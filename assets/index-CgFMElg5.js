var sD=Object.defineProperty;var k1=s=>{throw TypeError(s)};var iD=(s,e,t)=>e in s?sD(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Me=(s,e,t)=>iD(s,typeof e!="symbol"?e+"":e,t),Ib=(s,e,t)=>e.has(s)||k1("Cannot "+t);var m=(s,e,t)=>(Ib(s,e,"read from private field"),t?t.call(s):e.get(s)),k=(s,e,t)=>e.has(s)?k1("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),C=(s,e,t,n)=>(Ib(s,e,"write to private field"),n?n.call(s,t):e.set(s,t),t),M=(s,e,t)=>(Ib(s,e,"access private method"),t);var Bn=(s,e,t,n)=>({set _(i){C(s,e,i,t)},get _(){return m(s,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function hN(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Db={exports:{}},Fh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M1;function rD(){if(M1)return Fh;M1=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:s,type:n,key:l,ref:i!==void 0?i:null,props:a}}return Fh.Fragment=e,Fh.jsx=t,Fh.jsxs=t,Fh}var I1;function aD(){return I1||(I1=1,Db.exports=rD()),Db.exports}var b=aD(),Pb={exports:{}},Ue={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D1;function oD(){if(D1)return Ue;D1=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),_=Symbol.iterator;function S(U){return U===null||typeof U!="object"?null:(U=_&&U[_]||U["@@iterator"],typeof U=="function"?U:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,N={};function R(U,Q,re){this.props=U,this.context=Q,this.refs=N,this.updater=re||A}R.prototype.isReactComponent={},R.prototype.setState=function(U,Q){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,Q,"setState")},R.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function D(){}D.prototype=R.prototype;function P(U,Q,re){this.props=U,this.context=Q,this.refs=N,this.updater=re||A}var L=P.prototype=new D;L.constructor=P,E(L,R.prototype),L.isPureReactComponent=!0;var z=Array.isArray;function H(){}var F={H:null,A:null,T:null,S:null},X=Object.prototype.hasOwnProperty;function Y(U,Q,re){var ne=re.ref;return{$$typeof:s,type:U,key:Q,ref:ne!==void 0?ne:null,props:re}}function J(U,Q){return Y(U.type,Q,U.props)}function ie(U){return typeof U=="object"&&U!==null&&U.$$typeof===s}function pe(U){var Q={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(re){return Q[re]})}var ye=/\/+/g;function be(U,Q){return typeof U=="object"&&U!==null&&U.key!=null?pe(""+U.key):Q.toString(36)}function Se(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(H,H):(U.status="pending",U.then(function(Q){U.status==="pending"&&(U.status="fulfilled",U.value=Q)},function(Q){U.status==="pending"&&(U.status="rejected",U.reason=Q)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function j(U,Q,re,ne,fe){var ge=typeof U;(ge==="undefined"||ge==="boolean")&&(U=null);var de=!1;if(U===null)de=!0;else switch(ge){case"bigint":case"string":case"number":de=!0;break;case"object":switch(U.$$typeof){case s:case e:de=!0;break;case p:return de=U._init,j(de(U._payload),Q,re,ne,fe)}}if(de)return fe=fe(U),de=ne===""?"."+be(U,0):ne,z(fe)?(re="",de!=null&&(re=de.replace(ye,"$&/")+"/"),j(fe,Q,re,"",function(jn){return jn})):fe!=null&&(ie(fe)&&(fe=J(fe,re+(fe.key==null||U&&U.key===fe.key?"":(""+fe.key).replace(ye,"$&/")+"/")+de)),Q.push(fe)),1;de=0;var ot=ne===""?".":ne+":";if(z(U))for(var Ze=0;Ze<U.length;Ze++)ne=U[Ze],ge=ot+be(ne,Ze),de+=j(ne,Q,re,ge,fe);else if(Ze=S(U),typeof Ze=="function")for(U=Ze.call(U),Ze=0;!(ne=U.next()).done;)ne=ne.value,ge=ot+be(ne,Ze++),de+=j(ne,Q,re,ge,fe);else if(ge==="object"){if(typeof U.then=="function")return j(Se(U),Q,re,ne,fe);throw Q=String(U),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return de}function G(U,Q,re){if(U==null)return U;var ne=[],fe=0;return j(U,ne,"","",function(ge){return Q.call(re,ge,fe++)}),ne}function ae(U){if(U._status===-1){var Q=U._result;Q=Q(),Q.then(function(re){(U._status===0||U._status===-1)&&(U._status=1,U._result=re)},function(re){(U._status===0||U._status===-1)&&(U._status=2,U._result=re)}),U._status===-1&&(U._status=0,U._result=Q)}if(U._status===1)return U._result.default;throw U._result}var we=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(Q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},Ne={map:G,forEach:function(U,Q,re){G(U,function(){Q.apply(this,arguments)},re)},count:function(U){var Q=0;return G(U,function(){Q++}),Q},toArray:function(U){return G(U,function(Q){return Q})||[]},only:function(U){if(!ie(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return Ue.Activity=y,Ue.Children=Ne,Ue.Component=R,Ue.Fragment=t,Ue.Profiler=i,Ue.PureComponent=P,Ue.StrictMode=n,Ue.Suspense=d,Ue.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Ue.__COMPILER_RUNTIME={__proto__:null,c:function(U){return F.H.useMemoCache(U)}},Ue.cache=function(U){return function(){return U.apply(null,arguments)}},Ue.cacheSignal=function(){return null},Ue.cloneElement=function(U,Q,re){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var ne=E({},U.props),fe=U.key;if(Q!=null)for(ge in Q.key!==void 0&&(fe=""+Q.key),Q)!X.call(Q,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&Q.ref===void 0||(ne[ge]=Q[ge]);var ge=arguments.length-2;if(ge===1)ne.children=re;else if(1<ge){for(var de=Array(ge),ot=0;ot<ge;ot++)de[ot]=arguments[ot+2];ne.children=de}return Y(U.type,fe,ne)},Ue.createContext=function(U){return U={$$typeof:l,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:a,_context:U},U},Ue.createElement=function(U,Q,re){var ne,fe={},ge=null;if(Q!=null)for(ne in Q.key!==void 0&&(ge=""+Q.key),Q)X.call(Q,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(fe[ne]=Q[ne]);var de=arguments.length-2;if(de===1)fe.children=re;else if(1<de){for(var ot=Array(de),Ze=0;Ze<de;Ze++)ot[Ze]=arguments[Ze+2];fe.children=ot}if(U&&U.defaultProps)for(ne in de=U.defaultProps,de)fe[ne]===void 0&&(fe[ne]=de[ne]);return Y(U,ge,fe)},Ue.createRef=function(){return{current:null}},Ue.forwardRef=function(U){return{$$typeof:c,render:U}},Ue.isValidElement=ie,Ue.lazy=function(U){return{$$typeof:p,_payload:{_status:-1,_result:U},_init:ae}},Ue.memo=function(U,Q){return{$$typeof:h,type:U,compare:Q===void 0?null:Q}},Ue.startTransition=function(U){var Q=F.T,re={};F.T=re;try{var ne=U(),fe=F.S;fe!==null&&fe(re,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(H,we)}catch(ge){we(ge)}finally{Q!==null&&re.types!==null&&(Q.types=re.types),F.T=Q}},Ue.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Ue.use=function(U){return F.H.use(U)},Ue.useActionState=function(U,Q,re){return F.H.useActionState(U,Q,re)},Ue.useCallback=function(U,Q){return F.H.useCallback(U,Q)},Ue.useContext=function(U){return F.H.useContext(U)},Ue.useDebugValue=function(){},Ue.useDeferredValue=function(U,Q){return F.H.useDeferredValue(U,Q)},Ue.useEffect=function(U,Q){return F.H.useEffect(U,Q)},Ue.useEffectEvent=function(U){return F.H.useEffectEvent(U)},Ue.useId=function(){return F.H.useId()},Ue.useImperativeHandle=function(U,Q,re){return F.H.useImperativeHandle(U,Q,re)},Ue.useInsertionEffect=function(U,Q){return F.H.useInsertionEffect(U,Q)},Ue.useLayoutEffect=function(U,Q){return F.H.useLayoutEffect(U,Q)},Ue.useMemo=function(U,Q){return F.H.useMemo(U,Q)},Ue.useOptimistic=function(U,Q){return F.H.useOptimistic(U,Q)},Ue.useReducer=function(U,Q,re){return F.H.useReducer(U,Q,re)},Ue.useRef=function(U){return F.H.useRef(U)},Ue.useState=function(U){return F.H.useState(U)},Ue.useSyncExternalStore=function(U,Q,re){return F.H.useSyncExternalStore(U,Q,re)},Ue.useTransition=function(){return F.H.useTransition()},Ue.version="19.2.3",Ue}var P1;function Qx(){return P1||(P1=1,Pb.exports=oD()),Pb.exports}var se=Qx();const Wp=hN(se);var Lb={exports:{}},jh={},Ob={exports:{}},Ub={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L1;function lD(){return L1||(L1=1,(function(s){function e(j,G){var ae=j.length;j.push(G);e:for(;0<ae;){var we=ae-1>>>1,Ne=j[we];if(0<i(Ne,G))j[we]=G,j[ae]=Ne,ae=we;else break e}}function t(j){return j.length===0?null:j[0]}function n(j){if(j.length===0)return null;var G=j[0],ae=j.pop();if(ae!==G){j[0]=ae;e:for(var we=0,Ne=j.length,U=Ne>>>1;we<U;){var Q=2*(we+1)-1,re=j[Q],ne=Q+1,fe=j[ne];if(0>i(re,ae))ne<Ne&&0>i(fe,re)?(j[we]=fe,j[ne]=ae,we=ne):(j[we]=re,j[Q]=ae,we=Q);else if(ne<Ne&&0>i(fe,ae))j[we]=fe,j[ne]=ae,we=ne;else break e}}return G}function i(j,G){var ae=j.sortIndex-G.sortIndex;return ae!==0?ae:j.id-G.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;s.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();s.unstable_now=function(){return l.now()-c}}var d=[],h=[],p=1,y=null,_=3,S=!1,A=!1,E=!1,N=!1,R=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function L(j){for(var G=t(h);G!==null;){if(G.callback===null)n(h);else if(G.startTime<=j)n(h),G.sortIndex=G.expirationTime,e(d,G);else break;G=t(h)}}function z(j){if(E=!1,L(j),!A)if(t(d)!==null)A=!0,H||(H=!0,pe());else{var G=t(h);G!==null&&Se(z,G.startTime-j)}}var H=!1,F=-1,X=5,Y=-1;function J(){return N?!0:!(s.unstable_now()-Y<X)}function ie(){if(N=!1,H){var j=s.unstable_now();Y=j;var G=!0;try{e:{A=!1,E&&(E=!1,D(F),F=-1),S=!0;var ae=_;try{t:{for(L(j),y=t(d);y!==null&&!(y.expirationTime>j&&J());){var we=y.callback;if(typeof we=="function"){y.callback=null,_=y.priorityLevel;var Ne=we(y.expirationTime<=j);if(j=s.unstable_now(),typeof Ne=="function"){y.callback=Ne,L(j),G=!0;break t}y===t(d)&&n(d),L(j)}else n(d);y=t(d)}if(y!==null)G=!0;else{var U=t(h);U!==null&&Se(z,U.startTime-j),G=!1}}break e}finally{y=null,_=ae,S=!1}G=void 0}}finally{G?pe():H=!1}}}var pe;if(typeof P=="function")pe=function(){P(ie)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,be=ye.port2;ye.port1.onmessage=ie,pe=function(){be.postMessage(null)}}else pe=function(){R(ie,0)};function Se(j,G){F=R(function(){j(s.unstable_now())},G)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(j){j.callback=null},s.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<j?Math.floor(1e3/j):5},s.unstable_getCurrentPriorityLevel=function(){return _},s.unstable_next=function(j){switch(_){case 1:case 2:case 3:var G=3;break;default:G=_}var ae=_;_=G;try{return j()}finally{_=ae}},s.unstable_requestPaint=function(){N=!0},s.unstable_runWithPriority=function(j,G){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var ae=_;_=j;try{return G()}finally{_=ae}},s.unstable_scheduleCallback=function(j,G,ae){var we=s.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?we+ae:we):ae=we,j){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=ae+Ne,j={id:p++,callback:G,priorityLevel:j,startTime:ae,expirationTime:Ne,sortIndex:-1},ae>we?(j.sortIndex=ae,e(h,j),t(d)===null&&j===t(h)&&(E?(D(F),F=-1):E=!0,Se(z,ae-we))):(j.sortIndex=Ne,e(d,j),A||S||(A=!0,H||(H=!0,pe()))),j},s.unstable_shouldYield=J,s.unstable_wrapCallback=function(j){var G=_;return function(){var ae=_;_=G;try{return j.apply(this,arguments)}finally{_=ae}}}})(Ub)),Ub}var O1;function cD(){return O1||(O1=1,Ob.exports=lD()),Ob.exports}var Fb={exports:{}},Cn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U1;function uD(){if(U1)return Cn;U1=1;var s=Qx();function e(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(d,h,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:y==null?null:""+y,children:d,containerInfo:h,implementation:p}}var l=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Cn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Cn.createPortal=function(d,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return a(d,h,null,p)},Cn.flushSync=function(d){var h=l.T,p=n.p;try{if(l.T=null,n.p=2,d)return d()}finally{l.T=h,n.p=p,n.d.f()}},Cn.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(d,h))},Cn.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},Cn.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var p=h.as,y=c(p,h.crossOrigin),_=typeof h.integrity=="string"?h.integrity:void 0,S=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?n.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:y,integrity:_,fetchPriority:S}):p==="script"&&n.d.X(d,{crossOrigin:y,integrity:_,fetchPriority:S,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Cn.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=c(h.as,h.crossOrigin);n.d.M(d,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(d)},Cn.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,y=c(p,h.crossOrigin);n.d.L(d,p,{crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Cn.preloadModule=function(d,h){if(typeof d=="string")if(h){var p=c(h.as,h.crossOrigin);n.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(d)},Cn.requestFormReset=function(d){n.d.r(d)},Cn.unstable_batchedUpdates=function(d,h){return d(h)},Cn.useFormState=function(d,h,p){return l.H.useFormState(d,h,p)},Cn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Cn.version="19.2.3",Cn}var F1;function fN(){if(F1)return Fb.exports;F1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Fb.exports=uD(),Fb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j1;function dD(){if(j1)return jh;j1=1;var s=cD(),e=Qx(),t=fN();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,u=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(u=o.return),r=o.return;while(r)}return o.tag===3?u:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function c(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function d(r){if(a(r)!==r)throw Error(n(188))}function h(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(n(188));return o!==r?null:r}for(var u=r,f=o;;){var x=u.return;if(x===null)break;var w=x.alternate;if(w===null){if(f=x.return,f!==null){u=f;continue}break}if(x.child===w.child){for(w=x.child;w;){if(w===u)return d(x),r;if(w===f)return d(x),o;w=w.sibling}throw Error(n(188))}if(u.return!==f.return)u=x,f=w;else{for(var T=!1,I=x.child;I;){if(I===u){T=!0,u=x,f=w;break}if(I===f){T=!0,f=x,u=w;break}I=I.sibling}if(!T){for(I=w.child;I;){if(I===u){T=!0,u=w,f=x;break}if(I===f){T=!0,f=w,u=x;break}I=I.sibling}if(!T)throw Error(n(189))}}if(u.alternate!==f)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?r:o}function p(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=p(r),o!==null)return o;r=r.sibling}return null}var y=Object.assign,_=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),P=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),ie=Symbol.iterator;function pe(r){return r===null||typeof r!="object"?null:(r=ie&&r[ie]||r["@@iterator"],typeof r=="function"?r:null)}var ye=Symbol.for("react.client.reference");function be(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===ye?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case E:return"Fragment";case R:return"Profiler";case N:return"StrictMode";case z:return"Suspense";case H:return"SuspenseList";case Y:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case A:return"Portal";case P:return r.displayName||"Context";case D:return(r._context.displayName||"Context")+".Consumer";case L:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case F:return o=r.displayName||null,o!==null?o:be(r.type)||"Memo";case X:o=r._payload,r=r._init;try{return be(r(o))}catch{}}return null}var Se=Array.isArray,j=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},we=[],Ne=-1;function U(r){return{current:r}}function Q(r){0>Ne||(r.current=we[Ne],we[Ne]=null,Ne--)}function re(r,o){Ne++,we[Ne]=r.current,r.current=o}var ne=U(null),fe=U(null),ge=U(null),de=U(null);function ot(r,o){switch(re(ge,o),re(fe,r),re(ne,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?ZE(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=ZE(o),r=e1(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}Q(ne),re(ne,r)}function Ze(){Q(ne),Q(fe),Q(ge)}function jn(r){r.memoizedState!==null&&re(de,r);var o=ne.current,u=e1(o,r.type);o!==u&&(re(fe,r),re(ne,u))}function zi(r){fe.current===r&&(Q(ne),Q(fe)),de.current===r&&(Q(de),Ph._currentValue=ae)}var hr,Gs;function Zn(r){if(hr===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);hr=o&&o[1]||"",Gs=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+hr+r+Gs}var Hd=!1;function Bd(r,o){if(!r||Hd)return"";Hd=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var te=function(){throw Error()};if(Object.defineProperty(te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(te,[])}catch(W){var K=W}Reflect.construct(r,[],te)}else{try{te.call()}catch(W){K=W}r.call(te.prototype)}}else{try{throw Error()}catch(W){K=W}(te=r())&&typeof te.catch=="function"&&te.catch(function(){})}}catch(W){if(W&&K&&typeof W.stack=="string")return[W.stack,K.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=f.DetermineComponentFrameRoot(),T=w[0],I=w[1];if(T&&I){var O=T.split(`
`),$=I.split(`
`);for(x=f=0;f<O.length&&!O[f].includes("DetermineComponentFrameRoot");)f++;for(;x<$.length&&!$[x].includes("DetermineComponentFrameRoot");)x++;if(f===O.length||x===$.length)for(f=O.length-1,x=$.length-1;1<=f&&0<=x&&O[f]!==$[x];)x--;for(;1<=f&&0<=x;f--,x--)if(O[f]!==$[x]){if(f!==1||x!==1)do if(f--,x--,0>x||O[f]!==$[x]){var Z=`
`+O[f].replace(" at new "," at ");return r.displayName&&Z.includes("<anonymous>")&&(Z=Z.replace("<anonymous>",r.displayName)),Z}while(1<=f&&0<=x);break}}}finally{Hd=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?Zn(u):""}function gv(r,o){switch(r.tag){case 26:case 27:case 5:return Zn(r.type);case 16:return Zn("Lazy");case 13:return r.child!==o&&o!==null?Zn("Suspense Fallback"):Zn("Suspense");case 19:return Zn("SuspenseList");case 0:case 15:return Bd(r.type,!1);case 11:return Bd(r.type.render,!1);case 1:return Bd(r.type,!0);case 31:return Zn("Activity");default:return""}}function sm(r){try{var o="",u=null;do o+=gv(r,u),u=r,r=r.return;while(r);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Gd=Object.prototype.hasOwnProperty,qd=s.unstable_scheduleCallback,Vd=s.unstable_cancelCallback,vv=s.unstable_shouldYield,yv=s.unstable_requestPaint,oe=s.unstable_now,qe=s.unstable_getCurrentPriorityLevel,zn=s.unstable_ImmediatePriority,es=s.unstable_UserBlockingPriority,bc=s.unstable_NormalPriority,bv=s.unstable_LowPriority,ya=s.unstable_IdlePriority,Mo=s.log,zk=s.unstable_setDisableYieldValue,$d=null,ms=null;function ba(r){if(typeof Mo=="function"&&zk(r),ms&&typeof ms.setStrictMode=="function")try{ms.setStrictMode($d,r)}catch{}}var gs=Math.clz32?Math.clz32:Gk,Hk=Math.log,Bk=Math.LN2;function Gk(r){return r>>>=0,r===0?32:31-(Hk(r)/Bk|0)|0}var im=256,rm=262144,am=4194304;function Io(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function om(r,o,u){var f=r.pendingLanes;if(f===0)return 0;var x=0,w=r.suspendedLanes,T=r.pingedLanes;r=r.warmLanes;var I=f&134217727;return I!==0?(f=I&~w,f!==0?x=Io(f):(T&=I,T!==0?x=Io(T):u||(u=I&~r,u!==0&&(x=Io(u))))):(I=f&~w,I!==0?x=Io(I):T!==0?x=Io(T):u||(u=f&~r,u!==0&&(x=Io(u)))),x===0?0:o!==0&&o!==x&&(o&w)===0&&(w=x&-x,u=o&-o,w>=u||w===32&&(u&4194048)!==0)?o:x}function Yd(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function qk(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pw(){var r=am;return am<<=1,(am&62914560)===0&&(am=4194304),r}function _v(r){for(var o=[],u=0;31>u;u++)o.push(r);return o}function Kd(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Vk(r,o,u,f,x,w){var T=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var I=r.entanglements,O=r.expirationTimes,$=r.hiddenUpdates;for(u=T&~u;0<u;){var Z=31-gs(u),te=1<<Z;I[Z]=0,O[Z]=-1;var K=$[Z];if(K!==null)for($[Z]=null,Z=0;Z<K.length;Z++){var W=K[Z];W!==null&&(W.lane&=-536870913)}u&=~te}f!==0&&Lw(r,f,0),w!==0&&x===0&&r.tag!==0&&(r.suspendedLanes|=w&~(T&~o))}function Lw(r,o,u){r.pendingLanes|=o,r.suspendedLanes&=~o;var f=31-gs(o);r.entangledLanes|=o,r.entanglements[f]=r.entanglements[f]|1073741824|u&261930}function Ow(r,o){var u=r.entangledLanes|=o;for(r=r.entanglements;u;){var f=31-gs(u),x=1<<f;x&o|r[f]&o&&(r[f]|=o),u&=~x}}function Uw(r,o){var u=o&-o;return u=(u&42)!==0?1:xv(u),(u&(r.suspendedLanes|o))!==0?0:u}function xv(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function wv(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Fw(){var r=G.p;return r!==0?r:(r=window.event,r===void 0?32:S1(r.type))}function jw(r,o){var u=G.p;try{return G.p=r,o()}finally{G.p=u}}var _a=Math.random().toString(36).slice(2),pn="__reactFiber$"+_a,ts="__reactProps$"+_a,_c="__reactContainer$"+_a,Sv="__reactEvents$"+_a,$k="__reactListeners$"+_a,Yk="__reactHandles$"+_a,zw="__reactResources$"+_a,Xd="__reactMarker$"+_a;function Av(r){delete r[pn],delete r[ts],delete r[Sv],delete r[$k],delete r[Yk]}function xc(r){var o=r[pn];if(o)return o;for(var u=r.parentNode;u;){if(o=u[_c]||u[pn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(r=o1(r);r!==null;){if(u=r[pn])return u;r=o1(r)}return o}r=u,u=r.parentNode}return null}function wc(r){if(r=r[pn]||r[_c]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function Jd(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function Sc(r){var o=r[zw];return o||(o=r[zw]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function rn(r){r[Xd]=!0}var Hw=new Set,Bw={};function Do(r,o){Ac(r,o),Ac(r+"Capture",o)}function Ac(r,o){for(Bw[r]=o,r=0;r<o.length;r++)Hw.add(o[r])}var Kk=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gw={},qw={};function Xk(r){return Gd.call(qw,r)?!0:Gd.call(Gw,r)?!1:Kk.test(r)?qw[r]=!0:(Gw[r]=!0,!1)}function lm(r,o,u){if(Xk(o))if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+u)}}function cm(r,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+u)}}function fr(r,o,u,f){if(f===null)r.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(o,u,""+f)}}function qs(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Vw(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Jk(r,o,u){var f=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var x=f.get,w=f.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return x.call(this)},set:function(T){u=""+T,w.call(this,T)}}),Object.defineProperty(r,o,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Ev(r){if(!r._valueTracker){var o=Vw(r)?"checked":"value";r._valueTracker=Jk(r,o,""+r[o])}}function $w(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var u=o.getValue(),f="";return r&&(f=Vw(r)?r.checked?"true":"false":r.value),r=f,r!==u?(o.setValue(r),!0):!1}function um(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Wk=/[\n"\\]/g;function Vs(r){return r.replace(Wk,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Tv(r,o,u,f,x,w,T,I){r.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?r.type=T:r.removeAttribute("type"),o!=null?T==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+qs(o)):r.value!==""+qs(o)&&(r.value=""+qs(o)):T!=="submit"&&T!=="reset"||r.removeAttribute("value"),o!=null?Cv(r,T,qs(o)):u!=null?Cv(r,T,qs(u)):f!=null&&r.removeAttribute("value"),x==null&&w!=null&&(r.defaultChecked=!!w),x!=null&&(r.checked=x&&typeof x!="function"&&typeof x!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?r.name=""+qs(I):r.removeAttribute("name")}function Yw(r,o,u,f,x,w,T,I){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(r.type=w),o!=null||u!=null){if(!(w!=="submit"&&w!=="reset"||o!=null)){Ev(r);return}u=u!=null?""+qs(u):"",o=o!=null?""+qs(o):u,I||o===r.value||(r.value=o),r.defaultValue=o}f=f??x,f=typeof f!="function"&&typeof f!="symbol"&&!!f,r.checked=I?r.checked:!!f,r.defaultChecked=!!f,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(r.name=T),Ev(r)}function Cv(r,o,u){o==="number"&&um(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function Ec(r,o,u,f){if(r=r.options,o){o={};for(var x=0;x<u.length;x++)o["$"+u[x]]=!0;for(u=0;u<r.length;u++)x=o.hasOwnProperty("$"+r[u].value),r[u].selected!==x&&(r[u].selected=x),x&&f&&(r[u].defaultSelected=!0)}else{for(u=""+qs(u),o=null,x=0;x<r.length;x++){if(r[x].value===u){r[x].selected=!0,f&&(r[x].defaultSelected=!0);return}o!==null||r[x].disabled||(o=r[x])}o!==null&&(o.selected=!0)}}function Kw(r,o,u){if(o!=null&&(o=""+qs(o),o!==r.value&&(r.value=o),u==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=u!=null?""+qs(u):""}function Xw(r,o,u,f){if(o==null){if(f!=null){if(u!=null)throw Error(n(92));if(Se(f)){if(1<f.length)throw Error(n(93));f=f[0]}u=f}u==null&&(u=""),o=u}u=qs(o),r.defaultValue=u,f=r.textContent,f===u&&f!==""&&f!==null&&(r.value=f),Ev(r)}function Tc(r,o){if(o){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=o;return}}r.textContent=o}var Qk=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Jw(r,o,u){var f=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":f?r.setProperty(o,u):typeof u!="number"||u===0||Qk.has(o)?o==="float"?r.cssFloat=u:r[o]=(""+u).trim():r[o]=u+"px"}function Ww(r,o,u){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?r.setProperty(f,""):f==="float"?r.cssFloat="":r[f]="");for(var x in o)f=o[x],o.hasOwnProperty(x)&&u[x]!==f&&Jw(r,x,f)}else for(var w in o)o.hasOwnProperty(w)&&Jw(r,w,o[w])}function Nv(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zk=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),eM=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function dm(r){return eM.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function pr(){}var Rv=null;function kv(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Cc=null,Nc=null;function Qw(r){var o=wc(r);if(o&&(r=o.stateNode)){var u=r[ts]||null;e:switch(r=o.stateNode,o.type){case"input":if(Tv(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Vs(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var f=u[o];if(f!==r&&f.form===r.form){var x=f[ts]||null;if(!x)throw Error(n(90));Tv(f,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(o=0;o<u.length;o++)f=u[o],f.form===r.form&&$w(f)}break e;case"textarea":Kw(r,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Ec(r,!!u.multiple,o,!1)}}}var Mv=!1;function Zw(r,o,u){if(Mv)return r(o,u);Mv=!0;try{var f=r(o);return f}finally{if(Mv=!1,(Cc!==null||Nc!==null)&&(Qm(),Cc&&(o=Cc,r=Nc,Nc=Cc=null,Qw(o),r)))for(o=0;o<r.length;o++)Qw(r[o])}}function Wd(r,o){var u=r.stateNode;if(u===null)return null;var f=u[ts]||null;if(f===null)return null;u=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(r=r.type,f=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!f;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(n(231,o,typeof u));return u}var mr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Iv=!1;if(mr)try{var Qd={};Object.defineProperty(Qd,"passive",{get:function(){Iv=!0}}),window.addEventListener("test",Qd,Qd),window.removeEventListener("test",Qd,Qd)}catch{Iv=!1}var xa=null,Dv=null,hm=null;function eS(){if(hm)return hm;var r,o=Dv,u=o.length,f,x="value"in xa?xa.value:xa.textContent,w=x.length;for(r=0;r<u&&o[r]===x[r];r++);var T=u-r;for(f=1;f<=T&&o[u-f]===x[w-f];f++);return hm=x.slice(r,1<f?1-f:void 0)}function fm(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function pm(){return!0}function tS(){return!1}function ns(r){function o(u,f,x,w,T){this._reactName=u,this._targetInst=x,this.type=f,this.nativeEvent=w,this.target=T,this.currentTarget=null;for(var I in r)r.hasOwnProperty(I)&&(u=r[I],this[I]=u?u(w):w[I]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?pm:tS,this.isPropagationStopped=tS,this}return y(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=pm)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=pm)},persist:function(){},isPersistent:pm}),o}var Po={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mm=ns(Po),Zd=y({},Po,{view:0,detail:0}),tM=ns(Zd),Pv,Lv,eh,gm=y({},Zd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uv,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==eh&&(eh&&r.type==="mousemove"?(Pv=r.screenX-eh.screenX,Lv=r.screenY-eh.screenY):Lv=Pv=0,eh=r),Pv)},movementY:function(r){return"movementY"in r?r.movementY:Lv}}),nS=ns(gm),nM=y({},gm,{dataTransfer:0}),sM=ns(nM),iM=y({},Zd,{relatedTarget:0}),Ov=ns(iM),rM=y({},Po,{animationName:0,elapsedTime:0,pseudoElement:0}),aM=ns(rM),oM=y({},Po,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),lM=ns(oM),cM=y({},Po,{data:0}),sS=ns(cM),uM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fM(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=hM[r])?!!o[r]:!1}function Uv(){return fM}var pM=y({},Zd,{key:function(r){if(r.key){var o=uM[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=fm(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?dM[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uv,charCode:function(r){return r.type==="keypress"?fm(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?fm(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),mM=ns(pM),gM=y({},gm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),iS=ns(gM),vM=y({},Zd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uv}),yM=ns(vM),bM=y({},Po,{propertyName:0,elapsedTime:0,pseudoElement:0}),_M=ns(bM),xM=y({},gm,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),wM=ns(xM),SM=y({},Po,{newState:0,oldState:0}),AM=ns(SM),EM=[9,13,27,32],Fv=mr&&"CompositionEvent"in window,th=null;mr&&"documentMode"in document&&(th=document.documentMode);var TM=mr&&"TextEvent"in window&&!th,rS=mr&&(!Fv||th&&8<th&&11>=th),aS=" ",oS=!1;function lS(r,o){switch(r){case"keyup":return EM.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cS(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Rc=!1;function CM(r,o){switch(r){case"compositionend":return cS(o);case"keypress":return o.which!==32?null:(oS=!0,aS);case"textInput":return r=o.data,r===aS&&oS?null:r;default:return null}}function NM(r,o){if(Rc)return r==="compositionend"||!Fv&&lS(r,o)?(r=eS(),hm=Dv=xa=null,Rc=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return rS&&o.locale!=="ko"?null:o.data;default:return null}}var RM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uS(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!RM[r.type]:o==="textarea"}function dS(r,o,u,f){Cc?Nc?Nc.push(f):Nc=[f]:Cc=f,o=rg(o,"onChange"),0<o.length&&(u=new mm("onChange","change",null,u,f),r.push({event:u,listeners:o}))}var nh=null,sh=null;function kM(r){YE(r,0)}function vm(r){var o=Jd(r);if($w(o))return r}function hS(r,o){if(r==="change")return o}var fS=!1;if(mr){var jv;if(mr){var zv="oninput"in document;if(!zv){var pS=document.createElement("div");pS.setAttribute("oninput","return;"),zv=typeof pS.oninput=="function"}jv=zv}else jv=!1;fS=jv&&(!document.documentMode||9<document.documentMode)}function mS(){nh&&(nh.detachEvent("onpropertychange",gS),sh=nh=null)}function gS(r){if(r.propertyName==="value"&&vm(sh)){var o=[];dS(o,sh,r,kv(r)),Zw(kM,o)}}function MM(r,o,u){r==="focusin"?(mS(),nh=o,sh=u,nh.attachEvent("onpropertychange",gS)):r==="focusout"&&mS()}function IM(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return vm(sh)}function DM(r,o){if(r==="click")return vm(o)}function PM(r,o){if(r==="input"||r==="change")return vm(o)}function LM(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var vs=typeof Object.is=="function"?Object.is:LM;function ih(r,o){if(vs(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var u=Object.keys(r),f=Object.keys(o);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var x=u[f];if(!Gd.call(o,x)||!vs(r[x],o[x]))return!1}return!0}function vS(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function yS(r,o){var u=vS(r);r=0;for(var f;u;){if(u.nodeType===3){if(f=r+u.textContent.length,r<=o&&f>=o)return{node:u,offset:o-r};r=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=vS(u)}}function bS(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?bS(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function _S(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=um(r.document);o instanceof r.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)r=o.contentWindow;else break;o=um(r.document)}return o}function Hv(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var OM=mr&&"documentMode"in document&&11>=document.documentMode,kc=null,Bv=null,rh=null,Gv=!1;function xS(r,o,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Gv||kc==null||kc!==um(f)||(f=kc,"selectionStart"in f&&Hv(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),rh&&ih(rh,f)||(rh=f,f=rg(Bv,"onSelect"),0<f.length&&(o=new mm("onSelect","select",null,o,u),r.push({event:o,listeners:f}),o.target=kc)))}function Lo(r,o){var u={};return u[r.toLowerCase()]=o.toLowerCase(),u["Webkit"+r]="webkit"+o,u["Moz"+r]="moz"+o,u}var Mc={animationend:Lo("Animation","AnimationEnd"),animationiteration:Lo("Animation","AnimationIteration"),animationstart:Lo("Animation","AnimationStart"),transitionrun:Lo("Transition","TransitionRun"),transitionstart:Lo("Transition","TransitionStart"),transitioncancel:Lo("Transition","TransitionCancel"),transitionend:Lo("Transition","TransitionEnd")},qv={},wS={};mr&&(wS=document.createElement("div").style,"AnimationEvent"in window||(delete Mc.animationend.animation,delete Mc.animationiteration.animation,delete Mc.animationstart.animation),"TransitionEvent"in window||delete Mc.transitionend.transition);function Oo(r){if(qv[r])return qv[r];if(!Mc[r])return r;var o=Mc[r],u;for(u in o)if(o.hasOwnProperty(u)&&u in wS)return qv[r]=o[u];return r}var SS=Oo("animationend"),AS=Oo("animationiteration"),ES=Oo("animationstart"),UM=Oo("transitionrun"),FM=Oo("transitionstart"),jM=Oo("transitioncancel"),TS=Oo("transitionend"),CS=new Map,Vv="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vv.push("scrollEnd");function fi(r,o){CS.set(r,o),Do(o,[r])}var ym=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},$s=[],Ic=0,$v=0;function bm(){for(var r=Ic,o=$v=Ic=0;o<r;){var u=$s[o];$s[o++]=null;var f=$s[o];$s[o++]=null;var x=$s[o];$s[o++]=null;var w=$s[o];if($s[o++]=null,f!==null&&x!==null){var T=f.pending;T===null?x.next=x:(x.next=T.next,T.next=x),f.pending=x}w!==0&&NS(u,x,w)}}function _m(r,o,u,f){$s[Ic++]=r,$s[Ic++]=o,$s[Ic++]=u,$s[Ic++]=f,$v|=f,r.lanes|=f,r=r.alternate,r!==null&&(r.lanes|=f)}function Yv(r,o,u,f){return _m(r,o,u,f),xm(r)}function Uo(r,o){return _m(r,null,null,o),xm(r)}function NS(r,o,u){r.lanes|=u;var f=r.alternate;f!==null&&(f.lanes|=u);for(var x=!1,w=r.return;w!==null;)w.childLanes|=u,f=w.alternate,f!==null&&(f.childLanes|=u),w.tag===22&&(r=w.stateNode,r===null||r._visibility&1||(x=!0)),r=w,w=w.return;return r.tag===3?(w=r.stateNode,x&&o!==null&&(x=31-gs(u),r=w.hiddenUpdates,f=r[x],f===null?r[x]=[o]:f.push(o),o.lane=u|536870912),w):null}function xm(r){if(50<Ch)throw Ch=0,nb=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var Dc={};function zM(r,o,u,f){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ys(r,o,u,f){return new zM(r,o,u,f)}function Kv(r){return r=r.prototype,!(!r||!r.isReactComponent)}function gr(r,o){var u=r.alternate;return u===null?(u=ys(r.tag,o,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=o,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,o=r.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function RS(r,o){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,o=u.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function wm(r,o,u,f,x,w){var T=0;if(f=r,typeof r=="function")Kv(r)&&(T=1);else if(typeof r=="string")T=VI(r,u,ne.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case Y:return r=ys(31,u,o,x),r.elementType=Y,r.lanes=w,r;case E:return Fo(u.children,x,w,o);case N:T=8,x|=24;break;case R:return r=ys(12,u,o,x|2),r.elementType=R,r.lanes=w,r;case z:return r=ys(13,u,o,x),r.elementType=z,r.lanes=w,r;case H:return r=ys(19,u,o,x),r.elementType=H,r.lanes=w,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case P:T=10;break e;case D:T=9;break e;case L:T=11;break e;case F:T=14;break e;case X:T=16,f=null;break e}T=29,u=Error(n(130,r===null?"null":typeof r,"")),f=null}return o=ys(T,u,o,x),o.elementType=r,o.type=f,o.lanes=w,o}function Fo(r,o,u,f){return r=ys(7,r,f,o),r.lanes=u,r}function Xv(r,o,u){return r=ys(6,r,null,o),r.lanes=u,r}function kS(r){var o=ys(18,null,null,0);return o.stateNode=r,o}function Jv(r,o,u){return o=ys(4,r.children!==null?r.children:[],r.key,o),o.lanes=u,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var MS=new WeakMap;function Ys(r,o){if(typeof r=="object"&&r!==null){var u=MS.get(r);return u!==void 0?u:(o={value:r,source:o,stack:sm(o)},MS.set(r,o),o)}return{value:r,source:o,stack:sm(o)}}var Pc=[],Lc=0,Sm=null,ah=0,Ks=[],Xs=0,wa=null,Hi=1,Bi="";function vr(r,o){Pc[Lc++]=ah,Pc[Lc++]=Sm,Sm=r,ah=o}function IS(r,o,u){Ks[Xs++]=Hi,Ks[Xs++]=Bi,Ks[Xs++]=wa,wa=r;var f=Hi;r=Bi;var x=32-gs(f)-1;f&=~(1<<x),u+=1;var w=32-gs(o)+x;if(30<w){var T=x-x%5;w=(f&(1<<T)-1).toString(32),f>>=T,x-=T,Hi=1<<32-gs(o)+x|u<<x|f,Bi=w+r}else Hi=1<<w|u<<x|f,Bi=r}function Wv(r){r.return!==null&&(vr(r,1),IS(r,1,0))}function Qv(r){for(;r===Sm;)Sm=Pc[--Lc],Pc[Lc]=null,ah=Pc[--Lc],Pc[Lc]=null;for(;r===wa;)wa=Ks[--Xs],Ks[Xs]=null,Bi=Ks[--Xs],Ks[Xs]=null,Hi=Ks[--Xs],Ks[Xs]=null}function DS(r,o){Ks[Xs++]=Hi,Ks[Xs++]=Bi,Ks[Xs++]=wa,Hi=o.id,Bi=o.overflow,wa=r}var mn=null,wt=null,We=!1,Sa=null,Js=!1,Zv=Error(n(519));function Aa(r){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw oh(Ys(o,r)),Zv}function PS(r){var o=r.stateNode,u=r.type,f=r.memoizedProps;switch(o[pn]=r,o[ts]=f,u){case"dialog":Ke("cancel",o),Ke("close",o);break;case"iframe":case"object":case"embed":Ke("load",o);break;case"video":case"audio":for(u=0;u<Rh.length;u++)Ke(Rh[u],o);break;case"source":Ke("error",o);break;case"img":case"image":case"link":Ke("error",o),Ke("load",o);break;case"details":Ke("toggle",o);break;case"input":Ke("invalid",o),Yw(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Ke("invalid",o);break;case"textarea":Ke("invalid",o),Xw(o,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||f.suppressHydrationWarning===!0||WE(o.textContent,u)?(f.popover!=null&&(Ke("beforetoggle",o),Ke("toggle",o)),f.onScroll!=null&&Ke("scroll",o),f.onScrollEnd!=null&&Ke("scrollend",o),f.onClick!=null&&(o.onclick=pr),o=!0):o=!1,o||Aa(r,!0)}function LS(r){for(mn=r.return;mn;)switch(mn.tag){case 5:case 31:case 13:Js=!1;return;case 27:case 3:Js=!0;return;default:mn=mn.return}}function Oc(r){if(r!==mn)return!1;if(!We)return LS(r),We=!0,!1;var o=r.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||vb(r.type,r.memoizedProps)),u=!u),u&&wt&&Aa(r),LS(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));wt=a1(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));wt=a1(r)}else o===27?(o=wt,Fa(r.type)?(r=wb,wb=null,wt=r):wt=o):wt=mn?Qs(r.stateNode.nextSibling):null;return!0}function jo(){wt=mn=null,We=!1}function ey(){var r=Sa;return r!==null&&(as===null?as=r:as.push.apply(as,r),Sa=null),r}function oh(r){Sa===null?Sa=[r]:Sa.push(r)}var ty=U(null),zo=null,yr=null;function Ea(r,o,u){re(ty,o._currentValue),o._currentValue=u}function br(r){r._currentValue=ty.current,Q(ty)}function ny(r,o,u){for(;r!==null;){var f=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),r===u)break;r=r.return}}function sy(r,o,u,f){var x=r.child;for(x!==null&&(x.return=r);x!==null;){var w=x.dependencies;if(w!==null){var T=x.child;w=w.firstContext;e:for(;w!==null;){var I=w;w=x;for(var O=0;O<o.length;O++)if(I.context===o[O]){w.lanes|=u,I=w.alternate,I!==null&&(I.lanes|=u),ny(w.return,u,r),f||(T=null);break e}w=I.next}}else if(x.tag===18){if(T=x.return,T===null)throw Error(n(341));T.lanes|=u,w=T.alternate,w!==null&&(w.lanes|=u),ny(T,u,r),T=null}else T=x.child;if(T!==null)T.return=x;else for(T=x;T!==null;){if(T===r){T=null;break}if(x=T.sibling,x!==null){x.return=T.return,T=x;break}T=T.return}x=T}}function Uc(r,o,u,f){r=null;for(var x=o,w=!1;x!==null;){if(!w){if((x.flags&524288)!==0)w=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var T=x.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var I=x.type;vs(x.pendingProps.value,T.value)||(r!==null?r.push(I):r=[I])}}else if(x===de.current){if(T=x.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(r!==null?r.push(Ph):r=[Ph])}x=x.return}r!==null&&sy(o,r,u,f),o.flags|=262144}function Am(r){for(r=r.firstContext;r!==null;){if(!vs(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ho(r){zo=r,yr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function gn(r){return OS(zo,r)}function Em(r,o){return zo===null&&Ho(r),OS(r,o)}function OS(r,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},yr===null){if(r===null)throw Error(n(308));yr=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else yr=yr.next=o;return u}var HM=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(u,f){r.push(f)}};this.abort=function(){o.aborted=!0,r.forEach(function(u){return u()})}},BM=s.unstable_scheduleCallback,GM=s.unstable_NormalPriority,Gt={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function iy(){return{controller:new HM,data:new Map,refCount:0}}function lh(r){r.refCount--,r.refCount===0&&BM(GM,function(){r.controller.abort()})}var ch=null,ry=0,Fc=0,jc=null;function qM(r,o){if(ch===null){var u=ch=[];ry=0,Fc=lb(),jc={status:"pending",value:void 0,then:function(f){u.push(f)}}}return ry++,o.then(US,US),o}function US(){if(--ry===0&&ch!==null){jc!==null&&(jc.status="fulfilled");var r=ch;ch=null,Fc=0,jc=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function VM(r,o){var u=[],f={status:"pending",value:null,reason:null,then:function(x){u.push(x)}};return r.then(function(){f.status="fulfilled",f.value=o;for(var x=0;x<u.length;x++)(0,u[x])(o)},function(x){for(f.status="rejected",f.reason=x,x=0;x<u.length;x++)(0,u[x])(void 0)}),f}var FS=j.S;j.S=function(r,o){xE=oe(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&qM(r,o),FS!==null&&FS(r,o)};var Bo=U(null);function ay(){var r=Bo.current;return r!==null?r:vt.pooledCache}function Tm(r,o){o===null?re(Bo,Bo.current):re(Bo,o.pool)}function jS(){var r=ay();return r===null?null:{parent:Gt._currentValue,pool:r}}var zc=Error(n(460)),oy=Error(n(474)),Cm=Error(n(542)),Nm={then:function(){}};function zS(r){return r=r.status,r==="fulfilled"||r==="rejected"}function HS(r,o,u){switch(u=r[u],u===void 0?r.push(o):u!==o&&(o.then(pr,pr),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,GS(r),r;default:if(typeof o.status=="string")o.then(pr,pr);else{if(r=vt,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(f){if(o.status==="pending"){var x=o;x.status="fulfilled",x.value=f}},function(f){if(o.status==="pending"){var x=o;x.status="rejected",x.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,GS(r),r}throw qo=o,zc}}function Go(r){try{var o=r._init;return o(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(qo=u,zc):u}}var qo=null;function BS(){if(qo===null)throw Error(n(459));var r=qo;return qo=null,r}function GS(r){if(r===zc||r===Cm)throw Error(n(483))}var Hc=null,uh=0;function Rm(r){var o=uh;return uh+=1,Hc===null&&(Hc=[]),HS(Hc,r,o)}function dh(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function km(r,o){throw o.$$typeof===_?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function qS(r){function o(q,B){if(r){var V=q.deletions;V===null?(q.deletions=[B],q.flags|=16):V.push(B)}}function u(q,B){if(!r)return null;for(;B!==null;)o(q,B),B=B.sibling;return null}function f(q){for(var B=new Map;q!==null;)q.key!==null?B.set(q.key,q):B.set(q.index,q),q=q.sibling;return B}function x(q,B){return q=gr(q,B),q.index=0,q.sibling=null,q}function w(q,B,V){return q.index=V,r?(V=q.alternate,V!==null?(V=V.index,V<B?(q.flags|=67108866,B):V):(q.flags|=67108866,B)):(q.flags|=1048576,B)}function T(q){return r&&q.alternate===null&&(q.flags|=67108866),q}function I(q,B,V,ee){return B===null||B.tag!==6?(B=Xv(V,q.mode,ee),B.return=q,B):(B=x(B,V),B.return=q,B)}function O(q,B,V,ee){var Re=V.type;return Re===E?Z(q,B,V.props.children,ee,V.key):B!==null&&(B.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===X&&Go(Re)===B.type)?(B=x(B,V.props),dh(B,V),B.return=q,B):(B=wm(V.type,V.key,V.props,null,q.mode,ee),dh(B,V),B.return=q,B)}function $(q,B,V,ee){return B===null||B.tag!==4||B.stateNode.containerInfo!==V.containerInfo||B.stateNode.implementation!==V.implementation?(B=Jv(V,q.mode,ee),B.return=q,B):(B=x(B,V.children||[]),B.return=q,B)}function Z(q,B,V,ee,Re){return B===null||B.tag!==7?(B=Fo(V,q.mode,ee,Re),B.return=q,B):(B=x(B,V),B.return=q,B)}function te(q,B,V){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=Xv(""+B,q.mode,V),B.return=q,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case S:return V=wm(B.type,B.key,B.props,null,q.mode,V),dh(V,B),V.return=q,V;case A:return B=Jv(B,q.mode,V),B.return=q,B;case X:return B=Go(B),te(q,B,V)}if(Se(B)||pe(B))return B=Fo(B,q.mode,V,null),B.return=q,B;if(typeof B.then=="function")return te(q,Rm(B),V);if(B.$$typeof===P)return te(q,Em(q,B),V);km(q,B)}return null}function K(q,B,V,ee){var Re=B!==null?B.key:null;if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return Re!==null?null:I(q,B,""+V,ee);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case S:return V.key===Re?O(q,B,V,ee):null;case A:return V.key===Re?$(q,B,V,ee):null;case X:return V=Go(V),K(q,B,V,ee)}if(Se(V)||pe(V))return Re!==null?null:Z(q,B,V,ee,null);if(typeof V.then=="function")return K(q,B,Rm(V),ee);if(V.$$typeof===P)return K(q,B,Em(q,V),ee);km(q,V)}return null}function W(q,B,V,ee,Re){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return q=q.get(V)||null,I(B,q,""+ee,Re);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case S:return q=q.get(ee.key===null?V:ee.key)||null,O(B,q,ee,Re);case A:return q=q.get(ee.key===null?V:ee.key)||null,$(B,q,ee,Re);case X:return ee=Go(ee),W(q,B,V,ee,Re)}if(Se(ee)||pe(ee))return q=q.get(V)||null,Z(B,q,ee,Re,null);if(typeof ee.then=="function")return W(q,B,V,Rm(ee),Re);if(ee.$$typeof===P)return W(q,B,V,Em(B,ee),Re);km(B,ee)}return null}function _e(q,B,V,ee){for(var Re=null,tt=null,Ae=B,ze=B=0,Je=null;Ae!==null&&ze<V.length;ze++){Ae.index>ze?(Je=Ae,Ae=null):Je=Ae.sibling;var nt=K(q,Ae,V[ze],ee);if(nt===null){Ae===null&&(Ae=Je);break}r&&Ae&&nt.alternate===null&&o(q,Ae),B=w(nt,B,ze),tt===null?Re=nt:tt.sibling=nt,tt=nt,Ae=Je}if(ze===V.length)return u(q,Ae),We&&vr(q,ze),Re;if(Ae===null){for(;ze<V.length;ze++)Ae=te(q,V[ze],ee),Ae!==null&&(B=w(Ae,B,ze),tt===null?Re=Ae:tt.sibling=Ae,tt=Ae);return We&&vr(q,ze),Re}for(Ae=f(Ae);ze<V.length;ze++)Je=W(Ae,q,ze,V[ze],ee),Je!==null&&(r&&Je.alternate!==null&&Ae.delete(Je.key===null?ze:Je.key),B=w(Je,B,ze),tt===null?Re=Je:tt.sibling=Je,tt=Je);return r&&Ae.forEach(function(Ga){return o(q,Ga)}),We&&vr(q,ze),Re}function ke(q,B,V,ee){if(V==null)throw Error(n(151));for(var Re=null,tt=null,Ae=B,ze=B=0,Je=null,nt=V.next();Ae!==null&&!nt.done;ze++,nt=V.next()){Ae.index>ze?(Je=Ae,Ae=null):Je=Ae.sibling;var Ga=K(q,Ae,nt.value,ee);if(Ga===null){Ae===null&&(Ae=Je);break}r&&Ae&&Ga.alternate===null&&o(q,Ae),B=w(Ga,B,ze),tt===null?Re=Ga:tt.sibling=Ga,tt=Ga,Ae=Je}if(nt.done)return u(q,Ae),We&&vr(q,ze),Re;if(Ae===null){for(;!nt.done;ze++,nt=V.next())nt=te(q,nt.value,ee),nt!==null&&(B=w(nt,B,ze),tt===null?Re=nt:tt.sibling=nt,tt=nt);return We&&vr(q,ze),Re}for(Ae=f(Ae);!nt.done;ze++,nt=V.next())nt=W(Ae,q,ze,nt.value,ee),nt!==null&&(r&&nt.alternate!==null&&Ae.delete(nt.key===null?ze:nt.key),B=w(nt,B,ze),tt===null?Re=nt:tt.sibling=nt,tt=nt);return r&&Ae.forEach(function(nD){return o(q,nD)}),We&&vr(q,ze),Re}function pt(q,B,V,ee){if(typeof V=="object"&&V!==null&&V.type===E&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case S:e:{for(var Re=V.key;B!==null;){if(B.key===Re){if(Re=V.type,Re===E){if(B.tag===7){u(q,B.sibling),ee=x(B,V.props.children),ee.return=q,q=ee;break e}}else if(B.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===X&&Go(Re)===B.type){u(q,B.sibling),ee=x(B,V.props),dh(ee,V),ee.return=q,q=ee;break e}u(q,B);break}else o(q,B);B=B.sibling}V.type===E?(ee=Fo(V.props.children,q.mode,ee,V.key),ee.return=q,q=ee):(ee=wm(V.type,V.key,V.props,null,q.mode,ee),dh(ee,V),ee.return=q,q=ee)}return T(q);case A:e:{for(Re=V.key;B!==null;){if(B.key===Re)if(B.tag===4&&B.stateNode.containerInfo===V.containerInfo&&B.stateNode.implementation===V.implementation){u(q,B.sibling),ee=x(B,V.children||[]),ee.return=q,q=ee;break e}else{u(q,B);break}else o(q,B);B=B.sibling}ee=Jv(V,q.mode,ee),ee.return=q,q=ee}return T(q);case X:return V=Go(V),pt(q,B,V,ee)}if(Se(V))return _e(q,B,V,ee);if(pe(V)){if(Re=pe(V),typeof Re!="function")throw Error(n(150));return V=Re.call(V),ke(q,B,V,ee)}if(typeof V.then=="function")return pt(q,B,Rm(V),ee);if(V.$$typeof===P)return pt(q,B,Em(q,V),ee);km(q,V)}return typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint"?(V=""+V,B!==null&&B.tag===6?(u(q,B.sibling),ee=x(B,V),ee.return=q,q=ee):(u(q,B),ee=Xv(V,q.mode,ee),ee.return=q,q=ee),T(q)):u(q,B)}return function(q,B,V,ee){try{uh=0;var Re=pt(q,B,V,ee);return Hc=null,Re}catch(Ae){if(Ae===zc||Ae===Cm)throw Ae;var tt=ys(29,Ae,null,q.mode);return tt.lanes=ee,tt.return=q,tt}finally{}}}var Vo=qS(!0),VS=qS(!1),Ta=!1;function ly(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function cy(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ca(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Na(r,o,u){var f=r.updateQueue;if(f===null)return null;if(f=f.shared,(rt&2)!==0){var x=f.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),f.pending=o,o=xm(r),NS(r,null,u),o}return _m(r,f,o,u),xm(r)}function hh(r,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,Ow(r,u)}}function uy(r,o){var u=r.updateQueue,f=r.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var x=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var T={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};w===null?x=w=T:w=w.next=T,u=u.next}while(u!==null);w===null?x=w=o:w=w.next=o}else x=w=o;u={baseState:f.baseState,firstBaseUpdate:x,lastBaseUpdate:w,shared:f.shared,callbacks:f.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=o:r.next=o,u.lastBaseUpdate=o}var dy=!1;function fh(){if(dy){var r=jc;if(r!==null)throw r}}function ph(r,o,u,f){dy=!1;var x=r.updateQueue;Ta=!1;var w=x.firstBaseUpdate,T=x.lastBaseUpdate,I=x.shared.pending;if(I!==null){x.shared.pending=null;var O=I,$=O.next;O.next=null,T===null?w=$:T.next=$,T=O;var Z=r.alternate;Z!==null&&(Z=Z.updateQueue,I=Z.lastBaseUpdate,I!==T&&(I===null?Z.firstBaseUpdate=$:I.next=$,Z.lastBaseUpdate=O))}if(w!==null){var te=x.baseState;T=0,Z=$=O=null,I=w;do{var K=I.lane&-536870913,W=K!==I.lane;if(W?(Xe&K)===K:(f&K)===K){K!==0&&K===Fc&&(dy=!0),Z!==null&&(Z=Z.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var _e=r,ke=I;K=o;var pt=u;switch(ke.tag){case 1:if(_e=ke.payload,typeof _e=="function"){te=_e.call(pt,te,K);break e}te=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=ke.payload,K=typeof _e=="function"?_e.call(pt,te,K):_e,K==null)break e;te=y({},te,K);break e;case 2:Ta=!0}}K=I.callback,K!==null&&(r.flags|=64,W&&(r.flags|=8192),W=x.callbacks,W===null?x.callbacks=[K]:W.push(K))}else W={lane:K,tag:I.tag,payload:I.payload,callback:I.callback,next:null},Z===null?($=Z=W,O=te):Z=Z.next=W,T|=K;if(I=I.next,I===null){if(I=x.shared.pending,I===null)break;W=I,I=W.next,W.next=null,x.lastBaseUpdate=W,x.shared.pending=null}}while(!0);Z===null&&(O=te),x.baseState=O,x.firstBaseUpdate=$,x.lastBaseUpdate=Z,w===null&&(x.shared.lanes=0),Da|=T,r.lanes=T,r.memoizedState=te}}function $S(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function YS(r,o){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)$S(u[r],o)}var Bc=U(null),Mm=U(0);function KS(r,o){r=Nr,re(Mm,r),re(Bc,o),Nr=r|o.baseLanes}function hy(){re(Mm,Nr),re(Bc,Bc.current)}function fy(){Nr=Mm.current,Q(Bc),Q(Mm)}var bs=U(null),Ws=null;function Ra(r){var o=r.alternate;re(Ut,Ut.current&1),re(bs,r),Ws===null&&(o===null||Bc.current!==null||o.memoizedState!==null)&&(Ws=r)}function py(r){re(Ut,Ut.current),re(bs,r),Ws===null&&(Ws=r)}function XS(r){r.tag===22?(re(Ut,Ut.current),re(bs,r),Ws===null&&(Ws=r)):ka()}function ka(){re(Ut,Ut.current),re(bs,bs.current)}function _s(r){Q(bs),Ws===r&&(Ws=null),Q(Ut)}var Ut=U(0);function Im(r){for(var o=r;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||_b(u)||xb(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var _r=0,Fe=null,ht=null,qt=null,Dm=!1,Gc=!1,$o=!1,Pm=0,mh=0,qc=null,$M=0;function Dt(){throw Error(n(321))}function my(r,o){if(o===null)return!1;for(var u=0;u<o.length&&u<r.length;u++)if(!vs(r[u],o[u]))return!1;return!0}function gy(r,o,u,f,x,w){return _r=w,Fe=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,j.H=r===null||r.memoizedState===null?IA:My,$o=!1,w=u(f,x),$o=!1,Gc&&(w=WS(o,u,f,x)),JS(r),w}function JS(r){j.H=yh;var o=ht!==null&&ht.next!==null;if(_r=0,qt=ht=Fe=null,Dm=!1,mh=0,qc=null,o)throw Error(n(300));r===null||Vt||(r=r.dependencies,r!==null&&Am(r)&&(Vt=!0))}function WS(r,o,u,f){Fe=r;var x=0;do{if(Gc&&(qc=null),mh=0,Gc=!1,25<=x)throw Error(n(301));if(x+=1,qt=ht=null,r.updateQueue!=null){var w=r.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}j.H=DA,w=o(u,f)}while(Gc);return w}function YM(){var r=j.H,o=r.useState()[0];return o=typeof o.then=="function"?gh(o):o,r=r.useState()[0],(ht!==null?ht.memoizedState:null)!==r&&(Fe.flags|=1024),o}function vy(){var r=Pm!==0;return Pm=0,r}function yy(r,o,u){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~u}function by(r){if(Dm){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Dm=!1}_r=0,qt=ht=Fe=null,Gc=!1,mh=Pm=0,qc=null}function Hn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?Fe.memoizedState=qt=r:qt=qt.next=r,qt}function Ft(){if(ht===null){var r=Fe.alternate;r=r!==null?r.memoizedState:null}else r=ht.next;var o=qt===null?Fe.memoizedState:qt.next;if(o!==null)qt=o,ht=r;else{if(r===null)throw Fe.alternate===null?Error(n(467)):Error(n(310));ht=r,r={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},qt===null?Fe.memoizedState=qt=r:qt=qt.next=r}return qt}function Lm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function gh(r){var o=mh;return mh+=1,qc===null&&(qc=[]),r=HS(qc,r,o),o=Fe,(qt===null?o.memoizedState:qt.next)===null&&(o=o.alternate,j.H=o===null||o.memoizedState===null?IA:My),r}function Om(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return gh(r);if(r.$$typeof===P)return gn(r)}throw Error(n(438,String(r)))}function _y(r){var o=null,u=Fe.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var f=Fe.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(x){return x.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Lm(),Fe.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(r),f=0;f<r;f++)u[f]=J;return o.index++,u}function xr(r,o){return typeof o=="function"?o(r):o}function Um(r){var o=Ft();return xy(o,ht,r)}function xy(r,o,u){var f=r.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=u;var x=r.baseQueue,w=f.pending;if(w!==null){if(x!==null){var T=x.next;x.next=w.next,w.next=T}o.baseQueue=x=w,f.pending=null}if(w=r.baseState,x===null)r.memoizedState=w;else{o=x.next;var I=T=null,O=null,$=o,Z=!1;do{var te=$.lane&-536870913;if(te!==$.lane?(Xe&te)===te:(_r&te)===te){var K=$.revertLane;if(K===0)O!==null&&(O=O.next={lane:0,revertLane:0,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),te===Fc&&(Z=!0);else if((_r&K)===K){$=$.next,K===Fc&&(Z=!0);continue}else te={lane:0,revertLane:$.revertLane,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},O===null?(I=O=te,T=w):O=O.next=te,Fe.lanes|=K,Da|=K;te=$.action,$o&&u(w,te),w=$.hasEagerState?$.eagerState:u(w,te)}else K={lane:te,revertLane:$.revertLane,gesture:$.gesture,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},O===null?(I=O=K,T=w):O=O.next=K,Fe.lanes|=te,Da|=te;$=$.next}while($!==null&&$!==o);if(O===null?T=w:O.next=I,!vs(w,r.memoizedState)&&(Vt=!0,Z&&(u=jc,u!==null)))throw u;r.memoizedState=w,r.baseState=T,r.baseQueue=O,f.lastRenderedState=w}return x===null&&(f.lanes=0),[r.memoizedState,f.dispatch]}function wy(r){var o=Ft(),u=o.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=r;var f=u.dispatch,x=u.pending,w=o.memoizedState;if(x!==null){u.pending=null;var T=x=x.next;do w=r(w,T.action),T=T.next;while(T!==x);vs(w,o.memoizedState)||(Vt=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),u.lastRenderedState=w}return[w,f]}function QS(r,o,u){var f=Fe,x=Ft(),w=We;if(w){if(u===void 0)throw Error(n(407));u=u()}else u=o();var T=!vs((ht||x).memoizedState,u);if(T&&(x.memoizedState=u,Vt=!0),x=x.queue,Ey(tA.bind(null,f,x,r),[r]),x.getSnapshot!==o||T||qt!==null&&qt.memoizedState.tag&1){if(f.flags|=2048,Vc(9,{destroy:void 0},eA.bind(null,f,x,u,o),null),vt===null)throw Error(n(349));w||(_r&127)!==0||ZS(f,o,u)}return u}function ZS(r,o,u){r.flags|=16384,r={getSnapshot:o,value:u},o=Fe.updateQueue,o===null?(o=Lm(),Fe.updateQueue=o,o.stores=[r]):(u=o.stores,u===null?o.stores=[r]:u.push(r))}function eA(r,o,u,f){o.value=u,o.getSnapshot=f,nA(o)&&sA(r)}function tA(r,o,u){return u(function(){nA(o)&&sA(r)})}function nA(r){var o=r.getSnapshot;r=r.value;try{var u=o();return!vs(r,u)}catch{return!0}}function sA(r){var o=Uo(r,2);o!==null&&os(o,r,2)}function Sy(r){var o=Hn();if(typeof r=="function"){var u=r;if(r=u(),$o){ba(!0);try{u()}finally{ba(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xr,lastRenderedState:r},o}function iA(r,o,u,f){return r.baseState=u,xy(r,ht,typeof f=="function"?f:xr)}function KM(r,o,u,f,x){if(zm(r))throw Error(n(485));if(r=o.action,r!==null){var w={payload:x,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){w.listeners.push(T)}};j.T!==null?u(!0):w.isTransition=!1,f(w),u=o.pending,u===null?(w.next=o.pending=w,rA(o,w)):(w.next=u.next,o.pending=u.next=w)}}function rA(r,o){var u=o.action,f=o.payload,x=r.state;if(o.isTransition){var w=j.T,T={};j.T=T;try{var I=u(x,f),O=j.S;O!==null&&O(T,I),aA(r,o,I)}catch($){Ay(r,o,$)}finally{w!==null&&T.types!==null&&(w.types=T.types),j.T=w}}else try{w=u(x,f),aA(r,o,w)}catch($){Ay(r,o,$)}}function aA(r,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){oA(r,o,f)},function(f){return Ay(r,o,f)}):oA(r,o,u)}function oA(r,o,u){o.status="fulfilled",o.value=u,lA(o),r.state=u,o=r.pending,o!==null&&(u=o.next,u===o?r.pending=null:(u=u.next,o.next=u,rA(r,u)))}function Ay(r,o,u){var f=r.pending;if(r.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=u,lA(o),o=o.next;while(o!==f)}r.action=null}function lA(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function cA(r,o){return o}function uA(r,o){if(We){var u=vt.formState;if(u!==null){e:{var f=Fe;if(We){if(wt){t:{for(var x=wt,w=Js;x.nodeType!==8;){if(!w){x=null;break t}if(x=Qs(x.nextSibling),x===null){x=null;break t}}w=x.data,x=w==="F!"||w==="F"?x:null}if(x){wt=Qs(x.nextSibling),f=x.data==="F!";break e}}Aa(f)}f=!1}f&&(o=u[0])}}return u=Hn(),u.memoizedState=u.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:cA,lastRenderedState:o},u.queue=f,u=RA.bind(null,Fe,f),f.dispatch=u,f=Sy(!1),w=ky.bind(null,Fe,!1,f.queue),f=Hn(),x={state:o,dispatch:null,action:r,pending:null},f.queue=x,u=KM.bind(null,Fe,x,w,u),x.dispatch=u,f.memoizedState=r,[o,u,!1]}function dA(r){var o=Ft();return hA(o,ht,r)}function hA(r,o,u){if(o=xy(r,o,cA)[0],r=Um(xr)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=gh(o)}catch(T){throw T===zc?Cm:T}else f=o;o=Ft();var x=o.queue,w=x.dispatch;return u!==o.memoizedState&&(Fe.flags|=2048,Vc(9,{destroy:void 0},XM.bind(null,x,u),null)),[f,w,r]}function XM(r,o){r.action=o}function fA(r){var o=Ft(),u=ht;if(u!==null)return hA(o,u,r);Ft(),o=o.memoizedState,u=Ft();var f=u.queue.dispatch;return u.memoizedState=r,[o,f,!1]}function Vc(r,o,u,f){return r={tag:r,create:u,deps:f,inst:o,next:null},o=Fe.updateQueue,o===null&&(o=Lm(),Fe.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=r.next=r:(f=u.next,u.next=r,r.next=f,o.lastEffect=r),r}function pA(){return Ft().memoizedState}function Fm(r,o,u,f){var x=Hn();Fe.flags|=r,x.memoizedState=Vc(1|o,{destroy:void 0},u,f===void 0?null:f)}function jm(r,o,u,f){var x=Ft();f=f===void 0?null:f;var w=x.memoizedState.inst;ht!==null&&f!==null&&my(f,ht.memoizedState.deps)?x.memoizedState=Vc(o,w,u,f):(Fe.flags|=r,x.memoizedState=Vc(1|o,w,u,f))}function mA(r,o){Fm(8390656,8,r,o)}function Ey(r,o){jm(2048,8,r,o)}function JM(r){Fe.flags|=4;var o=Fe.updateQueue;if(o===null)o=Lm(),Fe.updateQueue=o,o.events=[r];else{var u=o.events;u===null?o.events=[r]:u.push(r)}}function gA(r){var o=Ft().memoizedState;return JM({ref:o,nextImpl:r}),function(){if((rt&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function vA(r,o){return jm(4,2,r,o)}function yA(r,o){return jm(4,4,r,o)}function bA(r,o){if(typeof o=="function"){r=r();var u=o(r);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function _A(r,o,u){u=u!=null?u.concat([r]):null,jm(4,4,bA.bind(null,o,r),u)}function Ty(){}function xA(r,o){var u=Ft();o=o===void 0?null:o;var f=u.memoizedState;return o!==null&&my(o,f[1])?f[0]:(u.memoizedState=[r,o],r)}function wA(r,o){var u=Ft();o=o===void 0?null:o;var f=u.memoizedState;if(o!==null&&my(o,f[1]))return f[0];if(f=r(),$o){ba(!0);try{r()}finally{ba(!1)}}return u.memoizedState=[f,o],f}function Cy(r,o,u){return u===void 0||(_r&1073741824)!==0&&(Xe&261930)===0?r.memoizedState=o:(r.memoizedState=u,r=SE(),Fe.lanes|=r,Da|=r,u)}function SA(r,o,u,f){return vs(u,o)?u:Bc.current!==null?(r=Cy(r,u,f),vs(r,o)||(Vt=!0),r):(_r&42)===0||(_r&1073741824)!==0&&(Xe&261930)===0?(Vt=!0,r.memoizedState=u):(r=SE(),Fe.lanes|=r,Da|=r,o)}function AA(r,o,u,f,x){var w=G.p;G.p=w!==0&&8>w?w:8;var T=j.T,I={};j.T=I,ky(r,!1,o,u);try{var O=x(),$=j.S;if($!==null&&$(I,O),O!==null&&typeof O=="object"&&typeof O.then=="function"){var Z=VM(O,f);vh(r,o,Z,Ss(r))}else vh(r,o,f,Ss(r))}catch(te){vh(r,o,{then:function(){},status:"rejected",reason:te},Ss())}finally{G.p=w,T!==null&&I.types!==null&&(T.types=I.types),j.T=T}}function WM(){}function Ny(r,o,u,f){if(r.tag!==5)throw Error(n(476));var x=EA(r).queue;AA(r,x,o,ae,u===null?WM:function(){return TA(r),u(f)})}function EA(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xr,lastRenderedState:ae},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xr,lastRenderedState:u},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function TA(r){var o=EA(r);o.next===null&&(o=r.alternate.memoizedState),vh(r,o.next.queue,{},Ss())}function Ry(){return gn(Ph)}function CA(){return Ft().memoizedState}function NA(){return Ft().memoizedState}function QM(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var u=Ss();r=Ca(u);var f=Na(o,r,u);f!==null&&(os(f,o,u),hh(f,o,u)),o={cache:iy()},r.payload=o;return}o=o.return}}function ZM(r,o,u){var f=Ss();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},zm(r)?kA(o,u):(u=Yv(r,o,u,f),u!==null&&(os(u,r,f),MA(u,o,f)))}function RA(r,o,u){var f=Ss();vh(r,o,u,f)}function vh(r,o,u,f){var x={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(zm(r))kA(o,x);else{var w=r.alternate;if(r.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var T=o.lastRenderedState,I=w(T,u);if(x.hasEagerState=!0,x.eagerState=I,vs(I,T))return _m(r,o,x,0),vt===null&&bm(),!1}catch{}finally{}if(u=Yv(r,o,x,f),u!==null)return os(u,r,f),MA(u,o,f),!0}return!1}function ky(r,o,u,f){if(f={lane:2,revertLane:lb(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},zm(r)){if(o)throw Error(n(479))}else o=Yv(r,u,f,2),o!==null&&os(o,r,2)}function zm(r){var o=r.alternate;return r===Fe||o!==null&&o===Fe}function kA(r,o){Gc=Dm=!0;var u=r.pending;u===null?o.next=o:(o.next=u.next,u.next=o),r.pending=o}function MA(r,o,u){if((u&4194048)!==0){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,Ow(r,u)}}var yh={readContext:gn,use:Om,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useLayoutEffect:Dt,useInsertionEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useSyncExternalStore:Dt,useId:Dt,useHostTransitionStatus:Dt,useFormState:Dt,useActionState:Dt,useOptimistic:Dt,useMemoCache:Dt,useCacheRefresh:Dt};yh.useEffectEvent=Dt;var IA={readContext:gn,use:Om,useCallback:function(r,o){return Hn().memoizedState=[r,o===void 0?null:o],r},useContext:gn,useEffect:mA,useImperativeHandle:function(r,o,u){u=u!=null?u.concat([r]):null,Fm(4194308,4,bA.bind(null,o,r),u)},useLayoutEffect:function(r,o){return Fm(4194308,4,r,o)},useInsertionEffect:function(r,o){Fm(4,2,r,o)},useMemo:function(r,o){var u=Hn();o=o===void 0?null:o;var f=r();if($o){ba(!0);try{r()}finally{ba(!1)}}return u.memoizedState=[f,o],f},useReducer:function(r,o,u){var f=Hn();if(u!==void 0){var x=u(o);if($o){ba(!0);try{u(o)}finally{ba(!1)}}}else x=o;return f.memoizedState=f.baseState=x,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:x},f.queue=r,r=r.dispatch=ZM.bind(null,Fe,r),[f.memoizedState,r]},useRef:function(r){var o=Hn();return r={current:r},o.memoizedState=r},useState:function(r){r=Sy(r);var o=r.queue,u=RA.bind(null,Fe,o);return o.dispatch=u,[r.memoizedState,u]},useDebugValue:Ty,useDeferredValue:function(r,o){var u=Hn();return Cy(u,r,o)},useTransition:function(){var r=Sy(!1);return r=AA.bind(null,Fe,r.queue,!0,!1),Hn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,u){var f=Fe,x=Hn();if(We){if(u===void 0)throw Error(n(407));u=u()}else{if(u=o(),vt===null)throw Error(n(349));(Xe&127)!==0||ZS(f,o,u)}x.memoizedState=u;var w={value:u,getSnapshot:o};return x.queue=w,mA(tA.bind(null,f,w,r),[r]),f.flags|=2048,Vc(9,{destroy:void 0},eA.bind(null,f,w,u,o),null),u},useId:function(){var r=Hn(),o=vt.identifierPrefix;if(We){var u=Bi,f=Hi;u=(f&~(1<<32-gs(f)-1)).toString(32)+u,o="_"+o+"R_"+u,u=Pm++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=$M++,o="_"+o+"r_"+u.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:Ry,useFormState:uA,useActionState:uA,useOptimistic:function(r){var o=Hn();o.memoizedState=o.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=ky.bind(null,Fe,!0,u),u.dispatch=o,[r,o]},useMemoCache:_y,useCacheRefresh:function(){return Hn().memoizedState=QM.bind(null,Fe)},useEffectEvent:function(r){var o=Hn(),u={impl:r};return o.memoizedState=u,function(){if((rt&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},My={readContext:gn,use:Om,useCallback:xA,useContext:gn,useEffect:Ey,useImperativeHandle:_A,useInsertionEffect:vA,useLayoutEffect:yA,useMemo:wA,useReducer:Um,useRef:pA,useState:function(){return Um(xr)},useDebugValue:Ty,useDeferredValue:function(r,o){var u=Ft();return SA(u,ht.memoizedState,r,o)},useTransition:function(){var r=Um(xr)[0],o=Ft().memoizedState;return[typeof r=="boolean"?r:gh(r),o]},useSyncExternalStore:QS,useId:CA,useHostTransitionStatus:Ry,useFormState:dA,useActionState:dA,useOptimistic:function(r,o){var u=Ft();return iA(u,ht,r,o)},useMemoCache:_y,useCacheRefresh:NA};My.useEffectEvent=gA;var DA={readContext:gn,use:Om,useCallback:xA,useContext:gn,useEffect:Ey,useImperativeHandle:_A,useInsertionEffect:vA,useLayoutEffect:yA,useMemo:wA,useReducer:wy,useRef:pA,useState:function(){return wy(xr)},useDebugValue:Ty,useDeferredValue:function(r,o){var u=Ft();return ht===null?Cy(u,r,o):SA(u,ht.memoizedState,r,o)},useTransition:function(){var r=wy(xr)[0],o=Ft().memoizedState;return[typeof r=="boolean"?r:gh(r),o]},useSyncExternalStore:QS,useId:CA,useHostTransitionStatus:Ry,useFormState:fA,useActionState:fA,useOptimistic:function(r,o){var u=Ft();return ht!==null?iA(u,ht,r,o):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:_y,useCacheRefresh:NA};DA.useEffectEvent=gA;function Iy(r,o,u,f){o=r.memoizedState,u=u(f,o),u=u==null?o:y({},o,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var Dy={enqueueSetState:function(r,o,u){r=r._reactInternals;var f=Ss(),x=Ca(f);x.payload=o,u!=null&&(x.callback=u),o=Na(r,x,f),o!==null&&(os(o,r,f),hh(o,r,f))},enqueueReplaceState:function(r,o,u){r=r._reactInternals;var f=Ss(),x=Ca(f);x.tag=1,x.payload=o,u!=null&&(x.callback=u),o=Na(r,x,f),o!==null&&(os(o,r,f),hh(o,r,f))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var u=Ss(),f=Ca(u);f.tag=2,o!=null&&(f.callback=o),o=Na(r,f,u),o!==null&&(os(o,r,u),hh(o,r,u))}};function PA(r,o,u,f,x,w,T){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(f,w,T):o.prototype&&o.prototype.isPureReactComponent?!ih(u,f)||!ih(x,w):!0}function LA(r,o,u,f){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,f),o.state!==r&&Dy.enqueueReplaceState(o,o.state,null)}function Yo(r,o){var u=o;if("ref"in o){u={};for(var f in o)f!=="ref"&&(u[f]=o[f])}if(r=r.defaultProps){u===o&&(u=y({},u));for(var x in r)u[x]===void 0&&(u[x]=r[x])}return u}function OA(r){ym(r)}function UA(r){console.error(r)}function FA(r){ym(r)}function Hm(r,o){try{var u=r.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function jA(r,o,u){try{var f=r.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Py(r,o,u){return u=Ca(u),u.tag=3,u.payload={element:null},u.callback=function(){Hm(r,o)},u}function zA(r){return r=Ca(r),r.tag=3,r}function HA(r,o,u,f){var x=u.type.getDerivedStateFromError;if(typeof x=="function"){var w=f.value;r.payload=function(){return x(w)},r.callback=function(){jA(o,u,f)}}var T=u.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(r.callback=function(){jA(o,u,f),typeof x!="function"&&(Pa===null?Pa=new Set([this]):Pa.add(this));var I=f.stack;this.componentDidCatch(f.value,{componentStack:I!==null?I:""})})}function eI(r,o,u,f,x){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=u.alternate,o!==null&&Uc(o,u,x,!0),u=bs.current,u!==null){switch(u.tag){case 31:case 13:return Ws===null?Zm():u.alternate===null&&Pt===0&&(Pt=3),u.flags&=-257,u.flags|=65536,u.lanes=x,f===Nm?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([f]):o.add(f),rb(r,f,x)),!1;case 22:return u.flags|=65536,f===Nm?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([f]):u.add(f)),rb(r,f,x)),!1}throw Error(n(435,u.tag))}return rb(r,f,x),Zm(),!1}if(We)return o=bs.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=x,f!==Zv&&(r=Error(n(422),{cause:f}),oh(Ys(r,u)))):(f!==Zv&&(o=Error(n(423),{cause:f}),oh(Ys(o,u))),r=r.current.alternate,r.flags|=65536,x&=-x,r.lanes|=x,f=Ys(f,u),x=Py(r.stateNode,f,x),uy(r,x),Pt!==4&&(Pt=2)),!1;var w=Error(n(520),{cause:f});if(w=Ys(w,u),Th===null?Th=[w]:Th.push(w),Pt!==4&&(Pt=2),o===null)return!0;f=Ys(f,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,r=x&-x,u.lanes|=r,r=Py(u.stateNode,f,r),uy(u,r),!1;case 1:if(o=u.type,w=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Pa===null||!Pa.has(w))))return u.flags|=65536,x&=-x,u.lanes|=x,x=zA(x),HA(x,r,u,f),uy(u,x),!1}u=u.return}while(u!==null);return!1}var Ly=Error(n(461)),Vt=!1;function vn(r,o,u,f){o.child=r===null?VS(o,null,u,f):Vo(o,r.child,u,f)}function BA(r,o,u,f,x){u=u.render;var w=o.ref;if("ref"in f){var T={};for(var I in f)I!=="ref"&&(T[I]=f[I])}else T=f;return Ho(o),f=gy(r,o,u,T,w,x),I=vy(),r!==null&&!Vt?(yy(r,o,x),wr(r,o,x)):(We&&I&&Wv(o),o.flags|=1,vn(r,o,f,x),o.child)}function GA(r,o,u,f,x){if(r===null){var w=u.type;return typeof w=="function"&&!Kv(w)&&w.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=w,qA(r,o,w,f,x)):(r=wm(u.type,null,f,o,o.mode,x),r.ref=o.ref,r.return=o,o.child=r)}if(w=r.child,!Gy(r,x)){var T=w.memoizedProps;if(u=u.compare,u=u!==null?u:ih,u(T,f)&&r.ref===o.ref)return wr(r,o,x)}return o.flags|=1,r=gr(w,f),r.ref=o.ref,r.return=o,o.child=r}function qA(r,o,u,f,x){if(r!==null){var w=r.memoizedProps;if(ih(w,f)&&r.ref===o.ref)if(Vt=!1,o.pendingProps=f=w,Gy(r,x))(r.flags&131072)!==0&&(Vt=!0);else return o.lanes=r.lanes,wr(r,o,x)}return Oy(r,o,u,f,x)}function VA(r,o,u,f){var x=f.children,w=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((o.flags&128)!==0){if(w=w!==null?w.baseLanes|u:u,r!==null){for(f=o.child=r.child,x=0;f!==null;)x=x|f.lanes|f.childLanes,f=f.sibling;f=x&~w}else f=0,o.child=null;return $A(r,o,w,u,f)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Tm(o,w!==null?w.cachePool:null),w!==null?KS(o,w):hy(),XS(o);else return f=o.lanes=536870912,$A(r,o,w!==null?w.baseLanes|u:u,u,f)}else w!==null?(Tm(o,w.cachePool),KS(o,w),ka(),o.memoizedState=null):(r!==null&&Tm(o,null),hy(),ka());return vn(r,o,x,u),o.child}function bh(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function $A(r,o,u,f,x){var w=ay();return w=w===null?null:{parent:Gt._currentValue,pool:w},o.memoizedState={baseLanes:u,cachePool:w},r!==null&&Tm(o,null),hy(),XS(o),r!==null&&Uc(r,o,f,!0),o.childLanes=x,null}function Bm(r,o){return o=qm({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function YA(r,o,u){return Vo(o,r.child,null,u),r=Bm(o,o.pendingProps),r.flags|=2,_s(o),o.memoizedState=null,r}function tI(r,o,u){var f=o.pendingProps,x=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(We){if(f.mode==="hidden")return r=Bm(o,f),o.lanes=536870912,bh(null,r);if(py(o),(r=wt)?(r=r1(r,Js),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:wa!==null?{id:Hi,overflow:Bi}:null,retryLane:536870912,hydrationErrors:null},u=kS(r),u.return=o,o.child=u,mn=o,wt=null)):r=null,r===null)throw Aa(o);return o.lanes=536870912,null}return Bm(o,f)}var w=r.memoizedState;if(w!==null){var T=w.dehydrated;if(py(o),x)if(o.flags&256)o.flags&=-257,o=YA(r,o,u);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(n(558));else if(Vt||Uc(r,o,u,!1),x=(u&r.childLanes)!==0,Vt||x){if(f=vt,f!==null&&(T=Uw(f,u),T!==0&&T!==w.retryLane))throw w.retryLane=T,Uo(r,T),os(f,r,T),Ly;Zm(),o=YA(r,o,u)}else r=w.treeContext,wt=Qs(T.nextSibling),mn=o,We=!0,Sa=null,Js=!1,r!==null&&DS(o,r),o=Bm(o,f),o.flags|=4096;return o}return r=gr(r.child,{mode:f.mode,children:f.children}),r.ref=o.ref,o.child=r,r.return=o,r}function Gm(r,o){var u=o.ref;if(u===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(r===null||r.ref!==u)&&(o.flags|=4194816)}}function Oy(r,o,u,f,x){return Ho(o),u=gy(r,o,u,f,void 0,x),f=vy(),r!==null&&!Vt?(yy(r,o,x),wr(r,o,x)):(We&&f&&Wv(o),o.flags|=1,vn(r,o,u,x),o.child)}function KA(r,o,u,f,x,w){return Ho(o),o.updateQueue=null,u=WS(o,f,u,x),JS(r),f=vy(),r!==null&&!Vt?(yy(r,o,w),wr(r,o,w)):(We&&f&&Wv(o),o.flags|=1,vn(r,o,u,w),o.child)}function XA(r,o,u,f,x){if(Ho(o),o.stateNode===null){var w=Dc,T=u.contextType;typeof T=="object"&&T!==null&&(w=gn(T)),w=new u(f,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=Dy,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=f,w.state=o.memoizedState,w.refs={},ly(o),T=u.contextType,w.context=typeof T=="object"&&T!==null?gn(T):Dc,w.state=o.memoizedState,T=u.getDerivedStateFromProps,typeof T=="function"&&(Iy(o,u,T,f),w.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(T=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),T!==w.state&&Dy.enqueueReplaceState(w,w.state,null),ph(o,f,w,x),fh(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(r===null){w=o.stateNode;var I=o.memoizedProps,O=Yo(u,I);w.props=O;var $=w.context,Z=u.contextType;T=Dc,typeof Z=="object"&&Z!==null&&(T=gn(Z));var te=u.getDerivedStateFromProps;Z=typeof te=="function"||typeof w.getSnapshotBeforeUpdate=="function",I=o.pendingProps!==I,Z||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(I||$!==T)&&LA(o,w,f,T),Ta=!1;var K=o.memoizedState;w.state=K,ph(o,f,w,x),fh(),$=o.memoizedState,I||K!==$||Ta?(typeof te=="function"&&(Iy(o,u,te,f),$=o.memoizedState),(O=Ta||PA(o,u,O,f,K,$,T))?(Z||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=$),w.props=f,w.state=$,w.context=T,f=O):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{w=o.stateNode,cy(r,o),T=o.memoizedProps,Z=Yo(u,T),w.props=Z,te=o.pendingProps,K=w.context,$=u.contextType,O=Dc,typeof $=="object"&&$!==null&&(O=gn($)),I=u.getDerivedStateFromProps,($=typeof I=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(T!==te||K!==O)&&LA(o,w,f,O),Ta=!1,K=o.memoizedState,w.state=K,ph(o,f,w,x),fh();var W=o.memoizedState;T!==te||K!==W||Ta||r!==null&&r.dependencies!==null&&Am(r.dependencies)?(typeof I=="function"&&(Iy(o,u,I,f),W=o.memoizedState),(Z=Ta||PA(o,u,Z,f,K,W,O)||r!==null&&r.dependencies!==null&&Am(r.dependencies))?($||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(f,W,O),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(f,W,O)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||T===r.memoizedProps&&K===r.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&K===r.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=W),w.props=f,w.state=W,w.context=O,f=Z):(typeof w.componentDidUpdate!="function"||T===r.memoizedProps&&K===r.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&K===r.memoizedState||(o.flags|=1024),f=!1)}return w=f,Gm(r,o),f=(o.flags&128)!==0,w||f?(w=o.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,r!==null&&f?(o.child=Vo(o,r.child,null,x),o.child=Vo(o,null,u,x)):vn(r,o,u,x),o.memoizedState=w.state,r=o.child):r=wr(r,o,x),r}function JA(r,o,u,f){return jo(),o.flags|=256,vn(r,o,u,f),o.child}var Uy={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Fy(r){return{baseLanes:r,cachePool:jS()}}function jy(r,o,u){return r=r!==null?r.childLanes&~u:0,o&&(r|=ws),r}function WA(r,o,u){var f=o.pendingProps,x=!1,w=(o.flags&128)!==0,T;if((T=w)||(T=r!==null&&r.memoizedState===null?!1:(Ut.current&2)!==0),T&&(x=!0,o.flags&=-129),T=(o.flags&32)!==0,o.flags&=-33,r===null){if(We){if(x?Ra(o):ka(),(r=wt)?(r=r1(r,Js),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:wa!==null?{id:Hi,overflow:Bi}:null,retryLane:536870912,hydrationErrors:null},u=kS(r),u.return=o,o.child=u,mn=o,wt=null)):r=null,r===null)throw Aa(o);return xb(r)?o.lanes=32:o.lanes=536870912,null}var I=f.children;return f=f.fallback,x?(ka(),x=o.mode,I=qm({mode:"hidden",children:I},x),f=Fo(f,x,u,null),I.return=o,f.return=o,I.sibling=f,o.child=I,f=o.child,f.memoizedState=Fy(u),f.childLanes=jy(r,T,u),o.memoizedState=Uy,bh(null,f)):(Ra(o),zy(o,I))}var O=r.memoizedState;if(O!==null&&(I=O.dehydrated,I!==null)){if(w)o.flags&256?(Ra(o),o.flags&=-257,o=Hy(r,o,u)):o.memoizedState!==null?(ka(),o.child=r.child,o.flags|=128,o=null):(ka(),I=f.fallback,x=o.mode,f=qm({mode:"visible",children:f.children},x),I=Fo(I,x,u,null),I.flags|=2,f.return=o,I.return=o,f.sibling=I,o.child=f,Vo(o,r.child,null,u),f=o.child,f.memoizedState=Fy(u),f.childLanes=jy(r,T,u),o.memoizedState=Uy,o=bh(null,f));else if(Ra(o),xb(I)){if(T=I.nextSibling&&I.nextSibling.dataset,T)var $=T.dgst;T=$,f=Error(n(419)),f.stack="",f.digest=T,oh({value:f,source:null,stack:null}),o=Hy(r,o,u)}else if(Vt||Uc(r,o,u,!1),T=(u&r.childLanes)!==0,Vt||T){if(T=vt,T!==null&&(f=Uw(T,u),f!==0&&f!==O.retryLane))throw O.retryLane=f,Uo(r,f),os(T,r,f),Ly;_b(I)||Zm(),o=Hy(r,o,u)}else _b(I)?(o.flags|=192,o.child=r.child,o=null):(r=O.treeContext,wt=Qs(I.nextSibling),mn=o,We=!0,Sa=null,Js=!1,r!==null&&DS(o,r),o=zy(o,f.children),o.flags|=4096);return o}return x?(ka(),I=f.fallback,x=o.mode,O=r.child,$=O.sibling,f=gr(O,{mode:"hidden",children:f.children}),f.subtreeFlags=O.subtreeFlags&65011712,$!==null?I=gr($,I):(I=Fo(I,x,u,null),I.flags|=2),I.return=o,f.return=o,f.sibling=I,o.child=f,bh(null,f),f=o.child,I=r.child.memoizedState,I===null?I=Fy(u):(x=I.cachePool,x!==null?(O=Gt._currentValue,x=x.parent!==O?{parent:O,pool:O}:x):x=jS(),I={baseLanes:I.baseLanes|u,cachePool:x}),f.memoizedState=I,f.childLanes=jy(r,T,u),o.memoizedState=Uy,bh(r.child,f)):(Ra(o),u=r.child,r=u.sibling,u=gr(u,{mode:"visible",children:f.children}),u.return=o,u.sibling=null,r!==null&&(T=o.deletions,T===null?(o.deletions=[r],o.flags|=16):T.push(r)),o.child=u,o.memoizedState=null,u)}function zy(r,o){return o=qm({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function qm(r,o){return r=ys(22,r,null,o),r.lanes=0,r}function Hy(r,o,u){return Vo(o,r.child,null,u),r=zy(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function QA(r,o,u){r.lanes|=o;var f=r.alternate;f!==null&&(f.lanes|=o),ny(r.return,o,u)}function By(r,o,u,f,x,w){var T=r.memoizedState;T===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:x,treeForkCount:w}:(T.isBackwards=o,T.rendering=null,T.renderingStartTime=0,T.last=f,T.tail=u,T.tailMode=x,T.treeForkCount=w)}function ZA(r,o,u){var f=o.pendingProps,x=f.revealOrder,w=f.tail;f=f.children;var T=Ut.current,I=(T&2)!==0;if(I?(T=T&1|2,o.flags|=128):T&=1,re(Ut,T),vn(r,o,f,u),f=We?ah:0,!I&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&QA(r,u,o);else if(r.tag===19)QA(r,u,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(x){case"forwards":for(u=o.child,x=null;u!==null;)r=u.alternate,r!==null&&Im(r)===null&&(x=u),u=u.sibling;u=x,u===null?(x=o.child,o.child=null):(x=u.sibling,u.sibling=null),By(o,!1,x,u,w,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,x=o.child,o.child=null;x!==null;){if(r=x.alternate,r!==null&&Im(r)===null){o.child=x;break}r=x.sibling,x.sibling=u,u=x,x=r}By(o,!0,u,null,w,f);break;case"together":By(o,!1,null,null,void 0,f);break;default:o.memoizedState=null}return o.child}function wr(r,o,u){if(r!==null&&(o.dependencies=r.dependencies),Da|=o.lanes,(u&o.childLanes)===0)if(r!==null){if(Uc(r,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,u=gr(r,r.pendingProps),o.child=u,u.return=o;r.sibling!==null;)r=r.sibling,u=u.sibling=gr(r,r.pendingProps),u.return=o;u.sibling=null}return o.child}function Gy(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&Am(r)))}function nI(r,o,u){switch(o.tag){case 3:ot(o,o.stateNode.containerInfo),Ea(o,Gt,r.memoizedState.cache),jo();break;case 27:case 5:jn(o);break;case 4:ot(o,o.stateNode.containerInfo);break;case 10:Ea(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,py(o),null;break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(Ra(o),o.flags|=128,null):(u&o.child.childLanes)!==0?WA(r,o,u):(Ra(o),r=wr(r,o,u),r!==null?r.sibling:null);Ra(o);break;case 19:var x=(r.flags&128)!==0;if(f=(u&o.childLanes)!==0,f||(Uc(r,o,u,!1),f=(u&o.childLanes)!==0),x){if(f)return ZA(r,o,u);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),re(Ut,Ut.current),f)break;return null;case 22:return o.lanes=0,VA(r,o,u,o.pendingProps);case 24:Ea(o,Gt,r.memoizedState.cache)}return wr(r,o,u)}function eE(r,o,u){if(r!==null)if(r.memoizedProps!==o.pendingProps)Vt=!0;else{if(!Gy(r,u)&&(o.flags&128)===0)return Vt=!1,nI(r,o,u);Vt=(r.flags&131072)!==0}else Vt=!1,We&&(o.flags&1048576)!==0&&IS(o,ah,o.index);switch(o.lanes=0,o.tag){case 16:e:{var f=o.pendingProps;if(r=Go(o.elementType),o.type=r,typeof r=="function")Kv(r)?(f=Yo(r,f),o.tag=1,o=XA(null,o,r,f,u)):(o.tag=0,o=Oy(null,o,r,f,u));else{if(r!=null){var x=r.$$typeof;if(x===L){o.tag=11,o=BA(null,o,r,f,u);break e}else if(x===F){o.tag=14,o=GA(null,o,r,f,u);break e}}throw o=be(r)||r,Error(n(306,o,""))}}return o;case 0:return Oy(r,o,o.type,o.pendingProps,u);case 1:return f=o.type,x=Yo(f,o.pendingProps),XA(r,o,f,x,u);case 3:e:{if(ot(o,o.stateNode.containerInfo),r===null)throw Error(n(387));f=o.pendingProps;var w=o.memoizedState;x=w.element,cy(r,o),ph(o,f,null,u);var T=o.memoizedState;if(f=T.cache,Ea(o,Gt,f),f!==w.cache&&sy(o,[Gt],u,!0),fh(),f=T.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:T.cache},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){o=JA(r,o,f,u);break e}else if(f!==x){x=Ys(Error(n(424)),o),oh(x),o=JA(r,o,f,u);break e}else{switch(r=o.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(wt=Qs(r.firstChild),mn=o,We=!0,Sa=null,Js=!0,u=VS(o,null,f,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(jo(),f===x){o=wr(r,o,u);break e}vn(r,o,f,u)}o=o.child}return o;case 26:return Gm(r,o),r===null?(u=d1(o.type,null,o.pendingProps,null))?o.memoizedState=u:We||(u=o.type,r=o.pendingProps,f=ag(ge.current).createElement(u),f[pn]=o,f[ts]=r,yn(f,u,r),rn(f),o.stateNode=f):o.memoizedState=d1(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return jn(o),r===null&&We&&(f=o.stateNode=l1(o.type,o.pendingProps,ge.current),mn=o,Js=!0,x=wt,Fa(o.type)?(wb=x,wt=Qs(f.firstChild)):wt=x),vn(r,o,o.pendingProps.children,u),Gm(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&We&&((x=f=wt)&&(f=II(f,o.type,o.pendingProps,Js),f!==null?(o.stateNode=f,mn=o,wt=Qs(f.firstChild),Js=!1,x=!0):x=!1),x||Aa(o)),jn(o),x=o.type,w=o.pendingProps,T=r!==null?r.memoizedProps:null,f=w.children,vb(x,w)?f=null:T!==null&&vb(x,T)&&(o.flags|=32),o.memoizedState!==null&&(x=gy(r,o,YM,null,null,u),Ph._currentValue=x),Gm(r,o),vn(r,o,f,u),o.child;case 6:return r===null&&We&&((r=u=wt)&&(u=DI(u,o.pendingProps,Js),u!==null?(o.stateNode=u,mn=o,wt=null,r=!0):r=!1),r||Aa(o)),null;case 13:return WA(r,o,u);case 4:return ot(o,o.stateNode.containerInfo),f=o.pendingProps,r===null?o.child=Vo(o,null,f,u):vn(r,o,f,u),o.child;case 11:return BA(r,o,o.type,o.pendingProps,u);case 7:return vn(r,o,o.pendingProps,u),o.child;case 8:return vn(r,o,o.pendingProps.children,u),o.child;case 12:return vn(r,o,o.pendingProps.children,u),o.child;case 10:return f=o.pendingProps,Ea(o,o.type,f.value),vn(r,o,f.children,u),o.child;case 9:return x=o.type._context,f=o.pendingProps.children,Ho(o),x=gn(x),f=f(x),o.flags|=1,vn(r,o,f,u),o.child;case 14:return GA(r,o,o.type,o.pendingProps,u);case 15:return qA(r,o,o.type,o.pendingProps,u);case 19:return ZA(r,o,u);case 31:return tI(r,o,u);case 22:return VA(r,o,u,o.pendingProps);case 24:return Ho(o),f=gn(Gt),r===null?(x=ay(),x===null&&(x=vt,w=iy(),x.pooledCache=w,w.refCount++,w!==null&&(x.pooledCacheLanes|=u),x=w),o.memoizedState={parent:f,cache:x},ly(o),Ea(o,Gt,x)):((r.lanes&u)!==0&&(cy(r,o),ph(o,null,null,u),fh()),x=r.memoizedState,w=o.memoizedState,x.parent!==f?(x={parent:f,cache:f},o.memoizedState=x,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=x),Ea(o,Gt,f)):(f=w.cache,Ea(o,Gt,f),f!==x.cache&&sy(o,[Gt],u,!0))),vn(r,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function Sr(r){r.flags|=4}function qy(r,o,u,f,x){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(x&335544128)===x)if(r.stateNode.complete)r.flags|=8192;else if(CE())r.flags|=8192;else throw qo=Nm,oy}else r.flags&=-16777217}function tE(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!g1(o))if(CE())r.flags|=8192;else throw qo=Nm,oy}function Vm(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?Pw():536870912,r.lanes|=o,Xc|=o)}function _h(r,o){if(!We)switch(r.tailMode){case"hidden":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:f.sibling=null}}function St(r){var o=r.alternate!==null&&r.alternate.child===r.child,u=0,f=0;if(o)for(var x=r.child;x!==null;)u|=x.lanes|x.childLanes,f|=x.subtreeFlags&65011712,f|=x.flags&65011712,x.return=r,x=x.sibling;else for(x=r.child;x!==null;)u|=x.lanes|x.childLanes,f|=x.subtreeFlags,f|=x.flags,x.return=r,x=x.sibling;return r.subtreeFlags|=f,r.childLanes=u,o}function sI(r,o,u){var f=o.pendingProps;switch(Qv(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(o),null;case 1:return St(o),null;case 3:return u=o.stateNode,f=null,r!==null&&(f=r.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),br(Gt),Ze(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(Oc(o)?Sr(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,ey())),St(o),null;case 26:var x=o.type,w=o.memoizedState;return r===null?(Sr(o),w!==null?(St(o),tE(o,w)):(St(o),qy(o,x,null,f,u))):w?w!==r.memoizedState?(Sr(o),St(o),tE(o,w)):(St(o),o.flags&=-16777217):(r=r.memoizedProps,r!==f&&Sr(o),St(o),qy(o,x,r,f,u)),null;case 27:if(zi(o),u=ge.current,x=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&Sr(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return St(o),null}r=ne.current,Oc(o)?PS(o):(r=l1(x,f,u),o.stateNode=r,Sr(o))}return St(o),null;case 5:if(zi(o),x=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&Sr(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return St(o),null}if(w=ne.current,Oc(o))PS(o);else{var T=ag(ge.current);switch(w){case 1:w=T.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:w=T.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":w=T.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":w=T.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":w=T.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof f.is=="string"?T.createElement("select",{is:f.is}):T.createElement("select"),f.multiple?w.multiple=!0:f.size&&(w.size=f.size);break;default:w=typeof f.is=="string"?T.createElement(x,{is:f.is}):T.createElement(x)}}w[pn]=o,w[ts]=f;e:for(T=o.child;T!==null;){if(T.tag===5||T.tag===6)w.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===o)break e;for(;T.sibling===null;){if(T.return===null||T.return===o)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}o.stateNode=w;e:switch(yn(w,x,f),x){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Sr(o)}}return St(o),qy(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,u),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==f&&Sr(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(n(166));if(r=ge.current,Oc(o)){if(r=o.stateNode,u=o.memoizedProps,f=null,x=mn,x!==null)switch(x.tag){case 27:case 5:f=x.memoizedProps}r[pn]=o,r=!!(r.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||WE(r.nodeValue,u)),r||Aa(o,!0)}else r=ag(r).createTextNode(f),r[pn]=o,o.stateNode=r}return St(o),null;case 31:if(u=o.memoizedState,r===null||r.memoizedState!==null){if(f=Oc(o),u!==null){if(r===null){if(!f)throw Error(n(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[pn]=o}else jo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;St(o),r=!1}else u=ey(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return o.flags&256?(_s(o),o):(_s(o),null);if((o.flags&128)!==0)throw Error(n(558))}return St(o),null;case 13:if(f=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(x=Oc(o),f!==null&&f.dehydrated!==null){if(r===null){if(!x)throw Error(n(318));if(x=o.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(n(317));x[pn]=o}else jo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;St(o),x=!1}else x=ey(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=x),x=!0;if(!x)return o.flags&256?(_s(o),o):(_s(o),null)}return _s(o),(o.flags&128)!==0?(o.lanes=u,o):(u=f!==null,r=r!==null&&r.memoizedState!==null,u&&(f=o.child,x=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(x=f.alternate.memoizedState.cachePool.pool),w=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(w=f.memoizedState.cachePool.pool),w!==x&&(f.flags|=2048)),u!==r&&u&&(o.child.flags|=8192),Vm(o,o.updateQueue),St(o),null);case 4:return Ze(),r===null&&hb(o.stateNode.containerInfo),St(o),null;case 10:return br(o.type),St(o),null;case 19:if(Q(Ut),f=o.memoizedState,f===null)return St(o),null;if(x=(o.flags&128)!==0,w=f.rendering,w===null)if(x)_h(f,!1);else{if(Pt!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(w=Im(r),w!==null){for(o.flags|=128,_h(f,!1),r=w.updateQueue,o.updateQueue=r,Vm(o,r),o.subtreeFlags=0,r=u,u=o.child;u!==null;)RS(u,r),u=u.sibling;return re(Ut,Ut.current&1|2),We&&vr(o,f.treeForkCount),o.child}r=r.sibling}f.tail!==null&&oe()>Jm&&(o.flags|=128,x=!0,_h(f,!1),o.lanes=4194304)}else{if(!x)if(r=Im(w),r!==null){if(o.flags|=128,x=!0,r=r.updateQueue,o.updateQueue=r,Vm(o,r),_h(f,!0),f.tail===null&&f.tailMode==="hidden"&&!w.alternate&&!We)return St(o),null}else 2*oe()-f.renderingStartTime>Jm&&u!==536870912&&(o.flags|=128,x=!0,_h(f,!1),o.lanes=4194304);f.isBackwards?(w.sibling=o.child,o.child=w):(r=f.last,r!==null?r.sibling=w:o.child=w,f.last=w)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=oe(),r.sibling=null,u=Ut.current,re(Ut,x?u&1|2:u&1),We&&vr(o,f.treeForkCount),r):(St(o),null);case 22:case 23:return _s(o),fy(),f=o.memoizedState!==null,r!==null?r.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(u&536870912)!==0&&(o.flags&128)===0&&(St(o),o.subtreeFlags&6&&(o.flags|=8192)):St(o),u=o.updateQueue,u!==null&&Vm(o,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==u&&(o.flags|=2048),r!==null&&Q(Bo),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),br(Gt),St(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function iI(r,o){switch(Qv(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return br(Gt),Ze(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return zi(o),null;case 31:if(o.memoizedState!==null){if(_s(o),o.alternate===null)throw Error(n(340));jo()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(_s(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));jo()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return Q(Ut),null;case 4:return Ze(),null;case 10:return br(o.type),null;case 22:case 23:return _s(o),fy(),r!==null&&Q(Bo),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return br(Gt),null;case 25:return null;default:return null}}function nE(r,o){switch(Qv(o),o.tag){case 3:br(Gt),Ze();break;case 26:case 27:case 5:zi(o);break;case 4:Ze();break;case 31:o.memoizedState!==null&&_s(o);break;case 13:_s(o);break;case 19:Q(Ut);break;case 10:br(o.type);break;case 22:case 23:_s(o),fy(),r!==null&&Q(Bo);break;case 24:br(Gt)}}function xh(r,o){try{var u=o.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var x=f.next;u=x;do{if((u.tag&r)===r){f=void 0;var w=u.create,T=u.inst;f=w(),T.destroy=f}u=u.next}while(u!==x)}}catch(I){ct(o,o.return,I)}}function Ma(r,o,u){try{var f=o.updateQueue,x=f!==null?f.lastEffect:null;if(x!==null){var w=x.next;f=w;do{if((f.tag&r)===r){var T=f.inst,I=T.destroy;if(I!==void 0){T.destroy=void 0,x=o;var O=u,$=I;try{$()}catch(Z){ct(x,O,Z)}}}f=f.next}while(f!==w)}}catch(Z){ct(o,o.return,Z)}}function sE(r){var o=r.updateQueue;if(o!==null){var u=r.stateNode;try{YS(o,u)}catch(f){ct(r,r.return,f)}}}function iE(r,o,u){u.props=Yo(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(f){ct(r,o,f)}}function wh(r,o){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var f=r.stateNode;break;case 30:f=r.stateNode;break;default:f=r.stateNode}typeof u=="function"?r.refCleanup=u(f):u.current=f}}catch(x){ct(r,o,x)}}function Gi(r,o){var u=r.ref,f=r.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(x){ct(r,o,x)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(x){ct(r,o,x)}else u.current=null}function rE(r){var o=r.type,u=r.memoizedProps,f=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(x){ct(r,r.return,x)}}function Vy(r,o,u){try{var f=r.stateNode;TI(f,r.type,u,o),f[ts]=o}catch(x){ct(r,r.return,x)}}function aE(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Fa(r.type)||r.tag===4}function $y(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||aE(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Fa(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Yy(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(r),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=pr));else if(f!==4&&(f===27&&Fa(r.type)&&(u=r.stateNode,o=null),r=r.child,r!==null))for(Yy(r,o,u),r=r.sibling;r!==null;)Yy(r,o,u),r=r.sibling}function $m(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?u.insertBefore(r,o):u.appendChild(r);else if(f!==4&&(f===27&&Fa(r.type)&&(u=r.stateNode),r=r.child,r!==null))for($m(r,o,u),r=r.sibling;r!==null;)$m(r,o,u),r=r.sibling}function oE(r){var o=r.stateNode,u=r.memoizedProps;try{for(var f=r.type,x=o.attributes;x.length;)o.removeAttributeNode(x[0]);yn(o,f,u),o[pn]=r,o[ts]=u}catch(w){ct(r,r.return,w)}}var Ar=!1,$t=!1,Ky=!1,lE=typeof WeakSet=="function"?WeakSet:Set,an=null;function rI(r,o){if(r=r.containerInfo,mb=fg,r=_S(r),Hv(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var x=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var T=0,I=-1,O=-1,$=0,Z=0,te=r,K=null;t:for(;;){for(var W;te!==u||x!==0&&te.nodeType!==3||(I=T+x),te!==w||f!==0&&te.nodeType!==3||(O=T+f),te.nodeType===3&&(T+=te.nodeValue.length),(W=te.firstChild)!==null;)K=te,te=W;for(;;){if(te===r)break t;if(K===u&&++$===x&&(I=T),K===w&&++Z===f&&(O=T),(W=te.nextSibling)!==null)break;te=K,K=te.parentNode}te=W}u=I===-1||O===-1?null:{start:I,end:O}}else u=null}u=u||{start:0,end:0}}else u=null;for(gb={focusedElem:r,selectionRange:u},fg=!1,an=o;an!==null;)if(o=an,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,an=r;else for(;an!==null;){switch(o=an,w=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)x=r[u],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&w!==null){r=void 0,u=o,x=w.memoizedProps,w=w.memoizedState,f=u.stateNode;try{var _e=Yo(u.type,x);r=f.getSnapshotBeforeUpdate(_e,w),f.__reactInternalSnapshotBeforeUpdate=r}catch(ke){ct(u,u.return,ke)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,u=r.nodeType,u===9)bb(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":bb(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,an=r;break}an=o.return}}function cE(r,o,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:Tr(r,u),f&4&&xh(5,u);break;case 1:if(Tr(r,u),f&4)if(r=u.stateNode,o===null)try{r.componentDidMount()}catch(T){ct(u,u.return,T)}else{var x=Yo(u.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(x,o,r.__reactInternalSnapshotBeforeUpdate)}catch(T){ct(u,u.return,T)}}f&64&&sE(u),f&512&&wh(u,u.return);break;case 3:if(Tr(r,u),f&64&&(r=u.updateQueue,r!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{YS(r,o)}catch(T){ct(u,u.return,T)}}break;case 27:o===null&&f&4&&oE(u);case 26:case 5:Tr(r,u),o===null&&f&4&&rE(u),f&512&&wh(u,u.return);break;case 12:Tr(r,u);break;case 31:Tr(r,u),f&4&&hE(r,u);break;case 13:Tr(r,u),f&4&&fE(r,u),f&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=pI.bind(null,u),PI(r,u))));break;case 22:if(f=u.memoizedState!==null||Ar,!f){o=o!==null&&o.memoizedState!==null||$t,x=Ar;var w=$t;Ar=f,($t=o)&&!w?Cr(r,u,(u.subtreeFlags&8772)!==0):Tr(r,u),Ar=x,$t=w}break;case 30:break;default:Tr(r,u)}}function uE(r){var o=r.alternate;o!==null&&(r.alternate=null,uE(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&Av(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Et=null,ss=!1;function Er(r,o,u){for(u=u.child;u!==null;)dE(r,o,u),u=u.sibling}function dE(r,o,u){if(ms&&typeof ms.onCommitFiberUnmount=="function")try{ms.onCommitFiberUnmount($d,u)}catch{}switch(u.tag){case 26:$t||Gi(u,o),Er(r,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:$t||Gi(u,o);var f=Et,x=ss;Fa(u.type)&&(Et=u.stateNode,ss=!1),Er(r,o,u),Mh(u.stateNode),Et=f,ss=x;break;case 5:$t||Gi(u,o);case 6:if(f=Et,x=ss,Et=null,Er(r,o,u),Et=f,ss=x,Et!==null)if(ss)try{(Et.nodeType===9?Et.body:Et.nodeName==="HTML"?Et.ownerDocument.body:Et).removeChild(u.stateNode)}catch(w){ct(u,o,w)}else try{Et.removeChild(u.stateNode)}catch(w){ct(u,o,w)}break;case 18:Et!==null&&(ss?(r=Et,s1(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),su(r)):s1(Et,u.stateNode));break;case 4:f=Et,x=ss,Et=u.stateNode.containerInfo,ss=!0,Er(r,o,u),Et=f,ss=x;break;case 0:case 11:case 14:case 15:Ma(2,u,o),$t||Ma(4,u,o),Er(r,o,u);break;case 1:$t||(Gi(u,o),f=u.stateNode,typeof f.componentWillUnmount=="function"&&iE(u,o,f)),Er(r,o,u);break;case 21:Er(r,o,u);break;case 22:$t=(f=$t)||u.memoizedState!==null,Er(r,o,u),$t=f;break;default:Er(r,o,u)}}function hE(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{su(r)}catch(u){ct(o,o.return,u)}}}function fE(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{su(r)}catch(u){ct(o,o.return,u)}}function aI(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new lE),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new lE),o;default:throw Error(n(435,r.tag))}}function Ym(r,o){var u=aI(r);o.forEach(function(f){if(!u.has(f)){u.add(f);var x=mI.bind(null,r,f);f.then(x,x)}})}function is(r,o){var u=o.deletions;if(u!==null)for(var f=0;f<u.length;f++){var x=u[f],w=r,T=o,I=T;e:for(;I!==null;){switch(I.tag){case 27:if(Fa(I.type)){Et=I.stateNode,ss=!1;break e}break;case 5:Et=I.stateNode,ss=!1;break e;case 3:case 4:Et=I.stateNode.containerInfo,ss=!0;break e}I=I.return}if(Et===null)throw Error(n(160));dE(w,T,x),Et=null,ss=!1,w=x.alternate,w!==null&&(w.return=null),x.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)pE(o,r),o=o.sibling}var pi=null;function pE(r,o){var u=r.alternate,f=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:is(o,r),rs(r),f&4&&(Ma(3,r,r.return),xh(3,r),Ma(5,r,r.return));break;case 1:is(o,r),rs(r),f&512&&($t||u===null||Gi(u,u.return)),f&64&&Ar&&(r=r.updateQueue,r!==null&&(f=r.callbacks,f!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var x=pi;if(is(o,r),rs(r),f&512&&($t||u===null||Gi(u,u.return)),f&4){var w=u!==null?u.memoizedState:null;if(f=r.memoizedState,u===null)if(f===null)if(r.stateNode===null){e:{f=r.type,u=r.memoizedProps,x=x.ownerDocument||x;t:switch(f){case"title":w=x.getElementsByTagName("title")[0],(!w||w[Xd]||w[pn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=x.createElement(f),x.head.insertBefore(w,x.querySelector("head > title"))),yn(w,f,u),w[pn]=r,rn(w),f=w;break e;case"link":var T=p1("link","href",x).get(f+(u.href||""));if(T){for(var I=0;I<T.length;I++)if(w=T[I],w.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&w.getAttribute("rel")===(u.rel==null?null:u.rel)&&w.getAttribute("title")===(u.title==null?null:u.title)&&w.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){T.splice(I,1);break t}}w=x.createElement(f),yn(w,f,u),x.head.appendChild(w);break;case"meta":if(T=p1("meta","content",x).get(f+(u.content||""))){for(I=0;I<T.length;I++)if(w=T[I],w.getAttribute("content")===(u.content==null?null:""+u.content)&&w.getAttribute("name")===(u.name==null?null:u.name)&&w.getAttribute("property")===(u.property==null?null:u.property)&&w.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&w.getAttribute("charset")===(u.charSet==null?null:u.charSet)){T.splice(I,1);break t}}w=x.createElement(f),yn(w,f,u),x.head.appendChild(w);break;default:throw Error(n(468,f))}w[pn]=r,rn(w),f=w}r.stateNode=f}else m1(x,r.type,r.stateNode);else r.stateNode=f1(x,f,r.memoizedProps);else w!==f?(w===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):w.count--,f===null?m1(x,r.type,r.stateNode):f1(x,f,r.memoizedProps)):f===null&&r.stateNode!==null&&Vy(r,r.memoizedProps,u.memoizedProps)}break;case 27:is(o,r),rs(r),f&512&&($t||u===null||Gi(u,u.return)),u!==null&&f&4&&Vy(r,r.memoizedProps,u.memoizedProps);break;case 5:if(is(o,r),rs(r),f&512&&($t||u===null||Gi(u,u.return)),r.flags&32){x=r.stateNode;try{Tc(x,"")}catch(_e){ct(r,r.return,_e)}}f&4&&r.stateNode!=null&&(x=r.memoizedProps,Vy(r,x,u!==null?u.memoizedProps:x)),f&1024&&(Ky=!0);break;case 6:if(is(o,r),rs(r),f&4){if(r.stateNode===null)throw Error(n(162));f=r.memoizedProps,u=r.stateNode;try{u.nodeValue=f}catch(_e){ct(r,r.return,_e)}}break;case 3:if(cg=null,x=pi,pi=og(o.containerInfo),is(o,r),pi=x,rs(r),f&4&&u!==null&&u.memoizedState.isDehydrated)try{su(o.containerInfo)}catch(_e){ct(r,r.return,_e)}Ky&&(Ky=!1,mE(r));break;case 4:f=pi,pi=og(r.stateNode.containerInfo),is(o,r),rs(r),pi=f;break;case 12:is(o,r),rs(r);break;case 31:is(o,r),rs(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Ym(r,f)));break;case 13:is(o,r),rs(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Xm=oe()),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Ym(r,f)));break;case 22:x=r.memoizedState!==null;var O=u!==null&&u.memoizedState!==null,$=Ar,Z=$t;if(Ar=$||x,$t=Z||O,is(o,r),$t=Z,Ar=$,rs(r),f&8192)e:for(o=r.stateNode,o._visibility=x?o._visibility&-2:o._visibility|1,x&&(u===null||O||Ar||$t||Ko(r)),u=null,o=r;;){if(o.tag===5||o.tag===26){if(u===null){O=u=o;try{if(w=O.stateNode,x)T=w.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{I=O.stateNode;var te=O.memoizedProps.style,K=te!=null&&te.hasOwnProperty("display")?te.display:null;I.style.display=K==null||typeof K=="boolean"?"":(""+K).trim()}}catch(_e){ct(O,O.return,_e)}}}else if(o.tag===6){if(u===null){O=o;try{O.stateNode.nodeValue=x?"":O.memoizedProps}catch(_e){ct(O,O.return,_e)}}}else if(o.tag===18){if(u===null){O=o;try{var W=O.stateNode;x?i1(W,!0):i1(O.stateNode,!1)}catch(_e){ct(O,O.return,_e)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=r.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,Ym(r,u))));break;case 19:is(o,r),rs(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Ym(r,f)));break;case 30:break;case 21:break;default:is(o,r),rs(r)}}function rs(r){var o=r.flags;if(o&2){try{for(var u,f=r.return;f!==null;){if(aE(f)){u=f;break}f=f.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var x=u.stateNode,w=$y(r);$m(r,w,x);break;case 5:var T=u.stateNode;u.flags&32&&(Tc(T,""),u.flags&=-33);var I=$y(r);$m(r,I,T);break;case 3:case 4:var O=u.stateNode.containerInfo,$=$y(r);Yy(r,$,O);break;default:throw Error(n(161))}}catch(Z){ct(r,r.return,Z)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function mE(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;mE(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function Tr(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)cE(r,o.alternate,o),o=o.sibling}function Ko(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:Ma(4,o,o.return),Ko(o);break;case 1:Gi(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&iE(o,o.return,u),Ko(o);break;case 27:Mh(o.stateNode);case 26:case 5:Gi(o,o.return),Ko(o);break;case 22:o.memoizedState===null&&Ko(o);break;case 30:Ko(o);break;default:Ko(o)}r=r.sibling}}function Cr(r,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,x=r,w=o,T=w.flags;switch(w.tag){case 0:case 11:case 15:Cr(x,w,u),xh(4,w);break;case 1:if(Cr(x,w,u),f=w,x=f.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch($){ct(f,f.return,$)}if(f=w,x=f.updateQueue,x!==null){var I=f.stateNode;try{var O=x.shared.hiddenCallbacks;if(O!==null)for(x.shared.hiddenCallbacks=null,x=0;x<O.length;x++)$S(O[x],I)}catch($){ct(f,f.return,$)}}u&&T&64&&sE(w),wh(w,w.return);break;case 27:oE(w);case 26:case 5:Cr(x,w,u),u&&f===null&&T&4&&rE(w),wh(w,w.return);break;case 12:Cr(x,w,u);break;case 31:Cr(x,w,u),u&&T&4&&hE(x,w);break;case 13:Cr(x,w,u),u&&T&4&&fE(x,w);break;case 22:w.memoizedState===null&&Cr(x,w,u),wh(w,w.return);break;case 30:break;default:Cr(x,w,u)}o=o.sibling}}function Xy(r,o){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&lh(u))}function Jy(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&lh(r))}function mi(r,o,u,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)gE(r,o,u,f),o=o.sibling}function gE(r,o,u,f){var x=o.flags;switch(o.tag){case 0:case 11:case 15:mi(r,o,u,f),x&2048&&xh(9,o);break;case 1:mi(r,o,u,f);break;case 3:mi(r,o,u,f),x&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&lh(r)));break;case 12:if(x&2048){mi(r,o,u,f),r=o.stateNode;try{var w=o.memoizedProps,T=w.id,I=w.onPostCommit;typeof I=="function"&&I(T,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(O){ct(o,o.return,O)}}else mi(r,o,u,f);break;case 31:mi(r,o,u,f);break;case 13:mi(r,o,u,f);break;case 23:break;case 22:w=o.stateNode,T=o.alternate,o.memoizedState!==null?w._visibility&2?mi(r,o,u,f):Sh(r,o):w._visibility&2?mi(r,o,u,f):(w._visibility|=2,$c(r,o,u,f,(o.subtreeFlags&10256)!==0||!1)),x&2048&&Xy(T,o);break;case 24:mi(r,o,u,f),x&2048&&Jy(o.alternate,o);break;default:mi(r,o,u,f)}}function $c(r,o,u,f,x){for(x=x&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var w=r,T=o,I=u,O=f,$=T.flags;switch(T.tag){case 0:case 11:case 15:$c(w,T,I,O,x),xh(8,T);break;case 23:break;case 22:var Z=T.stateNode;T.memoizedState!==null?Z._visibility&2?$c(w,T,I,O,x):Sh(w,T):(Z._visibility|=2,$c(w,T,I,O,x)),x&&$&2048&&Xy(T.alternate,T);break;case 24:$c(w,T,I,O,x),x&&$&2048&&Jy(T.alternate,T);break;default:$c(w,T,I,O,x)}o=o.sibling}}function Sh(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=r,f=o,x=f.flags;switch(f.tag){case 22:Sh(u,f),x&2048&&Xy(f.alternate,f);break;case 24:Sh(u,f),x&2048&&Jy(f.alternate,f);break;default:Sh(u,f)}o=o.sibling}}var Ah=8192;function Yc(r,o,u){if(r.subtreeFlags&Ah)for(r=r.child;r!==null;)vE(r,o,u),r=r.sibling}function vE(r,o,u){switch(r.tag){case 26:Yc(r,o,u),r.flags&Ah&&r.memoizedState!==null&&$I(u,pi,r.memoizedState,r.memoizedProps);break;case 5:Yc(r,o,u);break;case 3:case 4:var f=pi;pi=og(r.stateNode.containerInfo),Yc(r,o,u),pi=f;break;case 22:r.memoizedState===null&&(f=r.alternate,f!==null&&f.memoizedState!==null?(f=Ah,Ah=16777216,Yc(r,o,u),Ah=f):Yc(r,o,u));break;default:Yc(r,o,u)}}function yE(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Eh(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];an=f,_E(f,r)}yE(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)bE(r),r=r.sibling}function bE(r){switch(r.tag){case 0:case 11:case 15:Eh(r),r.flags&2048&&Ma(9,r,r.return);break;case 3:Eh(r);break;case 12:Eh(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,Km(r)):Eh(r);break;default:Eh(r)}}function Km(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];an=f,_E(f,r)}yE(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:Ma(8,o,o.return),Km(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,Km(o));break;default:Km(o)}r=r.sibling}}function _E(r,o){for(;an!==null;){var u=an;switch(u.tag){case 0:case 11:case 15:Ma(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:lh(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,an=f;else e:for(u=r;an!==null;){f=an;var x=f.sibling,w=f.return;if(uE(f),f===u){an=null;break e}if(x!==null){x.return=w,an=x;break e}an=w}}}var oI={getCacheForType:function(r){var o=gn(Gt),u=o.data.get(r);return u===void 0&&(u=r(),o.data.set(r,u)),u},cacheSignal:function(){return gn(Gt).controller.signal}},lI=typeof WeakMap=="function"?WeakMap:Map,rt=0,vt=null,Ye=null,Xe=0,lt=0,xs=null,Ia=!1,Kc=!1,Wy=!1,Nr=0,Pt=0,Da=0,Xo=0,Qy=0,ws=0,Xc=0,Th=null,as=null,Zy=!1,Xm=0,xE=0,Jm=1/0,Wm=null,Pa=null,Wt=0,La=null,Jc=null,Rr=0,eb=0,tb=null,wE=null,Ch=0,nb=null;function Ss(){return(rt&2)!==0&&Xe!==0?Xe&-Xe:j.T!==null?lb():Fw()}function SE(){if(ws===0)if((Xe&536870912)===0||We){var r=rm;rm<<=1,(rm&3932160)===0&&(rm=262144),ws=r}else ws=536870912;return r=bs.current,r!==null&&(r.flags|=32),ws}function os(r,o,u){(r===vt&&(lt===2||lt===9)||r.cancelPendingCommit!==null)&&(Wc(r,0),Oa(r,Xe,ws,!1)),Kd(r,u),((rt&2)===0||r!==vt)&&(r===vt&&((rt&2)===0&&(Xo|=u),Pt===4&&Oa(r,Xe,ws,!1)),qi(r))}function AE(r,o,u){if((rt&6)!==0)throw Error(n(327));var f=!u&&(o&127)===0&&(o&r.expiredLanes)===0||Yd(r,o),x=f?dI(r,o):ib(r,o,!0),w=f;do{if(x===0){Kc&&!f&&Oa(r,o,0,!1);break}else{if(u=r.current.alternate,w&&!cI(u)){x=ib(r,o,!1),w=!1;continue}if(x===2){if(w=o,r.errorRecoveryDisabledLanes&w)var T=0;else T=r.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){o=T;e:{var I=r;x=Th;var O=I.current.memoizedState.isDehydrated;if(O&&(Wc(I,T).flags|=256),T=ib(I,T,!1),T!==2){if(Wy&&!O){I.errorRecoveryDisabledLanes|=w,Xo|=w,x=4;break e}w=as,as=x,w!==null&&(as===null?as=w:as.push.apply(as,w))}x=T}if(w=!1,x!==2)continue}}if(x===1){Wc(r,0),Oa(r,o,0,!0);break}e:{switch(f=r,w=x,w){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:Oa(f,o,ws,!Ia);break e;case 2:as=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(x=Xm+300-oe(),10<x)){if(Oa(f,o,ws,!Ia),om(f,0,!0)!==0)break e;Rr=o,f.timeoutHandle=t1(EE.bind(null,f,u,as,Wm,Zy,o,ws,Xo,Xc,Ia,w,"Throttled",-0,0),x);break e}EE(f,u,as,Wm,Zy,o,ws,Xo,Xc,Ia,w,null,-0,0)}}break}while(!0);qi(r)}function EE(r,o,u,f,x,w,T,I,O,$,Z,te,K,W){if(r.timeoutHandle=-1,te=o.subtreeFlags,te&8192||(te&16785408)===16785408){te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:pr},vE(o,w,te);var _e=(w&62914560)===w?Xm-oe():(w&4194048)===w?xE-oe():0;if(_e=YI(te,_e),_e!==null){Rr=w,r.cancelPendingCommit=_e(DE.bind(null,r,o,w,u,f,x,T,I,O,Z,te,null,K,W)),Oa(r,w,T,!$);return}}DE(r,o,w,u,f,x,T,I,O)}function cI(r){for(var o=r;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var x=u[f],w=x.getSnapshot;x=x.value;try{if(!vs(w(),x))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Oa(r,o,u,f){o&=~Qy,o&=~Xo,r.suspendedLanes|=o,r.pingedLanes&=~o,f&&(r.warmLanes|=o),f=r.expirationTimes;for(var x=o;0<x;){var w=31-gs(x),T=1<<w;f[w]=-1,x&=~T}u!==0&&Lw(r,u,o)}function Qm(){return(rt&6)===0?(Nh(0),!1):!0}function sb(){if(Ye!==null){if(lt===0)var r=Ye.return;else r=Ye,yr=zo=null,by(r),Hc=null,uh=0,r=Ye;for(;r!==null;)nE(r.alternate,r),r=r.return;Ye=null}}function Wc(r,o){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,RI(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),Rr=0,sb(),vt=r,Ye=u=gr(r.current,null),Xe=o,lt=0,xs=null,Ia=!1,Kc=Yd(r,o),Wy=!1,Xc=ws=Qy=Xo=Da=Pt=0,as=Th=null,Zy=!1,(o&8)!==0&&(o|=o&32);var f=r.entangledLanes;if(f!==0)for(r=r.entanglements,f&=o;0<f;){var x=31-gs(f),w=1<<x;o|=r[x],f&=~w}return Nr=o,bm(),u}function TE(r,o){Fe=null,j.H=yh,o===zc||o===Cm?(o=BS(),lt=3):o===oy?(o=BS(),lt=4):lt=o===Ly?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,xs=o,Ye===null&&(Pt=1,Hm(r,Ys(o,r.current)))}function CE(){var r=bs.current;return r===null?!0:(Xe&4194048)===Xe?Ws===null:(Xe&62914560)===Xe||(Xe&536870912)!==0?r===Ws:!1}function NE(){var r=j.H;return j.H=yh,r===null?yh:r}function RE(){var r=j.A;return j.A=oI,r}function Zm(){Pt=4,Ia||(Xe&4194048)!==Xe&&bs.current!==null||(Kc=!0),(Da&134217727)===0&&(Xo&134217727)===0||vt===null||Oa(vt,Xe,ws,!1)}function ib(r,o,u){var f=rt;rt|=2;var x=NE(),w=RE();(vt!==r||Xe!==o)&&(Wm=null,Wc(r,o)),o=!1;var T=Pt;e:do try{if(lt!==0&&Ye!==null){var I=Ye,O=xs;switch(lt){case 8:sb(),T=6;break e;case 3:case 2:case 9:case 6:bs.current===null&&(o=!0);var $=lt;if(lt=0,xs=null,Qc(r,I,O,$),u&&Kc){T=0;break e}break;default:$=lt,lt=0,xs=null,Qc(r,I,O,$)}}uI(),T=Pt;break}catch(Z){TE(r,Z)}while(!0);return o&&r.shellSuspendCounter++,yr=zo=null,rt=f,j.H=x,j.A=w,Ye===null&&(vt=null,Xe=0,bm()),T}function uI(){for(;Ye!==null;)kE(Ye)}function dI(r,o){var u=rt;rt|=2;var f=NE(),x=RE();vt!==r||Xe!==o?(Wm=null,Jm=oe()+500,Wc(r,o)):Kc=Yd(r,o);e:do try{if(lt!==0&&Ye!==null){o=Ye;var w=xs;t:switch(lt){case 1:lt=0,xs=null,Qc(r,o,w,1);break;case 2:case 9:if(zS(w)){lt=0,xs=null,ME(o);break}o=function(){lt!==2&&lt!==9||vt!==r||(lt=7),qi(r)},w.then(o,o);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:zS(w)?(lt=0,xs=null,ME(o)):(lt=0,xs=null,Qc(r,o,w,7));break;case 5:var T=null;switch(Ye.tag){case 26:T=Ye.memoizedState;case 5:case 27:var I=Ye;if(T?g1(T):I.stateNode.complete){lt=0,xs=null;var O=I.sibling;if(O!==null)Ye=O;else{var $=I.return;$!==null?(Ye=$,eg($)):Ye=null}break t}}lt=0,xs=null,Qc(r,o,w,5);break;case 6:lt=0,xs=null,Qc(r,o,w,6);break;case 8:sb(),Pt=6;break e;default:throw Error(n(462))}}hI();break}catch(Z){TE(r,Z)}while(!0);return yr=zo=null,j.H=f,j.A=x,rt=u,Ye!==null?0:(vt=null,Xe=0,bm(),Pt)}function hI(){for(;Ye!==null&&!vv();)kE(Ye)}function kE(r){var o=eE(r.alternate,r,Nr);r.memoizedProps=r.pendingProps,o===null?eg(r):Ye=o}function ME(r){var o=r,u=o.alternate;switch(o.tag){case 15:case 0:o=KA(u,o,o.pendingProps,o.type,void 0,Xe);break;case 11:o=KA(u,o,o.pendingProps,o.type.render,o.ref,Xe);break;case 5:by(o);default:nE(u,o),o=Ye=RS(o,Nr),o=eE(u,o,Nr)}r.memoizedProps=r.pendingProps,o===null?eg(r):Ye=o}function Qc(r,o,u,f){yr=zo=null,by(o),Hc=null,uh=0;var x=o.return;try{if(eI(r,x,o,u,Xe)){Pt=1,Hm(r,Ys(u,r.current)),Ye=null;return}}catch(w){if(x!==null)throw Ye=x,w;Pt=1,Hm(r,Ys(u,r.current)),Ye=null;return}o.flags&32768?(We||f===1?r=!0:Kc||(Xe&536870912)!==0?r=!1:(Ia=r=!0,(f===2||f===9||f===3||f===6)&&(f=bs.current,f!==null&&f.tag===13&&(f.flags|=16384))),IE(o,r)):eg(o)}function eg(r){var o=r;do{if((o.flags&32768)!==0){IE(o,Ia);return}r=o.return;var u=sI(o.alternate,o,Nr);if(u!==null){Ye=u;return}if(o=o.sibling,o!==null){Ye=o;return}Ye=o=r}while(o!==null);Pt===0&&(Pt=5)}function IE(r,o){do{var u=iI(r.alternate,r);if(u!==null){u.flags&=32767,Ye=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(r=r.sibling,r!==null)){Ye=r;return}Ye=r=u}while(r!==null);Pt=6,Ye=null}function DE(r,o,u,f,x,w,T,I,O){r.cancelPendingCommit=null;do tg();while(Wt!==0);if((rt&6)!==0)throw Error(n(327));if(o!==null){if(o===r.current)throw Error(n(177));if(w=o.lanes|o.childLanes,w|=$v,Vk(r,u,w,T,I,O),r===vt&&(Ye=vt=null,Xe=0),Jc=o,La=r,Rr=u,eb=w,tb=x,wE=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,gI(bc,function(){return FE(),null})):(r.callbackNode=null,r.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=j.T,j.T=null,x=G.p,G.p=2,T=rt,rt|=4;try{rI(r,o,u)}finally{rt=T,G.p=x,j.T=f}}Wt=1,PE(),LE(),OE()}}function PE(){if(Wt===1){Wt=0;var r=La,o=Jc,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=j.T,j.T=null;var f=G.p;G.p=2;var x=rt;rt|=4;try{pE(o,r);var w=gb,T=_S(r.containerInfo),I=w.focusedElem,O=w.selectionRange;if(T!==I&&I&&I.ownerDocument&&bS(I.ownerDocument.documentElement,I)){if(O!==null&&Hv(I)){var $=O.start,Z=O.end;if(Z===void 0&&(Z=$),"selectionStart"in I)I.selectionStart=$,I.selectionEnd=Math.min(Z,I.value.length);else{var te=I.ownerDocument||document,K=te&&te.defaultView||window;if(K.getSelection){var W=K.getSelection(),_e=I.textContent.length,ke=Math.min(O.start,_e),pt=O.end===void 0?ke:Math.min(O.end,_e);!W.extend&&ke>pt&&(T=pt,pt=ke,ke=T);var q=yS(I,ke),B=yS(I,pt);if(q&&B&&(W.rangeCount!==1||W.anchorNode!==q.node||W.anchorOffset!==q.offset||W.focusNode!==B.node||W.focusOffset!==B.offset)){var V=te.createRange();V.setStart(q.node,q.offset),W.removeAllRanges(),ke>pt?(W.addRange(V),W.extend(B.node,B.offset)):(V.setEnd(B.node,B.offset),W.addRange(V))}}}}for(te=[],W=I;W=W.parentNode;)W.nodeType===1&&te.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<te.length;I++){var ee=te[I];ee.element.scrollLeft=ee.left,ee.element.scrollTop=ee.top}}fg=!!mb,gb=mb=null}finally{rt=x,G.p=f,j.T=u}}r.current=o,Wt=2}}function LE(){if(Wt===2){Wt=0;var r=La,o=Jc,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=j.T,j.T=null;var f=G.p;G.p=2;var x=rt;rt|=4;try{cE(r,o.alternate,o)}finally{rt=x,G.p=f,j.T=u}}Wt=3}}function OE(){if(Wt===4||Wt===3){Wt=0,yv();var r=La,o=Jc,u=Rr,f=wE;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Wt=5:(Wt=0,Jc=La=null,UE(r,r.pendingLanes));var x=r.pendingLanes;if(x===0&&(Pa=null),wv(u),o=o.stateNode,ms&&typeof ms.onCommitFiberRoot=="function")try{ms.onCommitFiberRoot($d,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=j.T,x=G.p,G.p=2,j.T=null;try{for(var w=r.onRecoverableError,T=0;T<f.length;T++){var I=f[T];w(I.value,{componentStack:I.stack})}}finally{j.T=o,G.p=x}}(Rr&3)!==0&&tg(),qi(r),x=r.pendingLanes,(u&261930)!==0&&(x&42)!==0?r===nb?Ch++:(Ch=0,nb=r):Ch=0,Nh(0)}}function UE(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,lh(o)))}function tg(){return PE(),LE(),OE(),FE()}function FE(){if(Wt!==5)return!1;var r=La,o=eb;eb=0;var u=wv(Rr),f=j.T,x=G.p;try{G.p=32>u?32:u,j.T=null,u=tb,tb=null;var w=La,T=Rr;if(Wt=0,Jc=La=null,Rr=0,(rt&6)!==0)throw Error(n(331));var I=rt;if(rt|=4,bE(w.current),gE(w,w.current,T,u),rt=I,Nh(0,!1),ms&&typeof ms.onPostCommitFiberRoot=="function")try{ms.onPostCommitFiberRoot($d,w)}catch{}return!0}finally{G.p=x,j.T=f,UE(r,o)}}function jE(r,o,u){o=Ys(u,o),o=Py(r.stateNode,o,2),r=Na(r,o,2),r!==null&&(Kd(r,2),qi(r))}function ct(r,o,u){if(r.tag===3)jE(r,r,u);else for(;o!==null;){if(o.tag===3){jE(o,r,u);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Pa===null||!Pa.has(f))){r=Ys(u,r),u=zA(2),f=Na(o,u,2),f!==null&&(HA(u,f,o,r),Kd(f,2),qi(f));break}}o=o.return}}function rb(r,o,u){var f=r.pingCache;if(f===null){f=r.pingCache=new lI;var x=new Set;f.set(o,x)}else x=f.get(o),x===void 0&&(x=new Set,f.set(o,x));x.has(u)||(Wy=!0,x.add(u),r=fI.bind(null,r,o,u),o.then(r,r))}function fI(r,o,u){var f=r.pingCache;f!==null&&f.delete(o),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,vt===r&&(Xe&u)===u&&(Pt===4||Pt===3&&(Xe&62914560)===Xe&&300>oe()-Xm?(rt&2)===0&&Wc(r,0):Qy|=u,Xc===Xe&&(Xc=0)),qi(r)}function zE(r,o){o===0&&(o=Pw()),r=Uo(r,o),r!==null&&(Kd(r,o),qi(r))}function pI(r){var o=r.memoizedState,u=0;o!==null&&(u=o.retryLane),zE(r,u)}function mI(r,o){var u=0;switch(r.tag){case 31:case 13:var f=r.stateNode,x=r.memoizedState;x!==null&&(u=x.retryLane);break;case 19:f=r.stateNode;break;case 22:f=r.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(o),zE(r,u)}function gI(r,o){return qd(r,o)}var ng=null,Zc=null,ab=!1,sg=!1,ob=!1,Ua=0;function qi(r){r!==Zc&&r.next===null&&(Zc===null?ng=Zc=r:Zc=Zc.next=r),sg=!0,ab||(ab=!0,yI())}function Nh(r,o){if(!ob&&sg){ob=!0;do for(var u=!1,f=ng;f!==null;){if(r!==0){var x=f.pendingLanes;if(x===0)var w=0;else{var T=f.suspendedLanes,I=f.pingedLanes;w=(1<<31-gs(42|r)+1)-1,w&=x&~(T&~I),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(u=!0,qE(f,w))}else w=Xe,w=om(f,f===vt?w:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(w&3)===0||Yd(f,w)||(u=!0,qE(f,w));f=f.next}while(u);ob=!1}}function vI(){HE()}function HE(){sg=ab=!1;var r=0;Ua!==0&&NI()&&(r=Ua);for(var o=oe(),u=null,f=ng;f!==null;){var x=f.next,w=BE(f,o);w===0?(f.next=null,u===null?ng=x:u.next=x,x===null&&(Zc=u)):(u=f,(r!==0||(w&3)!==0)&&(sg=!0)),f=x}Wt!==0&&Wt!==5||Nh(r),Ua!==0&&(Ua=0)}function BE(r,o){for(var u=r.suspendedLanes,f=r.pingedLanes,x=r.expirationTimes,w=r.pendingLanes&-62914561;0<w;){var T=31-gs(w),I=1<<T,O=x[T];O===-1?((I&u)===0||(I&f)!==0)&&(x[T]=qk(I,o)):O<=o&&(r.expiredLanes|=I),w&=~I}if(o=vt,u=Xe,u=om(r,r===o?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f=r.callbackNode,u===0||r===o&&(lt===2||lt===9)||r.cancelPendingCommit!==null)return f!==null&&f!==null&&Vd(f),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||Yd(r,u)){if(o=u&-u,o===r.callbackPriority)return o;switch(f!==null&&Vd(f),wv(u)){case 2:case 8:u=es;break;case 32:u=bc;break;case 268435456:u=ya;break;default:u=bc}return f=GE.bind(null,r),u=qd(u,f),r.callbackPriority=o,r.callbackNode=u,o}return f!==null&&f!==null&&Vd(f),r.callbackPriority=2,r.callbackNode=null,2}function GE(r,o){if(Wt!==0&&Wt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(tg()&&r.callbackNode!==u)return null;var f=Xe;return f=om(r,r===vt?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f===0?null:(AE(r,f,o),BE(r,oe()),r.callbackNode!=null&&r.callbackNode===u?GE.bind(null,r):null)}function qE(r,o){if(tg())return null;AE(r,o,!0)}function yI(){kI(function(){(rt&6)!==0?qd(zn,vI):HE()})}function lb(){if(Ua===0){var r=Fc;r===0&&(r=im,im<<=1,(im&261888)===0&&(im=256)),Ua=r}return Ua}function VE(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:dm(""+r)}function $E(r,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,r.id&&u.setAttribute("form",r.id),o.parentNode.insertBefore(u,o),r=new FormData(r),u.parentNode.removeChild(u),r}function bI(r,o,u,f,x){if(o==="submit"&&u&&u.stateNode===x){var w=VE((x[ts]||null).action),T=f.submitter;T&&(o=(o=T[ts]||null)?VE(o.formAction):T.getAttribute("formAction"),o!==null&&(w=o,T=null));var I=new mm("action","action",null,f,x);r.push({event:I,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ua!==0){var O=T?$E(x,T):new FormData(x);Ny(u,{pending:!0,data:O,method:x.method,action:w},null,O)}}else typeof w=="function"&&(I.preventDefault(),O=T?$E(x,T):new FormData(x),Ny(u,{pending:!0,data:O,method:x.method,action:w},w,O))},currentTarget:x}]})}}for(var cb=0;cb<Vv.length;cb++){var ub=Vv[cb],_I=ub.toLowerCase(),xI=ub[0].toUpperCase()+ub.slice(1);fi(_I,"on"+xI)}fi(SS,"onAnimationEnd"),fi(AS,"onAnimationIteration"),fi(ES,"onAnimationStart"),fi("dblclick","onDoubleClick"),fi("focusin","onFocus"),fi("focusout","onBlur"),fi(UM,"onTransitionRun"),fi(FM,"onTransitionStart"),fi(jM,"onTransitionCancel"),fi(TS,"onTransitionEnd"),Ac("onMouseEnter",["mouseout","mouseover"]),Ac("onMouseLeave",["mouseout","mouseover"]),Ac("onPointerEnter",["pointerout","pointerover"]),Ac("onPointerLeave",["pointerout","pointerover"]),Do("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Do("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Do("onBeforeInput",["compositionend","keypress","textInput","paste"]),Do("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Do("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Do("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rh));function YE(r,o){o=(o&4)!==0;for(var u=0;u<r.length;u++){var f=r[u],x=f.event;f=f.listeners;e:{var w=void 0;if(o)for(var T=f.length-1;0<=T;T--){var I=f[T],O=I.instance,$=I.currentTarget;if(I=I.listener,O!==w&&x.isPropagationStopped())break e;w=I,x.currentTarget=$;try{w(x)}catch(Z){ym(Z)}x.currentTarget=null,w=O}else for(T=0;T<f.length;T++){if(I=f[T],O=I.instance,$=I.currentTarget,I=I.listener,O!==w&&x.isPropagationStopped())break e;w=I,x.currentTarget=$;try{w(x)}catch(Z){ym(Z)}x.currentTarget=null,w=O}}}}function Ke(r,o){var u=o[Sv];u===void 0&&(u=o[Sv]=new Set);var f=r+"__bubble";u.has(f)||(KE(o,r,2,!1),u.add(f))}function db(r,o,u){var f=0;o&&(f|=4),KE(u,r,f,o)}var ig="_reactListening"+Math.random().toString(36).slice(2);function hb(r){if(!r[ig]){r[ig]=!0,Hw.forEach(function(u){u!=="selectionchange"&&(wI.has(u)||db(u,!1,r),db(u,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[ig]||(o[ig]=!0,db("selectionchange",!1,o))}}function KE(r,o,u,f){switch(S1(o)){case 2:var x=JI;break;case 8:x=WI;break;default:x=Cb}u=x.bind(null,o,u,r),x=void 0,!Iv||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),f?x!==void 0?r.addEventListener(o,u,{capture:!0,passive:x}):r.addEventListener(o,u,!0):x!==void 0?r.addEventListener(o,u,{passive:x}):r.addEventListener(o,u,!1)}function fb(r,o,u,f,x){var w=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var I=f.stateNode.containerInfo;if(I===x)break;if(T===4)for(T=f.return;T!==null;){var O=T.tag;if((O===3||O===4)&&T.stateNode.containerInfo===x)return;T=T.return}for(;I!==null;){if(T=xc(I),T===null)return;if(O=T.tag,O===5||O===6||O===26||O===27){f=w=T;continue e}I=I.parentNode}}f=f.return}Zw(function(){var $=w,Z=kv(u),te=[];e:{var K=CS.get(r);if(K!==void 0){var W=mm,_e=r;switch(r){case"keypress":if(fm(u)===0)break e;case"keydown":case"keyup":W=mM;break;case"focusin":_e="focus",W=Ov;break;case"focusout":_e="blur",W=Ov;break;case"beforeblur":case"afterblur":W=Ov;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=nS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=sM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=yM;break;case SS:case AS:case ES:W=aM;break;case TS:W=_M;break;case"scroll":case"scrollend":W=tM;break;case"wheel":W=wM;break;case"copy":case"cut":case"paste":W=lM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=iS;break;case"toggle":case"beforetoggle":W=AM}var ke=(o&4)!==0,pt=!ke&&(r==="scroll"||r==="scrollend"),q=ke?K!==null?K+"Capture":null:K;ke=[];for(var B=$,V;B!==null;){var ee=B;if(V=ee.stateNode,ee=ee.tag,ee!==5&&ee!==26&&ee!==27||V===null||q===null||(ee=Wd(B,q),ee!=null&&ke.push(kh(B,ee,V))),pt)break;B=B.return}0<ke.length&&(K=new W(K,_e,null,u,Z),te.push({event:K,listeners:ke}))}}if((o&7)===0){e:{if(K=r==="mouseover"||r==="pointerover",W=r==="mouseout"||r==="pointerout",K&&u!==Rv&&(_e=u.relatedTarget||u.fromElement)&&(xc(_e)||_e[_c]))break e;if((W||K)&&(K=Z.window===Z?Z:(K=Z.ownerDocument)?K.defaultView||K.parentWindow:window,W?(_e=u.relatedTarget||u.toElement,W=$,_e=_e?xc(_e):null,_e!==null&&(pt=a(_e),ke=_e.tag,_e!==pt||ke!==5&&ke!==27&&ke!==6)&&(_e=null)):(W=null,_e=$),W!==_e)){if(ke=nS,ee="onMouseLeave",q="onMouseEnter",B="mouse",(r==="pointerout"||r==="pointerover")&&(ke=iS,ee="onPointerLeave",q="onPointerEnter",B="pointer"),pt=W==null?K:Jd(W),V=_e==null?K:Jd(_e),K=new ke(ee,B+"leave",W,u,Z),K.target=pt,K.relatedTarget=V,ee=null,xc(Z)===$&&(ke=new ke(q,B+"enter",_e,u,Z),ke.target=V,ke.relatedTarget=pt,ee=ke),pt=ee,W&&_e)t:{for(ke=SI,q=W,B=_e,V=0,ee=q;ee;ee=ke(ee))V++;ee=0;for(var Re=B;Re;Re=ke(Re))ee++;for(;0<V-ee;)q=ke(q),V--;for(;0<ee-V;)B=ke(B),ee--;for(;V--;){if(q===B||B!==null&&q===B.alternate){ke=q;break t}q=ke(q),B=ke(B)}ke=null}else ke=null;W!==null&&XE(te,K,W,ke,!1),_e!==null&&pt!==null&&XE(te,pt,_e,ke,!0)}}e:{if(K=$?Jd($):window,W=K.nodeName&&K.nodeName.toLowerCase(),W==="select"||W==="input"&&K.type==="file")var tt=hS;else if(uS(K))if(fS)tt=PM;else{tt=IM;var Ae=MM}else W=K.nodeName,!W||W.toLowerCase()!=="input"||K.type!=="checkbox"&&K.type!=="radio"?$&&Nv($.elementType)&&(tt=hS):tt=DM;if(tt&&(tt=tt(r,$))){dS(te,tt,u,Z);break e}Ae&&Ae(r,K,$),r==="focusout"&&$&&K.type==="number"&&$.memoizedProps.value!=null&&Cv(K,"number",K.value)}switch(Ae=$?Jd($):window,r){case"focusin":(uS(Ae)||Ae.contentEditable==="true")&&(kc=Ae,Bv=$,rh=null);break;case"focusout":rh=Bv=kc=null;break;case"mousedown":Gv=!0;break;case"contextmenu":case"mouseup":case"dragend":Gv=!1,xS(te,u,Z);break;case"selectionchange":if(OM)break;case"keydown":case"keyup":xS(te,u,Z)}var ze;if(Fv)e:{switch(r){case"compositionstart":var Je="onCompositionStart";break e;case"compositionend":Je="onCompositionEnd";break e;case"compositionupdate":Je="onCompositionUpdate";break e}Je=void 0}else Rc?lS(r,u)&&(Je="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(Je="onCompositionStart");Je&&(rS&&u.locale!=="ko"&&(Rc||Je!=="onCompositionStart"?Je==="onCompositionEnd"&&Rc&&(ze=eS()):(xa=Z,Dv="value"in xa?xa.value:xa.textContent,Rc=!0)),Ae=rg($,Je),0<Ae.length&&(Je=new sS(Je,r,null,u,Z),te.push({event:Je,listeners:Ae}),ze?Je.data=ze:(ze=cS(u),ze!==null&&(Je.data=ze)))),(ze=TM?CM(r,u):NM(r,u))&&(Je=rg($,"onBeforeInput"),0<Je.length&&(Ae=new sS("onBeforeInput","beforeinput",null,u,Z),te.push({event:Ae,listeners:Je}),Ae.data=ze)),bI(te,r,$,u,Z)}YE(te,o)})}function kh(r,o,u){return{instance:r,listener:o,currentTarget:u}}function rg(r,o){for(var u=o+"Capture",f=[];r!==null;){var x=r,w=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||w===null||(x=Wd(r,u),x!=null&&f.unshift(kh(r,x,w)),x=Wd(r,o),x!=null&&f.push(kh(r,x,w))),r.tag===3)return f;r=r.return}return[]}function SI(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function XE(r,o,u,f,x){for(var w=o._reactName,T=[];u!==null&&u!==f;){var I=u,O=I.alternate,$=I.stateNode;if(I=I.tag,O!==null&&O===f)break;I!==5&&I!==26&&I!==27||$===null||(O=$,x?($=Wd(u,w),$!=null&&T.unshift(kh(u,$,O))):x||($=Wd(u,w),$!=null&&T.push(kh(u,$,O)))),u=u.return}T.length!==0&&r.push({event:o,listeners:T})}var AI=/\r\n?/g,EI=/\u0000|\uFFFD/g;function JE(r){return(typeof r=="string"?r:""+r).replace(AI,`
`).replace(EI,"")}function WE(r,o){return o=JE(o),JE(r)===o}function ft(r,o,u,f,x,w){switch(u){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||Tc(r,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&Tc(r,""+f);break;case"className":cm(r,"class",f);break;case"tabIndex":cm(r,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":cm(r,u,f);break;case"style":Ww(r,f,w);break;case"data":if(o!=="object"){cm(r,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||u!=="href")){r.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=dm(""+f),r.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(u==="formAction"?(o!=="input"&&ft(r,o,"name",x.name,x,null),ft(r,o,"formEncType",x.formEncType,x,null),ft(r,o,"formMethod",x.formMethod,x,null),ft(r,o,"formTarget",x.formTarget,x,null)):(ft(r,o,"encType",x.encType,x,null),ft(r,o,"method",x.method,x,null),ft(r,o,"target",x.target,x,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=dm(""+f),r.setAttribute(u,f);break;case"onClick":f!=null&&(r.onclick=pr);break;case"onScroll":f!=null&&Ke("scroll",r);break;case"onScrollEnd":f!=null&&Ke("scrollend",r);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(x.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"multiple":r.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":r.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){r.removeAttribute("xlink:href");break}u=dm(""+f),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""+f):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":f===!0?r.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,f):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?r.setAttribute(u,f):r.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?r.removeAttribute(u):r.setAttribute(u,f);break;case"popover":Ke("beforetoggle",r),Ke("toggle",r),lm(r,"popover",f);break;case"xlinkActuate":fr(r,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":fr(r,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":fr(r,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":fr(r,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":fr(r,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":fr(r,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":fr(r,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":fr(r,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":fr(r,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":lm(r,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Zk.get(u)||u,lm(r,u,f))}}function pb(r,o,u,f,x,w){switch(u){case"style":Ww(r,f,w);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(x.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"children":typeof f=="string"?Tc(r,f):(typeof f=="number"||typeof f=="bigint")&&Tc(r,""+f);break;case"onScroll":f!=null&&Ke("scroll",r);break;case"onScrollEnd":f!=null&&Ke("scrollend",r);break;case"onClick":f!=null&&(r.onclick=pr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Bw.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(x=u.endsWith("Capture"),o=u.slice(2,x?u.length-7:void 0),w=r[ts]||null,w=w!=null?w[u]:null,typeof w=="function"&&r.removeEventListener(o,w,x),typeof f=="function")){typeof w!="function"&&w!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(o,f,x);break e}u in r?r[u]=f:f===!0?r.setAttribute(u,""):lm(r,u,f)}}}function yn(r,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ke("error",r),Ke("load",r);var f=!1,x=!1,w;for(w in u)if(u.hasOwnProperty(w)){var T=u[w];if(T!=null)switch(w){case"src":f=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:ft(r,o,w,T,u,null)}}x&&ft(r,o,"srcSet",u.srcSet,u,null),f&&ft(r,o,"src",u.src,u,null);return;case"input":Ke("invalid",r);var I=w=T=x=null,O=null,$=null;for(f in u)if(u.hasOwnProperty(f)){var Z=u[f];if(Z!=null)switch(f){case"name":x=Z;break;case"type":T=Z;break;case"checked":O=Z;break;case"defaultChecked":$=Z;break;case"value":w=Z;break;case"defaultValue":I=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(n(137,o));break;default:ft(r,o,f,Z,u,null)}}Yw(r,w,I,O,$,T,x,!1);return;case"select":Ke("invalid",r),f=T=w=null;for(x in u)if(u.hasOwnProperty(x)&&(I=u[x],I!=null))switch(x){case"value":w=I;break;case"defaultValue":T=I;break;case"multiple":f=I;default:ft(r,o,x,I,u,null)}o=w,u=T,r.multiple=!!f,o!=null?Ec(r,!!f,o,!1):u!=null&&Ec(r,!!f,u,!0);return;case"textarea":Ke("invalid",r),w=x=f=null;for(T in u)if(u.hasOwnProperty(T)&&(I=u[T],I!=null))switch(T){case"value":f=I;break;case"defaultValue":x=I;break;case"children":w=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(n(91));break;default:ft(r,o,T,I,u,null)}Xw(r,f,x,w);return;case"option":for(O in u)if(u.hasOwnProperty(O)&&(f=u[O],f!=null))switch(O){case"selected":r.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:ft(r,o,O,f,u,null)}return;case"dialog":Ke("beforetoggle",r),Ke("toggle",r),Ke("cancel",r),Ke("close",r);break;case"iframe":case"object":Ke("load",r);break;case"video":case"audio":for(f=0;f<Rh.length;f++)Ke(Rh[f],r);break;case"image":Ke("error",r),Ke("load",r);break;case"details":Ke("toggle",r);break;case"embed":case"source":case"link":Ke("error",r),Ke("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($ in u)if(u.hasOwnProperty($)&&(f=u[$],f!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:ft(r,o,$,f,u,null)}return;default:if(Nv(o)){for(Z in u)u.hasOwnProperty(Z)&&(f=u[Z],f!==void 0&&pb(r,o,Z,f,u,void 0));return}}for(I in u)u.hasOwnProperty(I)&&(f=u[I],f!=null&&ft(r,o,I,f,u,null))}function TI(r,o,u,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,w=null,T=null,I=null,O=null,$=null,Z=null;for(W in u){var te=u[W];if(u.hasOwnProperty(W)&&te!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":O=te;default:f.hasOwnProperty(W)||ft(r,o,W,null,f,te)}}for(var K in f){var W=f[K];if(te=u[K],f.hasOwnProperty(K)&&(W!=null||te!=null))switch(K){case"type":w=W;break;case"name":x=W;break;case"checked":$=W;break;case"defaultChecked":Z=W;break;case"value":T=W;break;case"defaultValue":I=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(137,o));break;default:W!==te&&ft(r,o,K,W,f,te)}}Tv(r,T,I,O,$,Z,w,x);return;case"select":W=T=I=K=null;for(w in u)if(O=u[w],u.hasOwnProperty(w)&&O!=null)switch(w){case"value":break;case"multiple":W=O;default:f.hasOwnProperty(w)||ft(r,o,w,null,f,O)}for(x in f)if(w=f[x],O=u[x],f.hasOwnProperty(x)&&(w!=null||O!=null))switch(x){case"value":K=w;break;case"defaultValue":I=w;break;case"multiple":T=w;default:w!==O&&ft(r,o,x,w,f,O)}o=I,u=T,f=W,K!=null?Ec(r,!!u,K,!1):!!f!=!!u&&(o!=null?Ec(r,!!u,o,!0):Ec(r,!!u,u?[]:"",!1));return;case"textarea":W=K=null;for(I in u)if(x=u[I],u.hasOwnProperty(I)&&x!=null&&!f.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:ft(r,o,I,null,f,x)}for(T in f)if(x=f[T],w=u[T],f.hasOwnProperty(T)&&(x!=null||w!=null))switch(T){case"value":K=x;break;case"defaultValue":W=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(n(91));break;default:x!==w&&ft(r,o,T,x,f,w)}Kw(r,K,W);return;case"option":for(var _e in u)if(K=u[_e],u.hasOwnProperty(_e)&&K!=null&&!f.hasOwnProperty(_e))switch(_e){case"selected":r.selected=!1;break;default:ft(r,o,_e,null,f,K)}for(O in f)if(K=f[O],W=u[O],f.hasOwnProperty(O)&&K!==W&&(K!=null||W!=null))switch(O){case"selected":r.selected=K&&typeof K!="function"&&typeof K!="symbol";break;default:ft(r,o,O,K,f,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in u)K=u[ke],u.hasOwnProperty(ke)&&K!=null&&!f.hasOwnProperty(ke)&&ft(r,o,ke,null,f,K);for($ in f)if(K=f[$],W=u[$],f.hasOwnProperty($)&&K!==W&&(K!=null||W!=null))switch($){case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(n(137,o));break;default:ft(r,o,$,K,f,W)}return;default:if(Nv(o)){for(var pt in u)K=u[pt],u.hasOwnProperty(pt)&&K!==void 0&&!f.hasOwnProperty(pt)&&pb(r,o,pt,void 0,f,K);for(Z in f)K=f[Z],W=u[Z],!f.hasOwnProperty(Z)||K===W||K===void 0&&W===void 0||pb(r,o,Z,K,f,W);return}}for(var q in u)K=u[q],u.hasOwnProperty(q)&&K!=null&&!f.hasOwnProperty(q)&&ft(r,o,q,null,f,K);for(te in f)K=f[te],W=u[te],!f.hasOwnProperty(te)||K===W||K==null&&W==null||ft(r,o,te,K,f,W)}function QE(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function CI(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var x=u[f],w=x.transferSize,T=x.initiatorType,I=x.duration;if(w&&I&&QE(T)){for(T=0,I=x.responseEnd,f+=1;f<u.length;f++){var O=u[f],$=O.startTime;if($>I)break;var Z=O.transferSize,te=O.initiatorType;Z&&QE(te)&&(O=O.responseEnd,T+=Z*(O<I?1:(I-$)/(O-$)))}if(--f,o+=8*(w+T)/(x.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var mb=null,gb=null;function ag(r){return r.nodeType===9?r:r.ownerDocument}function ZE(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function e1(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function vb(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var yb=null;function NI(){var r=window.event;return r&&r.type==="popstate"?r===yb?!1:(yb=r,!0):(yb=null,!1)}var t1=typeof setTimeout=="function"?setTimeout:void 0,RI=typeof clearTimeout=="function"?clearTimeout:void 0,n1=typeof Promise=="function"?Promise:void 0,kI=typeof queueMicrotask=="function"?queueMicrotask:typeof n1<"u"?function(r){return n1.resolve(null).then(r).catch(MI)}:t1;function MI(r){setTimeout(function(){throw r})}function Fa(r){return r==="head"}function s1(r,o){var u=o,f=0;do{var x=u.nextSibling;if(r.removeChild(u),x&&x.nodeType===8)if(u=x.data,u==="/$"||u==="/&"){if(f===0){r.removeChild(x),su(o);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")Mh(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,Mh(u);for(var w=u.firstChild;w;){var T=w.nextSibling,I=w.nodeName;w[Xd]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&w.rel.toLowerCase()==="stylesheet"||u.removeChild(w),w=T}}else u==="body"&&Mh(r.ownerDocument.body);u=x}while(u);su(o)}function i1(r,o){var u=r;r=0;do{var f=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=f}while(u)}function bb(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":bb(u),Av(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function II(r,o,u,f){for(;r.nodeType===1;){var x=u;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(f){if(!r[Xd])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(w=r.getAttribute("rel"),w==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(w!==x.rel||r.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||r.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||r.getAttribute("title")!==(x.title==null?null:x.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(w=r.getAttribute("src"),(w!==(x.src==null?null:x.src)||r.getAttribute("type")!==(x.type==null?null:x.type)||r.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&w&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var w=x.name==null?null:""+x.name;if(x.type==="hidden"&&r.getAttribute("name")===w)return r}else return r;if(r=Qs(r.nextSibling),r===null)break}return null}function DI(r,o,u){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Qs(r.nextSibling),r===null))return null;return r}function r1(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Qs(r.nextSibling),r===null))return null;return r}function _b(r){return r.data==="$?"||r.data==="$~"}function xb(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function PI(r,o){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||u.readyState!=="loading")o();else{var f=function(){o(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),r._reactRetry=f}}function Qs(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var wb=null;function a1(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(o===0)return Qs(r.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}r=r.nextSibling}return null}function o1(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return r;o--}else u!=="/$"&&u!=="/&"||o++}r=r.previousSibling}return null}function l1(r,o,u){switch(o=ag(u),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function Mh(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);Av(r)}var Zs=new Map,c1=new Set;function og(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var kr=G.d;G.d={f:LI,r:OI,D:UI,C:FI,L:jI,m:zI,X:BI,S:HI,M:GI};function LI(){var r=kr.f(),o=Qm();return r||o}function OI(r){var o=wc(r);o!==null&&o.tag===5&&o.type==="form"?TA(o):kr.r(r)}var eu=typeof document>"u"?null:document;function u1(r,o,u){var f=eu;if(f&&typeof o=="string"&&o){var x=Vs(o);x='link[rel="'+r+'"][href="'+x+'"]',typeof u=="string"&&(x+='[crossorigin="'+u+'"]'),c1.has(x)||(c1.add(x),r={rel:r,crossOrigin:u,href:o},f.querySelector(x)===null&&(o=f.createElement("link"),yn(o,"link",r),rn(o),f.head.appendChild(o)))}}function UI(r){kr.D(r),u1("dns-prefetch",r,null)}function FI(r,o){kr.C(r,o),u1("preconnect",r,o)}function jI(r,o,u){kr.L(r,o,u);var f=eu;if(f&&r&&o){var x='link[rel="preload"][as="'+Vs(o)+'"]';o==="image"&&u&&u.imageSrcSet?(x+='[imagesrcset="'+Vs(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(x+='[imagesizes="'+Vs(u.imageSizes)+'"]')):x+='[href="'+Vs(r)+'"]';var w=x;switch(o){case"style":w=tu(r);break;case"script":w=nu(r)}Zs.has(w)||(r=y({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:r,as:o},u),Zs.set(w,r),f.querySelector(x)!==null||o==="style"&&f.querySelector(Ih(w))||o==="script"&&f.querySelector(Dh(w))||(o=f.createElement("link"),yn(o,"link",r),rn(o),f.head.appendChild(o)))}}function zI(r,o){kr.m(r,o);var u=eu;if(u&&r){var f=o&&typeof o.as=="string"?o.as:"script",x='link[rel="modulepreload"][as="'+Vs(f)+'"][href="'+Vs(r)+'"]',w=x;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=nu(r)}if(!Zs.has(w)&&(r=y({rel:"modulepreload",href:r},o),Zs.set(w,r),u.querySelector(x)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Dh(w)))return}f=u.createElement("link"),yn(f,"link",r),rn(f),u.head.appendChild(f)}}}function HI(r,o,u){kr.S(r,o,u);var f=eu;if(f&&r){var x=Sc(f).hoistableStyles,w=tu(r);o=o||"default";var T=x.get(w);if(!T){var I={loading:0,preload:null};if(T=f.querySelector(Ih(w)))I.loading=5;else{r=y({rel:"stylesheet",href:r,"data-precedence":o},u),(u=Zs.get(w))&&Sb(r,u);var O=T=f.createElement("link");rn(O),yn(O,"link",r),O._p=new Promise(function($,Z){O.onload=$,O.onerror=Z}),O.addEventListener("load",function(){I.loading|=1}),O.addEventListener("error",function(){I.loading|=2}),I.loading|=4,lg(T,o,f)}T={type:"stylesheet",instance:T,count:1,state:I},x.set(w,T)}}}function BI(r,o){kr.X(r,o);var u=eu;if(u&&r){var f=Sc(u).hoistableScripts,x=nu(r),w=f.get(x);w||(w=u.querySelector(Dh(x)),w||(r=y({src:r,async:!0},o),(o=Zs.get(x))&&Ab(r,o),w=u.createElement("script"),rn(w),yn(w,"link",r),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},f.set(x,w))}}function GI(r,o){kr.M(r,o);var u=eu;if(u&&r){var f=Sc(u).hoistableScripts,x=nu(r),w=f.get(x);w||(w=u.querySelector(Dh(x)),w||(r=y({src:r,async:!0,type:"module"},o),(o=Zs.get(x))&&Ab(r,o),w=u.createElement("script"),rn(w),yn(w,"link",r),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},f.set(x,w))}}function d1(r,o,u,f){var x=(x=ge.current)?og(x):null;if(!x)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=tu(u.href),u=Sc(x).hoistableStyles,f=u.get(o),f||(f={type:"style",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=tu(u.href);var w=Sc(x).hoistableStyles,T=w.get(r);if(T||(x=x.ownerDocument||x,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(r,T),(w=x.querySelector(Ih(r)))&&!w._p&&(T.instance=w,T.state.loading=5),Zs.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Zs.set(r,u),w||qI(x,r,u,T.state))),o&&f===null)throw Error(n(528,""));return T}if(o&&f!==null)throw Error(n(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=nu(u),u=Sc(x).hoistableScripts,f=u.get(o),f||(f={type:"script",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function tu(r){return'href="'+Vs(r)+'"'}function Ih(r){return'link[rel="stylesheet"]['+r+"]"}function h1(r){return y({},r,{"data-precedence":r.precedence,precedence:null})}function qI(r,o,u,f){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=r.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),yn(o,"link",u),rn(o),r.head.appendChild(o))}function nu(r){return'[src="'+Vs(r)+'"]'}function Dh(r){return"script[async]"+r}function f1(r,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var f=r.querySelector('style[data-href~="'+Vs(u.href)+'"]');if(f)return o.instance=f,rn(f),f;var x=y({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(r.ownerDocument||r).createElement("style"),rn(f),yn(f,"style",x),lg(f,u.precedence,r),o.instance=f;case"stylesheet":x=tu(u.href);var w=r.querySelector(Ih(x));if(w)return o.state.loading|=4,o.instance=w,rn(w),w;f=h1(u),(x=Zs.get(x))&&Sb(f,x),w=(r.ownerDocument||r).createElement("link"),rn(w);var T=w;return T._p=new Promise(function(I,O){T.onload=I,T.onerror=O}),yn(w,"link",f),o.state.loading|=4,lg(w,u.precedence,r),o.instance=w;case"script":return w=nu(u.src),(x=r.querySelector(Dh(w)))?(o.instance=x,rn(x),x):(f=u,(x=Zs.get(w))&&(f=y({},u),Ab(f,x)),r=r.ownerDocument||r,x=r.createElement("script"),rn(x),yn(x,"link",f),r.head.appendChild(x),o.instance=x);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,lg(f,u.precedence,r));return o.instance}function lg(r,o,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=f.length?f[f.length-1]:null,w=x,T=0;T<f.length;T++){var I=f[T];if(I.dataset.precedence===o)w=I;else if(w!==x)break}w?w.parentNode.insertBefore(r,w.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(r,o.firstChild))}function Sb(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function Ab(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var cg=null;function p1(r,o,u){if(cg===null){var f=new Map,x=cg=new Map;x.set(u,f)}else x=cg,f=x.get(u),f||(f=new Map,x.set(u,f));if(f.has(r))return f;for(f.set(r,null),u=u.getElementsByTagName(r),x=0;x<u.length;x++){var w=u[x];if(!(w[Xd]||w[pn]||r==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var T=w.getAttribute(o)||"";T=r+T;var I=f.get(T);I?I.push(w):f.set(T,[w])}}return f}function m1(r,o,u){r=r.ownerDocument||r,r.head.insertBefore(u,o==="title"?r.querySelector("head > title"):null)}function VI(r,o,u){if(u===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function g1(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function $I(r,o,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var x=tu(f.href),w=o.querySelector(Ih(x));if(w){o=w._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=ug.bind(r),o.then(r,r)),u.state.loading|=4,u.instance=w,rn(w);return}w=o.ownerDocument||o,f=h1(f),(x=Zs.get(x))&&Sb(f,x),w=w.createElement("link"),rn(w);var T=w;T._p=new Promise(function(I,O){T.onload=I,T.onerror=O}),yn(w,"link",f),u.instance=w}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=ug.bind(r),o.addEventListener("load",u),o.addEventListener("error",u))}}var Eb=0;function YI(r,o){return r.stylesheets&&r.count===0&&hg(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var f=setTimeout(function(){if(r.stylesheets&&hg(r,r.stylesheets),r.unsuspend){var w=r.unsuspend;r.unsuspend=null,w()}},6e4+o);0<r.imgBytes&&Eb===0&&(Eb=62500*CI());var x=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&hg(r,r.stylesheets),r.unsuspend)){var w=r.unsuspend;r.unsuspend=null,w()}},(r.imgBytes>Eb?50:800)+o);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(f),clearTimeout(x)}}:null}function ug(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)hg(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var dg=null;function hg(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,dg=new Map,o.forEach(KI,r),dg=null,ug.call(r))}function KI(r,o){if(!(o.state.loading&4)){var u=dg.get(r);if(u)var f=u.get(null);else{u=new Map,dg.set(r,u);for(var x=r.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<x.length;w++){var T=x[w];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(u.set(T.dataset.precedence,T),f=T)}f&&u.set(null,f)}x=o.instance,T=x.getAttribute("data-precedence"),w=u.get(T)||f,w===f&&u.set(null,x),u.set(T,x),this.count++,f=ug.bind(this),x.addEventListener("load",f),x.addEventListener("error",f),w?w.parentNode.insertBefore(x,w.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(x,r.firstChild)),o.state.loading|=4}}var Ph={$$typeof:P,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function XI(r,o,u,f,x,w,T,I,O){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_v(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_v(0),this.hiddenUpdates=_v(null),this.identifierPrefix=f,this.onUncaughtError=x,this.onCaughtError=w,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function v1(r,o,u,f,x,w,T,I,O,$,Z,te){return r=new XI(r,o,u,T,O,$,Z,te,I),o=1,w===!0&&(o|=24),w=ys(3,null,null,o),r.current=w,w.stateNode=r,o=iy(),o.refCount++,r.pooledCache=o,o.refCount++,w.memoizedState={element:f,isDehydrated:u,cache:o},ly(w),r}function y1(r){return r?(r=Dc,r):Dc}function b1(r,o,u,f,x,w){x=y1(x),f.context===null?f.context=x:f.pendingContext=x,f=Ca(o),f.payload={element:u},w=w===void 0?null:w,w!==null&&(f.callback=w),u=Na(r,f,o),u!==null&&(os(u,r,o),hh(u,r,o))}function _1(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<o?u:o}}function Tb(r,o){_1(r,o),(r=r.alternate)&&_1(r,o)}function x1(r){if(r.tag===13||r.tag===31){var o=Uo(r,67108864);o!==null&&os(o,r,67108864),Tb(r,67108864)}}function w1(r){if(r.tag===13||r.tag===31){var o=Ss();o=xv(o);var u=Uo(r,o);u!==null&&os(u,r,o),Tb(r,o)}}var fg=!0;function JI(r,o,u,f){var x=j.T;j.T=null;var w=G.p;try{G.p=2,Cb(r,o,u,f)}finally{G.p=w,j.T=x}}function WI(r,o,u,f){var x=j.T;j.T=null;var w=G.p;try{G.p=8,Cb(r,o,u,f)}finally{G.p=w,j.T=x}}function Cb(r,o,u,f){if(fg){var x=Nb(f);if(x===null)fb(r,o,f,pg,u),A1(r,f);else if(ZI(x,r,o,u,f))f.stopPropagation();else if(A1(r,f),o&4&&-1<QI.indexOf(r)){for(;x!==null;){var w=wc(x);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var T=Io(w.pendingLanes);if(T!==0){var I=w;for(I.pendingLanes|=2,I.entangledLanes|=2;T;){var O=1<<31-gs(T);I.entanglements[1]|=O,T&=~O}qi(w),(rt&6)===0&&(Jm=oe()+500,Nh(0))}}break;case 31:case 13:I=Uo(w,2),I!==null&&os(I,w,2),Qm(),Tb(w,2)}if(w=Nb(f),w===null&&fb(r,o,f,pg,u),w===x)break;x=w}x!==null&&f.stopPropagation()}else fb(r,o,f,null,u)}}function Nb(r){return r=kv(r),Rb(r)}var pg=null;function Rb(r){if(pg=null,r=xc(r),r!==null){var o=a(r);if(o===null)r=null;else{var u=o.tag;if(u===13){if(r=l(o),r!==null)return r;r=null}else if(u===31){if(r=c(o),r!==null)return r;r=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return pg=r,null}function S1(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(qe()){case zn:return 2;case es:return 8;case bc:case bv:return 32;case ya:return 268435456;default:return 32}default:return 32}}var kb=!1,ja=null,za=null,Ha=null,Lh=new Map,Oh=new Map,Ba=[],QI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function A1(r,o){switch(r){case"focusin":case"focusout":ja=null;break;case"dragenter":case"dragleave":za=null;break;case"mouseover":case"mouseout":Ha=null;break;case"pointerover":case"pointerout":Lh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oh.delete(o.pointerId)}}function Uh(r,o,u,f,x,w){return r===null||r.nativeEvent!==w?(r={blockedOn:o,domEventName:u,eventSystemFlags:f,nativeEvent:w,targetContainers:[x]},o!==null&&(o=wc(o),o!==null&&x1(o)),r):(r.eventSystemFlags|=f,o=r.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),r)}function ZI(r,o,u,f,x){switch(o){case"focusin":return ja=Uh(ja,r,o,u,f,x),!0;case"dragenter":return za=Uh(za,r,o,u,f,x),!0;case"mouseover":return Ha=Uh(Ha,r,o,u,f,x),!0;case"pointerover":var w=x.pointerId;return Lh.set(w,Uh(Lh.get(w)||null,r,o,u,f,x)),!0;case"gotpointercapture":return w=x.pointerId,Oh.set(w,Uh(Oh.get(w)||null,r,o,u,f,x)),!0}return!1}function E1(r){var o=xc(r.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){r.blockedOn=o,jw(r.priority,function(){w1(u)});return}}else if(o===31){if(o=c(u),o!==null){r.blockedOn=o,jw(r.priority,function(){w1(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function mg(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var u=Nb(r.nativeEvent);if(u===null){u=r.nativeEvent;var f=new u.constructor(u.type,u);Rv=f,u.target.dispatchEvent(f),Rv=null}else return o=wc(u),o!==null&&x1(o),r.blockedOn=u,!1;o.shift()}return!0}function T1(r,o,u){mg(r)&&u.delete(o)}function eD(){kb=!1,ja!==null&&mg(ja)&&(ja=null),za!==null&&mg(za)&&(za=null),Ha!==null&&mg(Ha)&&(Ha=null),Lh.forEach(T1),Oh.forEach(T1)}function gg(r,o){r.blockedOn===o&&(r.blockedOn=null,kb||(kb=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,eD)))}var vg=null;function C1(r){vg!==r&&(vg=r,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){vg===r&&(vg=null);for(var o=0;o<r.length;o+=3){var u=r[o],f=r[o+1],x=r[o+2];if(typeof f!="function"){if(Rb(f||u)===null)continue;break}var w=wc(u);w!==null&&(r.splice(o,3),o-=3,Ny(w,{pending:!0,data:x,method:u.method,action:f},f,x))}}))}function su(r){function o(O){return gg(O,r)}ja!==null&&gg(ja,r),za!==null&&gg(za,r),Ha!==null&&gg(Ha,r),Lh.forEach(o),Oh.forEach(o);for(var u=0;u<Ba.length;u++){var f=Ba[u];f.blockedOn===r&&(f.blockedOn=null)}for(;0<Ba.length&&(u=Ba[0],u.blockedOn===null);)E1(u),u.blockedOn===null&&Ba.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var x=u[f],w=u[f+1],T=x[ts]||null;if(typeof w=="function")T||C1(u);else if(T){var I=null;if(w&&w.hasAttribute("formAction")){if(x=w,T=w[ts]||null)I=T.formAction;else if(Rb(x)!==null)continue}else I=T.action;typeof I=="function"?u[f+1]=I:(u.splice(f,3),f-=3),C1(u)}}}function N1(){function r(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(T){return x=T})},focusReset:"manual",scroll:"manual"})}function o(){x!==null&&(x(),x=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,x=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),x!==null&&(x(),x=null)}}}function Mb(r){this._internalRoot=r}yg.prototype.render=Mb.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var u=o.current,f=Ss();b1(u,f,r,o,null,null)},yg.prototype.unmount=Mb.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;b1(r.current,2,null,r,null,null),Qm(),o[_c]=null}};function yg(r){this._internalRoot=r}yg.prototype.unstable_scheduleHydration=function(r){if(r){var o=Fw();r={blockedOn:null,target:r,priority:o};for(var u=0;u<Ba.length&&o!==0&&o<Ba[u].priority;u++);Ba.splice(u,0,r),u===0&&E1(r)}};var R1=e.version;if(R1!=="19.2.3")throw Error(n(527,R1,"19.2.3"));G.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=h(o),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var tD={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bg.isDisabled&&bg.supportsFiber)try{$d=bg.inject(tD),ms=bg}catch{}}return jh.createRoot=function(r,o){if(!i(r))throw Error(n(299));var u=!1,f="",x=OA,w=UA,T=FA;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(x=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError)),o=v1(r,1,!1,null,null,u,f,null,x,w,T,N1),r[_c]=o.current,hb(r),new Mb(o)},jh.hydrateRoot=function(r,o,u){if(!i(r))throw Error(n(299));var f=!1,x="",w=OA,T=UA,I=FA,O=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(w=u.onUncaughtError),u.onCaughtError!==void 0&&(T=u.onCaughtError),u.onRecoverableError!==void 0&&(I=u.onRecoverableError),u.formState!==void 0&&(O=u.formState)),o=v1(r,1,!0,o,u??null,f,x,O,w,T,I,N1),o.context=y1(null),u=o.current,f=Ss(),f=xv(f),x=Ca(f),x.callback=null,Na(u,x,f),u=f,o.current.lanes=u,Kd(o,u),qi(o),r[_c]=o.current,hb(r),new yg(o)},jh.version="19.2.3",jh}var z1;function hD(){if(z1)return Lb.exports;z1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Lb.exports=dD(),Lb.exports}var fD=hD();const pD=hN(fD);function W0(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(s);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(s,n[i])&&(t[n[i]]=s[n[i]]);return t}function mD(s,e,t,n){function i(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(p){try{h(n.next(p))}catch(y){l(y)}}function d(p){try{h(n.throw(p))}catch(y){l(y)}}function h(p){p.done?a(p.value):i(p.value).then(c,d)}h((n=n.apply(s,e||[])).next())})}const gD=s=>s?(...e)=>s(...e):(...e)=>fetch(...e);class Zx extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class vD extends Zx{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class H1 extends Zx{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class B1 extends Zx{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var l_;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(l_||(l_={}));class yD{constructor(e,{headers:t={},customFetch:n,region:i=l_.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=gD(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return mD(this,arguments,void 0,function*(t,n={}){var i;let a,l;try{const{headers:c,method:d,body:h,signal:p,timeout:y}=n;let _={},{region:S}=n;S||(S=this.region);const A=new URL(`${this.url}/${t}`);S&&S!=="any"&&(_["x-region"]=S,A.searchParams.set("forceFunctionRegion",S));let E;h&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(_["Content-Type"]="application/octet-stream",E=h):typeof h=="string"?(_["Content-Type"]="text/plain",E=h):typeof FormData<"u"&&h instanceof FormData?E=h:(_["Content-Type"]="application/json",E=JSON.stringify(h)):h&&typeof h!="string"&&!(typeof Blob<"u"&&h instanceof Blob)&&!(h instanceof ArrayBuffer)&&!(typeof FormData<"u"&&h instanceof FormData)?E=JSON.stringify(h):E=h;let N=p;y&&(l=new AbortController,a=setTimeout(()=>l.abort(),y),p?(N=l.signal,p.addEventListener("abort",()=>l.abort())):N=l.signal);const R=yield this.fetch(A.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},_),this.headers),c),body:E,signal:N}).catch(z=>{throw new vD(z)}),D=R.headers.get("x-relay-error");if(D&&D==="true")throw new H1(R);if(!R.ok)throw new B1(R);let P=((i=R.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),L;return P==="application/json"?L=yield R.json():P==="application/octet-stream"||P==="application/pdf"?L=yield R.blob():P==="text/event-stream"?L=R:P==="multipart/form-data"?L=yield R.formData():L=yield R.text(),{data:L,error:null,response:R}}catch(c){return{data:null,error:c,response:c instanceof B1||c instanceof H1?c.context:void 0}}finally{a&&clearTimeout(a)}})}}var bD=class extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}},_D=class{constructor(s){var e,t;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(e=s.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=s.signal,this.isMaybeSingle=(t=s.isMaybeSingle)!==null&&t!==void 0?t:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,e){return this.headers=new Headers(this.headers),this.headers.set(s,e),this}then(s,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let l=null,c=null,d=null,h=a.status,p=a.statusText;if(a.ok){var y,_;if(t.method!=="HEAD"){var S;const R=await a.text();R===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((S=t.headers.get("Accept"))===null||S===void 0)&&S.includes("application/vnd.pgrst.plan+text"))?c=R:c=JSON.parse(R))}const E=(y=t.headers.get("Prefer"))===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),N=(_=a.headers.get("content-range"))===null||_===void 0?void 0:_.split("/");E&&N&&N.length>1&&(d=parseInt(N[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(c)&&(c.length>1?(l={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,h=406,p="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var A;const E=await a.text();try{l=JSON.parse(E),Array.isArray(l)&&a.status===404&&(c=[],l=null,h=200,p="OK")}catch{a.status===404&&E===""?(h=204,p="No Content"):l={message:E}}if(l&&t.isMaybeSingle&&(!(l==null||(A=l.details)===null||A===void 0)&&A.includes("0 rows"))&&(l=null,h=200,p="OK"),l&&t.shouldThrowOnError)throw new bD(l)}return{error:l,data:c,count:d,status:h,statusText:p}});return this.shouldThrowOnError||(i=i.catch(a=>{var l;let c="";const d=a==null?void 0:a.cause;if(d){var h,p,y,_;const A=(h=d==null?void 0:d.message)!==null&&h!==void 0?h:"",E=(p=d==null?void 0:d.code)!==null&&p!==void 0?p:"";c=`${(y=a==null?void 0:a.name)!==null&&y!==void 0?y:"FetchError"}: ${a==null?void 0:a.message}`,c+=`

Caused by: ${(_=d==null?void 0:d.name)!==null&&_!==void 0?_:"Error"}: ${A}`,E&&(c+=` (${E})`),d!=null&&d.stack&&(c+=`
${d.stack}`)}else{var S;c=(S=a==null?void 0:a.stack)!==null&&S!==void 0?S:""}return{error:{message:`${(l=a==null?void 0:a.name)!==null&&l!==void 0?l:"FetchError"}: ${a==null?void 0:a.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(s,e)}returns(){return this}overrideTypes(){return this}},xD=class extends _D{select(s){let e=!1;const t=(s??"*").split("").map(n=>/\s/.test(n)&&!e?"":(n==='"'&&(e=!e),n)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:e=!0,nullsFirst:t,foreignTable:n,referencedTable:i=n}={}){const a=i?`${i}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${s}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:e,referencedTable:t=e}={}){const n=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(n,`${s}`),this}range(s,e,{foreignTable:t,referencedTable:n=t}={}){const i=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${s}`),this.url.searchParams.set(a,`${e-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:e=!1,settings:t=!1,buffers:n=!1,wal:i=!1,format:a="text"}={}){var l;const c=[s?"analyze":null,e?"verbose":null,t?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${d}"; options=${c};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}};const G1=new RegExp("[,()]");var uu=class extends xD{eq(s,e){return this.url.searchParams.append(s,`eq.${e}`),this}neq(s,e){return this.url.searchParams.append(s,`neq.${e}`),this}gt(s,e){return this.url.searchParams.append(s,`gt.${e}`),this}gte(s,e){return this.url.searchParams.append(s,`gte.${e}`),this}lt(s,e){return this.url.searchParams.append(s,`lt.${e}`),this}lte(s,e){return this.url.searchParams.append(s,`lte.${e}`),this}like(s,e){return this.url.searchParams.append(s,`like.${e}`),this}likeAllOf(s,e){return this.url.searchParams.append(s,`like(all).{${e.join(",")}}`),this}likeAnyOf(s,e){return this.url.searchParams.append(s,`like(any).{${e.join(",")}}`),this}ilike(s,e){return this.url.searchParams.append(s,`ilike.${e}`),this}ilikeAllOf(s,e){return this.url.searchParams.append(s,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(s,e){return this.url.searchParams.append(s,`ilike(any).{${e.join(",")}}`),this}regexMatch(s,e){return this.url.searchParams.append(s,`match.${e}`),this}regexIMatch(s,e){return this.url.searchParams.append(s,`imatch.${e}`),this}is(s,e){return this.url.searchParams.append(s,`is.${e}`),this}isDistinct(s,e){return this.url.searchParams.append(s,`isdistinct.${e}`),this}in(s,e){const t=Array.from(new Set(e)).map(n=>typeof n=="string"&&G1.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(s,`in.(${t})`),this}notIn(s,e){const t=Array.from(new Set(e)).map(n=>typeof n=="string"&&G1.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(s,`not.in.(${t})`),this}contains(s,e){return typeof e=="string"?this.url.searchParams.append(s,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(s,`cs.{${e.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(e)}`),this}containedBy(s,e){return typeof e=="string"?this.url.searchParams.append(s,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(s,`cd.{${e.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(e)}`),this}rangeGt(s,e){return this.url.searchParams.append(s,`sr.${e}`),this}rangeGte(s,e){return this.url.searchParams.append(s,`nxl.${e}`),this}rangeLt(s,e){return this.url.searchParams.append(s,`sl.${e}`),this}rangeLte(s,e){return this.url.searchParams.append(s,`nxr.${e}`),this}rangeAdjacent(s,e){return this.url.searchParams.append(s,`adj.${e}`),this}overlaps(s,e){return typeof e=="string"?this.url.searchParams.append(s,`ov.${e}`):this.url.searchParams.append(s,`ov.{${e.join(",")}}`),this}textSearch(s,e,{config:t,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const a=t===void 0?"":`(${t})`;return this.url.searchParams.append(s,`${i}fts${a}.${e}`),this}match(s){return Object.entries(s).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(s,e,t){return this.url.searchParams.append(s,`not.${e}.${t}`),this}or(s,{foreignTable:e,referencedTable:t=e}={}){const n=t?`${t}.or`:"or";return this.url.searchParams.append(n,`(${s})`),this}filter(s,e,t){return this.url.searchParams.append(s,`${e}.${t}`),this}},wD=class{constructor(s,{headers:e={},schema:t,fetch:n}){this.url=s,this.headers=new Headers(e),this.schema=t,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(s,e){const{head:t=!1,count:n}=e??{},i=t?"HEAD":"GET";let a=!1;const l=(s??"*").split("").map(h=>/\s/.test(h)&&!a?"":(h==='"'&&(a=!a),h)).join(""),{url:c,headers:d}=this.cloneRequestState();return c.searchParams.set("select",l),n&&d.append("Prefer",`count=${n}`),new uu({method:i,url:c,headers:d,schema:this.schema,fetch:this.fetch})}insert(s,{count:e,defaultToNull:t=!0}={}){var n;const i="POST",{url:a,headers:l}=this.cloneRequestState();if(e&&l.append("Prefer",`count=${e}`),t||l.append("Prefer","missing=default"),Array.isArray(s)){const c=s.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(c.length>0){const d=[...new Set(c)].map(h=>`"${h}"`);a.searchParams.set("columns",d.join(","))}}return new uu({method:i,url:a,headers:l,schema:this.schema,body:s,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(s,{onConflict:e,ignoreDuplicates:t=!1,count:n,defaultToNull:i=!0}={}){var a;const l="POST",{url:c,headers:d}=this.cloneRequestState();if(d.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&c.searchParams.set("on_conflict",e),n&&d.append("Prefer",`count=${n}`),i||d.append("Prefer","missing=default"),Array.isArray(s)){const h=s.reduce((p,y)=>p.concat(Object.keys(y)),[]);if(h.length>0){const p=[...new Set(h)].map(y=>`"${y}"`);c.searchParams.set("columns",p.join(","))}}return new uu({method:l,url:c,headers:d,schema:this.schema,body:s,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(s,{count:e}={}){var t;const n="PATCH",{url:i,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new uu({method:n,url:i,headers:a,schema:this.schema,body:s,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:s}={}){var e;const t="DELETE",{url:n,headers:i}=this.cloneRequestState();return s&&i.append("Prefer",`count=${s}`),new uu({method:t,url:n,headers:i,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},SD=class pN{constructor(e,{headers:t={},schema:n,fetch:i}={}){this.url=e,this.headers=new Headers(t),this.schemaName=n,this.fetch=i}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new wD(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new pN(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:i=!1,count:a}={}){var l;let c;const d=new URL(`${this.url}/rpc/${e}`);let h;const p=S=>S!==null&&typeof S=="object"&&(!Array.isArray(S)||S.some(p)),y=n&&Object.values(t).some(p);y?(c="POST",h=t):n||i?(c=n?"HEAD":"GET",Object.entries(t).filter(([S,A])=>A!==void 0).map(([S,A])=>[S,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([S,A])=>{d.searchParams.append(S,A)})):(c="POST",h=t);const _=new Headers(this.headers);return y?_.set("Prefer",a?`count=${a},return=minimal`:"return=minimal"):a&&_.set("Prefer",`count=${a}`),new uu({method:c,url:d,headers:_,schema:this.schemaName,body:h,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class AD{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const n=t.versions;if(n&&n.node){const i=n.node,a=parseInt(i.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const ED="2.90.1",TD=`realtime-js/${ED}`,mN="1.0.0",CD="2.0.0",q1=mN,c_=1e4,ND=1e3,RD=100;var Va;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Va||(Va={}));var Zt;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(Zt||(Zt={}));var Ii;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(Ii||(Ii={}));var u_;(function(s){s.websocket="websocket"})(u_||(u_={}));var sl;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(sl||(sl={}));class kD{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,n;const i=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(e){var t,n;const i=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(e,t,n){var i,a;const l=e.topic,c=(i=e.ref)!==null&&i!==void 0?i:"",d=(a=e.join_ref)!==null&&a!==void 0?a:"",h=e.payload.event,p=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},y=Object.keys(p).length===0?"":JSON.stringify(p);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`metadata length ${y.length} exceeds maximum of 255`);const _=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+c.length+l.length+h.length+y.length,S=new ArrayBuffer(this.HEADER_LENGTH+_);let A=new DataView(S),E=0;A.setUint8(E++,this.KINDS.userBroadcastPush),A.setUint8(E++,d.length),A.setUint8(E++,c.length),A.setUint8(E++,l.length),A.setUint8(E++,h.length),A.setUint8(E++,y.length),A.setUint8(E++,t),Array.from(d,R=>A.setUint8(E++,R.charCodeAt(0))),Array.from(c,R=>A.setUint8(E++,R.charCodeAt(0))),Array.from(l,R=>A.setUint8(E++,R.charCodeAt(0))),Array.from(h,R=>A.setUint8(E++,R.charCodeAt(0))),Array.from(y,R=>A.setUint8(E++,R.charCodeAt(0)));var N=new Uint8Array(S.byteLength+n.byteLength);return N.set(new Uint8Array(S),0),N.set(new Uint8Array(n),S.byteLength),N.buffer}decode(e,t){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return t(n)}if(typeof e=="string"){const n=JSON.parse(e),[i,a,l,c,d]=n;return t({join_ref:i,ref:a,topic:l,event:c,payload:d})}return t({})}_binaryDecode(e){const t=new DataView(e),n=t.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,i)}}_decodeUserBroadcast(e,t,n){const i=t.getUint8(1),a=t.getUint8(2),l=t.getUint8(3),c=t.getUint8(4);let d=this.HEADER_LENGTH+4;const h=n.decode(e.slice(d,d+i));d=d+i;const p=n.decode(e.slice(d,d+a));d=d+a;const y=n.decode(e.slice(d,d+l));d=d+l;const _=e.slice(d,e.byteLength),S=c===this.JSON_ENCODING?JSON.parse(n.decode(_)):_,A={type:this.BROADCAST_EVENT,event:p,payload:S};return l>0&&(A.meta=JSON.parse(y)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:A}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([n])=>t.includes(n)))}}class gN{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var _t;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(_t||(_t={}));const V1=(s,e,t={})=>{var n;const i=(n=t.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((a,l)=>(a[l]=MD(l,s,e,i),a),{}):{}},MD=(s,e,t,n)=>{const i=e.find(c=>c.name===s),a=i==null?void 0:i.type,l=t[s];return a&&!n.includes(a)?vN(a,l):d_(l)},vN=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return LD(e,t)}switch(s){case _t.bool:return ID(e);case _t.float4:case _t.float8:case _t.int2:case _t.int4:case _t.int8:case _t.numeric:case _t.oid:return DD(e);case _t.json:case _t.jsonb:return PD(e);case _t.timestamp:return OD(e);case _t.abstime:case _t.date:case _t.daterange:case _t.int4range:case _t.int8range:case _t.money:case _t.reltime:case _t.text:case _t.time:case _t.timestamptz:case _t.timetz:case _t.tsrange:case _t.tstzrange:return d_(e);default:return d_(e)}},d_=s=>s,ID=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},DD=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},PD=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch{return s}return s},LD=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,n=s[t];if(s[0]==="{"&&n==="}"){let a;const l=s.slice(1,t);try{a=JSON.parse("["+l+"]")}catch{a=l?l.split(","):[]}return a.map(c=>vN(e,c))}return s},OD=s=>typeof s=="string"?s.replace(" ","T"):s,yN=s=>{const e=new URL(s);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class jb{constructor(e,t,n={},i=c_){this.channel=e,this.event=t,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var $1;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})($1||($1={}));class ff{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ff.syncState(this.state,i,a,l),this.pendingDiffs.forEach(d=>{this.state=ff.syncDiff(this.state,d,a,l)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},i=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ff.syncDiff(this.state,i,a,l),c())}),this.onJoin((i,a,l)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:l})}),this.onLeave((i,a,l)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,i){const a=this.cloneDeep(e),l=this.transformState(t),c={},d={};return this.map(a,(h,p)=>{l[h]||(d[h]=p)}),this.map(l,(h,p)=>{const y=a[h];if(y){const _=p.map(N=>N.presence_ref),S=y.map(N=>N.presence_ref),A=p.filter(N=>S.indexOf(N.presence_ref)<0),E=y.filter(N=>_.indexOf(N.presence_ref)<0);A.length>0&&(c[h]=A),E.length>0&&(d[h]=E)}else c[h]=p}),this.syncDiff(a,{joins:c,leaves:d},n,i)}static syncDiff(e,t,n,i){const{joins:a,leaves:l}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(a,(c,d)=>{var h;const p=(h=e[c])!==null&&h!==void 0?h:[];if(e[c]=this.cloneDeep(d),p.length>0){const y=e[c].map(S=>S.presence_ref),_=p.filter(S=>y.indexOf(S.presence_ref)<0);e[c].unshift(..._)}n(c,p,d)}),this.map(l,(c,d)=>{let h=e[c];if(!h)return;const p=d.map(y=>y.presence_ref);h=h.filter(y=>p.indexOf(y.presence_ref)<0),e[c]=h,i(c,h,d),h.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const i=e[n];return"metas"in i?t[n]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[n]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Y1;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(Y1||(Y1={}));var pf;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(pf||(pf={}));var Pr;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Pr||(Pr={}));class xu{constructor(e,t={config:{}},n){var i,a;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Zt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new jb(this,Ii.join,this.params,this.timeout),this.rejoinTimer=new gN(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Zt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Zt.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ii.reply,{},(l,c)=>{this._trigger(this._replyEventName(c),l)}),this.presence=new ff(this),this.broadcastEndpointURL=yN(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var n,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Zt.closed){const{config:{broadcast:l,presence:c,private:d}}=this.params,h=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(S=>S.filter))!==null&&i!==void 0?i:[],p=!!this.bindings[pf.PRESENCE]&&this.bindings[pf.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,y={},_={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:p}),postgres_changes:h,private:d};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(S=>e==null?void 0:e(Pr.CHANNEL_ERROR,S)),this._onClose(()=>e==null?void 0:e(Pr.CLOSED)),this.updateJoinPayload(Object.assign({config:_},y)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:S})=>{var A;if(this.socket._isManualToken()||this.socket.setAuth(),S===void 0){e==null||e(Pr.SUBSCRIBED);return}else{const E=this.bindings.postgres_changes,N=(A=E==null?void 0:E.length)!==null&&A!==void 0?A:0,R=[];for(let D=0;D<N;D++){const P=E[D],{filter:{event:L,schema:z,table:H,filter:F}}=P,X=S&&S[D];if(X&&X.event===L&&xu.isFilterValueEqual(X.schema,z)&&xu.isFilterValueEqual(X.table,H)&&xu.isFilterValueEqual(X.filter,F))R.push(Object.assign(Object.assign({},P),{id:X.id}));else{this.unsubscribe(),this.state=Zt.errored,e==null||e(Pr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=R,e&&e(Pr.SUBSCRIBED);return}}).receive("error",S=>{this.state=Zt.errored,e==null||e(Pr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Pr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===Zt.joined&&e===pf.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,n)}async httpSend(e,t,n={}){var i;if(t==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(c.status===202)return{success:!0};let d=c.statusText;try{const h=await c.json();d=h.error||h.message||d}catch{}return Promise.reject(new Error(d))}async send(e,t={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:l}=e,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:l,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=h.body)===null||i===void 0?void 0:i.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var l,c,d;const h=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),h.receive("ok",()=>a("ok")),h.receive("error",()=>a("error")),h.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Zt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ii.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new jb(this,Ii.leave,{},e),n.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Zt.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const i=new AbortController,a=setTimeout(()=>i.abort(),n),l=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(a),l}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new jb(this,e,t,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>RD){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var i,a;const l=e.toLocaleLowerCase(),{close:c,error:d,leave:h,join:p}=Ii;if(n&&[c,d,h,p].indexOf(l)>=0&&n!==this._joinRef())return;let _=this._onMessage(l,t,n);if(t&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(S=>{var A,E,N;return((A=S.filter)===null||A===void 0?void 0:A.event)==="*"||((N=(E=S.filter)===null||E===void 0?void 0:E.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===l}).map(S=>S.callback(_,n)):(a=this.bindings[l])===null||a===void 0||a.filter(S=>{var A,E,N,R,D,P,L,z;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in S){const H=S.id,F=(A=S.filter)===null||A===void 0?void 0:A.event;return H&&((E=t.ids)===null||E===void 0?void 0:E.includes(H))&&(F==="*"||(F==null?void 0:F.toLocaleLowerCase())===((N=t.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))&&(!(!((R=S.filter)===null||R===void 0)&&R.table)||S.filter.table===((D=t.data)===null||D===void 0?void 0:D.table))}else{const H=(L=(P=S==null?void 0:S.filter)===null||P===void 0?void 0:P.event)===null||L===void 0?void 0:L.toLocaleLowerCase();return H==="*"||H===((z=t==null?void 0:t.event)===null||z===void 0?void 0:z.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===l}).map(S=>{if(typeof _=="object"&&"ids"in _){const A=_.data,{schema:E,table:N,commit_timestamp:R,type:D,errors:P}=A;_=Object.assign(Object.assign({},{schema:E,table:N,commit_timestamp:R,eventType:D,new:{},old:{},errors:P}),this._getPayloadRecords(A))}S.callback(_,n)})}_isClosed(){return this.state===Zt.closed}_isJoined(){return this.state===Zt.joined}_isJoining(){return this.state===Zt.joining}_isLeaving(){return this.state===Zt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const i=e.toLocaleLowerCase(),a={type:i,filter:t,callback:n};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&xu.isEqual(i.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ii.close,{},e)}_onError(e){this._on(Ii.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Zt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=V1(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=V1(e.columns,e.old_record)),t}}const zb=()=>{},_g={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},UD=[1e3,2e3,5e3,1e4],FD=1e4,jD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class zD{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=c_,this.transport=null,this.heartbeatIntervalMs=_g.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=zb,this.ref=0,this.reconnectTimer=null,this.vsn=q1,this.logger=zb,this.conn=null,this.sendBuffer=[],this.serializer=new kD,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),!(!((n=t==null?void 0:t.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${u_.websocket}`,this.httpEndpoint=yN(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=AD.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Va.connecting:return sl.Connecting;case Va.open:return sl.Open;case Va.closing:return sl.Closing;default:return sl.Closed}}isConnected(){return this.connectionState()===sl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(a=>a.topic===n);if(i)return i;{const a=new xu(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:n,payload:i,ref:a}=e,l=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${t} ${n} (${a})`,i),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(ND,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},_g.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const h=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",h)}catch(p){this.log("error","error in heartbeat callback",p)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:a,ref:l}=t,c=l?`(${l})`:"",d=a.status||"";this.log("receive",`${d} ${n} ${i} ${c}`.trim(),a),this.channels.filter(h=>h._isMember(n)).forEach(h=>h._trigger(i,a,l)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Va.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Va.open||this.conn.readyState===Va.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ii.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${n}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([jD],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,n=!1;if(e)t=e,n=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),t=this.accessTokenValue}else t=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(i=>{const a={access_token:t,version:TD};t&&i.updateJoinPayload(a),i.joinedOnce&&i._isJoined()&&i._push(Ii.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new gN(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},_g.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,i,a,l,c,d,h,p,y,_,S;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:c_,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:_g.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(l=e==null?void 0:e.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(c=e==null?void 0:e.heartbeatCallback)!==null&&c!==void 0?c:zb,this.vsn=(d=e==null?void 0:e.vsn)!==null&&d!==void 0?d:q1,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e==null?void 0:e.reconnectAfterMs)!==null&&h!==void 0?h:(A=>UD[A-1]||FD),this.vsn){case mN:this.encode=(p=e==null?void 0:e.encode)!==null&&p!==void 0?p:((A,E)=>E(JSON.stringify(A))),this.decode=(y=e==null?void 0:e.decode)!==null&&y!==void 0?y:((A,E)=>E(JSON.parse(A)));break;case CD:this.encode=(_=e==null?void 0:e.encode)!==null&&_!==void 0?_:this.serializer.encode.bind(this.serializer),this.decode=(S=e==null?void 0:e.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var vf=class extends Error{constructor(s,e){var t;super(s),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function HD(s,e,t){const n=new URL(e,s);if(t)for(const[i,a]of Object.entries(t))a!==void 0&&n.searchParams.set(i,a);return n.toString()}async function BD(s){return!s||s.type==="none"?{}:s.type==="bearer"?{Authorization:`Bearer ${s.token}`}:s.type==="header"?{[s.name]:s.value}:s.type==="custom"?await s.getHeaders():{}}function GD(s){const e=s.fetchImpl??globalThis.fetch;return{async request({method:t,path:n,query:i,body:a,headers:l}){const c=HD(s.baseUrl,n,i),d=await BD(s.auth),h=await e(c,{method:t,headers:{...a?{"Content-Type":"application/json"}:{},...d,...l},body:a?JSON.stringify(a):void 0}),p=await h.text(),y=(h.headers.get("content-type")||"").includes("application/json"),_=y&&p?JSON.parse(p):p;if(!h.ok){const S=y?_:void 0,A=S==null?void 0:S.error;throw new vf((A==null?void 0:A.message)??`Request failed with status ${h.status}`,{status:h.status,icebergType:A==null?void 0:A.type,icebergCode:A==null?void 0:A.code,details:S})}return{status:h.status,headers:h.headers,data:_}}}}function xg(s){return s.join("")}var qD=class{constructor(s,e=""){this.client=s,this.prefix=e}async listNamespaces(s){const e=s?{parent:xg(s.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(s,e){const t={namespace:s.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${xg(s.namespace)}`})}async loadNamespaceMetadata(s){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${xg(s.namespace)}`})).data.properties}}async namespaceExists(s){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${xg(s.namespace)}`}),!0}catch(e){if(e instanceof vf&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(s,e){try{return await this.createNamespace(s,e)}catch(t){if(t instanceof vf&&t.status===409)return;throw t}}};function iu(s){return s.join("")}var VD=class{constructor(s,e="",t){this.client=s,this.prefix=e,this.accessDelegation=t}async listTables(s){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${iu(s.namespace)}/tables`})).data.identifiers}async createTable(s,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${iu(s.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(s,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${iu(s.namespace)}/tables/${s.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(s,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${iu(s.namespace)}/tables/${s.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(s){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${iu(s.namespace)}/tables/${s.name}`,headers:e})).data.metadata}async tableExists(s){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${iu(s.namespace)}/tables/${s.name}`,headers:e}),!0}catch(t){if(t instanceof vf&&t.status===404)return!1;throw t}}async createTableIfNotExists(s,e){try{return await this.createTable(s,e)}catch(t){if(t instanceof vf&&t.status===409)return await this.loadTable({namespace:s.namespace,name:e.name});throw t}}},$D=class{constructor(s){var n;let e="v1";s.catalogName&&(e+=`/${s.catalogName}`);const t=s.baseUrl.endsWith("/")?s.baseUrl:`${s.baseUrl}/`;this.client=GD({baseUrl:t,auth:s.auth,fetchImpl:s.fetch}),this.accessDelegation=(n=s.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new qD(this.client,e),this.tableOps=new VD(this.client,e,this.accessDelegation)}async listNamespaces(s){return this.namespaceOps.listNamespaces(s)}async createNamespace(s,e){return this.namespaceOps.createNamespace(s,e)}async dropNamespace(s){await this.namespaceOps.dropNamespace(s)}async loadNamespaceMetadata(s){return this.namespaceOps.loadNamespaceMetadata(s)}async listTables(s){return this.tableOps.listTables(s)}async createTable(s,e){return this.tableOps.createTable(s,e)}async updateTable(s,e){return this.tableOps.updateTable(s,e)}async dropTable(s,e){await this.tableOps.dropTable(s,e)}async loadTable(s){return this.tableOps.loadTable(s)}async namespaceExists(s){return this.namespaceOps.namespaceExists(s)}async tableExists(s){return this.tableOps.tableExists(s)}async createNamespaceIfNotExists(s,e){return this.namespaceOps.createNamespaceIfNotExists(s,e)}async createTableIfNotExists(s,e){return this.tableOps.createTableIfNotExists(s,e)}},Q0=class extends Error{constructor(s){super(s),this.__isStorageError=!0,this.name="StorageError"}};function Mt(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}var YD=class extends Q0{constructor(s,e,t){super(s),this.name="StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},h_=class extends Q0{constructor(s,e){super(s),this.name="StorageUnknownError",this.originalError=e}};const ew=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),KD=()=>Response,f_=s=>{if(Array.isArray(s))return s.map(t=>f_(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,n])=>{const i=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[i]=f_(n)}),e},XD=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},JD=s=>!s||typeof s!="string"||s.length===0||s.length>100||s.trim()!==s||s.includes("/")||s.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(s);function yf(s){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yf(s)}function WD(s,e){if(yf(s)!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e);if(yf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function QD(s){var e=WD(s,"string");return yf(e)=="symbol"?e:e+""}function ZD(s,e,t){return(e=QD(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function K1(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,n)}return t}function Pe(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?K1(Object(t),!0).forEach(function(n){ZD(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):K1(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}const Hb=s=>{var e;return s.msg||s.message||s.error_description||(typeof s.error=="string"?s.error:(e=s.error)===null||e===void 0?void 0:e.message)||JSON.stringify(s)},eP=async(s,e,t)=>{s instanceof await KD()&&!(t!=null&&t.noResolveJson)?s.json().then(n=>{const i=s.status||500,a=(n==null?void 0:n.statusCode)||i+"";e(new YD(Hb(n),i,a))}).catch(n=>{e(new h_(Hb(n),n))}):e(new h_(Hb(s),s))},tP=(s,e,t,n)=>{const i={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"||!n?i:(XD(n)?(i.headers=Pe({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,e!=null&&e.duplex&&(i.duplex=e.duplex),Pe(Pe({},i),t))};async function Qp(s,e,t,n,i,a){return new Promise((l,c)=>{s(t,tP(e,n,i,a)).then(d=>{if(!d.ok)throw d;return n!=null&&n.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>eP(d,c,n))})}async function bf(s,e,t,n){return Qp(s,"GET",e,t,n)}async function yi(s,e,t,n,i){return Qp(s,"POST",e,n,i,t)}async function p_(s,e,t,n,i){return Qp(s,"PUT",e,n,i,t)}async function nP(s,e,t,n){return Qp(s,"HEAD",e,Pe(Pe({},t),{},{noResolveJson:!0}),n)}async function tw(s,e,t,n,i){return Qp(s,"DELETE",e,n,i,t)}var sP=class{constructor(s,e){this.downloadFn=s,this.shouldThrowOnError=e}then(s,e){return this.execute().then(s,e)}async execute(){var s=this;try{return{data:(await s.downloadFn()).body,error:null}}catch(e){if(s.shouldThrowOnError)throw e;if(Mt(e))return{data:null,error:e};throw e}}};let bN;bN=Symbol.toStringTag;var iP=class{constructor(s,e){this.downloadFn=s,this.shouldThrowOnError=e,this[bN]="BlobDownloadBuilder",this.promise=null}asStream(){return new sP(this.downloadFn,this.shouldThrowOnError)}then(s,e){return this.getPromise().then(s,e)}catch(s){return this.getPromise().catch(s)}finally(s){return this.getPromise().finally(s)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var s=this;try{return{data:await(await s.downloadFn()).blob(),error:null}}catch(e){if(s.shouldThrowOnError)throw e;if(Mt(e))return{data:null,error:e};throw e}}};const rP={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},X1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var aP=class{constructor(s,e={},t,n){this.shouldThrowOnError=!1,this.url=s,this.headers=e,this.bucketId=t,this.fetch=ew(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(s,e,t,n){var i=this;try{let a;const l=Pe(Pe({},X1),n);let c=Pe(Pe({},i.headers),s==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&t instanceof Blob?(a=new FormData,a.append("cacheControl",l.cacheControl),d&&a.append("metadata",i.encodeMetadata(d)),a.append("",t)):typeof FormData<"u"&&t instanceof FormData?(a=t,a.has("cacheControl")||a.append("cacheControl",l.cacheControl),d&&!a.has("metadata")&&a.append("metadata",i.encodeMetadata(d))):(a=t,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=i.toBase64(i.encodeMetadata(d))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(c=Pe(Pe({},c),n.headers));const h=i._removeEmptyFolders(e),p=i._getFinalPath(h),y=await(s=="PUT"?p_:yi)(i.fetch,`${i.url}/object/${p}`,a,Pe({headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{data:{path:h,id:y.Id,fullPath:y.Key},error:null}}catch(a){if(i.shouldThrowOnError)throw a;if(Mt(a))return{data:null,error:a};throw a}}async upload(s,e,t){return this.uploadOrUpdate("POST",s,e,t)}async uploadToSignedUrl(s,e,t,n){var i=this;const a=i._removeEmptyFolders(s),l=i._getFinalPath(a),c=new URL(i.url+`/object/upload/sign/${l}`);c.searchParams.set("token",e);try{let d;const h=Pe({upsert:X1.upsert},n),p=Pe(Pe({},i.headers),{"x-upsert":String(h.upsert)});return typeof Blob<"u"&&t instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",t)):typeof FormData<"u"&&t instanceof FormData?(d=t,d.append("cacheControl",h.cacheControl)):(d=t,p["cache-control"]=`max-age=${h.cacheControl}`,p["content-type"]=h.contentType),{data:{path:a,fullPath:(await p_(i.fetch,c.toString(),d,{headers:p})).Key},error:null}}catch(d){if(i.shouldThrowOnError)throw d;if(Mt(d))return{data:null,error:d};throw d}}async createSignedUploadUrl(s,e){var t=this;try{let n=t._getFinalPath(s);const i=Pe({},t.headers);e!=null&&e.upsert&&(i["x-upsert"]="true");const a=await yi(t.fetch,`${t.url}/object/upload/sign/${n}`,{},{headers:i}),l=new URL(t.url+a.url),c=l.searchParams.get("token");if(!c)throw new Q0("No token returned by API");return{data:{signedUrl:l.toString(),path:s,token:c},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}}async update(s,e,t){return this.uploadOrUpdate("PUT",s,e,t)}async move(s,e,t){var n=this;try{return{data:await yi(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:s,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Mt(i))return{data:null,error:i};throw i}}async copy(s,e,t){var n=this;try{return{data:{path:(await yi(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:s,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:n.headers})).Key},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Mt(i))return{data:null,error:i};throw i}}async createSignedUrl(s,e,t){var n=this;try{let i=n._getFinalPath(s),a=await yi(n.fetch,`${n.url}/object/sign/${i}`,Pe({expiresIn:e},t!=null&&t.transform?{transform:t.transform}:{}),{headers:n.headers});const l=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return a={signedUrl:encodeURI(`${n.url}${a.signedURL}${l}`)},{data:a,error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Mt(i))return{data:null,error:i};throw i}}async createSignedUrls(s,e,t){var n=this;try{const i=await yi(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:e,paths:s},{headers:n.headers}),a=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:i.map(l=>Pe(Pe({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${a}`):null})),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Mt(i))return{data:null,error:i};throw i}}download(s,e){const t=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),i=n?`?${n}`:"",a=this._getFinalPath(s),l=()=>bf(this.fetch,`${this.url}/${t}/${a}${i}`,{headers:this.headers,noResolveJson:!0});return new iP(l,this.shouldThrowOnError)}async info(s){var e=this;const t=e._getFinalPath(s);try{return{data:f_(await bf(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}}async exists(s){var e=this;const t=e._getFinalPath(s);try{return await nP(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Mt(n)&&n instanceof h_){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(s,e){const t=this._getFinalPath(s),n=[],i=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";i!==""&&n.push(i);const a=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${t}${c}`)}}}async remove(s){var e=this;try{return{data:await tw(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:s},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Mt(t))return{data:null,error:t};throw t}}async list(s,e,t){var n=this;try{const i=Pe(Pe(Pe({},rP),e),{},{prefix:s||""});return{data:await yi(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},t),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Mt(i))return{data:null,error:i};throw i}}async listV2(s,e){var t=this;try{const n=Pe({},s);return{data:await yi(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,n,{headers:t.headers},e),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s.replace(/^\/+/,"")}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const e=[];return s.width&&e.push(`width=${s.width}`),s.height&&e.push(`height=${s.height}`),s.resize&&e.push(`resize=${s.resize}`),s.format&&e.push(`format=${s.format}`),s.quality&&e.push(`quality=${s.quality}`),e.join("&")}};const _N="2.90.1",xN={"X-Client-Info":`storage-js/${_N}`};var oP=class{constructor(s,e={},t,n){this.shouldThrowOnError=!1;const i=new URL(s);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Pe(Pe({},xN),e),this.fetch=ew(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(s){var e=this;try{const t=e.listBucketOptionsToQueryString(s);return{data:await bf(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Mt(t))return{data:null,error:t};throw t}}async getBucket(s){var e=this;try{return{data:await bf(e.fetch,`${e.url}/bucket/${s}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Mt(t))return{data:null,error:t};throw t}}async createBucket(s,e={public:!1}){var t=this;try{return{data:await yi(t.fetch,`${t.url}/bucket`,{id:s,name:s,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}}async updateBucket(s,e){var t=this;try{return{data:await p_(t.fetch,`${t.url}/bucket/${s}`,{id:s,name:s,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}}async emptyBucket(s){var e=this;try{return{data:await yi(e.fetch,`${e.url}/bucket/${s}/empty`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Mt(t))return{data:null,error:t};throw t}}async deleteBucket(s){var e=this;try{return{data:await tw(e.fetch,`${e.url}/bucket/${s}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Mt(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(s){const e={};return s&&("limit"in s&&(e.limit=String(s.limit)),"offset"in s&&(e.offset=String(s.offset)),s.search&&(e.search=s.search),s.sortColumn&&(e.sortColumn=s.sortColumn),s.sortOrder&&(e.sortOrder=s.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},lP=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},xN),e),this.fetch=ew(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(s){var e=this;try{return{data:await yi(e.fetch,`${e.url}/bucket`,{name:s},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Mt(t))return{data:null,error:t};throw t}}async listBuckets(s){var e=this;try{const t=new URLSearchParams;(s==null?void 0:s.limit)!==void 0&&t.set("limit",s.limit.toString()),(s==null?void 0:s.offset)!==void 0&&t.set("offset",s.offset.toString()),s!=null&&s.sortColumn&&t.set("sortColumn",s.sortColumn),s!=null&&s.sortOrder&&t.set("sortOrder",s.sortOrder),s!=null&&s.search&&t.set("search",s.search);const n=t.toString(),i=n?`${e.url}/bucket?${n}`:`${e.url}/bucket`;return{data:await bf(e.fetch,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Mt(t))return{data:null,error:t};throw t}}async deleteBucket(s){var e=this;try{return{data:await tw(e.fetch,`${e.url}/bucket/${s}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Mt(t))return{data:null,error:t};throw t}}from(s){var e=this;if(!JD(s))throw new Q0("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new $D({baseUrl:this.url,catalogName:s,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(t,{get(i,a){const l=i[a];return typeof l!="function"?l:async(...c)=>{try{return{data:await l.apply(i,c),error:null}}catch(d){if(n)throw d;return{data:null,error:d}}}}})}};const nw={"X-Client-Info":`storage-js/${_N}`,"Content-Type":"application/json"};var wN=class extends Error{constructor(s){super(s),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function js(s){return typeof s=="object"&&s!==null&&"__isStorageVectorsError"in s}var Bb=class extends wN{constructor(s,e,t){super(s),this.name="StorageVectorsApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},cP=class extends wN{constructor(s,e){super(s),this.name="StorageVectorsUnknownError",this.originalError=e}};const sw=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),uP=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},J1=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),dP=async(s,e,t)=>{if(s&&typeof s=="object"&&"status"in s&&"ok"in s&&typeof s.status=="number"&&!(t!=null&&t.noResolveJson)){const n=s.status||500,i=s;if(typeof i.json=="function")i.json().then(a=>{const l=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||n+"";e(new Bb(J1(a),n,l))}).catch(()=>{const a=n+"";e(new Bb(i.statusText||`HTTP ${n} error`,n,a))});else{const a=n+"";e(new Bb(i.statusText||`HTTP ${n} error`,n,a))}}else e(new cP(J1(s),s))},hP=(s,e,t,n)=>{const i={method:s,headers:(e==null?void 0:e.headers)||{}};return n?(uP(n)?(i.headers=Pe({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,Pe(Pe({},i),t)):i};async function fP(s,e,t,n,i,a){return new Promise((l,c)=>{s(t,hP(e,n,i,a)).then(d=>{if(!d.ok)throw d;if(n!=null&&n.noResolveJson)return d;const h=d.headers.get("content-type");return!h||!h.includes("application/json")?{}:d.json()}).then(d=>l(d)).catch(d=>dP(d,c,n))})}async function zs(s,e,t,n,i){return fP(s,"POST",e,n,i,t)}var pP=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},nw),e),this.fetch=sw(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(s){var e=this;try{return{data:await zs(e.fetch,`${e.url}/CreateIndex`,s,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(js(t))return{data:null,error:t};throw t}}async getIndex(s,e){var t=this;try{return{data:await zs(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:s,indexName:e},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(js(n))return{data:null,error:n};throw n}}async listIndexes(s){var e=this;try{return{data:await zs(e.fetch,`${e.url}/ListIndexes`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(js(t))return{data:null,error:t};throw t}}async deleteIndex(s,e){var t=this;try{return{data:await zs(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:s,indexName:e},{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(js(n))return{data:null,error:n};throw n}}},mP=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},nw),e),this.fetch=sw(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(s){var e=this;try{if(s.vectors.length<1||s.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await zs(e.fetch,`${e.url}/PutVectors`,s,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(js(t))return{data:null,error:t};throw t}}async getVectors(s){var e=this;try{return{data:await zs(e.fetch,`${e.url}/GetVectors`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(js(t))return{data:null,error:t};throw t}}async listVectors(s){var e=this;try{if(s.segmentCount!==void 0){if(s.segmentCount<1||s.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(s.segmentIndex!==void 0&&(s.segmentIndex<0||s.segmentIndex>=s.segmentCount))throw new Error(`segmentIndex must be between 0 and ${s.segmentCount-1}`)}return{data:await zs(e.fetch,`${e.url}/ListVectors`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(js(t))return{data:null,error:t};throw t}}async queryVectors(s){var e=this;try{return{data:await zs(e.fetch,`${e.url}/QueryVectors`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(js(t))return{data:null,error:t};throw t}}async deleteVectors(s){var e=this;try{if(s.keys.length<1||s.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await zs(e.fetch,`${e.url}/DeleteVectors`,s,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(js(t))return{data:null,error:t};throw t}}},gP=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},nw),e),this.fetch=sw(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(s){var e=this;try{return{data:await zs(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:s},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(js(t))return{data:null,error:t};throw t}}async getBucket(s){var e=this;try{return{data:await zs(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:s},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(js(t))return{data:null,error:t};throw t}}async listBuckets(s={}){var e=this;try{return{data:await zs(e.fetch,`${e.url}/ListVectorBuckets`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(js(t))return{data:null,error:t};throw t}}async deleteBucket(s){var e=this;try{return{data:await zs(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:s},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(js(t))return{data:null,error:t};throw t}}},vP=class extends gP{constructor(s,e={}){super(s,e.headers||{},e.fetch)}from(s){return new yP(this.url,this.headers,s,this.fetch)}async createBucket(s){var e=()=>super.createBucket,t=this;return e().call(t,s)}async getBucket(s){var e=()=>super.getBucket,t=this;return e().call(t,s)}async listBuckets(s={}){var e=()=>super.listBuckets,t=this;return e().call(t,s)}async deleteBucket(s){var e=()=>super.deleteBucket,t=this;return e().call(t,s)}},yP=class extends pP{constructor(s,e,t,n){super(s,e,n),this.vectorBucketName=t}async createIndex(s){var e=()=>super.createIndex,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(s={}){var e=()=>super.listIndexes,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(s){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,s)}async deleteIndex(s){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,s)}index(s){return new bP(this.url,this.headers,this.vectorBucketName,s,this.fetch)}},bP=class extends mP{constructor(s,e,t,n,i){super(s,e,i),this.vectorBucketName=t,this.indexName=n}async putVectors(s){var e=()=>super.putVectors,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(s){var e=()=>super.getVectors,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(s={}){var e=()=>super.listVectors,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(s){var e=()=>super.queryVectors,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(s){var e=()=>super.deleteVectors,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},_P=class extends oP{constructor(s,e={},t,n){super(s,e,t,n)}from(s){return new aP(this.url,this.headers,s,this.fetch)}get vectors(){return new vP(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new lP(this.url+"/iceberg",this.headers,this.fetch)}};const SN="2.90.1",du=30*1e3,m_=3,Gb=m_*du,xP="http://localhost:9999",wP="supabase.auth.token",SP={"X-Client-Info":`gotrue-js/${SN}`},g_="X-Supabase-Api-Version",AN={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},AP=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,EP=600*1e3;class _f extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Te(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class TP extends _f{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function CP(s){return Te(s)&&s.name==="AuthApiError"}class il extends _f{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ma extends _f{constructor(e,t,n,i){super(e,n,i),this.name=t,this.status=n}}class As extends ma{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function NP(s){return Te(s)&&s.name==="AuthSessionMissingError"}class ru extends ma{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class wg extends ma{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Sg extends ma{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function RP(s){return Te(s)&&s.name==="AuthImplicitGrantRedirectError"}class W1 extends ma{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class kP extends ma{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class v_ extends ma{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function qb(s){return Te(s)&&s.name==="AuthRetryableFetchError"}class Q1 extends ma{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class y_ extends ma{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const h0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Z1=` 	
\r=`.split(""),MP=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<Z1.length;e+=1)s[Z1[e].charCodeAt(0)]=-2;for(let e=0;e<h0.length;e+=1)s[h0[e].charCodeAt(0)]=e;return s})();function eT(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(h0[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(h0[n]),e.queuedBits-=6}}function EN(s,e,t){const n=MP[s];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function tT(s){const e=[],t=l=>{e.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=l=>{PP(l,n,t)};for(let l=0;l<s.length;l+=1)EN(s.charCodeAt(l),i,a);return e.join("")}function IP(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function DP(s,e){for(let t=0;t<s.length;t+=1){let n=s.charCodeAt(t);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(s.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}IP(n,e)}}function PP(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let n=1;n<6;n+=1)if((s>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Tu(s){const e=[],t={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<s.length;i+=1)EN(s.charCodeAt(i),t,n);return new Uint8Array(e)}function LP(s){const e=[];return DP(s,t=>e.push(t)),new Uint8Array(e)}function ol(s){const e=[],t={queue:0,queuedBits:0},n=i=>{e.push(i)};return s.forEach(i=>eT(i,t,n)),eT(null,t,n),e.join("")}function OP(s){return Math.round(Date.now()/1e3)+s}function UP(){return Symbol("auth-callback")}const _n=()=>typeof window<"u"&&typeof document<"u",Jo={tested:!1,writable:!1},TN=()=>{if(!_n())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Jo.tested)return Jo.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Jo.tested=!0,Jo.writable=!0}catch{Jo.tested=!0,Jo.writable=!1}return Jo.writable};function FP(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,a)=>{e[a]=i})}catch{}return t.searchParams.forEach((n,i)=>{e[i]=n}),e}const CN=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),jP=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",hu=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},Wo=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},bn=async(s,e)=>{await s.removeItem(e)};class Z0{constructor(){this.promise=new Z0.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Z0.promiseConstructor=Promise;function Vb(s){const e=s.split(".");if(e.length!==3)throw new y_("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!AP.test(e[n]))throw new y_("JWT not in base64url format");return{header:JSON.parse(tT(e[0])),payload:JSON.parse(tT(e[1])),signature:Tu(e[2]),raw:{header:e[0],payload:e[1]}}}async function zP(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function HP(s,e){return new Promise((n,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const l=await s(a);if(!e(a,null,l)){n(l);return}}catch(l){if(!e(a,l)){i(l);return}}})()})}function BP(s){return("0"+s.toString(16)).substr(-2)}function GP(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let i="";for(let a=0;a<56;a++)i+=t.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,BP).join("")}async function qP(s){const t=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function VP(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await qP(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function au(s,e,t=!1){const n=GP();let i=n;t&&(i+="/PASSWORD_RECOVERY"),await hu(s,`${e}-code-verifier`,i);const a=await VP(n);return[a,n===a?"plain":"s256"]}const $P=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function YP(s){const e=s.headers.get(g_);if(!e||!e.match($P))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function KP(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function XP(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const JP=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ou(s){if(!JP.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function $b(){const s={};return new Proxy(s,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function WP(s,e){return new Proxy(s,{get:(t,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,n,i)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,n,i)}})}function nT(s){return JSON.parse(JSON.stringify(s))}const Qo=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),QP=[502,503,504];async function sT(s){var e;if(!jP(s))throw new v_(Qo(s),0);if(QP.includes(s.status))throw new v_(Qo(s),s.status);let t;try{t=await s.json()}catch(a){throw new il(Qo(a),a)}let n;const i=YP(s);if(i&&i.getTime()>=AN["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new Q1(Qo(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new As}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0))throw new Q1(Qo(t),s.status,t.weak_password.reasons);throw new TP(Qo(t),s.status||500,n)}const ZP=(s,e,t,n)=>{const i={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),t))};async function De(s,e,t,n){var i;const a=Object.assign({},n==null?void 0:n.headers);a[g_]||(a[g_]=AN["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const l=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await eL(s,e,t+c,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(d):{data:Object.assign({},d),error:null}}async function eL(s,e,t,n,i,a){const l=ZP(e,n,i,a);let c;try{c=await s(t,Object.assign({},l))}catch(d){throw console.error(d),new v_(Qo(d),0)}if(c.ok||await sT(c),n!=null&&n.noResolveJson)return c;try{return await c.json()}catch(d){await sT(d)}}function gi(s){var e;let t=null;sL(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=OP(s.expires_in)));const n=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:n},error:null}}function iT(s){const e=gi(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=s.weak_password),e}function $a(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function tL(s){return{data:s,error:null}}function nL(s){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:a}=s,l=W0(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:a},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function rT(s){return s}function sL(s){return s.access_token&&s.refresh_token&&s.expires_in}const Yb=["global","local","others"];class iL{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=CN(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Yb[0]){if(Yb.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Yb.join(", ")}`);try{return await De(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Te(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await De(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:$a})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=W0(e,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await De(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:nL,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Te(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await De(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:$a})}catch(t){if(Te(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,i,a,l,c,d;try{const h={nextPage:null,lastPage:0,total:0},p=await De(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:rT});if(p.error)throw p.error;const y=await p.json(),_=(l=p.headers.get("x-total-count"))!==null&&l!==void 0?l:0,S=(d=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return S.length>0&&(S.forEach(A=>{const E=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(A.split(";")[1].split("=")[1]);h[`${N}Page`]=E}),h.total=parseInt(_)),{data:Object.assign(Object.assign({},y),h),error:null}}catch(h){if(Te(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){ou(e);try{return await De(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:$a})}catch(t){if(Te(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){ou(e);try{return await De(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:$a})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){ou(e);try{return await De(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:$a})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){ou(e.userId);try{const{data:t,error:n}=await De(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:n}}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _deleteFactor(e){ou(e.userId),ou(e.id);try{return{data:await De(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,i,a,l,c,d;try{const h={nextPage:null,lastPage:0,total:0},p=await De(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:rT});if(p.error)throw p.error;const y=await p.json(),_=(l=p.headers.get("x-total-count"))!==null&&l!==void 0?l:0,S=(d=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return S.length>0&&(S.forEach(A=>{const E=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(A.split(";")[1].split("=")[1]);h[`${N}Page`]=E}),h.total=parseInt(_)),{data:Object.assign(Object.assign({},y),h),error:null}}catch(h){if(Te(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(e){try{return await De(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await De(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await De(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Te(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await De(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await De(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Te(t))return{data:null,error:t};throw t}}}function aT(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}const lu={debug:!!(globalThis&&TN()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class NN extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class rL extends NN{}async function aL(s,e,t){lu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),lu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){lu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,i.name);try{return await t()}finally{lu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,i.name)}}else{if(e===0)throw lu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new rL(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(lu.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function oL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function RN(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function lL(s){return parseInt(s,16)}function cL(s){const e=new TextEncoder().encode(s);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function uL(s){var e;const{chainId:t,domain:n,expirationTime:i,issuedAt:a=new Date,nonce:l,notBefore:c,requestId:d,resources:h,scheme:p,uri:y,version:_}=s;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!y)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(_!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${_}`);if(!((e=s.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const S=RN(s.address),A=p?`${p}://${n}`:n,E=s.statement?`${s.statement}
`:"",N=`${A} wants you to sign in with your Ethereum account:
${S}

${E}`;let R=`URI: ${y}
Version: ${_}
Chain ID: ${t}${l?`
Nonce: ${l}`:""}
Issued At: ${a.toISOString()}`;if(i&&(R+=`
Expiration Time: ${i.toISOString()}`),c&&(R+=`
Not Before: ${c.toISOString()}`),d&&(R+=`
Request ID: ${d}`),h){let D=`
Resources:`;for(const P of h){if(!P||typeof P!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${P}`);D+=`
- ${P}`}R+=D}return`${N}
${R}`}class Kt extends Error{constructor({message:e,code:t,cause:n,name:i}){var a;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=i??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=t}}class f0 extends Kt{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function dL({error:s,options:e}){var t,n,i;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Kt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((t=a.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Kt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(e.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Kt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((i=a.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Kt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new Kt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new Kt({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return a.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Kt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new Kt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const l=window.location.hostname;if(kN(l)){if(a.rp.id!==l)return new Kt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new Kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Kt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new Kt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new Kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function hL({error:s,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Kt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new Kt({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const n=window.location.hostname;if(kN(n)){if(t.rpId!==n)return new Kt({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new Kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new Kt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new Kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}class fL{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const pL=new fL;function mL(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:e,user:t,excludeCredentials:n}=s,i=W0(s,["challenge","user","excludeCredentials"]),a=Tu(e).buffer,l=Object.assign(Object.assign({},t),{id:Tu(t.id).buffer}),c=Object.assign(Object.assign({},i),{challenge:a,user:l});if(n&&n.length>0){c.excludeCredentials=new Array(n.length);for(let d=0;d<n.length;d++){const h=n[d];c.excludeCredentials[d]=Object.assign(Object.assign({},h),{id:Tu(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return c}function gL(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:e,allowCredentials:t}=s,n=W0(s,["challenge","allowCredentials"]),i=Tu(e).buffer,a=Object.assign(Object.assign({},n),{challenge:i});if(t&&t.length>0){a.allowCredentials=new Array(t.length);for(let l=0;l<t.length;l++){const c=t[l];a.allowCredentials[l]=Object.assign(Object.assign({},c),{id:Tu(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function vL(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s;return{id:s.id,rawId:s.id,response:{attestationObject:ol(new Uint8Array(s.response.attestationObject)),clientDataJSON:ol(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function yL(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s,n=s.getClientExtensionResults(),i=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:ol(new Uint8Array(i.authenticatorData)),clientDataJSON:ol(new Uint8Array(i.clientDataJSON)),signature:ol(new Uint8Array(i.signature)),userHandle:i.userHandle?ol(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function kN(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function oT(){var s,e;return!!(_n()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator==null?void 0:navigator.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function bL(s){try{const e=await navigator.credentials.create(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new f0("Browser returned unexpected credential type",e)}:{data:null,error:new f0("Empty credential response",e)}}catch(e){return{data:null,error:dL({error:e,options:s})}}}async function _L(s){try{const e=await navigator.credentials.get(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new f0("Browser returned unexpected credential type",e)}:{data:null,error:new f0("Empty credential response",e)}}catch(e){return{data:null,error:hL({error:e,options:s})}}}const xL={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},wL={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function p0(...s){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),t=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of s)if(i)for(const a in i){const l=i[a];if(l!==void 0)if(Array.isArray(l))n[a]=l;else if(t(l))n[a]=l;else if(e(l)){const c=n[a];e(c)?n[a]=p0(c,l):n[a]=p0(l)}else n[a]=l}return n}function SL(s,e){return p0(xL,s,e||{})}function AL(s,e){return p0(wL,s,e||{})}class EL{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:n,signal:i},a){try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!l)return{data:null,error:c};const d=i??pL.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:h}=l.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${n}`),h.displayName||(h.displayName=h.name)}switch(l.webauthn.type){case"create":{const h=SL(l.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:p,error:y}=await bL({publicKey:h,signal:d});return p?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:p}},error:null}:{data:null,error:y}}case"request":{const h=AL(l.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:p,error:y}=await _L(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:h,signal:d}));return p?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:p}},error:null}:{data:null,error:y}}}}catch(l){return Te(l)?{data:null,error:l}:{data:null,error:new il("Unexpected error in challenge",l)}}}async _verify({challengeId:e,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!t)return{data:null,error:new _f("rpId is required for WebAuthn authentication")};try{if(!oT())return{data:null,error:new il("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:n},signal:i},{request:a});if(!l)return{data:null,error:c};const{webauthn:d}=l;return this._verify({factorId:e,challengeId:l.challengeId,webauthn:{type:d.type,rpId:t,rpOrigins:n,credential_response:d.credential_response}})}catch(l){return Te(l)?{data:null,error:l}:{data:null,error:new il("Unexpected error in authenticate",l)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!t)return{data:null,error:new _f("rpId is required for WebAuthn registration")};try{if(!oT())return{data:null,error:new il("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this._enroll({friendlyName:e});if(!l)return await this.client.mfa.listFactors().then(p=>{var y;return(y=p.data)===null||y===void 0?void 0:y.all.find(_=>_.factor_type==="webauthn"&&_.friendly_name===e&&_.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p==null?void 0:p.id}):void 0),{data:null,error:c};const{data:d,error:h}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:i},{create:a});return d?this._verify({factorId:l.id,challengeId:d.challengeId,webauthn:{rpId:t,rpOrigins:n,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:h}}catch(l){return Te(l)?{data:null,error:l}:{data:null,error:new il("Unexpected error in register",l)}}}}oL();const TL={url:xP,storageKey:wP,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:SP,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function lT(s,e,t){return await t()}const cu={};class xf{get jwks(){var e,t;return(t=(e=cu[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){cu[this.storageKey]=Object.assign(Object.assign({},cu[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=cu[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){cu[this.storageKey]=Object.assign(Object.assign({},cu[this.storageKey]),{cachedAt:e})}constructor(e){var t,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},TL),e);if(this.storageKey=a.storageKey,this.instanceID=(t=xf.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,xf.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&_n()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new iL({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=CN(a.fetch),this.lock=a.lock||lT,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&_n()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=aL:this.lock=lT,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new EL(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:TN()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=aT(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=aT(this.memoryStorage)),_n()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${SN}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},n="none";if(_n()&&(t=FP(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),_n()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:a}=await this._getSessionFromURL(t,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),RP(a)){const d=(e=a.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return{error:a}}const{session:l,redirectType:c}=i;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Te(t)?this._returnResult({error:t}):this._returnResult({error:new il("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,i;try{const a=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:gi}),{data:l,error:c}=a;if(c||!l)return this._returnResult({data:{user:null,session:null},error:c});const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(a){if(Te(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,n,i;try{let a;if("email"in e){const{email:p,password:y,options:_}=e;let S=null,A=null;this.flowType==="pkce"&&([S,A]=await au(this.storage,this.storageKey)),a=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:p,password:y,data:(t=_==null?void 0:_.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:S,code_challenge_method:A},xform:gi})}else if("phone"in e){const{phone:p,password:y,options:_}=e;a=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:y,data:(n=_==null?void 0:_.data)!==null&&n!==void 0?n:{},channel:(i=_==null?void 0:_.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:gi})}else throw new wg("You must provide either an email or phone number and a password");const{data:l,error:c}=a;if(c||!l)return await bn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(a){if(await bn(this.storage,`${this.storageKey}-code-verifier`),Te(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:l,options:c}=e;t=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:iT})}else if("phone"in e){const{phone:a,password:l,options:c}=e;t=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:iT})}else throw new wg("You must provide either an email or phone number and a password");const{data:n,error:i}=t;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const a=new ru;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(t){if(Te(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,n,i,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,n,i,a,l,c,d,h,p,y,_;let S,A;if("message"in e)S=e.message,A=e.signature;else{const{chain:E,wallet:N,statement:R,options:D}=e;let P;if(_n())if(typeof N=="object")P=N;else{const Y=window;if("ethereum"in Y&&typeof Y.ethereum=="object"&&"request"in Y.ethereum&&typeof Y.ethereum.request=="function")P=Y.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(D!=null&&D.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=N}const L=new URL((t=D==null?void 0:D.url)!==null&&t!==void 0?t:window.location.href),z=await P.request({method:"eth_requestAccounts"}).then(Y=>Y).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!z||z.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const H=RN(z[0]);let F=(n=D==null?void 0:D.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!F){const Y=await P.request({method:"eth_chainId"});F=lL(Y)}const X={domain:L.host,address:H,statement:R,uri:L.href,version:"1",chainId:F,nonce:(i=D==null?void 0:D.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(l=(a=D==null?void 0:D.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(c=D==null?void 0:D.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(d=D==null?void 0:D.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(h=D==null?void 0:D.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(p=D==null?void 0:D.signInWithEthereum)===null||p===void 0?void 0:p.resources};S=uL(X),A=await P.request({method:"personal_sign",params:[cL(S),H]})}try{const{data:E,error:N}=await De(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:S,signature:A},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:gi});if(N)throw N;if(!E||!E.session||!E.user){const R=new ru;return this._returnResult({data:{user:null,session:null},error:R})}return E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),this._returnResult({data:Object.assign({},E),error:N})}catch(E){if(Te(E))return this._returnResult({data:{user:null,session:null},error:E});throw E}}async signInWithSolana(e){var t,n,i,a,l,c,d,h,p,y,_,S;let A,E;if("message"in e)A=e.message,E=e.signature;else{const{chain:N,wallet:R,statement:D,options:P}=e;let L;if(_n())if(typeof R=="object")L=R;else{const H=window;if("solana"in H&&typeof H.solana=="object"&&("signIn"in H.solana&&typeof H.solana.signIn=="function"||"signMessage"in H.solana&&typeof H.solana.signMessage=="function"))L=H.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!(P!=null&&P.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");L=R}const z=new URL((t=P==null?void 0:P.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in L&&L.signIn){const H=await L.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},P==null?void 0:P.signInWithSolana),{version:"1",domain:z.host,uri:z.href}),D?{statement:D}:null));let F;if(Array.isArray(H)&&H[0]&&typeof H[0]=="object")F=H[0];else if(H&&typeof H=="object"&&"signedMessage"in H&&"signature"in H)F=H;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)A=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),E=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in L)||typeof L.signMessage!="function"||!("publicKey"in L)||typeof L!="object"||!L.publicKey||!("toBase58"in L.publicKey)||typeof L.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");A=[`${z.host} wants you to sign in with your Solana account:`,L.publicKey.toBase58(),...D?["",D,""]:[""],"Version: 1",`URI: ${z.href}`,`Issued At: ${(i=(n=P==null?void 0:P.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=P==null?void 0:P.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${P.signInWithSolana.notBefore}`]:[],...!((l=P==null?void 0:P.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${P.signInWithSolana.expirationTime}`]:[],...!((c=P==null?void 0:P.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${P.signInWithSolana.chainId}`]:[],...!((d=P==null?void 0:P.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${P.signInWithSolana.nonce}`]:[],...!((h=P==null?void 0:P.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${P.signInWithSolana.requestId}`]:[],...!((y=(p=P==null?void 0:P.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||y===void 0)&&y.length?["Resources",...P.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const H=await L.signMessage(new TextEncoder().encode(A),"utf8");if(!H||!(H instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");E=H}}try{const{data:N,error:R}=await De(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:A,signature:ol(E)},!((_=e.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(S=e.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:gi});if(R)throw R;if(!N||!N.session||!N.user){const D=new ru;return this._returnResult({data:{user:null,session:null},error:D})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:R})}catch(N){if(Te(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async _exchangeCodeForSession(e){const t=await Wo(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(t??"").split("/");try{if(!n&&this.flowType==="pkce")throw new kP;const{data:a,error:l}=await De(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:gi});if(await bn(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!a||!a.session||!a.user){const c=new ru;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:l})}catch(a){if(await bn(this.storage,`${this.storageKey}-code-verifier`),Te(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:n,token:i,access_token:a,nonce:l}=e,c=await De(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:l,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:gi}),{data:d,error:h}=c;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!d||!d.session||!d.user){const p=new ru;return this._returnResult({data:{user:null,session:null},error:p})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:h})}catch(t){if(Te(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,n,i,a,l;try{if("email"in e){const{email:c,options:d}=e;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await au(this.storage,this.storageKey));const{error:y}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},create_user:(n=d==null?void 0:d.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:p},redirectTo:d==null?void 0:d.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:y})}if("phone"in e){const{phone:c,options:d}=e,{data:h,error:p}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(i=d==null?void 0:d.data)!==null&&i!==void 0?i:{},create_user:(a=d==null?void 0:d.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:p})}throw new wg("You must provide either an email or phone number.")}catch(c){if(await bn(this.storage,`${this.storageKey}-code-verifier`),Te(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var t,n;try{let i,a;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:c}=await De(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:gi});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,h=l.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(i){if(Te(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(e){var t,n,i,a,l;try{let c=null,d=null;this.flowType==="pkce"&&([c,d]=await au(this.storage,this.storageKey));const h=await De(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:tL});return!((a=h.data)===null||a===void 0)&&a.url&&_n()&&!(!((l=e.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(c){if(await bn(this.storage,`${this.storageKey}-code-verifier`),Te(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new As;const{error:i}=await De(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(e){if(Te(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:a}=e,{error:l}=await De(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in e){const{phone:n,type:i,options:a}=e,{data:l,error:c}=await De(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c})}throw new wg("You must provide either an email or phone number and a type")}catch(t){if(Te(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Wo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Gb:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const l=await Wo(this.userStorage,this.storageKey+"-user");l!=null&&l.user?e.user=l.user:e.user=$b()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};e.user=WP(e.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:$a}):await this._useSession(async t=>{var n,i,a;const{data:l,error:c}=t;if(c)throw c;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new As}:await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:$a})})}catch(t){if(Te(t))return NP(t)&&(await this._removeSession(),await bn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:i,error:a}=n;if(a)throw a;if(!i.session)throw new As;const l=i.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await au(this.storage,this.storageKey));const{data:h,error:p}=await De(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:$a});if(p)throw p;return l.user=h.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await bn(this.storage,`${this.storageKey}-code-verifier`),Te(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new As;const t=Date.now()/1e3;let n=t,i=!0,a=null;const{payload:l}=Vb(e.access_token);if(l.exp&&(n=l.exp,i=n<=t),i){const{data:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c)return{data:{user:null,session:null},error:null};a=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;a={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(Te(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:l,error:c}=t;if(c)throw c;e=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new As;const{data:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(Te(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!_n())throw new Sg("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Sg(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new W1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Sg("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new W1("No code detected.");const{data:D,error:P}=await this._exchangeCodeForSession(e.code);if(P)throw P;const L=new URL(window.location.href);return L.searchParams.delete("code"),window.history.replaceState(window.history.state,"",L.toString()),{data:{session:D.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:l,expires_in:c,expires_at:d,token_type:h}=e;if(!a||!c||!l||!h)throw new Sg("No session defined in URL");const p=Math.round(Date.now()/1e3),y=parseInt(c);let _=p+y;d&&(_=parseInt(d));const S=_-p;S*1e3<=du&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${y}s`);const A=_-y;p-A>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",A,_,p):p-A<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",A,_,p);const{data:E,error:N}=await this._getUser(a);if(N)throw N;const R={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:y,expires_at:_,refresh_token:l,token_type:h,user:E.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:R,redirectType:e.type},error:null})}catch(n){if(Te(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Wo(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:i,error:a}=t;if(a)return this._returnResult({error:a});const l=(n=i.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(CP(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await bn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=UP(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,i;try{const{data:{session:a},error:l}=t;if(l)throw l;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await au(this.storage,this.storageKey,!0));try{return await De(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(await bn(this.storage,`${this.storageKey}-code-verifier`),Te(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(Te(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:i}=await this._useSession(async a=>{var l,c,d,h,p;const{data:y,error:_}=a;if(_)throw _;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await De(this.fetch,"GET",S,{headers:this.headers,jwt:(p=(h=y.session)===null||h===void 0?void 0:h.access_token)!==null&&p!==void 0?p:void 0})});if(i)throw i;return _n()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:e.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Te(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:i,data:{session:a}}=t;if(i)throw i;const{options:l,provider:c,token:d,access_token:h,nonce:p}=e,y=await De(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:c,id_token:d,access_token:h,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:gi}),{data:_,error:S}=y;return S?this._returnResult({data:{user:null,session:null},error:S}):!_||!_.session||!_.user?this._returnResult({data:{user:null,session:null},error:new ru}):(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("USER_UPDATED",_.session)),this._returnResult({data:_,error:S}))}catch(i){if(await bn(this.storage,`${this.storageKey}-code-verifier`),Te(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,i;const{data:a,error:l}=t;if(l)throw l;return await De(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(Te(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await HP(async i=>(i>0&&await zP(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await De(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:gi})),(i,a)=>{const l=200*Math.pow(2,i);return a&&qb(a)&&Date.now()+l-n<du})}catch(n){if(this._debug(t,"error",n),Te(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),_n()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Wo(this.storage,this.storageKey);if(i&&this.userStorage){let l=await Wo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:i.user},await hu(this.userStorage,this.storageKey+"-user",l)),i.user=(e=l==null?void 0:l.user)!==null&&e!==void 0?e:$b()}else if(i&&!i.user&&!i.user){const l=await Wo(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(i.user=l.user,await bn(this.storage,this.storageKey+"-user"),await hu(this.storage,this.storageKey,i)):i.user=$b()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const a=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Gb;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${Gb}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:l}=await this._callRefreshToken(i.refresh_token);l&&(console.error(l),qb(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:c}=await this._getUser(i.access_token);!c&&(l!=null&&l.user)?(i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new As;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Z0;const{data:a,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!a.session)throw new As;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const c={data:a.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(a){if(this._debug(i,"error",a),Te(a)){const l={data:null,error:a};return qb(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(d){a.push(d)}});if(await Promise.all(l),a.length>0){for(let c=0;c<a.length;c+=1)console.error(a[c]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await bn(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await hu(this.userStorage,this.storageKey+"-user",{user:t.user});const i=Object.assign({},t);delete i.user;const a=nT(i);await hu(this.storage,this.storageKey,a)}else{const i=nT(t);await hu(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await bn(this.storage,this.storageKey),await bn(this.storage,this.storageKey+"-code-verifier"),await bn(this.storage,this.storageKey+"-user"),this.userStorage&&await bn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&_n()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),du);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/du);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${du}ms, refresh threshold is ${m_} ticks`),i<=m_&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof NN)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_n()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const i=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,l]=await au(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});i.push(c.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:i,error:a}=t;return a?this._returnResult({data:null,error:a}):await De(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Te(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,i;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:d,error:h}=await De(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return h?this._returnResult({data:null,error:h}):(e.factorType==="totp"&&d.type==="totp"&&(!((i=d==null?void 0:d.totp)===null||i===void 0)&&i.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(t){if(Te(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:a}=t;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?vL(e.webauthn.credential_response):yL(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:d}=await De(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:d}))})}catch(t){if(Te(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:a}=t;if(a)return this._returnResult({data:null,error:a});const l=await De(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:c}=l;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:mL(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:gL(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Te(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])i.all.push(a),a.status==="verified"&&i[a.factor_type].push(a);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Vb(n.access_token);let l=null;a.aal&&(l=a.aal);let c=l;((t=(e=n.user.factors)===null||e===void 0?void 0:e.filter(p=>p.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(c="aal2");const h=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;return i?this._returnResult({data:null,error:i}):n?await De(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new As})})}catch(t){if(Te(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new As});const l=await De(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&_n()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Te(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new As});const l=await De(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&_n()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Te(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;return n?this._returnResult({data:null,error:n}):t?await De(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new As})})}catch(e){if(Te(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;return i?this._returnResult({data:null,error:i}):n?(await De(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new As})})}catch(t){if(Te(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(c=>c.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(c=>c.kid===e),n&&this.jwks_cached_at+EP>i)return n;const{data:a,error:l}=await De(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,n=a.keys.find(c=>c.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:S,error:A}=await this.getSession();if(A||!S.session)return this._returnResult({data:null,error:A});n=S.session.access_token}const{header:i,payload:a,signature:l,raw:{header:c,payload:d}}=Vb(n);t!=null&&t.allowExpired||KP(a.exp);const h=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!h){const{error:S}=await this.getUser(n);if(S)throw S;return{data:{claims:a,header:i,signature:l},error:null}}const p=XP(i.alg),y=await crypto.subtle.importKey("jwk",h,p,!0,["verify"]);if(!await crypto.subtle.verify(p,y,l,LP(`${c}.${d}`)))throw new y_("Invalid JWT signature");return{data:{claims:a,header:i,signature:l},error:null}}catch(n){if(Te(n))return this._returnResult({data:null,error:n});throw n}}}xf.nextInstanceID={};const CL=xf,NL="2.90.1";let Yh="";typeof Deno<"u"?Yh="deno":typeof document<"u"?Yh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Yh="react-native":Yh="node";const RL={"X-Client-Info":`supabase-js-${Yh}/${NL}`},kL={headers:RL},ML={schema:"public"},IL={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DL={};function wf(s){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wf(s)}function PL(s,e){if(wf(s)!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e);if(wf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function LL(s){var e=PL(s,"string");return wf(e)=="symbol"?e:e+""}function OL(s,e,t){return(e=LL(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function cT(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,n)}return t}function Ot(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?cT(Object(t),!0).forEach(function(n){OL(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):cT(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}const UL=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),FL=()=>Headers,jL=(s,e,t)=>{const n=UL(t),i=FL();return async(a,l)=>{var c;const d=(c=await e())!==null&&c!==void 0?c:s;let h=new i(l==null?void 0:l.headers);return h.has("apikey")||h.set("apikey",s),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),n(a,Ot(Ot({},l),{},{headers:h}))}};function zL(s){return s.endsWith("/")?s:s+"/"}function HL(s,e){var t,n;const{db:i,auth:a,realtime:l,global:c}=s,{db:d,auth:h,realtime:p,global:y}=e,_={db:Ot(Ot({},d),i),auth:Ot(Ot({},h),a),realtime:Ot(Ot({},p),l),storage:{},global:Ot(Ot(Ot({},y),c),{},{headers:Ot(Ot({},(t=y==null?void 0:y.headers)!==null&&t!==void 0?t:{}),(n=c==null?void 0:c.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return s.accessToken?_.accessToken=s.accessToken:delete _.accessToken,_}function BL(s){const e=s==null?void 0:s.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(zL(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var GL=class extends CL{constructor(s){super(s)}},qL=class{constructor(s,e,t){var n,i;this.supabaseUrl=s,this.supabaseKey=e;const a=BL(s);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const l=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:ML,realtime:DL,auth:Ot(Ot({},IL),{},{storageKey:l}),global:kL},d=HL(t??{},c);if(this.storageKey=(n=d.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(p,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}});else{var h;this.auth=this._initSupabaseAuthClient((h=d.auth)!==null&&h!==void 0?h:{},this.headers,d.global.fetch)}this.fetch=jL(e,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Ot({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new SD(new URL("rest/v1",a).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new _P(this.storageUrl.href,this.headers,this.fetch,t==null?void 0:t.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new yD(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(s,e,t)}channel(s,e={config:{}}){return this.realtime.channel(s,e)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var s=this,e,t;if(s.accessToken)return await s.accessToken();const{data:n}=await s.auth.getSession();return(e=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:s.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:e,detectSessionInUrl:t,storage:n,userStorage:i,storageKey:a,flowType:l,lock:c,debug:d,throwOnError:h},p,y){const _={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new GL({url:this.authUrl.href,headers:Ot(Ot({},_),p),storageKey:a,autoRefreshToken:s,persistSession:e,detectSessionInUrl:t,storage:n,userStorage:i,flowType:l,lock:c,debug:d,throwOnError:h,fetch:y,hasCustomAuthorizationHeader:Object.keys(this.headers).some(S=>S.toLowerCase()==="authorization")})}_initRealtimeClient(s){return new zD(this.realtimeUrl.href,Ot(Ot({},s),{},{params:Ot(Ot({},{apikey:this.supabaseKey}),s==null?void 0:s.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,e)=>{this._handleTokenChanged(s,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(s,e,t){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):s==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const VL=(s,e,t)=>new qL(s,e,t);function $L(){if(typeof window<"u")return!1;const s=globalThis.process;if(!s)return!1;const e=s.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}$L()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const YL="https://dnwczvokxloyzjnqqfbd.supabase.co",KL="sb_publishable_evp59khbQk9e0LE6YnjzxQ_4ByKuJaq",Ht=VL(YL,KL);var he=(s=>(s.HOME="HOME",s.PROCESSING="PROCESSING",s.QUIZ="QUIZ",s.RESULT="RESULT",s.ERROR="ERROR",s.SERVICES="SERVICES",s.PROFILE="PROFILE",s.DEVAI="DEVAI",s.ABOUT="ABOUT",s.EXAMS="EXAMS",s))(he||{});const b_={" ":[" ",""],"  ":[" ","  "," "]},yt=({children:s,variant:e="primary",fullWidth:t=!1,className:n="",...i})=>{const a="px-6 py-3.5 rounded-xl font-bold transition-all duration-300 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 relative overflow-hidden",l={primary:"bg-gradient-to-r from-violet-600 via-purple-600 to-fuchsia-600 text-white shadow-[0_0_20px_rgba(139,92,246,0.3)] hover:shadow-[0_0_30px_rgba(139,92,246,0.5)] border border-white/10",secondary:"bg-white/5 hover:bg-white/10 text-white border border-white/10 hover:border-white/20 backdrop-blur-md",outline:"bg-transparent border border-white/20 text-slate-300 hover:text-white hover:border-violet-500 hover:shadow-[0_0_15px_rgba(139,92,246,0.2)]",danger:"bg-red-500/10 text-red-400 hover:bg-red-500/20 border border-red-500/20"};return b.jsx("button",{className:`${a} ${l[e]} ${t?"w-full":""} ${n}`,...i,children:b.jsx("span",{className:"relative z-10 flex items-center gap-2",children:s})})};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XL=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),JL=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),uT=s=>{const e=JL(s);return e.charAt(0).toUpperCase()+e.slice(1)},MN=(...s)=>s.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),WL=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var QL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZL=se.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:l,...c},d)=>se.createElement("svg",{ref:d,...QL,width:e,height:e,stroke:s,strokeWidth:n?Number(t)*24/Number(e):t,className:MN("lucide",i),...!a&&!WL(c)&&{"aria-hidden":"true"},...c},[...l.map(([h,p])=>se.createElement(h,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=(s,e)=>{const t=se.forwardRef(({className:n,...i},a)=>se.createElement(ZL,{ref:a,iconNode:e,className:MN(`lucide-${XL(uT(s))}`,`lucide-${s}`,n),...i}));return t.displayName=uT(s),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eO=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],IN=ce("arrow-left",eO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tO=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Cu=ce("arrow-right",tO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nO=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],sO=ce("arrow-up-down",nO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iO=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],m0=ce("book-open",iO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rO=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],iw=ce("brain-circuit",rO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aO=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],oO=ce("briefcase",aO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lO=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],DN=ce("building-2",lO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cO=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],dT=ce("building",cO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uO=[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h.01",key:"1bh4kh"}],["path",{d:"M12 4h.01",key:"1ujb9j"}],["path",{d:"M17 4h.01",key:"1upcoc"}]],dO=ce("cake",uO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hO=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],PN=ce("calculator",hO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fO=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],LN=ce("chart-column",fO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pO=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Kh=ce("chevron-down",pO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mO=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],rw=ce("chevron-left",mO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gO=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],vO=ce("chevron-right",gO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ON=ce("circle-alert",yO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],g0=ce("circle-check",bO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _O=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],xO=ce("circle-plus",_O);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],SO=ce("circle-question-mark",wO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AO=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],aw=ce("circle-user-round",AO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],TO=ce("circle-x",EO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CO=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],NO=ce("clock",CO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RO=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],UN=ce("cloud-upload",RO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kO=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],FN=ce("code-xml",kO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MO=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],__=ce("cpu",MO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IO=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],jN=ce("crown",IO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DO=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],hT=ce("database",DO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PO=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],LO=ce("facebook",PO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],zN=ce("file-text",OO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UO=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],FO=ce("folder-open",UO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jO=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],zO=ce("folder",jO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],BO=ce("frown",HO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GO=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],qO=ce("funnel",GO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VO=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Ud=ce("graduation-cap",VO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $O=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],YO=ce("history",$O);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KO=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],ow=ce("house",KO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XO=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],JO=ce("layers",XO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WO=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],QO=ce("layout-grid",WO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZO=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],HN=ce("library",ZO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eU=[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]],tU=ce("list-filter",eU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nU=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Di=ce("loader-circle",nU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sU=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],iU=ce("lock",sU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rU=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],aU=ce("log-in",rU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oU=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],lU=ce("log-out",oU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cU=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],uU=ce("mail",cU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dU=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],hU=ce("map-pin",dU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fU=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],BN=ce("medal",fU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pU=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],mU=ce("menu",pU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gU=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],x_=ce("message-circle",gU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vU=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"m10 8-3 3 3 3",key:"fp6dz7"}],["path",{d:"m14 14 3-3-3-3",key:"1yrceu"}]],yU=ce("message-square-code",vU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bU=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],GN=ce("monitor",bU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _U=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],xU=ce("palette",_U);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wU=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],SU=ce("panels-top-left",wU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AU=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],EU=ce("percent",AU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TU=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],CU=ce("puzzle",TU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NU=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],RU=ce("refresh-cw",NU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kU=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],MU=ce("rocket",kU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IU=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],DU=ce("rotate-ccw",IU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PU=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],qN=ce("save",PU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LU=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],OU=ce("search",LU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UU=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],FU=ce("send",UU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jU=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],w_=ce("shield-alert",jU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zU=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],HU=ce("shield-check",zU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BU=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],VN=ce("smartphone",BU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GU=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],da=ce("sparkles",GU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qU=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ev=ce("star",qU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VU=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],zh=ce("trash-2",VU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $U=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],v0=ce("trophy",$U);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YU=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],$N=ce("type",YU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KU=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],XU=ce("user-plus",KU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JU=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],WU=ce("user-round",JU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QU=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ZU=ce("user",QU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],YN=ce("users",e5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t5=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Zp=ce("x",t5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],gc=ce("zap",n5),s5=({isOpen:s,onClose:e,onSuccess:t})=>{const[n,i]=se.useState("LOGIN"),[a,l]=se.useState(""),[c,d]=se.useState(""),[h,p]=se.useState(""),[y,_]=se.useState(!1),[S,A]=se.useState(""),[E,N]=se.useState(!1),[R,D]=se.useState(!1),[P,L]=se.useState(!1);if(!s)return null;const z=()=>{e(),setTimeout(()=>{i("LOGIN"),l(""),d(""),p(""),A(""),N(!1),_(!1),D(!1),L(!1)},300)},H=async X=>{if(X.preventDefault(),n!=="LOGIN"&&!R){A("     ");return}_(!0),A("");try{let Y=null;if(n==="GUEST"){if(!h.trim())throw new Error("  ");const J=h.trim()==="0",ie=J?"":h,pe={id:J?"admin-yazan-2001":"guest-"+Date.now(),email:J?"admin@idraak.ai":"guest@local",user_metadata:{full_name:ie,role:J?"admin":"student",avatar:J?"Joshua":"Felix"},app_metadata:{provider:"guest"},aud:"authenticated",created_at:new Date().toISOString()};localStorage.setItem("guest_user",JSON.stringify(pe)),Y=pe}else if(n==="LOGIN"){const J=await Ht.auth.signInWithPassword({email:a,password:c});if(J.error)throw J.error;Y=J.data.user}else{if(!h.trim())throw new Error("   ");const J=await Ht.auth.signUp({email:a,password:c,options:{data:{full_name:h}}});if(J.error)throw J.error;Y=J.data.user}Y&&(N(!0),setTimeout(()=>{t(Y),z()},1500))}catch(Y){A(Y.message||"   "),_(!1)}},F=()=>b.jsxs("div",{className:"absolute inset-0 bg-[#050505] z-50 p-8 flex flex-col",children:[b.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[b.jsx("button",{onClick:()=>L(!1),className:"p-2 bg-white/5 rounded-full text-slate-400 hover:text-white transition-colors",children:b.jsx(IN,{size:18})}),b.jsx("h3",{className:"text-xl font-black text-white",children:" "})]}),b.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 text-slate-400 text-sm leading-relaxed space-y-4 text-right",dir:"rtl",children:[b.jsx("p",{className:"font-bold text-white text-lg",children:"   ."}),b.jsx("p",{children:"1.            ."}),b.jsx("p",{children:"2.   PDF                     ."}),b.jsx("p",{children:"3.        .             ."}),b.jsx("p",{children:"4.    Google Gemini         ."}),b.jsx("p",{children:"5.        ."})]}),b.jsx(yt,{onClick:()=>L(!1),className:"mt-6 shadow-lg shadow-emerald-500/10",children:" "})]});return b.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[b.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>!E&&z()}),b.jsxs("div",{className:"glass-panel w-full max-w-md bg-[#050505] rounded-[2.5rem] p-8 relative border border-white/10 shadow-[0_0_50px_rgba(139,92,246,0.15)] min-h-[580px] flex flex-col justify-center overflow-hidden",children:[P&&F(),E?b.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-10",children:[b.jsx("div",{className:"w-24 h-24 bg-emerald-500/10 rounded-full flex items-center justify-center mb-6 border border-emerald-500/20 shadow-[0_0_30px_rgba(16,185,129,0.2)]",children:b.jsx(g0,{className:"text-emerald-400 w-12 h-12"})}),b.jsx("h2",{className:"text-3xl font-black text-white mb-2 tracking-tight",children:" !"}),b.jsx("p",{className:"text-emerald-400 font-bold text-lg",children:"   "}),b.jsx("div",{className:"mt-8",children:b.jsx(Di,{className:"animate-spin text-slate-600"})})]}):b.jsxs(b.Fragment,{children:[b.jsx("button",{onClick:z,className:"absolute top-6 left-6 p-2 text-slate-500 hover:text-white hover:bg-white/10 rounded-full z-10 transition-all",children:b.jsx(Zp,{size:20})}),b.jsxs("div",{className:"text-center mb-8",children:[b.jsxs("div",{className:"w-16 h-16 bg-violet-500/10 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-violet-500/20 shadow-inner",children:[n==="LOGIN"&&b.jsx(aU,{className:"text-violet-400",size:32}),n==="SIGNUP"&&b.jsx(XU,{className:"text-violet-400",size:32}),n==="GUEST"&&b.jsx(aw,{className:"text-violet-400",size:32})]}),b.jsx("h2",{className:"text-2xl font-black text-white mb-2 tracking-tight",children:n==="LOGIN"?" ":n==="SIGNUP"?"  ":" "}),b.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"    "})]}),b.jsxs("div",{className:"flex p-1 bg-white/5 rounded-2xl mb-8 relative z-10 border border-white/5 shadow-inner",children:[b.jsx("button",{onClick:()=>{i("LOGIN"),A("")},className:`flex-1 py-3 text-sm font-black rounded-xl transition-all ${n==="LOGIN"||n==="SIGNUP"?"bg-violet-600 text-white shadow-lg shadow-violet-600/20":"text-slate-500 hover:text-white"}`,children:""}),b.jsx("button",{onClick:()=>{i("GUEST"),A("")},className:`flex-1 py-3 text-sm font-black rounded-xl transition-all ${n==="GUEST"?"bg-violet-600 text-white shadow-lg shadow-violet-600/20":"text-slate-500 hover:text-white"}`,children:""})]}),S&&b.jsxs("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-2xl flex items-start gap-3 animate-lux-up",children:[b.jsx(ON,{className:"text-red-400 shrink-0 mt-0.5",size:18}),b.jsx("p",{className:"text-red-300 text-sm font-bold leading-tight",children:S})]}),b.jsxs("form",{onSubmit:H,className:"space-y-5 flex-1 flex flex-col",children:[n==="GUEST"&&b.jsxs("div",{className:"bg-amber-500/5 border border-amber-500/10 p-4 rounded-2xl mb-2 flex items-start gap-3 text-right",children:[b.jsx(w_,{size:20,className:"text-amber-500 shrink-0 mt-0.5"}),b.jsxs("p",{className:"text-amber-200/80 text-[11px] leading-relaxed font-medium",children:[b.jsx("span",{className:"font-black text-amber-300 block mb-0.5",children:" :"}),"         .     ."]})]}),(n==="SIGNUP"||n==="GUEST")&&b.jsxs("div",{className:"space-y-2",children:[b.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:n==="GUEST"?"   ":" "}),b.jsxs("div",{className:"relative",children:[b.jsx(ZU,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),b.jsx("input",{type:"text",required:!0,value:h,onChange:X=>p(X.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:n==="GUEST"?"   ":" "})]})]}),n!=="GUEST"&&b.jsxs(b.Fragment,{children:[b.jsxs("div",{className:"space-y-2",children:[b.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:" "}),b.jsxs("div",{className:"relative",children:[b.jsx(uU,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),b.jsx("input",{type:"email",required:!0,value:a,onChange:X=>l(X.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:"name@example.com"})]})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:" "}),b.jsxs("div",{className:"relative",children:[b.jsx(iU,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),b.jsx("input",{type:"password",required:!0,minLength:6,value:c,onChange:X=>d(X.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:""})]})]})]}),n!=="LOGIN"&&b.jsxs("div",{className:"flex items-start gap-3 mt-2 py-2 px-1",children:[b.jsx("input",{type:"checkbox",checked:R,onChange:X=>D(X.target.checked),className:"mt-1 w-5 h-5 rounded-lg border-white/10 accent-emerald-500 cursor-pointer transition-all"}),b.jsxs("label",{className:"text-xs text-slate-500 font-bold text-right leading-relaxed select-none",children:["  ",b.jsx("button",{type:"button",onClick:()=>L(!0),className:"text-emerald-400 underline hover:text-emerald-300 transition-colors",children:"   "}),"   ."]})]}),b.jsxs("div",{className:"mt-auto pt-4",children:[b.jsx(yt,{type:"submit",fullWidth:!0,disabled:y,className:"py-4 shadow-xl",children:y?b.jsxs("span",{className:"animate-pulse flex items-center gap-2",children:[b.jsx(Di,{className:"animate-spin",size:18}),"  ..."]}):n==="LOGIN"?"":" "}),n==="LOGIN"&&b.jsx("button",{type:"button",onClick:()=>{i("SIGNUP"),A("")},className:"w-full text-center mt-6 text-emerald-400 hover:text-emerald-300 transition-all font-black text-lg md:text-xl underline decoration-emerald-800 underline-offset-8 decoration-2",children:"      "}),n==="SIGNUP"&&b.jsx("button",{type:"button",onClick:()=>{i("LOGIN"),A("")},className:"w-full text-center mt-6 text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"      "}),n==="GUEST"&&b.jsx("button",{type:"button",onClick:()=>{i("SIGNUP"),A("")},className:"w-full text-center mt-6 text-xs font-bold text-slate-500 hover:text-emerald-400 transition-colors",children:"      "})]})]})]})]})]})};var i5=fN();const r5=()=>{const[s,e]=se.useState([]),[t,n]=se.useState(!0),[i,a]=se.useState(null),[l,c]=se.useState(null);se.useEffect(()=>{d();let S;try{S=Ht.channel("leaderboard-realtime").on("postgres_changes",{event:"*",schema:"public",table:"quiz_history"},()=>{d()}).subscribe()}catch{console.warn("Realtime subscription failed, falling back to manual fetch only.")}return()=>{S&&Ht.removeChannel(S)}},[]);const d=async()=>{try{c(null);const{data:S,error:A}=await Ht.from("quiz_history").select("*").order("created_at",{ascending:!1});if(A)throw A;if(!S){e([]);return}const E=new Map;S.forEach(R=>{const D=(R.score||0)*10,P=R.score||0,L=R.total_questions||10,z=R.player_name||" ",H=R.player_avatar||"Felix",F=R.player_university,X=R.player_major,Y=R.player_age;if(E.has(R.user_id)){const J=E.get(R.user_id);E.set(R.user_id,{...J,exp:J.exp+D,quizCount:J.quizCount+1,rawScoreSum:J.rawScoreSum+P,maxScoreSum:J.maxScoreSum+L})}else E.set(R.user_id,{name:z,avatar:H,exp:D,quizCount:1,rawScoreSum:P,maxScoreSum:L,university:F,major:X,age:Y})});const N=Array.from(E.entries()).map(([R,D])=>{const P=D.maxScoreSum>0?Math.round(D.rawScoreSum/D.maxScoreSum*100):0;return{userId:R,name:D.name,avatar:D.avatar,totalExp:D.exp,totalQuizzes:D.quizCount,averageScore:P,university:D.university,major:D.major,age:D.age,rank:0}}).sort((R,D)=>D.totalExp-R.totalExp).slice(0,10).map((R,D)=>({...R,rank:D+1}));e(N)}catch(S){console.error("Leaderboard fetch error:",S),c(S.message==="Failed to fetch"?"  .     .":"     .")}finally{n(!1)}},h=S=>{switch(S){case 1:return"bg-gradient-to-r from-black via-[#0a0a0a] to-[#453a15] border-[#d4af37]/20 shadow-[0_0_20px_rgba(0,0,0,0.5)]";case 2:return"bg-gradient-to-r from-[#0a0a0a] via-[#150a1c] to-[#420a15] border-[#c31432]/20 shadow-lg";case 3:return"bg-gradient-to-r from-[#030712] via-[#051125] to-[#3a3324] border-[#a89166]/20 shadow-lg";default:return"bg-gradient-to-r from-[#18181b] via-[#27272a] to-[#3f3f46] border-white/5 opacity-80 hover:opacity-100 transition-opacity"}},p=S=>["  "," "," "," "," ","  "," "," "," "," "][S-1]||" ",y=S=>["   !    ."," !      .","   !    .","     .  !"," !      .","  !      .","   .   !","    .    .","     .  !","   .    !"][S-1]||"    !",_=S=>S===1?b.jsx(jN,{size:28,className:"text-yellow-400/80 drop-shadow-[0_0_8px_rgba(250,204,21,0.6)] animate-bounce"}):S===2?b.jsx(ev,{size:24,className:"text-fuchsia-400/80 drop-shadow-[0_0_6px_rgba(192,38,211,0.5)]"}):S===3?b.jsx(BN,{size:24,className:"text-amber-500/80 drop-shadow-[0_0_6px_rgba(245,158,11,0.5)]"}):b.jsxs("span",{className:`text-lg font-black font-mono ${S<=5?"text-white/80":"text-slate-600"}`,children:["#",S]});return b.jsxs("div",{className:"w-full max-w-4xl mx-auto mt-2 mb-10 px-4",children:[b.jsxs("div",{className:"text-center mb-10 animate-lux-up",children:[b.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-2xl bg-gradient-to-br from-yellow-500/10 to-amber-600/10 text-yellow-500/70 mb-4 border border-yellow-500/20 shadow-[0_0_20px_rgba(234,179,8,0.1)]",children:b.jsx(v0,{size:32})}),b.jsx("h2",{className:"text-3xl md:text-4xl font-black text-white mb-3",children:" "})]}),t?b.jsx("div",{className:"flex justify-center py-10",children:b.jsx(Di,{className:"animate-spin text-violet-500/50",size:32})}):l?b.jsxs("div",{className:"text-center py-8 bg-red-500/5 border border-red-500/10 rounded-3xl",children:[b.jsx("p",{className:"text-red-400 font-bold mb-4",children:l}),b.jsxs("button",{onClick:()=>{n(!0),d()},className:"flex items-center gap-2 mx-auto text-xs font-black text-slate-400 hover:text-white uppercase tracking-widest bg-white/5 px-4 py-2 rounded-xl transition-all",children:[b.jsx(RU,{size:14}),"  "]})]}):b.jsx("div",{className:"grid gap-4",children:s.map((S,A)=>b.jsxs("div",{onClick:()=>a(S),className:`relative flex items-center justify-between p-4 md:p-5 rounded-[1.8rem] md:rounded-[2.2rem] border transition-all duration-700 group hover:scale-[1.01] cursor-pointer ${h(S.rank)} animate-lux-up`,style:{animationDelay:`${A*.08}s`},children:[b.jsxs("div",{className:"flex items-center gap-4 md:gap-8",children:[b.jsx("div",{className:"w-10 flex justify-center shrink-0",children:_(S.rank)}),b.jsx("div",{className:"relative",children:b.jsx("div",{className:`w-14 h-14 md:w-16 md:h-16 rounded-full border overflow-hidden bg-black/60 ${S.rank===1?"border-yellow-400/20 ring-4 ring-yellow-400/5":"border-white/5"}`,children:b.jsx("img",{src:`https://api.dicebear.com/9.x/notionists/svg?seed=${S.avatar||"default"}&backgroundColor=b6e3f4,c0aede,d1d4f9`,alt:S.name,className:"w-full h-full object-cover opacity-90"})})}),b.jsxs("div",{children:[b.jsx("h3",{className:`font-black text-base md:text-lg tracking-tight ${S.rank<=5?"text-white/90":"text-slate-400"}`,children:S.name}),b.jsx("p",{className:`text-[10px] font-black uppercase tracking-widest ${S.rank===1?"text-yellow-500/60":"text-slate-500"}`,children:p(S.rank)})]})]}),b.jsxs("div",{className:"flex flex-col items-end shrink-0",children:[b.jsxs("div",{className:"flex items-center gap-1.5",children:[b.jsx("span",{className:`text-xl md:text-2xl font-black font-mono leading-none ${S.rank===1?"text-yellow-500/80":"text-white/80"}`,children:S.totalExp}),b.jsx(iw,{size:14,className:"text-slate-600"})]}),b.jsx("span",{className:"text-[8px] font-black uppercase tracking-tighter text-slate-700",children:" "})]})]},S.userId))}),i&&i5.createPortal(b.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4",children:[b.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-3xl",onClick:()=>a(null)}),b.jsxs("div",{className:`glass-panel w-[90%] sm:w-full max-w-md rounded-[3rem] relative animate-lux-scale border border-white/10 shadow-[0_0_80px_rgba(0,0,0,1)] overflow-hidden ${h(i.rank)}`,children:[b.jsx("button",{onClick:()=>a(null),className:"absolute top-6 right-6 w-9 h-9 flex items-center justify-center bg-red-500/20 text-red-400 border border-red-500/30 hover:bg-red-500/30 hover:text-red-300 rounded-full transition-all z-20",children:b.jsx(Zp,{size:22})}),b.jsx("div",{className:"p-8 md:p-10 flex flex-col items-center text-center relative z-10",children:(()=>{const S={1:"text-yellow-400",2:"text-fuchsia-400",3:"text-amber-500"},A=S[i.rank]||"text-white/80",E=S[i.rank]?S[i.rank].replace("400","300"):"text-white/70";return b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"w-32 h-32 rounded-full border-2 shadow-2xl mb-6 overflow-hidden bg-black/80",children:b.jsx("img",{src:`https://api.dicebear.com/9.x/notionists/svg?seed=${i.avatar||"default"}&backgroundColor=b6e3f4,c0aede,d1d4f9`,alt:i.name,className:"w-full h-full object-cover opacity-90"})}),b.jsx("h3",{className:"text-3xl font-black text-white/90 mb-1 tracking-tight",children:i.name}),b.jsx("p",{className:"text-sm font-black text-white/40 mb-8",children:p(i.rank)}),b.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full mb-8 text-center",children:[b.jsxs("div",{className:"bg-black/40 backdrop-blur-md rounded-[2rem] p-6 border border-white/5 flex flex-col items-center",children:[b.jsx("span",{className:`text-3xl font-black ${A}`,children:i.totalQuizzes}),b.jsx("span",{className:"text-[10px] text-white/30 font-bold uppercase tracking-widest",children:" "})]}),b.jsxs("div",{className:"bg-black/40 backdrop-blur-md rounded-[2rem] p-6 border border-white/5 flex flex-col items-center",children:[b.jsxs("span",{className:`text-3xl font-black ${A}`,children:[i.averageScore,"%"]}),b.jsx("span",{className:"text-[10px] text-white/30 font-bold uppercase tracking-widest",children:" "})]})]}),b.jsxs("div",{className:"w-full space-y-3 mb-8",children:[b.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[b.jsx(DN,{size:20,className:"text-slate-500 shrink-0"}),b.jsxs("div",{className:"text-right",children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),b.jsx("p",{className:`text-sm font-bold ${E}`,children:i.university||" "})]})]}),b.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[b.jsx(HN,{size:20,className:"text-slate-500 shrink-0"}),b.jsxs("div",{className:"text-right",children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),b.jsx("p",{className:`text-sm font-bold ${E}`,children:i.major||" "})]})]}),b.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[b.jsx(dO,{size:20,className:"text-slate-500 shrink-0"}),b.jsxs("div",{className:"text-right",children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),b.jsx("p",{className:`text-sm font-bold ${E}`,children:i.age||" "})]})]})]}),b.jsx("div",{className:"w-full text-center px-4 py-4 rounded-2xl bg-black/20 border border-white/5",children:b.jsxs("p",{className:"text-xs italic text-slate-400",children:['"',y(i.rank),'"']})})]})})()})]})]}),document.body)]})},a5=()=>{const[s,e]=se.useState({quizzes:0,students:125,loading:!0});se.useEffect(()=>{(async()=>{try{const{count:a,error:l}=await Ht.from("quiz_history").select("*",{count:"exact",head:!0}),{data:c,error:d}=await Ht.from("quiz_history").select("user_id");if(l||d)throw new Error("Error fetching stats");const h=new Set(c==null?void 0:c.map(p=>p.user_id)).size;e({quizzes:a||0,students:125+h,loading:!1})}catch(a){console.error("Failed to fetch live stats:",a),e(l=>({...l,loading:!1}))}})()},[]);const t=[{label:"  ",value:s.loading?"...":`+${s.quizzes.toLocaleString()}`,icon:b.jsx(gc,{size:20}),color:"text-amber-400",bg:"bg-amber-500/10"},{label:" ",value:s.loading?"...":`+${s.students.toLocaleString()}`,icon:b.jsx(YN,{size:20}),color:"text-violet-400",bg:"bg-violet-500/10"},{label:" ",value:"99.2%",icon:b.jsx(HU,{size:20}),color:"text-emerald-400",bg:"bg-emerald-500/10"}],n=[{title:"  ",desc:"   Gemini        .",icon:b.jsx(da,{className:"text-violet-400"})},{title:"  ",desc:"   10   100      .",icon:b.jsx(m0,{className:"text-blue-400"})},{title:"  ",desc:"            .",icon:b.jsx(LN,{className:"text-fuchsia-400"})}];return b.jsxs("div",{className:"w-full max-w-5xl mx-auto mt-16 mb-24 px-4",children:[b.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-16",children:t.map((i,a)=>b.jsxs("div",{className:"glass-panel p-6 rounded-[2rem] border border-white/5 flex items-center gap-5 hover:border-white/10 transition-all animate-lux-up",style:{animationDelay:`${a*.1}s`},children:[b.jsx("div",{className:`w-12 h-12 rounded-2xl ${i.bg} ${i.color} flex items-center justify-center shrink-0`,children:s.loading&&a<2?b.jsx(Di,{size:18,className:"animate-spin"}):i.icon}),b.jsxs("div",{children:[b.jsx("p",{className:"text-2xl font-black text-white leading-none mb-1",children:i.value}),b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:i.label})]})]},a))}),b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"absolute inset-0 bg-violet-600/5 blur-[100px] rounded-full pointer-events-none"}),b.jsxs("div",{className:"text-center mb-12 animate-lux-up",children:[b.jsx("h2",{className:"text-3xl font-black text-white mb-3",children:"   "}),b.jsx("div",{className:"h-1 w-20 bg-gradient-to-r from-violet-600 to-fuchsia-600 mx-auto rounded-full"})]}),b.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 relative z-10",children:n.map((i,a)=>b.jsxs("div",{className:"group glass-panel p-8 rounded-[2.5rem] border border-white/5 hover:border-violet-500/30 transition-all animate-lux-up",style:{animationDelay:`${(a+3)*.1}s`},children:[b.jsx("div",{className:"w-14 h-14 rounded-2xl bg-white/5 flex items-center justify-center mb-6 group-hover:scale-110 group-hover:bg-violet-500/10 transition-all duration-500",children:Wp.cloneElement(i.icon,{size:28})}),b.jsx("h3",{className:"text-xl font-bold text-white mb-3 group-hover:text-violet-300 transition-colors",children:i.title}),b.jsx("p",{className:"text-sm text-slate-500 leading-relaxed font-medium",children:i.desc})]},a))})]}),b.jsx("div",{className:"mt-16 glass-panel p-1 border-white/5 rounded-[2rem] overflow-hidden animate-lux-up",style:{animationDelay:"0.8s"},children:b.jsxs("div",{className:"bg-gradient-to-r from-violet-900/20 via-black to-fuchsia-900/20 p-8 rounded-[1.9rem] flex flex-col items-center text-center",children:[b.jsx(ev,{className:"text-yellow-500/50 mb-4 animate-pulse",size:32,fill:"currentColor"}),b.jsx("p",{className:"text-xl md:text-2xl font-medium text-slate-300 italic leading-relaxed",children:'"      ."'}),b.jsx("p",{className:"mt-4 text-xs font-black text-violet-400 uppercase tracking-widest",children:"  "})]})})]})},o5=({onNavigate:s,onLogActivity:e})=>{const[t,n]=se.useState("selection");se.useEffect(()=>{const G=ae=>{ae.state&&ae.state.toolView?n(ae.state.toolView):n("selection"),window.scrollTo(0,0)};return window.addEventListener("popstate",G),()=>window.removeEventListener("popstate",G)},[]);const i=G=>{if(G!==t){if(window.scrollTo(0,0),G!=="selection")window.history.pushState({toolView:G,appState:he.SERVICES},"");else{t!=="selection"&&window.history.back();return}n(G)}},[a,l]=se.useState(""),[c,d]=se.useState(""),[h,p]=se.useState(""),[y,_]=se.useState(null),[S,A]=se.useState(""),[E,N]=se.useState("100to4"),[R,D]=se.useState(null),[P,L]=se.useState(""),[z,H]=se.useState(""),[F,X]=se.useState([{id:"1",grade:"",hours:"3",isRepeated:!1,isExcluded:!1},{id:"2",grade:"",hours:"3",isRepeated:!1,isExcluded:!1}]),[Y,J]=se.useState(null),ie=()=>{X([...F,{id:Date.now().toString(),grade:"",hours:"3",isRepeated:!1,isExcluded:!1}])},pe=(G,ae)=>{X(F.map(we=>we.id===G?{...we,...ae}:we))},ye=()=>{const G=parseFloat(a),ae=parseFloat(c),we=parseFloat(h);if(isNaN(G)||isNaN(ae)||isNaN(we)){_({type:"error",message:"    "});return}const Ne=G*.45+ae*.1,U=(we-Ne)/.45;U<0?_({type:"error",message:"  "}):(_({type:"success",message:"  :",value:U.toFixed(2)}),e==null||e("  "))},be=()=>{const G=parseFloat(S);if(!isNaN(G))if(E==="100to4"){if(G>100||G<0){D({type:"error",message:"0-100 "});return}let ae=G>=50?(2.14+(G-50)*.04).toFixed(2):"0.00";D({type:"success",message:"  4.00 :",value:ae})}else{if(G>4||G<0){D({type:"error",message:"0-4 "});return}let ae=G>=2.14?Math.min(96,Math.round((G-2.14)/.04+50)).toString():"< 50";D({type:"success",message:" :",value:ae})}},Se=()=>{let G=(parseFloat(P)||0)*(parseFloat(z)||0),ae=parseFloat(z)||0;F.forEach(we=>{const Ne=parseFloat(we.grade),U=parseFloat(we.hours);isNaN(Ne)||isNaN(U)||we.isExcluded||Ne<60||(G+=Ne*U,ae+=U)}),J({gpa:ae>0?(G/ae).toFixed(2):"0.00",hours:ae})},j=()=>b.jsxs("div",{className:"animate-lux-up space-y-10",children:[b.jsxs("div",{className:"text-center mb-12",children:[b.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-2xl bg-violet-500/10 text-violet-400 mb-6 border border-violet-500/20",children:b.jsx(gc,{size:32})}),b.jsx("h2",{className:"text-3xl font-black text-white mb-4",children:" "})]}),b.jsx("div",{className:"max-w-5xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[{id:"final_calc",title:"  ",desc:"    .",icon:b.jsx(PN,{}),color:"violet"},{id:"gpa_calc",title:" ",desc:"   100%  4.0.",icon:b.jsx(sO,{}),color:"emerald"},{id:"cumulative_gpa_100",title:" ",desc:"   .",icon:b.jsx(EU,{}),color:"blue"}].map(G=>b.jsxs("div",{onClick:()=>i(G.id),className:"glass-panel group p-6 rounded-[2rem] bg-[#080808] border border-white/5 hover:border-violet-500/30 cursor-pointer transition-all flex flex-col items-center text-center",children:[b.jsx("div",{className:`w-12 h-12 bg-${G.color}-500/10 rounded-xl flex items-center justify-center text-${G.color}-400 mb-4`,children:G.icon}),b.jsx("h3",{className:"text-sm font-bold text-white mb-2",children:G.title}),b.jsxs("div",{className:"mt-auto w-full py-2 rounded-xl bg-white/5 text-[10px] font-black text-slate-400",children:["  ",b.jsx(Cu,{size:14,className:"inline"})]})]},G.id))})]});return b.jsx("div",{className:"min-h-screen pt-20 sm:pt-28 pb-20 relative z-10 px-4",children:b.jsxs("div",{className:"max-w-6xl mx-auto",children:[b.jsxs("div",{className:"flex items-center gap-2 mb-6 text-xs font-bold text-slate-500",dir:"rtl",children:[b.jsx("button",{onClick:()=>s(he.HOME),className:"hover:text-white",children:""}),b.jsx(rw,{size:12}),b.jsx("button",{onClick:()=>i("selection"),className:t==="selection"?"text-violet-400":"hover:text-white",children:" "})]}),t==="selection"&&j(),t==="final_calc"&&b.jsx("div",{className:"animate-lux-up max-w-lg mx-auto space-y-6",children:b.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#080808] border border-white/10 text-right",children:[b.jsx("h3",{className:"text-xl font-black text-white mb-6",children:" "}),b.jsxs("div",{className:"space-y-4",children:[b.jsx("input",{type:"number",value:a,onChange:G=>l(G.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:" (100)"}),b.jsx("input",{type:"number",value:c,onChange:G=>d(G.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:" (100)"}),b.jsx("input",{type:"number",value:h,onChange:G=>p(G.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:" "}),b.jsx(yt,{onClick:ye,fullWidth:!0,children:""})]}),y&&b.jsx("div",{className:"mt-6 p-4 bg-white/5 rounded-2xl text-center",children:b.jsx("p",{className:"text-3xl font-black text-white",children:y.value})})]})}),t==="gpa_calc"&&b.jsx("div",{className:"animate-lux-up max-w-lg mx-auto space-y-6",children:b.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#080808] border border-white/10 text-right",children:[b.jsxs("div",{className:"flex bg-white/5 p-1 rounded-xl mb-6",children:[b.jsx("button",{onClick:()=>N("100to4"),className:`flex-1 py-2 rounded-lg text-xs font-bold ${E==="100to4"?"bg-emerald-600 text-white":"text-slate-500"}`,children:"100  4"}),b.jsx("button",{onClick:()=>N("4to100"),className:`flex-1 py-2 rounded-lg text-xs font-bold ${E==="4to100"?"bg-emerald-600 text-white":"text-slate-500"}`,children:"4  100"})]}),b.jsx("input",{type:"number",value:S,onChange:G=>A(G.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white text-right font-bold",placeholder:" "}),b.jsx(yt,{onClick:be,fullWidth:!0,className:"!bg-emerald-600 mt-4",children:""}),R&&b.jsx("div",{className:"mt-6 p-6 bg-emerald-500/5 rounded-3xl text-center",children:b.jsx("p",{className:"text-5xl font-black text-white",children:R.value})})]})}),t==="cumulative_gpa_100"&&b.jsx("div",{className:"animate-lux-up max-w-2xl mx-auto space-y-6",children:b.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#080808] border border-white/10 text-right",children:[b.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[b.jsx("input",{type:"number",value:P,onChange:G=>L(G.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:" "}),b.jsx("input",{type:"number",value:z,onChange:G=>H(G.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:" "})]}),b.jsxs("div",{className:"space-y-4 mb-6",children:[F.map(G=>b.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[b.jsx("input",{type:"number",value:G.grade,onChange:ae=>pe(G.id,{grade:ae.target.value}),className:"col-span-2 bg-black/40 border border-white/5 rounded-lg p-2 text-white text-right",placeholder:""}),b.jsx("input",{type:"number",value:G.hours,onChange:ae=>pe(G.id,{hours:ae.target.value}),className:"bg-black/40 border border-white/5 rounded-lg p-2 text-white text-right",placeholder:""})]},G.id)),b.jsx("button",{onClick:ie,className:"text-xs text-blue-400 font-bold",children:"+  "})]}),b.jsx(yt,{onClick:Se,fullWidth:!0,className:"!bg-blue-600",children:" "}),Y&&b.jsx("div",{className:"mt-6 p-6 bg-blue-500/5 rounded-3xl text-center",children:b.jsx("p",{className:"text-4xl font-black text-white",children:Y.gpa})})]})})]})})},Ag=()=>{const[s,e]=se.useState(!1),t=se.useRef(null);return se.useEffect(()=>{const n=new IntersectionObserver(([i])=>{i.isIntersecting&&(e(!0),n.unobserve(i.target))},{threshold:.1,rootMargin:"0px 0px -50px 0px"});return t.current&&n.observe(t.current),()=>{t.current&&n.unobserve(t.current)}},[]),{ref:t,isVisible:s}},l5=({onNavigate:s})=>{const e=Ag(),t=Ag(),n=Ag(),i=Ag(),a=()=>b.jsxs("div",{className:"flex items-center gap-2 mb-8 text-[10px] sm:text-xs font-bold text-slate-500 overflow-x-auto whitespace-nowrap py-2",dir:"rtl",children:[b.jsxs("button",{onClick:()=>s(he.HOME),className:"flex items-center gap-1 hover:text-white transition-colors",children:[b.jsx(ow,{size:14})," "]}),b.jsx(rw,{size:12,className:"shrink-0 opacity-40"}),b.jsx("span",{className:"text-white bg-violet-500/10 px-2 py-0.5 rounded-md border border-violet-500/20",children:" "})]});return b.jsxs("div",{className:"min-h-screen pt-20 sm:pt-28 pb-32 px-4 relative z-10 bg-[#000000] text-right overflow-x-hidden",dir:"rtl",children:[b.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none",children:[b.jsx("div",{className:"absolute top-[-10%] left-[20%] w-[80vw] h-[80vw] bg-violet-600/10 rounded-full blur-[120px]"}),b.jsx("div",{className:"absolute bottom-[-5%] right-[-10%] w-[60vw] h-[60vw] bg-fuchsia-600/10 rounded-full blur-[100px]"})]}),b.jsxs("div",{className:"max-w-6xl mx-auto relative z-10",children:[b.jsxs("div",{className:"flex items-center justify-between mb-8 animate-lux-up",children:[b.jsx(a,{}),b.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 px-4 py-2 rounded-full bg-[#0f172a]/50 border border-violet-500/20 shadow-[0_0_20px_rgba(139,92,246,0.15)] backdrop-blur-xl",children:[b.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-violet-500 animate-pulse"}),b.jsx("span",{className:"text-[9px] sm:text-[11px] font-black text-violet-100 tracking-widest",children:" "})]})]}),b.jsxs("div",{ref:e.ref,className:`grid grid-cols-1 lg:grid-cols-2 gap-12 items-center mb-24 transition-all duration-1000 transform ${e.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-12"}`,children:[b.jsxs("div",{className:"text-right space-y-6 sm:space-y-8",children:[b.jsx("div",{className:"space-y-4",children:b.jsxs("h1",{className:"text-4xl sm:text-6xl md:text-8xl font-black text-white leading-tight tracking-tighter",children:[" ",b.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-400 to-blue-400",children:""})," ",b.jsx("br",{})," ."]})}),b.jsxs("p",{className:"text-slate-400 text-base sm:text-lg md:text-xl leading-relaxed max-w-xl font-medium",children:[" ",b.jsx("span",{className:"text-white font-bold italic",children:" "}),"   ",b.jsx("span",{className:"text-violet-400 font-bold",children:"  "}),".            ."]}),b.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-4",children:[b.jsxs("a",{href:"https://wa.me/962790000000",target:"_blank",className:"px-8 py-4 bg-gradient-to-r from-violet-600 to-fuchsia-600 rounded-2xl text-white font-black flex items-center justify-center gap-3 hover:shadow-[0_0_30px_rgba(139,92,246,0.4)] transition-all transform hover:-translate-y-1 active:scale-95 text-sm sm:text-base",children:[b.jsx(x_,{size:20}),"  "]}),b.jsx("button",{className:"px-8 py-4 bg-white/5 border border-white/10 rounded-2xl text-slate-300 font-black hover:bg-white/10 transition-all text-sm sm:text-base",children:" "})]})]}),b.jsx("div",{className:"relative order-first lg:order-last overflow-hidden sm:overflow-visible",children:b.jsxs("div",{className:"relative aspect-square w-full max-w-[280px] sm:max-w-lg mx-auto flex items-center justify-center",children:[b.jsx("div",{className:"absolute w-24 h-24 sm:w-32 sm:h-32 bg-violet-600/20 rounded-full blur-[40px] sm:blur-[60px] animate-pulse"}),b.jsxs("svg",{viewBox:"0 0 200 200",className:"w-full h-full relative z-10 overflow-visible",children:[b.jsx("defs",{children:b.jsxs("radialGradient",{id:"grad1",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%",children:[b.jsx("stop",{offset:"0%",style:{stopColor:"#8b5cf6",stopOpacity:.4}}),b.jsx("stop",{offset:"100%",style:{stopColor:"transparent",stopOpacity:0}})]})}),b.jsx("g",{className:"animate-spin",style:{transformOrigin:"center",animationDuration:"60s"},children:[...Array(15)].map((l,c)=>{const d=c/15*Math.PI*2,h=60+Math.random()*30,p=100+Math.cos(d)*h,y=100+Math.sin(d)*h;return b.jsx("circle",{cx:p,cy:y,r:Math.random()*1,fill:"white",className:"animate-pulse",style:{animationDelay:`${c*.3}s`}},c)})}),b.jsx("circle",{cx:"100",cy:"100",r:"45",fill:"none",stroke:"url(#grad1)",strokeWidth:"0.5",className:"animate-pulse"}),b.jsx("circle",{cx:"100",cy:"100",r:"65",fill:"none",stroke:"#8b5cf6",strokeWidth:"0.2",strokeDasharray:"4,10",className:"opacity-40"})]}),b.jsx("div",{className:"absolute top-1/4 right-[10%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-violet-400 shadow-[0_0_20px_rgba(139,92,246,0.3)] animate-bounce",style:{animationDuration:"4.5s"},children:b.jsx(FN,{size:24})}),b.jsx("div",{className:"absolute bottom-[20%] left-[5%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-fuchsia-400 shadow-[0_0_20px_rgba(217,70,239,0.3)] animate-bounce",style:{animationDuration:"5.5s",animationDelay:"1.2s"},children:b.jsx(VN,{size:24})}),b.jsx("div",{className:"absolute top-[45%] left-[-5%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-blue-400 shadow-[0_0_20px_rgba(59,130,246,0.3)] animate-bounce",style:{animationDuration:"6.5s",animationDelay:"2.5s"},children:b.jsx(GN,{size:24})}),b.jsx("div",{className:"absolute w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-violet-500/10 to-transparent rounded-full flex items-center justify-center border border-white/5 backdrop-blur-sm",children:b.jsx(__,{size:28,className:"text-white/80 animate-pulse"})})]})})]}),b.jsxs("div",{ref:t.ref,className:`mb-12 flex flex-col md:flex-row md:items-end justify-between gap-6 transition-all duration-1000 transform ${t.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:[b.jsxs("div",{className:"text-right",children:[b.jsx("h3",{className:"text-2xl sm:text-3xl font-black text-white mb-2",children:" "}),b.jsx("p",{className:"text-yellow-400 text-sm sm:text-base font-bold mb-3",children:"       "}),b.jsx("div",{className:"h-1.5 w-32 bg-gradient-to-r from-violet-600 via-fuchsia-500 to-transparent rounded-full"})]}),b.jsx("p",{className:"text-slate-500 text-[9px] sm:text-[10px] font-bold uppercase tracking-[0.3em]",children:"Etqan Excellence Solutions"})]}),b.jsx("div",{ref:n.ref,className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-24",children:[{icon:b.jsx(SU,{className:"text-violet-400"}),title:"  ",subtitle:"Premium Web Experiences",desc:b.jsxs("div",{className:"space-y-3",children:[b.jsx("p",{children:"     (Portfolios)       ."}),b.jsxs("div",{className:"text-yellow-400 font-bold text-[11px] sm:text-xs bg-yellow-400/5 p-3 rounded-xl border border-yellow-400/10",children:[b.jsx("p",{className:"mb-2 opacity-80 border-b border-yellow-400/20 pb-1 inline-block",children:":"}),b.jsxs("ul",{className:"space-y-1",children:[b.jsx("li",{children:"   "}),b.jsx("li",{children:"   "}),b.jsx("li",{children:"    "})]})]})]}),tags:["React","Tailwind","Motion"],color:"violet"},{icon:b.jsx(__,{className:"text-blue-400"}),title:"  ",subtitle:"Academic & Enterprise Solutions",desc:"            .",tags:["Architecture","Database","AI"],color:"blue"}].map((l,c)=>b.jsx(c5,{index:c,icon:l.icon,title:l.title,subtitle:l.subtitle,desc:l.desc,tags:l.tags,color:l.color,isVisible:n.isVisible},c))}),b.jsxs("div",{ref:i.ref,className:`glass-panel p-8 sm:p-16 rounded-[2.5rem] sm:rounded-[3rem] bg-gradient-to-br from-[#0a0a0a] via-[#050505] to-[#111] border border-white/5 relative overflow-hidden text-center transition-all duration-1000 transform shadow-2xl ${i.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-12"}`,children:[b.jsx("div",{className:"absolute -top-24 -left-24 w-64 h-64 bg-violet-600/10 rounded-full blur-[100px] pointer-events-none"}),b.jsx("div",{className:"absolute -bottom-24 -right-24 w-64 h-64 bg-fuchsia-600/10 rounded-full blur-[100px] pointer-events-none"}),b.jsxs("div",{className:"relative z-10 space-y-6 sm:space-y-8",children:[b.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 sm:w-16 sm:h-16 rounded-2xl bg-white/5 border border-white/10 mb-2",children:b.jsx(MU,{className:"text-violet-500 animate-pulse",size:28})}),b.jsx("h2",{className:"text-3xl sm:text-5xl font-black text-white tracking-tight",children:"   "}),b.jsx("p",{className:"text-slate-400 text-base sm:text-lg max-w-2xl mx-auto font-medium px-4",children:"        .   ."}),b.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 pt-6 px-4",children:[b.jsxs("a",{href:"https://wa.me/962790000000",className:"w-full sm:w-auto px-10 py-4 bg-emerald-600 hover:bg-emerald-500 rounded-2xl text-white font-black flex items-center justify-center gap-3 transition-all shadow-xl shadow-emerald-900/20 text-sm sm:text-base",children:[b.jsx(x_,{size:22}),"   "]}),b.jsx("button",{className:"w-full sm:w-auto px-10 py-4 bg-white/5 border border-white/10 rounded-2xl text-slate-300 font-black hover:bg-white/10 transition-all text-sm sm:text-base",children:"  "})]})]})]}),b.jsxs("div",{className:"mt-20 text-center space-y-4 px-4 pb-12",children:[b.jsxs("div",{className:"flex items-center justify-center gap-4 sm:gap-6 text-slate-600",children:[b.jsx("div",{className:"w-6 sm:w-8 h-px bg-white/5"}),b.jsx("span",{className:"text-[9px] sm:text-[10px] font-black uppercase tracking-[0.3em] whitespace-nowrap",children:"Etqan Group Jordan"}),b.jsx("div",{className:"w-6 sm:w-8 h-px bg-white/5"})]}),b.jsx("p",{className:"text-[9px] sm:text-[10px] font-bold text-slate-700",children:"      2024"})]})]})]})},c5=({index:s,icon:e,title:t,subtitle:n,desc:i,tags:a,color:l,isVisible:c})=>{const d={violet:"text-violet-400",fuchsia:"text-fuchsia-400",blue:"text-blue-400",emerald:"text-emerald-400",amber:"text-amber-400",rose:"text-rose-400"};return b.jsxs("div",{className:`group glass-panel p-6 sm:p-8 rounded-[2rem] sm:rounded-[2.5rem] bg-[#050505] border backdrop-blur-xl transition-all duration-700 hover:-translate-y-2 flex flex-col h-full relative overflow-hidden transform ${c?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,style:{transitionDelay:`${s*150}ms`},children:[b.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"}),b.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-2xl bg-white/5 flex items-center justify-center mb-5 sm:mb-6 group-hover:scale-110 transition-transform duration-500",children:Wp.cloneElement(e,{size:24})}),b.jsxs("div",{className:"mb-2",children:[b.jsx("h3",{className:"text-lg sm:text-xl font-black text-white mb-1 group-hover:text-white transition-colors",children:t}),b.jsx("p",{className:`text-[9px] sm:text-[10px] font-black uppercase tracking-widest ${d[l]} opacity-70`,children:n})]}),b.jsx("div",{className:"text-slate-500 text-xs sm:text-sm leading-relaxed mb-6 sm:mb-8 flex-1 font-medium",children:i}),b.jsx("div",{className:"flex flex-wrap gap-2",children:a.map((h,p)=>b.jsx("span",{className:"px-2.5 py-1 rounded-lg bg-white/5 border border-white/5 text-[8px] sm:text-[9px] font-bold text-slate-400 uppercase tracking-wider",children:h},p))}),b.jsx("div",{className:"absolute -bottom-10 -right-10 w-20 h-20 sm:w-24 sm:h-24 rounded-full blur-[30px] sm:blur-[40px] opacity-0 group-hover:opacity-20 transition-opacity bg-current"})]})},Kb=()=>{const[s,e]=se.useState(!1),t=se.useRef(null);return se.useEffect(()=>{const n=new IntersectionObserver(([i])=>{i.isIntersecting&&(e(!0),n.unobserve(i.target))},{threshold:.1});return t.current&&n.observe(t.current),()=>{t.current&&n.unobserve(t.current)}},[]),{ref:t,isVisible:s}},u5=({onNavigate:s})=>{const e=Kb(),t=Kb(),n=Kb(),i="https://lh3.googleusercontent.com/d/1tbzVNKO3FGH46Pa6MZ58OWD4BXVKdK5P",a=()=>b.jsxs("div",{className:"flex items-center gap-2 mb-0 text-[10px] sm:text-xs font-bold text-slate-500 overflow-x-auto whitespace-nowrap py-2",dir:"rtl",children:[b.jsxs("button",{onClick:()=>s(he.HOME),className:"flex items-center gap-1 hover:text-white transition-colors",children:[b.jsx(ow,{size:14})," "]}),b.jsx(rw,{size:12,className:"shrink-0 opacity-40"}),b.jsx("span",{className:"text-white bg-violet-500/10 px-2 py-0.5 rounded-md border border-violet-500/20",children:" "})]});return b.jsxs("div",{className:"min-h-screen pt-16 sm:pt-40 pb-32 px-4 relative bg-[#020205] text-right overflow-x-hidden",dir:"rtl",children:[b.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden",children:[b.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[100vw] h-[100vw] bg-violet-900/5 rounded-full blur-[120px]"}),b.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[80vw] h-[80vw] bg-fuchsia-900/5 rounded-full blur-[100px]"})]}),b.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[b.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-8 animate-lux-up px-2 sm:px-0",children:[b.jsx(a,{}),b.jsx("div",{className:"px-4 py-1.5 sm:px-5 sm:py-2 rounded-full bg-violet-500/10 border border-violet-500/20 text-violet-400 text-[10px] sm:text-[11px] font-black tracking-widest uppercase",children:" "})]}),b.jsx("div",{ref:e.ref,className:`relative mb-12 sm:mb-20 transition-all duration-1000 transform ${e.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:b.jsxs("div",{className:"glass-panel p-6 sm:p-12 rounded-[2.5rem] sm:rounded-[3rem] bg-gradient-to-br from-[#0a0a0a] to-black border border-white/10 relative overflow-hidden flex flex-col items-center text-center",children:[b.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-1/2 bg-gradient-to-b from-violet-600/5 to-transparent"}),b.jsxs("div",{className:"relative mb-6 sm:mb-8",children:[b.jsx("div",{className:"absolute inset-0 bg-violet-600/10 blur-3xl"}),b.jsx("div",{className:"relative w-28 h-28 sm:w-44 sm:h-44 bg-[#050505] rounded-[2rem] sm:rounded-[2.5rem] border border-white/10 flex items-center justify-center shadow-2xl mx-auto overflow-hidden group",children:b.jsx("img",{src:i,alt:"  ",className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",onError:l=>{l.target.src="https://api.dicebear.com/9.x/notionists/svg?seed=Joshua&backgroundColor=b6e3f4,c0aede,d1d4f9"}})}),b.jsx("div",{className:"absolute -bottom-1 -right-1 sm:-bottom-2 sm:-right-2 bg-violet-600 p-2 sm:p-2.5 rounded-xl sm:rounded-2xl border-2 sm:border-4 border-[#0a0a0a] text-white shadow-lg",children:b.jsx(da,{size:16,className:"sm:w-5 sm:h-5"})})]}),b.jsxs("div",{className:"space-y-4 relative z-10 w-full",children:[b.jsxs("h1",{className:"text-3xl sm:text-6xl font-black text-white tracking-tighter",children:[" ",b.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-400 to-white",children:" "})]}),b.jsx("p",{className:"text-slate-400 text-xs sm:text-base font-bold max-w-lg mx-auto leading-relaxed px-2",children:"            ."}),b.jsx("div",{className:"flex items-center justify-center gap-4 text-[10px] sm:text-xs font-black text-slate-500 uppercase tracking-widest pt-1",children:b.jsxs("span",{className:"flex items-center gap-1.5",children:[b.jsx(hU,{size:12,className:"text-violet-500 sm:w-3.5 sm:h-3.5"}),"  "]})}),b.jsxs("div",{className:"pt-6 sm:pt-8 flex flex-col items-center gap-3",children:[b.jsx("span",{className:"text-yellow-400 text-[11px] sm:text-sm font-black uppercase tracking-[0.25em] drop-shadow-[0_0_8px_rgba(250,204,21,0.3)]",children:" "}),b.jsxs("div",{className:"flex items-center justify-center gap-4 sm:gap-6",children:[b.jsx("a",{href:"https://www.facebook.com/yazanabokaheal2",target:"_blank",rel:"noopener noreferrer",className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-[#1877F2]/10 border border-[#1877F2]/20 flex items-center justify-center text-[#1877F2] hover:bg-[#1877F2]/20 hover:scale-110 transition-all shadow-[0_0_15px_rgba(24,119,242,0.15)] group",title:"",children:b.jsx(LO,{size:24,className:"sm:w-8 sm:h-8 group-hover:drop-shadow-[0_0_8px_rgba(24,119,242,0.5)] transition-all"})}),b.jsx("a",{href:"https://wa.me/972568401548",target:"_blank",rel:"noopener noreferrer",className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-[#25D366]/10 border border-[#25D366]/20 flex items-center justify-center text-[#25D366] hover:bg-[#25D366]/20 hover:scale-110 transition-all shadow-[0_0_15px_rgba(37,211,102,0.15)] group",title:"",children:b.jsx(x_,{size:24,className:"sm:w-8 sm:h-8 group-hover:drop-shadow-[0_0_8px_rgba(37,211,102,0.5)] transition-all"})}),b.jsx("a",{href:"https://t.me/yazan1342",target:"_blank",rel:"noopener noreferrer",className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-[#0088cc]/10 border border-[#0088cc]/20 flex items-center justify-center text-[#0088cc] hover:bg-[#0088cc]/20 hover:scale-110 transition-all shadow-[0_0_15px_rgba(0,136,204,0.15)] group",title:"",children:b.jsx(FU,{size:24,className:"sm:w-8 sm:h-8 group-hover:drop-shadow-[0_0_8px_rgba(0,136,204,0.5)] transition-all"})})]})]})]})]})}),b.jsxs("div",{ref:t.ref,className:`grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-12 transition-all duration-1000 transform ${t.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:[b.jsxs("div",{className:"group relative",children:[b.jsx("div",{className:"absolute inset-0 bg-violet-600/20 blur-2xl opacity-0 group-hover:opacity-100 transition-opacity rounded-[2.5rem]"}),b.jsxs("div",{className:"glass-panel relative p-6 sm:p-8 rounded-[2rem] sm:rounded-[2.5rem] bg-[#050505] border border-white/5 h-full flex flex-col items-start text-right transition-all group-hover:border-violet-500/30",children:[b.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-xl sm:rounded-2xl bg-violet-500/10 flex items-center justify-center text-violet-400 mb-5 group-hover:scale-110 transition-transform shadow-inner",children:b.jsx(Ud,{size:24,className:"sm:w-7 sm:h-7"})}),b.jsx("h3",{className:"text-lg sm:text-xl font-black text-white mb-2",children:" "}),b.jsxs("p",{className:"text-slate-400 text-xs sm:text-sm leading-relaxed font-medium",children:["  ",b.jsx("span",{className:"text-violet-400 font-bold",children:" "}),"     -    ",b.jsx("span",{className:"text-yellow-400 font-bold",children:""}),"."]})]})]}),b.jsxs("div",{className:"group relative",children:[b.jsx("div",{className:"absolute inset-0 bg-fuchsia-600/20 blur-2xl opacity-0 group-hover:opacity-100 transition-opacity rounded-[2.5rem]"}),b.jsxs("div",{className:"glass-panel relative p-6 sm:p-8 rounded-[2rem] sm:rounded-[2.5rem] bg-[#050505] border border-white/5 h-full flex flex-col items-start text-right transition-all group-hover:border-fuchsia-500/30",children:[b.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-xl sm:rounded-2xl bg-fuchsia-500/10 flex items-center justify-center text-fuchsia-400 mb-5 group-hover:scale-110 transition-transform shadow-inner",children:b.jsx(oO,{size:24,className:"sm:w-7 sm:h-7"})}),b.jsx("h3",{className:"text-lg sm:text-xl font-black text-white mb-2",children:" "}),b.jsxs("p",{className:"text-slate-400 text-xs sm:text-sm leading-relaxed font-medium",children:["    ",b.jsx("span",{className:"text-fuchsia-400 font-bold",children:"   - "}),".            ."]})]})]})]}),b.jsx("div",{ref:n.ref,className:`relative transition-all duration-1000 transform ${n.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:b.jsxs("div",{className:"glass-panel p-6 sm:p-12 rounded-[2.5rem] sm:rounded-[3rem] bg-[#030303] border border-white/5 relative overflow-hidden",children:[b.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-violet-600/5 rounded-full blur-3xl"}),b.jsxs("div",{className:"flex flex-col items-center text-center space-y-6 sm:space-y-8 relative z-10",children:[b.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 rounded-full bg-white/5 border border-white/10 text-violet-400 text-[9px] sm:text-[10px] font-black tracking-widest uppercase",children:[b.jsx(FN,{size:12}),"  "]}),b.jsxs("div",{className:"space-y-3",children:[b.jsx("h3",{className:"text-xl sm:text-4xl font-black text-white tracking-tight leading-tight px-4",children:"   "}),b.jsx("p",{className:"text-slate-500 text-xs sm:text-base max-w-2xl mx-auto leading-relaxed font-medium px-2",children:"              :"})]}),b.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 w-full",children:[{icon:b.jsx(GN,{}),label:"  ",color:"text-blue-400",bg:"bg-blue-500/5"},{icon:b.jsx(VN,{}),label:" ",color:"text-violet-400",bg:"bg-violet-500/5"},{icon:b.jsx(__,{}),label:" ",color:"text-fuchsia-400",bg:"bg-fuchsia-500/5"}].map((l,c)=>b.jsxs("div",{className:"bg-white/5 p-5 rounded-[2rem] border border-white/5 flex flex-col items-center gap-3 sm:gap-4 group hover:bg-white/10 hover:-translate-y-1 transition-all",children:[b.jsx("div",{className:`${l.color} ${l.bg} p-3 sm:p-4 rounded-xl sm:rounded-2xl group-hover:scale-110 transition-transform`,children:Wp.cloneElement(l.icon,{size:24,className:"sm:w-7 sm:h-7"})}),b.jsx("span",{className:"text-[10px] sm:text-sm font-black text-slate-200 tracking-tight",children:l.label})]},c))}),b.jsx("div",{className:"pt-6 sm:pt-10 w-full px-2",children:b.jsx("div",{className:"p-0.5 sm:p-1 rounded-[2rem] sm:rounded-[2.5rem] bg-gradient-to-r from-violet-600 via-fuchsia-600 to-violet-600",children:b.jsx("div",{className:"bg-[#0a0a0a] rounded-[1.8rem] sm:rounded-[2.3rem] p-4 sm:p-6 flex flex-wrap justify-center gap-2 sm:gap-4",children:[" "," "," "," "].map((l,c)=>b.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-white/5 rounded-full text-[9px] sm:text-[10px] font-black text-slate-300 border border-white/5 uppercase tracking-wider",children:[b.jsx(gc,{size:12,className:"text-yellow-500"})," ",l]},c))})})})]})]})}),b.jsxs("div",{className:"mt-16 sm:mt-24 text-center space-y-6 pb-20",children:[b.jsxs("div",{className:"flex items-center justify-center gap-4 sm:gap-6 opacity-30",children:[b.jsx("div",{className:"h-px w-8 sm:w-12 bg-white"}),b.jsx("p",{className:"text-[8px] sm:text-[10px] font-black uppercase tracking-[0.3em] text-white",children:"Etqan Group  2026"}),b.jsx("div",{className:"h-px w-8 sm:w-12 bg-white"})]}),b.jsx("p",{className:"text-[8px] sm:text-[9px] text-slate-600 font-bold italic tracking-wide",children:'"      ."'})]})]})]})},Xb=["Felix","Joshua","Nolan","Liam","Caleb","Mason","Jack","Ethan","Aiden","Leo","Aneka","Selena","Molly","Sophia","Zoe","Lily","Maya","Chloe","Ruby","Eva"],Jb=s=>`https://api.dicebear.com/9.x/notionists/svg?seed=${s}&backgroundColor=b6e3f4,c0aede,d1d4f9`,Wb=({src:s,alt:e,className:t})=>{const[n,i]=se.useState(!1);return b.jsxs("div",{className:`relative overflow-hidden bg-white/5 ${t}`,children:[!n&&b.jsx("div",{className:"absolute inset-0 bg-white/5 z-10 flex items-center justify-center"}),b.jsx("img",{src:s,alt:e,loading:"lazy",onLoad:()=>i(!0),className:`w-full h-full object-cover transition-opacity duration-300 ${n?"opacity-100":"opacity-0"}`})]})},d5=({user:s,quizHistory:e,onLogout:t,onSaveProfile:n,onNavigate:i})=>{const[a,l]=se.useState(!1),[c,d]=se.useState(!1),h=(s==null?void 0:s.user_metadata)||{};se.useEffect(()=>{a&&window.scrollTo({top:0,behavior:"auto"})},[a]);const p=se.useMemo(()=>{const J=e.reduce((we,Ne)=>we+Ne.score*10,0),ie=e.reduce((we,Ne)=>we+Ne.score,0),pe=e.reduce((we,Ne)=>we+Ne.total_questions,0),ye=pe>0?Math.round(ie/pe*100):0;let be=1,Se=200,j=0;J>=2e3?(be=5,Se=5e3,j=2e3):J>=1e3?(be=4,Se=2e3,j=1e3):J>=500?(be=3,Se=1e3,j=500):J>=200&&(be=2,Se=500,j=200);const G=Math.min(100,Math.max(0,(J-j)/(Se-j)*100)),ae=[{id:"first",icon:b.jsx(da,{}),title:" ",earned:e.length>=1,desc:"  "},{id:"master",icon:b.jsx(v0,{}),title:"",earned:e.length>=5,desc:" 5 "},{id:"exp",icon:b.jsx(gc,{}),title:" ",earned:J>=500,desc:" 500  "},{id:"perfect",icon:b.jsx(BN,{}),title:" ",earned:e.some(we=>we.score===we.total_questions),desc:"   100%"}];return{totalExp:J,avgScore:ye,level:be,nextLevelXp:Se,progress:G,achievements:ae}},[e]),[y,_]=se.useState(h.full_name||""),[S,A]=se.useState(h.gender||"male"),[E,N]=se.useState(h.age||"18-22"),[R,D]=se.useState(h.avatar||Xb[0]),[P,L]=se.useState(h.university||""),[z,H]=se.useState(h.major||""),[F,X]=se.useState(h.academic_year||"1"),Y=async()=>{d(!0),await n({full_name:y,gender:S,avatar:R,university:P,major:z,academic_year:F,age:E}),d(!1),l(!1)};return b.jsx("div",{className:"min-h-screen pt-24 pb-20 px-4 md:px-6 relative z-10 bg-[#000] animate-lux-up",children:b.jsx("div",{className:"max-w-7xl mx-auto",children:a?b.jsx("div",{className:"glass-panel p-8 rounded-3xl border border-white/10 bg-[#080808] animate-lux-scale",children:b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10",children:[b.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[b.jsxs("div",{children:[b.jsxs("h3",{className:"text-lg font-bold text-slate-200 mb-4 flex items-center gap-2 border-b border-white/5 pb-2",children:[b.jsx(WU,{className:"text-amber-400",size:20}),"  "]}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:" "}),b.jsx("input",{type:"text",value:y,onChange:J=>_(J.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl py-3 px-4 text-white focus:border-amber-500 transition-all outline-none"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:""}),b.jsx("select",{value:E,onChange:J=>N(J.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl py-3 px-4 text-white outline-none",children:["  18","18-22","23-25","  25"].map(J=>b.jsx("option",{className:"bg-black text-white",children:J},J))})]})]})]}),b.jsxs("div",{className:"pt-6 flex gap-4 border-t border-white/5",children:[b.jsxs(yt,{onClick:Y,disabled:c,className:"!bg-amber-500 !text-black px-8",children:[c?b.jsx(Di,{size:18,className:"animate-spin"}):b.jsx(qN,{size:18}),c?" ...":" "]}),b.jsx(yt,{onClick:()=>l(!1),variant:"secondary",children:""})]})]}),b.jsxs("div",{className:"lg:col-span-4 bg-white/5 rounded-2xl p-6 border border-white/5",children:[b.jsxs("h3",{className:"text-sm font-bold text-slate-400 mb-4 flex items-center gap-2",children:[b.jsx(xU,{size:16}),"  "]}),b.jsx("div",{className:"flex flex-col items-center mb-6",children:b.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-amber-500 bg-white/5 overflow-hidden",children:b.jsx(Wb,{src:Jb(R),alt:"Avatar",className:"w-full h-full"})})}),b.jsx("div",{className:"grid grid-cols-5 gap-2 h-auto max-h-[150px] overflow-y-auto pr-2 custom-scrollbar",children:Xb.map(J=>b.jsx("div",{onClick:()=>D(J),className:`aspect-square rounded-xl cursor-pointer border-2 overflow-hidden ${R===J?"border-amber-500 scale-105":"border-transparent"}`,children:b.jsx(Wb,{src:Jb(J),alt:J,className:"w-full h-full"})},J))})]})]})}):b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mt-6",children:[b.jsx("div",{className:"lg:col-span-1 space-y-6",children:b.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#080808] border border-white/10 flex flex-col items-center text-center overflow-hidden",children:[b.jsx("div",{className:"w-40 h-40 rounded-full border-[6px] border-black shadow-2xl mb-4 bg-white/5 overflow-hidden",children:b.jsx(Wb,{src:Jb(h.avatar||Xb[0]),alt:"Profile",className:"w-full h-full"})}),b.jsx("h2",{className:"text-3xl font-black text-white mb-1",children:h.full_name}),b.jsx("p",{className:"text-sm text-slate-500 mb-6",children:s==null?void 0:s.email}),b.jsxs("div",{className:"w-full space-y-3",children:[b.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/5 border border-white/5",children:[b.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500/10 flex items-center justify-center text-blue-400",children:b.jsx(DN,{size:20})}),b.jsxs("div",{className:"text-right",children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),b.jsx("p",{className:"text-sm font-bold text-white truncate",children:h.university||" "})]})]}),b.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/5 border border-white/5",children:[b.jsx("div",{className:"w-10 h-10 rounded-xl bg-fuchsia-500/10 flex items-center justify-center text-fuchsia-400",children:b.jsx(HN,{size:20})}),b.jsxs("div",{className:"text-right",children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),b.jsx("p",{className:"text-sm font-bold text-white truncate",children:h.major||" "})]})]})]}),b.jsx(yt,{onClick:()=>l(!0),variant:"secondary",fullWidth:!0,className:"mt-6 !bg-white/5 text-sm",children:" "}),b.jsx(yt,{onClick:t,variant:"danger",fullWidth:!0,className:"mt-3 text-sm",children:""})]})}),b.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[b.jsxs("div",{className:"glass-panel p-5 rounded-[2rem] bg-[#080808] border border-white/10 flex items-center gap-4",children:[b.jsx("div",{className:"w-12 h-12 rounded-2xl bg-amber-400/10 flex items-center justify-center text-amber-400",children:b.jsx(iw,{size:24})}),b.jsxs("div",{children:[b.jsx("h4",{className:"text-2xl font-black text-white",children:e.length}),b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:" "})]})]}),b.jsxs("div",{className:"glass-panel p-5 rounded-[2rem] bg-[#080808] border border-white/10 flex items-center gap-4",children:[b.jsx("div",{className:"w-12 h-12 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-400",children:b.jsx(v0,{size:24})}),b.jsxs("div",{children:[b.jsxs("h4",{className:"text-2xl font-black text-white",children:[p.avgScore,"%"]}),b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:" "})]})]}),b.jsxs("div",{className:"glass-panel p-5 rounded-[2rem] bg-[#080808] border border-white/10 flex items-center gap-4",children:[b.jsx("div",{className:"w-12 h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-blue-400",children:b.jsx(ev,{size:24})}),b.jsxs("div",{children:[b.jsx("h4",{className:"text-2xl font-black text-white",children:p.totalExp}),b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:" "})]})]})]}),b.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#080808] border border-white/10",children:[b.jsx("div",{className:"flex items-center justify-between mb-6",children:b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsx("div",{className:"w-14 h-14 rounded-2xl bg-amber-500/10 border border-amber-500/20 flex items-center justify-center text-amber-400 text-3xl font-black",children:p.level}),b.jsxs("div",{children:[b.jsx("h3",{className:"text-xl font-black text-white",children:""}),b.jsxs("p",{className:"text-xs text-slate-500",children:[" ",p.nextLevelXp-p.totalExp,"   "]})]})]})}),b.jsx("div",{className:"h-3 bg-white/5 rounded-full overflow-hidden border border-white/5",children:b.jsx("div",{className:"h-full bg-amber-500 transition-all duration-1000",style:{width:`${p.progress}%`}})})]}),b.jsxs("div",{className:"glass-panel bg-[#080808] rounded-[2.5rem] p-8 border border-white/10",children:[b.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-3",children:[b.jsx(YO,{className:"text-amber-400",size:24}),"  "]}),b.jsx("div",{className:"space-y-3",children:e.length===0?b.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-white/5 rounded-3xl",children:[b.jsx(zN,{size:32,className:"mx-auto mb-4 text-slate-600"}),b.jsx("h4",{className:"text-lg font-bold text-white mb-2",children:"  "}),b.jsx(yt,{onClick:()=>i(he.HOME),className:"!bg-amber-500 !text-black !text-xs mt-4",children:" "})]}):e.slice(0,10).map((J,ie)=>{const pe=Math.round(J.score/J.total_questions*100);return b.jsxs("div",{className:"p-4 rounded-2xl bg-white/[0.02] border border-white/5 flex items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsxs("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center font-black border ${pe>=50?"bg-emerald-500/10 border-emerald-500/20 text-emerald-400":"bg-red-500/10 border-red-500/20 text-red-400"}`,children:[pe,"%"]}),b.jsxs("div",{children:[b.jsx("h4",{className:"font-bold text-white text-sm",children:J.quiz_title}),b.jsxs("p",{className:"text-[10px] text-slate-500",children:[J.score," / ",J.total_questions,"  "]})]})]}),b.jsx("span",{className:"text-[10px] text-slate-500",children:new Date(J.created_at).toLocaleDateString("ar-EG")})]},ie)})})]})]})]})})})},h5=({onFileSelect:s,disabled:e})=>{const t=se.useRef(null),n=i=>{i.target.files&&i.target.files.length>0&&(s(i.target.files[0]),i.target.value="")};return b.jsx("div",{className:"flex justify-center w-full",children:b.jsxs("div",{className:`uiverse-upload-card ${e?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{var i;return!e&&((i=t.current)==null?void 0:i.click())},children:[b.jsx("input",{type:"file",accept:"application/pdf",className:"hidden",ref:t,onChange:n,disabled:e}),b.jsx("div",{className:"w-16 h-16 bg-gradient-to-tr from-violet-500/20 to-fuchsia-500/20 text-violet-300 rounded-2xl flex items-center justify-center mb-4 border border-white/5 shadow-inner transition-transform duration-500",children:b.jsx(UN,{size:32,className:"drop-shadow-[0_0_10px_rgba(167,139,250,0.5)]"})}),b.jsx("h3",{className:"text-xl font-black text-white mb-2 tracking-tight transition-colors",children:"  PDF"}),b.jsx("p",{className:"text-slate-400 text-[10px] px-6 mb-6 leading-relaxed font-medium text-center",children:"         ."}),b.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-violet-300 bg-violet-500/10 border border-violet-500/20 px-3 py-1.5 rounded-full shadow-[0_0_15px_rgba(139,92,246,0.1)]",children:[b.jsx(da,{size:12}),b.jsx("span",{children:"  "})]})]})})};var mf={};mf.d=(s,e)=>{for(var t in e)mf.o(e,t)&&!mf.o(s,t)&&Object.defineProperty(s,t,{enumerable:!0,get:e[t]})};mf.o=(s,e)=>Object.prototype.hasOwnProperty.call(s,e);var Le=globalThis.pdfjsLib={};mf.d(Le,{AbortException:()=>To,AnnotationEditorLayer:()=>Mx,AnnotationEditorParamsType:()=>Qe,AnnotationEditorType:()=>He,AnnotationEditorUIManager:()=>fc,AnnotationLayer:()=>o3,AnnotationMode:()=>Ya,ColorPicker:()=>S0,DOMSVGFactory:()=>gw,DrawLayer:()=>Px,FeatureTest:()=>Xn,GlobalWorkerOptions:()=>la,ImageKind:()=>Pg,InvalidPDFException:()=>A_,MissingPDFException:()=>Sf,OPS:()=>bi,OutputScale:()=>T_,PDFDataRangeTransport:()=>XR,PDFDateString:()=>hw,PDFWorker:()=>Ru,PasswordResponses:()=>g5,PermissionFlag:()=>m5,PixelsPerInch:()=>Co,RenderingCancelledException:()=>uw,TextLayer:()=>Af,TouchManager:()=>x0,UnexpectedResponseException:()=>y0,Util:()=>Ce,VerbosityLevel:()=>tv,XfaLayer:()=>WR,build:()=>H4,createValidAbsoluteUrl:()=>_5,fetchData:()=>rv,getDocument:()=>I4,getFilenameFromUrl:()=>R5,getPdfFilenameFromUrl:()=>k5,getXfaPageViewport:()=>M5,isDataScheme:()=>av,isPdfFile:()=>dw,noContextMenu:()=>Ui,normalizeUnicode:()=>T5,setLayerDimensions:()=>hc,shadow:()=>$e,stopEvent:()=>Hs,version:()=>z4});const Un=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),KN=[1,0,0,1,0,0],S_=[.001,0,0,.001,0,0],f5=1e7,Qb=1.35,Us={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ya={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},p5="pdfjs_internal_editor_",He={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Qe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},m5={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Nn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Pg={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Qt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Hh={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},tv={ERRORS:0,WARNINGS:1,INFOS:5},bi={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},g5={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let nv=tv.WARNINGS;function v5(s){Number.isInteger(s)&&(nv=s)}function y5(){return nv}function sv(s){nv>=tv.INFOS&&console.log(`Info: ${s}`)}function Be(s){nv>=tv.WARNINGS&&console.log(`Warning: ${s}`)}function bt(s){throw new Error(s)}function Xt(s,e){s||bt(e)}function b5(s){switch(s==null?void 0:s.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function _5(s,e=null,t=null){if(!s)return null;try{if(t&&typeof s=="string"){if(t.addDefaultProtocol&&s.startsWith("www.")){const i=s.match(/\./g);(i==null?void 0:i.length)>=2&&(s=`http://${s}`)}if(t.tryConvertEncoding)try{s=E5(s)}catch{}}const n=e?new URL(s,e):new URL(s);if(b5(n))return n}catch{}return null}function $e(s,e,t,n=!1){return Object.defineProperty(s,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const Ro=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class fT extends Ro{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Zb extends Ro{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class A_ extends Ro{constructor(e){super(e,"InvalidPDFException")}}class Sf extends Ro{constructor(e){super(e,"MissingPDFException")}}class y0 extends Ro{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class x5 extends Ro{constructor(e){super(e,"FormatError")}}class To extends Ro{constructor(e){super(e,"AbortException")}}function XN(s){(typeof s!="object"||(s==null?void 0:s.length)===void 0)&&bt("Invalid argument for bytesToString");const e=s.length,t=8192;if(e<t)return String.fromCharCode.apply(null,s);const n=[];for(let i=0;i<e;i+=t){const a=Math.min(i+t,e),l=s.subarray(i,a);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function iv(s){typeof s!="string"&&bt("Invalid argument for stringToBytes");const e=s.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=s.charCodeAt(n)&255;return t}function w5(s){return String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255)}function lw(s){const e=Object.create(null);for(const[t,n]of s)e[t]=n;return e}function S5(){const s=new Uint8Array(4);return s[0]=1,new Uint32Array(s.buffer,0,1)[0]===1}function A5(){try{return new Function(""),!0}catch{return!1}}class Xn{static get isLittleEndian(){return $e(this,"isLittleEndian",S5())}static get isEvalSupported(){return $e(this,"isEvalSupported",A5())}static get isOffscreenCanvasSupported(){return $e(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return $e(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?$e(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):$e(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return $e(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const e_=Array.from(Array(256).keys(),s=>s.toString(16).padStart(2,"0"));var ca,Lg,E_;class Ce{static makeHexColor(e,t,n){return`#${e_[e]}${e_[t]}${e_[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const n=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[n,i]}static applyInverseTransform(e,t){const n=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,a=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n;return[i,a]}static getAxialAlignedBoundingBox(e,t){const n=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),a=this.applyTransform([e[0],e[3]],t),l=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],i[0],a[0],l[0]),Math.min(n[1],i[1],a[1],l[1]),Math.max(n[0],i[0],a[0],l[0]),Math.max(n[1],i[1],a[1],l[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],a=e[2]*t[0]+e[3]*t[2],l=e[2]*t[1]+e[3]*t[3],c=(n+l)/2,d=Math.sqrt((n+l)**2-4*(n*l-a*i))/2,h=c+d||1,p=c-d||1;return[Math.sqrt(h),Math.sqrt(p)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>l?null:[n,a,i,l]}static bezierBoundingBox(e,t,n,i,a,l,c,d,h){return h?(h[0]=Math.min(h[0],e,c),h[1]=Math.min(h[1],t,d),h[2]=Math.max(h[2],e,c),h[3]=Math.max(h[3],t,d)):h=[Math.min(e,c),Math.min(t,d),Math.max(e,c),Math.max(t,d)],M(this,ca,E_).call(this,e,n,a,c,t,i,l,d,3*(-e+3*(n-a)+c),6*(e-2*n+a),3*(n-e),h),M(this,ca,E_).call(this,e,n,a,c,t,i,l,d,3*(-t+3*(i-l)+d),6*(t-2*i+l),3*(i-t),h),h}}ca=new WeakSet,Lg=function(e,t,n,i,a,l,c,d,h,p){if(h<=0||h>=1)return;const y=1-h,_=h*h,S=_*h,A=y*(y*(y*e+3*h*t)+3*_*n)+S*i,E=y*(y*(y*a+3*h*l)+3*_*c)+S*d;p[0]=Math.min(p[0],A),p[1]=Math.min(p[1],E),p[2]=Math.max(p[2],A),p[3]=Math.max(p[3],E)},E_=function(e,t,n,i,a,l,c,d,h,p,y,_){if(Math.abs(h)<1e-12){Math.abs(p)>=1e-12&&M(this,ca,Lg).call(this,e,t,n,i,a,l,c,d,-y/p,_);return}const S=p**2-4*y*h;if(S<0)return;const A=Math.sqrt(S),E=2*h;M(this,ca,Lg).call(this,e,t,n,i,a,l,c,d,(-p+A)/E,_),M(this,ca,Lg).call(this,e,t,n,i,a,l,c,d,(-p-A)/E,_)},k(Ce,ca);function E5(s){return decodeURIComponent(escape(s))}let t_=null,pT=null;function T5(s){return t_||(t_=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,pT=new Map([["","t"]])),s.replaceAll(t_,(e,t,n)=>t?t.normalize("NFKC"):pT.get(n))}function C5(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const s=new Uint8Array(32);return crypto.getRandomValues(s),XN(s)}const cw="pdfjs_internal_id_";function N5(s){return Uint8Array.prototype.toBase64?s.toBase64():btoa(XN(s))}typeof Promise.try!="function"&&(Promise.try=function(s,...e){return new Promise(t=>{t(s(...e))})});const Mr="http://www.w3.org/2000/svg",rl=class rl{};Me(rl,"CSS",96),Me(rl,"PDF",72),Me(rl,"PDF_TO_CSS_UNITS",rl.CSS/rl.PDF);let Co=rl;async function rv(s,e="text"){if(Xh(s,document.baseURI)){const t=await fetch(s);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const i=new XMLHttpRequest;i.open("GET",s,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}class em{constructor({viewBox:e,userUnit:t,scale:n,rotation:i,offsetX:a=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=i,this.offsetX=a,this.offsetY=l,n*=t;const d=(e[2]+e[0])/2,h=(e[3]+e[1])/2;let p,y,_,S;switch(i%=360,i<0&&(i+=360),i){case 180:p=-1,y=0,_=0,S=1;break;case 90:p=0,y=1,_=1,S=0;break;case 270:p=0,y=-1,_=-1,S=0;break;case 0:p=1,y=0,_=0,S=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(_=-_,S=-S);let A,E,N,R;p===0?(A=Math.abs(h-e[1])*n+a,E=Math.abs(d-e[0])*n+l,N=(e[3]-e[1])*n,R=(e[2]-e[0])*n):(A=Math.abs(d-e[0])*n+a,E=Math.abs(h-e[1])*n+l,N=(e[2]-e[0])*n,R=(e[3]-e[1])*n),this.transform=[p*n,y*n,_*n,S*n,A-p*n*d-_*n*h,E-y*n*d-S*n*h],this.width=N,this.height=R}get rawDims(){const{userUnit:e,viewBox:t}=this,n=t.map(i=>i*e);return $e(this,"rawDims",{pageWidth:n[2]-n[0],pageHeight:n[3]-n[1],pageX:n[0],pageY:n[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:a=!1}={}){return new em({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:a})}convertToViewportPoint(e,t){return Ce.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=Ce.applyTransform([e[0],e[1]],this.transform),n=Ce.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return Ce.applyInverseTransform([e,t],this.transform)}}class uw extends Ro{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function av(s){const e=s.length;let t=0;for(;t<e&&s[t].trim()==="";)t++;return s.substring(t,t+5).toLowerCase()==="data:"}function dw(s){return typeof s=="string"&&/\.pdf$/i.test(s)}function R5(s){return[s]=s.split(/[#?]/,1),s.substring(s.lastIndexOf("/")+1)}function k5(s,e="document.pdf"){if(typeof s!="string")return e;if(av(s))return Be('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(s);let a=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(a&&(a=a[0],a.includes("%")))try{a=n.exec(decodeURIComponent(a))[0]}catch{}return a||e}class mT{constructor(){Me(this,"started",Object.create(null));Me(this,"times",[])}time(e){e in this.started&&Be(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Be(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:i,end:a}of this.times)e.push(`${n.padEnd(t)} ${a-i}ms
`);return e.join("")}}function Xh(s,e){try{const{protocol:t}=e?new URL(s,e):new URL(s);return t==="http:"||t==="https:"}catch{return!1}}function Ui(s){s.preventDefault()}function Hs(s){s.preventDefault(),s.stopPropagation()}var Tf;class hw{static toDateObject(e){if(!e||typeof e!="string")return null;m(this,Tf)||C(this,Tf,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=m(this,Tf).exec(e);if(!t)return null;const n=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let d=parseInt(t[6],10);d=d>=0&&d<=59?d:0;const h=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let y=parseInt(t[9],10)||0;return y=y>=0&&y<=59?y:0,h==="-"?(l+=p,c+=y):h==="+"&&(l-=p,c-=y),new Date(Date.UTC(n,i,a,l,c,d))}}Tf=new WeakMap,k(hw,Tf);function M5(s,{scale:e=1,rotation:t=0}){const{width:n,height:i}=s.attributes.style,a=[0,0,parseInt(n),parseInt(i)];return new em({viewBox:a,userUnit:1,scale:e,rotation:t})}function fw(s){if(s.startsWith("#")){const e=parseInt(s.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return s.startsWith("rgb(")?s.slice(4,-1).split(",").map(e=>parseInt(e)):s.startsWith("rgba(")?s.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Be(`Not a valid color format: "${s}"`),[0,0,0])}function I5(s){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of s.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;s.set(t,fw(n))}e.remove()}function Ct(s){const{a:e,b:t,c:n,d:i,e:a,f:l}=s.getTransform();return[e,t,n,i,a,l]}function Vi(s){const{a:e,b:t,c:n,d:i,e:a,f:l}=s.getTransform().invertSelf();return[e,t,n,i,a,l]}function hc(s,e,t=!1,n=!0){if(e instanceof em){const{pageWidth:i,pageHeight:a}=e.rawDims,{style:l}=s,c=Xn.isCSSRoundSupported,d=`var(--scale-factor) * ${i}px`,h=`var(--scale-factor) * ${a}px`,p=c?`round(down, ${d}, var(--scale-round-x, 1px))`:`calc(${d})`,y=c?`round(down, ${h}, var(--scale-round-y, 1px))`:`calc(${h})`;!t||e.rotation%180===0?(l.width=p,l.height=y):(l.width=y,l.height=p)}n&&s.setAttribute("data-main-rotation",e.rotation)}class T_{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Ka,ll,_i,cl,Cf,Nf,I0,JN,Jn,WN,QN,Og,ZN,N_;const Lr=class Lr{constructor(e){k(this,Jn);k(this,Ka,null);k(this,ll,null);k(this,_i);k(this,cl,null);k(this,Cf,null);C(this,_i,e),m(Lr,Nf)||C(Lr,Nf,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=C(this,Ka,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=m(this,_i)._uiManager._signal;e.addEventListener("contextmenu",Ui,{signal:t}),e.addEventListener("pointerdown",M(Lr,I0,JN),{signal:t});const n=C(this,cl,document.createElement("div"));n.className="buttons",e.append(n);const i=m(this,_i).toolbarPosition;if(i){const{style:a}=e,l=m(this,_i)._uiManager.direction==="ltr"?1-i[0]:i[0];a.insetInlineEnd=`${100*l}%`,a.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return M(this,Jn,ZN).call(this),e}get div(){return m(this,Ka)}hide(){var e;m(this,Ka).classList.add("hidden"),(e=m(this,ll))==null||e.hideDropdown()}show(){var e;m(this,Ka).classList.remove("hidden"),(e=m(this,Cf))==null||e.shown()}async addAltText(e){const t=await e.render();M(this,Jn,Og).call(this,t),m(this,cl).prepend(t,m(this,Jn,N_)),C(this,Cf,e)}addColorPicker(e){C(this,ll,e);const t=e.renderButton();M(this,Jn,Og).call(this,t),m(this,cl).prepend(t,m(this,Jn,N_))}remove(){var e;m(this,Ka).remove(),(e=m(this,ll))==null||e.destroy(),C(this,ll,null)}};Ka=new WeakMap,ll=new WeakMap,_i=new WeakMap,cl=new WeakMap,Cf=new WeakMap,Nf=new WeakMap,I0=new WeakSet,JN=function(e){e.stopPropagation()},Jn=new WeakSet,WN=function(e){m(this,_i)._focusEventsAllowed=!1,Hs(e)},QN=function(e){m(this,_i)._focusEventsAllowed=!0,Hs(e)},Og=function(e){const t=m(this,_i)._uiManager._signal;e.addEventListener("focusin",M(this,Jn,WN).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",M(this,Jn,QN).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Ui,{signal:t})},ZN=function(){const{editorType:e,_uiManager:t}=m(this,_i),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",m(Lr,Nf)[e]),M(this,Jn,Og).call(this,n),n.addEventListener("click",i=>{t.delete()},{signal:t._signal}),m(this,cl).append(n)},N_=function(){const e=document.createElement("div");return e.className="divider",e},k(Lr,I0),k(Lr,Nf,null);let C_=Lr;var Rf,ul,dl,No,eR,tR,nR;class D5{constructor(e){k(this,No);k(this,Rf,null);k(this,ul,null);k(this,dl);C(this,dl,e)}show(e,t,n){const[i,a]=M(this,No,tR).call(this,t,n),{style:l}=m(this,ul)||C(this,ul,M(this,No,eR).call(this));e.append(m(this,ul)),l.insetInlineEnd=`${100*i}%`,l.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){m(this,ul).remove()}}Rf=new WeakMap,ul=new WeakMap,dl=new WeakMap,No=new WeakSet,eR=function(){const e=C(this,ul,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Ui,{signal:m(this,dl)._signal});const t=C(this,Rf,document.createElement("div"));return t.className="buttons",e.append(t),M(this,No,nR).call(this),e},tR=function(e,t){let n=0,i=0;for(const a of e){const l=a.y+a.height;if(l<n)continue;const c=a.x+(t?a.width:0);if(l>n){i=c,n=l;continue}t?c>i&&(i=c):c<i&&(i=c)}return[t?1-i:i,n]},nR=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=m(this,dl)._signal;e.addEventListener("contextmenu",Ui,{signal:n}),e.addEventListener("click",()=>{m(this,dl).highlightSelection("floating_button")},{signal:n}),m(this,Rf).append(e)};function b0(s,e,t){for(const n of t)e.addEventListener(n,s[n].bind(s))}var D0;class P5{constructor(){k(this,D0,0)}get id(){return`${p5}${Bn(this,D0)._++}`}}D0=new WeakMap;var Iu,kf,Mn,Du,Ug;const Nw=class Nw{constructor(){k(this,Du);k(this,Iu,C5());k(this,kf,0);k(this,Mn,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const a=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return $e(this,"_isSVGFittingCanvas",a)}async getFromFile(e){const{lastModified:t,name:n,size:i,type:a}=e;return M(this,Du,Ug).call(this,`${t}_${n}_${i}_${a}`,e)}async getFromUrl(e){return M(this,Du,Ug).call(this,e,e)}async getFromBlob(e,t){const n=await t;return M(this,Du,Ug).call(this,e,n)}async getFromId(e){m(this,Mn)||C(this,Mn,new Map);const t=m(this,Mn).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){m(this,Mn)||C(this,Mn,new Map);let n=m(this,Mn).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${m(this,Iu)}_${Bn(this,kf)._++}`,refCounter:1,isSvg:!1},m(this,Mn).set(e,n),m(this,Mn).set(n.id,n),n}getSvgUrl(e){const t=m(this,Mn).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;m(this,Mn)||C(this,Mn,new Map);const t=m(this,Mn).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const a=new OffscreenCanvas(n.width,n.height);a.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=a.convertToBlob()}(i=n.close)==null||i.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${m(this,Iu)}_`)}};Iu=new WeakMap,kf=new WeakMap,Mn=new WeakMap,Du=new WeakSet,Ug=async function(e,t){m(this,Mn)||C(this,Mn,new Map);let n=m(this,Mn).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${m(this,Iu)}_${Bn(this,kf)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(n.url=t,i=await rv(t,"blob")):t instanceof File?i=n.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const a=Nw._isSVGFittingCanvas,l=new FileReader,c=new Image,d=new Promise((h,p)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,h()},l.onload=async()=>{const y=n.svgUrl=l.result;c.src=await a?`${y}#svgView(preserveAspectRatio(none))`:y},c.onerror=l.onerror=p});l.readAsDataURL(i),await d}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){Be(i),n=null}return m(this,Mn).set(e,n),n&&m(this,Mn).set(n.id,n),n};let R_=Nw;var jt,Xa,Mf,Rt;class L5{constructor(e=128){k(this,jt,[]);k(this,Xa,!1);k(this,Mf);k(this,Rt,-1);C(this,Mf,e)}add({cmd:e,undo:t,post:n,mustExec:i,type:a=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(i&&e(),m(this,Xa))return;const d={cmd:e,undo:t,post:n,type:a};if(m(this,Rt)===-1){m(this,jt).length>0&&(m(this,jt).length=0),C(this,Rt,0),m(this,jt).push(d);return}if(l&&m(this,jt)[m(this,Rt)].type===a){c&&(d.undo=m(this,jt)[m(this,Rt)].undo),m(this,jt)[m(this,Rt)]=d;return}const h=m(this,Rt)+1;h===m(this,Mf)?m(this,jt).splice(0,1):(C(this,Rt,h),h<m(this,jt).length&&m(this,jt).splice(h)),m(this,jt).push(d)}undo(){if(m(this,Rt)===-1)return;C(this,Xa,!0);const{undo:e,post:t}=m(this,jt)[m(this,Rt)];e(),t==null||t(),C(this,Xa,!1),C(this,Rt,m(this,Rt)-1)}redo(){if(m(this,Rt)<m(this,jt).length-1){C(this,Rt,m(this,Rt)+1),C(this,Xa,!0);const{cmd:e,post:t}=m(this,jt)[m(this,Rt)];e(),t==null||t(),C(this,Xa,!1)}}hasSomethingToUndo(){return m(this,Rt)!==-1}hasSomethingToRedo(){return m(this,Rt)<m(this,jt).length-1}cleanType(e){if(m(this,Rt)!==-1){for(let t=m(this,Rt);t>=0;t--)if(m(this,jt)[t].type!==e){m(this,jt).splice(t+1,m(this,Rt)-t),C(this,Rt,t);return}m(this,jt).length=0,C(this,Rt,-1)}}destroy(){C(this,jt,null)}}jt=new WeakMap,Xa=new WeakMap,Mf=new WeakMap,Rt=new WeakMap;var P0,sR;class tm{constructor(e){k(this,P0);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Xn.platform;for(const[n,i,a={}]of e)for(const l of n){const c=l.startsWith("mac+");t&&c?(this.callbacks.set(l.slice(4),{callback:i,options:a}),this.allKeys.add(l.split("+").at(-1))):!t&&!c&&(this.callbacks.set(l,{callback:i,options:a}),this.allKeys.add(l.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(M(this,P0,sR).call(this,t));if(!n)return;const{callback:i,options:{bubbles:a=!1,args:l=[],checker:c=null}}=n;c&&!c(e,t)||(i.bind(e,...l,t)(),a||Hs(t))}}P0=new WeakSet,sR=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const L0=class L0{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return I5(e),$e(this,"_colors",e)}convert(e){const t=fw(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,i]of this._colors)if(i.every((a,l)=>a===t[l]))return L0._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?Ce.makeHexColor(...t):e}};Me(L0,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let k_=L0;var Pu,Es,tn,xn,Lu,Ur,Ou,ti,Ja,hl,Uu,fl,Ki,xi,pl,If,Df,Fu,Pf,Xi,Wa,ju,Qa,Ji,O0,Za,Lf,eo,ml,Of,Uf,on,ut,Fr,gl,Ff,jf,to,Wi,jr,zf,ni,le,Fg,M_,iR,rR,jg,aR,oR,lR,I_,cR,D_,P_,uR,Gn,Ir,dR,hR,L_,fR,Jh,O_;const Au=class Au{constructor(e,t,n,i,a,l,c,d,h,p,y,_,S){k(this,le);k(this,Pu,new AbortController);k(this,Es,null);k(this,tn,new Map);k(this,xn,new Map);k(this,Lu,null);k(this,Ur,null);k(this,Ou,null);k(this,ti,new L5);k(this,Ja,null);k(this,hl,null);k(this,Uu,0);k(this,fl,new Set);k(this,Ki,null);k(this,xi,null);k(this,pl,new Set);Me(this,"_editorUndoBar",null);k(this,If,!1);k(this,Df,!1);k(this,Fu,!1);k(this,Pf,null);k(this,Xi,null);k(this,Wa,null);k(this,ju,null);k(this,Qa,!1);k(this,Ji,null);k(this,O0,new P5);k(this,Za,!1);k(this,Lf,!1);k(this,eo,null);k(this,ml,null);k(this,Of,null);k(this,Uf,null);k(this,on,He.NONE);k(this,ut,new Set);k(this,Fr,null);k(this,gl,null);k(this,Ff,null);k(this,jf,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});k(this,to,[0,0]);k(this,Wi,null);k(this,jr,null);k(this,zf,null);k(this,ni,null);const A=this._signal=m(this,Pu).signal;C(this,jr,e),C(this,zf,t),C(this,Lu,n),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:A}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:A}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:A}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:A}),i._on("setpreference",this.onSetPreference.bind(this),{signal:A}),i._on("switchannotationeditorparams",E=>this.updateParams(E.type,E.value),{signal:A}),M(this,le,aR).call(this),M(this,le,uR).call(this),M(this,le,I_).call(this),C(this,Ur,a.annotationStorage),C(this,Pf,a.filterFactory),C(this,gl,l),C(this,ju,c||null),C(this,If,d),C(this,Df,h),C(this,Fu,p),C(this,Uf,y||null),this.viewParameters={realScale:Co.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=_||null,this._supportsPinchToZoom=S!==!1}static get _keyboardManager(){const e=Au.prototype,t=l=>m(l,jr).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:d}=c;return d!=="text"&&d!=="number"}return!0},i=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return $e(this,"_keyboardManager",new tm([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&m(l,jr).contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&m(l,jr).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}]]))}destroy(){var e,t,n,i,a;(e=m(this,ni))==null||e.resolve(),C(this,ni,null),(t=m(this,Pu))==null||t.abort(),C(this,Pu,null),this._signal=null;for(const l of m(this,xn).values())l.destroy();m(this,xn).clear(),m(this,tn).clear(),m(this,pl).clear(),C(this,Es,null),m(this,ut).clear(),m(this,ti).destroy(),(n=m(this,Lu))==null||n.destroy(),(i=m(this,Ji))==null||i.hide(),C(this,Ji,null),m(this,Xi)&&(clearTimeout(m(this,Xi)),C(this,Xi,null)),m(this,Wi)&&(clearTimeout(m(this,Wi)),C(this,Wi,null)),(a=this._editorUndoBar)==null||a.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return m(this,Uf)}get useNewAltTextFlow(){return m(this,Df)}get useNewAltTextWhenAddingImage(){return m(this,Fu)}get hcmFilter(){return $e(this,"hcmFilter",m(this,gl)?m(this,Pf).addHCMFilter(m(this,gl).foreground,m(this,gl).background):"none")}get direction(){return $e(this,"direction",getComputedStyle(m(this,jr)).direction)}get highlightColors(){return $e(this,"highlightColors",m(this,ju)?new Map(m(this,ju).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return $e(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),C(this,hl,e)}setMainHighlightColorPicker(e){C(this,Of,e)}editAltText(e,t=!1){var n;(n=m(this,Lu))==null||n.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":C(this,Fu,t);break}}onPageChanging({pageNumber:e}){C(this,Uu,e-1)}focusMainContainer(){m(this,jr).focus()}findParent(e,t){for(const n of m(this,xn).values()){const{x:i,y:a,width:l,height:c}=n.div.getBoundingClientRect();if(e>=i&&e<=i+l&&t>=a&&t<=a+c)return n}return null}disableUserSelect(e=!1){m(this,zf).classList.toggle("noUserSelect",e)}addShouldRescale(e){m(this,pl).add(e)}removeShouldRescale(e){m(this,pl).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Co.PDF_TO_CSS_UNITS;for(const n of m(this,pl))n.onScaleChanging();(t=m(this,hl))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:a,focusOffset:l}=t,c=t.toString(),h=M(this,le,Fg).call(this,t).closest(".textLayer"),p=this.getSelectionBoxes(h);if(!p)return;t.empty();const y=M(this,le,M_).call(this,h),_=m(this,on)===He.NONE,S=()=>{y==null||y.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:p,anchorNode:n,anchorOffset:i,focusNode:a,focusOffset:l,text:c}),_&&this.showAllEditors("highlight",!0,!0)};if(_){this.switchToMode(He.HIGHLIGHT,S);return}S()}addToAnnotationStorage(e){!e.isEmpty()&&m(this,Ur)&&!m(this,Ur).has(e.id)&&m(this,Ur).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,m(this,Qa)&&(C(this,Qa,!1),M(this,le,jg).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of m(this,ut))if(t.div.contains(e)){C(this,ml,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!m(this,ml))return;const[e,t]=m(this,ml);C(this,ml,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){M(this,le,I_).call(this),M(this,le,D_).call(this)}removeEditListeners(){M(this,le,cR).call(this),M(this,le,P_).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of m(this,xi))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of m(this,xi))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=m(this,Es))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of m(this,ut)){const a=i.serialize(!0);a&&t.push(a)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const l of m(this,xi))if(l.isHandlingMimeForPasting(a.type)){l.paste(a,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(a){Be(`paste: "${a.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const a=[];for(const d of n){const h=await i.deserialize(d);if(!h)return;a.push(h)}const l=()=>{for(const d of a)M(this,le,L_).call(this,d);M(this,le,O_).call(this,a)},c=()=>{for(const d of a)d.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(a){Be(`paste: "${a.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),m(this,on)!==He.NONE&&!this.isEditorHandlingKeyboard&&Au._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,m(this,Qa)&&(C(this,Qa,!1),M(this,le,jg).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(M(this,le,oR).call(this),M(this,le,D_).call(this),M(this,le,Gn).call(this,{isEditing:m(this,on)!==He.NONE,isEmpty:M(this,le,Jh).call(this),hasSomethingToUndo:m(this,ti).hasSomethingToUndo(),hasSomethingToRedo:m(this,ti).hasSomethingToRedo(),hasSelectedEditor:!1})):(M(this,le,lR).call(this),M(this,le,P_).call(this),M(this,le,Gn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!m(this,xi)){C(this,xi,e);for(const t of m(this,xi))M(this,le,Ir).call(this,t.defaultPropertiesToUpdate)}}getId(){return m(this,O0).id}get currentLayer(){return m(this,xn).get(m(this,Uu))}getLayer(e){return m(this,xn).get(e)}get currentPageIndex(){return m(this,Uu)}addLayer(e){m(this,xn).set(e.pageIndex,e),m(this,Za)?e.enable():e.disable()}removeLayer(e){m(this,xn).delete(e.pageIndex)}async updateMode(e,t=null,n=!1){var i;if(m(this,on)!==e&&!(m(this,ni)&&(await m(this,ni).promise,!m(this,ni)))){if(C(this,ni,Promise.withResolvers()),C(this,on,e),e===He.NONE){this.setEditingState(!1),M(this,le,hR).call(this),(i=this._editorUndoBar)==null||i.hide(),m(this,ni).resolve();return}this.setEditingState(!0),await M(this,le,dR).call(this),this.unselectAll();for(const a of m(this,xn).values())a.updateMode(e);if(!t){n&&this.addNewEditorFromKeyboard(),m(this,ni).resolve();return}for(const a of m(this,tn).values())a.annotationElementId===t?(this.setSelected(a),a.enterInEditMode()):a.unselect();m(this,ni).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==m(this,on)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var n;if(m(this,xi)){switch(e){case Qe.CREATE:this.currentLayer.addNewEditor();return;case Qe.HIGHLIGHT_DEFAULT_COLOR:(n=m(this,Of))==null||n.updateColor(t);break;case Qe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(m(this,Ff)||C(this,Ff,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of m(this,ut))i.updateParams(e,t);for(const i of m(this,xi))i.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var a;for(const l of m(this,tn).values())l.editorType===e&&l.show(t);(((a=m(this,Ff))==null?void 0:a.get(Qe.HIGHLIGHT_SHOW_ALL))??!0)!==t&&M(this,le,Ir).call(this,[[Qe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(m(this,Lf)!==e){C(this,Lf,e);for(const t of m(this,xn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const n of m(this,tn).values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return m(this,tn).get(e)}addEditor(e){m(this,tn).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(m(this,Xi)&&clearTimeout(m(this,Xi)),C(this,Xi,setTimeout(()=>{this.focusMainContainer(),C(this,Xi,null)},0))),m(this,tn).delete(e.id),this.unselect(e),(!e.annotationElementId||!m(this,fl).has(e.annotationElementId))&&((t=m(this,Ur))==null||t.remove(e.id))}addDeletedAnnotationElement(e){m(this,fl).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return m(this,fl).has(e)}removeDeletedAnnotationElement(e){m(this,fl).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){m(this,Es)!==e&&(C(this,Es,e),e&&M(this,le,Ir).call(this,e.propertiesToUpdate))}updateUI(e){m(this,le,fR)===e&&M(this,le,Ir).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){M(this,le,Ir).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(m(this,ut).has(e)){m(this,ut).delete(e),e.unselect(),M(this,le,Gn).call(this,{hasSelectedEditor:this.hasSelection});return}m(this,ut).add(e),e.select(),M(this,le,Ir).call(this,e.propertiesToUpdate),M(this,le,Gn).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=m(this,hl))==null||t.commitOrRemove();for(const n of m(this,ut))n!==e&&n.unselect();m(this,ut).clear(),m(this,ut).add(e),e.select(),M(this,le,Ir).call(this,e.propertiesToUpdate),M(this,le,Gn).call(this,{hasSelectedEditor:!0})}isSelected(e){return m(this,ut).has(e)}get firstSelectedEditor(){return m(this,ut).values().next().value}unselect(e){e.unselect(),m(this,ut).delete(e),M(this,le,Gn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return m(this,ut).size!==0}get isEnterHandled(){return m(this,ut).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;m(this,ti).undo(),M(this,le,Gn).call(this,{hasSomethingToUndo:m(this,ti).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:M(this,le,Jh).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){m(this,ti).redo(),M(this,le,Gn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:m(this,ti).hasSomethingToRedo(),isEmpty:M(this,le,Jh).call(this)})}addCommands(e){m(this,ti).add(e),M(this,le,Gn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:M(this,le,Jh).call(this)})}cleanUndoStack(e){m(this,ti).cleanType(e)}delete(){var a;this.commitOrRemove();const e=(a=this.currentLayer)==null?void 0:a.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...m(this,ut)],n=()=>{var l;(l=this._editorUndoBar)==null||l.show(i,t.length===1?t[0].editorType:t.length);for(const c of t)c.remove()},i=()=>{for(const l of t)M(this,le,L_).call(this,l)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=m(this,Es))==null||e.commitOrRemove()}hasSomethingToControl(){return m(this,Es)||this.hasSelection}selectAll(){for(const e of m(this,ut))e.commit();M(this,le,O_).call(this,m(this,tn).values())}unselectAll(){var e;if(!(m(this,Es)&&(m(this,Es).commitOrRemove(),m(this,on)!==He.NONE))&&!((e=m(this,hl))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of m(this,ut))t.unselect();m(this,ut).clear(),M(this,le,Gn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;m(this,to)[0]+=e,m(this,to)[1]+=t;const[i,a]=m(this,to),l=[...m(this,ut)],c=1e3;m(this,Wi)&&clearTimeout(m(this,Wi)),C(this,Wi,setTimeout(()=>{C(this,Wi,null),m(this,to)[0]=m(this,to)[1]=0,this.addCommands({cmd:()=>{for(const d of l)m(this,tn).has(d.id)&&d.translateInPage(i,a)},undo:()=>{for(const d of l)m(this,tn).has(d.id)&&d.translateInPage(-i,-a)},mustExec:!1})},c));for(const d of l)d.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),C(this,Ki,new Map);for(const e of m(this,ut))m(this,Ki).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!m(this,Ki))return!1;this.disableUserSelect(!1);const e=m(this,Ki);C(this,Ki,null);let t=!1;for(const[{x:i,y:a,pageIndex:l},c]of e)c.newX=i,c.newY=a,c.newPageIndex=l,t||(t=i!==c.savedX||a!==c.savedY||l!==c.savedPageIndex);if(!t)return!1;const n=(i,a,l,c)=>{if(m(this,tn).has(i.id)){const d=m(this,xn).get(c);d?i._setParentAndPosition(d,a,l):(i.pageIndex=c,i.x=a,i.y=l)}};return this.addCommands({cmd:()=>{for(const[i,{newX:a,newY:l,newPageIndex:c}]of e)n(i,a,l,c)},undo:()=>{for(const[i,{savedX:a,savedY:l,savedPageIndex:c}]of e)n(i,a,l,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(m(this,Ki))for(const n of m(this,Ki).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||m(this,ut).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return m(this,Es)===e}getActive(){return m(this,Es)}getMode(){return m(this,on)}get imageManager(){return $e(this,"imageManager",new R_)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,p=t.rangeCount;h<p;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:n,y:i,width:a,height:l}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(h,p,y,_)=>({x:(p-i)/l,y:1-(h+y-n)/a,width:_/l,height:y/a});break;case"180":c=(h,p,y,_)=>({x:1-(h+y-n)/a,y:1-(p+_-i)/l,width:y/a,height:_/l});break;case"270":c=(h,p,y,_)=>({x:1-(p+_-i)/l,y:(h-n)/a,width:_/l,height:y/a});break;default:c=(h,p,y,_)=>({x:(h-n)/a,y:(p-i)/l,width:y/a,height:_/l});break}const d=[];for(let h=0,p=t.rangeCount;h<p;h++){const y=t.getRangeAt(h);if(!y.collapsed)for(const{x:_,y:S,width:A,height:E}of y.getClientRects())A===0||E===0||d.push(c(_,S,A,E))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:e,id:t}){(m(this,Ou)||C(this,Ou,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=m(this,Ou))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=m(this,Ou))==null?void 0:i.get(e.data.id);if(!t)return;const n=m(this,Ur).getRawValue(t);n&&(m(this,on)===He.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}};Pu=new WeakMap,Es=new WeakMap,tn=new WeakMap,xn=new WeakMap,Lu=new WeakMap,Ur=new WeakMap,Ou=new WeakMap,ti=new WeakMap,Ja=new WeakMap,hl=new WeakMap,Uu=new WeakMap,fl=new WeakMap,Ki=new WeakMap,xi=new WeakMap,pl=new WeakMap,If=new WeakMap,Df=new WeakMap,Fu=new WeakMap,Pf=new WeakMap,Xi=new WeakMap,Wa=new WeakMap,ju=new WeakMap,Qa=new WeakMap,Ji=new WeakMap,O0=new WeakMap,Za=new WeakMap,Lf=new WeakMap,eo=new WeakMap,ml=new WeakMap,Of=new WeakMap,Uf=new WeakMap,on=new WeakMap,ut=new WeakMap,Fr=new WeakMap,gl=new WeakMap,Ff=new WeakMap,jf=new WeakMap,to=new WeakMap,Wi=new WeakMap,jr=new WeakMap,zf=new WeakMap,ni=new WeakMap,le=new WeakSet,Fg=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},M_=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of m(this,xn).values())if(n.hasTextLayer(e))return n;return null},iR=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=M(this,le,Fg).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(m(this,Ji)||C(this,Ji,new D5(this)),m(this,Ji).show(n,i,this.direction==="ltr"))},rR=function(){var a,l,c;const e=document.getSelection();if(!e||e.isCollapsed){m(this,Fr)&&((a=m(this,Ji))==null||a.hide(),C(this,Fr,null),M(this,le,Gn).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===m(this,Fr))return;const i=M(this,le,Fg).call(this,e).closest(".textLayer");if(!i){m(this,Fr)&&((l=m(this,Ji))==null||l.hide(),C(this,Fr,null),M(this,le,Gn).call(this,{hasSelectedText:!1}));return}if((c=m(this,Ji))==null||c.hide(),C(this,Fr,t),M(this,le,Gn).call(this,{hasSelectedText:!0}),!(m(this,on)!==He.HIGHLIGHT&&m(this,on)!==He.NONE)&&(m(this,on)===He.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),C(this,Qa,this.isShiftKeyDown),!this.isShiftKeyDown)){const d=m(this,on)===He.HIGHLIGHT?M(this,le,M_).call(this,i):null;d==null||d.toggleDrawing();const h=new AbortController,p=this.combinedSignal(h),y=_=>{_.type==="pointerup"&&_.button!==0||(h.abort(),d==null||d.toggleDrawing(!0),_.type==="pointerup"&&M(this,le,jg).call(this,"main_toolbar"))};window.addEventListener("pointerup",y,{signal:p}),window.addEventListener("blur",y,{signal:p})}},jg=function(e=""){m(this,on)===He.HIGHLIGHT?this.highlightSelection(e):m(this,If)&&M(this,le,iR).call(this)},aR=function(){document.addEventListener("selectionchange",M(this,le,rR).bind(this),{signal:this._signal})},oR=function(){if(m(this,Wa))return;C(this,Wa,new AbortController);const e=this.combinedSignal(m(this,Wa));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},lR=function(){var e;(e=m(this,Wa))==null||e.abort(),C(this,Wa,null)},I_=function(){if(m(this,eo))return;C(this,eo,new AbortController);const e=this.combinedSignal(m(this,eo));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},cR=function(){var e;(e=m(this,eo))==null||e.abort(),C(this,eo,null)},D_=function(){if(m(this,Ja))return;C(this,Ja,new AbortController);const e=this.combinedSignal(m(this,Ja));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},P_=function(){var e;(e=m(this,Ja))==null||e.abort(),C(this,Ja,null)},uR=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Gn=function(e){Object.entries(e).some(([n,i])=>m(this,jf)[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(m(this,jf),e)}),m(this,on)===He.HIGHLIGHT&&e.hasSelectedEditor===!1&&M(this,le,Ir).call(this,[[Qe.HIGHLIGHT_FREE,!0]]))},Ir=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},dR=async function(){if(!m(this,Za)){C(this,Za,!0);const e=[];for(const t of m(this,xn).values())e.push(t.enable());await Promise.all(e);for(const t of m(this,tn).values())t.enable()}},hR=function(){if(this.unselectAll(),m(this,Za)){C(this,Za,!1);for(const e of m(this,xn).values())e.disable();for(const e of m(this,tn).values())e.disable()}},L_=function(e){const t=m(this,xn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},fR=function(){let e=null;for(e of m(this,ut));return e},Jh=function(){if(m(this,tn).size===0)return!0;if(m(this,tn).size===1)for(const e of m(this,tn).values())return e.isEmpty();return!1},O_=function(e){for(const t of m(this,ut))t.unselect();m(this,ut).clear();for(const t of e)t.isEmpty()||(m(this,ut).add(t),t.select());M(this,le,Gn).call(this,{hasSelectedEditor:this.hasSelection})},Me(Au,"TRANSLATE_SMALL",1),Me(Au,"TRANSLATE_BIG",10);let fc=Au;var ln,Qi,wi,zu,Zi,Ts,Hu,er,ds,zr,vl,tr,no,Pi,Wh,zg;const qn=class qn{constructor(e){k(this,Pi);k(this,ln,null);k(this,Qi,!1);k(this,wi,null);k(this,zu,null);k(this,Zi,null);k(this,Ts,null);k(this,Hu,!1);k(this,er,null);k(this,ds,null);k(this,zr,null);k(this,vl,null);k(this,tr,!1);C(this,ds,e),C(this,tr,e._uiManager.useNewAltTextFlow),m(qn,no)||C(qn,no,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){qn._l10n??(qn._l10n=e)}async render(){const e=C(this,wi,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=C(this,zu,document.createElement("span"));e.append(t),m(this,tr)?(e.classList.add("new"),e.setAttribute("data-l10n-id",m(qn,no).missing),t.setAttribute("data-l10n-id",m(qn,no)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=m(this,ds)._uiManager._signal;e.addEventListener("contextmenu",Ui,{signal:n}),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const i=a=>{a.preventDefault(),m(this,ds)._uiManager.editAltText(m(this,ds)),m(this,tr)&&m(this,ds)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:m(this,Pi,Wh)}})};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(C(this,Hu,!0),i(a))},{signal:n}),await M(this,Pi,zg).call(this),e}finish(){m(this,wi)&&(m(this,wi).focus({focusVisible:m(this,Hu)}),C(this,Hu,!1))}isEmpty(){return m(this,tr)?m(this,ln)===null:!m(this,ln)&&!m(this,Qi)}hasData(){return m(this,tr)?m(this,ln)!==null||!!m(this,zr):this.isEmpty()}get guessedText(){return m(this,zr)}async setGuessedText(e){m(this,ln)===null&&(C(this,zr,e),C(this,vl,await qn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),M(this,Pi,zg).call(this))}toggleAltTextBadge(e=!1){var t;if(!m(this,tr)||m(this,ln)){(t=m(this,er))==null||t.remove(),C(this,er,null);return}if(!m(this,er)){const n=C(this,er,document.createElement("div"));n.className="noAltTextBadge",m(this,ds).div.append(n)}m(this,er).classList.toggle("hidden",!e)}serialize(e){let t=m(this,ln);return!e&&m(this,zr)===t&&(t=m(this,vl)),{altText:t,decorative:m(this,Qi),guessedText:m(this,zr),textWithDisclaimer:m(this,vl)}}get data(){return{altText:m(this,ln),decorative:m(this,Qi)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:i,cancel:a=!1}){n&&(C(this,zr,n),C(this,vl,i)),!(m(this,ln)===e&&m(this,Qi)===t)&&(a||(C(this,ln,e),C(this,Qi,t)),M(this,Pi,zg).call(this))}toggle(e=!1){m(this,wi)&&(!e&&m(this,Ts)&&(clearTimeout(m(this,Ts)),C(this,Ts,null)),m(this,wi).disabled=!e)}shown(){m(this,ds)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:m(this,Pi,Wh)}})}destroy(){var e,t;(e=m(this,wi))==null||e.remove(),C(this,wi,null),C(this,zu,null),C(this,Zi,null),(t=m(this,er))==null||t.remove(),C(this,er,null)}};ln=new WeakMap,Qi=new WeakMap,wi=new WeakMap,zu=new WeakMap,Zi=new WeakMap,Ts=new WeakMap,Hu=new WeakMap,er=new WeakMap,ds=new WeakMap,zr=new WeakMap,vl=new WeakMap,tr=new WeakMap,no=new WeakMap,Pi=new WeakSet,Wh=function(){return m(this,ln)&&"added"||m(this,ln)===null&&this.guessedText&&"review"||"missing"},zg=async function(){var i,a,l;const e=m(this,wi);if(!e)return;if(m(this,tr)){if(e.classList.toggle("done",!!m(this,ln)),e.setAttribute("data-l10n-id",m(qn,no)[m(this,Pi,Wh)]),(i=m(this,zu))==null||i.setAttribute("data-l10n-id",m(qn,no)[`${m(this,Pi,Wh)}-label`]),!m(this,ln)){(a=m(this,Zi))==null||a.remove();return}}else{if(!m(this,ln)&&!m(this,Qi)){e.classList.remove("done"),(l=m(this,Zi))==null||l.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=m(this,Zi);if(!t){C(this,Zi,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${m(this,ds).id}`;const c=100,d=m(this,ds)._uiManager._signal;d.addEventListener("abort",()=>{clearTimeout(m(this,Ts)),C(this,Ts,null)},{once:!0}),e.addEventListener("mouseenter",()=>{C(this,Ts,setTimeout(()=>{C(this,Ts,null),m(this,Zi).classList.add("show"),m(this,ds)._reportTelemetry({action:"alt_text_tooltip"})},c))},{signal:d}),e.addEventListener("mouseleave",()=>{var h;m(this,Ts)&&(clearTimeout(m(this,Ts)),C(this,Ts,null)),(h=m(this,Zi))==null||h.classList.remove("show")},{signal:d})}m(this,Qi)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=m(this,ln)),t.parentNode||e.append(t);const n=m(this,ds).getImageForAltText();n==null||n.setAttribute("aria-describedby",t.id)},k(qn,no,null),Me(qn,"_l10n",null);let _0=qn;var Hf,yl,Bf,Gf,qf,Vf,$f,Bu,Hr,bl,so,fa,pR,mR,U_;const Rw=class Rw{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:a=null,onPinchEnd:l=null,signal:c}){k(this,fa);k(this,Hf);k(this,yl,!1);k(this,Bf,null);k(this,Gf);k(this,qf);k(this,Vf);k(this,$f);k(this,Bu);k(this,Hr,null);k(this,bl);k(this,so,null);C(this,Hf,e),C(this,Bf,n),C(this,Gf,t),C(this,qf,i),C(this,Vf,a),C(this,$f,l),C(this,bl,new AbortController),C(this,Bu,AbortSignal.any([c,m(this,bl).signal])),e.addEventListener("touchstart",M(this,fa,pR).bind(this),{passive:!1,signal:m(this,Bu)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return $e(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=m(this,bl))==null||e.abort(),C(this,bl,null)}};Hf=new WeakMap,yl=new WeakMap,Bf=new WeakMap,Gf=new WeakMap,qf=new WeakMap,Vf=new WeakMap,$f=new WeakMap,Bu=new WeakMap,Hr=new WeakMap,bl=new WeakMap,so=new WeakMap,fa=new WeakSet,pR=function(e){var i,a,l;if((i=m(this,Gf))!=null&&i.call(this)||e.touches.length<2)return;if(!m(this,so)){C(this,so,new AbortController);const c=AbortSignal.any([m(this,Bu),m(this,so).signal]),d=m(this,Hf),h={signal:c,passive:!1};d.addEventListener("touchmove",M(this,fa,mR).bind(this),h),d.addEventListener("touchend",M(this,fa,U_).bind(this),h),d.addEventListener("touchcancel",M(this,fa,U_).bind(this),h),(a=m(this,qf))==null||a.call(this)}if(Hs(e),e.touches.length!==2||(l=m(this,Bf))!=null&&l.call(this)){C(this,Hr,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),C(this,Hr,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},mR=function(e){var L;if(!m(this,Hr)||e.touches.length!==2)return;let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:i,screenY:a}=t,{screenX:l,screenY:c}=n,d=m(this,Hr),{touch0X:h,touch0Y:p,touch1X:y,touch1Y:_}=d,S=y-h,A=_-p,E=l-i,N=c-a,R=Math.hypot(E,N)||1,D=Math.hypot(S,A)||1;if(!m(this,yl)&&Math.abs(D-R)<=Rw.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=i,d.touch0Y=a,d.touch1X=l,d.touch1Y=c,e.preventDefault(),!m(this,yl)){C(this,yl,!0);return}const P=[(i+l)/2,(a+c)/2];(L=m(this,Vf))==null||L.call(this,P,D,R)},U_=function(e){var t;m(this,so).abort(),C(this,so,null),(t=m(this,$f))==null||t.call(this),m(this,Hr)&&(e.preventDefault(),C(this,Hr,null),C(this,yl,!1))};let x0=Rw;var _l,Si,At,Gu,io,Yf,xl,wn,wl,Br,ro,Kf,Sl,Cs,Xf,Al,Gr,nr,qu,Vu,si,El,Jf,U0,Ie,F_,Wf,j_,Hg,gR,vR,z_,Bg,H_,yR,bR,_R,B_,xR,G_,wR,SR,AR,q_,Qh;const Ge=class Ge{constructor(e){k(this,Ie);k(this,_l,null);k(this,Si,null);k(this,At,null);k(this,Gu,!1);k(this,io,null);k(this,Yf,"");k(this,xl,!1);k(this,wn,null);k(this,wl,null);k(this,Br,null);k(this,ro,null);k(this,Kf,"");k(this,Sl,!1);k(this,Cs,null);k(this,Xf,!1);k(this,Al,!1);k(this,Gr,!1);k(this,nr,null);k(this,qu,0);k(this,Vu,0);k(this,si,null);k(this,El,null);Me(this,"_editToolbar",null);Me(this,"_initialOptions",Object.create(null));Me(this,"_initialData",null);Me(this,"_isVisible",!0);Me(this,"_uiManager",null);Me(this,"_focusEventsAllowed",!0);k(this,Jf,!1);k(this,U0,Ge._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[a,l];const[c,d]=this.parentDimensions;this.x=e.x/c,this.y=e.y/d,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Ge.prototype._resizeWithKeyboard,t=fc.TRANSLATE_SMALL,n=fc.TRANSLATE_BIG;return $e(this,"_resizerKeyboardManager",new tm([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Ge.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return $e(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new O5({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Ge._l10n??(Ge._l10n=e),Ge._l10nResizer||(Ge._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Ge._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Ge._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){bt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return m(this,Jf)}set _isDraggable(e){var t;C(this,Jf,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=m(this,U0)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):M(this,Ie,Qh).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(m(this,Sl)?C(this,Sl,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[a,l]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/a,this.y=(t+i)/l,this.fixAndSetPosition()}translate(e,t){M(this,Ie,F_).call(this,this.parentDimensions,e,t)}translateInPage(e,t){m(this,Cs)||C(this,Cs,[this.x,this.y,this.width,this.height]),M(this,Ie,F_).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){m(this,Cs)||C(this,Cs,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[i,a]}=this;if(this.x+=e/i,this.y+=t/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:_}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,_)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[d,h]=this.getBaseTranslation();l+=d,c+=h;const{style:p}=n;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!m(this,Cs)&&(m(this,Cs)[0]!==this.x||m(this,Cs)[1]!==this.y)}get _hasBeenResized(){return!!m(this,Cs)&&(m(this,Cs)[2]!==this.width||m(this,Cs)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Ge,i=n/e,a=n/t;switch(this.rotation){case 90:return[-i,a];case 180:return[i,a];case 270:return[i,-a];default:return[-i,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,i]}=this;let{x:a,y:l,width:c,height:d}=this;if(c*=n,d*=i,a*=n,l*=i,this._mustFixPosition)switch(e){case 0:a=Math.max(0,Math.min(n-c,a)),l=Math.max(0,Math.min(i-d,l));break;case 90:a=Math.max(0,Math.min(n-d,a)),l=Math.min(i,Math.max(c,l));break;case 180:a=Math.min(n,Math.max(c,a)),l=Math.min(i,Math.max(d,l));break;case 270:a=Math.min(n,Math.max(d,a)),l=Math.max(0,Math.min(i-c,l));break}this.x=a/=n,this.y=l/=i;const[h,p]=this.getBaseTranslation();a+=h,l+=p,t.left=`${(100*a).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return M(n=Ge,Wf,j_).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return M(n=Ge,Wf,j_).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,i]=this.parentDimensions,{style:a}=this.div;a.width=`${(100*e/n).toFixed(2)}%`,m(this,xl)||(a.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,i=n.endsWith("%"),a=!m(this,xl)&&t.endsWith("%");if(i&&a)return;const[l,c]=this.parentDimensions;i||(e.width=`${(100*parseFloat(n)/l).toFixed(2)}%`),!m(this,xl)&&!a&&(e.height=`${(100*parseFloat(t)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=m(this,At))==null||e.finish()}async addEditToolbar(){return this._editToolbar||m(this,Al)?this._editToolbar:(this._editToolbar=new C_(this),this.div.append(this._editToolbar.render()),m(this,At)&&await this._editToolbar.addAltText(m(this,At)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=m(this,At))==null||e.destroy())}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){m(this,At)||(_0.initialize(Ge._l10n),C(this,At,new _0(this)),m(this,_l)&&(m(this,At).data=m(this,_l),C(this,_l,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=m(this,At))==null?void 0:e.data}set altTextData(e){m(this,At)&&(m(this,At).data=e)}get guessedAltText(){var e;return(e=m(this,At))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=m(this,At))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=m(this,At))==null?void 0:t.serialize(e)}hasAltText(){return!!m(this,At)&&!m(this,At).isEmpty()}hasAltTextData(){var e;return((e=m(this,At))==null?void 0:e.hasData())??!1}render(){var a;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=m(this,Gu)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),M(this,Ie,G_).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[n,i]=this.getInitialTranslation();return this.translate(n,i),b0(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(m(this,El)||C(this,El,new x0({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:M(this,Ie,yR).bind(this),onPinching:M(this,Ie,bR).bind(this),onPinchEnd:M(this,Ie,_R).bind(this),signal:this._uiManager._signal}))),(a=this._uiManager._editorUndoBar)==null||a.hide(),this.div}pointerdown(e){const{isMac:t}=Xn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(C(this,Sl,!0),this._isDraggable){M(this,Ie,xR).call(this,e);return}M(this,Ie,B_).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){m(this,nr)&&clearTimeout(m(this,nr)),C(this,nr,setTimeout(()=>{var e;C(this,nr,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const i=this.parentScale,[a,l]=this.pageDimensions,[c,d]=this.pageTranslation,h=e/i,p=t/i,y=this.x*a,_=this.y*l,S=this.width*a,A=this.height*l;switch(n){case 0:return[y+h+c,l-_-p-A+d,y+h+S+c,l-_-p+d];case 90:return[y+p+c,l-_+h+d,y+p+A+c,l-_+h+S+d];case 180:return[y-h-S+c,l-_+p+d,y-h+c,l-_+p+A+d];case 270:return[y-p-A+c,l-_-h-S+d,y-p+c,l-_-h+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,a,l]=e,c=a-n,d=l-i;switch(this.rotation){case 0:return[n,t-l,c,d];case 90:return[n,t-i,d,c];case 180:return[a,t-i,c,d];case 270:return[a,t-l,d,c];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){C(this,Al,!0)}disableEditMode(){C(this,Al,!1)}isInEditMode(){return m(this,Al)}shouldGetKeyboardEvents(){return m(this,Gr)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:a,innerWidth:l}=window;return t<l&&i>0&&e<a&&n>0}rebuild(){M(this,Ie,G_).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){bt("An editor must be serializable")}static async deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});i.rotation=e.rotation,C(i,_l,e.accessibilityData);const[a,l]=i.pageDimensions,[c,d,h,p]=i.getRectInCurrentCoords(e.rect,l);return i.x=c/a,i.y=d/l,i.width=h/a,i.height=p/l,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=m(this,ro))==null||e.abort(),C(this,ro,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),m(this,nr)&&(clearTimeout(m(this,nr)),C(this,nr,null)),M(this,Ie,Qh).call(this),this.removeEditToolbar(),m(this,si)){for(const n of m(this,si).values())clearTimeout(n);C(this,si,null)}this.parent=null,(t=m(this,El))==null||t.destroy(),C(this,El,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(M(this,Ie,gR).call(this),m(this,wn).classList.remove("hidden"),b0(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),C(this,Br,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=m(this,wn).children;if(!m(this,Si)){C(this,Si,Array.from(t));const l=M(this,Ie,wR).bind(this),c=M(this,Ie,SR).bind(this),d=this._uiManager._signal;for(const h of m(this,Si)){const p=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",l,{signal:d}),h.addEventListener("blur",c,{signal:d}),h.addEventListener("focus",M(this,Ie,AR).bind(this,p),{signal:d}),h.setAttribute("data-l10n-id",Ge._l10nResizer[p])}}const n=m(this,Si)[0];let i=0;for(const l of t){if(l===n)break;i++}const a=(360-this.rotation+this.parentRotation)%360/90*(m(this,Si).length/4);if(a!==i){if(a<i)for(let c=0;c<i-a;c++)m(this,wn).append(m(this,wn).firstChild);else if(a>i)for(let c=0;c<a-i;c++)m(this,wn).firstChild.before(m(this,wn).lastChild);let l=0;for(const c of t){const h=m(this,Si)[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Ge._l10nResizer[h])}}M(this,Ie,q_).call(this,0),C(this,Gr,!0),m(this,wn).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){m(this,Gr)&&M(this,Ie,H_).call(this,m(this,Kf),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){M(this,Ie,Qh).call(this),this.div.focus()}select(){var e,t,n;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,a;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((a=this._editToolbar)==null||a.show())});return}(t=this._editToolbar)==null||t.show(),(n=m(this,At))==null||n.toggleAltTextBadge(!1)}unselect(){var e,t,n,i,a;(e=m(this,wn))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(a=m(this,At))==null||a.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return m(this,Xf)}set isEditing(e){C(this,Xf,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){C(this,xl,!0);const n=e/t,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){m(this,si)||C(this,si,new Map);const{action:n}=e;let i=m(this,si).get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),m(this,si).delete(n),m(this,si).size===0&&C(this,si,null)},Ge._telemetryTimeout),m(this,si).set(n,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),C(this,Gu,!1)}disable(){this.div&&(this.div.tabIndex=-1),C(this,Gu,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};_l=new WeakMap,Si=new WeakMap,At=new WeakMap,Gu=new WeakMap,io=new WeakMap,Yf=new WeakMap,xl=new WeakMap,wn=new WeakMap,wl=new WeakMap,Br=new WeakMap,ro=new WeakMap,Kf=new WeakMap,Sl=new WeakMap,Cs=new WeakMap,Xf=new WeakMap,Al=new WeakMap,Gr=new WeakMap,nr=new WeakMap,qu=new WeakMap,Vu=new WeakMap,si=new WeakMap,El=new WeakMap,Jf=new WeakMap,U0=new WeakMap,Ie=new WeakSet,F_=function([e,t],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Wf=new WeakSet,j_=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Hg=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},gR=function(){if(m(this,wn))return;C(this,wn,document.createElement("div")),m(this,wn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const i=document.createElement("div");m(this,wn).append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",M(this,Ie,vR).bind(this,n),{signal:t}),i.addEventListener("contextmenu",Ui,{signal:t}),i.tabIndex=-1}this.div.prepend(m(this,wn))},vR=function(e,t){var p;t.preventDefault();const{isMac:n}=Xn.platform;if(t.button!==0||t.ctrlKey&&n)return;(p=m(this,At))==null||p.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,C(this,wl,[t.screenX,t.screenY]);const a=new AbortController,l=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",M(this,Ie,H_).bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Hs,{passive:!1,signal:l}),window.addEventListener("contextmenu",Ui,{signal:l}),C(this,Br,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const c=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const h=()=>{var y;a.abort(),this.parent.togglePointerEvents(!0),(y=m(this,At))==null||y.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=c,this.div.style.cursor=d,M(this,Ie,Bg).call(this)};window.addEventListener("pointerup",h,{signal:l}),window.addEventListener("blur",h,{signal:l})},z_=function(e,t,n,i){this.width=n,this.height=i,this.x=e,this.y=t;const[a,l]=this.parentDimensions;this.setDims(a*n,l*i),this.fixAndSetPosition(),this._onResized()},Bg=function(){if(!m(this,Br))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=m(this,Br);C(this,Br,null);const a=this.x,l=this.y,c=this.width,d=this.height;a===e&&l===t&&c===n&&d===i||this.addCommands({cmd:M(this,Ie,z_).bind(this,a,l,c,d),undo:M(this,Ie,z_).bind(this,e,t,n,i),mustExec:!0})},H_=function(e,t){const[n,i]=this.parentDimensions,a=this.x,l=this.y,c=this.width,d=this.height,h=Ge.MIN_SIZE/n,p=Ge.MIN_SIZE/i,y=M(this,Ie,Hg).call(this,this.rotation),_=(j,G)=>[y[0]*j+y[2]*G,y[1]*j+y[3]*G],S=M(this,Ie,Hg).call(this,360-this.rotation),A=(j,G)=>[S[0]*j+S[2]*G,S[1]*j+S[3]*G];let E,N,R=!1,D=!1;switch(e){case"topLeft":R=!0,E=(j,G)=>[0,0],N=(j,G)=>[j,G];break;case"topMiddle":E=(j,G)=>[j/2,0],N=(j,G)=>[j/2,G];break;case"topRight":R=!0,E=(j,G)=>[j,0],N=(j,G)=>[0,G];break;case"middleRight":D=!0,E=(j,G)=>[j,G/2],N=(j,G)=>[0,G/2];break;case"bottomRight":R=!0,E=(j,G)=>[j,G],N=(j,G)=>[0,0];break;case"bottomMiddle":E=(j,G)=>[j/2,G],N=(j,G)=>[j/2,0];break;case"bottomLeft":R=!0,E=(j,G)=>[0,G],N=(j,G)=>[j,0];break;case"middleLeft":D=!0,E=(j,G)=>[0,G/2],N=(j,G)=>[j,G/2];break}const P=E(c,d),L=N(c,d);let z=_(...L);const H=Ge._round(a+z[0]),F=Ge._round(l+z[1]);let X=1,Y=1,J,ie;if(t.fromKeyboard)({deltaX:J,deltaY:ie}=t);else{const{screenX:j,screenY:G}=t,[ae,we]=m(this,wl);[J,ie]=this.screenToPageTranslation(j-ae,G-we),m(this,wl)[0]=j,m(this,wl)[1]=G}if([J,ie]=A(J/n,ie/i),R){const j=Math.hypot(c,d);X=Y=Math.max(Math.min(Math.hypot(L[0]-P[0]-J,L[1]-P[1]-ie)/j,1/c,1/d),h/c,p/d)}else D?X=Math.max(h,Math.min(1,Math.abs(L[0]-P[0]-J)))/c:Y=Math.max(p,Math.min(1,Math.abs(L[1]-P[1]-ie)))/d;const pe=Ge._round(c*X),ye=Ge._round(d*Y);z=_(...N(pe,ye));const be=H-z[0],Se=F-z[1];m(this,Cs)||C(this,Cs,[this.x,this.y,this.width,this.height]),this.width=pe,this.height=ye,this.x=be,this.y=Se,this.setDims(n*pe,i*ye),this.fixAndSetPosition(),this._onResizing()},yR=function(){var e;C(this,Br,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=m(this,At))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},bR=function(e,t,n){let a=.7*(n/t)+1-.7;if(a===1)return;const l=M(this,Ie,Hg).call(this,this.rotation),c=(H,F)=>[l[0]*H+l[2]*F,l[1]*H+l[3]*F],[d,h]=this.parentDimensions,p=this.x,y=this.y,_=this.width,S=this.height,A=Ge.MIN_SIZE/d,E=Ge.MIN_SIZE/h;a=Math.max(Math.min(a,1/_,1/S),A/_,E/S);const N=Ge._round(_*a),R=Ge._round(S*a);if(N===_&&R===S)return;m(this,Cs)||C(this,Cs,[p,y,_,S]);const D=c(_/2,S/2),P=Ge._round(p+D[0]),L=Ge._round(y+D[1]),z=c(N/2,R/2);this.x=P-z[0],this.y=L-z[1],this.width=N,this.height=R,this.setDims(d*N,h*R),this.fixAndSetPosition(),this._onResizing()},_R=function(){var e;(e=m(this,At))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),M(this,Ie,Bg).call(this)},B_=function(e){const{isMac:t}=Xn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},xR=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,a=this._uiManager.combinedSignal(i),l={capture:!0,passive:!1,signal:a},c=h=>{i.abort(),C(this,io,null),C(this,Sl,!1),this._uiManager.endDragSession()||M(this,Ie,B_).call(this,h),n&&this._onStopDragging()};t&&(C(this,qu,e.clientX),C(this,Vu,e.clientY),C(this,io,e.pointerId),C(this,Yf,e.pointerType),window.addEventListener("pointermove",h=>{n||(n=!0,this._onStartDragging());const{clientX:p,clientY:y,pointerId:_}=h;if(_!==m(this,io)){Hs(h);return}const[S,A]=this.screenToPageTranslation(p-m(this,qu),y-m(this,Vu));C(this,qu,p),C(this,Vu,y),this._uiManager.dragSelectedEditors(S,A)},l),window.addEventListener("touchmove",Hs,l),window.addEventListener("pointerdown",h=>{h.pointerType===m(this,Yf)&&(m(this,El)||h.isPrimary)&&c(h),Hs(h)},l));const d=h=>{if(!m(this,io)||m(this,io)===h.pointerId){c(h);return}Hs(h)};window.addEventListener("pointerup",d,{signal:a}),window.addEventListener("blur",d,{signal:a})},G_=function(){if(m(this,ro)||!this.div)return;C(this,ro,new AbortController);const e=this._uiManager.combinedSignal(m(this,ro));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},wR=function(e){Ge._resizerKeyboardManager.exec(this,e)},SR=function(e){var t;m(this,Gr)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==m(this,wn)&&M(this,Ie,Qh).call(this)},AR=function(e){C(this,Kf,m(this,Gr)?e:"")},q_=function(e){if(m(this,Si))for(const t of m(this,Si))t.tabIndex=e},Qh=function(){C(this,Gr,!1),M(this,Ie,q_).call(this,-1),M(this,Ie,Bg).call(this)},k(Ge,Wf),Me(Ge,"_l10n",null),Me(Ge,"_l10nResizer",null),Me(Ge,"_borderLineWidth",-1),Me(Ge,"_colorManager",new k_),Me(Ge,"_zIndex",1),Me(Ge,"_telemetryTimeout",1e3);let It=Ge;class O5 extends It{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const gT=3285377520,ei=4294901760,$i=65535;class ER{constructor(e){this.h1=e?e&4294967295:gT,this.h2=e?e&4294967295:gT}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let E=0,N=e.length;E<N;E++){const R=e.charCodeAt(E);R<=255?t[n++]=R:(t[n++]=R>>>8,t[n++]=R&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,a=n-i*4,l=new Uint32Array(t.buffer,0,i);let c=0,d=0,h=this.h1,p=this.h2;const y=3432918353,_=461845907,S=y&$i,A=_&$i;for(let E=0;E<i;E++)E&1?(c=l[E],c=c*y&ei|c*S&$i,c=c<<15|c>>>17,c=c*_&ei|c*A&$i,h^=c,h=h<<13|h>>>19,h=h*5+3864292196):(d=l[E],d=d*y&ei|d*S&$i,d=d<<15|d>>>17,d=d*_&ei|d*A&$i,p^=d,p=p<<13|p>>>19,p=p*5+3864292196);switch(c=0,a){case 3:c^=t[i*4+2]<<16;case 2:c^=t[i*4+1]<<8;case 1:c^=t[i*4],c=c*y&ei|c*S&$i,c=c<<15|c>>>17,c=c*_&ei|c*A&$i,i&1?h^=c:p^=c}this.h1=h,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ei|e*36045&$i,t=t*4283543511&ei|((t<<16|e>>>16)*2950163797&ei)>>>16,e^=t>>>1,e=e*444984403&ei|e*60499&$i,t=t*3301882366&ei|((t<<16|e>>>16)*3120437893&ei)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const V_=Object.freeze({map:null,hash:"",transfer:void 0});var Tl,Cl,cn,F0,TR;class pw{constructor(){k(this,F0);k(this,Tl,!1);k(this,Cl,null);k(this,cn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=m(this,cn).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return m(this,cn).get(e)}remove(e){if(m(this,cn).delete(e),m(this,cn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of m(this,cn).values())if(t instanceof It)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=m(this,cn).get(e);let i=!1;if(n!==void 0)for(const[a,l]of Object.entries(t))n[a]!==l&&(i=!0,n[a]=l);else i=!0,m(this,cn).set(e,t);i&&M(this,F0,TR).call(this),t instanceof It&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return m(this,cn).has(e)}getAll(){return m(this,cn).size>0?lw(m(this,cn)):null}setAll(e){for(const[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return m(this,cn).size}resetModified(){m(this,Tl)&&(C(this,Tl,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new CR(this)}get serializable(){if(m(this,cn).size===0)return V_;const e=new Map,t=new ER,n=[],i=Object.create(null);let a=!1;for(const[l,c]of m(this,cn)){const d=c instanceof It?c.serialize(!1,i):c;d&&(e.set(l,d),t.update(`${l}:${JSON.stringify(d)}`),a||(a=!!d.bitmap))}if(a)for(const l of e.values())l.bitmap&&n.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:V_}get editorStats(){let e=null;const t=new Map;for(const n of m(this,cn).values()){if(!(n instanceof It))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:a}=i;t.has(a)||t.set(a,Object.getPrototypeOf(n).constructor),e||(e=Object.create(null));const l=e[a]||(e[a]=new Map);for(const[c,d]of Object.entries(i)){if(c==="type")continue;let h=l.get(c);h||(h=new Map,l.set(c,h));const p=h.get(d)??0;h.set(d,p+1)}}for(const[n,i]of t)e[n]=i.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){C(this,Cl,null)}get modifiedIds(){if(m(this,Cl))return m(this,Cl);const e=[];for(const t of m(this,cn).values())!(t instanceof It)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return C(this,Cl,{ids:new Set(e),hash:e.join(",")})}}Tl=new WeakMap,Cl=new WeakMap,cn=new WeakMap,F0=new WeakSet,TR=function(){m(this,Tl)||(C(this,Tl,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Qf;class CR extends pw{constructor(t){super();k(this,Qf);const{map:n,hash:i,transfer:a}=t.serializable,l=structuredClone(n,a?{transfer:a}:null);C(this,Qf,{map:l,hash:i,transfer:a})}get print(){bt("Should not call PrintAnnotationStorage.print")}get serializable(){return m(this,Qf)}get modifiedIds(){return $e(this,"modifiedIds",{ids:new Set,hash:""})}}Qf=new WeakMap;var $u;class U5{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){k(this,$u,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),m(this,$u).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||m(this,$u).has(e.loadedName))){if(Xt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:a}=e,l=new FontFace(n,i,a);this.addNativeFontFace(l);try{await l.load(),m(this,$u).add(n),t==null||t(e)}catch{Be(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}bt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw Be(`Failed to load font '${n.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return $e(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Un||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),$e(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Xt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const a=n.shift();setTimeout(a.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:t,callback:e};return n.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return $e(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(L,z){return L.charCodeAt(z)<<24|L.charCodeAt(z+1)<<16|L.charCodeAt(z+2)<<8|L.charCodeAt(z+3)&255}function i(L,z,H,F){const X=L.substring(0,z),Y=L.substring(z+H);return X+F+Y}let a,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const d=c.getContext("2d");let h=0;function p(L,z){if(++h>30){Be("Load test font never loaded."),z();return}if(d.font="30px "+L,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){z();return}setTimeout(p.bind(null,L,z))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let _=this._loadTestFont;_=i(_,976,y.length,y);const A=16,E=1482184792;let N=n(_,A);for(a=0,l=y.length-3;a<l;a+=4)N=N-E+n(y,a)|0;a<y.length&&(N=N-E+n(y+"XXX",a)|0),_=i(_,A,4,w5(N));const R=`url(data:font/opentype;base64,${btoa(_)});`,D=`@font-face {font-family:"${y}";src:${R}}`;this.insertRule(D);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const L of[e.loadedName,y]){const z=this._document.createElement("span");z.textContent="Hi",z.style.fontFamily=L,P.append(z)}this._document.body.append(P),p(y,()=>{P.remove(),t.complete()})}}$u=new WeakMap;class F5{constructor(e,{disableFontFace:t=!1,fontExtraProperties:n=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const a in e)this[a]=e[a];this.disableFontFace=t===!0,this.fontExtraProperties=n===!0,this._inspectFont=i}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${N5(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let i;try{i=e.get(n)}catch(l){Be(`getPathGenerator - ignoring character: "${l}".`)}const a=new Path2D(i||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=a}}const Eg={DATA:1,ERROR:2},Yt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function vT(){}function cs(s){if(s instanceof To||s instanceof A_||s instanceof Sf||s instanceof fT||s instanceof y0||s instanceof Zb)return s;switch(s instanceof Error||typeof s=="object"&&s!==null||bt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),s.name){case"AbortException":return new To(s.message);case"InvalidPDFException":return new A_(s.message);case"MissingPDFException":return new Sf(s.message);case"PasswordException":return new fT(s.message,s.code);case"UnexpectedResponseException":return new y0(s.message,s.status);case"UnknownErrorException":return new Zb(s.message,s.details)}return new Zb(s.message,s.toString())}var Yu,di,NR,RR,kR,Gg;class Zh{constructor(e,t,n){k(this,di);k(this,Yu,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",M(this,di,NR).bind(this),{signal:m(this,Yu).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const i=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[i]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(l){a.reject(l)}return a.promise}sendWithStream(e,t,n,i){const a=this.streamId++,l=this.sourceName,c=this.targetName,d=this.comObj;return new ReadableStream({start:h=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:h,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:l,targetName:c,action:e,streamId:a,data:t,desiredSize:h.desiredSize},i),p.promise},pull:h=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,d.postMessage({sourceName:l,targetName:c,stream:Yt.PULL,streamId:a,desiredSize:h.desiredSize}),p.promise},cancel:h=>{Xt(h instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,d.postMessage({sourceName:l,targetName:c,stream:Yt.CANCEL,streamId:a,reason:cs(h)}),p.promise}},n)}destroy(){var e;(e=m(this,Yu))==null||e.abort(),C(this,Yu,null)}}Yu=new WeakMap,di=new WeakSet,NR=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){M(this,di,kR).call(this,e);return}if(e.callback){const n=e.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===Eg.DATA)i.resolve(e.data);else if(e.callback===Eg.ERROR)i.reject(cs(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,i=e.sourceName,a=this.comObj;Promise.try(t,e.data).then(function(l){a.postMessage({sourceName:n,targetName:i,callback:Eg.DATA,callbackId:e.callbackId,data:l})},function(l){a.postMessage({sourceName:n,targetName:i,callback:Eg.ERROR,callbackId:e.callbackId,reason:cs(l)})});return}if(e.streamId){M(this,di,RR).call(this,e);return}t(e.data)},RR=function(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,a=this.comObj,l=this,c=this.actionHandler[e.action],d={enqueue(h,p=1,y){if(this.isCancelled)return;const _=this.desiredSize;this.desiredSize-=p,_>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:i,stream:Yt.ENQUEUE,streamId:t,chunk:h},y)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:Yt.CLOSE,streamId:t}),delete l.streamSinks[t])},error(h){Xt(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:Yt.ERROR,streamId:t,reason:cs(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[t]=d,Promise.try(c,e.data,d).then(function(){a.postMessage({sourceName:n,targetName:i,stream:Yt.START_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:i,stream:Yt.START_COMPLETE,streamId:t,reason:cs(h)})})},kR=function(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,a=this.comObj,l=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case Yt.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(cs(e.reason));break;case Yt.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(cs(e.reason));break;case Yt.PULL:if(!c){a.postMessage({sourceName:n,targetName:i,stream:Yt.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||vT).then(function(){a.postMessage({sourceName:n,targetName:i,stream:Yt.PULL_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:i,stream:Yt.PULL_COMPLETE,streamId:t,reason:cs(h)})});break;case Yt.ENQUEUE:if(Xt(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case Yt.CLOSE:if(Xt(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),M(this,di,Gg).call(this,l,t);break;case Yt.ERROR:Xt(l,"error should have stream controller"),l.controller.error(cs(e.reason)),M(this,di,Gg).call(this,l,t);break;case Yt.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(cs(e.reason)),M(this,di,Gg).call(this,l,t);break;case Yt.CANCEL:if(!c)break;const d=cs(e.reason);Promise.try(c.onCancel||vT,d).then(function(){a.postMessage({sourceName:n,targetName:i,stream:Yt.CANCEL_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:i,stream:Yt.CANCEL_COMPLETE,streamId:t,reason:cs(h)})}),c.sinkCapability.reject(d),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Gg=async function(e,t){var n,i,a;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(i=e.pullCall)==null?void 0:i.promise,(a=e.cancelCall)==null?void 0:a.promise]),delete this.streamControllers[t]};var Zf;class MR{constructor({enableHWA:e=!1}){k(this,Zf,!1);C(this,Zf,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!m(this,Zf)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){bt("Abstract method `_createCanvas` called.")}}Zf=new WeakMap;class j5 extends MR{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class IR{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){bt("Abstract method `_fetch` called.")}}class DR extends IR{async _fetch(e){const t=await rv(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):iv(t)}}class PR{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,a){return"none"}destroy(e=!1){}}var Nl,Ku,qr,Vr,In,Rl,kl,me,Rn,ef,fu,qg,pu,LR,$_,mu,tf,nf,Y_,sf;class z5 extends PR{constructor({docId:t,ownerDocument:n=globalThis.document}){super();k(this,me);k(this,Nl);k(this,Ku);k(this,qr);k(this,Vr);k(this,In);k(this,Rl);k(this,kl,0);C(this,Vr,t),C(this,In,n)}addFilter(t){if(!t)return"none";let n=m(this,me,Rn).get(t);if(n)return n;const[i,a,l]=M(this,me,qg).call(this,t),c=t.length===1?i:`${i}${a}${l}`;if(n=m(this,me,Rn).get(c),n)return m(this,me,Rn).set(t,n),n;const d=`g_${m(this,Vr)}_transfer_map_${Bn(this,kl)._++}`,h=M(this,me,pu).call(this,d);m(this,me,Rn).set(t,h),m(this,me,Rn).set(c,h);const p=M(this,me,mu).call(this,d);return M(this,me,nf).call(this,i,a,l,p),h}addHCMFilter(t,n){var A;const i=`${t}-${n}`,a="base";let l=m(this,me,ef).get(a);if((l==null?void 0:l.key)===i||(l?((A=l.filter)==null||A.remove(),l.key=i,l.url="none",l.filter=null):(l={key:i,url:"none",filter:null},m(this,me,ef).set(a,l)),!t||!n))return l.url;const c=M(this,me,sf).call(this,t);t=Ce.makeHexColor(...c);const d=M(this,me,sf).call(this,n);if(n=Ce.makeHexColor(...d),m(this,me,fu).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return l.url;const h=new Array(256);for(let E=0;E<=255;E++){const N=E/255;h[E]=N<=.03928?N/12.92:((N+.055)/1.055)**2.4}const p=h.join(","),y=`g_${m(this,Vr)}_hcm_filter`,_=l.filter=M(this,me,mu).call(this,y);M(this,me,nf).call(this,p,p,p,_),M(this,me,$_).call(this,_);const S=(E,N)=>{const R=c[E]/255,D=d[E]/255,P=new Array(N+1);for(let L=0;L<=N;L++)P[L]=R+L/N*(D-R);return P.join(",")};return M(this,me,nf).call(this,S(0,5),S(1,5),S(2,5),_),l.url=M(this,me,pu).call(this,y),l.url}addAlphaFilter(t){let n=m(this,me,Rn).get(t);if(n)return n;const[i]=M(this,me,qg).call(this,[t]),a=`alpha_${i}`;if(n=m(this,me,Rn).get(a),n)return m(this,me,Rn).set(t,n),n;const l=`g_${m(this,Vr)}_alpha_map_${Bn(this,kl)._++}`,c=M(this,me,pu).call(this,l);m(this,me,Rn).set(t,c),m(this,me,Rn).set(a,c);const d=M(this,me,mu).call(this,l);return M(this,me,Y_).call(this,i,d),c}addLuminosityFilter(t){let n=m(this,me,Rn).get(t||"luminosity");if(n)return n;let i,a;if(t?([i]=M(this,me,qg).call(this,[t]),a=`luminosity_${i}`):a="luminosity",n=m(this,me,Rn).get(a),n)return m(this,me,Rn).set(t,n),n;const l=`g_${m(this,Vr)}_luminosity_map_${Bn(this,kl)._++}`,c=M(this,me,pu).call(this,l);m(this,me,Rn).set(t,c),m(this,me,Rn).set(a,c);const d=M(this,me,mu).call(this,l);return M(this,me,LR).call(this,d),t&&M(this,me,Y_).call(this,i,d),c}addHighlightHCMFilter(t,n,i,a,l){var D;const c=`${n}-${i}-${a}-${l}`;let d=m(this,me,ef).get(t);if((d==null?void 0:d.key)===c||(d?((D=d.filter)==null||D.remove(),d.key=c,d.url="none",d.filter=null):(d={key:c,url:"none",filter:null},m(this,me,ef).set(t,d)),!n||!i))return d.url;const[h,p]=[n,i].map(M(this,me,sf).bind(this));let y=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),_=Math.round(.2126*p[0]+.7152*p[1]+.0722*p[2]),[S,A]=[a,l].map(M(this,me,sf).bind(this));_<y&&([y,_,S,A]=[_,y,A,S]),m(this,me,fu).style.color="";const E=(P,L,z)=>{const H=new Array(256),F=(_-y)/z,X=P/255,Y=(L-P)/(255*z);let J=0;for(let ie=0;ie<=z;ie++){const pe=Math.round(y+ie*F),ye=X+ie*Y;for(let be=J;be<=pe;be++)H[be]=ye;J=pe+1}for(let ie=J;ie<256;ie++)H[ie]=H[J-1];return H.join(",")},N=`g_${m(this,Vr)}_hcm_${t}_filter`,R=d.filter=M(this,me,mu).call(this,N);return M(this,me,$_).call(this,R),M(this,me,nf).call(this,E(S[0],A[0],5),E(S[1],A[1],5),E(S[2],A[2],5),R),d.url=M(this,me,pu).call(this,N),d.url}destroy(t=!1){var n,i,a,l;t&&((n=m(this,Rl))!=null&&n.size)||((i=m(this,qr))==null||i.parentNode.parentNode.remove(),C(this,qr,null),(a=m(this,Ku))==null||a.clear(),C(this,Ku,null),(l=m(this,Rl))==null||l.clear(),C(this,Rl,null),C(this,kl,0))}}Nl=new WeakMap,Ku=new WeakMap,qr=new WeakMap,Vr=new WeakMap,In=new WeakMap,Rl=new WeakMap,kl=new WeakMap,me=new WeakSet,Rn=function(){return m(this,Ku)||C(this,Ku,new Map)},ef=function(){return m(this,Rl)||C(this,Rl,new Map)},fu=function(){if(!m(this,qr)){const t=m(this,In).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const i=m(this,In).createElementNS(Mr,"svg");i.setAttribute("width",0),i.setAttribute("height",0),C(this,qr,m(this,In).createElementNS(Mr,"defs")),t.append(i),i.append(m(this,qr)),m(this,In).body.append(t)}return m(this,qr)},qg=function(t){if(t.length===1){const h=t[0],p=new Array(256);for(let _=0;_<256;_++)p[_]=h[_]/255;const y=p.join(",");return[y,y,y]}const[n,i,a]=t,l=new Array(256),c=new Array(256),d=new Array(256);for(let h=0;h<256;h++)l[h]=n[h]/255,c[h]=i[h]/255,d[h]=a[h]/255;return[l.join(","),c.join(","),d.join(",")]},pu=function(t){if(m(this,Nl)===void 0){C(this,Nl,"");const n=m(this,In).URL;n!==m(this,In).baseURI&&(av(n)?Be('#createUrl: ignore "data:"-URL for performance reasons.'):C(this,Nl,n.split("#",1)[0]))}return`url(${m(this,Nl)}#${t})`},LR=function(t){const n=m(this,In).createElementNS(Mr,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},$_=function(t){const n=m(this,In).createElementNS(Mr,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},mu=function(t){const n=m(this,In).createElementNS(Mr,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),m(this,me,fu).append(n),n},tf=function(t,n,i){const a=m(this,In).createElementNS(Mr,n);a.setAttribute("type","discrete"),a.setAttribute("tableValues",i),t.append(a)},nf=function(t,n,i,a){const l=m(this,In).createElementNS(Mr,"feComponentTransfer");a.append(l),M(this,me,tf).call(this,l,"feFuncR",t),M(this,me,tf).call(this,l,"feFuncG",n),M(this,me,tf).call(this,l,"feFuncB",i)},Y_=function(t,n){const i=m(this,In).createElementNS(Mr,"feComponentTransfer");n.append(i),M(this,me,tf).call(this,i,"feFuncA",t)},sf=function(t){return m(this,me,fu).style.color=t,fw(getComputedStyle(m(this,me,fu)).getPropertyValue("color"))};class OR{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){bt("Abstract method `_fetch` called.")}}class UR extends OR{async _fetch(e){const t=await rv(e,"arraybuffer");return new Uint8Array(t)}}Un&&Be("Please use the `legacy` build in Node.js environments.");async function FR(s){const t=await process.getBuiltinModule("fs").promises.readFile(s);return new Uint8Array(t)}class H5 extends PR{}class B5 extends MR{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class G5 extends IR{async _fetch(e){return FR(e)}}class q5 extends OR{async _fetch(e){return FR(e)}}const On={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function K_(s,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,n),s.clip(i)}class mw{getPattern(){bt("Abstract method `getPattern` called.")}}class V5 extends mw{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,i){let a;if(i===On.STROKE||i===On.FILL){const l=t.current.getClippedPathBoundingBox(i,Ct(e))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,d=Math.ceil(l[3]-l[1])||1,h=t.cachedCanvases.getCanvas("pattern",c,d),p=h.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),n=Ce.transform(n,[1,0,0,1,l[0],l[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),K_(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=e.createPattern(h.canvas,"no-repeat");const y=new DOMMatrix(n);a.setTransform(y)}else K_(e,this._bbox),a=this._createGradient(e);return a}}function n_(s,e,t,n,i,a,l,c){const d=e.coords,h=e.colors,p=s.data,y=s.width*4;let _;d[t+1]>d[n+1]&&(_=t,t=n,n=_,_=a,a=l,l=_),d[n+1]>d[i+1]&&(_=n,n=i,i=_,_=l,l=c,c=_),d[t+1]>d[n+1]&&(_=t,t=n,n=_,_=a,a=l,l=_);const S=(d[t]+e.offsetX)*e.scaleX,A=(d[t+1]+e.offsetY)*e.scaleY,E=(d[n]+e.offsetX)*e.scaleX,N=(d[n+1]+e.offsetY)*e.scaleY,R=(d[i]+e.offsetX)*e.scaleX,D=(d[i+1]+e.offsetY)*e.scaleY;if(A>=D)return;const P=h[a],L=h[a+1],z=h[a+2],H=h[l],F=h[l+1],X=h[l+2],Y=h[c],J=h[c+1],ie=h[c+2],pe=Math.round(A),ye=Math.round(D);let be,Se,j,G,ae,we,Ne,U;for(let Q=pe;Q<=ye;Q++){if(Q<N){const de=Q<A?0:(A-Q)/(A-N);be=S-(S-E)*de,Se=P-(P-H)*de,j=L-(L-F)*de,G=z-(z-X)*de}else{let de;Q>D?de=1:N===D?de=0:de=(N-Q)/(N-D),be=E-(E-R)*de,Se=H-(H-Y)*de,j=F-(F-J)*de,G=X-(X-ie)*de}let re;Q<A?re=0:Q>D?re=1:re=(A-Q)/(A-D),ae=S-(S-R)*re,we=P-(P-Y)*re,Ne=L-(L-J)*re,U=z-(z-ie)*re;const ne=Math.round(Math.min(be,ae)),fe=Math.round(Math.max(be,ae));let ge=y*Q+ne*4;for(let de=ne;de<=fe;de++)re=(be-de)/(be-ae),re<0?re=0:re>1&&(re=1),p[ge++]=Se-(Se-we)*re|0,p[ge++]=j-(j-Ne)*re|0,p[ge++]=G-(G-U)*re|0,p[ge++]=255}}function $5(s,e,t){const n=e.coords,i=e.colors;let a,l;switch(e.type){case"lattice":const c=e.verticesPerRow,d=Math.floor(n.length/c)-1,h=c-1;for(a=0;a<d;a++){let p=a*c;for(let y=0;y<h;y++,p++)n_(s,t,n[p],n[p+1],n[p+c],i[p],i[p+1],i[p+c]),n_(s,t,n[p+c+1],n[p+1],n[p+c],i[p+c+1],i[p+1],i[p+c])}break;case"triangles":for(a=0,l=n.length;a<l;a+=3)n_(s,t,n[a],n[a+1],n[a+2],i[a],i[a+1],i[a+2]);break;default:throw new Error("illegal figure")}}class Y5 extends mw{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-c,p=Math.ceil(this._bounds[3])-d,y=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),_=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),S=h/y,A=p/_,E={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-d,scaleX:1/S,scaleY:1/A},N=y+4,R=_+4,D=n.getCanvas("mesh",N,R),P=D.context,L=P.createImageData(y,_);if(t){const H=L.data;for(let F=0,X=H.length;F<X;F+=4)H[F]=t[0],H[F+1]=t[1],H[F+2]=t[2],H[F+3]=255}for(const H of this._figures)$5(L,H,E);return P.putImageData(L,2,2),{canvas:D.canvas,offsetX:c-2*S,offsetY:d-2*A,scaleX:S,scaleY:A}}getPattern(e,t,n,i){K_(e,this._bbox);let a;if(i===On.SHADING)a=Ce.singularValueDecompose2dScale(Ct(e));else if(a=Ce.singularValueDecompose2dScale(t.baseTransform),this.matrix){const c=Ce.singularValueDecompose2dScale(this.matrix);a=[a[0]*c[0],a[1]*c[1]]}const l=this._createMeshCanvas(a,i===On.SHADING?null:this._background,t.cachedCanvases);return i!==On.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class K5 extends mw{getPattern(){return"hotpink"}}function X5(s){switch(s[0]){case"RadialAxial":return new V5(s);case"Mesh":return new Y5(s);case"Dummy":return new K5}throw new Error(`Unknown IR type: ${s[0]}`)}const yT={COLORED:1,UNCOLORED:2},j0=class j0{constructor(e,t,n,i,a){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=n,this.canvasGraphicsFactory=i,this.baseTransform=a}createPatternCanvas(e){const{bbox:t,operatorList:n,paintType:i,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:d,ystep:h}=this;d=Math.abs(d),h=Math.abs(h),sv("TilingType: "+a);const p=t[0],y=t[1],_=t[2],S=t[3],A=_-p,E=S-y,N=Ce.singularValueDecompose2dScale(this.matrix),R=Ce.singularValueDecompose2dScale(this.baseTransform),D=N[0]*R[0],P=N[1]*R[1];let L=A,z=E,H=!1,F=!1;const X=Math.ceil(d*D),Y=Math.ceil(h*P),J=Math.ceil(A*D),ie=Math.ceil(E*P);X>=J?L=d:H=!0,Y>=ie?z=h:F=!0;const pe=this.getSizeAndScale(L,this.ctx.canvas.width,D),ye=this.getSizeAndScale(z,this.ctx.canvas.height,P),be=e.cachedCanvases.getCanvas("pattern",pe.size,ye.size),Se=be.context,j=c.createCanvasGraphics(Se);if(j.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(j,i,l),Se.translate(-pe.scale*p,-ye.scale*y),j.transform(pe.scale,0,0,ye.scale,0,0),Se.save(),this.clipBbox(j,p,y,_,S),j.baseTransform=Ct(j.ctx),j.executeOperatorList(n),j.endDrawing(),Se.restore(),H||F){const G=be.canvas;H&&(L=d),F&&(z=h);const ae=this.getSizeAndScale(L,this.ctx.canvas.width,D),we=this.getSizeAndScale(z,this.ctx.canvas.height,P),Ne=ae.size,U=we.size,Q=e.cachedCanvases.getCanvas("pattern-workaround",Ne,U),re=Q.context,ne=H?Math.floor(A/d):0,fe=F?Math.floor(E/h):0;for(let ge=0;ge<=ne;ge++)for(let de=0;de<=fe;de++)re.drawImage(G,Ne*ge,U*de,Ne,U,0,0,Ne,U);return{canvas:Q.canvas,scaleX:ae.scale,scaleY:we.scale,offsetX:p,offsetY:y}}return{canvas:be.canvas,scaleX:pe.scale,scaleY:ye.scale,offsetX:p,offsetY:y}}getSizeAndScale(e,t,n){const i=Math.max(j0.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*n);return a>=i?a=i:n=a/e,{scale:n,size:a}}clipBbox(e,t,n,i,a){const l=i-t,c=a-n;e.ctx.rect(t,n,l,c),e.current.updateRectMinMax(Ct(e.ctx),[t,n,i,a]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const i=e.ctx,a=e.current;switch(t){case yT.COLORED:const l=this.ctx;i.fillStyle=l.fillStyle,i.strokeStyle=l.strokeStyle,a.fillColor=l.fillStyle,a.strokeColor=l.strokeStyle;break;case yT.UNCOLORED:const c=Ce.makeHexColor(n[0],n[1],n[2]);i.fillStyle=c,i.strokeStyle=c,a.fillColor=c,a.strokeColor=c;break;default:throw new x5(`Unsupported paint type: ${t}`)}}getPattern(e,t,n,i){let a=n;i!==On.SHADING&&(a=Ce.transform(a,t.baseTransform),this.matrix&&(a=Ce.transform(a,this.matrix)));const l=this.createPatternCanvas(t);let c=new DOMMatrix(a);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const d=e.createPattern(l.canvas,"repeat");return d.setTransform(c),d}};Me(j0,"MAX_PATTERN_SIZE",3e3);let X_=j0;function J5({src:s,srcPos:e=0,dest:t,width:n,height:i,nonBlackColor:a=4294967295,inverseDecode:l=!1}){const c=Xn.isLittleEndian?4278190080:255,[d,h]=l?[a,c]:[c,a],p=n>>3,y=n&7,_=s.length;t=new Uint32Array(t.buffer);let S=0;for(let A=0;A<i;A++){for(const N=e+p;e<N;e++){const R=e<_?s[e]:255;t[S++]=R&128?h:d,t[S++]=R&64?h:d,t[S++]=R&32?h:d,t[S++]=R&16?h:d,t[S++]=R&8?h:d,t[S++]=R&4?h:d,t[S++]=R&2?h:d,t[S++]=R&1?h:d}if(y===0)continue;const E=e<_?s[e++]:255;for(let N=0;N<y;N++)t[S++]=E&1<<7-N?h:d}return{srcPos:e,destPos:S}}const bT=16,_T=100,W5=15,xT=10,wT=1e3,ps=16;function Q5(s,e){if(s._removeMirroring)throw new Error("Context is already forwarding operations.");s.__originalSave=s.save,s.__originalRestore=s.restore,s.__originalRotate=s.rotate,s.__originalScale=s.scale,s.__originalTranslate=s.translate,s.__originalTransform=s.transform,s.__originalSetTransform=s.setTransform,s.__originalResetTransform=s.resetTransform,s.__originalClip=s.clip,s.__originalMoveTo=s.moveTo,s.__originalLineTo=s.lineTo,s.__originalBezierCurveTo=s.bezierCurveTo,s.__originalRect=s.rect,s.__originalClosePath=s.closePath,s.__originalBeginPath=s.beginPath,s._removeMirroring=()=>{s.save=s.__originalSave,s.restore=s.__originalRestore,s.rotate=s.__originalRotate,s.scale=s.__originalScale,s.translate=s.__originalTranslate,s.transform=s.__originalTransform,s.setTransform=s.__originalSetTransform,s.resetTransform=s.__originalResetTransform,s.clip=s.__originalClip,s.moveTo=s.__originalMoveTo,s.lineTo=s.__originalLineTo,s.bezierCurveTo=s.__originalBezierCurveTo,s.rect=s.__originalRect,s.closePath=s.__originalClosePath,s.beginPath=s.__originalBeginPath,delete s._removeMirroring},s.save=function(){e.save(),this.__originalSave()},s.restore=function(){e.restore(),this.__originalRestore()},s.translate=function(n,i){e.translate(n,i),this.__originalTranslate(n,i)},s.scale=function(n,i){e.scale(n,i),this.__originalScale(n,i)},s.transform=function(n,i,a,l,c,d){e.transform(n,i,a,l,c,d),this.__originalTransform(n,i,a,l,c,d)},s.setTransform=function(n,i,a,l,c,d){e.setTransform(n,i,a,l,c,d),this.__originalSetTransform(n,i,a,l,c,d)},s.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},s.rotate=function(n){e.rotate(n),this.__originalRotate(n)},s.clip=function(n){e.clip(n),this.__originalClip(n)},s.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},s.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},s.bezierCurveTo=function(t,n,i,a,l,c){e.bezierCurveTo(t,n,i,a,l,c),this.__originalBezierCurveTo(t,n,i,a,l,c)},s.rect=function(t,n,i,a){e.rect(t,n,i,a),this.__originalRect(t,n,i,a)},s.closePath=function(){e.closePath(),this.__originalClosePath()},s.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Z5{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Tg(s,e,t,n,i,a,l,c,d,h){const[p,y,_,S,A,E]=Ct(s);if(y===0&&_===0){const D=l*p+A,P=Math.round(D),L=c*S+E,z=Math.round(L),H=(l+d)*p+A,F=Math.abs(Math.round(H)-P)||1,X=(c+h)*S+E,Y=Math.abs(Math.round(X)-z)||1;return s.setTransform(Math.sign(p),0,0,Math.sign(S),P,z),s.drawImage(e,t,n,i,a,0,0,F,Y),s.setTransform(p,y,_,S,A,E),[F,Y]}if(p===0&&S===0){const D=c*_+A,P=Math.round(D),L=l*y+E,z=Math.round(L),H=(c+h)*_+A,F=Math.abs(Math.round(H)-P)||1,X=(l+d)*y+E,Y=Math.abs(Math.round(X)-z)||1;return s.setTransform(0,Math.sign(y),Math.sign(_),0,P,z),s.drawImage(e,t,n,i,a,0,0,Y,F),s.setTransform(p,y,_,S,A,E),[Y,F]}s.drawImage(e,t,n,i,a,l,c,d,h);const N=Math.hypot(p,y),R=Math.hypot(_,S);return[N*d,R*h]}function e4(s){const{width:e,height:t}=s;if(e>wT||t>wT)return null;const n=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),a=e+1;let l=new Uint8Array(a*(t+1)),c,d,h;const p=e+7&-8;let y=new Uint8Array(p*t),_=0;for(const R of s.data){let D=128;for(;D>0;)y[_++]=R&D?0:255,D>>=1}let S=0;for(_=0,y[_]!==0&&(l[0]=1,++S),d=1;d<e;d++)y[_]!==y[_+1]&&(l[d]=y[_]?2:1,++S),_++;for(y[_]!==0&&(l[d]=2,++S),c=1;c<t;c++){_=c*p,h=c*a,y[_-p]!==y[_]&&(l[h]=y[_]?1:8,++S);let R=(y[_]?4:0)+(y[_-p]?8:0);for(d=1;d<e;d++)R=(R>>2)+(y[_+1]?4:0)+(y[_-p+1]?8:0),i[R]&&(l[h+d]=i[R],++S),_++;if(y[_-p]!==y[_]&&(l[h+d]=y[_]?2:4,++S),S>n)return null}for(_=p*(t-1),h=c*a,y[_]!==0&&(l[h]=8,++S),d=1;d<e;d++)y[_]!==y[_+1]&&(l[h+d]=y[_]?4:8,++S),_++;if(y[_]!==0&&(l[h+d]=4,++S),S>n)return null;const A=new Int32Array([0,a,-1,0,-a,0,0,0,1]),E=new Path2D;for(c=0;S&&c<=t;c++){let R=c*a;const D=R+e;for(;R<D&&!l[R];)R++;if(R===D)continue;E.moveTo(R%a,c);const P=R;let L=l[R];do{const z=A[L];do R+=z;while(!l[R]);const H=l[R];H!==5&&H!==10?(L=H,l[R]=0):(L=H&51*L>>4,l[R]&=L>>2|L<<2),E.lineTo(R%a,R/a|0),l[R]||--S}while(P!==R);--c}return y=null,l=null,function(R){R.save(),R.scale(1/e,-1/t),R.translate(0,-t),R.fill(E),R.beginPath(),R.restore()}}class ST{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=KN,this.textMatrixScale=1,this.fontMatrix=S_,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Nn.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=Ce.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){const n=Ce.applyTransform(t,e),i=Ce.applyTransform(t.slice(2),e),a=Ce.applyTransform([t[0],t[3]],e),l=Ce.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,n[0],i[0],a[0],l[0]),this.minY=Math.min(this.minY,n[1],i[1],a[1],l[1]),this.maxX=Math.max(this.maxX,n[0],i[0],a[0],l[0]),this.maxY=Math.max(this.maxY,n[1],i[1],a[1],l[1])}updateScalingPathMinMax(e,t){Ce.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,i,a,l,c,d,h,p){const y=Ce.bezierBoundingBox(t,n,i,a,l,c,d,h,p);p||this.updateRectMinMax(e,y)}getPathBoundingBox(e=On.FILL,t=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(e===On.STROKE){t||bt("Stroke bounding box must include transform.");const i=Ce.singularValueDecompose2dScale(t),a=i[0]*this.lineWidth/2,l=i[1]*this.lineWidth/2;n[0]-=a,n[1]-=l,n[2]+=a,n[3]+=l}return n}updateClipFromPath(){const e=Ce.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=On.FILL,t=null){return Ce.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function AT(s,e){if(e instanceof ImageData){s.putImageData(e,0,0);return}const t=e.height,n=e.width,i=t%ps,a=(t-i)/ps,l=i===0?a:a+1,c=s.createImageData(n,ps);let d=0,h;const p=e.data,y=c.data;let _,S,A,E;if(e.kind===Pg.GRAYSCALE_1BPP){const N=p.byteLength,R=new Uint32Array(y.buffer,0,y.byteLength>>2),D=R.length,P=n+7>>3,L=4294967295,z=Xn.isLittleEndian?4278190080:255;for(_=0;_<l;_++){for(A=_<a?ps:i,h=0,S=0;S<A;S++){const H=N-d;let F=0;const X=H>P?n:H*8-7,Y=X&-8;let J=0,ie=0;for(;F<Y;F+=8)ie=p[d++],R[h++]=ie&128?L:z,R[h++]=ie&64?L:z,R[h++]=ie&32?L:z,R[h++]=ie&16?L:z,R[h++]=ie&8?L:z,R[h++]=ie&4?L:z,R[h++]=ie&2?L:z,R[h++]=ie&1?L:z;for(;F<X;F++)J===0&&(ie=p[d++],J=128),R[h++]=ie&J?L:z,J>>=1}for(;h<D;)R[h++]=0;s.putImageData(c,0,_*ps)}}else if(e.kind===Pg.RGBA_32BPP){for(S=0,E=n*ps*4,_=0;_<a;_++)y.set(p.subarray(d,d+E)),d+=E,s.putImageData(c,0,S),S+=ps;_<l&&(E=n*i*4,y.set(p.subarray(d,d+E)),s.putImageData(c,0,S))}else if(e.kind===Pg.RGB_24BPP)for(A=ps,E=n*A,_=0;_<l;_++){for(_>=a&&(A=i,E=n*A),h=0,S=E;S--;)y[h++]=p[d++],y[h++]=p[d++],y[h++]=p[d++],y[h++]=255;s.putImageData(c,0,_*ps)}else throw new Error(`bad image kind: ${e.kind}`)}function ET(s,e){if(e.bitmap){s.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,i=t%ps,a=(t-i)/ps,l=i===0?a:a+1,c=s.createImageData(n,ps);let d=0;const h=e.data,p=c.data;for(let y=0;y<l;y++){const _=y<a?ps:i;({srcPos:d}=J5({src:h,srcPos:d,dest:p,width:n,height:_,nonBlackColor:0})),s.putImageData(c,0,y*ps)}}function Bh(s,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)s[n]!==void 0&&(e[n]=s[n]);s.setLineDash!==void 0&&(e.setLineDash(s.getLineDash()),e.lineDashOffset=s.lineDashOffset)}function Cg(s){if(s.strokeStyle=s.fillStyle="#000000",s.fillRule="nonzero",s.globalAlpha=1,s.lineWidth=1,s.lineCap="butt",s.lineJoin="miter",s.miterLimit=10,s.globalCompositeOperation="source-over",s.font="10px sans-serif",s.setLineDash!==void 0&&(s.setLineDash([]),s.lineDashOffset=0),!Un){const{filter:e}=s;e!=="none"&&e!==""&&(s.filter="none")}}function TT(s,e){if(e)return!0;const t=Ce.singularValueDecompose2dScale(s);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*Co.PDF_TO_CSS_UNITS);return t[0]<=n&&t[1]<=n}const t4=["butt","round","square"],n4=["miter","round","bevel"],s4={},CT={};var Fi,J_,W_,Q_;const kw=class kw{constructor(e,t,n,i,a,{optionalContentConfig:l,markedContentStack:c=null},d,h){k(this,Fi);this.ctx=e,this.current=new ST(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new Z5(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:i=null}){const a=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,a,l),this.ctx.fillStyle=c,n){const d=this.cachedCanvases.getCanvas("transparent",a,l);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...Ct(this.compositeCtx))}this.ctx.save(),Cg(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ct(this.ctx)}executeOperatorList(e,t,n,i){const a=e.argsArray,l=e.fnArray;let c=t||0;const d=a.length;if(d===c)return c;const h=d-c>xT&&typeof n=="function",p=h?Date.now()+W5:0;let y=0;const _=this.commonObjs,S=this.objs;let A;for(;;){if(i!==void 0&&c===i.nextBreakPoint)return i.breakIt(c,n),c;if(A=l[c],A!==bi.dependency)this[A].apply(this,a[c]);else for(const E of a[c]){const N=E.startsWith("g_")?_:S;if(!N.has(E))return N.get(E,n),c}if(c++,c===d)return c;if(h&&++y>xT){if(Date.now()>p)return n(),c;y=0}}}endDrawing(){M(this,Fi,J_).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),M(this,Fi,W_).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,i=e.height??e.displayHeight;let a=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),c=n,d=i,h="prescale1",p,y;for(;a>2&&c>1||l>2&&d>1;){let _=c,S=d;a>2&&c>1&&(_=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),a/=c/_),l>2&&d>1&&(S=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,l/=d/S),p=this.cachedCanvases.getCanvas(h,_,S),y=p.context,y.clearRect(0,0,_,S),y.drawImage(e,0,0,c,d,0,0,_,S),e=p.canvas,c=_,d=S,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:d}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:i}=e,a=this.current.fillColor,l=this.current.patternFill,c=Ct(t);let d,h,p,y;if((e.bitmap||e.data)&&e.count>1){const X=e.bitmap||e.data.buffer;h=JSON.stringify(l?c:[c.slice(0,4),a]),d=this._cachedBitmapsMap.get(X),d||(d=new Map,this._cachedBitmapsMap.set(X,d));const Y=d.get(h);if(Y&&!l){const J=Math.round(Math.min(c[0],c[2])+c[4]),ie=Math.round(Math.min(c[1],c[3])+c[5]);return{canvas:Y,offsetX:J,offsetY:ie}}p=Y}p||(y=this.cachedCanvases.getCanvas("maskCanvas",n,i),ET(y.context,e));let _=Ce.transform(c,[1/n,0,0,-1/i,0,0]);_=Ce.transform(_,[1,0,0,1,0,-i]);const[S,A,E,N]=Ce.getAxialAlignedBoundingBox([0,0,n,i],_),R=Math.round(E-S)||1,D=Math.round(N-A)||1,P=this.cachedCanvases.getCanvas("fillCanvas",R,D),L=P.context,z=S,H=A;L.translate(-z,-H),L.transform(..._),p||(p=this._scaleImage(y.canvas,Vi(L)),p=p.img,d&&l&&d.set(h,p)),L.imageSmoothingEnabled=TT(Ct(L),e.interpolate),Tg(L,p,0,0,p.width,p.height,0,0,n,i),L.globalCompositeOperation="source-in";const F=Ce.transform(Vi(L),[1,0,0,1,-z,-H]);return L.fillStyle=l?a.getPattern(t,this,F,On.FILL):a,L.fillRect(0,0,n,i),d&&!l&&(this.cachedCanvases.delete("fillCanvas"),d.set(h,P.canvas)),{canvas:P.canvas,offsetX:Math.round(z),offsetY:Math.round(H)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=t4[e]}setLineJoin(e){this.ctx.lineJoin=n4[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const a=this.ctx;a.setTransform(...Ct(this.suspendedCtx)),Bh(this.suspendedCtx,a),Q5(a,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Bh(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){const a=i[0],l=i[1],c=i[2]-a,d=i[3]-l;c===0||d===0||(this.genericComposeSMask(t.context,n,c,d,t.subtype,t.backdrop,t.transferMap,a,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,a,l,c,d,h,p,y){let _=e.canvas,S=d-p,A=h-y;if(l){const N=Ce.makeHexColor(...l);if(S<0||A<0||S+n>_.width||A+i>_.height){const R=this.cachedCanvases.getCanvas("maskExtension",n,i),D=R.context;D.drawImage(_,-S,-A),D.globalCompositeOperation="destination-atop",D.fillStyle=N,D.fillRect(0,0,n,i),D.globalCompositeOperation="source-over",_=R.canvas,S=A=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const R=new Path2D;R.rect(S,A,n,i),e.clip(R),e.globalCompositeOperation="destination-atop",e.fillStyle=N,e.fillRect(S,A,n,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),a==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):a==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const E=new Path2D;E.rect(d,h,n,i),t.clip(E),t.globalCompositeOperation="destination-in",t.drawImage(_,S,A,n,i,d,h,n,i),t.restore()}save(){this.inSMaskMode?(Bh(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Bh(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,i,a,l){this.ctx.transform(e,t,n,i,a,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){const i=this.ctx,a=this.current;let l=a.x,c=a.y,d,h;const p=Ct(i),y=p[0]===0&&p[3]===0||p[1]===0&&p[2]===0,_=y?n.slice(0):null;for(let S=0,A=0,E=e.length;S<E;S++)switch(e[S]|0){case bi.rectangle:l=t[A++],c=t[A++];const N=t[A++],R=t[A++],D=l+N,P=c+R;i.moveTo(l,c),N===0||R===0?i.lineTo(D,P):(i.lineTo(D,c),i.lineTo(D,P),i.lineTo(l,P)),y||a.updateRectMinMax(p,[l,c,D,P]),i.closePath();break;case bi.moveTo:l=t[A++],c=t[A++],i.moveTo(l,c),y||a.updatePathMinMax(p,l,c);break;case bi.lineTo:l=t[A++],c=t[A++],i.lineTo(l,c),y||a.updatePathMinMax(p,l,c);break;case bi.curveTo:d=l,h=c,l=t[A+4],c=t[A+5],i.bezierCurveTo(t[A],t[A+1],t[A+2],t[A+3],l,c),a.updateCurvePathMinMax(p,d,h,t[A],t[A+1],t[A+2],t[A+3],l,c,_),A+=6;break;case bi.curveTo2:d=l,h=c,i.bezierCurveTo(l,c,t[A],t[A+1],t[A+2],t[A+3]),a.updateCurvePathMinMax(p,d,h,l,c,t[A],t[A+1],t[A+2],t[A+3],_),l=t[A+2],c=t[A+3],A+=4;break;case bi.curveTo3:d=l,h=c,l=t[A+2],c=t[A+3],i.bezierCurveTo(t[A],t[A+1],l,c,l,c),a.updateCurvePathMinMax(p,d,h,t[A],t[A+1],l,c,l,c,_),A+=4;break;case bi.closePath:i.closePath();break}y&&a.updateScalingPathMinMax(p,_),a.setCurrentPoint(l,c)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&(n!=null&&n.getPattern)?(t.save(),t.strokeStyle=n.getPattern(t,this,Vi(t),On.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,n=this.current.fillColor,i=this.current.patternFill;let a=!1;i&&(t.save(),t.fillStyle=n.getPattern(t,this,Vi(t),On.FILL),a=!0);const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),a&&t.restore(),e&&this.consumePath(l)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=s4}eoClip(){this.pendingClip=CT}beginText(){this.current.textMatrix=KN,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const n=new Path2D,i=t.getTransform().invertSelf();for(const{transform:a,x:l,y:c,fontSize:d,path:h}of e)n.addPath(h,new DOMMatrix(a).preMultiplySelf(i).translate(l,c).scale(d,-d));t.clip(n),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var p;const n=this.commonObjs.get(e),i=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=n.fontMatrix||S_,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Be("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const a=n.loadedName||"sans-serif",l=((p=n.systemFontInfo)==null?void 0:p.css)||`"${a}", ${n.fallbackName}`;let c="normal";n.black?c="900":n.bold&&(c="bold");const d=n.italic?"italic":"normal";let h=t;t<bT?h=bT:t>_T&&(h=_T),this.current.fontSizeScale=t/h,this.ctx.font=`${d} ${c} ${h}px ${l}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,i,a,l){this.current.textMatrix=[e,t,n,i,a,l],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,i,a){const l=this.ctx,c=this.current,d=c.font,h=c.textRenderingMode,p=c.fontSize/c.fontSizeScale,y=h&Nn.FILL_STROKE_MASK,_=!!(h&Nn.ADD_TO_PATH_FLAG),S=c.patternFill&&!d.missingFile,A=c.patternStroke&&!d.missingFile;let E;if((d.disableFontFace||_||S||A)&&(E=d.getPathGenerator(this.commonObjs,e)),d.disableFontFace||S||A){if(l.save(),l.translate(t,n),l.scale(p,-p),y===Nn.FILL||y===Nn.FILL_STROKE)if(i){const N=l.getTransform();l.setTransform(...i),l.fill(M(this,Fi,Q_).call(this,E,N,i))}else l.fill(E);if(y===Nn.STROKE||y===Nn.FILL_STROKE)if(a){const N=l.getTransform();l.setTransform(...a),l.stroke(M(this,Fi,Q_).call(this,E,N,a))}else l.lineWidth/=p,l.stroke(E);l.restore()}else(y===Nn.FILL||y===Nn.FILL_STROKE)&&l.fillText(e,t,n),(y===Nn.STROKE||y===Nn.FILL_STROKE)&&l.strokeText(e,t,n);_&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ct(l),x:t,y:n,fontSize:p,path:E})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return $e(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const a=this.ctx,l=t.fontSizeScale,c=t.charSpacing,d=t.wordSpacing,h=t.fontDirection,p=t.textHScale*h,y=e.length,_=n.vertical,S=_?1:-1,A=n.defaultVMetrics,E=i*t.fontMatrix[0],N=t.textRenderingMode===Nn.FILL&&!n.disableFontFace&&!t.patternFill;a.save(),a.transform(...t.textMatrix),a.translate(t.x,t.y+t.textRise),h>0?a.scale(p,-1):a.scale(p,1);let R,D;if(t.patternFill){a.save();const F=t.fillColor.getPattern(a,this,Vi(a),On.FILL);R=Ct(a),a.restore(),a.fillStyle=F}if(t.patternStroke){a.save();const F=t.strokeColor.getPattern(a,this,Vi(a),On.STROKE);D=Ct(a),a.restore(),a.strokeStyle=F}let P=t.lineWidth;const L=t.textMatrixScale;if(L===0||P===0){const F=t.textRenderingMode&Nn.FILL_STROKE_MASK;(F===Nn.STROKE||F===Nn.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=L;if(l!==1&&(a.scale(l,l),P/=l),a.lineWidth=P,n.isInvalidPDFjsFont){const F=[];let X=0;for(const Y of e)F.push(Y.unicode),X+=Y.width;a.fillText(F.join(""),0,0),t.x+=X*E*p,a.restore(),this.compose();return}let z=0,H;for(H=0;H<y;++H){const F=e[H];if(typeof F=="number"){z+=S*F*i/1e3;continue}let X=!1;const Y=(F.isSpace?d:0)+c,J=F.fontChar,ie=F.accent;let pe,ye,be=F.width;if(_){const j=F.vmetric||A,G=-(F.vmetric?j[1]:be*.5)*E,ae=j[2]*E;be=j?-j[0]:be,pe=G/l,ye=(z+ae)/l}else pe=z/l,ye=0;if(n.remeasure&&be>0){const j=a.measureText(J).width*1e3/i*l;if(be<j&&this.isFontSubpixelAAEnabled){const G=be/j;X=!0,a.save(),a.scale(G,1),pe/=G}else be!==j&&(pe+=(be-j)/2e3*i/l)}if(this.contentVisible&&(F.isInFont||n.missingFile)){if(N&&!ie)a.fillText(J,pe,ye);else if(this.paintChar(J,pe,ye,R,D),ie){const j=pe+i*ie.offset.x/l,G=ye-i*ie.offset.y/l;this.paintChar(ie.fontChar,j,G,R,D)}}const Se=_?be*E-Y*h:be*E+Y*h;z+=Se,X&&a.restore()}_?t.y-=z:t.x+=z*p,a.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,i=n.font,a=n.fontSize,l=n.fontDirection,c=i.vertical?1:-1,d=n.charSpacing,h=n.wordSpacing,p=n.textHScale*l,y=n.fontMatrix||S_,_=e.length,S=n.textRenderingMode===Nn.INVISIBLE;let A,E,N,R;if(!(S||a===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(p,l),A=0;A<_;++A){if(E=e[A],typeof E=="number"){R=c*E*a/1e3,this.ctx.translate(R,0),n.x+=R*p;continue}const D=(E.isSpace?h:0)+d,P=i.charProcOperatorList[E.operatorListId];if(!P){Be(`Type3 character "${E.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=E,this.save(),t.scale(a,a),t.transform(...y),this.executeOperatorList(P),this.restore()),N=Ce.applyTransform([E.width,0],y)[0]*a+D,t.translate(N,0),n.x+=N*p}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,i,a,l){this.ctx.rect(n,i,a-n,l-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const n=e[1],i=this.baseTransform||Ct(this.ctx),a={createCanvasGraphics:l=>new kw(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new X_(e,n,this.ctx,a,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){this.ctx.strokeStyle=this.current.strokeColor=Ce.makeHexColor(e,t,n),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,n){this.ctx.fillStyle=this.current.fillColor=Ce.makeHexColor(e,t,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=X5(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,Vi(t),On.SHADING);const i=Vi(t);if(i){const{width:a,height:l}=t.canvas,[c,d,h,p]=Ce.getAxialAlignedBoundingBox([0,0,a,l],i);this.ctx.fillRect(c,d,h-c,p-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){bt("Should not call beginInlineImage")}beginImageData(){bt("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Ct(this.ctx),t)){const n=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],n,i),this.current.updateRectMinMax(Ct(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||sv("TODO: Support non-isolated groups."),e.knockout&&Be("Knockout groups not supported.");const n=Ct(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=Ce.getAxialAlignedBoundingBox(e.bbox,Ct(t));const a=[0,0,t.canvas.width,t.canvas.height];i=Ce.intersect(i,a)||[0,0,0,0];const l=Math.floor(i[0]),c=Math.floor(i[1]),d=Math.max(Math.ceil(i[2])-l,1),h=Math.max(Math.ceil(i[3])-c,1);this.current.startNewPathAndClipBox([0,0,d,h]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const y=this.cachedCanvases.getCanvas(p,d,h),_=y.context;_.translate(-l,-c),_.transform(...n),e.smask?this.smaskStack.push({canvas:y.canvas,context:_,offsetX:l,offsetY:c,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(l,c),t.save()),Bh(t,_),this.ctx=_,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Ct(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const a=Ce.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,n,i,a){if(M(this,Fi,J_).call(this),Cg(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const l=t[2]-t[0],c=t[3]-t[1];if(a&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=l,t[3]=c;const[d,h]=Ce.singularValueDecompose2dScale(Ct(this.ctx)),{viewportScale:p}=this,y=Math.ceil(l*this.outputScaleX*p),_=Math.ceil(c*this.outputScaleY*p);this.annotationCanvas=this.canvasFactory.create(y,_);const{canvas:S,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(e,S),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(d,0,0,-h,0,c*h),Cg(this.ctx)}else Cg(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],l,c),this.ctx.clip(),this.ctx.beginPath()}this.current=new ST(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),M(this,Fi,W_).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const n=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=e4(e)),i.compiled)){i.compiled(n);return}const a=this._createMaskCanvas(e),l=a.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(l,a.offsetX,a.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,i=0,a,l){if(!this.contentVisible)return;e=this.getObject(e.data,e);const c=this.ctx;c.save();const d=Ct(c);c.transform(t,n,i,a,0,0);const h=this._createMaskCanvas(e);c.setTransform(1,0,0,1,h.offsetX-d[4],h.offsetY-d[5]);for(let p=0,y=l.length;p<y;p+=2){const _=Ce.transform(d,[t,n,i,a,l[p],l[p+1]]),[S,A]=Ce.applyTransform([0,0],_);c.drawImage(h.canvas,S,A)}c.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const a of e){const{data:l,width:c,height:d,transform:h}=a,p=this.cachedCanvases.getCanvas("maskCanvas",c,d),y=p.context;y.save();const _=this.getObject(l,a);ET(y,_),y.globalCompositeOperation="source-in",y.fillStyle=i?n.getPattern(y,this,Vi(t),On.FILL):n,y.fillRect(0,0,c,d),y.restore(),t.save(),t.transform(...h),t.scale(1,-1),Tg(t,p.canvas,0,0,c,d,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Be("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,i){if(!this.contentVisible)return;const a=this.getObject(e);if(!a){Be("Dependent image isn't ready yet");return}const l=a.width,c=a.height,d=[];for(let h=0,p=i.length;h<p;h+=2)d.push({transform:[t,0,0,n,i[h],i[h+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(a,d)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:i}=e,a=this.cachedCanvases.getCanvas("inlineImage",n,i),l=a.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",a.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,i=this.ctx;if(this.save(),!Un){const{filter:c}=i;c!=="none"&&c!==""&&(i.filter="none")}i.scale(1/t,-1/n);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const d=this.cachedCanvases.getCanvas("inlineImage",t,n).context;AT(d,e),a=this.applyTransferMapsToCanvas(d)}const l=this._scaleImage(a,Vi(i));i.imageSmoothingEnabled=TT(Ct(i),e.interpolate),Tg(i,l.img,0,0,l.paintWidth,l.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const a=e.width,l=e.height,d=this.cachedCanvases.getCanvas("inlineImage",a,l).context;AT(d,e),i=this.applyTransferMapsToCanvas(d)}for(const a of t)n.save(),n.transform(...a.transform),n.scale(1,-1),Tg(n,i,a.x,a.y,a.w,a.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const n=this.ctx;this.pendingClip&&(t||(this.pendingClip===CT?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ct(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:a}=this.ctx.getTransform();let l,c;if(n===0&&i===0){const d=Math.abs(t),h=Math.abs(a);if(d===h)if(e===0)l=c=1/d;else{const p=d*e;l=c=p<1?1/p:1}else if(e===0)l=1/d,c=1/h;else{const p=d*e,y=h*e;l=p<1?1/p:1,c=y<1?1/y:1}}else{const d=Math.abs(t*a-n*i),h=Math.hypot(t,n),p=Math.hypot(i,a);if(e===0)l=p/d,c=h/d;else{const y=e*d;l=p>y?p/y:1,c=h>y?h/y:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:n}=this.current,[i,a]=this.getScaleForStroking();if(t.lineWidth=n||1,i===1&&a===1){t.stroke();return}const l=t.getLineDash();if(e&&t.save(),t.scale(i,a),l.length>0){const c=Math.max(i,a);t.setLineDash(l.map(d=>d/c)),t.lineDashOffset/=c}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Fi=new WeakSet,J_=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},W_=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Q_=function(e,t,n){const i=new Path2D;return i.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),i};let Nu=kw;for(const s in bi)Nu.prototype[s]!==void 0&&(Nu.prototype[bi[s]]=Nu.prototype[s]);var ep,tp;class la{static get workerPort(){return m(this,ep)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");C(this,ep,e)}static get workerSrc(){return m(this,tp)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");C(this,tp,e)}}ep=new WeakMap,tp=new WeakMap,k(la,ep,null),k(la,tp,"");var Ml,np;class i4{constructor({parsedData:e,rawData:t}){k(this,Ml);k(this,np);C(this,Ml,e),C(this,np,t)}getRaw(){return m(this,np)}get(e){return m(this,Ml).get(e)??null}getAll(){return lw(m(this,Ml))}has(e){return m(this,Ml).has(e)}}Ml=new WeakMap,np=new WeakMap;const gu=Symbol("INTERNAL");var sp,ip,rp,Xu;class r4{constructor(e,{name:t,intent:n,usage:i,rbGroups:a}){k(this,sp,!1);k(this,ip,!1);k(this,rp,!1);k(this,Xu,!0);C(this,sp,!!(e&Us.DISPLAY)),C(this,ip,!!(e&Us.PRINT)),this.name=t,this.intent=n,this.usage=i,this.rbGroups=a}get visible(){if(m(this,rp))return m(this,Xu);if(!m(this,Xu))return!1;const{print:e,view:t}=this.usage;return m(this,sp)?(t==null?void 0:t.viewState)!=="OFF":m(this,ip)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==gu&&bt("Internal method `_setVisible` called."),C(this,rp,n),C(this,Xu,t)}}sp=new WeakMap,ip=new WeakMap,rp=new WeakMap,Xu=new WeakMap;var ao,dt,Ju,Wu,ap,Z_;class a4{constructor(e,t=Us.DISPLAY){k(this,ap);k(this,ao,null);k(this,dt,new Map);k(this,Ju,null);k(this,Wu,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,C(this,Wu,e.order);for(const n of e.groups)m(this,dt).set(n.id,new r4(t,n));if(e.baseState==="OFF")for(const n of m(this,dt).values())n._setVisible(gu,!1);for(const n of e.on)m(this,dt).get(n)._setVisible(gu,!0);for(const n of e.off)m(this,dt).get(n)._setVisible(gu,!1);C(this,Ju,this.getHash())}}isVisible(e){if(m(this,dt).size===0)return!0;if(!e)return sv("Optional content group not defined."),!0;if(e.type==="OCG")return m(this,dt).has(e.id)?m(this,dt).get(e.id).visible:(Be(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return M(this,ap,Z_).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!m(this,dt).has(t))return Be(`Optional content group not found: ${t}`),!0;if(m(this,dt).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!m(this,dt).has(t))return Be(`Optional content group not found: ${t}`),!0;if(!m(this,dt).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!m(this,dt).has(t))return Be(`Optional content group not found: ${t}`),!0;if(!m(this,dt).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!m(this,dt).has(t))return Be(`Optional content group not found: ${t}`),!0;if(m(this,dt).get(t).visible)return!1}return!0}return Be(`Unknown optional content policy ${e.policy}.`),!0}return Be(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var a;const i=m(this,dt).get(e);if(!i){Be(`Optional content group not found: ${e}`);return}if(n&&t&&i.rbGroups.length)for(const l of i.rbGroups)for(const c of l)c!==e&&((a=m(this,dt).get(c))==null||a._setVisible(gu,!1,!0));i._setVisible(gu,!!t,!0),C(this,ao,null)}setOCGState({state:e,preserveRB:t}){let n;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const a=m(this,dt).get(i);if(a)switch(n){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!a.visible,t);break}}C(this,ao,null)}get hasInitialVisibility(){return m(this,Ju)===null||this.getHash()===m(this,Ju)}getOrder(){return m(this,dt).size?m(this,Wu)?m(this,Wu).slice():[...m(this,dt).keys()]:null}getGroups(){return m(this,dt).size>0?lw(m(this,dt)):null}getGroup(e){return m(this,dt).get(e)||null}getHash(){if(m(this,ao)!==null)return m(this,ao);const e=new ER;for(const[t,n]of m(this,dt))e.update(`${t}:${n.visible}`);return C(this,ao,e.hexdigest())}}ao=new WeakMap,dt=new WeakMap,Ju=new WeakMap,Wu=new WeakMap,ap=new WeakSet,Z_=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let i=1;i<t;i++){const a=e[i];let l;if(Array.isArray(a))l=M(this,ap,Z_).call(this,a);else if(m(this,dt).has(a))l=m(this,dt).get(a).visible;else return Be(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"};class o4{constructor(e,{disableRange:t=!1,disableStream:n=!1}){Xt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:a,progressiveDone:l,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,(a==null?void 0:a.length)>0){const d=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((d,h)=>{this._onReceiveData({begin:d,chunk:h})}),e.addProgressListener((d,h)=>{this._onProgress({loaded:d,total:h})}),e.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(a){return a._begin!==e?!1:(a._enqueue(n),!0)});Xt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,n,i,a;e.total===void 0?(n=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||n.call(t,{loaded:e.loaded}):(a=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||a.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Xt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new l4(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new c4(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class l4{constructor(e,t,n=!1,i=null){this._stream=e,this._done=n||!1,this._filename=dw(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class c4{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function u4(s){let e=!0,t=n("filename\\*","i").exec(s);if(t){t=t[1];let p=c(t);return p=unescape(p),p=d(p),p=h(p),a(p)}if(t=l(s),t){const p=h(t);return a(p)}if(t=n("filename","i").exec(s),t){t=t[1];let p=c(t);return p=h(p),a(p)}function n(p,y){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function i(p,y){if(p){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const _=new TextDecoder(p,{fatal:!0}),S=iv(y);y=_.decode(S),e=!1}catch{}}return y}function a(p){return e&&/[\x80-\xff]/.test(p)&&(p=i("utf-8",p),e&&(p=i("iso-8859-1",p))),p}function l(p){const y=[];let _;const S=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(_=S.exec(p))!==null;){let[,E,N,R]=_;if(E=parseInt(E,10),E in y){if(E===0)break;continue}y[E]=[N,R]}const A=[];for(let E=0;E<y.length&&E in y;++E){let[N,R]=y[E];R=c(R),N&&(R=unescape(R),E===0&&(R=d(R))),A.push(R)}return A.join("")}function c(p){if(p.startsWith('"')){const y=p.slice(1).split('\\"');for(let _=0;_<y.length;++_){const S=y[_].indexOf('"');S!==-1&&(y[_]=y[_].slice(0,S),y.length=_+1),y[_]=y[_].replaceAll(/\\(.)/g,"$1")}p=y.join('"')}return p}function d(p){const y=p.indexOf("'");if(y===-1)return p;const _=p.slice(0,y),A=p.slice(y+1).replace(/^[^']*'/,"");return i(_,A)}function h(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,_,S,A){if(S==="q"||S==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(E,N){return String.fromCharCode(parseInt(N,16))}),i(_,A);try{A=atob(A)}catch{}return i(_,A)})}return""}function jR(s,e){const t=new Headers;if(!s||!e||typeof e!="object")return t;for(const n in e){const i=e[n];i!==void 0&&t.append(n,i)}return t}function ov(s){try{return new URL(s).origin}catch{}return null}function zR({responseHeaders:s,isHttp:e,rangeChunkSize:t,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(s.get("Content-Length"),10);return!Number.isInteger(a)||(i.suggestedLength=a,a<=2*t)||n||!e||s.get("Accept-Ranges")!=="bytes"||(s.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function HR(s){const e=s.get("Content-Disposition");if(e){let t=u4(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(dw(t))return t}return null}function lv(s,e){return s===404||s===0&&e.startsWith("file:")?new Sf('Missing PDF "'+e+'".'):new y0(`Unexpected server response (${s}) while retrieving PDF "${e}".`,s)}function BR(s){return s===200||s===206}function GR(s,e,t){return{method:"GET",headers:s,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function qR(s){return s instanceof Uint8Array?s.buffer:s instanceof ArrayBuffer?s:(Be(`getArrayBuffer - unexpected data format: ${s}`),new Uint8Array(s).buffer)}class NT{constructor(e){Me(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=jR(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Xt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new d4(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new h4(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class d4{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),i=t.url;fetch(i,GR(n,this._withCredentials,this._abortController)).then(a=>{if(e._responseOrigin=ov(a.url),!BR(a.status))throw lv(a.status,i);this._reader=a.body.getReader(),this._headersCapability.resolve();const l=a.headers,{allowRangeRequests:c,suggestedLength:d}=zR({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=d||this._contentLength,this._filename=HR(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new To("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:qR(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class h4{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const a=new Headers(e.headers);a.append("Range",`bytes=${t}-${n-1}`);const l=i.url;fetch(l,GR(a,this._withCredentials,this._abortController)).then(c=>{const d=ov(c.url);if(d!==e._responseOrigin)throw new Error(`Expected range response-origin "${d}" to match "${e._responseOrigin}".`);if(!BR(c.status))throw lv(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:qR(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const s_=200,i_=206;function f4(s){const e=s.response;return typeof e!="string"?e:iv(e).buffer}class p4{constructor({url:e,httpHeaders:t,withCredentials:n}){Me(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=jR(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[a,l]of this.headers)t.setRequestHeader(a,l);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=i_):i.expectedStatus=s_,t.responseType="arraybuffer",Xt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var i;const n=this.pendingRequests[e];n&&((i=n.onProgress)==null||i.call(n,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){n.onError(i.status);return}const a=i.status||s_;if(!(a===s_&&n.expectedStatus===i_)&&a!==n.expectedStatus){n.onError(i.status);return}const c=f4(i);if(a===i_){const d=i.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);h?n.onDone({begin:parseInt(h[1],10),chunk:c}):(Be('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class m4{constructor(e){this._source=e,this._manager=new p4(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Xt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new g4(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new v4(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class g4{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=ov(t.responseURL);const n=t.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[d,...h]=c.split(": ");return[d,h.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:l}=zR({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=HR(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=lv(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class v4{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=ov((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=lv(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const y4=/^[a-z][a-z0-9\-+.]+:/i;function b4(s){if(y4.test(s))return new URL(s);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(s))}class _4{constructor(e){this.source=e,this.url=b4(e.url),Xt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Xt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new x4(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new w4(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class x4{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Sf(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new To("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class w4{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const S4=1e5,ls=30,A4=.8;var dN,oo,hs,op,lp,Il,$r,cp,up,Dl,Qu,Zu,lo,ed,dp,td,Pl,hp,fp,Ll,Ol,pp,co,nd,pa,VR,$R,ex,Bs,Vg,tx,YR,KR;const en=class en{constructor({textContentSource:e,container:t,viewport:n}){k(this,pa);k(this,oo,Promise.withResolvers());k(this,hs,null);k(this,op,!1);k(this,lp,!!((dN=globalThis.FontInspector)!=null&&dN.enabled));k(this,Il,null);k(this,$r,null);k(this,cp,0);k(this,up,0);k(this,Dl,null);k(this,Qu,null);k(this,Zu,0);k(this,lo,0);k(this,ed,Object.create(null));k(this,dp,[]);k(this,td,null);k(this,Pl,[]);k(this,hp,new WeakMap);k(this,fp,null);var d;if(e instanceof ReadableStream)C(this,td,e);else if(typeof e=="object")C(this,td,new ReadableStream({start(h){h.enqueue(e),h.close()}}));else throw new Error('No "textContentSource" parameter specified.');C(this,hs,C(this,Qu,t)),C(this,lo,n.scale*(globalThis.devicePixelRatio||1)),C(this,Zu,n.rotation),C(this,$r,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:a,pageX:l,pageY:c}=n.rawDims;C(this,fp,[1,0,0,-1,-l,c+a]),C(this,up,i),C(this,cp,a),M(d=en,Bs,YR).call(d),hc(t,n),m(this,oo).promise.finally(()=>{m(en,nd).delete(this),C(this,$r,null),C(this,ed,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Xn.platform;return $e(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{m(this,Dl).read().then(({value:t,done:n})=>{if(n){m(this,oo).resolve();return}m(this,Il)??C(this,Il,t.lang),Object.assign(m(this,ed),t.styles),M(this,pa,VR).call(this,t.items),e()},m(this,oo).reject)};return C(this,Dl,m(this,td).getReader()),m(en,nd).add(this),e(),m(this,oo).promise}update({viewport:e,onBefore:t=null}){var a;const n=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==m(this,Zu)&&(t==null||t(),C(this,Zu,i),hc(m(this,Qu),{rotation:i})),n!==m(this,lo)){t==null||t(),C(this,lo,n);const l={div:null,properties:null,ctx:M(a=en,Bs,Vg).call(a,m(this,Il))};for(const c of m(this,Pl))l.properties=m(this,hp).get(c),l.div=c,M(this,pa,ex).call(this,l)}}cancel(){var t;const e=new To("TextLayer task cancelled.");(t=m(this,Dl))==null||t.cancel(e).catch(()=>{}),C(this,Dl,null),m(this,oo).reject(e)}get textDivs(){return m(this,Pl)}get textContentItemsStr(){return m(this,dp)}static cleanup(){if(!(m(this,nd).size>0)){m(this,Ll).clear();for(const{canvas:e}of m(this,Ol).values())e.remove();m(this,Ol).clear()}}};oo=new WeakMap,hs=new WeakMap,op=new WeakMap,lp=new WeakMap,Il=new WeakMap,$r=new WeakMap,cp=new WeakMap,up=new WeakMap,Dl=new WeakMap,Qu=new WeakMap,Zu=new WeakMap,lo=new WeakMap,ed=new WeakMap,dp=new WeakMap,td=new WeakMap,Pl=new WeakMap,hp=new WeakMap,fp=new WeakMap,Ll=new WeakMap,Ol=new WeakMap,pp=new WeakMap,co=new WeakMap,nd=new WeakMap,pa=new WeakSet,VR=function(e){var i,a;if(m(this,op))return;(a=m(this,$r)).ctx??(a.ctx=M(i=en,Bs,Vg).call(i,m(this,Il)));const t=m(this,Pl),n=m(this,dp);for(const l of e){if(t.length>S4){Be("Ignoring additional textDivs for performance reasons."),C(this,op,!0);return}if(l.str===void 0){if(l.type==="beginMarkedContentProps"||l.type==="beginMarkedContent"){const c=m(this,hs);C(this,hs,document.createElement("span")),m(this,hs).classList.add("markedContent"),l.id!==null&&m(this,hs).setAttribute("id",`${l.id}`),c.append(m(this,hs))}else l.type==="endMarkedContent"&&C(this,hs,m(this,hs).parentNode);continue}n.push(l.str),M(this,pa,$R).call(this,l)}},$R=function(e){var E;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};m(this,Pl).push(t);const i=Ce.transform(m(this,fp),e.transform);let a=Math.atan2(i[1],i[0]);const l=m(this,ed)[e.fontName];l.vertical&&(a+=Math.PI/2);let c=m(this,lp)&&l.fontSubstitution||l.fontFamily;c=en.fontFamilyMap.get(c)||c;const d=Math.hypot(i[2],i[3]),h=d*M(E=en,Bs,KR).call(E,c,m(this,Il));let p,y;a===0?(p=i[4],y=i[5]-h):(p=i[4]+h*Math.sin(a),y=i[5]-h*Math.cos(a));const _="calc(var(--scale-factor)*",S=t.style;m(this,hs)===m(this,Qu)?(S.left=`${(100*p/m(this,up)).toFixed(2)}%`,S.top=`${(100*y/m(this,cp)).toFixed(2)}%`):(S.left=`${_}${p.toFixed(2)}px)`,S.top=`${_}${y.toFixed(2)}px)`),S.fontSize=`${_}${(m(en,co)*d).toFixed(2)}px)`,S.fontFamily=c,n.fontSize=d,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,m(this,lp)&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),a!==0&&(n.angle=a*(180/Math.PI));let A=!1;if(e.str.length>1)A=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const N=Math.abs(e.transform[0]),R=Math.abs(e.transform[3]);N!==R&&Math.max(N,R)/Math.min(N,R)>1.5&&(A=!0)}if(A&&(n.canvasWidth=l.vertical?e.height:e.width),m(this,hp).set(t,n),m(this,$r).div=t,m(this,$r).properties=n,M(this,pa,ex).call(this,m(this,$r)),n.hasText&&m(this,hs).append(t),n.hasEOL){const N=document.createElement("br");N.setAttribute("role","presentation"),m(this,hs).append(N)}},ex=function(e){var c;const{div:t,properties:n,ctx:i}=e,{style:a}=t;let l="";if(m(en,co)>1&&(l=`scale(${1/m(en,co)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:d}=a,{canvasWidth:h,fontSize:p}=n;M(c=en,Bs,tx).call(c,i,p*m(this,lo),d);const{width:y}=i.measureText(t.textContent);y>0&&(l=`scaleX(${h*m(this,lo)/y}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(a.transform=l)},Bs=new WeakSet,Vg=function(e=null){let t=m(this,Ol).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),m(this,Ol).set(e,t),m(this,pp).set(t,{size:0,family:""})}return t},tx=function(e,t,n){const i=m(this,pp).get(e);t===i.size&&n===i.family||(e.font=`${t}px ${n}`,i.size=t,i.family=n)},YR=function(){if(m(this,co)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),C(this,co,e.getBoundingClientRect().height),e.remove()},KR=function(e,t){const n=m(this,Ll).get(e);if(n)return n;const i=M(this,Bs,Vg).call(this,t);i.canvas.width=i.canvas.height=ls,M(this,Bs,tx).call(this,i,ls,e);const a=i.measureText("");let l=a.fontBoundingBoxAscent,c=Math.abs(a.fontBoundingBoxDescent);if(l){const p=l/(l+c);return m(this,Ll).set(e,p),i.canvas.width=i.canvas.height=0,p}i.strokeStyle="red",i.clearRect(0,0,ls,ls),i.strokeText("g",0,0);let d=i.getImageData(0,0,ls,ls).data;c=0;for(let p=d.length-1-3;p>=0;p-=4)if(d[p]>0){c=Math.ceil(p/4/ls);break}i.clearRect(0,0,ls,ls),i.strokeText("A",0,ls),d=i.getImageData(0,0,ls,ls).data,l=0;for(let p=0,y=d.length;p<y;p+=4)if(d[p]>0){l=ls-Math.floor(p/4/ls);break}i.canvas.width=i.canvas.height=0;const h=l?l/(l+c):A4;return m(this,Ll).set(e,h),h},k(en,Bs),k(en,Ll,new Map),k(en,Ol,new Map),k(en,pp,new WeakMap),k(en,co,null),k(en,nd,new Set);let Af=en;class Ef{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function i(a){var d;if(!a)return;let l=null;const c=a.name;if(c==="#text")l=a.value;else if(Ef.shouldBuildText(c))(d=a==null?void 0:a.attributes)!=null&&d.textContent?l=a.attributes.textContent:a.value&&(l=a.value);else return;if(l!==null&&t.push({str:l}),!!a.children)for(const h of a.children)i(h)}return i(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const E4=65536,T4=100,C4=5e3,N4=Un?B5:j5,R4=Un?G5:DR,k4=Un?H5:z5,M4=Un?q5:UR;function I4(s={}){typeof s=="string"||s instanceof URL?s={url:s}:(s instanceof ArrayBuffer||ArrayBuffer.isView(s))&&(s={data:s});const e=new nx,{docId:t}=e,n=s.url?D4(s.url):null,i=s.data?P4(s.data):null,a=s.httpHeaders||null,l=s.withCredentials===!0,c=s.password??null,d=s.range instanceof XR?s.range:null,h=Number.isInteger(s.rangeChunkSize)&&s.rangeChunkSize>0?s.rangeChunkSize:E4;let p=s.worker instanceof Ru?s.worker:null;const y=s.verbosity,_=typeof s.docBaseUrl=="string"&&!av(s.docBaseUrl)?s.docBaseUrl:null,S=typeof s.cMapUrl=="string"?s.cMapUrl:null,A=s.cMapPacked!==!1,E=s.CMapReaderFactory||R4,N=typeof s.standardFontDataUrl=="string"?s.standardFontDataUrl:null,R=s.StandardFontDataFactory||M4,D=s.stopAtErrors!==!0,P=Number.isInteger(s.maxImageSize)&&s.maxImageSize>-1?s.maxImageSize:-1,L=s.isEvalSupported!==!1,z=typeof s.isOffscreenCanvasSupported=="boolean"?s.isOffscreenCanvasSupported:!Un,H=typeof s.isImageDecoderSupported=="boolean"?s.isImageDecoderSupported:!Un&&(Xn.platform.isFirefox||!globalThis.chrome),F=Number.isInteger(s.canvasMaxAreaInBytes)?s.canvasMaxAreaInBytes:-1,X=typeof s.disableFontFace=="boolean"?s.disableFontFace:Un,Y=s.fontExtraProperties===!0,J=s.enableXfa===!0,ie=s.ownerDocument||globalThis.document,pe=s.disableRange===!0,ye=s.disableStream===!0,be=s.disableAutoFetch===!0,Se=s.pdfBug===!0,j=s.CanvasFactory||N4,G=s.FilterFactory||k4,ae=s.enableHWA===!0,we=d?d.length:s.length??NaN,Ne=typeof s.useSystemFonts=="boolean"?s.useSystemFonts:!Un&&!X,U=typeof s.useWorkerFetch=="boolean"?s.useWorkerFetch:E===DR&&R===UR&&S&&N&&Xh(S,document.baseURI)&&Xh(N,document.baseURI),Q=null;v5(y);const re={canvasFactory:new j({ownerDocument:ie,enableHWA:ae}),filterFactory:new G({docId:t,ownerDocument:ie}),cMapReaderFactory:U?null:new E({baseUrl:S,isCompressed:A}),standardFontDataFactory:U?null:new R({baseUrl:N})};if(!p){const ge={verbosity:y,port:la.workerPort};p=ge.port?Ru.fromPort(ge):new Ru(ge),e._worker=p}const ne={docId:t,apiVersion:"4.10.38",data:i,password:c,disableAutoFetch:be,rangeChunkSize:h,length:we,docBaseUrl:_,enableXfa:J,evaluatorOptions:{maxImageSize:P,disableFontFace:X,ignoreErrors:D,isEvalSupported:L,isOffscreenCanvasSupported:z,isImageDecoderSupported:H,canvasMaxAreaInBytes:F,fontExtraProperties:Y,useSystemFonts:Ne,cMapUrl:U?S:null,standardFontDataUrl:U?N:null}},fe={disableFontFace:X,fontExtraProperties:Y,ownerDocument:ie,pdfBug:Se,styleElement:Q,loadingParams:{disableAutoFetch:be,enableXfa:J}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const ge=p.messageHandler.sendWithPromise("GetDocRequest",ne,i?[i.buffer]:null);let de;if(d)de=new o4(d,{disableRange:pe,disableStream:ye});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");let ot;if(Un)if(Xh(n)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");ot=NT}else ot=_4;else ot=Xh(n)?NT:m4;de=new ot({url:n,length:we,httpHeaders:a,withCredentials:l,rangeChunkSize:h,disableRange:pe,disableStream:ye})}return ge.then(ot=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Ze=new Zh(t,ot,p.port),jn=new F4(Ze,e,de,fe,re);e._transport=jn,Ze.send("Ready",null)})}).catch(e._capability.reject),e}function D4(s){if(s instanceof URL)return s.href;try{return new URL(s,window.location).href}catch{if(Un&&typeof s=="string")return s}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function P4(s){if(Un&&typeof Buffer<"u"&&s instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength)return s;if(typeof s=="string")return iv(s);if(s instanceof ArrayBuffer||ArrayBuffer.isView(s)||typeof s=="object"&&!isNaN(s==null?void 0:s.length))return new Uint8Array(s);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function RT(s){return typeof s=="object"&&Number.isInteger(s==null?void 0:s.num)&&s.num>=0&&Number.isInteger(s==null?void 0:s.gen)&&s.gen>=0}var z0;const H0=class H0{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Bn(H0,z0)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,n,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(a){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,a}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};z0=new WeakMap,k(H0,z0,0);let nx=H0;class XR{constructor(e,t,n=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){bt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class L4{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return $e(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var uo,Yr,li,vu,$g;class O4{constructor(e,t,n,i=!1){k(this,li);k(this,uo,null);k(this,Yr,!1);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new mT:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new JR,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:a=!1}={}){return new em({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:a})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return $e(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:i=Ya.ENABLE,transform:a=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:d=null,pageColors:h=null,printAnnotationStorage:p=null,isEditing:y=!1}){var L,z;(L=this._stats)==null||L.time("Overall");const _=this._transport.getRenderingIntent(n,i,p,y),{renderingIntent:S,cacheKey:A}=_;C(this,Yr,!1),M(this,li,$g).call(this),c||(c=this._transport.getOptionalContentConfig(S));let E=this._intentStates.get(A);E||(E=Object.create(null),this._intentStates.set(A,E)),E.streamReaderCancelTimeout&&(clearTimeout(E.streamReaderCancelTimeout),E.streamReaderCancelTimeout=null);const N=!!(S&Us.PRINT);E.displayReadyCapability||(E.displayReadyCapability=Promise.withResolvers(),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(z=this._stats)==null||z.time("Page Request"),this._pumpOperatorList(_));const R=H=>{var F;E.renderTasks.delete(D),(this._maybeCleanupAfterRender||N)&&C(this,Yr,!0),M(this,li,vu).call(this,!N),H?(D.capability.reject(H),this._abortOperatorList({intentState:E,reason:H instanceof Error?H:new Error(H)})):D.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(F=globalThis.Stats)!=null&&F.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},D=new ix({callback:R,params:{canvasContext:e,viewport:t,transform:a,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:E.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!N,pdfBug:this._pdfBug,pageColors:h});(E.renderTasks||(E.renderTasks=new Set)).add(D);const P=D.task;return Promise.all([E.displayReadyCapability.promise,c]).then(([H,F])=>{var X;if(this.destroyed){R();return}if((X=this._stats)==null||X.time("Rendering"),!(F.renderingIntent&S))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");D.initializeGraphics({transparency:H,optionalContentConfig:F}),D.operatorListChanged()}).catch(R),P}getOperatorList({intent:e="display",annotationMode:t=Ya.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){var h;function a(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(d))}const l=this._transport.getRenderingIntent(e,t,n,i,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let d;return c.opListReadCapability||(d=Object.create(null),d.operatorListChanged=a,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(d),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Ef.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,i){function a(){l.read().then(function({value:d,done:h}){if(h){n(c);return}c.lang??(c.lang=d.lang),Object.assign(c.styles,d.styles),c.items.push(...d.items),a()},i)}const l=t.getReader(),c={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),C(this,Yr,!1),M(this,li,$g).call(this),Promise.all(e)}cleanup(e=!1){C(this,Yr,!0);const t=M(this,li,vu).call(this,!1);return e&&t&&this._stats&&(this._stats=new mT),t}_startRenderPage(e,t){var i,a;const n=this._intentStates.get(t);n&&((i=this._stats)==null||i.timeEnd("Page Request"),(a=n.displayReadyCapability)==null||a.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&M(this,li,vu).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:i}){const{map:a,transfer:l}=n,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:a,modifiedIds:i},l).getReader(),h=this._intentStates.get(t);h.streamReader=d;const p=()=>{d.read().then(({value:y,done:_})=>{if(_){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,h),p())},y=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const _ of h.renderTasks)_.operatorListChanged();M(this,li,vu).call(this,!0)}if(h.displayReadyCapability)h.displayReadyCapability.reject(y);else if(h.opListReadCapability)h.opListReadCapability.reject(y);else throw y}})};p()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof uw){let i=T4;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new To(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,a]of this._intentStates)if(a===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}uo=new WeakMap,Yr=new WeakMap,li=new WeakSet,vu=function(e=!1){if(M(this,li,$g).call(this),!m(this,Yr)||this.destroyed)return!1;if(e)return C(this,uo,setTimeout(()=>{C(this,uo,null),M(this,li,vu).call(this,!1)},C4)),!1;for(const{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),C(this,Yr,!1),!0},$g=function(){m(this,uo)&&(clearTimeout(m(this,uo)),C(this,uo,null))};var Kr,B0;class U4{constructor(){k(this,Kr,new Map);k(this,B0,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};m(this,B0).then(()=>{for(const[i]of m(this,Kr))i.call(this,n)})}addEventListener(e,t,n=null){let i=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:a}=n;if(a.aborted){Be("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);i=()=>a.removeEventListener("abort",l),a.addEventListener("abort",l)}m(this,Kr).set(t,i)}removeEventListener(e,t){const n=m(this,Kr).get(t);n==null||n(),m(this,Kr).delete(t)}terminate(){for(const[,e]of m(this,Kr))e==null||e();m(this,Kr).clear()}}Kr=new WeakMap,B0=new WeakMap;var G0,Ul,Fl,sd,Yg,id,Kg;const Tt=class Tt{constructor({name:e=null,port:t=null,verbosity:n=y5()}={}){k(this,sd);var i;if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((i=m(Tt,Fl))!=null&&i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(m(Tt,Fl)||C(Tt,Fl,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Zh("main","worker",e),this._messageHandler.on("ready",function(){}),M(this,sd,Yg).call(this)}_initialize(){if(m(Tt,Ul)||m(Tt,id,Kg)){this._setupFakeWorker();return}let{workerSrc:e}=Tt;try{Tt._isSameOrigin(window.location.href,e)||(e=Tt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Zh("main","worker",t),i=()=>{a.abort(),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:a.signal}),n.on("test",c=>{if(a.abort(),this.destroyed||!c){i();return}this._messageHandler=n,this._port=t,this._webWorker=t,M(this,sd,Yg).call(this)}),n.on("ready",c=>{if(a.abort(),this.destroyed){i();return}try{l()}catch{this._setupFakeWorker()}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{sv("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){m(Tt,Ul)||(Be("Setting up fake worker."),C(Tt,Ul,!0)),Tt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new U4;this._port=t;const n=`fake${Bn(Tt,G0)._++}`,i=new Zh(n+"_worker",n,t);e.setup(i,t),this._messageHandler=new Zh(n,n+"_worker",t),M(this,sd,Yg).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,n;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=m(Tt,Fl))==null||t.delete(this._port),this._port=null,(n=this._messageHandler)==null||n.destroy(),this._messageHandler=null}static fromPort(e){var n;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(n=m(this,Fl))==null?void 0:n.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Tt(e)}static get workerSrc(){if(la.workerSrc)return la.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return $e(this,"_setupFakeWorkerGlobal",(async()=>m(this,id,Kg)?m(this,id,Kg):(await import(this.workerSrc)).WorkerMessageHandler)())}};G0=new WeakMap,Ul=new WeakMap,Fl=new WeakMap,sd=new WeakSet,Yg=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},id=new WeakSet,Kg=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},k(Tt,id),k(Tt,G0,0),k(Tt,Ul,!1),k(Tt,Fl),Un&&(C(Tt,Ul,!0),la.workerSrc||(la.workerSrc="./pdf.worker.mjs")),Tt._isSameOrigin=(e,t)=>{let n;try{if(n=new URL(e),!n.origin||n.origin==="null")return!1}catch{return!1}const i=new URL(t,n);return n.origin===i.origin},Tt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let Ru=Tt;var Xr,sr,rd,ad,Jr,jl,rf;class F4{constructor(e,t,n,i,a){k(this,jl);k(this,Xr,new Map);k(this,sr,new Map);k(this,rd,new Map);k(this,ad,new Map);k(this,Jr,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new JR,this.fontLoader=new U5({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return $e(this,"annotationStorage",new pw)}getRenderingIntent(e,t=Ya.ENABLE,n=null,i=!1,a=!1){let l=Us.DISPLAY,c=V_;switch(e){case"any":l=Us.ANY;break;case"display":break;case"print":l=Us.PRINT;break;default:Be(`getRenderingIntent - invalid intent: ${e}`)}const d=l&Us.PRINT&&n instanceof CR?n:this.annotationStorage;switch(t){case Ya.DISABLE:l+=Us.ANNOTATIONS_DISABLE;break;case Ya.ENABLE:break;case Ya.ENABLE_FORMS:l+=Us.ANNOTATIONS_FORMS;break;case Ya.ENABLE_STORAGE:l+=Us.ANNOTATIONS_STORAGE,c=d.serializable;break;default:Be(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(l+=Us.IS_EDITING),a&&(l+=Us.OPLIST);const{ids:h,hash:p}=d.modifiedIds,y=[l,c.hash,p];return{renderingIntent:l,cacheKey:y.join("_"),annotationStorageSerializable:c,modifiedIds:h}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=m(this,Jr))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of m(this,sr).values())e.push(i._destroy());m(this,sr).clear(),m(this,rd).clear(),m(this,ad).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,a;this.commonObjs.clear(),this.fontLoader.clear(),m(this,Xr).clear(),this.filterFactory.destroy(),Af.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new To("Worker was terminated.")),(a=this.messageHandler)==null||a.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,i)=>{Xt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},i.onPull=()=>{this._fullReader.read().then(function({value:a,done:l}){if(l){i.close();return}Xt(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{this._fullReader.cancel(a),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async n=>{var c;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:a,contentLength:l}=this._fullReader;return(!i||!a)&&(this._lastProgress&&((c=t.onProgress)==null||c.call(t,this._lastProgress)),this._fullReader.onProgress=d=>{var h;(h=t.onProgress)==null||h.call(t,{loaded:d.loaded,total:d.total})}),{isStreamingSupported:i,isRangeSupported:a,contentLength:l}}),e.on("GetRangeReader",(n,i)=>{Xt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(n.begin,n.end);if(!a){i.close();return}i.onPull=()=>{a.read().then(function({value:l,done:c}){if(c){i.close();return}Xt(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{i.error(l)})},i.onCancel=l=>{a.cancel(l),i.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new L4(n,this))}),e.on("DocException",n=>{t._capability.reject(cs(n))}),e.on("PasswordRequest",n=>{C(this,Jr,Promise.withResolvers());try{if(!t.onPassword)throw cs(n);const i=a=>{a instanceof Error?m(this,Jr).reject(a):m(this,Jr).resolve({password:a})};t.onPassword(i,n.code)}catch(i){m(this,Jr).reject(i)}return m(this,Jr).promise}),e.on("DataLoaded",n=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;m(this,sr).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,i,a])=>{var l;if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":const{disableFontFace:c,fontExtraProperties:d,pdfBug:h}=this._params;if("error"in a){const S=a.error;Be(`Error during font loading: ${S}`),this.commonObjs.resolve(n,S);break}const p=h&&((l=globalThis.FontInspector)!=null&&l.enabled)?(S,A)=>globalThis.FontInspector.fontAdded(S,A):null,y=new F5(a,{disableFontFace:c,fontExtraProperties:d,inspectFont:p});this.fontLoader.bind(y).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!d&&y.data&&(y.data=null),this.commonObjs.resolve(n,y)});break;case"CopyLocalImage":const{imageRef:_}=a;Xt(_,"The imageRef must be defined.");for(const S of m(this,sr).values())for(const[,A]of S.objs)if((A==null?void 0:A.ref)===_)return A.dataLen?(this.commonObjs.resolve(n,structuredClone(A)),A.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,a);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([n,i,a,l])=>{var d;if(this.destroyed)return;const c=m(this,sr).get(i);if(!c.objs.has(n)){if(c._intentStates.size===0){(d=l==null?void 0:l.bitmap)==null||d.close();return}switch(a){case"Image":c.objs.resolve(n,l),(l==null?void 0:l.dataLen)>f5&&(c._maybeCleanupAfterRender=!0);break;case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${a}`)}}}),e.on("DocProgress",n=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:n.loaded,total:n.total})}),e.on("FetchBuiltInCMap",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)}),e.on("FetchStandardFontData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Be("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=this._fullReader)==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=m(this,rd).get(t);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&m(this,ad).set(a.refStr,e);const l=new O4(t,a,this,this._params.pdfBug);return m(this,sr).set(t,l),l});return m(this,rd).set(t,i),i}getPageIndex(e){return RT(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return M(this,jl,rf).call(this,"GetFieldObjects")}hasJSActions(){return M(this,jl,rf).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return M(this,jl,rf).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return M(this,jl,rf).call(this,"GetOptionalContentConfig").then(t=>new a4(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=m(this,Xr).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(i=>{var a,l;return{info:i[0],metadata:i[1]?new i4(i[1]):null,contentDispositionFilename:((a=this._fullReader)==null?void 0:a.filename)??null,contentLength:((l=this._fullReader)==null?void 0:l.contentLength)??null}});return m(this,Xr).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of m(this,sr).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),m(this,Xr).clear(),this.filterFactory.destroy(!0),Af.cleanup()}}cachedPageNumber(e){if(!RT(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return m(this,ad).get(t)??null}}Xr=new WeakMap,sr=new WeakMap,rd=new WeakMap,ad=new WeakMap,Jr=new WeakMap,jl=new WeakSet,rf=function(e,t=null){const n=m(this,Xr).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return m(this,Xr).set(e,i),i};const Gh=Symbol("INITIAL_DATA");var Ns,mp,sx;class JR{constructor(){k(this,mp);k(this,Ns,Object.create(null))}get(e,t=null){if(t){const i=M(this,mp,sx).call(this,e);return i.promise.then(()=>t(i.data)),null}const n=m(this,Ns)[e];if(!n||n.data===Gh)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=m(this,Ns)[e];return!!t&&t.data!==Gh}delete(e){const t=m(this,Ns)[e];return!t||t.data===Gh?!1:(delete m(this,Ns)[e],!0)}resolve(e,t=null){const n=M(this,mp,sx).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in m(this,Ns)){const{data:n}=m(this,Ns)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}C(this,Ns,Object.create(null))}*[Symbol.iterator](){for(const e in m(this,Ns)){const{data:t}=m(this,Ns)[e];t!==Gh&&(yield[e,t])}}}Ns=new WeakMap,mp=new WeakSet,sx=function(e){var t;return(t=m(this,Ns))[e]||(t[e]={...Promise.withResolvers(),data:Gh})};var ho;class j4{constructor(e){k(this,ho,null);C(this,ho,e),this.onContinue=null}get promise(){return m(this,ho).capability.promise}cancel(e=0){m(this,ho).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=m(this,ho).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=m(this,ho);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}ho=new WeakMap;var fo,zl;const al=class al{constructor({callback:e,params:t,objs:n,commonObjs:i,annotationCanvasMap:a,operatorList:l,pageIndex:c,canvasFactory:d,filterFactory:h,useRequestAnimationFrame:p=!1,pdfBug:y=!1,pageColors:_=null}){k(this,fo,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=d,this.filterFactory=h,this._pdfBug=y,this.pageColors=_,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new j4(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var c,d;if(this.cancelled)return;if(this._canvas){if(m(al,zl).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");m(al,zl).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:a,background:l}=this.params;this.gfx=new Nu(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:i,transparency:e,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,(d=this.graphicsReadyCallback)==null||d.call(this)}cancel(e=null,t=0){var n;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),m(this,fo)&&(window.cancelAnimationFrame(m(this,fo)),C(this,fo,null)),m(al,zl).delete(this._canvas),this.callback(e||new uw(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?C(this,fo,window.requestAnimationFrame(()=>{C(this,fo,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),m(al,zl).delete(this._canvas),this.callback())))}};fo=new WeakMap,zl=new WeakMap,k(al,zl,new WeakSet);let ix=al;const z4="4.10.38",H4="f9bea397f";function kT(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}function qh(s){return Math.max(0,Math.min(255,255*s))}class MT{static CMYK_G([e,t,n,i]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=qh(e),[e,e,e]}static G_HTML([e]){const t=kT(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(qh)}static RGB_HTML(e){return`#${e.map(kT).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,n+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,n,i]){return[qh(1-Math.min(1,e+i)),qh(1-Math.min(1,n+i)),qh(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const i=1-e,a=1-t,l=1-n,c=Math.min(i,a,l);return["CMYK",i,a,l,c]}}class B4{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){bt("Abstract method `_createSVG` called.")}}class gw extends B4{_createSVG(e){return document.createElementNS(Mr,e)}}class WR{static setupStorage(e,t,n,i,a){const l=i.getValue(t,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),a==="print")break;e.addEventListener("input",c=>{i.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?e.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&e.removeAttribute("checked"),a==="print")break;e.addEventListener("change",c=>{i.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),a==="print")break;e.addEventListener("input",c=>{i.setValue(t,{value:c.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const d=c.target.options,h=d.selectedIndex===-1?"":d[d.selectedIndex].value;i.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:i,linkService:a}){const{attributes:l}=t,c=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${i}`);for(const[d,h]of Object.entries(l))if(h!=null)switch(d){case"class":h.length&&e.setAttribute(d,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!c||d!=="href"&&d!=="newWindow")&&e.setAttribute(d,h)}c&&a.addLinkAttributes(e,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(e,l.dataId,t,n)}static render(e){var y,_;const t=e.annotationStorage,n=e.linkService,i=e.xfaHtml,a=e.intent||"display",l=document.createElement(i.name);i.attributes&&this.setAttributes({html:l,element:i,intent:a,linkService:n});const c=a!=="richText",d=e.div;if(d.append(l),e.viewport){const S=`matrix(${e.viewport.transform.join(",")})`;d.style.transform=S}c&&d.setAttribute("class","xfaLayer xfaFont");const h=[];if(i.children.length===0){if(i.value){const S=document.createTextNode(i.value);l.append(S),c&&Ef.shouldBuildText(i.name)&&h.push(S)}return{textDivs:h}}const p=[[i,-1,l]];for(;p.length>0;){const[S,A,E]=p.at(-1);if(A+1===S.children.length){p.pop();continue}const N=S.children[++p.at(-1)[1]];if(N===null)continue;const{name:R}=N;if(R==="#text"){const P=document.createTextNode(N.value);h.push(P),E.append(P);continue}const D=(y=N==null?void 0:N.attributes)!=null&&y.xmlns?document.createElementNS(N.attributes.xmlns,R):document.createElement(R);if(E.append(D),N.attributes&&this.setAttributes({html:D,element:N,storage:t,intent:a,linkService:n}),((_=N.children)==null?void 0:_.length)>0)p.push([N,-1,D]);else if(N.value){const P=document.createTextNode(N.value);c&&Ef.shouldBuildText(R)&&h.push(P),D.append(P)}}for(const S of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))S.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const nm=1e3,G4=9,pc=new WeakSet;function Eo(s){return{width:s[2]-s[0],height:s[3]-s[1]}}class q4{static create(e){switch(e.data.annotationType){case Qt.LINK:return new QR(e);case Qt.TEXT:return new V4(e);case Qt.WIDGET:switch(e.data.fieldType){case"Tx":return new $4(e);case"Btn":return e.data.radioButton?new t2(e):e.data.checkBox?new K4(e):new X4(e);case"Ch":return new J4(e);case"Sig":return new Y4(e)}return new vc(e);case Qt.POPUP:return new ax(e);case Qt.FREETEXT:return new a2(e);case Qt.LINE:return new Q4(e);case Qt.SQUARE:return new Z4(e);case Qt.CIRCLE:return new e3(e);case Qt.POLYLINE:return new o2(e);case Qt.CARET:return new n3(e);case Qt.INK:return new vw(e);case Qt.POLYGON:return new t3(e);case Qt.HIGHLIGHT:return new l2(e);case Qt.UNDERLINE:return new s3(e);case Qt.SQUIGGLY:return new i3(e);case Qt.STRIKEOUT:return new r3(e);case Qt.STAMP:return new c2(e);case Qt.FILEATTACHMENT:return new a3(e);default:return new Bt(e)}}}var Hl,od,ld,gp,rx;const Mw=class Mw{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){k(this,gp);k(this,Hl,null);k(this,od,!1);k(this,ld,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e!=null&&e.str||t!=null&&t.str||n!=null&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Mw._hasPopupData(this.data)}updateEdited(e){var n;if(!this.container)return;m(this,Hl)||C(this,Hl,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&M(this,gp,rx).call(this,t),(n=m(this,ld))==null||n.popup.updateEdited(e)}resetEdited(){var e;m(this,Hl)&&(M(this,gp,rx).call(this,m(this,Hl).rect),(e=m(this,ld))==null||e.popup.resetEdited(),C(this,Hl,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:i}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",t.id),this instanceof vc||(a.tabIndex=nm);const{style:l}=a;if(l.zIndex=this.parent.zIndex++,t.alternativeText&&(a.title=t.alternativeText),t.noRotate&&a.classList.add("norotate"),!t.rect||this instanceof ax){const{rotation:E}=t;return!t.hasOwnCanvas&&E!==0&&this.setRotation(E,a),a}const{width:c,height:d}=Eo(t.rect);if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const E=t.borderStyle.horizontalCornerRadius,N=t.borderStyle.verticalCornerRadius;if(E>0||N>0){const D=`calc(${E}px * var(--scale-factor)) / calc(${N}px * var(--scale-factor))`;l.borderRadius=D}else if(this instanceof t2){const D=`calc(${c}px * var(--scale-factor)) / calc(${d}px * var(--scale-factor))`;l.borderRadius=D}switch(t.borderStyle.style){case Hh.SOLID:l.borderStyle="solid";break;case Hh.DASHED:l.borderStyle="dashed";break;case Hh.BEVELED:Be("Unimplemented border style: beveled");break;case Hh.INSET:Be("Unimplemented border style: inset");break;case Hh.UNDERLINE:l.borderBottomStyle="solid";break}const R=t.borderColor||null;R?(C(this,od,!0),l.borderColor=Ce.makeHexColor(R[0]|0,R[1]|0,R[2]|0)):l.borderWidth=0}const h=Ce.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:y,pageX:_,pageY:S}=i.rawDims;l.left=`${100*(h[0]-_)/p}%`,l.top=`${100*(h[1]-S)/y}%`;const{rotation:A}=t;return t.hasOwnCanvas||A===0?(l.width=`${100*c/p}%`,l.height=`${100*d/y}%`):this.setRotation(A,a),a}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims,{width:a,height:l}=Eo(this.data.rect);let c,d;e%180===0?(c=100*a/n,d=100*l/i):(c=100*l/n,d=100*a/i),t.style.width=`${c}%`,t.style.height=`${d}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,i)=>{const a=i.detail[t],l=a[0],c=a.slice(1);i.target.style[n]=MT[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:MT[`${l}_rgb`](c)})};return $e(this,"_commonActions",{display:t=>{const{display:n}=t.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail)){const a=e[i]||n[i];a==null||a(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,a]of Object.entries(t)){const l=n[i];if(l){const c={detail:{[i]:a},target:e};l(c),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,a]=this.data.rect.map(E=>Math.fround(E));if(e.length===8){const[E,N,R,D]=e.subarray(2,6);if(i===E&&a===N&&t===R&&n===D)return}const{style:l}=this.container;let c;if(m(this,od)){const{borderColor:E,borderWidth:N}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${E}" stroke-width="${N}">`],this.container.classList.add("hasBorder")}const d=i-t,h=a-n,{svgFactory:p}=this,y=p.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0);const _=p.createElement("defs");y.append(_);const S=p.createElement("clipPath"),A=`clippath_${this.data.id}`;S.setAttribute("id",A),S.setAttribute("clipPathUnits","objectBoundingBox"),_.append(S);for(let E=2,N=e.length;E<N;E+=8){const R=e[E],D=e[E+1],P=e[E+2],L=e[E+3],z=p.createElement("rect"),H=(P-t)/d,F=(a-D)/h,X=(R-P)/d,Y=(D-L)/h;z.setAttribute("x",H),z.setAttribute("y",F),z.setAttribute("width",X),z.setAttribute("height",Y),S.append(z),c==null||c.push(`<rect vector-effect="non-scaling-stroke" x="${H}" y="${F}" width="${X}" height="${Y}"/>`)}m(this,od)&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(y),this.container.style.clipPath=`url(#${A})`}_createPopup(){const{data:e}=this,t=C(this,ld,new ax({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){bt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:a,id:l,exportValues:c}of i){if(a===-1||l===t)continue;const d=typeof c=="string"?c:null,h=document.querySelector(`[data-element-id="${l}"]`);if(h&&!pc.has(h)){Be(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:d,domElement:h})}return n}for(const i of document.getElementsByName(e)){const{exportValue:a}=i,l=i.getAttribute("data-element-id");l!==t&&pc.has(i)&&n.push({id:l,exportValue:a,domElement:i})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};Hl=new WeakMap,od=new WeakMap,ld=new WeakMap,gp=new WeakSet,rx=function(e){const{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:d}}}}=this;n==null||n.splice(0,4,...e);const{width:h,height:p}=Eo(e);t.left=`${100*(e[0]-c)/a}%`,t.top=`${100*(l-e[3]+d)/l}%`,i===0?(t.width=`${100*h/a}%`,t.height=`${100*p/l}%`):this.setRotation(i)};let Bt=Mw;var Fs,Zo,ZR,e2;class QR extends Bt{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});k(this,Fs);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let a=!1;return t.url?(n.addLinkAttributes(i,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(i,t.action),a=!0):t.attachment?(M(this,Fs,ZR).call(this,i,t.attachment,t.attachmentDest),a=!0):t.setOCGState?(M(this,Fs,e2).call(this,i,t.setOCGState),a=!0):t.dest?(this._bindLink(i,t.dest),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),a=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(i,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&this.container.append(i),this.container}_bindLink(t,n){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&M(this,Fs,Zo).call(this)}_bindNamedAction(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),M(this,Fs,Zo).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(n.actions)){const l=i.get(a);l&&(t[l]=()=>{var c;return(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:a}}),!1})}t.onclick||(t.onclick=()=>!1),M(this,Fs,Zo).call(this)}_bindResetFormAction(t,n){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),M(this,Fs,Zo).call(this),!this._fieldObjects){Be('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var y;i==null||i();const{fields:a,refs:l,include:c}=n,d=[];if(a.length!==0||l.length!==0){const _=new Set(l);for(const S of a){const A=this._fieldObjects[S]||[];for(const{id:E}of A)_.add(E)}for(const S of Object.values(this._fieldObjects))for(const A of S)_.has(A.id)===c&&d.push(A)}else for(const _ of Object.values(this._fieldObjects))d.push(..._);const h=this.annotationStorage,p=[];for(const _ of d){const{id:S}=_;switch(p.push(S),_.type){case"text":{const E=_.defaultValue||"";h.setValue(S,{value:E});break}case"checkbox":case"radiobutton":{const E=_.defaultValue===_.exportValues;h.setValue(S,{value:E});break}case"combobox":case"listbox":{const E=_.defaultValue||"";h.setValue(S,{value:E});break}default:continue}const A=document.querySelector(`[data-element-id="${S}"]`);if(A){if(!pc.has(A)){Be(`_bindResetFormAction - element not allowed: ${S}`);continue}}else continue;A.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:p,name:"ResetForm"}})),!1}}}Fs=new WeakSet,Zo=function(){this.container.setAttribute("data-internal-link","")},ZR=function(t,n,i=null){t.href=this.linkService.getAnchorUrl(""),n.description&&(t.title=n.description),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(n.content,n.filename,i),!1},M(this,Fs,Zo).call(this)},e2=function(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),M(this,Fs,Zo).call(this)};class V4 extends Bt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class vc extends Bt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Xn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,a){n.includes("mouse")?e.addEventListener(n,l=>{var c;(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(n,l=>{var c;if(n==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}a&&((c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(l)}}))})}_setEventListeners(e,t,n,i){var a,l,c;for(const[d,h]of n)(h==="Action"||(a=this.data.actions)!=null&&a[h])&&((h==="Focus"||h==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,d,h,i),h==="Focus"&&!((l=this.data.actions)!=null&&l.Blur)?this._setEventListener(e,t,"blur","Blur",null):h==="Blur"&&!((c=this.data.actions)!=null&&c.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Ce.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||G4,a=e.style;let l;const c=2,d=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c),p=Math.round(h/(Qb*i))||1,y=h/p;l=Math.min(i,d(y/Qb))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(i,d(h/Qb))}a.fontSize=`calc(${l}px * var(--scale-factor))`,a.color=Ce.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(a.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class $4 extends vc{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,i){const a=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=n),a.setValue(l.id,{[i]:n})}render(){var i,a;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const l=e.getValue(t,{value:this.data.fieldValue});let c=l.value||"";const d=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;d&&c.length>d&&(c=c.slice(0,d));let h=l.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const p={userValue:c,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=h??c,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",h??c),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),pc.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=nm,this._setRequired(n,this.data.required),d&&(n.maxLength=d),n.addEventListener("input",_=>{e.setValue(t,{value:_.target.value}),this.setPropertyOnSiblings(n,"value",_.target.value,"value"),p.formattedValue=null}),n.addEventListener("resetform",_=>{const S=this.data.defaultFieldValue??"";n.value=p.userValue=S,p.formattedValue=null});let y=_=>{const{formattedValue:S}=p;S!=null&&(_.target.value=S),_.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",S=>{var E;if(p.focused)return;const{target:A}=S;p.userValue&&(A.value=p.userValue),p.lastCommittedValue=A.value,p.commitKey=1,(E=this.data.actions)!=null&&E.Focus||(p.focused=!0)}),n.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const A={value(E){p.userValue=E.detail.value??"",e.setValue(t,{value:p.userValue.toString()}),E.target.value=p.userValue},formattedValue(E){const{formattedValue:N}=E.detail;p.formattedValue=N,N!=null&&E.target!==document.activeElement&&(E.target.value=N),e.setValue(t,{formattedValue:N})},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{var P;const{charLimit:N}=E.detail,{target:R}=E;if(N===0){R.removeAttribute("maxLength");return}R.setAttribute("maxLength",N);let D=p.userValue;!D||D.length<=N||(D=D.slice(0,N),R.value=p.userValue=D,e.setValue(t,{value:D}),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:D,willCommit:!0,commitKey:1,selStart:R.selectionStart,selEnd:R.selectionEnd}}))}};this._dispatchEventFromSandbox(A,S)}),n.addEventListener("keydown",S=>{var N;p.commitKey=1;let A=-1;if(S.key==="Escape"?A=0:S.key==="Enter"&&!this.data.multiLine?A=2:S.key==="Tab"&&(p.commitKey=3),A===-1)return;const{value:E}=S.target;p.lastCommittedValue!==E&&(p.lastCommittedValue=E,p.userValue=E,(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:A,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const _=y;y=null,n.addEventListener("blur",S=>{var E,N;if(!p.focused||!S.relatedTarget)return;(E=this.data.actions)!=null&&E.Blur||(p.focused=!1);const{value:A}=S.target;p.userValue=A,p.lastCommittedValue!==A&&((N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:p.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}})),_(S)}),(a=this.data.actions)!=null&&a.Keystroke&&n.addEventListener("beforeinput",S=>{var z;p.lastCommittedValue=null;const{data:A,target:E}=S,{value:N,selectionStart:R,selectionEnd:D}=E;let P=R,L=D;switch(S.inputType){case"deleteWordBackward":{const H=N.substring(0,R).match(/\w*[^\w]*$/);H&&(P-=H[0].length);break}case"deleteWordForward":{const H=N.substring(R).match(/^[^\w]*\w*/);H&&(L+=H[0].length);break}case"deleteContentBackward":R===D&&(P-=1);break;case"deleteContentForward":R===D&&(L+=1);break}S.preventDefault(),(z=this.linkService.eventBus)==null||z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:N,change:A||"",willCommit:!1,selStart:P,selEnd:L}})}),this._setEventListeners(n,p,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(y&&n.addEventListener("blur",y),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/d;n.classList.add("comb"),n.style.letterSpacing=`calc(${S}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Y4 extends vc{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class K4 extends vc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return pc.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=nm,a.addEventListener("change",l=>{const{name:c,checked:d}=l.target;for(const h of this._getElementsByName(c,n)){const p=d&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=p),e.setValue(h.id,{value:p})}e.setValue(n,{value:d})}),a.addEventListener("resetform",l=>{const c=t.defaultFieldValue||"Off";l.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",l=>{const c={value(d){d.target.checked=d.detail.value!=="Off",e.setValue(n,{value:d.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class t2 extends vc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(const l of this._getElementsByName(t.fieldName,n))e.setValue(l.id,{value:!1});const a=document.createElement("input");if(pc.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.tabIndex=nm,a.addEventListener("change",l=>{const{name:c,checked:d}=l.target;for(const h of this._getElementsByName(c,n))e.setValue(h.id,{value:!1});e.setValue(n,{value:d})}),a.addEventListener("resetform",l=>{const c=t.defaultFieldValue;l.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;a.addEventListener("updatefromsandbox",c=>{const d={value:h=>{const p=l===h.detail.value;for(const y of this._getElementsByName(h.target.name)){const _=p&&y.id===n;y.domElement&&(y.domElement.checked=_),e.setValue(y.id,{value:_})}}};this._dispatchEventFromSandbox(d,c)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class X4 extends QR{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class J4 extends vc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");pc.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=nm;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",p=>{const y=this.data.defaultFieldValue;for(const _ of i.options)_.selected=_.value===y});for(const p of this.data.options){const y=document.createElement("option");y.textContent=p.displayValue,y.value=p.exportValue,n.value.includes(p.exportValue)&&(y.setAttribute("selected",!0),a=!1),i.append(y)}let l=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),i.prepend(p),l=()=>{p.remove(),i.removeEventListener("input",l),l=null},i.addEventListener("input",l)}const c=p=>{const y=p?"value":"textContent",{options:_,multiple:S}=i;return S?Array.prototype.filter.call(_,A=>A.selected).map(A=>A[y]):_.selectedIndex===-1?null:_[_.selectedIndex][y]};let d=c(!1);const h=p=>{const y=p.target.options;return Array.prototype.map.call(y,_=>({displayValue:_.textContent,exportValue:_.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",p=>{const y={value(_){l==null||l();const S=_.detail.value,A=new Set(Array.isArray(S)?S:[S]);for(const E of i.options)E.selected=A.has(E.value);e.setValue(t,{value:c(!0)}),d=c(!1)},multipleSelection(_){i.multiple=!0},remove(_){const S=i.options,A=_.detail.remove;S[A].selected=!1,i.remove(A),S.length>0&&Array.prototype.findIndex.call(S,N=>N.selected)===-1&&(S[0].selected=!0),e.setValue(t,{value:c(!0),items:h(_)}),d=c(!1)},clear(_){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),d=c(!1)},insert(_){const{index:S,displayValue:A,exportValue:E}=_.detail.insert,N=i.children[S],R=document.createElement("option");R.textContent=A,R.value=E,N?N.before(R):i.append(R),e.setValue(t,{value:c(!0),items:h(_)}),d=c(!1)},items(_){const{items:S}=_.detail;for(;i.length!==0;)i.remove(0);for(const A of S){const{displayValue:E,exportValue:N}=A,R=document.createElement("option");R.textContent=E,R.value=N,i.append(R)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:c(!0),items:h(_)}),d=c(!1)},indices(_){const S=new Set(_.detail.indices);for(const A of _.target.options)A.selected=S.has(A.index);e.setValue(t,{value:c(!0)}),d=c(!1)},editable(_){_.target.disabled=!_.detail.editable}};this._dispatchEventFromSandbox(y,p)}),i.addEventListener("input",p=>{var S;const y=c(!0),_=c(!1);e.setValue(t,{value:y}),p.preventDefault(),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:d,change:_,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):i.addEventListener("input",function(p){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class ax extends Bt{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:Bt._hasPopupData(t)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new W4({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(n=>`${cw}${n}`).join(",")),this.container}}var cd,q0,V0,ud,Bl,Lt,Wr,dd,vp,yp,hd,Qr,Ai,Zr,bp,ea,_p,Gl,ql,gt,Xg,ox,n2,s2,i2,r2,Jg,Wg,lx;class W4{constructor({container:e,color:t,elements:n,titleObj:i,modificationDate:a,contentsObj:l,richText:c,parent:d,rect:h,parentRect:p,open:y}){k(this,gt);k(this,cd,M(this,gt,i2).bind(this));k(this,q0,M(this,gt,lx).bind(this));k(this,V0,M(this,gt,Wg).bind(this));k(this,ud,M(this,gt,Jg).bind(this));k(this,Bl,null);k(this,Lt,null);k(this,Wr,null);k(this,dd,null);k(this,vp,null);k(this,yp,null);k(this,hd,null);k(this,Qr,!1);k(this,Ai,null);k(this,Zr,null);k(this,bp,null);k(this,ea,null);k(this,_p,null);k(this,Gl,null);k(this,ql,!1);var _;C(this,Lt,e),C(this,_p,i),C(this,Wr,l),C(this,ea,c),C(this,yp,d),C(this,Bl,t),C(this,bp,h),C(this,hd,p),C(this,vp,n),C(this,dd,hw.toDateObject(a)),this.trigger=n.flatMap(S=>S.getElementsToTriggerPopup());for(const S of this.trigger)S.addEventListener("click",m(this,ud)),S.addEventListener("mouseenter",m(this,V0)),S.addEventListener("mouseleave",m(this,q0)),S.classList.add("popupTriggerArea");for(const S of n)(_=S.container)==null||_.addEventListener("keydown",m(this,cd));m(this,Lt).hidden=!0,y&&M(this,gt,Jg).call(this)}render(){if(m(this,Ai))return;const e=C(this,Ai,document.createElement("div"));if(e.className="popup",m(this,Bl)){const a=e.style.outlineColor=Ce.makeHexColor(...m(this,Bl));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${a} 30%, white)`:e.style.backgroundColor=Ce.makeHexColor(...m(this,Bl).map(c=>Math.floor(.7*(255-c)+c)))}const t=document.createElement("span");t.className="header";const n=document.createElement("h1");if(t.append(n),{dir:n.dir,str:n.textContent}=m(this,_p),e.append(t),m(this,dd)){const a=document.createElement("span");a.classList.add("popupDate"),a.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),a.setAttribute("data-l10n-args",JSON.stringify({dateObj:m(this,dd).valueOf()})),t.append(a)}const i=m(this,gt,Xg);if(i)WR.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const a=this._formatContents(m(this,Wr));e.append(a)}m(this,Lt).append(e)}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let a=0,l=i.length;a<l;++a){const c=i[a];n.append(document.createTextNode(c)),a<l-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:e,popupContent:t}){var n;m(this,Gl)||C(this,Gl,{contentsObj:m(this,Wr),richText:m(this,ea)}),e&&C(this,Zr,null),t&&(C(this,ea,M(this,gt,s2).call(this,t)),C(this,Wr,null)),(n=m(this,Ai))==null||n.remove(),C(this,Ai,null)}resetEdited(){var e;m(this,Gl)&&({contentsObj:Bn(this,Wr)._,richText:Bn(this,ea)._}=m(this,Gl),C(this,Gl,null),(e=m(this,Ai))==null||e.remove(),C(this,Ai,null),C(this,Zr,null))}forceHide(){C(this,ql,this.isVisible),m(this,ql)&&(m(this,Lt).hidden=!0)}maybeShow(){m(this,ql)&&(m(this,Ai)||M(this,gt,Wg).call(this),C(this,ql,!1),m(this,Lt).hidden=!1)}get isVisible(){return m(this,Lt).hidden===!1}}cd=new WeakMap,q0=new WeakMap,V0=new WeakMap,ud=new WeakMap,Bl=new WeakMap,Lt=new WeakMap,Wr=new WeakMap,dd=new WeakMap,vp=new WeakMap,yp=new WeakMap,hd=new WeakMap,Qr=new WeakMap,Ai=new WeakMap,Zr=new WeakMap,bp=new WeakMap,ea=new WeakMap,_p=new WeakMap,Gl=new WeakMap,ql=new WeakMap,gt=new WeakSet,Xg=function(){const e=m(this,ea),t=m(this,Wr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&m(this,ea).html||null},ox=function(){var e,t,n;return((n=(t=(e=m(this,gt,Xg))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},n2=function(){var e,t,n;return((n=(t=(e=m(this,gt,Xg))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},s2=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:m(this,gt,n2),fontSize:m(this,gt,ox)?`calc(${m(this,gt,ox)}px * var(--scale-factor))`:""}};for(const a of e.split(`
`))t.push({name:"span",value:a,attributes:i});return n},i2=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&m(this,Qr))&&M(this,gt,Jg).call(this)},r2=function(){if(m(this,Zr)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:a}}}=m(this,yp);let l=!!m(this,hd),c=l?m(this,hd):m(this,bp);for(const A of m(this,vp))if(!c||Ce.intersect(A.data.rect,c)!==null){c=A.data.rect,l=!0;break}const d=Ce.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),p=l?c[2]-c[0]+5:0,y=d[0]+p,_=d[1];C(this,Zr,[100*(y-i)/t,100*(_-a)/n]);const{style:S}=m(this,Lt);S.left=`${m(this,Zr)[0]}%`,S.top=`${m(this,Zr)[1]}%`},Jg=function(){C(this,Qr,!m(this,Qr)),m(this,Qr)?(M(this,gt,Wg).call(this),m(this,Lt).addEventListener("click",m(this,ud)),m(this,Lt).addEventListener("keydown",m(this,cd))):(M(this,gt,lx).call(this),m(this,Lt).removeEventListener("click",m(this,ud)),m(this,Lt).removeEventListener("keydown",m(this,cd)))},Wg=function(){m(this,Ai)||this.render(),this.isVisible?m(this,Qr)&&m(this,Lt).classList.add("focused"):(M(this,gt,r2).call(this),m(this,Lt).hidden=!1,m(this,Lt).style.zIndex=parseInt(m(this,Lt).style.zIndex)+1e3)},lx=function(){m(this,Lt).classList.remove("focused"),!(m(this,Qr)||!this.isVisible)&&(m(this,Lt).hidden=!0,m(this,Lt).style.zIndex=parseInt(m(this,Lt).style.zIndex)-1e3)};class a2 extends Bt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=He.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var xp;class Q4 extends Bt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});k(this,xp,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:n,height:i}=Eo(t.rect),a=this.svgFactory.create(n,i,!0),l=C(this,xp,this.svgFactory.createElement("svg:line"));return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return m(this,xp)}addHighlightArea(){this.container.classList.add("highlightArea")}}xp=new WeakMap;var wp;class Z4 extends Bt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});k(this,wp,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:n,height:i}=Eo(t.rect),a=this.svgFactory.create(n,i,!0),l=t.borderStyle.width,c=C(this,wp,this.svgFactory.createElement("svg:rect"));return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",n-l),c.setAttribute("height",i-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return m(this,wp)}addHighlightArea(){this.container.classList.add("highlightArea")}}wp=new WeakMap;var Sp;class e3 extends Bt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});k(this,Sp,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:n,height:i}=Eo(t.rect),a=this.svgFactory.create(n,i,!0),l=t.borderStyle.width,c=C(this,Sp,this.svgFactory.createElement("svg:ellipse"));return c.setAttribute("cx",n/2),c.setAttribute("cy",i/2),c.setAttribute("rx",n/2-l/2),c.setAttribute("ry",i/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return m(this,Sp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Sp=new WeakMap;var Ap;class o2 extends Bt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});k(this,Ap,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:i,popupRef:a}}=this;if(!n)return this.container;const{width:l,height:c}=Eo(t),d=this.svgFactory.create(l,c,!0);let h=[];for(let y=0,_=n.length;y<_;y+=2){const S=n[y]-t[0],A=t[3]-n[y+1];h.push(`${S},${A}`)}h=h.join(" ");const p=C(this,Ap,this.svgFactory.createElement(this.svgElementName));return p.setAttribute("points",h),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),d.append(p),this.container.append(d),!a&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return m(this,Ap)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ap=new WeakMap;class t3 extends o2{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class n3 extends Bt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Ep,Vl,Tp,cx;class vw extends Bt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});k(this,Tp);k(this,Ep,null);k(this,Vl,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?He.HIGHLIGHT:He.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:i,borderStyle:a,popupRef:l}}=this,{transform:c,width:d,height:h}=M(this,Tp,cx).call(this,n,t),p=this.svgFactory.create(d,h,!0),y=C(this,Ep,this.svgFactory.createElement("svg:g"));p.append(y),y.setAttribute("stroke-width",a.width||1),y.setAttribute("stroke-linecap","round"),y.setAttribute("stroke-linejoin","round"),y.setAttribute("stroke-miterlimit",10),y.setAttribute("stroke","transparent"),y.setAttribute("fill","transparent"),y.setAttribute("transform",c);for(let _=0,S=i.length;_<S;_++){const A=this.svgFactory.createElement(this.svgElementName);m(this,Vl).push(A),A.setAttribute("points",i[_].join(",")),y.append(A)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(p),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:i,rect:a}=t,l=m(this,Ep);if(n>=0&&l.setAttribute("stroke-width",n||1),i)for(let c=0,d=m(this,Vl).length;c<d;c++)m(this,Vl)[c].setAttribute("points",i[c].join(","));if(a){const{transform:c,width:d,height:h}=M(this,Tp,cx).call(this,this.data.rotation,a);l.parentElement.setAttribute("viewBox",`0 0 ${d} ${h}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return m(this,Vl)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ep=new WeakMap,Vl=new WeakMap,Tp=new WeakSet,cx=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class l2 extends Bt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=He.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class s3 extends Bt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class i3 extends Bt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class r3 extends Bt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class c2 extends Bt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=He.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Cp,Np,ux;class a3 extends Bt{constructor(t){var i;super(t,{isRenderable:!0});k(this,Np);k(this,Cp,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let i;n.hasAppearance||n.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),i.addEventListener("dblclick",M(this,Np,ux).bind(this)),C(this,Cp,i);const{isMac:a}=Xn.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(a?l.metaKey:l.ctrlKey)&&M(this,Np,ux).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return m(this,Cp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Cp=new WeakMap,Np=new WeakSet,ux=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Rp,$l,Yl,kp,mc,u2,dx;class o3{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:i,page:a,viewport:l,structTreeLayer:c}){k(this,mc);k(this,Rp,null);k(this,$l,null);k(this,Yl,new Map);k(this,kp,null);this.div=e,C(this,Rp,t),C(this,$l,n),C(this,kp,c||null),this.page=a,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return m(this,Yl).size>0}async render(e){var l;const{annotations:t}=e,n=this.div;hc(n,this.viewport);const i=new Map,a={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new gw,annotationStorage:e.annotationStorage||new pw,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const d=c.annotationType===Qt.POPUP;if(d){const y=i.get(c.id);if(!y)continue;a.elements=y}else{const{width:y,height:_}=Eo(c.rect);if(y<=0||_<=0)continue}a.data=c;const h=q4.create(a);if(!h.isRenderable)continue;if(!d&&c.popupRef){const y=i.get(c.popupRef);y?y.push(h):i.set(c.popupRef,[h])}const p=h.render();c.hidden&&(p.style.visibility="hidden"),await M(this,mc,u2).call(this,p,c.id),h._isEditable&&(m(this,Yl).set(h.data.id,h),(l=this._annotationEditorUIManager)==null||l.renderAnnotationElement(h))}M(this,mc,dx).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,hc(t,{rotation:e.rotation}),M(this,mc,dx).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(m(this,Yl).values())}getEditableAnnotation(e){return m(this,Yl).get(e)}}Rp=new WeakMap,$l=new WeakMap,Yl=new WeakMap,kp=new WeakMap,mc=new WeakSet,u2=async function(e,t){var l,c;const n=e.firstChild||e,i=n.id=`${cw}${t}`,a=await((l=m(this,kp))==null?void 0:l.getAriaAttributes(i));if(a)for(const[d,h]of a)n.setAttribute(d,h);this.div.append(e),(c=m(this,Rp))==null||c.moveElementInDOM(this.div,e,n,!1)},dx=function(){if(!m(this,$l))return;const e=this.div;for(const[t,n]of m(this,$l)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:a}=i;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):i.append(n)}m(this,$l).clear()};const Ng=/\r\n?|\n/g;var Ei,Rs,Mp,Kl,ks,Jt,d2,h2,f2,Qg,ua,Zg,e0,p2,fx,m2;const xt=class xt extends It{constructor(t){super({...t,name:"freeTextEditor"});k(this,Jt);k(this,Ei);k(this,Rs,"");k(this,Mp,`${this.id}-editor`);k(this,Kl,null);k(this,ks);C(this,Ei,t.color||xt._defaultColor||It._defaultLineColor),C(this,ks,t.fontSize||xt._defaultFontSize)}static get _keyboardManager(){const t=xt.prototype,n=l=>l.isEmpty(),i=fc.TRANSLATE_SMALL,a=fc.TRANSLATE_BIG;return $e(this,"_keyboardManager",new tm([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:n}]]))}static initialize(t,n){It.initialize(t,n);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case Qe.FREETEXT_SIZE:xt._defaultFontSize=n;break;case Qe.FREETEXT_COLOR:xt._defaultColor=n;break}}updateParams(t,n){switch(t){case Qe.FREETEXT_SIZE:M(this,Jt,d2).call(this,n);break;case Qe.FREETEXT_COLOR:M(this,Jt,h2).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Qe.FREETEXT_SIZE,xt._defaultFontSize],[Qe.FREETEXT_COLOR,xt._defaultColor||It._defaultLineColor]]}get propertiesToUpdate(){return[[Qe.FREETEXT_SIZE,m(this,ks)],[Qe.FREETEXT_COLOR,m(this,Ei)]]}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-xt._internalPadding*t,-(xt._internalPadding+m(this,ks))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(He.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),C(this,Kl,new AbortController);const t=this._uiManager.combinedSignal(m(this,Kl));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",m(this,Mp)),this._isDraggable=!0,(t=m(this,Kl))==null||t.abort(),C(this,Kl,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=m(this,Rs),n=C(this,Rs,M(this,Jt,f2).call(this).trimEnd());if(t===n)return;const i=a=>{if(C(this,Rs,a),!a){this.remove();return}M(this,Jt,e0).call(this),this._uiManager.rebuild(this),M(this,Jt,Qg).call(this)};this.addCommands({cmd:()=>{i(n)},undo:()=>{i(t)},mustExec:!1}),M(this,Jt,Qg).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){xt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,n;this.width&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",m(this,Mp)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${m(this,ks)}px * var(--scale-factor))`,i.color=m(this,Ei),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),b0(this,this.div,["dblclick","keydown"]),this.width){const[a,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[d,h]=this.getInitialTranslation();[d,h]=this.pageTranslationToScreen(d,h);const[p,y]=this.pageDimensions,[_,S]=this.pageTranslation;let A,E;switch(this.rotation){case 0:A=t+(c[0]-_)/p,E=n+this.height-(c[1]-S)/y;break;case 90:A=t+(c[0]-_)/p,E=n-(c[1]-S)/y,[d,h]=[h,-d];break;case 180:A=t-this.width+(c[0]-_)/p,E=n-(c[1]-S)/y,[d,h]=[-d,-h];break;case 270:A=t+(c[0]-_-this.height*y)/p,E=n+(c[1]-S-this.width*p)/y,[d,h]=[-h,d];break}this.setAt(A*a,E*l,d,h)}else this.setAt(t*a,n*l,this.width*a,this.height*l);M(this,Jt,e0).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var A,E,N;const n=t.clipboardData||window.clipboardData,{types:i}=n;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const a=M(A=xt,ua,fx).call(A,n.getData("text")||"").replaceAll(Ng,`
`);if(!a)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!a.includes(`
`)){c.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:d,startOffset:h}=c,p=[],y=[];if(d.nodeType===Node.TEXT_NODE){const R=d.parentElement;if(y.push(d.nodeValue.slice(h).replaceAll(Ng,"")),R!==this.editorDiv){let D=p;for(const P of this.editorDiv.childNodes){if(P===R){D=y;continue}D.push(M(E=xt,ua,Zg).call(E,P))}}p.push(d.nodeValue.slice(0,h).replaceAll(Ng,""))}else if(d===this.editorDiv){let R=p,D=0;for(const P of this.editorDiv.childNodes)D++===h&&(R=y),R.push(M(N=xt,ua,Zg).call(N,P))}C(this,Rs,`${p.join(`
`)}${a}${y.join(`
`)}`),M(this,Jt,e0).call(this);const _=new Range;let S=p.reduce((R,D)=>R+D.length,0);for(const{firstChild:R}of this.editorDiv.childNodes)if(R.nodeType===Node.TEXT_NODE){const D=R.nodeValue.length;if(S<=D){_.setStart(R,S),_.setEnd(R,S);break}S-=D}l.removeAllRanges(),l.addRange(_)}get contentDiv(){return this.editorDiv}static async deserialize(t,n,i){var c;let a=null;if(t instanceof a2){const{data:{defaultAppearanceData:{fontSize:d,fontColor:h},rect:p,rotation:y,id:_,popupRef:S},textContent:A,textPosition:E,parent:{page:{pageNumber:N}}}=t;if(!A||A.length===0)return null;a=t={annotationType:He.FREETEXT,color:Array.from(h),fontSize:d,value:A.join(`
`),position:E,pageIndex:N-1,rect:p.slice(0),rotation:y,id:_,deleted:!1,popupRef:S}}const l=await super.deserialize(t,n,i);return C(l,ks,t.fontSize),C(l,Ei,Ce.makeHexColor(...t.color)),C(l,Rs,M(c=xt,ua,fx).call(c,t.value)),l.annotationElementId=t.id||null,l._initialData=a,l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=xt._internalPadding*this.parentScale,i=this.getRect(n,n),a=It._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:m(this,Ei)),l={annotationType:He.FREETEXT,color:a,fontSize:m(this,ks),value:M(this,Jt,p2).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?l:this.annotationElementId&&!M(this,Jt,m2).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(this.deleted)return n;const{style:i}=n;i.fontSize=`calc(${m(this,ks)}px * var(--scale-factor))`,i.color=m(this,Ei),n.replaceChildren();for(const l of m(this,Rs).split(`
`)){const c=document.createElement("div");c.append(l?document.createTextNode(l):document.createElement("br")),n.append(c)}const a=xt._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(a,a),popupContent:m(this,Rs)}),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Ei=new WeakMap,Rs=new WeakMap,Mp=new WeakMap,Kl=new WeakMap,ks=new WeakMap,Jt=new WeakSet,d2=function(t){const n=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--scale-factor))`,this.translate(0,-(a-m(this,ks))*this.parentScale),C(this,ks,a),M(this,Jt,Qg).call(this)},i=m(this,ks);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},h2=function(t){const n=a=>{C(this,Ei,this.editorDiv.style.color=a)},i=m(this,Ei);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},f2=function(){var i;const t=[];this.editorDiv.normalize();let n=null;for(const a of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&a.nodeName==="BR"||(t.push(M(i=xt,ua,Zg).call(i,a)),n=a);return t.join(`
`)},Qg=function(){const[t,n]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:a,div:l}=this,c=l.style.display,d=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",a.div.append(this.div),i=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",d)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/n):(this.width=i.height/t,this.height=i.width/n),this.fixAndSetPosition()},ua=new WeakSet,Zg=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Ng,"")},e0=function(){if(this.editorDiv.replaceChildren(),!!m(this,Rs))for(const t of m(this,Rs).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},p2=function(){return m(this,Rs).replaceAll(""," ")},fx=function(t){return t.replaceAll(" ","")},m2=function(t){const{value:n,fontSize:i,color:a,pageIndex:l}=this._initialData;return this._hasBeenMoved||t.value!==n||t.fontSize!==i||t.color.some((c,d)=>c!==a[d])||t.pageIndex!==l},k(xt,ua),Me(xt,"_freeTextDefaultContent",""),Me(xt,"_internalPadding",0),Me(xt,"_defaultColor",null),Me(xt,"_defaultFontSize",10),Me(xt,"_type","freetext"),Me(xt,"_editorType",He.FREETEXT);let hx=xt;class ve{toSVGPath(){bt("Abstract method `toSVGPath` must be implemented.")}get box(){bt("Abstract getter `box` must be implemented.")}serialize(e,t){bt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,i,a,l){l||(l=new Float32Array(e.length));for(let c=0,d=e.length;c<d;c+=2)l[c]=t+e[c]*i,l[c+1]=n+e[c+1]*a;return l}static _rescaleAndSwap(e,t,n,i,a,l){l||(l=new Float32Array(e.length));for(let c=0,d=e.length;c<d;c+=2)l[c]=t+e[c+1]*i,l[c+1]=n+e[c]*a;return l}static _translate(e,t,n,i){i||(i=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)i[a]=t+e[a],i[a+1]=n+e[a+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,i,a){switch(a){case 90:return[1-t/n,e/i];case 180:return[1-e/n,1-t/i];case 270:return[t/n,1-e/i];default:return[e/n,t/i]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,i,a,l){return[(e+5*n)/6,(t+5*i)/6,(5*n+a)/6,(5*i+l)/6,(n+a)/2,(i+l)/2]}}Me(ve,"PRECISION",1e-4);var Ms,Ti,fd,pd,ir,Ve,Xl,Jl,Ip,Dp,md,gd,po,Pp,$0,Y0,sn,af,g2,v2,y2,b2,_2,x2;const Or=class Or{constructor({x:e,y:t},n,i,a,l,c=0){k(this,sn);k(this,Ms);k(this,Ti,[]);k(this,fd);k(this,pd);k(this,ir,[]);k(this,Ve,new Float32Array(18));k(this,Xl);k(this,Jl);k(this,Ip);k(this,Dp);k(this,md);k(this,gd);k(this,po,[]);C(this,Ms,n),C(this,gd,a*i),C(this,pd,l),m(this,Ve).set([NaN,NaN,NaN,NaN,e,t],6),C(this,fd,c),C(this,Dp,m(Or,Pp)*i),C(this,Ip,m(Or,Y0)*i),C(this,md,i),m(this,po).push(e,t)}isEmpty(){return isNaN(m(this,Ve)[8])}add({x:e,y:t}){var Y;C(this,Xl,e),C(this,Jl,t);const[n,i,a,l]=m(this,Ms);let[c,d,h,p]=m(this,Ve).subarray(8,12);const y=e-h,_=t-p,S=Math.hypot(y,_);if(S<m(this,Ip))return!1;const A=S-m(this,Dp),E=A/S,N=E*y,R=E*_;let D=c,P=d;c=h,d=p,h+=N,p+=R,(Y=m(this,po))==null||Y.push(e,t);const L=-R/A,z=N/A,H=L*m(this,gd),F=z*m(this,gd);return m(this,Ve).set(m(this,Ve).subarray(2,8),0),m(this,Ve).set([h+H,p+F],4),m(this,Ve).set(m(this,Ve).subarray(14,18),12),m(this,Ve).set([h-H,p-F],16),isNaN(m(this,Ve)[6])?(m(this,ir).length===0&&(m(this,Ve).set([c+H,d+F],2),m(this,ir).push(NaN,NaN,NaN,NaN,(c+H-n)/a,(d+F-i)/l),m(this,Ve).set([c-H,d-F],14),m(this,Ti).push(NaN,NaN,NaN,NaN,(c-H-n)/a,(d-F-i)/l)),m(this,Ve).set([D,P,c,d,h,p],6),!this.isEmpty()):(m(this,Ve).set([D,P,c,d,h,p],6),Math.abs(Math.atan2(P-d,D-c)-Math.atan2(R,N))<Math.PI/2?([c,d,h,p]=m(this,Ve).subarray(2,6),m(this,ir).push(NaN,NaN,NaN,NaN,((c+h)/2-n)/a,((d+p)/2-i)/l),[c,d,D,P]=m(this,Ve).subarray(14,18),m(this,Ti).push(NaN,NaN,NaN,NaN,((D+c)/2-n)/a,((P+d)/2-i)/l),!0):([D,P,c,d,h,p]=m(this,Ve).subarray(0,6),m(this,ir).push(((D+5*c)/6-n)/a,((P+5*d)/6-i)/l,((5*c+h)/6-n)/a,((5*d+p)/6-i)/l,((c+h)/2-n)/a,((d+p)/2-i)/l),[h,p,c,d,D,P]=m(this,Ve).subarray(12,18),m(this,Ti).push(((D+5*c)/6-n)/a,((P+5*d)/6-i)/l,((5*c+h)/6-n)/a,((5*d+p)/6-i)/l,((c+h)/2-n)/a,((d+p)/2-i)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=m(this,ir),t=m(this,Ti);if(isNaN(m(this,Ve)[6])&&!this.isEmpty())return M(this,sn,g2).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);M(this,sn,y2).call(this,n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return M(this,sn,v2).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,i,a,l){return new w2(e,t,n,i,a,l)}getOutlines(){var y;const e=m(this,ir),t=m(this,Ti),n=m(this,Ve),[i,a,l,c]=m(this,Ms),d=new Float32Array((((y=m(this,po))==null?void 0:y.length)??0)+2);for(let _=0,S=d.length-2;_<S;_+=2)d[_]=(m(this,po)[_]-i)/l,d[_+1]=(m(this,po)[_+1]-a)/c;if(d[d.length-2]=(m(this,Xl)-i)/l,d[d.length-1]=(m(this,Jl)-a)/c,isNaN(n[6])&&!this.isEmpty())return M(this,sn,b2).call(this,d);const h=new Float32Array(m(this,ir).length+24+m(this,Ti).length);let p=e.length;for(let _=0;_<p;_+=2){if(isNaN(e[_])){h[_]=h[_+1]=NaN;continue}h[_]=e[_],h[_+1]=e[_+1]}p=M(this,sn,x2).call(this,h,p);for(let _=t.length-6;_>=6;_-=6)for(let S=0;S<6;S+=2){if(isNaN(t[_+S])){h[p]=h[p+1]=NaN,p+=2;continue}h[p]=t[_+S],h[p+1]=t[_+S+1],p+=2}return M(this,sn,_2).call(this,h,p),this.newFreeDrawOutline(h,d,m(this,Ms),m(this,md),m(this,fd),m(this,pd))}};Ms=new WeakMap,Ti=new WeakMap,fd=new WeakMap,pd=new WeakMap,ir=new WeakMap,Ve=new WeakMap,Xl=new WeakMap,Jl=new WeakMap,Ip=new WeakMap,Dp=new WeakMap,md=new WeakMap,gd=new WeakMap,po=new WeakMap,Pp=new WeakMap,$0=new WeakMap,Y0=new WeakMap,sn=new WeakSet,af=function(){const e=m(this,Ve).subarray(4,6),t=m(this,Ve).subarray(16,18),[n,i,a,l]=m(this,Ms);return[(m(this,Xl)+(e[0]-t[0])/2-n)/a,(m(this,Jl)+(e[1]-t[1])/2-i)/l,(m(this,Xl)+(t[0]-e[0])/2-n)/a,(m(this,Jl)+(t[1]-e[1])/2-i)/l]},g2=function(){const[e,t,n,i]=m(this,Ms),[a,l,c,d]=M(this,sn,af).call(this);return`M${(m(this,Ve)[2]-e)/n} ${(m(this,Ve)[3]-t)/i} L${(m(this,Ve)[4]-e)/n} ${(m(this,Ve)[5]-t)/i} L${a} ${l} L${c} ${d} L${(m(this,Ve)[16]-e)/n} ${(m(this,Ve)[17]-t)/i} L${(m(this,Ve)[14]-e)/n} ${(m(this,Ve)[15]-t)/i} Z`},v2=function(e){const t=m(this,Ti);e.push(`L${t[4]} ${t[5]} Z`)},y2=function(e){const[t,n,i,a]=m(this,Ms),l=m(this,Ve).subarray(4,6),c=m(this,Ve).subarray(16,18),[d,h,p,y]=M(this,sn,af).call(this);e.push(`L${(l[0]-t)/i} ${(l[1]-n)/a} L${d} ${h} L${p} ${y} L${(c[0]-t)/i} ${(c[1]-n)/a}`)},b2=function(e){const t=m(this,Ve),[n,i,a,l]=m(this,Ms),[c,d,h,p]=M(this,sn,af).call(this),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(t[2]-n)/a,(t[3]-i)/l,NaN,NaN,NaN,NaN,(t[4]-n)/a,(t[5]-i)/l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,h,p,NaN,NaN,NaN,NaN,(t[16]-n)/a,(t[17]-i)/l,NaN,NaN,NaN,NaN,(t[14]-n)/a,(t[15]-i)/l],0),this.newFreeDrawOutline(y,e,m(this,Ms),m(this,md),m(this,fd),m(this,pd))},_2=function(e,t){const n=m(this,Ti);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},x2=function(e,t){const n=m(this,Ve).subarray(4,6),i=m(this,Ve).subarray(16,18),[a,l,c,d]=m(this,Ms),[h,p,y,_]=M(this,sn,af).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-a)/c,(n[1]-l)/d,NaN,NaN,NaN,NaN,h,p,NaN,NaN,NaN,NaN,y,_,NaN,NaN,NaN,NaN,(i[0]-a)/c,(i[1]-l)/d],t),t+=24},k(Or,Pp,8),k(Or,$0,2),k(Or,Y0,m(Or,Pp)+m(Or,$0));let w0=Or;var vd,Wl,ta,Lp,Is,Op,zt,K0,S2;class w2 extends ve{constructor(t,n,i,a,l,c){super();k(this,K0);k(this,vd);k(this,Wl,new Float32Array(4));k(this,ta);k(this,Lp);k(this,Is);k(this,Op);k(this,zt);C(this,zt,t),C(this,Is,n),C(this,vd,i),C(this,Op,a),C(this,ta,l),C(this,Lp,c),this.lastPoint=[NaN,NaN],M(this,K0,S2).call(this,c);const[d,h,p,y]=m(this,Wl);for(let _=0,S=t.length;_<S;_+=2)t[_]=(t[_]-d)/p,t[_+1]=(t[_+1]-h)/y;for(let _=0,S=n.length;_<S;_+=2)n[_]=(n[_]-d)/p,n[_+1]=(n[_+1]-h)/y}toSVGPath(){const t=[`M${m(this,zt)[4]} ${m(this,zt)[5]}`];for(let n=6,i=m(this,zt).length;n<i;n+=6){if(isNaN(m(this,zt)[n])){t.push(`L${m(this,zt)[n+4]} ${m(this,zt)[n+5]}`);continue}t.push(`C${m(this,zt)[n]} ${m(this,zt)[n+1]} ${m(this,zt)[n+2]} ${m(this,zt)[n+3]} ${m(this,zt)[n+4]} ${m(this,zt)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,i,a],l){const c=i-t,d=a-n;let h,p;switch(l){case 0:h=ve._rescale(m(this,zt),t,a,c,-d),p=ve._rescale(m(this,Is),t,a,c,-d);break;case 90:h=ve._rescaleAndSwap(m(this,zt),t,n,c,d),p=ve._rescaleAndSwap(m(this,Is),t,n,c,d);break;case 180:h=ve._rescale(m(this,zt),i,n,-c,d),p=ve._rescale(m(this,Is),i,n,-c,d);break;case 270:h=ve._rescaleAndSwap(m(this,zt),i,a,-c,-d),p=ve._rescaleAndSwap(m(this,Is),i,a,-c,-d);break}return{outline:Array.from(h),points:[Array.from(p)]}}get box(){return m(this,Wl)}newOutliner(t,n,i,a,l,c=0){return new w0(t,n,i,a,l,c)}getNewOutline(t,n){const[i,a,l,c]=m(this,Wl),[d,h,p,y]=m(this,vd),_=l*p,S=c*y,A=i*p+d,E=a*y+h,N=this.newOutliner({x:m(this,Is)[0]*_+A,y:m(this,Is)[1]*S+E},m(this,vd),m(this,Op),t,m(this,Lp),n??m(this,ta));for(let R=2;R<m(this,Is).length;R+=2)N.add({x:m(this,Is)[R]*_+A,y:m(this,Is)[R+1]*S+E});return N.getOutlines()}}vd=new WeakMap,Wl=new WeakMap,ta=new WeakMap,Lp=new WeakMap,Is=new WeakMap,Op=new WeakMap,zt=new WeakMap,K0=new WeakSet,S2=function(t){const n=m(this,zt);let i=n[4],a=n[5],l=i,c=a,d=i,h=a,p=i,y=a;const _=t?Math.max:Math.min;for(let A=6,E=n.length;A<E;A+=6){if(isNaN(n[A]))l=Math.min(l,n[A+4]),c=Math.min(c,n[A+5]),d=Math.max(d,n[A+4]),h=Math.max(h,n[A+5]),y<n[A+5]?(p=n[A+4],y=n[A+5]):y===n[A+5]&&(p=_(p,n[A+4]));else{const N=Ce.bezierBoundingBox(i,a,...n.slice(A,A+6));l=Math.min(l,N[0]),c=Math.min(c,N[1]),d=Math.max(d,N[2]),h=Math.max(h,N[3]),y<N[3]?(p=N[2],y=N[3]):y===N[3]&&(p=_(p,N[2]))}i=n[A+4],a=n[A+5]}const S=m(this,Wl);S[0]=l-m(this,ta),S[1]=c-m(this,ta),S[2]=d-l+2*m(this,ta),S[3]=h-c+2*m(this,ta),this.lastPoint=[p,y]};var Up,Fp,mo,Ci,Wn,A2,t0,E2,T2,mx;class px{constructor(e,t=0,n=0,i=!0){k(this,Wn);k(this,Up);k(this,Fp);k(this,mo,[]);k(this,Ci,[]);let a=1/0,l=-1/0,c=1/0,d=-1/0;const h=10**-4;for(const{x:N,y:R,width:D,height:P}of e){const L=Math.floor((N-t)/h)*h,z=Math.ceil((N+D+t)/h)*h,H=Math.floor((R-t)/h)*h,F=Math.ceil((R+P+t)/h)*h,X=[L,H,F,!0],Y=[z,H,F,!1];m(this,mo).push(X,Y),a=Math.min(a,L),l=Math.max(l,z),c=Math.min(c,H),d=Math.max(d,F)}const p=l-a+2*n,y=d-c+2*n,_=a-n,S=c-n,A=m(this,mo).at(i?-1:-2),E=[A[0],A[2]];for(const N of m(this,mo)){const[R,D,P]=N;N[0]=(R-_)/p,N[1]=(D-S)/y,N[2]=(P-S)/y}C(this,Up,new Float32Array([_,S,p,y])),C(this,Fp,E)}getOutlines(){m(this,mo).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of m(this,mo))t[3]?(e.push(...M(this,Wn,mx).call(this,t)),M(this,Wn,E2).call(this,t)):(M(this,Wn,T2).call(this,t),e.push(...M(this,Wn,mx).call(this,t)));return M(this,Wn,A2).call(this,e)}}Up=new WeakMap,Fp=new WeakMap,mo=new WeakMap,Ci=new WeakMap,Wn=new WeakSet,A2=function(e){const t=[],n=new Set;for(const l of e){const[c,d,h]=l;t.push([c,d,l],[c,h,l])}t.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=t.length;l<c;l+=2){const d=t[l][2],h=t[l+1][2];d.push(h),h.push(d),n.add(d),n.add(h)}const i=[];let a;for(;n.size>0;){const l=n.values().next().value;let[c,d,h,p,y]=l;n.delete(l);let _=c,S=d;for(a=[c,h],i.push(a);;){let A;if(n.has(p))A=p;else if(n.has(y))A=y;else break;n.delete(A),[c,d,h,p,y]=A,_!==c&&(a.push(_,S,c,S===d?d:h),_=c),S=S===d?h:d}a.push(_,S)}return new l3(i,m(this,Up),m(this,Fp))},t0=function(e){const t=m(this,Ci);let n=0,i=t.length-1;for(;n<=i;){const a=n+i>>1,l=t[a][0];if(l===e)return a;l<e?n=a+1:i=a-1}return i+1},E2=function([,e,t]){const n=M(this,Wn,t0).call(this,e);m(this,Ci).splice(n,0,[e,t])},T2=function([,e,t]){const n=M(this,Wn,t0).call(this,e);for(let i=n;i<m(this,Ci).length;i++){const[a,l]=m(this,Ci)[i];if(a!==e)break;if(a===e&&l===t){m(this,Ci).splice(i,1);return}}for(let i=n-1;i>=0;i--){const[a,l]=m(this,Ci)[i];if(a!==e)break;if(a===e&&l===t){m(this,Ci).splice(i,1);return}}},mx=function(e){const[t,n,i]=e,a=[[t,n,i]],l=M(this,Wn,t0).call(this,i);for(let c=0;c<l;c++){const[d,h]=m(this,Ci)[c];for(let p=0,y=a.length;p<y;p++){const[,_,S]=a[p];if(!(h<=_||S<=d)){if(_>=d){if(S>h)a[p][1]=h;else{if(y===1)return[];a.splice(p,1),p--,y--}continue}a[p][2]=d,S>h&&a.push([t,h,S])}}}return a};var jp,yd;class l3 extends ve{constructor(t,n,i){super();k(this,jp);k(this,yd);C(this,yd,t),C(this,jp,n),this.lastPoint=i}toSVGPath(){const t=[];for(const n of m(this,yd)){let[i,a]=n;t.push(`M${i} ${a}`);for(let l=2;l<n.length;l+=2){const c=n[l],d=n[l+1];c===i?(t.push(`V${d}`),a=d):d===a&&(t.push(`H${c}`),i=c)}t.push("Z")}return t.join(" ")}serialize([t,n,i,a],l){const c=[],d=i-t,h=a-n;for(const p of m(this,yd)){const y=new Array(p.length);for(let _=0;_<p.length;_+=2)y[_]=t+p[_]*d,y[_+1]=a-p[_+1]*h;c.push(y)}return c}get box(){return m(this,jp)}get classNamesForOutlining(){return["highlightOutline"]}}jp=new WeakMap,yd=new WeakMap;class gx extends w0{newFreeDrawOutline(e,t,n,i,a,l){return new c3(e,t,n,i,a,l)}}class c3 extends w2{newOutliner(e,t,n,i,a,l=0){return new gx(e,t,n,i,a,l)}}var Ni,Ql,bd,nn,zp,_d,Hp,Bp,go,Ri,xd,Gp,mt,vx,yx,bx,el,C2,qa;const us=class us{constructor({editor:e=null,uiManager:t=null}){k(this,mt);k(this,Ni,null);k(this,Ql,null);k(this,bd);k(this,nn,null);k(this,zp,!1);k(this,_d,!1);k(this,Hp,null);k(this,Bp);k(this,go,null);k(this,Ri,null);k(this,xd);var n;e?(C(this,_d,!1),C(this,xd,Qe.HIGHLIGHT_COLOR),C(this,Hp,e)):(C(this,_d,!0),C(this,xd,Qe.HIGHLIGHT_DEFAULT_COLOR)),C(this,Ri,(e==null?void 0:e._uiManager)||t),C(this,Bp,m(this,Ri)._eventBus),C(this,bd,(e==null?void 0:e.color)||((n=m(this,Ri))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),m(us,Gp)||C(us,Gp,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return $e(this,"_keyboardManager",new tm([[["Escape","mac+Escape"],us.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],us.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],us.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],us.prototype._moveToPrevious],[["Home","mac+Home"],us.prototype._moveToBeginning],[["End","mac+End"],us.prototype._moveToEnd]]))}renderButton(){const e=C(this,Ni,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=m(this,Ri)._signal;e.addEventListener("click",M(this,mt,el).bind(this),{signal:t}),e.addEventListener("keydown",M(this,mt,bx).bind(this),{signal:t});const n=C(this,Ql,document.createElement("span"));return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=m(this,bd),e.append(n),e}renderMainDropdown(){const e=C(this,nn,M(this,mt,vx).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===m(this,Ni)){M(this,mt,el).call(this,e);return}const t=e.target.getAttribute("data-color");t&&M(this,mt,yx).call(this,t,e)}_moveToNext(e){var t,n;if(!m(this,mt,qa)){M(this,mt,el).call(this,e);return}if(e.target===m(this,Ni)){(t=m(this,nn).firstChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=m(this,nn))==null?void 0:t.firstChild)||e.target===m(this,Ni)){m(this,mt,qa)&&this._hideDropdownFromKeyboard();return}m(this,mt,qa)||M(this,mt,el).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!m(this,mt,qa)){M(this,mt,el).call(this,e);return}(t=m(this,nn).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!m(this,mt,qa)){M(this,mt,el).call(this,e);return}(t=m(this,nn).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=m(this,nn))==null||e.classList.add("hidden"),(t=m(this,go))==null||t.abort(),C(this,go,null)}_hideDropdownFromKeyboard(){var e;if(!m(this,_d)){if(!m(this,mt,qa)){(e=m(this,Hp))==null||e.unselect();return}this.hideDropdown(),m(this,Ni).focus({preventScroll:!0,focusVisible:m(this,zp)})}}updateColor(e){if(m(this,Ql)&&(m(this,Ql).style.backgroundColor=e),!m(this,nn))return;const t=m(this,Ri).highlightColors.values();for(const n of m(this,nn).children)n.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=m(this,Ni))==null||e.remove(),C(this,Ni,null),C(this,Ql,null),(t=m(this,nn))==null||t.remove(),C(this,nn,null)}};Ni=new WeakMap,Ql=new WeakMap,bd=new WeakMap,nn=new WeakMap,zp=new WeakMap,_d=new WeakMap,Hp=new WeakMap,Bp=new WeakMap,go=new WeakMap,Ri=new WeakMap,xd=new WeakMap,Gp=new WeakMap,mt=new WeakSet,vx=function(){const e=document.createElement("div"),t=m(this,Ri)._signal;e.addEventListener("contextmenu",Ui,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,i]of m(this,Ri).highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",i),a.title=n,a.setAttribute("data-l10n-id",m(us,Gp)[n]);const l=document.createElement("span");a.append(l),l.className="swatch",l.style.backgroundColor=i,a.setAttribute("aria-selected",i===m(this,bd)),a.addEventListener("click",M(this,mt,yx).bind(this,i),{signal:t}),e.append(a)}return e.addEventListener("keydown",M(this,mt,bx).bind(this),{signal:t}),e},yx=function(e,t){t.stopPropagation(),m(this,Bp).dispatch("switchannotationeditorparams",{source:this,type:m(this,xd),value:e})},bx=function(e){us._keyboardManager.exec(this,e)},el=function(e){if(m(this,mt,qa)){this.hideDropdown();return}if(C(this,zp,e.detail===0),m(this,go)||(C(this,go,new AbortController),window.addEventListener("pointerdown",M(this,mt,C2).bind(this),{signal:m(this,Ri).combinedSignal(m(this,go))})),m(this,nn)){m(this,nn).classList.remove("hidden");return}const t=C(this,nn,M(this,mt,vx).call(this));m(this,Ni).append(t)},C2=function(e){var t;(t=m(this,nn))!=null&&t.contains(e.target)||this.hideDropdown()},qa=function(){return m(this,nn)&&!m(this,nn).classList.contains("hidden")},k(us,Gp,null);let S0=us;var wd,qp,na,Zl,Sd,fs,Vp,$p,ec,ii,Ds,Sn,Ad,sa,Dn,Ed,ri,Yp,je,_x,n0,N2,R2,k2,xx,tl,ci,yu,M2,s0,of,I2,D2,P2,L2,O2;const at=class at extends It{constructor(t){super({...t,name:"highlightEditor"});k(this,je);k(this,wd,null);k(this,qp,0);k(this,na);k(this,Zl,null);k(this,Sd,null);k(this,fs,null);k(this,Vp,null);k(this,$p,0);k(this,ec,null);k(this,ii,null);k(this,Ds,null);k(this,Sn,!1);k(this,Ad,null);k(this,sa);k(this,Dn,null);k(this,Ed,"");k(this,ri);k(this,Yp,"");this.color=t.color||at._defaultColor,C(this,ri,t.thickness||at._defaultThickness),C(this,sa,t.opacity||at._defaultOpacity),C(this,na,t.boxes||null),C(this,Yp,t.methodOfCreation||""),C(this,Ed,t.text||""),this._isDraggable=!1,t.highlightId>-1?(C(this,Sn,!0),M(this,je,n0).call(this,t),M(this,je,tl).call(this)):m(this,na)&&(C(this,wd,t.anchorNode),C(this,qp,t.anchorOffset),C(this,Vp,t.focusNode),C(this,$p,t.focusOffset),M(this,je,_x).call(this),M(this,je,tl).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=at.prototype;return $e(this,"_keyboardManager",new tm([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:m(this,Sn)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:m(this,ri),methodOfCreation:m(this,Yp)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var i;It.initialize(t,n),at._defaultColor||(at._defaultColor=((i=n.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case Qe.HIGHLIGHT_DEFAULT_COLOR:at._defaultColor=n;break;case Qe.HIGHLIGHT_THICKNESS:at._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return m(this,Ad)}updateParams(t,n){switch(t){case Qe.HIGHLIGHT_COLOR:M(this,je,N2).call(this,n);break;case Qe.HIGHLIGHT_THICKNESS:M(this,je,R2).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Qe.HIGHLIGHT_DEFAULT_COLOR,at._defaultColor],[Qe.HIGHLIGHT_THICKNESS,at._defaultThickness]]}get propertiesToUpdate(){return[[Qe.HIGHLIGHT_COLOR,this.color||at._defaultColor],[Qe.HIGHLIGHT_THICKNESS,m(this,ri)||at._defaultThickness],[Qe.HIGHLIGHT_FREE,m(this,Sn)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(C(this,Sd,new S0({editor:this})),t.addColorPicker(m(this,Sd))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(M(this,je,of).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,M(this,je,of).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){M(this,je,xx).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,je,tl).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let n=!1;this.parent&&!t?M(this,je,xx).call(this):t&&(M(this,je,tl).call(this,t),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var a,l,c;const{drawLayer:n}=this.parent;let i;m(this,Sn)?(t=(t-this.rotation+360)%360,i=M(a=at,ci,yu).call(a,m(this,ii).box,t)):i=M(l=at,ci,yu).call(l,[this.x,this.y,this.width,this.height],t),n.updateProperties(m(this,Ds),{bbox:i,root:{"data-main-rotation":t}}),n.updateProperties(m(this,Dn),{bbox:M(c=at,ci,yu).call(c,m(this,fs).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();m(this,Ed)&&(t.setAttribute("aria-label",m(this,Ed)),t.setAttribute("role","mark")),m(this,Sn)?t.classList.add("free"):this.div.addEventListener("keydown",M(this,je,M2).bind(this),{signal:this._uiManager._signal});const n=C(this,ec,document.createElement("div"));t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=m(this,Zl);const[i,a]=this.parentDimensions;return this.setDims(this.width*i,this.height*a),b0(this,m(this,ec),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(m(this,Dn),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(m(this,Dn),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:M(this,je,s0).call(this,!0);break;case 1:case 3:M(this,je,s0).call(this,!1);break}}select(){var t;super.select(),m(this,Dn)&&((t=this.parent)==null||t.drawLayer.updateProperties(m(this,Dn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),m(this,Dn)&&((t=this.parent)==null||t.drawLayer.updateProperties(m(this,Dn),{rootClass:{selected:!1}}),m(this,Sn)||M(this,je,s0).call(this,!1))}get _mustFixPosition(){return!m(this,Sn)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(m(this,Ds),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(m(this,Dn),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:i,x:a,y:l}){const{x:c,y:d,width:h,height:p}=i.getBoundingClientRect(),y=new AbortController,_=t.combinedSignal(y),S=A=>{y.abort(),M(this,ci,L2).call(this,t,A)};window.addEventListener("blur",S,{signal:_}),window.addEventListener("pointerup",S,{signal:_}),window.addEventListener("pointerdown",Hs,{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",Ui,{signal:_}),i.addEventListener("pointermove",M(this,ci,P2).bind(this,t),{signal:_}),this._freeHighlight=new gx({x:a,y:l},[c,d,h,p],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,i){var E,N,R,D;let a=null;if(t instanceof l2){const{data:{quadPoints:P,rect:L,rotation:z,id:H,color:F,opacity:X,popupRef:Y},parent:{page:{pageNumber:J}}}=t;a=t={annotationType:He.HIGHLIGHT,color:Array.from(F),opacity:X,quadPoints:P,boxes:null,pageIndex:J-1,rect:L.slice(0),rotation:z,id:H,deleted:!1,popupRef:Y}}else if(t instanceof vw){const{data:{inkLists:P,rect:L,rotation:z,id:H,color:F,borderStyle:{rawWidth:X},popupRef:Y},parent:{page:{pageNumber:J}}}=t;a=t={annotationType:He.HIGHLIGHT,color:Array.from(F),thickness:X,inkLists:P,boxes:null,pageIndex:J-1,rect:L.slice(0),rotation:z,id:H,deleted:!1,popupRef:Y}}const{color:l,quadPoints:c,inkLists:d,opacity:h}=t,p=await super.deserialize(t,n,i);p.color=Ce.makeHexColor(...l),C(p,sa,h||1),d&&C(p,ri,t.thickness),p.annotationElementId=t.id||null,p._initialData=a;const[y,_]=p.pageDimensions,[S,A]=p.pageTranslation;if(c){const P=C(p,na,[]);for(let L=0;L<c.length;L+=8)P.push({x:(c[L]-S)/y,y:1-(c[L+1]-A)/_,width:(c[L+2]-c[L])/y,height:(c[L+1]-c[L+5])/_});M(E=p,je,_x).call(E),M(N=p,je,tl).call(N),p.rotate(p.rotation)}else if(d){C(p,Sn,!0);const P=d[0],L={x:P[0]-S,y:_-(P[1]-A)},z=new gx(L,[0,0,y,_],1,m(p,ri)/2,!0,.001);for(let X=0,Y=P.length;X<Y;X+=2)L.x=P[X]-S,L.y=_-(P[X+1]-A),z.add(L);const{id:H,clipPathId:F}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:p.color,"fill-opacity":p._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:z.toSVGPath()}},!0,!0);M(R=p,je,n0).call(R,{highlightOutlines:z.getOutlines(),highlightId:H,clipPathId:F}),M(D=p,je,tl).call(D)}return p}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),i=It._colorManager.convert(this.color),a={annotationType:He.HIGHLIGHT,color:i,opacity:m(this,sa),thickness:m(this,ri),quadPoints:M(this,je,I2).call(this),outlines:M(this,je,D2).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:M(this,je,of).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!M(this,je,O2).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};wd=new WeakMap,qp=new WeakMap,na=new WeakMap,Zl=new WeakMap,Sd=new WeakMap,fs=new WeakMap,Vp=new WeakMap,$p=new WeakMap,ec=new WeakMap,ii=new WeakMap,Ds=new WeakMap,Sn=new WeakMap,Ad=new WeakMap,sa=new WeakMap,Dn=new WeakMap,Ed=new WeakMap,ri=new WeakMap,Yp=new WeakMap,je=new WeakSet,_x=function(){const t=new px(m(this,na),.001);C(this,ii,t.getOutlines()),[this.x,this.y,this.width,this.height]=m(this,ii).box;const n=new px(m(this,na),.0025,.001,this._uiManager.direction==="ltr");C(this,fs,n.getOutlines());const{lastPoint:i}=m(this,fs);C(this,Ad,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},n0=function({highlightOutlines:t,highlightId:n,clipPathId:i}){var y,_;if(C(this,ii,t),C(this,fs,t.getNewOutline(m(this,ri)/2+1.5,.0025)),n>=0)C(this,Ds,n),C(this,Zl,i),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),C(this,Dn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:m(this,fs).box,path:{d:m(this,fs).toSVGPath()}},!0));else if(this.parent){const S=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(m(this,Ds),{bbox:M(y=at,ci,yu).call(y,m(this,ii).box,(S-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(m(this,Dn),{bbox:M(_=at,ci,yu).call(_,m(this,fs).box,S),path:{d:m(this,fs).toSVGPath()}})}const[l,c,d,h]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=d,this.height=h;break;case 90:{const[S,A]=this.parentDimensions;this.x=c,this.y=1-l,this.width=d*A/S,this.height=h*S/A;break}case 180:this.x=1-l,this.y=1-c,this.width=d,this.height=h;break;case 270:{const[S,A]=this.parentDimensions;this.x=1-c,this.y=l,this.width=d*A/S,this.height=h*S/A;break}}const{lastPoint:p}=m(this,fs);C(this,Ad,[(p[0]-l)/d,(p[1]-c)/h])},N2=function(t){const n=(l,c)=>{var d,h;this.color=l,C(this,sa,c),(d=this.parent)==null||d.drawLayer.updateProperties(m(this,Ds),{root:{fill:l,"fill-opacity":c}}),(h=m(this,Sd))==null||h.updateColor(l)},i=this.color,a=m(this,sa);this.addCommands({cmd:n.bind(this,t,at._defaultOpacity),undo:n.bind(this,i,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},R2=function(t){const n=m(this,ri),i=a=>{C(this,ri,a),M(this,je,k2).call(this,a)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},k2=function(t){if(!m(this,Sn))return;M(this,je,n0).call(this,{highlightOutlines:m(this,ii).getNewOutline(t/2)}),this.fixAndSetPosition();const[n,i]=this.parentDimensions;this.setDims(this.width*n,this.height*i)},xx=function(){m(this,Ds)===null||!this.parent||(this.parent.drawLayer.remove(m(this,Ds)),C(this,Ds,null),this.parent.drawLayer.remove(m(this,Dn)),C(this,Dn,null))},tl=function(t=this.parent){m(this,Ds)===null&&({id:Bn(this,Ds)._,clipPathId:Bn(this,Zl)._}=t.drawLayer.draw({bbox:m(this,ii).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":m(this,sa)},rootClass:{highlight:!0,free:m(this,Sn)},path:{d:m(this,ii).toSVGPath()}},!1,!0),C(this,Dn,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:m(this,Sn)},bbox:m(this,fs).box,path:{d:m(this,fs).toSVGPath()}},m(this,Sn))),m(this,ec)&&(m(this,ec).style.clipPath=m(this,Zl)))},ci=new WeakSet,yu=function([t,n,i,a],l){switch(l){case 90:return[1-n-a,t,a,i];case 180:return[1-t-i,1-n-a,i,a];case 270:return[n,1-t-i,a,i]}return[t,n,i,a]},M2=function(t){at._keyboardManager.exec(this,t)},s0=function(t){if(!m(this,wd))return;const n=window.getSelection();t?n.setPosition(m(this,wd),m(this,qp)):n.setPosition(m(this,Vp),m(this,$p))},of=function(){return m(this,Sn)?this.rotation:0},I2=function(){if(m(this,Sn))return null;const[t,n]=this.pageDimensions,[i,a]=this.pageTranslation,l=m(this,na),c=new Float32Array(l.length*8);let d=0;for(const{x:h,y:p,width:y,height:_}of l){const S=h*t+i,A=(1-p)*n+a;c[d]=c[d+4]=S,c[d+1]=c[d+3]=A,c[d+2]=c[d+6]=S+y*t,c[d+5]=c[d+7]=A-_*n,d+=8}return c},D2=function(t){return m(this,ii).serialize(t,M(this,je,of).call(this))},P2=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},L2=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},O2=function(t){const{color:n}=this._initialData;return t.color.some((i,a)=>i!==n[a])},k(at,ci),Me(at,"_defaultColor",null),Me(at,"_defaultOpacity",1),Me(at,"_defaultThickness",12),Me(at,"_type","highlight"),Me(at,"_editorType",He.HIGHLIGHT),Me(at,"_freeHighlightId",-1),Me(at,"_freeHighlight",null),Me(at,"_freeHighlightClipId","");let A0=at;var tc;class u3{constructor(){k(this,tc,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))this.updateProperty(t,n)}updateSVGProperty(e,t){m(this,tc)[e]=t}toSVGProperties(){const e=m(this,tc);return C(this,tc,Object.create(null)),{root:e}}reset(){C(this,tc,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){bt("Not implemented")}}tc=new WeakMap;var Ps,Td,un,nc,sc,vo,yo,bo,ic,et,Sx,Ax,Ex,lf,U2,i0,cf,bu;const xe=class xe extends It{constructor(t){super(t);k(this,et);k(this,Ps,null);k(this,Td);Me(this,"_drawId",null);C(this,Td,t.mustBeCommitted||!1),t.drawOutlines&&(M(this,et,Sx).call(this,t),M(this,et,lf).call(this))}static _mergeSVGProperties(t,n){const i=new Set(Object.keys(t));for(const[a,l]of Object.entries(n))i.has(a)?Object.assign(t[a],l):t[a]=l;return t}static getDefaultDrawingOptions(t){bt("Not implemented")}static get typesMap(){bt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,n),this._currentParent&&(m(xe,un).updateProperty(i,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[i,a]of this.typesMap)t.push([i,n[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[i,a]of this.constructor.typesMap)t.push([i,n[a]]);return t}_updateProperty(t,n,i){const a=this._drawingOptions,l=a[n],c=d=>{var p;a.updateProperty(n,d);const h=m(this,Ps).updateProperty(n,d);h&&M(this,et,cf).call(this,h),(p=this.parent)==null||p.drawLayer.updateProperties(this._drawId,a.toSVGProperties())};this.addCommands({cmd:c.bind(this,i),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,xe._mergeSVGProperties(m(this,Ps).getPathResizingSVGProperties(M(this,et,i0).call(this)),{bbox:M(this,et,bu).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,xe._mergeSVGProperties(m(this,Ps).getPathResizedSVGProperties(M(this,et,i0).call(this)),{bbox:M(this,et,bu).call(this)}))}_onTranslating(t,n){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:M(this,et,bu).call(this,t,n)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,xe._mergeSVGProperties(m(this,Ps).getPathTranslatedSVGProperties(M(this,et,i0).call(this),this.parentDimensions),{bbox:M(this,et,bu).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,m(this,Td)&&(C(this,Td,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){M(this,et,Ex).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,et,lf).call(this),M(this,et,cf).call(this,m(this,Ps).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),M(this,et,Ex).call(this)):t&&(this._uiManager.addShouldRescale(this),M(this,et,lf).call(this,t),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,xe._mergeSVGProperties({bbox:M(this,et,bu).call(this)},m(this,Ps).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&M(this,et,cf).call(this,m(this,Ps).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const n=document.createElement("div");t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal";const[i,a]=this.parentDimensions;return this.setDims(this.width*i,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,n,i,a,l){bt("Not implemented")}static startDrawing(t,n,i,a){var N;const{target:l,offsetX:c,offsetY:d,pointerId:h,pointerType:p}=a;if(m(xe,yo)&&m(xe,yo)!==p)return;const{viewport:{rotation:y}}=t,{width:_,height:S}=l.getBoundingClientRect(),A=C(xe,nc,new AbortController),E=t.combinedSignal(A);if(m(xe,vo)||C(xe,vo,h),m(xe,yo)??C(xe,yo,p),window.addEventListener("pointerup",R=>{var D;m(xe,vo)===R.pointerId?this._endDraw(R):(D=m(xe,bo))==null||D.delete(R.pointerId)},{signal:E}),window.addEventListener("pointercancel",R=>{var D;m(xe,vo)===R.pointerId?this._currentParent.endDrawingSession():(D=m(xe,bo))==null||D.delete(R.pointerId)},{signal:E}),window.addEventListener("pointerdown",R=>{m(xe,yo)===R.pointerType&&((m(xe,bo)||C(xe,bo,new Set)).add(R.pointerId),m(xe,un).isCancellable()&&(m(xe,un).removeLastElement(),m(xe,un).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:E}),window.addEventListener("contextmenu",Ui,{signal:E}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:E}),l.addEventListener("touchmove",R=>{R.timeStamp===m(xe,ic)&&Hs(R)},{signal:E}),t.toggleDrawing(),(N=n._editorUndoBar)==null||N.hide(),m(xe,un)){t.drawLayer.updateProperties(this._currentDrawId,m(xe,un).startNew(c,d,_,S,y));return}n.updateUIForDefaultProperties(this),C(xe,un,this.createDrawerInstance(c,d,_,S,y)),C(xe,sc,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(m(xe,sc).toSVGProperties(),m(xe,un).defaultSVGProperties),!0,!1)}static _drawMove(t){var l;if(C(xe,ic,-1),!m(xe,un))return;const{offsetX:n,offsetY:i,pointerId:a}=t;if(m(xe,vo)===a){if(((l=m(xe,bo))==null?void 0:l.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,m(xe,un).add(n,i)),C(xe,ic,t.timeStamp),Hs(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,C(xe,un,null),C(xe,sc,null),C(xe,yo,null),C(xe,ic,NaN)),m(xe,nc)&&(m(xe,nc).abort(),C(xe,nc,null),C(xe,vo,NaN),C(xe,bo,null))}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),t&&n.drawLayer.updateProperties(this._currentDrawId,m(xe,un).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=m(xe,un),a=this._currentDrawId,l=i.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(a,i.setLastElement(l))},undo:()=>{n.drawLayer.updateProperties(a,i.removeLastElement())},mustExec:!1,type:Qe.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(Qe.DRAW_STEP),!m(xe,un).isEmpty()){const{pageDimensions:[i,a],scale:l}=n,c=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:m(xe,un).getOutlines(i*l,a*l,l,this._INNER_MARGIN),drawingOptions:m(xe,sc),mustBeCommitted:!t});return this._cleanup(!0),c}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,i,a,l,c){bt("Not implemented")}static async deserialize(t,n,i){var y,_;const{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:d}}=n.viewport,h=this.deserializeDraw(c,d,a,l,this._INNER_MARGIN,t),p=await super.deserialize(t,n,i);return p.createDrawingOptions(t),M(y=p,et,Sx).call(y,{drawOutlines:h}),M(_=p,et,lf).call(_),p.onScaleChanging(),p.rotate(),p}serializeDraw(t){const[n,i]=this.pageTranslation,[a,l]=this.pageDimensions;return m(this,Ps).serialize([n,i,a,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ps=new WeakMap,Td=new WeakMap,un=new WeakMap,nc=new WeakMap,sc=new WeakMap,vo=new WeakMap,yo=new WeakMap,bo=new WeakMap,ic=new WeakMap,et=new WeakSet,Sx=function({drawOutlines:t,drawId:n,drawingOptions:i}){C(this,Ps,t),this._drawingOptions||(this._drawingOptions=i),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=M(this,et,Ax).call(this,t,this.parent),M(this,et,cf).call(this,t.box)},Ax=function(t,n){const{id:i}=n.drawLayer.draw(xe._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},Ex=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},lf=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=M(this,et,Ax).call(this,m(this,Ps),t)}},U2=function([t,n,i,a]){const{parentDimensions:[l,c],rotation:d}=this;switch(d){case 90:return[n,1-t,i*(c/l),a*(l/c)];case 180:return[1-t,1-n,i,a];case 270:return[1-n,t,i*(c/l),a*(l/c)];default:return[t,n,i,a]}},i0=function(){const{x:t,y:n,width:i,height:a,parentDimensions:[l,c],rotation:d}=this;switch(d){case 90:return[1-n,t,i*(l/c),a*(c/l)];case 180:return[1-t,1-n,i,a];case 270:return[n,1-t,i*(l/c),a*(c/l)];default:return[t,n,i,a]}},cf=function(t){if([this.x,this.y,this.width,this.height]=M(this,et,U2).call(this,t),this.div){this.fixAndSetPosition();const[n,i]=this.parentDimensions;this.setDims(this.width*n,this.height*i)}this._onResized()},bu=function(){const{x:t,y:n,width:i,height:a,rotation:l,parentRotation:c,parentDimensions:[d,h]}=this;switch((l*4+c)/90){case 1:return[1-n-a,t,a,i];case 2:return[1-t-i,1-n-a,i,a];case 3:return[n,1-t-i,a,i];case 4:return[t,n-i*(d/h),a*(h/d),i*(d/h)];case 5:return[1-n,t,i*(d/h),a*(h/d)];case 6:return[1-t-a*(h/d),1-n,a*(h/d),i*(d/h)];case 7:return[n-i*(d/h),1-t-a*(h/d),i*(d/h),a*(h/d)];case 8:return[t-i,n-a,i,a];case 9:return[1-n,t-i,a,i];case 10:return[1-t,1-n,i,a];case 11:return[n-a,1-t,a,i];case 12:return[t-a*(h/d),n,a*(h/d),i*(d/h)];case 13:return[1-n-i*(d/h),t-a*(h/d),i*(d/h),a*(h/d)];case 14:return[1-t,1-n-i*(d/h),a*(h/d),i*(d/h)];case 15:return[n,1-t,i*(d/h),a*(h/d)];default:return[t,n,i,a]}},Me(xe,"_currentDrawId",-1),Me(xe,"_currentParent",null),k(xe,un,null),k(xe,nc,null),k(xe,sc,null),k(xe,vo,NaN),k(xe,yo,null),k(xe,bo,null),k(xe,ic,NaN),Me(xe,"_INNER_MARGIN",3);let wx=xe;var rr,dn,hn,rc,Cd,Vn,An,ai,ac,oc,lc,Nd,r0;class d3{constructor(e,t,n,i,a,l){k(this,Nd);k(this,rr,new Float64Array(6));k(this,dn);k(this,hn);k(this,rc);k(this,Cd);k(this,Vn);k(this,An,"");k(this,ai,0);k(this,ac,new E0);k(this,oc);k(this,lc);C(this,oc,n),C(this,lc,i),C(this,rc,a),C(this,Cd,l),[e,t]=M(this,Nd,r0).call(this,e,t);const c=C(this,dn,[NaN,NaN,NaN,NaN,e,t]);C(this,Vn,[e,t]),C(this,hn,[{line:c,points:m(this,Vn)}]),m(this,rr).set(c,0)}updateProperty(e,t){e==="stroke-width"&&C(this,Cd,t)}isEmpty(){return!m(this,hn)||m(this,hn).length===0}isCancellable(){return m(this,Vn).length<=10}add(e,t){[e,t]=M(this,Nd,r0).call(this,e,t);const[n,i,a,l]=m(this,rr).subarray(2,6),c=e-a,d=t-l;return Math.hypot(m(this,oc)*c,m(this,lc)*d)<=2?null:(m(this,Vn).push(e,t),isNaN(n)?(m(this,rr).set([a,l,e,t],2),m(this,dn).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(m(this,rr)[0])&&m(this,dn).splice(6,6),m(this,rr).set([n,i,a,l,e,t],0),m(this,dn).push(...ve.createBezierPoints(n,i,a,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(m(this,Vn).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,i,a){C(this,oc,n),C(this,lc,i),C(this,rc,a),[e,t]=M(this,Nd,r0).call(this,e,t);const l=C(this,dn,[NaN,NaN,NaN,NaN,e,t]);C(this,Vn,[e,t]);const c=m(this,hn).at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),m(this,hn).push({line:l,points:m(this,Vn)}),m(this,rr).set(l,0),C(this,ai,0),this.toSVGPath(),null}getLastElement(){return m(this,hn).at(-1)}setLastElement(e){return m(this,hn)?(m(this,hn).push(e),C(this,dn,e.line),C(this,Vn,e.points),C(this,ai,0),{path:{d:this.toSVGPath()}}):m(this,ac).setLastElement(e)}removeLastElement(){if(!m(this,hn))return m(this,ac).removeLastElement();m(this,hn).pop(),C(this,An,"");for(let e=0,t=m(this,hn).length;e<t;e++){const{line:n,points:i}=m(this,hn)[e];C(this,dn,n),C(this,Vn,i),C(this,ai,0),this.toSVGPath()}return{path:{d:m(this,An)}}}toSVGPath(){const e=ve.svgRound(m(this,dn)[4]),t=ve.svgRound(m(this,dn)[5]);if(m(this,Vn).length===2)return C(this,An,`${m(this,An)} M ${e} ${t} Z`),m(this,An);if(m(this,Vn).length<=6){const i=m(this,An).lastIndexOf("M");C(this,An,`${m(this,An).slice(0,i)} M ${e} ${t}`),C(this,ai,6)}if(m(this,Vn).length===4){const i=ve.svgRound(m(this,dn)[10]),a=ve.svgRound(m(this,dn)[11]);return C(this,An,`${m(this,An)} L ${i} ${a}`),C(this,ai,12),m(this,An)}const n=[];m(this,ai)===0&&(n.push(`M ${e} ${t}`),C(this,ai,6));for(let i=m(this,ai),a=m(this,dn).length;i<a;i+=6){const[l,c,d,h,p,y]=m(this,dn).slice(i,i+6).map(ve.svgRound);n.push(`C${l} ${c} ${d} ${h} ${p} ${y}`)}return C(this,An,m(this,An)+n.join(" ")),C(this,ai,m(this,dn).length),m(this,An)}getOutlines(e,t,n,i){const a=m(this,hn).at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),m(this,ac).build(m(this,hn),e,t,n,m(this,rc),m(this,Cd),i),C(this,rr,null),C(this,dn,null),C(this,hn,null),C(this,An,null),m(this,ac)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}rr=new WeakMap,dn=new WeakMap,hn=new WeakMap,rc=new WeakMap,Cd=new WeakMap,Vn=new WeakMap,An=new WeakMap,ai=new WeakMap,ac=new WeakMap,oc=new WeakMap,lc=new WeakMap,Nd=new WeakSet,r0=function(e,t){return ve._normalizePoint(e,t,m(this,oc),m(this,lc),m(this,rc))};var $n,Kp,Xp,Ls,ar,or,Rd,kd,Md,Tn,Dr,F2,j2,z2;const Iw=class Iw extends ve{constructor(){super(...arguments);k(this,Tn);k(this,$n);k(this,Kp,0);k(this,Xp);k(this,Ls);k(this,ar);k(this,or);k(this,Rd);k(this,kd);k(this,Md)}build(t,n,i,a,l,c,d){C(this,ar,n),C(this,or,i),C(this,Rd,a),C(this,kd,l),C(this,Md,c),C(this,Xp,d??0),C(this,Ls,t),M(this,Tn,j2).call(this)}setLastElement(t){return m(this,Ls).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return m(this,Ls).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of m(this,Ls)){if(t.push(`M${ve.svgRound(n[4])} ${ve.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12){t.push(`L${ve.svgRound(n[10])} ${ve.svgRound(n[11])}`);continue}for(let i=6,a=n.length;i<a;i+=6){const[l,c,d,h,p,y]=n.subarray(i,i+6).map(ve.svgRound);t.push(`C${l} ${c} ${d} ${h} ${p} ${y}`)}}return t.join("")}serialize([t,n,i,a],l){const c=[],d=[],[h,p,y,_]=M(this,Tn,F2).call(this);let S,A,E,N,R,D,P,L,z;switch(m(this,kd)){case 0:z=ve._rescale,S=t,A=n+a,E=i,N=-a,R=t+h*i,D=n+(1-p-_)*a,P=t+(h+y)*i,L=n+(1-p)*a;break;case 90:z=ve._rescaleAndSwap,S=t,A=n,E=i,N=a,R=t+p*i,D=n+h*a,P=t+(p+_)*i,L=n+(h+y)*a;break;case 180:z=ve._rescale,S=t+i,A=n,E=-i,N=a,R=t+(1-h-y)*i,D=n+p*a,P=t+(1-h)*i,L=n+(p+_)*a;break;case 270:z=ve._rescaleAndSwap,S=t+i,A=n+a,E=-i,N=-a,R=t+(1-p-_)*i,D=n+(1-h-y)*a,P=t+(1-p)*i,L=n+(1-h)*a;break}for(const{line:H,points:F}of m(this,Ls))c.push(z(H,S,A,E,N,l?new Array(H.length):null)),d.push(z(F,S,A,E,N,l?new Array(F.length):null));return{lines:c,points:d,rect:[R,D,P,L]}}static deserialize(t,n,i,a,l,{paths:{lines:c,points:d},rotation:h,thickness:p}){const y=[];let _,S,A,E,N;switch(h){case 0:N=ve._rescale,_=-t/i,S=n/a+1,A=1/i,E=-1/a;break;case 90:N=ve._rescaleAndSwap,_=-n/a,S=-t/i,A=1/a,E=1/i;break;case 180:N=ve._rescale,_=t/i+1,S=-n/a,A=-1/i,E=1/a;break;case 270:N=ve._rescaleAndSwap,_=n/a+1,S=t/i+1,A=-1/a,E=-1/i;break}if(!c){c=[];for(const D of d){const P=D.length;if(P===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,D[0],D[1]]));continue}if(P===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,D[0],D[1],NaN,NaN,NaN,NaN,D[2],D[3]]));continue}const L=new Float32Array(3*(P-2));c.push(L);let[z,H,F,X]=D.subarray(0,4);L.set([NaN,NaN,NaN,NaN,z,H],0);for(let Y=4;Y<P;Y+=2){const J=D[Y],ie=D[Y+1];L.set(ve.createBezierPoints(z,H,F,X,J,ie),(Y-2)*3),[z,H,F,X]=[F,X,J,ie]}}}for(let D=0,P=c.length;D<P;D++)y.push({line:N(c[D].map(L=>L??NaN),_,S,A,E),points:N(d[D].map(L=>L??NaN),_,S,A,E)});const R=new Iw;return R.build(y,i,a,1,h,p,l),R}get box(){return m(this,$n)}updateProperty(t,n){return t==="stroke-width"?M(this,Tn,z2).call(this,n):null}updateParentDimensions([t,n],i){const[a,l]=M(this,Tn,Dr).call(this);C(this,ar,t),C(this,or,n),C(this,Rd,i);const[c,d]=M(this,Tn,Dr).call(this),h=c-a,p=d-l,y=m(this,$n);return y[0]-=h,y[1]-=p,y[2]+=2*h,y[3]+=2*p,y}updateRotation(t){return C(this,Kp,t),{path:{transform:this.rotationTransform}}}get viewBox(){return m(this,$n).map(ve.svgRound).join(" ")}get defaultProperties(){const[t,n]=m(this,$n);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=m(this,$n);let i=0,a=0,l=0,c=0,d=0,h=0;switch(m(this,Kp)){case 90:a=n/t,l=-t/n,d=t;break;case 180:i=-1,c=-1,d=t,h=n;break;case 270:a=-n/t,l=t/n,h=n;break;default:return""}return`matrix(${i} ${a} ${l} ${c} ${ve.svgRound(d)} ${ve.svgRound(h)})`}getPathResizingSVGProperties([t,n,i,a]){const[l,c]=M(this,Tn,Dr).call(this),[d,h,p,y]=m(this,$n);if(Math.abs(p-l)<=ve.PRECISION||Math.abs(y-c)<=ve.PRECISION){const N=t+i/2-(d+p/2),R=n+a/2-(h+y/2);return{path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`,transform:`${this.rotationTransform} translate(${N} ${R})`}}}const _=(i-2*l)/(p-2*l),S=(a-2*c)/(y-2*c),A=p/i,E=y/a;return{path:{"transform-origin":`${ve.svgRound(d)} ${ve.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${E}) translate(${ve.svgRound(l)} ${ve.svgRound(c)}) scale(${_} ${S}) translate(${ve.svgRound(-l)} ${ve.svgRound(-c)})`}}}getPathResizedSVGProperties([t,n,i,a]){const[l,c]=M(this,Tn,Dr).call(this),d=m(this,$n),[h,p,y,_]=d;if(d[0]=t,d[1]=n,d[2]=i,d[3]=a,Math.abs(y-l)<=ve.PRECISION||Math.abs(_-c)<=ve.PRECISION){const R=t+i/2-(h+y/2),D=n+a/2-(p+_/2);for(const{line:P,points:L}of m(this,Ls))ve._translate(P,R,D,P),ve._translate(L,R,D,L);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const S=(i-2*l)/(y-2*l),A=(a-2*c)/(_-2*c),E=-S*(h+l)+t+l,N=-A*(p+c)+n+c;if(S!==1||A!==1||E!==0||N!==0)for(const{line:R,points:D}of m(this,Ls))ve._rescale(R,E,N,S,A,R),ve._rescale(D,E,N,S,A,D);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],i){const[a,l]=i,c=m(this,$n),d=t-c[0],h=n-c[1];if(m(this,ar)===a&&m(this,or)===l)for(const{line:p,points:y}of m(this,Ls))ve._translate(p,d,h,p),ve._translate(y,d,h,y);else{const p=m(this,ar)/a,y=m(this,or)/l;C(this,ar,a),C(this,or,l);for(const{line:_,points:S}of m(this,Ls))ve._rescale(_,d,h,p,y,_),ve._rescale(S,d,h,p,y,S);c[2]*=p,c[3]*=y}return c[0]=t,c[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`}}}get defaultSVGProperties(){const t=m(this,$n);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ve.svgRound(t[0])} ${ve.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};$n=new WeakMap,Kp=new WeakMap,Xp=new WeakMap,Ls=new WeakMap,ar=new WeakMap,or=new WeakMap,Rd=new WeakMap,kd=new WeakMap,Md=new WeakMap,Tn=new WeakSet,Dr=function(t=m(this,Md)){const n=m(this,Xp)+t/2*m(this,Rd);return m(this,kd)%180===0?[n/m(this,ar),n/m(this,or)]:[n/m(this,or),n/m(this,ar)]},F2=function(){const[t,n,i,a]=m(this,$n),[l,c]=M(this,Tn,Dr).call(this,0);return[t+l,n+c,i-2*l,a-2*c]},j2=function(){const t=C(this,$n,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:a}of m(this,Ls)){if(a.length<=12){for(let d=4,h=a.length;d<h;d+=6){const[p,y]=a.subarray(d,d+2);t[0]=Math.min(t[0],p),t[1]=Math.min(t[1],y),t[2]=Math.max(t[2],p),t[3]=Math.max(t[3],y)}continue}let l=a[4],c=a[5];for(let d=6,h=a.length;d<h;d+=6){const[p,y,_,S,A,E]=a.subarray(d,d+6);Ce.bezierBoundingBox(l,c,p,y,_,S,A,E,t),l=A,c=E}}const[n,i]=M(this,Tn,Dr).call(this);t[0]=Math.min(1,Math.max(0,t[0]-n)),t[1]=Math.min(1,Math.max(0,t[1]-i)),t[2]=Math.min(1,Math.max(0,t[2]+n)),t[3]=Math.min(1,Math.max(0,t[3]+i)),t[2]-=t[0],t[3]-=t[1]},z2=function(t){const[n,i]=M(this,Tn,Dr).call(this);C(this,Md,t);const[a,l]=M(this,Tn,Dr).call(this),[c,d]=[a-n,l-i],h=m(this,$n);return h[0]-=c,h[1]-=d,h[2]+=2*c,h[3]+=2*d,h};let E0=Iw;var Id;const Dw=class Dw extends u3{constructor(t){super();k(this,Id);C(this,Id,t),super.updateProperties({fill:"none",stroke:It._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,n){t==="stroke-width"&&(n??(n=this["stroke-width"]),n*=m(this,Id).realScale),super.updateSVGProperty(t,n)}clone(){const t=new Dw(m(this,Id));return t.updateAll(this),t}};Id=new WeakMap;let Tx=Dw;var X0,H2;const Eu=class Eu extends wx{constructor(t){super({...t,name:"inkEditor"});k(this,X0);this._willKeepAspectRatio=!0}static initialize(t,n){It.initialize(t,n),this._defaultDrawingOptions=new Tx(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return $e(this,"typesMap",new Map([[Qe.INK_THICKNESS,"stroke-width"],[Qe.INK_COLOR,"stroke"],[Qe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,i,a,l){return new d3(t,n,i,a,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,i,a,l,c){return E0.deserialize(t,n,i,a,l,c)}static async deserialize(t,n,i){let a=null;if(t instanceof vw){const{data:{inkLists:c,rect:d,rotation:h,id:p,color:y,opacity:_,borderStyle:{rawWidth:S},popupRef:A},parent:{page:{pageNumber:E}}}=t;a=t={annotationType:He.INK,color:Array.from(y),thickness:S,opacity:_,paths:{points:c},boxes:null,pageIndex:E-1,rect:d.slice(0),rotation:h,id:p,deleted:!1,popupRef:A}}const l=await super.deserialize(t,n,i);return l.annotationElementId=t.id||null,l._initialData=a,l}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:i}=this;n.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:i}){this._drawingOptions=Eu.getDefaultDrawingOptions({stroke:Ce.makeHexColor(...t),"stroke-width":n,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:i,rect:a}=this.serializeDraw(t),{_drawingOptions:{stroke:l,"stroke-opacity":c,"stroke-width":d}}=this,h={annotationType:He.INK,color:It._colorManager.convert(l),opacity:c,thickness:d,paths:{lines:n,points:i},pageIndex:this.pageIndex,rect:a,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?h:this.annotationElementId&&!M(this,X0,H2).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(t){const{points:n,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:n}),null}};X0=new WeakSet,H2=function(t){const{color:n,thickness:i,opacity:a,pageIndex:l}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((c,d)=>c!==n[d])||t.thickness!==i||t.opacity!==a||t.pageIndex!==l},Me(Eu,"_type","ink"),Me(Eu,"_editorType",He.INK),Me(Eu,"_defaultDrawingOptions",null);let Cx=Eu;var kt,En,_o,ia,xo,Dd,lr,cr,Os,Pd,st,uf,df,a0,Rx,o0,kx,l0,B2;const gf=class gf extends It{constructor(t){super({...t,name:"stampEditor"});k(this,st);k(this,kt,null);k(this,En,null);k(this,_o,null);k(this,ia,null);k(this,xo,null);k(this,Dd,"");k(this,lr,null);k(this,cr,null);k(this,Os,!1);k(this,Pd,!1);C(this,ia,t.bitmapUrl),C(this,xo,t.bitmapFile)}static initialize(t,n){It.initialize(t,n)}static get supportedTypes(){return $e(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(n=>`image/${n}`))}static get supportedTypesStr(){return $e(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,n){n.pasteEditor(He.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,d=await i.guess({name:"altText",request:{data:a,width:l,height:c,channels:a.length/(l*c)}});if(!d)throw new Error("No response from the AI service.");if(d.error)throw new Error("Error from the AI service.");if(d.cancel)return null;if(!d.output)throw new Error("No valid response from the AI service.");const h=d.output;return await this.setGuessedAltText(h),n&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}remove(){var t;m(this,En)&&(C(this,kt,null),this._uiManager.imageManager.deleteId(m(this,En)),(t=m(this,lr))==null||t.remove(),C(this,lr,null),m(this,cr)&&(clearTimeout(m(this,cr)),C(this,cr,null))),super.remove()}rebuild(){if(!this.parent){m(this,En)&&M(this,st,a0).call(this);return}super.rebuild(),this.div!==null&&(m(this,En)&&m(this,lr)===null&&M(this,st,a0).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(m(this,_o)||m(this,kt)||m(this,ia)||m(this,xo)||m(this,En))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;if(this.width&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),m(this,kt)?M(this,st,Rx).call(this):M(this,st,a0).call(this),this.width&&!this.annotationElementId){const[i,a]=this.parentDimensions;this.setAt(t*i,n*a,this.width*i,this.height*a)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;m(this,cr)!==null&&clearTimeout(m(this,cr)),C(this,cr,setTimeout(()=>{C(this,cr,null),M(this,st,kx).call(this)},200))}copyCanvas(t,n,i=!1){var S;t||(t=224);const{width:a,height:l}=m(this,kt),c=new T_;let d=m(this,kt),h=a,p=l,y=null;if(n){if(a>n||l>n){const X=Math.min(n/a,n/l);h=Math.floor(a*X),p=Math.floor(l*X)}y=document.createElement("canvas");const A=y.width=Math.ceil(h*c.sx),E=y.height=Math.ceil(p*c.sy);m(this,Os)||(d=M(this,st,o0).call(this,A,E));const N=y.getContext("2d");N.filter=this._uiManager.hcmFilter;let R="white",D="#cfcfd8";this._uiManager.hcmFilter!=="none"?D="black":(S=window.matchMedia)!=null&&S.call(window,"(prefers-color-scheme: dark)").matches&&(R="#8f8f9d",D="#42414d");const P=15,L=P*c.sx,z=P*c.sy,H=new OffscreenCanvas(L*2,z*2),F=H.getContext("2d");F.fillStyle=R,F.fillRect(0,0,L*2,z*2),F.fillStyle=D,F.fillRect(0,0,L,z),F.fillRect(L,z,L,z),N.fillStyle=N.createPattern(H,"repeat"),N.fillRect(0,0,A,E),N.drawImage(d,0,0,d.width,d.height,0,0,A,E)}let _=null;if(i){let A,E;if(c.symmetric&&d.width<t&&d.height<t)A=d.width,E=d.height;else if(d=m(this,kt),a>t||l>t){const D=Math.min(t/a,t/l);A=Math.floor(a*D),E=Math.floor(l*D),m(this,Os)||(d=M(this,st,o0).call(this,A,E))}const R=new OffscreenCanvas(A,E).getContext("2d",{willReadFrequently:!0});R.drawImage(d,0,0,d.width,d.height,0,0,A,E),_={width:A,height:E,data:R.getImageData(0,0,A,E).data}}return{canvas:y,width:h,height:p,imageData:_}}getImageForAltText(){return m(this,lr)}static async deserialize(t,n,i){var E;let a=null;if(t instanceof c2){const{data:{rect:N,rotation:R,id:D,structParent:P,popupRef:L},container:z,parent:{page:{pageNumber:H}}}=t,F=z.querySelector("canvas"),X=i.imageManager.getFromCanvas(z.id,F);F.remove();const Y=((E=await n._structTree.getAriaAttributes(`${cw}${D}`))==null?void 0:E.get("aria-label"))||"";a=t={annotationType:He.STAMP,bitmapId:X.id,bitmap:X.bitmap,pageIndex:H-1,rect:N.slice(0),rotation:R,id:D,deleted:!1,accessibilityData:{decorative:!1,altText:Y},isSvg:!1,structParent:P,popupRef:L}}const l=await super.deserialize(t,n,i),{rect:c,bitmap:d,bitmapUrl:h,bitmapId:p,isSvg:y,accessibilityData:_}=t;p&&i.imageManager.isValidId(p)?(C(l,En,p),d&&C(l,kt,d)):C(l,ia,h),C(l,Os,y);const[S,A]=l.pageDimensions;return l.width=(c[2]-c[0])/S,l.height=(c[3]-c[1])/A,l.annotationElementId=t.id||null,_&&(l.altTextData=_),l._initialData=a,C(l,Pd,!!a),l}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:He.STAMP,bitmapId:m(this,En),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:m(this,Os),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=M(this,st,l0).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:a,altText:l}=this.serializeAltText(!1);if(!a&&l&&(i.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const d=M(this,st,B2).call(this,i);if(d.isSame)return null;d.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,n===null)return i;n.stamps||(n.stamps=new Map);const c=m(this,Os)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!n.stamps.has(m(this,En)))n.stamps.set(m(this,En),{area:c,serialized:i}),i.bitmap=M(this,st,l0).call(this,!1);else if(m(this,Os)){const d=n.stamps.get(m(this,En));c>d.area&&(d.area=c,d.serialized.bitmap.close(),d.serialized.bitmap=M(this,st,l0).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};kt=new WeakMap,En=new WeakMap,_o=new WeakMap,ia=new WeakMap,xo=new WeakMap,Dd=new WeakMap,lr=new WeakMap,cr=new WeakMap,Os=new WeakMap,Pd=new WeakMap,st=new WeakSet,uf=function(t,n=!1){if(!t){this.remove();return}C(this,kt,t.bitmap),n||(C(this,En,t.id),C(this,Os,t.isSvg)),t.file&&C(this,Dd,t.file.name),M(this,st,Rx).call(this)},df=function(){if(C(this,_o,null),this._uiManager.enableWaiting(!1),!!m(this,lr)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&m(this,kt)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&m(this,kt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},a0=function(){if(m(this,En)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(m(this,En)).then(i=>M(this,st,uf).call(this,i,!0)).finally(()=>M(this,st,df).call(this));return}if(m(this,ia)){const i=m(this,ia);C(this,ia,null),this._uiManager.enableWaiting(!0),C(this,_o,this._uiManager.imageManager.getFromUrl(i).then(a=>M(this,st,uf).call(this,a)).finally(()=>M(this,st,df).call(this)));return}if(m(this,xo)){const i=m(this,xo);C(this,xo,null),this._uiManager.enableWaiting(!0),C(this,_o,this._uiManager.imageManager.getFromFile(i).then(a=>M(this,st,uf).call(this,a)).finally(()=>M(this,st,df).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=gf.supportedTypesStr;const n=this._uiManager._signal;C(this,_o,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),M(this,st,uf).call(this,a)}i()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:n})}).finally(()=>M(this,st,df).call(this))),t.click()},Rx=function(){var y;const{div:t}=this;let{width:n,height:i}=m(this,kt);const[a,l]=this.pageDimensions,c=.75;if(this.width)n=this.width*a,i=this.height*l;else if(n>c*a||i>c*l){const _=Math.min(c*a/n,c*l/i);n*=_,i*=_}const[d,h]=this.parentDimensions;this.setDims(n*d/a,i*h/l),this._uiManager.enableWaiting(!1);const p=C(this,lr,document.createElement("canvas"));p.setAttribute("role","img"),this.addContainer(p),this.width=n/a,this.height=i/l,(y=this._initialOptions)!=null&&y.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),M(this,st,kx).call(this),m(this,Pd)||(this.parent.addUndoableEditor(this),C(this,Pd,!0)),this._reportTelemetry({action:"inserted_image"}),m(this,Dd)&&p.setAttribute("aria-label",m(this,Dd))},o0=function(t,n){const{width:i,height:a}=m(this,kt);let l=i,c=a,d=m(this,kt);for(;l>2*t||c>2*n;){const h=l,p=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*n&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const y=new OffscreenCanvas(l,c);y.getContext("2d").drawImage(d,0,0,h,p,0,0,l,c),d=y.transferToImageBitmap()}return d},kx=function(){const[t,n]=this.parentDimensions,{width:i,height:a}=this,l=new T_,c=Math.ceil(i*t*l.sx),d=Math.ceil(a*n*l.sy),h=m(this,lr);if(!h||h.width===c&&h.height===d)return;h.width=c,h.height=d;const p=m(this,Os)?m(this,kt):M(this,st,o0).call(this,c,d),y=h.getContext("2d");y.filter=this._uiManager.hcmFilter,y.drawImage(p,0,0,p.width,p.height,0,0,c,d)},l0=function(t){if(t){if(m(this,Os)){const a=this._uiManager.imageManager.getSvgUrl(m(this,En));if(a)return a}const n=document.createElement("canvas");return{width:n.width,height:n.height}=m(this,kt),n.getContext("2d").drawImage(m(this,kt),0,0),n.toDataURL()}if(m(this,Os)){const[n,i]=this.pageDimensions,a=Math.round(this.width*n*Co.PDF_TO_CSS_UNITS),l=Math.round(this.height*i*Co.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(a,l);return c.getContext("2d").drawImage(m(this,kt),0,0,m(this,kt).width,m(this,kt).height,0,0,a,l),c.transferToImageBitmap()}return structuredClone(m(this,kt))},B2=function(t){var c;const{pageIndex:n,accessibilityData:{altText:i}}=this._initialData,a=t.pageIndex===n,l=(((c=t.accessibilityData)==null?void 0:c.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&a&&l,isSameAltText:l}},Me(gf,"_type","stamp"),Me(gf,"_editorType",He.STAMP);let Nx=gf;var cc,Ld,ur,wo,ra,oi,So,Od,uc,ki,aa,Pn,oa,Ee,Ao,Nt,G2,Yi,Ix,Dx,c0;const vi=class vi{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:i,accessibilityManager:a,annotationLayer:l,drawLayer:c,textLayer:d,viewport:h,l10n:p}){k(this,Nt);k(this,cc);k(this,Ld,!1);k(this,ur,null);k(this,wo,null);k(this,ra,null);k(this,oi,new Map);k(this,So,!1);k(this,Od,!1);k(this,uc,!1);k(this,ki,null);k(this,aa,null);k(this,Pn,null);k(this,oa,null);k(this,Ee);const y=[...m(vi,Ao).values()];if(!vi._initialized){vi._initialized=!0;for(const _ of y)_.initialize(p,e)}e.registerEditorTypes(y),C(this,Ee,e),this.pageIndex=t,this.div=n,C(this,cc,a),C(this,ur,l),this.viewport=h,C(this,Pn,d),this.drawLayer=c,this._structTree=i,m(this,Ee).addLayer(this)}get isEmpty(){return m(this,oi).size===0}get isInvisible(){return this.isEmpty&&m(this,Ee).getMode()===He.NONE}updateToolbar(e){m(this,Ee).updateToolbar(e)}updateMode(e=m(this,Ee).getMode()){switch(M(this,Nt,c0).call(this),e){case He.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case He.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case He.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of m(vi,Ao).values())t.toggle(`${n._type}Editing`,e===n._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=m(this,Pn))==null?void 0:t.div)}setEditingState(e){m(this,Ee).setEditingState(e)}addCommands(e){m(this,Ee).addCommands(e)}cleanUndoStack(e){m(this,Ee).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=m(this,ur))==null||t.div.classList.toggle("disabled",!e)}async enable(){C(this,uc,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const n of m(this,oi).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(m(this,Ee).removeChangedExistingAnnotation(n),e.add(n.annotationElementId));if(!m(this,ur)){C(this,uc,!1);return}const t=m(this,ur).getEditableAnnotations();for(const n of t){if(n.hide(),m(this,Ee).isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}C(this,uc,!1)}disable(){var i;C(this,Od,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const a of m(this,oi).values())if(a.disableEditing(),!!a.annotationElementId){if(a.serialize()!==null){e.set(a.annotationElementId,a);continue}else t.set(a.annotationElementId,a);(i=this.getEditableAnnotation(a.annotationElementId))==null||i.show(),a.remove()}if(m(this,ur)){const a=m(this,ur).getEditableAnnotations();for(const l of a){const{id:c}=l.data;if(m(this,Ee).isDeletedAnnotationElement(c))continue;let d=t.get(c);if(d){d.resetAnnotationElement(l),d.show(!1),l.show();continue}d=e.get(c),d&&(m(this,Ee).addChangedExistingAnnotation(d),d.renderAnnotationElement(l)&&d.show(!1)),l.show()}}M(this,Nt,c0).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const a of m(vi,Ao).values())n.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),C(this,Od,!1)}getEditableAnnotation(e){var t;return((t=m(this,ur))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){m(this,Ee).getActive()!==e&&m(this,Ee).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=m(this,Pn))!=null&&e.div&&!m(this,oa)){C(this,oa,new AbortController);const t=m(this,Ee).combinedSignal(m(this,oa));m(this,Pn).div.addEventListener("pointerdown",M(this,Nt,G2).bind(this),{signal:t}),m(this,Pn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=m(this,Pn))!=null&&e.div&&m(this,oa)&&(m(this,oa).abort(),C(this,oa,null),m(this,Pn).div.classList.remove("highlighting"))}enableClick(){if(m(this,wo))return;C(this,wo,new AbortController);const e=m(this,Ee).combinedSignal(m(this,wo));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=m(this,wo))==null||e.abort(),C(this,wo,null)}attach(e){m(this,oi).set(e.id,e);const{annotationElementId:t}=e;t&&m(this,Ee).isDeletedAnnotationElement(t)&&m(this,Ee).removeDeletedAnnotationElement(e)}detach(e){var t;m(this,oi).delete(e.id),(t=m(this,cc))==null||t.removePointerInTextLayer(e.contentDiv),!m(this,Od)&&e.annotationElementId&&m(this,Ee).addDeletedAnnotationElement(e)}remove(e){this.detach(e),m(this,Ee).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(m(this,Ee).addDeletedAnnotationElement(e.annotationElementId),It.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),m(this,Ee).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!m(this,uc)),m(this,Ee).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!m(this,ra)&&(e._focusEventsAllowed=!1,C(this,ra,setTimeout(()=>{C(this,ra,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:m(this,Ee)._signal}),t.focus())},0))),e._structTreeParentId=(n=m(this,cc))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getNextId(){return m(this,Ee).getId()}combinedSignal(e){return m(this,Ee).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=m(this,Nt,Yi))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){m(this,Ee).updateToolbar(e),m(this,Ee).updateMode(e);const{offsetX:n,offsetY:i}=M(this,Nt,Dx).call(this),a=this.getNextId(),l=M(this,Nt,Ix).call(this,{parent:this,id:a,x:n,y:i,uiManager:m(this,Ee),isCentered:!0,...t});l&&this.add(l)}async deserialize(e){var t;return await((t=m(vi,Ao).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,m(this,Ee)))||null}createAndAddNewEditor(e,t,n={}){const i=this.getNextId(),a=M(this,Nt,Ix).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:m(this,Ee),isCentered:t,...n});return a&&this.add(a),a}addNewEditor(){this.createAndAddNewEditor(M(this,Nt,Dx).call(this),!0)}setSelected(e){m(this,Ee).setSelected(e)}toggleSelected(e){m(this,Ee).toggleSelected(e)}unselect(e){m(this,Ee).unselect(e)}pointerup(e){var n;const{isMac:t}=Xn.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&m(this,So)&&(C(this,So,!1),!((n=m(this,Nt,Yi))!=null&&n.isDrawer&&m(this,Nt,Yi).supportMultipleDrawings))){if(!m(this,Ld)){C(this,Ld,!0);return}if(m(this,Ee).getMode()===He.STAMP){m(this,Ee).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var i;if(m(this,Ee).getMode()===He.HIGHLIGHT&&this.enableTextSelection(),m(this,So)){C(this,So,!1);return}const{isMac:t}=Xn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(C(this,So,!0),(i=m(this,Nt,Yi))!=null&&i.isDrawer){this.startDrawingSession(e);return}const n=m(this,Ee).getActive();C(this,Ld,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus(),m(this,ki)){m(this,Nt,Yi).startDrawing(this,m(this,Ee),!1,e);return}m(this,Ee).setCurrentDrawingSession(this),C(this,ki,new AbortController);const t=m(this,Ee).combinedSignal(m(this,ki));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(C(this,aa,null),this.commitOrRemove())},{signal:t}),m(this,Nt,Yi).startDrawing(this,m(this,Ee),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&C(this,aa,t);return}m(this,aa)&&setTimeout(()=>{var t;(t=m(this,aa))==null||t.focus(),C(this,aa,null)},0)}endDrawingSession(e=!1){return m(this,ki)?(m(this,Ee).setCurrentDrawingSession(null),m(this,ki).abort(),C(this,ki,null),C(this,aa,null),m(this,Nt,Yi).endDrawing(e)):null}findNewParent(e,t,n){const i=m(this,Ee).findParent(t,n);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return m(this,ki)?(this.endDrawingSession(),!0):!1}onScaleChanging(){m(this,ki)&&m(this,Nt,Yi).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=m(this,Ee).getActive())==null?void 0:e.parent)===this&&(m(this,Ee).commitOrRemove(),m(this,Ee).setActiveEditor(null)),m(this,ra)&&(clearTimeout(m(this,ra)),C(this,ra,null));for(const n of m(this,oi).values())(t=m(this,cc))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,m(this,oi).clear(),m(this,Ee).removeLayer(this)}render({viewport:e}){this.viewport=e,hc(this.div,e);for(const t of m(this,Ee).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){m(this,Ee).commitOrRemove(),M(this,Nt,c0).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,hc(this.div,{rotation:n}),t!==n)for(const i of m(this,oi).values())i.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return m(this,Ee).viewParameters.realScale}};cc=new WeakMap,Ld=new WeakMap,ur=new WeakMap,wo=new WeakMap,ra=new WeakMap,oi=new WeakMap,So=new WeakMap,Od=new WeakMap,uc=new WeakMap,ki=new WeakMap,aa=new WeakMap,Pn=new WeakMap,oa=new WeakMap,Ee=new WeakMap,Ao=new WeakMap,Nt=new WeakSet,G2=function(e){m(this,Ee).unselectAll();const{target:t}=e;if(t===m(this,Pn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&m(this,Pn).div.contains(t)){const{isMac:n}=Xn.platform;if(e.button!==0||e.ctrlKey&&n)return;m(this,Ee).showAllEditors("highlight",!0,!0),m(this,Pn).div.classList.add("free"),this.toggleDrawing(),A0.startHighlighting(this,m(this,Ee).direction==="ltr",{target:m(this,Pn).div,x:e.x,y:e.y}),m(this,Pn).div.addEventListener("pointerup",()=>{m(this,Pn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:m(this,Ee)._signal}),e.preventDefault()}},Yi=function(){return m(vi,Ao).get(m(this,Ee).getMode())},Ix=function(e){const t=m(this,Nt,Yi);return t?new t.prototype.constructor(e):null},Dx=function(){const{x:e,y:t,width:n,height:i}=this.div.getBoundingClientRect(),a=Math.max(0,e),l=Math.max(0,t),c=Math.min(window.innerWidth,e+n),d=Math.min(window.innerHeight,t+i),h=(a+c)/2-e,p=(l+d)/2-t,[y,_]=this.viewport.rotation%180===0?[h,p]:[p,h];return{offsetX:y,offsetY:_}},c0=function(){for(const e of m(this,oi).values())e.isEmpty()&&e.remove()},Me(vi,"_initialized",!1),k(vi,Ao,new Map([hx,Cx,Nx,A0].map(e=>[e._editorType,e])));let Mx=vi;var Mi,Jp,Yn,dc,J0,q2,dr,Lx,V2,Ox;const kn=class kn{constructor({pageIndex:e}){k(this,dr);k(this,Mi,null);k(this,Jp,0);k(this,Yn,new Map);k(this,dc,new Map);this.pageIndex=e}setParent(e){if(!m(this,Mi)){C(this,Mi,e);return}if(m(this,Mi)!==e){if(m(this,Yn).size>0)for(const t of m(this,Yn).values())t.remove(),e.append(t);C(this,Mi,e)}}static get _svgFactory(){return $e(this,"_svgFactory",new gw)}draw(e,t=!1,n=!1){const i=Bn(this,Jp)._++,a=M(this,dr,Lx).call(this),l=kn._svgFactory.createElement("defs");a.append(l);const c=kn._svgFactory.createElement("path");l.append(c);const d=`path_p${this.pageIndex}_${i}`;c.setAttribute("id",d),c.setAttribute("vector-effect","non-scaling-stroke"),t&&m(this,dc).set(i,c);const h=n?M(this,dr,V2).call(this,l,d):null,p=kn._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${d}`),this.updateProperties(a,e),m(this,Yn).set(i,a),{id:i,clipPathId:`url(#${h})`}}drawOutline(e,t){const n=Bn(this,Jp)._++,i=M(this,dr,Lx).call(this),a=kn._svgFactory.createElement("defs");i.append(a);const l=kn._svgFactory.createElement("path");a.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let d;if(t){const y=kn._svgFactory.createElement("mask");a.append(y),d=`mask_p${this.pageIndex}_${n}`,y.setAttribute("id",d),y.setAttribute("maskUnits","objectBoundingBox");const _=kn._svgFactory.createElement("rect");y.append(_),_.setAttribute("width","1"),_.setAttribute("height","1"),_.setAttribute("fill","white");const S=kn._svgFactory.createElement("use");y.append(S),S.setAttribute("href",`#${c}`),S.setAttribute("stroke","none"),S.setAttribute("fill","black"),S.setAttribute("fill-rule","nonzero"),S.classList.add("mask")}const h=kn._svgFactory.createElement("use");i.append(h),h.setAttribute("href",`#${c}`),d&&h.setAttribute("mask",`url(#${d})`);const p=h.cloneNode();return i.append(p),h.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(i,e),m(this,Yn).set(n,i),n}finalizeDraw(e,t){m(this,dc).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var d;if(!t)return;const{root:n,bbox:i,rootClass:a,path:l}=t,c=typeof e=="number"?m(this,Yn).get(e):e;if(c){if(n&&M(this,dr,Ox).call(this,c,n),i&&M(d=kn,J0,q2).call(d,c,i),a){const{classList:h}=c;for(const[p,y]of Object.entries(a))h.toggle(p,y)}if(l){const p=c.firstChild.firstChild;M(this,dr,Ox).call(this,p,l)}}}updateParent(e,t){if(t===this)return;const n=m(this,Yn).get(e);n&&(m(t,Mi).append(n),m(this,Yn).delete(e),m(t,Yn).set(e,n))}remove(e){m(this,dc).delete(e),m(this,Mi)!==null&&(m(this,Yn).get(e).remove(),m(this,Yn).delete(e))}destroy(){C(this,Mi,null);for(const e of m(this,Yn).values())e.remove();m(this,Yn).clear(),m(this,dc).clear()}};Mi=new WeakMap,Jp=new WeakMap,Yn=new WeakMap,dc=new WeakMap,J0=new WeakSet,q2=function(e,[t,n,i,a]){const{style:l}=e;l.top=`${100*n}%`,l.left=`${100*t}%`,l.width=`${100*i}%`,l.height=`${100*a}%`},dr=new WeakSet,Lx=function(){const e=kn._svgFactory.create(1,1,!0);return m(this,Mi).append(e),e.setAttribute("aria-hidden",!0),e},V2=function(e,t){const n=kn._svgFactory.createElement("clipPath");e.append(n);const i=`clip_${t}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const a=kn._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${t}`),a.classList.add("clip"),i},Ox=function(e,t){for(const[n,i]of Object.entries(t))i===null?e.removeAttribute(n):e.setAttribute(n,i)},k(kn,J0);let Px=kn;globalThis.pdfjsTestingUtils={HighlightOutliner:px};Le.AbortException;Le.AnnotationEditorLayer;Le.AnnotationEditorParamsType;Le.AnnotationEditorType;Le.AnnotationEditorUIManager;Le.AnnotationLayer;Le.AnnotationMode;Le.ColorPicker;Le.DOMSVGFactory;Le.DrawLayer;Le.FeatureTest;var h3=Le.GlobalWorkerOptions;Le.ImageKind;Le.InvalidPDFException;Le.MissingPDFException;Le.OPS;Le.OutputScale;Le.PDFDataRangeTransport;Le.PDFDateString;Le.PDFWorker;Le.PasswordResponses;Le.PermissionFlag;Le.PixelsPerInch;Le.RenderingCancelledException;Le.TextLayer;Le.TouchManager;Le.UnexpectedResponseException;Le.Util;Le.VerbosityLevel;Le.XfaLayer;Le.build;Le.createValidAbsoluteUrl;Le.fetchData;var f3=Le.getDocument;Le.getFilenameFromUrl;Le.getPdfFilenameFromUrl;Le.getXfaPageViewport;Le.isDataScheme;Le.isPdfFile;Le.noContextMenu;Le.normalizeUnicode;Le.setLayerDimensions;Le.shadow;Le.stopEvent;Le.version;h3.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.10.38/build/pdf.worker.min.mjs";const p3=async s=>{try{const e=await s.arrayBuffer(),n=await f3({data:e,cMapUrl:"https://cdn.jsdelivr.net/npm/pdfjs-dist@4.10.38/cmaps/",cMapPacked:!0}).promise;let i="";const a=n.numPages;for(let l=1;l<=a;l++){const p=(await(await n.getPage(l)).getTextContent()).items.map(y=>y.str).join(" ").replace(/\s+/g," ").trim();i+=`Page ${l}:
${p}

`}return i}catch(e){throw console.error("PDF Extraction Error:",e),new Error("    PDF.         .")}};var m3={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let g3,v3;function y3(){return{geminiUrl:g3,vertexUrl:v3}}function b3(s,e,t,n){var i,a;if(!(s!=null&&s.baseUrl)){const l=y3();return e?(i=l.vertexUrl)!==null&&i!==void 0?i:t:(a=l.geminiUrl)!==null&&a!==void 0?a:n}return s.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ga{}function ue(s,e){const t=/\{([^}]+)\}/g;return s.replace(t,(n,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const a=e[i];return a!=null?String(a):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function v(s,e,t){for(let a=0;a<e.length-1;a++){const l=e[a];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in s))if(Array.isArray(t))s[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(s[c])){const d=s[c];if(Array.isArray(t))for(let h=0;h<d.length;h++){const p=d[h];v(p,e.slice(a+1),t[h])}else for(const h of d)v(h,e.slice(a+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in s||(s[c]=[{}]);const d=s[c];v(d[0],e.slice(a+1),t);return}(!s[l]||typeof s[l]!="object")&&(s[l]={}),s=s[l]}const n=e[e.length-1],i=s[n];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(s,t):s[n]=t}function g(s,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return s;for(let n=0;n<e.length;n++){if(typeof s!="object"||s===null)return t;const i=e[n];if(i.endsWith("[]")){const a=i.slice(0,-2);if(a in s){const l=s[a];return Array.isArray(l)?l.map(c=>g(c,e.slice(n+1),t)):t}else return t}else s=s[i]}return s}catch(n){if(n instanceof TypeError)return t;throw n}}function _3(s,e){for(const[t,n]of Object.entries(e)){const i=t.split("."),a=n.split("."),l=new Set;let c=-1;for(let d=0;d<i.length;d++)if(i[d]==="*"){c=d;break}if(c!==-1&&a.length>c)for(let d=c;d<a.length;d++){const h=a[d];h!=="*"&&!h.endsWith("[]")&&!h.endsWith("[0]")&&l.add(h)}Ux(s,i,a,0,l)}}function Ux(s,e,t,n,i){if(n>=e.length||typeof s!="object"||s===null)return;const a=e[n];if(a.endsWith("[]")){const l=a.slice(0,-2),c=s;if(l in c&&Array.isArray(c[l]))for(const d of c[l])Ux(d,e,t,n+1,i)}else if(a==="*"){if(typeof s=="object"&&s!==null&&!Array.isArray(s)){const l=s,c=Object.keys(l).filter(h=>!h.startsWith("_")&&!i.has(h)),d={};for(const h of c)d[h]=l[h];for(const[h,p]of Object.entries(d)){const y=[];for(const _ of t.slice(n))_==="*"?y.push(h):y.push(_);v(l,y,p)}for(const h of c)delete l[h]}}else{const l=s;a in l&&Ux(l[a],e,t,n+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yw(s){if(typeof s!="string")throw new Error("fromImageBytes must be a string");return s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function x3(s){const e={},t=g(s,["operationName"]);t!=null&&v(e,["operationName"],t);const n=g(s,["resourceName"]);return n!=null&&v(e,["_url","resourceName"],n),e}function w3(s){const e={},t=g(s,["name"]);t!=null&&v(e,["name"],t);const n=g(s,["metadata"]);n!=null&&v(e,["metadata"],n);const i=g(s,["done"]);i!=null&&v(e,["done"],i);const a=g(s,["error"]);a!=null&&v(e,["error"],a);const l=g(s,["response","generateVideoResponse"]);return l!=null&&v(e,["response"],A3(l)),e}function S3(s){const e={},t=g(s,["name"]);t!=null&&v(e,["name"],t);const n=g(s,["metadata"]);n!=null&&v(e,["metadata"],n);const i=g(s,["done"]);i!=null&&v(e,["done"],i);const a=g(s,["error"]);a!=null&&v(e,["error"],a);const l=g(s,["response"]);return l!=null&&v(e,["response"],E3(l)),e}function A3(s){const e={},t=g(s,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>T3(l))),v(e,["generatedVideos"],a)}const n=g(s,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const i=g(s,["raiMediaFilteredReasons"]);return i!=null&&v(e,["raiMediaFilteredReasons"],i),e}function E3(s){const e={},t=g(s,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>C3(l))),v(e,["generatedVideos"],a)}const n=g(s,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const i=g(s,["raiMediaFilteredReasons"]);return i!=null&&v(e,["raiMediaFilteredReasons"],i),e}function T3(s){const e={},t=g(s,["video"]);return t!=null&&v(e,["video"],D3(t)),e}function C3(s){const e={},t=g(s,["_self"]);return t!=null&&v(e,["video"],P3(t)),e}function N3(s){const e={},t=g(s,["operationName"]);return t!=null&&v(e,["_url","operationName"],t),e}function R3(s){const e={},t=g(s,["operationName"]);return t!=null&&v(e,["_url","operationName"],t),e}function k3(s){const e={},t=g(s,["name"]);t!=null&&v(e,["name"],t);const n=g(s,["metadata"]);n!=null&&v(e,["metadata"],n);const i=g(s,["done"]);i!=null&&v(e,["done"],i);const a=g(s,["error"]);a!=null&&v(e,["error"],a);const l=g(s,["response"]);return l!=null&&v(e,["response"],M3(l)),e}function M3(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["parent"]);n!=null&&v(e,["parent"],n);const i=g(s,["documentName"]);return i!=null&&v(e,["documentName"],i),e}function $2(s){const e={},t=g(s,["name"]);t!=null&&v(e,["name"],t);const n=g(s,["metadata"]);n!=null&&v(e,["metadata"],n);const i=g(s,["done"]);i!=null&&v(e,["done"],i);const a=g(s,["error"]);a!=null&&v(e,["error"],a);const l=g(s,["response"]);return l!=null&&v(e,["response"],I3(l)),e}function I3(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["parent"]);n!=null&&v(e,["parent"],n);const i=g(s,["documentName"]);return i!=null&&v(e,["documentName"],i),e}function D3(s){const e={},t=g(s,["uri"]);t!=null&&v(e,["uri"],t);const n=g(s,["encodedVideo"]);n!=null&&v(e,["videoBytes"],yw(n));const i=g(s,["encoding"]);return i!=null&&v(e,["mimeType"],i),e}function P3(s){const e={},t=g(s,["gcsUri"]);t!=null&&v(e,["uri"],t);const n=g(s,["bytesBase64Encoded"]);n!=null&&v(e,["videoBytes"],yw(n));const i=g(s,["mimeType"]);return i!=null&&v(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var IT;(function(s){s.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",s.OUTCOME_OK="OUTCOME_OK",s.OUTCOME_FAILED="OUTCOME_FAILED",s.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(IT||(IT={}));var DT;(function(s){s.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",s.PYTHON="PYTHON"})(DT||(DT={}));var PT;(function(s){s.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",s.SILENT="SILENT",s.WHEN_IDLE="WHEN_IDLE",s.INTERRUPT="INTERRUPT"})(PT||(PT={}));var Ln;(function(s){s.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",s.STRING="STRING",s.NUMBER="NUMBER",s.INTEGER="INTEGER",s.BOOLEAN="BOOLEAN",s.ARRAY="ARRAY",s.OBJECT="OBJECT",s.NULL="NULL"})(Ln||(Ln={}));var LT;(function(s){s.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",s.SIMPLE_SEARCH="SIMPLE_SEARCH",s.ELASTIC_SEARCH="ELASTIC_SEARCH"})(LT||(LT={}));var OT;(function(s){s.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",s.NO_AUTH="NO_AUTH",s.API_KEY_AUTH="API_KEY_AUTH",s.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",s.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",s.OAUTH="OAUTH",s.OIDC_AUTH="OIDC_AUTH"})(OT||(OT={}));var UT;(function(s){s.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",s.HTTP_IN_QUERY="HTTP_IN_QUERY",s.HTTP_IN_HEADER="HTTP_IN_HEADER",s.HTTP_IN_PATH="HTTP_IN_PATH",s.HTTP_IN_BODY="HTTP_IN_BODY",s.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(UT||(UT={}));var FT;(function(s){s.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",s.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",s.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",s.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(FT||(FT={}));var jT;(function(s){s.UNSPECIFIED="UNSPECIFIED",s.BLOCKING="BLOCKING",s.NON_BLOCKING="NON_BLOCKING"})(jT||(jT={}));var zT;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.MODE_DYNAMIC="MODE_DYNAMIC"})(zT||(zT={}));var HT;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.AUTO="AUTO",s.ANY="ANY",s.NONE="NONE",s.VALIDATED="VALIDATED"})(HT||(HT={}));var BT;(function(s){s.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",s.LOW="LOW",s.MEDIUM="MEDIUM",s.HIGH="HIGH",s.MINIMAL="MINIMAL"})(BT||(BT={}));var GT;(function(s){s.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",s.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",s.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",s.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",s.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",s.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",s.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",s.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",s.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",s.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",s.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(GT||(GT={}));var qT;(function(s){s.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",s.SEVERITY="SEVERITY",s.PROBABILITY="PROBABILITY"})(qT||(qT={}));var VT;(function(s){s.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",s.BLOCK_NONE="BLOCK_NONE",s.OFF="OFF"})(VT||(VT={}));var $T;(function(s){s.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",s.STOP="STOP",s.MAX_TOKENS="MAX_TOKENS",s.SAFETY="SAFETY",s.RECITATION="RECITATION",s.LANGUAGE="LANGUAGE",s.OTHER="OTHER",s.BLOCKLIST="BLOCKLIST",s.PROHIBITED_CONTENT="PROHIBITED_CONTENT",s.SPII="SPII",s.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",s.IMAGE_SAFETY="IMAGE_SAFETY",s.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",s.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",s.NO_IMAGE="NO_IMAGE",s.IMAGE_RECITATION="IMAGE_RECITATION",s.IMAGE_OTHER="IMAGE_OTHER"})($T||($T={}));var YT;(function(s){s.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",s.NEGLIGIBLE="NEGLIGIBLE",s.LOW="LOW",s.MEDIUM="MEDIUM",s.HIGH="HIGH"})(YT||(YT={}));var KT;(function(s){s.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",s.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",s.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",s.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",s.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(KT||(KT={}));var XT;(function(s){s.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",s.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",s.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",s.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",s.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(XT||(XT={}));var JT;(function(s){s.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",s.SAFETY="SAFETY",s.OTHER="OTHER",s.BLOCKLIST="BLOCKLIST",s.PROHIBITED_CONTENT="PROHIBITED_CONTENT",s.IMAGE_SAFETY="IMAGE_SAFETY",s.MODEL_ARMOR="MODEL_ARMOR",s.JAILBREAK="JAILBREAK"})(JT||(JT={}));var WT;(function(s){s.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",s.ON_DEMAND="ON_DEMAND",s.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(WT||(WT={}));var T0;(function(s){s.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",s.TEXT="TEXT",s.IMAGE="IMAGE",s.AUDIO="AUDIO"})(T0||(T0={}));var QT;(function(s){s.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",s.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",s.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",s.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(QT||(QT={}));var ZT;(function(s){s.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",s.TUNING_MODE_FULL="TUNING_MODE_FULL",s.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(ZT||(ZT={}));var eC;(function(s){s.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",s.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",s.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",s.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",s.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",s.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",s.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(eC||(eC={}));var Fx;(function(s){s.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",s.JOB_STATE_QUEUED="JOB_STATE_QUEUED",s.JOB_STATE_PENDING="JOB_STATE_PENDING",s.JOB_STATE_RUNNING="JOB_STATE_RUNNING",s.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",s.JOB_STATE_FAILED="JOB_STATE_FAILED",s.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",s.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",s.JOB_STATE_PAUSED="JOB_STATE_PAUSED",s.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",s.JOB_STATE_UPDATING="JOB_STATE_UPDATING",s.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Fx||(Fx={}));var tC;(function(s){s.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",s.TUNING_TASK_I2V="TUNING_TASK_I2V",s.TUNING_TASK_T2V="TUNING_TASK_T2V",s.TUNING_TASK_R2V="TUNING_TASK_R2V"})(tC||(tC={}));var nC;(function(s){s.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",s.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",s.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",s.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",s.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(nC||(nC={}));var sC;(function(s){s.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",s.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",s.BALANCED="BALANCED",s.PRIORITIZE_COST="PRIORITIZE_COST"})(sC||(sC={}));var iC;(function(s){s.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",s.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(iC||(iC={}));var rC;(function(s){s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",s.BLOCK_NONE="BLOCK_NONE"})(rC||(rC={}));var aC;(function(s){s.DONT_ALLOW="DONT_ALLOW",s.ALLOW_ADULT="ALLOW_ADULT",s.ALLOW_ALL="ALLOW_ALL"})(aC||(aC={}));var oC;(function(s){s.auto="auto",s.en="en",s.ja="ja",s.ko="ko",s.hi="hi",s.zh="zh",s.pt="pt",s.es="es"})(oC||(oC={}));var lC;(function(s){s.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",s.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",s.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",s.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",s.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(lC||(lC={}));var cC;(function(s){s.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",s.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",s.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",s.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(cC||(cC={}));var uC;(function(s){s.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",s.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",s.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",s.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(uC||(uC={}));var dC;(function(s){s.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",s.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",s.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",s.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",s.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",s.EDIT_MODE_STYLE="EDIT_MODE_STYLE",s.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",s.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(dC||(dC={}));var hC;(function(s){s.FOREGROUND="FOREGROUND",s.BACKGROUND="BACKGROUND",s.PROMPT="PROMPT",s.SEMANTIC="SEMANTIC",s.INTERACTIVE="INTERACTIVE"})(hC||(hC={}));var fC;(function(s){s.ASSET="ASSET",s.STYLE="STYLE"})(fC||(fC={}));var pC;(function(s){s.INSERT="INSERT",s.REMOVE="REMOVE",s.REMOVE_STATIC="REMOVE_STATIC",s.OUTPAINT="OUTPAINT"})(pC||(pC={}));var mC;(function(s){s.OPTIMIZED="OPTIMIZED",s.LOSSLESS="LOSSLESS"})(mC||(mC={}));var gC;(function(s){s.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",s.PREFERENCE_TUNING="PREFERENCE_TUNING"})(gC||(gC={}));var vC;(function(s){s.STATE_UNSPECIFIED="STATE_UNSPECIFIED",s.STATE_PENDING="STATE_PENDING",s.STATE_ACTIVE="STATE_ACTIVE",s.STATE_FAILED="STATE_FAILED"})(vC||(vC={}));var yC;(function(s){s.STATE_UNSPECIFIED="STATE_UNSPECIFIED",s.PROCESSING="PROCESSING",s.ACTIVE="ACTIVE",s.FAILED="FAILED"})(yC||(yC={}));var bC;(function(s){s.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",s.UPLOADED="UPLOADED",s.GENERATED="GENERATED",s.REGISTERED="REGISTERED"})(bC||(bC={}));var _C;(function(s){s.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",s.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",s.RESPONSE_REJECTED="RESPONSE_REJECTED",s.NEED_MORE_INPUT="NEED_MORE_INPUT"})(_C||(_C={}));var xC;(function(s){s.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",s.TEXT="TEXT",s.IMAGE="IMAGE",s.VIDEO="VIDEO",s.AUDIO="AUDIO",s.DOCUMENT="DOCUMENT"})(xC||(xC={}));var wC;(function(s){s.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",s.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",s.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(wC||(wC={}));var SC;(function(s){s.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",s.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",s.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(SC||(SC={}));var AC;(function(s){s.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",s.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",s.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(AC||(AC={}));var EC;(function(s){s.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",s.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",s.NO_INTERRUPTION="NO_INTERRUPTION"})(EC||(EC={}));var TC;(function(s){s.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",s.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",s.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(TC||(TC={}));var CC;(function(s){s.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",s.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",s.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",s.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",s.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",s.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",s.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",s.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",s.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",s.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",s.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",s.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",s.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(CC||(CC={}));var NC;(function(s){s.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",s.QUALITY="QUALITY",s.DIVERSITY="DIVERSITY",s.VOCALIZATION="VOCALIZATION"})(NC||(NC={}));var wu;(function(s){s.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",s.PLAY="PLAY",s.PAUSE="PAUSE",s.STOP="STOP",s.RESET_CONTEXT="RESET_CONTEXT"})(wu||(wu={}));class jx{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Vh{get text(){var e,t,n,i,a,l,c,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",p=!1;const y=[];for(const _ of(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[S,A]of Object.entries(_))S!=="text"&&S!=="thought"&&S!=="thoughtSignature"&&(A!==null||A!==void 0)&&y.push(S);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;p=!0,h+=_.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?h:void 0}get data(){var e,t,n,i,a,l,c,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const p=[];for(const y of(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[_,S]of Object.entries(y))_!=="inlineData"&&(S!==null||S!==void 0)&&p.push(_);y.inlineData&&typeof y.inlineData.data=="string"&&(h+=atob(y.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var e,t,n,i,a,l,c,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var e,t,n,i,a,l,c,d,h;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if((p==null?void 0:p.length)!==0)return(h=p==null?void 0:p[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var e,t,n,i,a,l,c,d,h;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if((p==null?void 0:p.length)!==0)return(h=p==null?void 0:p[0])===null||h===void 0?void 0:h.output}}class RC{}class kC{}class L3{}class O3{}class U3{}class F3{}class MC{}class IC{}class DC{}class j3{}class C0{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new C0;let i;const a=e;return t?i=S3(a):i=w3(a),Object.assign(n,i),n}}class PC{}class LC{}class OC{}class UC{}class z3{}class H3{}class B3{}class bw{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new bw,a=k3(e);return Object.assign(n,a),n}}class G3{}class q3{}class V3{}class FC{}class $3{get text(){var e,t,n;let i="",a=!1;const l=[];for(const c of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[d,h]of Object.entries(c))d!=="text"&&d!=="thought"&&h!==null&&l.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;a=!0,i+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?i:void 0}get data(){var e,t,n;let i="";const a=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[c,d]of Object.entries(l))c!=="inlineData"&&d!==null&&a.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(i+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class Y3{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class _w{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new _w,a=$2(e);return Object.assign(n,a),n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function it(s,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(s.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Y2(s,e){const t=it(s,e);return t?t.startsWith("publishers/")&&s.isVertexAI()?`projects/${s.getProject()}/locations/${s.getLocation()}/${t}`:t.startsWith("models/")&&s.isVertexAI()?`projects/${s.getProject()}/locations/${s.getLocation()}/publishers/google/${t}`:t:""}function K2(s){return Array.isArray(s)?s.map(e=>N0(e)):[N0(s)]}function N0(s){if(typeof s=="object"&&s!==null)return s;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof s}`)}function X2(s){const e=N0(s);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function J2(s){const e=N0(s);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function jC(s){if(s==null)throw new Error("PartUnion is required");if(typeof s=="object")return s;if(typeof s=="string")return{text:s};throw new Error(`Unsupported part type: ${typeof s}`)}function W2(s){if(s==null||Array.isArray(s)&&s.length===0)throw new Error("PartListUnion is required");return Array.isArray(s)?s.map(e=>jC(e)):[jC(s)]}function zx(s){return s!=null&&typeof s=="object"&&"parts"in s&&Array.isArray(s.parts)}function zC(s){return s!=null&&typeof s=="object"&&"functionCall"in s}function HC(s){return s!=null&&typeof s=="object"&&"functionResponse"in s}function Fn(s){if(s==null)throw new Error("ContentUnion is required");return zx(s)?s:{role:"user",parts:W2(s)}}function xw(s,e){if(!e)return[];if(s.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=Fn(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(s.isVertexAI()){const t=Fn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Fn(t)):[Fn(e)]}function ui(s){if(s==null||Array.isArray(s)&&s.length===0)throw new Error("contents are required");if(!Array.isArray(s)){if(zC(s)||HC(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Fn(s)]}const e=[],t=[],n=zx(s[0]);for(const i of s){const a=zx(i);if(a!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(i);else{if(zC(i)||HC(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(i)}}return n||e.push({role:"user",parts:W2(t)}),e}function K3(s,e){s.includes("null")&&(e.nullable=!0);const t=s.filter(n=>n!=="null");if(t.length===1)e.type=Object.values(Ln).includes(t[0].toUpperCase())?t[0].toUpperCase():Ln.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.values(Ln).includes(n.toUpperCase())?n.toUpperCase():Ln.TYPE_UNSPECIFIED})}}function ku(s){const e={},t=["items"],n=["anyOf"],i=["properties"];if(s.type&&s.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=s.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,s=a[1]):a[1].type==="null"&&(e.nullable=!0,s=a[0])),s.type instanceof Array&&K3(s.type,e);for(const[l,c]of Object.entries(s))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(Ln).includes(c.toUpperCase())?c.toUpperCase():Ln.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=ku(c);else if(n.includes(l)){const d=[];for(const h of c){if(h.type=="null"){e.nullable=!0;continue}d.push(ku(h))}e[l]=d}else if(i.includes(l)){const d={};for(const[h,p]of Object.entries(c))d[h]=ku(p);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=c}return e}function ww(s){return ku(s)}function Sw(s){if(typeof s=="object")return s;if(typeof s=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:s}}};throw new Error(`Unsupported speechConfig type: ${typeof s}`)}function Aw(s){if("multiSpeakerVoiceConfig"in s)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return s}function Fd(s){if(s.functionDeclarations)for(const e of s.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=ku(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=ku(e.response));return s}function jd(s){if(s==null)throw new Error("tools is required");if(!Array.isArray(s))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of s)e.push(t);return e}function X3(s,e,t,n=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===n;return s.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${s.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${s.getProject()}/locations/${s.getLocation()}/${e}`:i?`projects/${s.getProject()}/locations/${s.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function va(s,e){if(typeof e!="string")throw new Error("name must be a string");return X3(s,e,"cachedContents")}function Q2(s){switch(s){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return s}}function ko(s){return yw(s)}function J3(s){return s!=null&&typeof s=="object"&&"name"in s}function W3(s){return s!=null&&typeof s=="object"&&"video"in s}function Q3(s){return s!=null&&typeof s=="object"&&"uri"in s}function Z2(s){var e;let t;if(J3(s)&&(t=s.name),!(Q3(s)&&(t=s.uri,t===void 0))&&!(W3(s)&&(t=(e=s.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof s=="string"&&(t=s),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const i=t.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${t}`);t=i[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function ek(s,e){let t;return s.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function tk(s){for(const e of["models","tunedModels","publisherModels"])if(Z3(s,e))return s[e];return[]}function Z3(s,e){return s!==null&&typeof s=="object"&&e in s}function eF(s,e={}){const t=s,n={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(n.responseJsonSchema=t.outputSchema),e.behavior&&(n.behavior=e.behavior),{functionDeclarations:[n]}}function tF(s,e={}){const t=[],n=new Set;for(const i of s){const a=i.name;if(n.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);n.add(a);const l=eF(i,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function nk(s,e){let t;if(typeof e=="string")if(s.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(s.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const n=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,i=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(s.isVertexAI()){if(i>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function nF(s){if(typeof s!="string")return s;const e=s;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function sk(s){if(typeof s!="object"||s===null)return{};const e=s,t=e.inlinedResponses;if(typeof t!="object"||t===null)return s;const i=t.inlinedResponses;if(!Array.isArray(i)||i.length===0)return s;let a=!1;for(const l of i){if(typeof l!="object"||l===null)continue;const d=l.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),s}function zd(s,e){const t=e;if(!s.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function ik(s){const e=s;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sF(s){const e={},t=g(s,["responsesFile"]);t!=null&&v(e,["fileName"],t);const n=g(s,["inlinedResponses","inlinedResponses"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>UF(l))),v(e,["inlinedResponses"],a)}const i=g(s,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),v(e,["inlinedEmbedContentResponses"],a)}return e}function iF(s){const e={},t=g(s,["predictionsFormat"]);t!=null&&v(e,["format"],t);const n=g(s,["gcsDestination","outputUriPrefix"]);n!=null&&v(e,["gcsUri"],n);const i=g(s,["bigqueryDestination","outputUri"]);return i!=null&&v(e,["bigqueryUri"],i),e}function rF(s){const e={},t=g(s,["format"]);t!=null&&v(e,["predictionsFormat"],t);const n=g(s,["gcsUri"]);n!=null&&v(e,["gcsDestination","outputUriPrefix"],n);const i=g(s,["bigqueryUri"]);if(i!=null&&v(e,["bigqueryDestination","outputUri"],i),g(s,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(s,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(g(s,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function u0(s){const e={},t=g(s,["name"]);t!=null&&v(e,["name"],t);const n=g(s,["metadata","displayName"]);n!=null&&v(e,["displayName"],n);const i=g(s,["metadata","state"]);i!=null&&v(e,["state"],ik(i));const a=g(s,["metadata","createTime"]);a!=null&&v(e,["createTime"],a);const l=g(s,["metadata","endTime"]);l!=null&&v(e,["endTime"],l);const c=g(s,["metadata","updateTime"]);c!=null&&v(e,["updateTime"],c);const d=g(s,["metadata","model"]);d!=null&&v(e,["model"],d);const h=g(s,["metadata","output"]);return h!=null&&v(e,["dest"],sF(sk(h))),e}function Hx(s){const e={},t=g(s,["name"]);t!=null&&v(e,["name"],t);const n=g(s,["displayName"]);n!=null&&v(e,["displayName"],n);const i=g(s,["state"]);i!=null&&v(e,["state"],ik(i));const a=g(s,["error"]);a!=null&&v(e,["error"],a);const l=g(s,["createTime"]);l!=null&&v(e,["createTime"],l);const c=g(s,["startTime"]);c!=null&&v(e,["startTime"],c);const d=g(s,["endTime"]);d!=null&&v(e,["endTime"],d);const h=g(s,["updateTime"]);h!=null&&v(e,["updateTime"],h);const p=g(s,["model"]);p!=null&&v(e,["model"],p);const y=g(s,["inputConfig"]);y!=null&&v(e,["src"],aF(y));const _=g(s,["outputConfig"]);_!=null&&v(e,["dest"],iF(sk(_)));const S=g(s,["completionStats"]);return S!=null&&v(e,["completionStats"],S),e}function aF(s){const e={},t=g(s,["instancesFormat"]);t!=null&&v(e,["format"],t);const n=g(s,["gcsSource","uris"]);n!=null&&v(e,["gcsUri"],n);const i=g(s,["bigquerySource","inputUri"]);return i!=null&&v(e,["bigqueryUri"],i),e}function oF(s,e){const t={};if(g(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(g(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=g(e,["fileName"]);n!=null&&v(t,["fileName"],n);const i=g(e,["inlinedRequests"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>OF(s,l))),v(t,["requests","requests"],a)}return t}function lF(s){const e={},t=g(s,["format"]);t!=null&&v(e,["instancesFormat"],t);const n=g(s,["gcsUri"]);n!=null&&v(e,["gcsSource","uris"],n);const i=g(s,["bigqueryUri"]);if(i!=null&&v(e,["bigquerySource","inputUri"],i),g(s,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(s,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function cF(s){const e={},t=g(s,["data"]);if(t!=null&&v(e,["data"],t),g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function uF(s,e){const t={},n=g(e,["name"]);return n!=null&&v(t,["_url","name"],zd(s,n)),t}function dF(s,e){const t={},n=g(e,["name"]);return n!=null&&v(t,["_url","name"],zd(s,n)),t}function hF(s){const e={},t=g(s,["content"]);t!=null&&v(e,["content"],t);const n=g(s,["citationMetadata"]);n!=null&&v(e,["citationMetadata"],fF(n));const i=g(s,["tokenCount"]);i!=null&&v(e,["tokenCount"],i);const a=g(s,["finishReason"]);a!=null&&v(e,["finishReason"],a);const l=g(s,["avgLogprobs"]);l!=null&&v(e,["avgLogprobs"],l);const c=g(s,["groundingMetadata"]);c!=null&&v(e,["groundingMetadata"],c);const d=g(s,["index"]);d!=null&&v(e,["index"],d);const h=g(s,["logprobsResult"]);h!=null&&v(e,["logprobsResult"],h);const p=g(s,["safetyRatings"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(S=>S)),v(e,["safetyRatings"],_)}const y=g(s,["urlContextMetadata"]);return y!=null&&v(e,["urlContextMetadata"],y),e}function fF(s){const e={},t=g(s,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>i)),v(e,["citations"],n)}return e}function rk(s){const e={},t=g(s,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>qF(a))),v(e,["parts"],i)}const n=g(s,["role"]);return n!=null&&v(e,["role"],n),e}function pF(s,e){const t={},n=g(s,["displayName"]);if(e!==void 0&&n!=null&&v(e,["batch","displayName"],n),g(s,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function mF(s,e){const t={},n=g(s,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const i=g(s,["dest"]);return e!==void 0&&i!=null&&v(e,["outputConfig"],rF(nF(i))),t}function BC(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["src"]);i!=null&&v(t,["batch","inputConfig"],oF(s,nk(s,i)));const a=g(e,["config"]);return a!=null&&pF(a,t),t}function gF(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["model"],it(s,n));const i=g(e,["src"]);i!=null&&v(t,["inputConfig"],lF(nk(s,i)));const a=g(e,["config"]);return a!=null&&mF(a,t),t}function vF(s,e){const t={},n=g(s,["displayName"]);return e!==void 0&&n!=null&&v(e,["batch","displayName"],n),t}function yF(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["src"]);i!=null&&v(t,["batch","inputConfig"],EF(s,i));const a=g(e,["config"]);return a!=null&&vF(a,t),t}function bF(s,e){const t={},n=g(e,["name"]);return n!=null&&v(t,["_url","name"],zd(s,n)),t}function _F(s,e){const t={},n=g(e,["name"]);return n!=null&&v(t,["_url","name"],zd(s,n)),t}function xF(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["name"]);n!=null&&v(e,["name"],n);const i=g(s,["done"]);i!=null&&v(e,["done"],i);const a=g(s,["error"]);return a!=null&&v(e,["error"],a),e}function wF(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["name"]);n!=null&&v(e,["name"],n);const i=g(s,["done"]);i!=null&&v(e,["done"],i);const a=g(s,["error"]);return a!=null&&v(e,["error"],a),e}function SF(s,e){const t={},n=g(e,["contents"]);if(n!=null){let a=xw(s,n);Array.isArray(a)&&(a=a.map(l=>l)),v(t,["requests[]","request","content"],a)}const i=g(e,["config"]);return i!=null&&(v(t,["_self"],AF(i,t)),_3(t,{"requests[].*":"requests[].request.*"})),t}function AF(s,e){const t={},n=g(s,["taskType"]);e!==void 0&&n!=null&&v(e,["requests[]","taskType"],n);const i=g(s,["title"]);e!==void 0&&i!=null&&v(e,["requests[]","title"],i);const a=g(s,["outputDimensionality"]);if(e!==void 0&&a!=null&&v(e,["requests[]","outputDimensionality"],a),g(s,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(s,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function EF(s,e){const t={},n=g(e,["fileName"]);n!=null&&v(t,["file_name"],n);const i=g(e,["inlinedRequests"]);return i!=null&&v(t,["requests"],SF(s,i)),t}function TF(s){const e={};if(g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(s,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function CF(s){const e={},t=g(s,["id"]);t!=null&&v(e,["id"],t);const n=g(s,["args"]);n!=null&&v(e,["args"],n);const i=g(s,["name"]);if(i!=null&&v(e,["name"],i),g(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function NF(s){const e={},t=g(s,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=g(s,["mode"]);if(n!=null&&v(e,["mode"],n),g(s,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function RF(s,e,t){const n={},i=g(e,["systemInstruction"]);t!==void 0&&i!=null&&v(t,["systemInstruction"],rk(Fn(i)));const a=g(e,["temperature"]);a!=null&&v(n,["temperature"],a);const l=g(e,["topP"]);l!=null&&v(n,["topP"],l);const c=g(e,["topK"]);c!=null&&v(n,["topK"],c);const d=g(e,["candidateCount"]);d!=null&&v(n,["candidateCount"],d);const h=g(e,["maxOutputTokens"]);h!=null&&v(n,["maxOutputTokens"],h);const p=g(e,["stopSequences"]);p!=null&&v(n,["stopSequences"],p);const y=g(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const _=g(e,["logprobs"]);_!=null&&v(n,["logprobs"],_);const S=g(e,["presencePenalty"]);S!=null&&v(n,["presencePenalty"],S);const A=g(e,["frequencyPenalty"]);A!=null&&v(n,["frequencyPenalty"],A);const E=g(e,["seed"]);E!=null&&v(n,["seed"],E);const N=g(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const R=g(e,["responseSchema"]);R!=null&&v(n,["responseSchema"],ww(R));const D=g(e,["responseJsonSchema"]);if(D!=null&&v(n,["responseJsonSchema"],D),g(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=g(e,["safetySettings"]);if(t!==void 0&&P!=null){let ye=P;Array.isArray(ye)&&(ye=ye.map(be=>VF(be))),v(t,["safetySettings"],ye)}const L=g(e,["tools"]);if(t!==void 0&&L!=null){let ye=jd(L);Array.isArray(ye)&&(ye=ye.map(be=>YF(Fd(be)))),v(t,["tools"],ye)}const z=g(e,["toolConfig"]);if(t!==void 0&&z!=null&&v(t,["toolConfig"],$F(z)),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=g(e,["cachedContent"]);t!==void 0&&H!=null&&v(t,["cachedContent"],va(s,H));const F=g(e,["responseModalities"]);F!=null&&v(n,["responseModalities"],F);const X=g(e,["mediaResolution"]);X!=null&&v(n,["mediaResolution"],X);const Y=g(e,["speechConfig"]);if(Y!=null&&v(n,["speechConfig"],Sw(Y)),g(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const J=g(e,["thinkingConfig"]);J!=null&&v(n,["thinkingConfig"],J);const ie=g(e,["imageConfig"]);ie!=null&&v(n,["imageConfig"],LF(ie));const pe=g(e,["enableEnhancedCivicAnswers"]);return pe!=null&&v(n,["enableEnhancedCivicAnswers"],pe),n}function kF(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>hF(h))),v(e,["candidates"],d)}const i=g(s,["modelVersion"]);i!=null&&v(e,["modelVersion"],i);const a=g(s,["promptFeedback"]);a!=null&&v(e,["promptFeedback"],a);const l=g(s,["responseId"]);l!=null&&v(e,["responseId"],l);const c=g(s,["usageMetadata"]);return c!=null&&v(e,["usageMetadata"],c),e}function MF(s,e){const t={},n=g(e,["name"]);return n!=null&&v(t,["_url","name"],zd(s,n)),t}function IF(s,e){const t={},n=g(e,["name"]);return n!=null&&v(t,["_url","name"],zd(s,n)),t}function DF(s){const e={};if(g(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(s,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function PF(s){const e={};if(g(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(s,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function LF(s){const e={},t=g(s,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=g(s,["imageSize"]);if(n!=null&&v(e,["imageSize"],n),g(s,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(g(s,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(s,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function OF(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["request","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let c=ui(i);Array.isArray(c)&&(c=c.map(d=>rk(d))),v(t,["request","contents"],c)}const a=g(e,["metadata"]);a!=null&&v(t,["metadata"],a);const l=g(e,["config"]);return l!=null&&v(t,["request","generationConfig"],RF(s,l,g(t,["request"],{}))),t}function UF(s){const e={},t=g(s,["response"]);t!=null&&v(e,["response"],kF(t));const n=g(s,["error"]);return n!=null&&v(e,["error"],n),e}function FF(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);if(e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),g(s,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function jF(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);e!==void 0&&i!=null&&v(e,["_query","pageToken"],i);const a=g(s,["filter"]);return e!==void 0&&a!=null&&v(e,["_query","filter"],a),t}function zF(s){const e={},t=g(s,["config"]);return t!=null&&FF(t,e),e}function HF(s){const e={},t=g(s,["config"]);return t!=null&&jF(t,e),e}function BF(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=g(s,["operations"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>u0(l))),v(e,["batchJobs"],a)}return e}function GF(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=g(s,["batchPredictionJobs"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>Hx(l))),v(e,["batchJobs"],a)}return e}function qF(s){const e={},t=g(s,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=g(s,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const i=g(s,["executableCode"]);i!=null&&v(e,["executableCode"],i);const a=g(s,["fileData"]);a!=null&&v(e,["fileData"],TF(a));const l=g(s,["functionCall"]);l!=null&&v(e,["functionCall"],CF(l));const c=g(s,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const d=g(s,["inlineData"]);d!=null&&v(e,["inlineData"],cF(d));const h=g(s,["text"]);h!=null&&v(e,["text"],h);const p=g(s,["thought"]);p!=null&&v(e,["thought"],p);const y=g(s,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const _=g(s,["videoMetadata"]);return _!=null&&v(e,["videoMetadata"],_),e}function VF(s){const e={},t=g(s,["category"]);if(t!=null&&v(e,["category"],t),g(s,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=g(s,["threshold"]);return n!=null&&v(e,["threshold"],n),e}function $F(s){const e={},t=g(s,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=g(s,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],NF(n)),e}function YF(s){const e={};if(g(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=g(s,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=g(s,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const i=g(s,["codeExecution"]);if(i!=null&&v(e,["codeExecution"],i),g(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(s,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(y=>y)),v(e,["functionDeclarations"],p)}const l=g(s,["googleMaps"]);l!=null&&v(e,["googleMaps"],DF(l));const c=g(s,["googleSearch"]);c!=null&&v(e,["googleSearch"],PF(c));const d=g(s,["googleSearchRetrieval"]);d!=null&&v(e,["googleSearchRetrieval"],d);const h=g(s,["urlContext"]);return h!=null&&v(e,["urlContext"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ha;(function(s){s.PAGED_ITEM_BATCH_JOBS="batchJobs",s.PAGED_ITEM_MODELS="models",s.PAGED_ITEM_TUNING_JOBS="tuningJobs",s.PAGED_ITEM_FILES="files",s.PAGED_ITEM_CACHED_CONTENTS="cachedContents",s.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",s.PAGED_ITEM_DOCUMENTS="documents"})(ha||(ha={}));class yc{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i)}init(e,t,n){var i,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!n||Object.keys(n).length===0?l={config:{}}:typeof n=="object"?l=Object.assign({},n):l=n,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(i=l.config)===null||i===void 0?void 0:i.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KF extends ga{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new yc(ha.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=BC(this.apiClient,e),n=t._url,i=ue("{model}:batchGenerateContent",n),c=t.batch.inputConfig.requests,d=c.requests,h=[];for(const p of d){const y=Object.assign({},p);if(y.systemInstruction){const _=y.systemInstruction;delete y.systemInstruction;const S=y.request;S.systemInstruction=_,y.request=S}h.push(y)}return c.requests=h,delete t.config,delete t._url,delete t._query,{path:i,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},i=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${i}`),n.dest===void 0){const a=this.getGcsUri(e),l=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?n.dest=`${a.slice(0,-6)}/dest`:n.dest=`${a}_dest_${i}`;else if(l)n.dest=`${l}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=gF(this.apiClient,e);return c=ue("batchPredictionJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>Hx(p))}else{const h=BC(this.apiClient,e);return c=ue("{model}:batchGenerateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>u0(p))}}async createEmbeddingsInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=yF(this.apiClient,e);return a=ue("{model}:asyncBatchEmbedContent",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>u0(d))}}async get(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=IF(this.apiClient,e);return c=ue("batchPredictionJobs/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>Hx(p))}else{const h=MF(this.apiClient,e);return c=ue("batches/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>u0(p))}}async cancel(e){var t,n,i,a;let l="",c={};if(this.apiClient.isVertexAI()){const d=dF(this.apiClient,e);l=ue("batchPredictionJobs/{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}else{const d=uF(this.apiClient,e);l=ue("batches/{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=HF(e);return c=ue("batchPredictionJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=GF(p),_=new FC;return Object.assign(_,y),_})}else{const h=zF(e);return c=ue("batches",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=BF(p),_=new FC;return Object.assign(_,y),_})}}async delete(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=_F(this.apiClient,e);return c=ue("batchPredictionJobs/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>wF(p))}else{const h=bF(this.apiClient,e);return c=ue("batches/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>xF(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XF(s){const e={},t=g(s,["data"]);if(t!=null&&v(e,["data"],t),g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function GC(s){const e={},t=g(s,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>y6(a))),v(e,["parts"],i)}const n=g(s,["role"]);return n!=null&&v(e,["role"],n),e}function JF(s,e){const t={},n=g(s,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const i=g(s,["expireTime"]);e!==void 0&&i!=null&&v(e,["expireTime"],i);const a=g(s,["displayName"]);e!==void 0&&a!=null&&v(e,["displayName"],a);const l=g(s,["contents"]);if(e!==void 0&&l!=null){let p=ui(l);Array.isArray(p)&&(p=p.map(y=>GC(y))),v(e,["contents"],p)}const c=g(s,["systemInstruction"]);e!==void 0&&c!=null&&v(e,["systemInstruction"],GC(Fn(c)));const d=g(s,["tools"]);if(e!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(y=>_6(y))),v(e,["tools"],p)}const h=g(s,["toolConfig"]);if(e!==void 0&&h!=null&&v(e,["toolConfig"],b6(h)),g(s,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function WF(s,e){const t={},n=g(s,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const i=g(s,["expireTime"]);e!==void 0&&i!=null&&v(e,["expireTime"],i);const a=g(s,["displayName"]);e!==void 0&&a!=null&&v(e,["displayName"],a);const l=g(s,["contents"]);if(e!==void 0&&l!=null){let y=ui(l);Array.isArray(y)&&(y=y.map(_=>_)),v(e,["contents"],y)}const c=g(s,["systemInstruction"]);e!==void 0&&c!=null&&v(e,["systemInstruction"],Fn(c));const d=g(s,["tools"]);if(e!==void 0&&d!=null){let y=d;Array.isArray(y)&&(y=y.map(_=>x6(_))),v(e,["tools"],y)}const h=g(s,["toolConfig"]);e!==void 0&&h!=null&&v(e,["toolConfig"],h);const p=g(s,["kmsKeyName"]);return e!==void 0&&p!=null&&v(e,["encryption_spec","kmsKeyName"],p),t}function QF(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["model"],Y2(s,n));const i=g(e,["config"]);return i!=null&&JF(i,t),t}function ZF(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["model"],Y2(s,n));const i=g(e,["config"]);return i!=null&&WF(i,t),t}function e6(s,e){const t={},n=g(e,["name"]);return n!=null&&v(t,["_url","name"],va(s,n)),t}function t6(s,e){const t={},n=g(e,["name"]);return n!=null&&v(t,["_url","name"],va(s,n)),t}function n6(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function s6(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function i6(s){const e={};if(g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(s,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function r6(s){const e={},t=g(s,["id"]);t!=null&&v(e,["id"],t);const n=g(s,["args"]);n!=null&&v(e,["args"],n);const i=g(s,["name"]);if(i!=null&&v(e,["name"],i),g(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function a6(s){const e={},t=g(s,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=g(s,["mode"]);if(n!=null&&v(e,["mode"],n),g(s,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function o6(s){const e={},t=g(s,["description"]);t!=null&&v(e,["description"],t);const n=g(s,["name"]);n!=null&&v(e,["name"],n);const i=g(s,["parameters"]);i!=null&&v(e,["parameters"],i);const a=g(s,["parametersJsonSchema"]);a!=null&&v(e,["parametersJsonSchema"],a);const l=g(s,["response"]);l!=null&&v(e,["response"],l);const c=g(s,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),g(s,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function l6(s,e){const t={},n=g(e,["name"]);return n!=null&&v(t,["_url","name"],va(s,n)),t}function c6(s,e){const t={},n=g(e,["name"]);return n!=null&&v(t,["_url","name"],va(s,n)),t}function u6(s){const e={};if(g(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(s,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function d6(s){const e={};if(g(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(s,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function h6(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);return e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),t}function f6(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);return e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),t}function p6(s){const e={},t=g(s,["config"]);return t!=null&&h6(t,e),e}function m6(s){const e={},t=g(s,["config"]);return t!=null&&f6(t,e),e}function g6(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=g(s,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),v(e,["cachedContents"],a)}return e}function v6(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=g(s,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),v(e,["cachedContents"],a)}return e}function y6(s){const e={},t=g(s,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=g(s,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const i=g(s,["executableCode"]);i!=null&&v(e,["executableCode"],i);const a=g(s,["fileData"]);a!=null&&v(e,["fileData"],i6(a));const l=g(s,["functionCall"]);l!=null&&v(e,["functionCall"],r6(l));const c=g(s,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const d=g(s,["inlineData"]);d!=null&&v(e,["inlineData"],XF(d));const h=g(s,["text"]);h!=null&&v(e,["text"],h);const p=g(s,["thought"]);p!=null&&v(e,["thought"],p);const y=g(s,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const _=g(s,["videoMetadata"]);return _!=null&&v(e,["videoMetadata"],_),e}function b6(s){const e={},t=g(s,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=g(s,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],a6(n)),e}function _6(s){const e={};if(g(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=g(s,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=g(s,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const i=g(s,["codeExecution"]);if(i!=null&&v(e,["codeExecution"],i),g(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(s,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(y=>y)),v(e,["functionDeclarations"],p)}const l=g(s,["googleMaps"]);l!=null&&v(e,["googleMaps"],u6(l));const c=g(s,["googleSearch"]);c!=null&&v(e,["googleSearch"],d6(c));const d=g(s,["googleSearchRetrieval"]);d!=null&&v(e,["googleSearchRetrieval"],d);const h=g(s,["urlContext"]);return h!=null&&v(e,["urlContext"],h),e}function x6(s){const e={},t=g(s,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=g(s,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),g(s,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=g(s,["codeExecution"]);i!=null&&v(e,["codeExecution"],i);const a=g(s,["enterpriseWebSearch"]);a!=null&&v(e,["enterpriseWebSearch"],a);const l=g(s,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(_=>o6(_))),v(e,["functionDeclarations"],y)}const c=g(s,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const d=g(s,["googleSearch"]);d!=null&&v(e,["googleSearch"],d);const h=g(s,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const p=g(s,["urlContext"]);return p!=null&&v(e,["urlContext"],p),e}function w6(s,e){const t={},n=g(s,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const i=g(s,["expireTime"]);return e!==void 0&&i!=null&&v(e,["expireTime"],i),t}function S6(s,e){const t={},n=g(s,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const i=g(s,["expireTime"]);return e!==void 0&&i!=null&&v(e,["expireTime"],i),t}function A6(s,e){const t={},n=g(e,["name"]);n!=null&&v(t,["_url","name"],va(s,n));const i=g(e,["config"]);return i!=null&&w6(i,t),t}function E6(s,e){const t={},n=g(e,["name"]);n!=null&&v(t,["_url","name"],va(s,n));const i=g(e,["config"]);return i!=null&&S6(i,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class T6 extends ga{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new yc(ha.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=ZF(this.apiClient,e);return c=ue("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=QF(this.apiClient,e);return c=ue("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async get(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=c6(this.apiClient,e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=l6(this.apiClient,e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async delete(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=t6(this.apiClient,e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=s6(p),_=new OC;return Object.assign(_,y),_})}else{const h=e6(this.apiClient,e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=n6(p),_=new OC;return Object.assign(_,y),_})}}async update(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=E6(this.apiClient,e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=A6(this.apiClient,e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async listInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=m6(e);return c=ue("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=v6(p),_=new UC;return Object.assign(_,y),_})}else{const h=p6(e);return c=ue("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=g6(p),_=new UC;return Object.assign(_,y),_})}}}function R0(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(s);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(s,n[i])&&(t[n[i]]=s[n[i]]);return t}function qC(s){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&s[e],n=0;if(t)return t.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Oe(s){return this instanceof Oe?(this.v=s,this):new Oe(s)}function Li(s,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(s,e||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(S){return function(A){return Promise.resolve(A).then(S,y)}}function c(S,A){n[S]&&(i[S]=function(E){return new Promise(function(N,R){a.push([S,E,N,R])>1||d(S,E)})},A&&(i[S]=A(i[S])))}function d(S,A){try{h(n[S](A))}catch(E){_(a[0][3],E)}}function h(S){S.value instanceof Oe?Promise.resolve(S.value.v).then(p,y):_(a[0][2],S)}function p(S){d("next",S)}function y(S){d("throw",S)}function _(S,A){S(A),a.shift(),a.length&&d(a[0][0],a[0][1])}}function Oi(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=s[Symbol.asyncIterator],t;return e?e.call(s):(s=typeof qC=="function"?qC(s):s[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=s[a]&&function(l){return new Promise(function(c,d){l=s[a](l),i(c,d,l.done,l.value)})}}function i(a,l,c,d){Promise.resolve(d).then(function(h){a({value:h,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function C6(s){var e;if(s.candidates==null||s.candidates.length===0)return!1;const t=(e=s.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:ak(t)}function ak(s){if(s.parts===void 0||s.parts.length===0)return!1;for(const e of s.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function N6(s){if(s.length!==0){for(const e of s)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function VC(s){if(s===void 0||s.length===0)return[];const e=[],t=s.length;let n=0;for(;n<t;)if(s[n].role==="user")e.push(s[n]),n++;else{const i=[];let a=!0;for(;n<t&&s[n].role==="model";)i.push(s[n]),a&&!ak(s[n])&&(a=!1),n++;a?e.push(...i):e.pop()}return e}class R6{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new k6(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class k6{constructor(e,t,n,i={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=a,this.sendPromise=Promise.resolve(),N6(a)}async sendMessage(e){var t;await this.sendPromise;const n=Fn(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,l,c;const d=await i,h=(l=(a=d.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,p=d.automaticFunctionCallingHistory,y=this.getHistory(!0).length;let _=[];p!=null&&(_=(c=p.slice(y))!==null&&c!==void 0?c:[]);const S=h?[h]:[];this.recordHistory(n,S,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;const n=Fn(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const a=await i;return this.processStreamResponse(a,n)}getHistory(e=!1){const t=e?VC(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Li(this,arguments,function*(){var i,a,l,c,d,h;const p=[];try{for(var y=!0,_=Oi(e),S;S=yield Oe(_.next()),i=S.done,!i;y=!0){c=S.value,y=!1;const A=c;if(C6(A)){const E=(h=(d=A.candidates)===null||d===void 0?void 0:d[0])===null||h===void 0?void 0:h.content;E!==void 0&&p.push(E)}yield yield Oe(A)}}catch(A){a={error:A}}finally{try{!y&&!i&&(l=_.return)&&(yield Oe(l.call(_)))}finally{if(a)throw a.error}}this.recordHistory(t,p)})}recordHistory(e,t,n){let i=[];t.length>0&&t.every(a=>a.role!==void 0)?i=t:i.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...VC(n)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cv extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,cv.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function M6(s){const e={},t=g(s,["file"]);return t!=null&&v(e,["file"],t),e}function I6(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function D6(s){const e={},t=g(s,["name"]);return t!=null&&v(e,["_url","file"],Z2(t)),e}function P6(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function L6(s){const e={},t=g(s,["name"]);return t!=null&&v(e,["_url","file"],Z2(t)),e}function O6(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);return e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),t}function U6(s){const e={},t=g(s,["config"]);return t!=null&&O6(t,e),e}function F6(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=g(s,["files"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),v(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class j6 extends ga{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new yc(ha.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=U6(e);return a=ue("files",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const h=F6(d),p=new G3;return Object.assign(p,h),p})}}async createInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=M6(e);return a=ue("upload/v1beta/files",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=I6(d),p=new q3;return Object.assign(p,h),p})}}async get(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=L6(e);return a=ue("files/{file}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=D6(e);return a=ue("files/{file}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const h=P6(d),p=new V3;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function d0(s){const e={},t=g(s,["data"]);if(t!=null&&v(e,["data"],t),g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function z6(s){const e={},t=g(s,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>nj(a))),v(e,["parts"],i)}const n=g(s,["role"]);return n!=null&&v(e,["role"],n),e}function H6(s){const e={};if(g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(s,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function B6(s){const e={},t=g(s,["id"]);t!=null&&v(e,["id"],t);const n=g(s,["args"]);n!=null&&v(e,["args"],n);const i=g(s,["name"]);if(i!=null&&v(e,["name"],i),g(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function G6(s){const e={},t=g(s,["description"]);t!=null&&v(e,["description"],t);const n=g(s,["name"]);n!=null&&v(e,["name"],n);const i=g(s,["parameters"]);i!=null&&v(e,["parameters"],i);const a=g(s,["parametersJsonSchema"]);a!=null&&v(e,["parametersJsonSchema"],a);const l=g(s,["response"]);l!=null&&v(e,["response"],l);const c=g(s,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),g(s,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function q6(s){const e={},t=g(s,["modelSelectionConfig"]);t!=null&&v(e,["modelConfig"],t);const n=g(s,["responseJsonSchema"]);n!=null&&v(e,["responseJsonSchema"],n);const i=g(s,["audioTimestamp"]);i!=null&&v(e,["audioTimestamp"],i);const a=g(s,["candidateCount"]);a!=null&&v(e,["candidateCount"],a);const l=g(s,["enableAffectiveDialog"]);l!=null&&v(e,["enableAffectiveDialog"],l);const c=g(s,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const d=g(s,["logprobs"]);d!=null&&v(e,["logprobs"],d);const h=g(s,["maxOutputTokens"]);h!=null&&v(e,["maxOutputTokens"],h);const p=g(s,["mediaResolution"]);p!=null&&v(e,["mediaResolution"],p);const y=g(s,["presencePenalty"]);y!=null&&v(e,["presencePenalty"],y);const _=g(s,["responseLogprobs"]);_!=null&&v(e,["responseLogprobs"],_);const S=g(s,["responseMimeType"]);S!=null&&v(e,["responseMimeType"],S);const A=g(s,["responseModalities"]);A!=null&&v(e,["responseModalities"],A);const E=g(s,["responseSchema"]);E!=null&&v(e,["responseSchema"],E);const N=g(s,["routingConfig"]);N!=null&&v(e,["routingConfig"],N);const R=g(s,["seed"]);R!=null&&v(e,["seed"],R);const D=g(s,["speechConfig"]);D!=null&&v(e,["speechConfig"],D);const P=g(s,["stopSequences"]);P!=null&&v(e,["stopSequences"],P);const L=g(s,["temperature"]);L!=null&&v(e,["temperature"],L);const z=g(s,["thinkingConfig"]);z!=null&&v(e,["thinkingConfig"],z);const H=g(s,["topK"]);H!=null&&v(e,["topK"],H);const F=g(s,["topP"]);if(F!=null&&v(e,["topP"],F),g(s,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function V6(s){const e={};if(g(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(s,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function $6(s){const e={};if(g(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(s,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function Y6(s,e){const t={},n=g(s,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],n);const i=g(s,["responseModalities"]);e!==void 0&&i!=null&&v(e,["setup","generationConfig","responseModalities"],i);const a=g(s,["temperature"]);e!==void 0&&a!=null&&v(e,["setup","generationConfig","temperature"],a);const l=g(s,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=g(s,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const d=g(s,["maxOutputTokens"]);e!==void 0&&d!=null&&v(e,["setup","generationConfig","maxOutputTokens"],d);const h=g(s,["mediaResolution"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","mediaResolution"],h);const p=g(s,["seed"]);e!==void 0&&p!=null&&v(e,["setup","generationConfig","seed"],p);const y=g(s,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],Aw(y));const _=g(s,["thinkingConfig"]);e!==void 0&&_!=null&&v(e,["setup","generationConfig","thinkingConfig"],_);const S=g(s,["enableAffectiveDialog"]);e!==void 0&&S!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],S);const A=g(s,["systemInstruction"]);e!==void 0&&A!=null&&v(e,["setup","systemInstruction"],z6(Fn(A)));const E=g(s,["tools"]);if(e!==void 0&&E!=null){let H=jd(E);Array.isArray(H)&&(H=H.map(F=>ij(Fd(F)))),v(e,["setup","tools"],H)}const N=g(s,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],sj(N));const R=g(s,["inputAudioTranscription"]);e!==void 0&&R!=null&&v(e,["setup","inputAudioTranscription"],R);const D=g(s,["outputAudioTranscription"]);e!==void 0&&D!=null&&v(e,["setup","outputAudioTranscription"],D);const P=g(s,["realtimeInputConfig"]);e!==void 0&&P!=null&&v(e,["setup","realtimeInputConfig"],P);const L=g(s,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const z=g(s,["proactivity"]);if(e!==void 0&&z!=null&&v(e,["setup","proactivity"],z),g(s,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function K6(s,e){const t={},n=g(s,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],q6(n));const i=g(s,["responseModalities"]);e!==void 0&&i!=null&&v(e,["setup","generationConfig","responseModalities"],i);const a=g(s,["temperature"]);e!==void 0&&a!=null&&v(e,["setup","generationConfig","temperature"],a);const l=g(s,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=g(s,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const d=g(s,["maxOutputTokens"]);e!==void 0&&d!=null&&v(e,["setup","generationConfig","maxOutputTokens"],d);const h=g(s,["mediaResolution"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","mediaResolution"],h);const p=g(s,["seed"]);e!==void 0&&p!=null&&v(e,["setup","generationConfig","seed"],p);const y=g(s,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],Aw(y));const _=g(s,["thinkingConfig"]);e!==void 0&&_!=null&&v(e,["setup","generationConfig","thinkingConfig"],_);const S=g(s,["enableAffectiveDialog"]);e!==void 0&&S!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],S);const A=g(s,["systemInstruction"]);e!==void 0&&A!=null&&v(e,["setup","systemInstruction"],Fn(A));const E=g(s,["tools"]);if(e!==void 0&&E!=null){let F=jd(E);Array.isArray(F)&&(F=F.map(X=>rj(Fd(X)))),v(e,["setup","tools"],F)}const N=g(s,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],N);const R=g(s,["inputAudioTranscription"]);e!==void 0&&R!=null&&v(e,["setup","inputAudioTranscription"],R);const D=g(s,["outputAudioTranscription"]);e!==void 0&&D!=null&&v(e,["setup","outputAudioTranscription"],D);const P=g(s,["realtimeInputConfig"]);e!==void 0&&P!=null&&v(e,["setup","realtimeInputConfig"],P);const L=g(s,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const z=g(s,["proactivity"]);e!==void 0&&z!=null&&v(e,["setup","proactivity"],z);const H=g(s,["explicitVadSignal"]);return e!==void 0&&H!=null&&v(e,["setup","explicitVadSignal"],H),t}function X6(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["setup","model"],it(s,n));const i=g(e,["config"]);return i!=null&&v(t,["config"],Y6(i,t)),t}function J6(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["setup","model"],it(s,n));const i=g(e,["config"]);return i!=null&&v(t,["config"],K6(i,t)),t}function W6(s){const e={},t=g(s,["musicGenerationConfig"]);return t!=null&&v(e,["musicGenerationConfig"],t),e}function Q6(s){const e={},t=g(s,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>i)),v(e,["weightedPrompts"],n)}return e}function Z6(s){const e={},t=g(s,["media"]);if(t!=null){let h=K2(t);Array.isArray(h)&&(h=h.map(p=>d0(p))),v(e,["mediaChunks"],h)}const n=g(s,["audio"]);n!=null&&v(e,["audio"],d0(J2(n)));const i=g(s,["audioStreamEnd"]);i!=null&&v(e,["audioStreamEnd"],i);const a=g(s,["video"]);a!=null&&v(e,["video"],d0(X2(a)));const l=g(s,["text"]);l!=null&&v(e,["text"],l);const c=g(s,["activityStart"]);c!=null&&v(e,["activityStart"],c);const d=g(s,["activityEnd"]);return d!=null&&v(e,["activityEnd"],d),e}function ej(s){const e={},t=g(s,["media"]);if(t!=null){let h=K2(t);Array.isArray(h)&&(h=h.map(p=>p)),v(e,["mediaChunks"],h)}const n=g(s,["audio"]);n!=null&&v(e,["audio"],J2(n));const i=g(s,["audioStreamEnd"]);i!=null&&v(e,["audioStreamEnd"],i);const a=g(s,["video"]);a!=null&&v(e,["video"],X2(a));const l=g(s,["text"]);l!=null&&v(e,["text"],l);const c=g(s,["activityStart"]);c!=null&&v(e,["activityStart"],c);const d=g(s,["activityEnd"]);return d!=null&&v(e,["activityEnd"],d),e}function tj(s){const e={},t=g(s,["setupComplete"]);t!=null&&v(e,["setupComplete"],t);const n=g(s,["serverContent"]);n!=null&&v(e,["serverContent"],n);const i=g(s,["toolCall"]);i!=null&&v(e,["toolCall"],i);const a=g(s,["toolCallCancellation"]);a!=null&&v(e,["toolCallCancellation"],a);const l=g(s,["usageMetadata"]);l!=null&&v(e,["usageMetadata"],aj(l));const c=g(s,["goAway"]);c!=null&&v(e,["goAway"],c);const d=g(s,["sessionResumptionUpdate"]);d!=null&&v(e,["sessionResumptionUpdate"],d);const h=g(s,["voiceActivityDetectionSignal"]);return h!=null&&v(e,["voiceActivityDetectionSignal"],h),e}function nj(s){const e={},t=g(s,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=g(s,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const i=g(s,["executableCode"]);i!=null&&v(e,["executableCode"],i);const a=g(s,["fileData"]);a!=null&&v(e,["fileData"],H6(a));const l=g(s,["functionCall"]);l!=null&&v(e,["functionCall"],B6(l));const c=g(s,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const d=g(s,["inlineData"]);d!=null&&v(e,["inlineData"],d0(d));const h=g(s,["text"]);h!=null&&v(e,["text"],h);const p=g(s,["thought"]);p!=null&&v(e,["thought"],p);const y=g(s,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const _=g(s,["videoMetadata"]);return _!=null&&v(e,["videoMetadata"],_),e}function sj(s){const e={},t=g(s,["handle"]);if(t!=null&&v(e,["handle"],t),g(s,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function ij(s){const e={};if(g(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=g(s,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=g(s,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const i=g(s,["codeExecution"]);if(i!=null&&v(e,["codeExecution"],i),g(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(s,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(y=>y)),v(e,["functionDeclarations"],p)}const l=g(s,["googleMaps"]);l!=null&&v(e,["googleMaps"],V6(l));const c=g(s,["googleSearch"]);c!=null&&v(e,["googleSearch"],$6(c));const d=g(s,["googleSearchRetrieval"]);d!=null&&v(e,["googleSearchRetrieval"],d);const h=g(s,["urlContext"]);return h!=null&&v(e,["urlContext"],h),e}function rj(s){const e={},t=g(s,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=g(s,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),g(s,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=g(s,["codeExecution"]);i!=null&&v(e,["codeExecution"],i);const a=g(s,["enterpriseWebSearch"]);a!=null&&v(e,["enterpriseWebSearch"],a);const l=g(s,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(_=>G6(_))),v(e,["functionDeclarations"],y)}const c=g(s,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const d=g(s,["googleSearch"]);d!=null&&v(e,["googleSearch"],d);const h=g(s,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const p=g(s,["urlContext"]);return p!=null&&v(e,["urlContext"],p),e}function aj(s){const e={},t=g(s,["promptTokenCount"]);t!=null&&v(e,["promptTokenCount"],t);const n=g(s,["cachedContentTokenCount"]);n!=null&&v(e,["cachedContentTokenCount"],n);const i=g(s,["candidatesTokenCount"]);i!=null&&v(e,["responseTokenCount"],i);const a=g(s,["toolUsePromptTokenCount"]);a!=null&&v(e,["toolUsePromptTokenCount"],a);const l=g(s,["thoughtsTokenCount"]);l!=null&&v(e,["thoughtsTokenCount"],l);const c=g(s,["totalTokenCount"]);c!=null&&v(e,["totalTokenCount"],c);const d=g(s,["promptTokensDetails"]);if(d!=null){let S=d;Array.isArray(S)&&(S=S.map(A=>A)),v(e,["promptTokensDetails"],S)}const h=g(s,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(A=>A)),v(e,["cacheTokensDetails"],S)}const p=g(s,["candidatesTokensDetails"]);if(p!=null){let S=p;Array.isArray(S)&&(S=S.map(A=>A)),v(e,["responseTokensDetails"],S)}const y=g(s,["toolUsePromptTokensDetails"]);if(y!=null){let S=y;Array.isArray(S)&&(S=S.map(A=>A)),v(e,["toolUsePromptTokensDetails"],S)}const _=g(s,["trafficType"]);return _!=null&&v(e,["trafficType"],_),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oj(s){const e={},t=g(s,["data"]);if(t!=null&&v(e,["data"],t),g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function lj(s){const e={},t=g(s,["content"]);t!=null&&v(e,["content"],t);const n=g(s,["citationMetadata"]);n!=null&&v(e,["citationMetadata"],cj(n));const i=g(s,["tokenCount"]);i!=null&&v(e,["tokenCount"],i);const a=g(s,["finishReason"]);a!=null&&v(e,["finishReason"],a);const l=g(s,["avgLogprobs"]);l!=null&&v(e,["avgLogprobs"],l);const c=g(s,["groundingMetadata"]);c!=null&&v(e,["groundingMetadata"],c);const d=g(s,["index"]);d!=null&&v(e,["index"],d);const h=g(s,["logprobsResult"]);h!=null&&v(e,["logprobsResult"],h);const p=g(s,["safetyRatings"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(S=>S)),v(e,["safetyRatings"],_)}const y=g(s,["urlContextMetadata"]);return y!=null&&v(e,["urlContextMetadata"],y),e}function cj(s){const e={},t=g(s,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>i)),v(e,["citations"],n)}return e}function uj(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let a=ui(i);Array.isArray(a)&&(a=a.map(l=>l)),v(t,["contents"],a)}return t}function dj(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["tokensInfo"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>a)),v(e,["tokensInfo"],i)}return e}function hj(s){const e={},t=g(s,["values"]);t!=null&&v(e,["values"],t);const n=g(s,["statistics"]);return n!=null&&v(e,["statistics"],fj(n)),e}function fj(s){const e={},t=g(s,["truncated"]);t!=null&&v(e,["truncated"],t);const n=g(s,["token_count"]);return n!=null&&v(e,["tokenCount"],n),e}function uv(s){const e={},t=g(s,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>wz(a))),v(e,["parts"],i)}const n=g(s,["role"]);return n!=null&&v(e,["role"],n),e}function pj(s){const e={},t=g(s,["controlType"]);t!=null&&v(e,["controlType"],t);const n=g(s,["enableControlImageComputation"]);return n!=null&&v(e,["computeControl"],n),e}function mj(s){const e={};if(g(s,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(g(s,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(g(s,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function gj(s,e){const t={},n=g(s,["systemInstruction"]);e!==void 0&&n!=null&&v(e,["systemInstruction"],Fn(n));const i=g(s,["tools"]);if(e!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>uk(c))),v(e,["tools"],l)}const a=g(s,["generationConfig"]);return e!==void 0&&a!=null&&v(e,["generationConfig"],oz(a)),t}function vj(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let l=ui(i);Array.isArray(l)&&(l=l.map(c=>uv(c))),v(t,["contents"],l)}const a=g(e,["config"]);return a!=null&&mj(a),t}function yj(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let l=ui(i);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["contents"],l)}const a=g(e,["config"]);return a!=null&&gj(a,t),t}function bj(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["totalTokens"]);n!=null&&v(e,["totalTokens"],n);const i=g(s,["cachedContentTokenCount"]);return i!=null&&v(e,["cachedContentTokenCount"],i),e}function _j(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["totalTokens"]);return n!=null&&v(e,["totalTokens"],n),e}function xj(s,e){const t={},n=g(e,["model"]);return n!=null&&v(t,["_url","name"],it(s,n)),t}function wj(s,e){const t={},n=g(e,["model"]);return n!=null&&v(t,["_url","name"],it(s,n)),t}function Sj(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function Aj(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function Ej(s,e){const t={},n=g(s,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const i=g(s,["negativePrompt"]);e!==void 0&&i!=null&&v(e,["parameters","negativePrompt"],i);const a=g(s,["numberOfImages"]);e!==void 0&&a!=null&&v(e,["parameters","sampleCount"],a);const l=g(s,["aspectRatio"]);e!==void 0&&l!=null&&v(e,["parameters","aspectRatio"],l);const c=g(s,["guidanceScale"]);e!==void 0&&c!=null&&v(e,["parameters","guidanceScale"],c);const d=g(s,["seed"]);e!==void 0&&d!=null&&v(e,["parameters","seed"],d);const h=g(s,["safetyFilterLevel"]);e!==void 0&&h!=null&&v(e,["parameters","safetySetting"],h);const p=g(s,["personGeneration"]);e!==void 0&&p!=null&&v(e,["parameters","personGeneration"],p);const y=g(s,["includeSafetyAttributes"]);e!==void 0&&y!=null&&v(e,["parameters","includeSafetyAttributes"],y);const _=g(s,["includeRaiReason"]);e!==void 0&&_!=null&&v(e,["parameters","includeRaiReason"],_);const S=g(s,["language"]);e!==void 0&&S!=null&&v(e,["parameters","language"],S);const A=g(s,["outputMimeType"]);e!==void 0&&A!=null&&v(e,["parameters","outputOptions","mimeType"],A);const E=g(s,["outputCompressionQuality"]);e!==void 0&&E!=null&&v(e,["parameters","outputOptions","compressionQuality"],E);const N=g(s,["addWatermark"]);e!==void 0&&N!=null&&v(e,["parameters","addWatermark"],N);const R=g(s,["labels"]);e!==void 0&&R!=null&&v(e,["labels"],R);const D=g(s,["editMode"]);e!==void 0&&D!=null&&v(e,["parameters","editMode"],D);const P=g(s,["baseSteps"]);return e!==void 0&&P!=null&&v(e,["parameters","editConfig","baseSteps"],P),t}function Tj(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["prompt"]);i!=null&&v(t,["instances[0]","prompt"],i);const a=g(e,["referenceImages"]);if(a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>Nz(d))),v(t,["instances[0]","referenceImages"],c)}const l=g(e,["config"]);return l!=null&&Ej(l,t),t}function Cj(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>dv(a))),v(e,["generatedImages"],i)}return e}function Nj(s,e){const t={},n=g(s,["taskType"]);e!==void 0&&n!=null&&v(e,["requests[]","taskType"],n);const i=g(s,["title"]);e!==void 0&&i!=null&&v(e,["requests[]","title"],i);const a=g(s,["outputDimensionality"]);if(e!==void 0&&a!=null&&v(e,["requests[]","outputDimensionality"],a),g(s,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(s,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Rj(s,e){const t={},n=g(s,["taskType"]);e!==void 0&&n!=null&&v(e,["instances[]","task_type"],n);const i=g(s,["title"]);e!==void 0&&i!=null&&v(e,["instances[]","title"],i);const a=g(s,["outputDimensionality"]);e!==void 0&&a!=null&&v(e,["parameters","outputDimensionality"],a);const l=g(s,["mimeType"]);e!==void 0&&l!=null&&v(e,["instances[]","mimeType"],l);const c=g(s,["autoTruncate"]);return e!==void 0&&c!=null&&v(e,["parameters","autoTruncate"],c),t}function kj(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let c=xw(s,i);Array.isArray(c)&&(c=c.map(d=>d)),v(t,["requests[]","content"],c)}const a=g(e,["config"]);a!=null&&Nj(a,t);const l=g(e,["model"]);return l!==void 0&&v(t,["requests[]","model"],it(s,l)),t}function Mj(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let l=xw(s,i);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["instances[]","content"],l)}const a=g(e,["config"]);return a!=null&&Rj(a,t),t}function Ij(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>l)),v(e,["embeddings"],a)}const i=g(s,["metadata"]);return i!=null&&v(e,["metadata"],i),e}function Dj(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>hj(l))),v(e,["embeddings"],a)}const i=g(s,["metadata"]);return i!=null&&v(e,["metadata"],i),e}function Pj(s){const e={},t=g(s,["endpoint"]);t!=null&&v(e,["name"],t);const n=g(s,["deployedModelId"]);return n!=null&&v(e,["deployedModelId"],n),e}function Lj(s){const e={};if(g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(s,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function Oj(s){const e={},t=g(s,["id"]);t!=null&&v(e,["id"],t);const n=g(s,["args"]);n!=null&&v(e,["args"],n);const i=g(s,["name"]);if(i!=null&&v(e,["name"],i),g(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Uj(s){const e={},t=g(s,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=g(s,["mode"]);if(n!=null&&v(e,["mode"],n),g(s,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Fj(s){const e={},t=g(s,["description"]);t!=null&&v(e,["description"],t);const n=g(s,["name"]);n!=null&&v(e,["name"],n);const i=g(s,["parameters"]);i!=null&&v(e,["parameters"],i);const a=g(s,["parametersJsonSchema"]);a!=null&&v(e,["parametersJsonSchema"],a);const l=g(s,["response"]);l!=null&&v(e,["response"],l);const c=g(s,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),g(s,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function jj(s,e,t){const n={},i=g(e,["systemInstruction"]);t!==void 0&&i!=null&&v(t,["systemInstruction"],uv(Fn(i)));const a=g(e,["temperature"]);a!=null&&v(n,["temperature"],a);const l=g(e,["topP"]);l!=null&&v(n,["topP"],l);const c=g(e,["topK"]);c!=null&&v(n,["topK"],c);const d=g(e,["candidateCount"]);d!=null&&v(n,["candidateCount"],d);const h=g(e,["maxOutputTokens"]);h!=null&&v(n,["maxOutputTokens"],h);const p=g(e,["stopSequences"]);p!=null&&v(n,["stopSequences"],p);const y=g(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const _=g(e,["logprobs"]);_!=null&&v(n,["logprobs"],_);const S=g(e,["presencePenalty"]);S!=null&&v(n,["presencePenalty"],S);const A=g(e,["frequencyPenalty"]);A!=null&&v(n,["frequencyPenalty"],A);const E=g(e,["seed"]);E!=null&&v(n,["seed"],E);const N=g(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const R=g(e,["responseSchema"]);R!=null&&v(n,["responseSchema"],ww(R));const D=g(e,["responseJsonSchema"]);if(D!=null&&v(n,["responseJsonSchema"],D),g(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=g(e,["safetySettings"]);if(t!==void 0&&P!=null){let ye=P;Array.isArray(ye)&&(ye=ye.map(be=>Rz(be))),v(t,["safetySettings"],ye)}const L=g(e,["tools"]);if(t!==void 0&&L!=null){let ye=jd(L);Array.isArray(ye)&&(ye=ye.map(be=>Oz(Fd(be)))),v(t,["tools"],ye)}const z=g(e,["toolConfig"]);if(t!==void 0&&z!=null&&v(t,["toolConfig"],Lz(z)),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=g(e,["cachedContent"]);t!==void 0&&H!=null&&v(t,["cachedContent"],va(s,H));const F=g(e,["responseModalities"]);F!=null&&v(n,["responseModalities"],F);const X=g(e,["mediaResolution"]);X!=null&&v(n,["mediaResolution"],X);const Y=g(e,["speechConfig"]);if(Y!=null&&v(n,["speechConfig"],Sw(Y)),g(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const J=g(e,["thinkingConfig"]);J!=null&&v(n,["thinkingConfig"],J);const ie=g(e,["imageConfig"]);ie!=null&&v(n,["imageConfig"],hz(ie));const pe=g(e,["enableEnhancedCivicAnswers"]);return pe!=null&&v(n,["enableEnhancedCivicAnswers"],pe),n}function zj(s,e,t){const n={},i=g(e,["systemInstruction"]);t!==void 0&&i!=null&&v(t,["systemInstruction"],Fn(i));const a=g(e,["temperature"]);a!=null&&v(n,["temperature"],a);const l=g(e,["topP"]);l!=null&&v(n,["topP"],l);const c=g(e,["topK"]);c!=null&&v(n,["topK"],c);const d=g(e,["candidateCount"]);d!=null&&v(n,["candidateCount"],d);const h=g(e,["maxOutputTokens"]);h!=null&&v(n,["maxOutputTokens"],h);const p=g(e,["stopSequences"]);p!=null&&v(n,["stopSequences"],p);const y=g(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const _=g(e,["logprobs"]);_!=null&&v(n,["logprobs"],_);const S=g(e,["presencePenalty"]);S!=null&&v(n,["presencePenalty"],S);const A=g(e,["frequencyPenalty"]);A!=null&&v(n,["frequencyPenalty"],A);const E=g(e,["seed"]);E!=null&&v(n,["seed"],E);const N=g(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const R=g(e,["responseSchema"]);R!=null&&v(n,["responseSchema"],ww(R));const D=g(e,["responseJsonSchema"]);D!=null&&v(n,["responseJsonSchema"],D);const P=g(e,["routingConfig"]);P!=null&&v(n,["routingConfig"],P);const L=g(e,["modelSelectionConfig"]);L!=null&&v(n,["modelConfig"],L);const z=g(e,["safetySettings"]);if(t!==void 0&&z!=null){let j=z;Array.isArray(j)&&(j=j.map(G=>G)),v(t,["safetySettings"],j)}const H=g(e,["tools"]);if(t!==void 0&&H!=null){let j=jd(H);Array.isArray(j)&&(j=j.map(G=>uk(Fd(G)))),v(t,["tools"],j)}const F=g(e,["toolConfig"]);t!==void 0&&F!=null&&v(t,["toolConfig"],F);const X=g(e,["labels"]);t!==void 0&&X!=null&&v(t,["labels"],X);const Y=g(e,["cachedContent"]);t!==void 0&&Y!=null&&v(t,["cachedContent"],va(s,Y));const J=g(e,["responseModalities"]);J!=null&&v(n,["responseModalities"],J);const ie=g(e,["mediaResolution"]);ie!=null&&v(n,["mediaResolution"],ie);const pe=g(e,["speechConfig"]);pe!=null&&v(n,["speechConfig"],Sw(pe));const ye=g(e,["audioTimestamp"]);ye!=null&&v(n,["audioTimestamp"],ye);const be=g(e,["thinkingConfig"]);be!=null&&v(n,["thinkingConfig"],be);const Se=g(e,["imageConfig"]);if(Se!=null&&v(n,["imageConfig"],fz(Se)),g(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}function $C(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let l=ui(i);Array.isArray(l)&&(l=l.map(c=>uv(c))),v(t,["contents"],l)}const a=g(e,["config"]);return a!=null&&v(t,["generationConfig"],jj(s,a,t)),t}function YC(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let l=ui(i);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["contents"],l)}const a=g(e,["config"]);return a!=null&&v(t,["generationConfig"],zj(s,a,t)),t}function KC(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>lj(h))),v(e,["candidates"],d)}const i=g(s,["modelVersion"]);i!=null&&v(e,["modelVersion"],i);const a=g(s,["promptFeedback"]);a!=null&&v(e,["promptFeedback"],a);const l=g(s,["responseId"]);l!=null&&v(e,["responseId"],l);const c=g(s,["usageMetadata"]);return c!=null&&v(e,["usageMetadata"],c),e}function XC(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>p)),v(e,["candidates"],h)}const i=g(s,["createTime"]);i!=null&&v(e,["createTime"],i);const a=g(s,["modelVersion"]);a!=null&&v(e,["modelVersion"],a);const l=g(s,["promptFeedback"]);l!=null&&v(e,["promptFeedback"],l);const c=g(s,["responseId"]);c!=null&&v(e,["responseId"],c);const d=g(s,["usageMetadata"]);return d!=null&&v(e,["usageMetadata"],d),e}function Hj(s,e){const t={};if(g(s,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(s,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=g(s,["numberOfImages"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const i=g(s,["aspectRatio"]);e!==void 0&&i!=null&&v(e,["parameters","aspectRatio"],i);const a=g(s,["guidanceScale"]);if(e!==void 0&&a!=null&&v(e,["parameters","guidanceScale"],a),g(s,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=g(s,["safetyFilterLevel"]);e!==void 0&&l!=null&&v(e,["parameters","safetySetting"],l);const c=g(s,["personGeneration"]);e!==void 0&&c!=null&&v(e,["parameters","personGeneration"],c);const d=g(s,["includeSafetyAttributes"]);e!==void 0&&d!=null&&v(e,["parameters","includeSafetyAttributes"],d);const h=g(s,["includeRaiReason"]);e!==void 0&&h!=null&&v(e,["parameters","includeRaiReason"],h);const p=g(s,["language"]);e!==void 0&&p!=null&&v(e,["parameters","language"],p);const y=g(s,["outputMimeType"]);e!==void 0&&y!=null&&v(e,["parameters","outputOptions","mimeType"],y);const _=g(s,["outputCompressionQuality"]);if(e!==void 0&&_!=null&&v(e,["parameters","outputOptions","compressionQuality"],_),g(s,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(g(s,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const S=g(s,["imageSize"]);if(e!==void 0&&S!=null&&v(e,["parameters","sampleImageSize"],S),g(s,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function Bj(s,e){const t={},n=g(s,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const i=g(s,["negativePrompt"]);e!==void 0&&i!=null&&v(e,["parameters","negativePrompt"],i);const a=g(s,["numberOfImages"]);e!==void 0&&a!=null&&v(e,["parameters","sampleCount"],a);const l=g(s,["aspectRatio"]);e!==void 0&&l!=null&&v(e,["parameters","aspectRatio"],l);const c=g(s,["guidanceScale"]);e!==void 0&&c!=null&&v(e,["parameters","guidanceScale"],c);const d=g(s,["seed"]);e!==void 0&&d!=null&&v(e,["parameters","seed"],d);const h=g(s,["safetyFilterLevel"]);e!==void 0&&h!=null&&v(e,["parameters","safetySetting"],h);const p=g(s,["personGeneration"]);e!==void 0&&p!=null&&v(e,["parameters","personGeneration"],p);const y=g(s,["includeSafetyAttributes"]);e!==void 0&&y!=null&&v(e,["parameters","includeSafetyAttributes"],y);const _=g(s,["includeRaiReason"]);e!==void 0&&_!=null&&v(e,["parameters","includeRaiReason"],_);const S=g(s,["language"]);e!==void 0&&S!=null&&v(e,["parameters","language"],S);const A=g(s,["outputMimeType"]);e!==void 0&&A!=null&&v(e,["parameters","outputOptions","mimeType"],A);const E=g(s,["outputCompressionQuality"]);e!==void 0&&E!=null&&v(e,["parameters","outputOptions","compressionQuality"],E);const N=g(s,["addWatermark"]);e!==void 0&&N!=null&&v(e,["parameters","addWatermark"],N);const R=g(s,["labels"]);e!==void 0&&R!=null&&v(e,["labels"],R);const D=g(s,["imageSize"]);e!==void 0&&D!=null&&v(e,["parameters","sampleImageSize"],D);const P=g(s,["enhancePrompt"]);return e!==void 0&&P!=null&&v(e,["parameters","enhancePrompt"],P),t}function Gj(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["prompt"]);i!=null&&v(t,["instances[0]","prompt"],i);const a=g(e,["config"]);return a!=null&&Hj(a,t),t}function qj(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["prompt"]);i!=null&&v(t,["instances[0]","prompt"],i);const a=g(e,["config"]);return a!=null&&Bj(a,t),t}function Vj(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>sz(l))),v(e,["generatedImages"],a)}const i=g(s,["positivePromptSafetyAttributes"]);return i!=null&&v(e,["positivePromptSafetyAttributes"],lk(i)),e}function $j(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>dv(l))),v(e,["generatedImages"],a)}const i=g(s,["positivePromptSafetyAttributes"]);return i!=null&&v(e,["positivePromptSafetyAttributes"],ck(i)),e}function Yj(s,e){const t={},n=g(s,["numberOfVideos"]);if(e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n),g(s,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(s,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=g(s,["durationSeconds"]);if(e!==void 0&&i!=null&&v(e,["parameters","durationSeconds"],i),g(s,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=g(s,["aspectRatio"]);e!==void 0&&a!=null&&v(e,["parameters","aspectRatio"],a);const l=g(s,["resolution"]);e!==void 0&&l!=null&&v(e,["parameters","resolution"],l);const c=g(s,["personGeneration"]);if(e!==void 0&&c!=null&&v(e,["parameters","personGeneration"],c),g(s,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=g(s,["negativePrompt"]);e!==void 0&&d!=null&&v(e,["parameters","negativePrompt"],d);const h=g(s,["enhancePrompt"]);if(e!==void 0&&h!=null&&v(e,["parameters","enhancePrompt"],h),g(s,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const p=g(s,["lastFrame"]);e!==void 0&&p!=null&&v(e,["instances[0]","lastFrame"],hv(p));const y=g(s,["referenceImages"]);if(e!==void 0&&y!=null){let _=y;Array.isArray(_)&&(_=_.map(S=>Xz(S))),v(e,["instances[0]","referenceImages"],_)}if(g(s,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(g(s,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function Kj(s,e){const t={},n=g(s,["numberOfVideos"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const i=g(s,["outputGcsUri"]);e!==void 0&&i!=null&&v(e,["parameters","storageUri"],i);const a=g(s,["fps"]);e!==void 0&&a!=null&&v(e,["parameters","fps"],a);const l=g(s,["durationSeconds"]);e!==void 0&&l!=null&&v(e,["parameters","durationSeconds"],l);const c=g(s,["seed"]);e!==void 0&&c!=null&&v(e,["parameters","seed"],c);const d=g(s,["aspectRatio"]);e!==void 0&&d!=null&&v(e,["parameters","aspectRatio"],d);const h=g(s,["resolution"]);e!==void 0&&h!=null&&v(e,["parameters","resolution"],h);const p=g(s,["personGeneration"]);e!==void 0&&p!=null&&v(e,["parameters","personGeneration"],p);const y=g(s,["pubsubTopic"]);e!==void 0&&y!=null&&v(e,["parameters","pubsubTopic"],y);const _=g(s,["negativePrompt"]);e!==void 0&&_!=null&&v(e,["parameters","negativePrompt"],_);const S=g(s,["enhancePrompt"]);e!==void 0&&S!=null&&v(e,["parameters","enhancePrompt"],S);const A=g(s,["generateAudio"]);e!==void 0&&A!=null&&v(e,["parameters","generateAudio"],A);const E=g(s,["lastFrame"]);e!==void 0&&E!=null&&v(e,["instances[0]","lastFrame"],ji(E));const N=g(s,["referenceImages"]);if(e!==void 0&&N!=null){let P=N;Array.isArray(P)&&(P=P.map(L=>Jz(L))),v(e,["instances[0]","referenceImages"],P)}const R=g(s,["mask"]);e!==void 0&&R!=null&&v(e,["instances[0]","mask"],Kz(R));const D=g(s,["compressionQuality"]);return e!==void 0&&D!=null&&v(e,["parameters","compressionQuality"],D),t}function Xj(s){const e={},t=g(s,["name"]);t!=null&&v(e,["name"],t);const n=g(s,["metadata"]);n!=null&&v(e,["metadata"],n);const i=g(s,["done"]);i!=null&&v(e,["done"],i);const a=g(s,["error"]);a!=null&&v(e,["error"],a);const l=g(s,["response","generateVideoResponse"]);return l!=null&&v(e,["response"],Zj(l)),e}function Jj(s){const e={},t=g(s,["name"]);t!=null&&v(e,["name"],t);const n=g(s,["metadata"]);n!=null&&v(e,["metadata"],n);const i=g(s,["done"]);i!=null&&v(e,["done"],i);const a=g(s,["error"]);a!=null&&v(e,["error"],a);const l=g(s,["response"]);return l!=null&&v(e,["response"],ez(l)),e}function Wj(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["prompt"]);i!=null&&v(t,["instances[0]","prompt"],i);const a=g(e,["image"]);a!=null&&v(t,["instances[0]","image"],hv(a));const l=g(e,["video"]);l!=null&&v(t,["instances[0]","video"],dk(l));const c=g(e,["source"]);c!=null&&tz(c,t);const d=g(e,["config"]);return d!=null&&Yj(d,t),t}function Qj(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["prompt"]);i!=null&&v(t,["instances[0]","prompt"],i);const a=g(e,["image"]);a!=null&&v(t,["instances[0]","image"],ji(a));const l=g(e,["video"]);l!=null&&v(t,["instances[0]","video"],hk(l));const c=g(e,["source"]);c!=null&&nz(c,t);const d=g(e,["config"]);return d!=null&&Kj(d,t),t}function Zj(s){const e={},t=g(s,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>rz(l))),v(e,["generatedVideos"],a)}const n=g(s,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const i=g(s,["raiMediaFilteredReasons"]);return i!=null&&v(e,["raiMediaFilteredReasons"],i),e}function ez(s){const e={},t=g(s,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>az(l))),v(e,["generatedVideos"],a)}const n=g(s,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const i=g(s,["raiMediaFilteredReasons"]);return i!=null&&v(e,["raiMediaFilteredReasons"],i),e}function tz(s,e){const t={},n=g(s,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const i=g(s,["image"]);e!==void 0&&i!=null&&v(e,["instances[0]","image"],hv(i));const a=g(s,["video"]);return e!==void 0&&a!=null&&v(e,["instances[0]","video"],dk(a)),t}function nz(s,e){const t={},n=g(s,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const i=g(s,["image"]);e!==void 0&&i!=null&&v(e,["instances[0]","image"],ji(i));const a=g(s,["video"]);return e!==void 0&&a!=null&&v(e,["instances[0]","video"],hk(a)),t}function sz(s){const e={},t=g(s,["_self"]);t!=null&&v(e,["image"],pz(t));const n=g(s,["raiFilteredReason"]);n!=null&&v(e,["raiFilteredReason"],n);const i=g(s,["_self"]);return i!=null&&v(e,["safetyAttributes"],lk(i)),e}function dv(s){const e={},t=g(s,["_self"]);t!=null&&v(e,["image"],ok(t));const n=g(s,["raiFilteredReason"]);n!=null&&v(e,["raiFilteredReason"],n);const i=g(s,["_self"]);i!=null&&v(e,["safetyAttributes"],ck(i));const a=g(s,["prompt"]);return a!=null&&v(e,["enhancedPrompt"],a),e}function iz(s){const e={},t=g(s,["_self"]);t!=null&&v(e,["mask"],ok(t));const n=g(s,["labels"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>a)),v(e,["labels"],i)}return e}function rz(s){const e={},t=g(s,["video"]);return t!=null&&v(e,["video"],$z(t)),e}function az(s){const e={},t=g(s,["_self"]);return t!=null&&v(e,["video"],Yz(t)),e}function oz(s){const e={},t=g(s,["modelSelectionConfig"]);t!=null&&v(e,["modelConfig"],t);const n=g(s,["responseJsonSchema"]);n!=null&&v(e,["responseJsonSchema"],n);const i=g(s,["audioTimestamp"]);i!=null&&v(e,["audioTimestamp"],i);const a=g(s,["candidateCount"]);a!=null&&v(e,["candidateCount"],a);const l=g(s,["enableAffectiveDialog"]);l!=null&&v(e,["enableAffectiveDialog"],l);const c=g(s,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const d=g(s,["logprobs"]);d!=null&&v(e,["logprobs"],d);const h=g(s,["maxOutputTokens"]);h!=null&&v(e,["maxOutputTokens"],h);const p=g(s,["mediaResolution"]);p!=null&&v(e,["mediaResolution"],p);const y=g(s,["presencePenalty"]);y!=null&&v(e,["presencePenalty"],y);const _=g(s,["responseLogprobs"]);_!=null&&v(e,["responseLogprobs"],_);const S=g(s,["responseMimeType"]);S!=null&&v(e,["responseMimeType"],S);const A=g(s,["responseModalities"]);A!=null&&v(e,["responseModalities"],A);const E=g(s,["responseSchema"]);E!=null&&v(e,["responseSchema"],E);const N=g(s,["routingConfig"]);N!=null&&v(e,["routingConfig"],N);const R=g(s,["seed"]);R!=null&&v(e,["seed"],R);const D=g(s,["speechConfig"]);D!=null&&v(e,["speechConfig"],D);const P=g(s,["stopSequences"]);P!=null&&v(e,["stopSequences"],P);const L=g(s,["temperature"]);L!=null&&v(e,["temperature"],L);const z=g(s,["thinkingConfig"]);z!=null&&v(e,["thinkingConfig"],z);const H=g(s,["topK"]);H!=null&&v(e,["topK"],H);const F=g(s,["topP"]);if(F!=null&&v(e,["topP"],F),g(s,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function lz(s,e){const t={},n=g(e,["model"]);return n!=null&&v(t,["_url","name"],it(s,n)),t}function cz(s,e){const t={},n=g(e,["model"]);return n!=null&&v(t,["_url","name"],it(s,n)),t}function uz(s){const e={};if(g(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(s,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function dz(s){const e={};if(g(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(s,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function hz(s){const e={},t=g(s,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=g(s,["imageSize"]);if(n!=null&&v(e,["imageSize"],n),g(s,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(g(s,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(s,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function fz(s){const e={},t=g(s,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=g(s,["imageSize"]);n!=null&&v(e,["imageSize"],n);const i=g(s,["personGeneration"]);i!=null&&v(e,["personGeneration"],i);const a=g(s,["outputMimeType"]);a!=null&&v(e,["imageOutputOptions","mimeType"],a);const l=g(s,["outputCompressionQuality"]);return l!=null&&v(e,["imageOutputOptions","compressionQuality"],l),e}function pz(s){const e={},t=g(s,["bytesBase64Encoded"]);t!=null&&v(e,["imageBytes"],ko(t));const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function ok(s){const e={},t=g(s,["gcsUri"]);t!=null&&v(e,["gcsUri"],t);const n=g(s,["bytesBase64Encoded"]);n!=null&&v(e,["imageBytes"],ko(n));const i=g(s,["mimeType"]);return i!=null&&v(e,["mimeType"],i),e}function hv(s){const e={};if(g(s,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=g(s,["imageBytes"]);t!=null&&v(e,["bytesBase64Encoded"],ko(t));const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function ji(s){const e={},t=g(s,["gcsUri"]);t!=null&&v(e,["gcsUri"],t);const n=g(s,["imageBytes"]);n!=null&&v(e,["bytesBase64Encoded"],ko(n));const i=g(s,["mimeType"]);return i!=null&&v(e,["mimeType"],i),e}function mz(s,e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&v(t,["_query","pageSize"],i);const a=g(e,["pageToken"]);t!==void 0&&a!=null&&v(t,["_query","pageToken"],a);const l=g(e,["filter"]);t!==void 0&&l!=null&&v(t,["_query","filter"],l);const c=g(e,["queryBase"]);return t!==void 0&&c!=null&&v(t,["_url","models_url"],ek(s,c)),n}function gz(s,e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&v(t,["_query","pageSize"],i);const a=g(e,["pageToken"]);t!==void 0&&a!=null&&v(t,["_query","pageToken"],a);const l=g(e,["filter"]);t!==void 0&&l!=null&&v(t,["_query","filter"],l);const c=g(e,["queryBase"]);return t!==void 0&&c!=null&&v(t,["_url","models_url"],ek(s,c)),n}function vz(s,e){const t={},n=g(e,["config"]);return n!=null&&mz(s,n,t),t}function yz(s,e){const t={},n=g(e,["config"]);return n!=null&&gz(s,n,t),t}function bz(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=g(s,["_self"]);if(i!=null){let a=tk(i);Array.isArray(a)&&(a=a.map(l=>Bx(l))),v(e,["models"],a)}return e}function _z(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=g(s,["_self"]);if(i!=null){let a=tk(i);Array.isArray(a)&&(a=a.map(l=>Gx(l))),v(e,["models"],a)}return e}function xz(s){const e={},t=g(s,["maskMode"]);t!=null&&v(e,["maskMode"],t);const n=g(s,["segmentationClasses"]);n!=null&&v(e,["maskClasses"],n);const i=g(s,["maskDilation"]);return i!=null&&v(e,["dilation"],i),e}function Bx(s){const e={},t=g(s,["name"]);t!=null&&v(e,["name"],t);const n=g(s,["displayName"]);n!=null&&v(e,["displayName"],n);const i=g(s,["description"]);i!=null&&v(e,["description"],i);const a=g(s,["version"]);a!=null&&v(e,["version"],a);const l=g(s,["_self"]);l!=null&&v(e,["tunedModelInfo"],Uz(l));const c=g(s,["inputTokenLimit"]);c!=null&&v(e,["inputTokenLimit"],c);const d=g(s,["outputTokenLimit"]);d!=null&&v(e,["outputTokenLimit"],d);const h=g(s,["supportedGenerationMethods"]);h!=null&&v(e,["supportedActions"],h);const p=g(s,["temperature"]);p!=null&&v(e,["temperature"],p);const y=g(s,["maxTemperature"]);y!=null&&v(e,["maxTemperature"],y);const _=g(s,["topP"]);_!=null&&v(e,["topP"],_);const S=g(s,["topK"]);S!=null&&v(e,["topK"],S);const A=g(s,["thinking"]);return A!=null&&v(e,["thinking"],A),e}function Gx(s){const e={},t=g(s,["name"]);t!=null&&v(e,["name"],t);const n=g(s,["displayName"]);n!=null&&v(e,["displayName"],n);const i=g(s,["description"]);i!=null&&v(e,["description"],i);const a=g(s,["versionId"]);a!=null&&v(e,["version"],a);const l=g(s,["deployedModels"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(_=>Pj(_))),v(e,["endpoints"],y)}const c=g(s,["labels"]);c!=null&&v(e,["labels"],c);const d=g(s,["_self"]);d!=null&&v(e,["tunedModelInfo"],Fz(d));const h=g(s,["defaultCheckpointId"]);h!=null&&v(e,["defaultCheckpointId"],h);const p=g(s,["checkpoints"]);if(p!=null){let y=p;Array.isArray(y)&&(y=y.map(_=>_)),v(e,["checkpoints"],y)}return e}function wz(s){const e={},t=g(s,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=g(s,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const i=g(s,["executableCode"]);i!=null&&v(e,["executableCode"],i);const a=g(s,["fileData"]);a!=null&&v(e,["fileData"],Lj(a));const l=g(s,["functionCall"]);l!=null&&v(e,["functionCall"],Oj(l));const c=g(s,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const d=g(s,["inlineData"]);d!=null&&v(e,["inlineData"],oj(d));const h=g(s,["text"]);h!=null&&v(e,["text"],h);const p=g(s,["thought"]);p!=null&&v(e,["thought"],p);const y=g(s,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const _=g(s,["videoMetadata"]);return _!=null&&v(e,["videoMetadata"],_),e}function Sz(s){const e={},t=g(s,["productImage"]);return t!=null&&v(e,["image"],ji(t)),e}function Az(s,e){const t={},n=g(s,["numberOfImages"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const i=g(s,["baseSteps"]);e!==void 0&&i!=null&&v(e,["parameters","baseSteps"],i);const a=g(s,["outputGcsUri"]);e!==void 0&&a!=null&&v(e,["parameters","storageUri"],a);const l=g(s,["seed"]);e!==void 0&&l!=null&&v(e,["parameters","seed"],l);const c=g(s,["safetyFilterLevel"]);e!==void 0&&c!=null&&v(e,["parameters","safetySetting"],c);const d=g(s,["personGeneration"]);e!==void 0&&d!=null&&v(e,["parameters","personGeneration"],d);const h=g(s,["addWatermark"]);e!==void 0&&h!=null&&v(e,["parameters","addWatermark"],h);const p=g(s,["outputMimeType"]);e!==void 0&&p!=null&&v(e,["parameters","outputOptions","mimeType"],p);const y=g(s,["outputCompressionQuality"]);e!==void 0&&y!=null&&v(e,["parameters","outputOptions","compressionQuality"],y);const _=g(s,["enhancePrompt"]);e!==void 0&&_!=null&&v(e,["parameters","enhancePrompt"],_);const S=g(s,["labels"]);return e!==void 0&&S!=null&&v(e,["labels"],S),t}function Ez(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["source"]);i!=null&&Cz(i,t);const a=g(e,["config"]);return a!=null&&Az(a,t),t}function Tz(s){const e={},t=g(s,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>dv(i))),v(e,["generatedImages"],n)}return e}function Cz(s,e){const t={},n=g(s,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const i=g(s,["personImage"]);e!==void 0&&i!=null&&v(e,["instances[0]","personImage","image"],ji(i));const a=g(s,["productImages"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>Sz(c))),v(e,["instances[0]","productImages"],l)}return t}function Nz(s){const e={},t=g(s,["referenceImage"]);t!=null&&v(e,["referenceImage"],ji(t));const n=g(s,["referenceId"]);n!=null&&v(e,["referenceId"],n);const i=g(s,["referenceType"]);i!=null&&v(e,["referenceType"],i);const a=g(s,["maskImageConfig"]);a!=null&&v(e,["maskImageConfig"],xz(a));const l=g(s,["controlImageConfig"]);l!=null&&v(e,["controlImageConfig"],pj(l));const c=g(s,["styleImageConfig"]);c!=null&&v(e,["styleImageConfig"],c);const d=g(s,["subjectImageConfig"]);return d!=null&&v(e,["subjectImageConfig"],d),e}function lk(s){const e={},t=g(s,["safetyAttributes","categories"]);t!=null&&v(e,["categories"],t);const n=g(s,["safetyAttributes","scores"]);n!=null&&v(e,["scores"],n);const i=g(s,["contentType"]);return i!=null&&v(e,["contentType"],i),e}function ck(s){const e={},t=g(s,["safetyAttributes","categories"]);t!=null&&v(e,["categories"],t);const n=g(s,["safetyAttributes","scores"]);n!=null&&v(e,["scores"],n);const i=g(s,["contentType"]);return i!=null&&v(e,["contentType"],i),e}function Rz(s){const e={},t=g(s,["category"]);if(t!=null&&v(e,["category"],t),g(s,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=g(s,["threshold"]);return n!=null&&v(e,["threshold"],n),e}function kz(s){const e={},t=g(s,["image"]);return t!=null&&v(e,["image"],ji(t)),e}function Mz(s,e){const t={},n=g(s,["mode"]);e!==void 0&&n!=null&&v(e,["parameters","mode"],n);const i=g(s,["maxPredictions"]);e!==void 0&&i!=null&&v(e,["parameters","maxPredictions"],i);const a=g(s,["confidenceThreshold"]);e!==void 0&&a!=null&&v(e,["parameters","confidenceThreshold"],a);const l=g(s,["maskDilation"]);e!==void 0&&l!=null&&v(e,["parameters","maskDilation"],l);const c=g(s,["binaryColorThreshold"]);e!==void 0&&c!=null&&v(e,["parameters","binaryColorThreshold"],c);const d=g(s,["labels"]);return e!==void 0&&d!=null&&v(e,["labels"],d),t}function Iz(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["source"]);i!=null&&Pz(i,t);const a=g(e,["config"]);return a!=null&&Mz(a,t),t}function Dz(s){const e={},t=g(s,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>iz(i))),v(e,["generatedMasks"],n)}return e}function Pz(s,e){const t={},n=g(s,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const i=g(s,["image"]);e!==void 0&&i!=null&&v(e,["instances[0]","image"],ji(i));const a=g(s,["scribbleImage"]);return e!==void 0&&a!=null&&v(e,["instances[0]","scribble"],kz(a)),t}function Lz(s){const e={},t=g(s,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=g(s,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],Uj(n)),e}function Oz(s){const e={};if(g(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=g(s,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=g(s,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const i=g(s,["codeExecution"]);if(i!=null&&v(e,["codeExecution"],i),g(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(s,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(y=>y)),v(e,["functionDeclarations"],p)}const l=g(s,["googleMaps"]);l!=null&&v(e,["googleMaps"],uz(l));const c=g(s,["googleSearch"]);c!=null&&v(e,["googleSearch"],dz(c));const d=g(s,["googleSearchRetrieval"]);d!=null&&v(e,["googleSearchRetrieval"],d);const h=g(s,["urlContext"]);return h!=null&&v(e,["urlContext"],h),e}function uk(s){const e={},t=g(s,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=g(s,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),g(s,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=g(s,["codeExecution"]);i!=null&&v(e,["codeExecution"],i);const a=g(s,["enterpriseWebSearch"]);a!=null&&v(e,["enterpriseWebSearch"],a);const l=g(s,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(_=>Fj(_))),v(e,["functionDeclarations"],y)}const c=g(s,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const d=g(s,["googleSearch"]);d!=null&&v(e,["googleSearch"],d);const h=g(s,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const p=g(s,["urlContext"]);return p!=null&&v(e,["urlContext"],p),e}function Uz(s){const e={},t=g(s,["baseModel"]);t!=null&&v(e,["baseModel"],t);const n=g(s,["createTime"]);n!=null&&v(e,["createTime"],n);const i=g(s,["updateTime"]);return i!=null&&v(e,["updateTime"],i),e}function Fz(s){const e={},t=g(s,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&v(e,["baseModel"],t);const n=g(s,["createTime"]);n!=null&&v(e,["createTime"],n);const i=g(s,["updateTime"]);return i!=null&&v(e,["updateTime"],i),e}function jz(s,e){const t={},n=g(s,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const i=g(s,["description"]);e!==void 0&&i!=null&&v(e,["description"],i);const a=g(s,["defaultCheckpointId"]);return e!==void 0&&a!=null&&v(e,["defaultCheckpointId"],a),t}function zz(s,e){const t={},n=g(s,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const i=g(s,["description"]);e!==void 0&&i!=null&&v(e,["description"],i);const a=g(s,["defaultCheckpointId"]);return e!==void 0&&a!=null&&v(e,["defaultCheckpointId"],a),t}function Hz(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","name"],it(s,n));const i=g(e,["config"]);return i!=null&&jz(i,t),t}function Bz(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["config"]);return i!=null&&zz(i,t),t}function Gz(s,e){const t={},n=g(s,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const i=g(s,["safetyFilterLevel"]);e!==void 0&&i!=null&&v(e,["parameters","safetySetting"],i);const a=g(s,["personGeneration"]);e!==void 0&&a!=null&&v(e,["parameters","personGeneration"],a);const l=g(s,["includeRaiReason"]);e!==void 0&&l!=null&&v(e,["parameters","includeRaiReason"],l);const c=g(s,["outputMimeType"]);e!==void 0&&c!=null&&v(e,["parameters","outputOptions","mimeType"],c);const d=g(s,["outputCompressionQuality"]);e!==void 0&&d!=null&&v(e,["parameters","outputOptions","compressionQuality"],d);const h=g(s,["enhanceInputImage"]);e!==void 0&&h!=null&&v(e,["parameters","upscaleConfig","enhanceInputImage"],h);const p=g(s,["imagePreservationFactor"]);e!==void 0&&p!=null&&v(e,["parameters","upscaleConfig","imagePreservationFactor"],p);const y=g(s,["labels"]);e!==void 0&&y!=null&&v(e,["labels"],y);const _=g(s,["numberOfImages"]);e!==void 0&&_!=null&&v(e,["parameters","sampleCount"],_);const S=g(s,["mode"]);return e!==void 0&&S!=null&&v(e,["parameters","mode"],S),t}function qz(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["_url","model"],it(s,n));const i=g(e,["image"]);i!=null&&v(t,["instances[0]","image"],ji(i));const a=g(e,["upscaleFactor"]);a!=null&&v(t,["parameters","upscaleConfig","upscaleFactor"],a);const l=g(e,["config"]);return l!=null&&Gz(l,t),t}function Vz(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>dv(a))),v(e,["generatedImages"],i)}return e}function $z(s){const e={},t=g(s,["uri"]);t!=null&&v(e,["uri"],t);const n=g(s,["encodedVideo"]);n!=null&&v(e,["videoBytes"],ko(n));const i=g(s,["encoding"]);return i!=null&&v(e,["mimeType"],i),e}function Yz(s){const e={},t=g(s,["gcsUri"]);t!=null&&v(e,["uri"],t);const n=g(s,["bytesBase64Encoded"]);n!=null&&v(e,["videoBytes"],ko(n));const i=g(s,["mimeType"]);return i!=null&&v(e,["mimeType"],i),e}function Kz(s){const e={},t=g(s,["image"]);t!=null&&v(e,["_self"],ji(t));const n=g(s,["maskMode"]);return n!=null&&v(e,["maskMode"],n),e}function Xz(s){const e={},t=g(s,["image"]);t!=null&&v(e,["image"],hv(t));const n=g(s,["referenceType"]);return n!=null&&v(e,["referenceType"],n),e}function Jz(s){const e={},t=g(s,["image"]);t!=null&&v(e,["image"],ji(t));const n=g(s,["referenceType"]);return n!=null&&v(e,["referenceType"],n),e}function dk(s){const e={},t=g(s,["uri"]);t!=null&&v(e,["uri"],t);const n=g(s,["videoBytes"]);n!=null&&v(e,["encodedVideo"],ko(n));const i=g(s,["mimeType"]);return i!=null&&v(e,["encoding"],i),e}function hk(s){const e={},t=g(s,["uri"]);t!=null&&v(e,["gcsUri"],t);const n=g(s,["videoBytes"]);n!=null&&v(e,["bytesBase64Encoded"],ko(n));const i=g(s,["mimeType"]);return i!=null&&v(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wz(s,e){const t={},n=g(s,["displayName"]);return e!==void 0&&n!=null&&v(e,["displayName"],n),t}function Qz(s){const e={},t=g(s,["config"]);return t!=null&&Wz(t,e),e}function Zz(s,e){const t={},n=g(s,["force"]);return e!==void 0&&n!=null&&v(e,["_query","force"],n),t}function eH(s){const e={},t=g(s,["name"]);t!=null&&v(e,["_url","name"],t);const n=g(s,["config"]);return n!=null&&Zz(n,e),e}function tH(s){const e={},t=g(s,["name"]);return t!=null&&v(e,["_url","name"],t),e}function nH(s,e){const t={},n=g(s,["customMetadata"]);if(e!==void 0&&n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>l)),v(e,["customMetadata"],a)}const i=g(s,["chunkingConfig"]);return e!==void 0&&i!=null&&v(e,["chunkingConfig"],i),t}function sH(s){const e={},t=g(s,["name"]);t!=null&&v(e,["name"],t);const n=g(s,["metadata"]);n!=null&&v(e,["metadata"],n);const i=g(s,["done"]);i!=null&&v(e,["done"],i);const a=g(s,["error"]);a!=null&&v(e,["error"],a);const l=g(s,["response"]);return l!=null&&v(e,["response"],rH(l)),e}function iH(s){const e={},t=g(s,["fileSearchStoreName"]);t!=null&&v(e,["_url","file_search_store_name"],t);const n=g(s,["fileName"]);n!=null&&v(e,["fileName"],n);const i=g(s,["config"]);return i!=null&&nH(i,e),e}function rH(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["parent"]);n!=null&&v(e,["parent"],n);const i=g(s,["documentName"]);return i!=null&&v(e,["documentName"],i),e}function aH(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);return e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),t}function oH(s){const e={},t=g(s,["config"]);return t!=null&&aH(t,e),e}function lH(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=g(s,["fileSearchStores"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),v(e,["fileSearchStores"],a)}return e}function fk(s,e){const t={},n=g(s,["mimeType"]);e!==void 0&&n!=null&&v(e,["mimeType"],n);const i=g(s,["displayName"]);e!==void 0&&i!=null&&v(e,["displayName"],i);const a=g(s,["customMetadata"]);if(e!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>d)),v(e,["customMetadata"],c)}const l=g(s,["chunkingConfig"]);return e!==void 0&&l!=null&&v(e,["chunkingConfig"],l),t}function cH(s){const e={},t=g(s,["fileSearchStoreName"]);t!=null&&v(e,["_url","file_search_store_name"],t);const n=g(s,["config"]);return n!=null&&fk(n,e),e}function uH(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dH="Content-Type",hH="X-Server-Timeout",fH="User-Agent",qx="x-goog-api-client",pH="1.35.0",mH=`google-genai-sdk/${pH}`,gH="v1beta1",vH="v1beta";class yH{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:gH,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:vH,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const i=[this.getRequestUrlInternal(t)];return n&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))i.searchParams.append(l,String(c));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,i.toString(),e.abortSignal),this.unaryApiCall(i,a,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[i,a]of Object.entries(t))typeof a=="object"?n[i]=Object.assign(Object.assign({},n[i]),a):a!==void 0&&(n[i]=a);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,i.toString(),e.abortSignal),this.streamApiCall(i,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,i){if(t&&t.timeout||i){const a=new AbortController,l=a.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const c=setTimeout(()=>a.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}i&&i.addEventListener("abort",()=>{a.abort()}),e.signal=l}return t&&t.extraBody!==null&&bH(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await JC(i),new jx(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await JC(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return Li(this,arguments,function*(){var n;const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),a=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let l="";const c="data:",d=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:h,value:p}=yield Oe(i.read());if(h){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const y=a.decode(p,{stream:!0});try{const A=JSON.parse(y);if("error"in A){const E=JSON.parse(JSON.stringify(A.error)),N=E.status,R=E.code,D=`got status: ${N}. ${JSON.stringify(A)}`;if(R>=400&&R<600)throw new cv({message:D,status:R})}}catch(A){if(A.name==="ApiError")throw A}l+=y;let _=-1,S=0;for(;;){_=-1,S=0;for(const N of d){const R=l.indexOf(N);R!==-1&&(_===-1||R<_)&&(_=R,S=N.length)}if(_===-1)break;const A=l.substring(0,_);l=l.substring(_+S);const E=A.trim();if(E.startsWith(c)){const N=E.substring(c.length).trim();try{const R=new Response(N,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Oe(new jx(R))}catch(R){throw new Error(`exception parsing stream chunk ${N}. ${R}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=mH+" "+this.clientOptions.userAgentExtra;return e[fH]=t,e[qx]=t,e[dH]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[i,a]of Object.entries(e.headers))n.append(i,a);e.timeout&&e.timeout>0&&n.append(hH,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return typeof e=="string"&&(n=e.replace(/[/\\]+$/,""),n=(t=n.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),n}async uploadFile(e,t){var n;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const a=this.clientOptions.uploader,l=await a.stat(e);i.sizeBytes=String(l.size);const c=(n=t==null?void 0:t.mimeType)!==null&&n!==void 0?n:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=c;const d={file:i},h=this.getFileName(e),p=ue("upload/v1beta/files",d._url),y=await this.fetchUploadUrl(p,i.sizeBytes,i.mimeType,h,d,t==null?void 0:t.httpOptions);return a.upload(e,y,this)}async uploadFileToFileSearchStore(e,t,n){var i;const a=this.clientOptions.uploader,l=await a.stat(t),c=String(l.size),d=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const h=`upload/v1beta/${e}:uploadToFileSearchStore`,p=this.getFileName(t),y={};n!=null&&fk(n,y);const _=await this.fetchUploadUrl(h,c,d,p,y,n==null?void 0:n.httpOptions);return a.uploadToFileSearchStore(t,_,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,n,i,a,l){var c;let d={};l?d=l:d={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},i?{"X-Goog-Upload-File-Name":i}:{})};const h=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:d});if(!h||!(h!=null&&h.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const p=(c=h==null?void 0:h.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(p===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return p}}async function JC(s){var e;if(s===void 0)throw new Error("response is undefined");if(!s.ok){const t=s.status;let n;!((e=s.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?n=await s.json():n={error:{message:await s.text(),code:s.status,status:s.statusText}};const i=JSON.stringify(n);throw t>=400&&t<600?new cv({message:i,status:t}):new Error(i)}}function bH(s,e){if(!e||Object.keys(e).length===0)return;if(s.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof s.body=="string"&&s.body.length>0)try{const a=JSON.parse(s.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(a,l){const c=Object.assign({},a);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const h=l[d],p=c[d];h&&typeof h=="object"&&!Array.isArray(h)&&p&&typeof p=="object"&&!Array.isArray(p)?c[d]=n(p,h):(p&&h&&typeof p!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof p}, New type: ${typeof h}. Overwriting.`),c[d]=h)}return c}const i=n(t,e);s.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _H="mcp_used/unknown";let xH=!1;function pk(s){for(const e of s)if(wH(e)||typeof e=="object"&&"inputSchema"in e)return!0;return xH}function mk(s){var e;const t=(e=s[qx])!==null&&e!==void 0?e:"";s[qx]=(t+` ${_H}`).trimStart()}function wH(s){return s!==null&&typeof s=="object"&&s instanceof Ew}function SH(s){return Li(this,arguments,function*(t,n=100){let i,a=0;for(;a<n;){const l=yield Oe(t.listTools({cursor:i}));for(const c of l.tools)yield yield Oe(c),a++;if(!l.nextCursor)break;i=l.nextCursor}})}class Ew{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Ew(e,t)}async initialize(){var e,t,n,i;if(this.mcpTools.length>0)return;const a={},l=[];for(const p of this.mcpClients)try{for(var c=!0,d=(t=void 0,Oi(SH(p))),h;h=await d.next(),e=h.done,!e;c=!0){i=h.value,c=!1;const y=i;l.push(y);const _=y.name;if(a[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);a[_]=p}}catch(y){t={error:y}}finally{try{!c&&!e&&(n=d.return)&&await n.call(d)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),tF(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[n.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const l=await i.callTool({name:n.name,arguments:n.args},void 0,a);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function AH(s,e,t){const n=new Y3;let i;t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),Object.assign(n,i),e(n)}class EH{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=NH(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),d=`${i}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${c}`;let h=()=>{};const p=new Promise(P=>{h=P}),y=e.callbacks,_=function(){h({})},S=this.apiClient,A={onopen:_,onmessage:P=>{AH(S,y.onmessage,P)},onerror:(t=y==null?void 0:y.onerror)!==null&&t!==void 0?t:function(P){},onclose:(n=y==null?void 0:y.onclose)!==null&&n!==void 0?n:function(P){}},E=this.webSocketFactory.create(d,CH(l),A);E.connect(),await p;const D={setup:{model:it(this.apiClient,e.model)}};return E.send(JSON.stringify(D)),new TH(E,this.apiClient)}}class TH{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=Q6(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=W6(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(wu.PLAY)}pause(){this.sendPlaybackControl(wu.PAUSE)}stop(){this.sendPlaybackControl(wu.STOP)}resetContext(){this.sendPlaybackControl(wu.RESET_CONTEXT)}close(){this.conn.close()}}function CH(s){const e={};return s.forEach((t,n)=>{e[n]=t}),e}function NH(s){const e=new Headers;for(const[t,n]of Object.entries(s))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const RH="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function kH(s,e,t){const n=new $3;let i;t.data instanceof Blob?i=await t.data.text():t.data instanceof ArrayBuffer?i=new TextDecoder().decode(t.data):i=t.data;const a=JSON.parse(i);if(s.isVertexAI()){const l=tj(a);Object.assign(n,l)}else Object.assign(n,a);e(n)}class MH{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new EH(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,i,a,l,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let p;const y=this.apiClient.getHeaders();e.config&&e.config.tools&&pk(e.config.tools)&&mk(y);const _=LH(y);if(this.apiClient.isVertexAI())p=`${d}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_,p);else{const Y=this.apiClient.getApiKey();let J="BidiGenerateContent",ie="key";Y!=null&&Y.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),J="BidiGenerateContentConstrained",ie="access_token"),p=`${d}/ws/google.ai.generativelanguage.${h}.GenerativeService.${J}?${ie}=${Y}`}let S=()=>{};const A=new Promise(Y=>{S=Y}),E=e.callbacks,N=function(){var Y;(Y=E==null?void 0:E.onopen)===null||Y===void 0||Y.call(E),S({})},R=this.apiClient,D={onopen:N,onmessage:Y=>{kH(R,E.onmessage,Y)},onerror:(t=E==null?void 0:E.onerror)!==null&&t!==void 0?t:function(Y){},onclose:(n=E==null?void 0:E.onclose)!==null&&n!==void 0?n:function(Y){}},P=this.webSocketFactory.create(p,PH(_),D);P.connect(),await A;let L=it(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&L.startsWith("publishers/")){const Y=this.apiClient.getProject(),J=this.apiClient.getLocation();L=`projects/${Y}/locations/${J}/`+L}let z={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[T0.AUDIO]}:e.config.responseModalities=[T0.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const H=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],F=[];for(const Y of H)if(this.isCallableTool(Y)){const J=Y;F.push(await J.tool())}else F.push(Y);F.length>0&&(e.config.tools=F);const X={model:L,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?z=J6(this.apiClient,X):z=X6(this.apiClient,X),delete z.config,P.send(JSON.stringify(z)),new DH(P,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const IH={turnComplete:!0};class DH{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=ui(t.turns),e.isVertexAI()||(n=n.map(i=>uv(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const a of n){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(RH)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},IH),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:ej(e)}:t={realtimeInput:Z6(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function PH(s){const e={};return s.forEach((t,n)=>{e[n]=t}),e}function LH(s){const e=new Headers;for(const[t,n]of Object.entries(s))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WC=10;function QC(s){var e,t,n;if(!((e=s==null?void 0:s.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const l of(t=s==null?void 0:s.tools)!==null&&t!==void 0?t:[])if(Mu(l)){i=!0;break}if(!i)return!0;const a=(n=s==null?void 0:s.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function Mu(s){return"callTool"in s&&typeof s.callTool=="function"}function OH(s){var e,t,n;return(n=(t=(e=s.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>Mu(i)))!==null&&n!==void 0?n:!1}function ZC(s){var e;const t=[];return!((e=s==null?void 0:s.config)===null||e===void 0)&&e.tools&&s.config.tools.forEach((n,i)=>{if(Mu(n))return;const a=n;a.functionDeclarations&&a.functionDeclarations.length>0&&t.push(i)}),t}function eN(s){var e;return!(!((e=s==null?void 0:s.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UH extends ga{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,i,a,l,c;const d=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!OH(t)||QC(t.config))return await this.generateContentInternal(d);const h=ZC(t);if(h.length>0){const E=h.map(N=>`tools[${N}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${E}.`)}let p,y;const _=ui(d.contents),S=(a=(i=(n=d.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&a!==void 0?a:WC;let A=0;for(;A<S&&(p=await this.generateContentInternal(d),!(!p.functionCalls||p.functionCalls.length===0));){const E=p.candidates[0].content,N=[];for(const R of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(Mu(R)){const P=await R.callTool(p.functionCalls);N.push(...P)}A++,y={role:"user",parts:N},d.contents=ui(d.contents),d.contents.push(E),d.contents.push(y),eN(d.config)&&(_.push(E),_.push(y))}return eN(d.config)&&(p.automaticFunctionCallingHistory=_),p},this.generateContentStream=async t=>{var n,i,a,l,c;if(this.maybeMoveToResponseJsonSchem(t),QC(t.config)){const y=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(y)}const d=ZC(t);if(d.length>0){const y=d.map(_=>`tools[${_}]`).join(", ");throw new Error(`Incompatible tools found at ${y}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const h=(a=(i=(n=t==null?void 0:t.config)===null||n===void 0?void 0:n.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,p=(c=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(h&&!p)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var i;let a;const l=[];if(n!=null&&n.generatedImages)for(const d of n.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((i=d==null?void 0:d.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?a=d==null?void 0:d.safetyAttributes:l.push(d);let c;return a?c={generatedImages:l,positivePromptSafetyAttributes:a,sdkHttpResponse:n.sdkHttpResponse}:c={generatedImages:l,sdkHttpResponse:n.sdkHttpResponse},c}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new yc(ha.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(i)},this.generateVideos=async t=>{var n,i,a,l,c,d;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=t.video)===null||n===void 0)&&n.uri&&(!((i=t.video)===null||i===void 0)&&i.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(a=t.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.uri&&(!((d=(c=t.source)===null||c===void 0?void 0:c.video)===null||d===void 0)&&d.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,i;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const l=await Promise.all(a.map(async d=>Mu(d)?await d.tool():d)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&pk(e.config.tools)){const d=(i=(n=e.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&i!==void 0?i:{};let h=Object.assign({},d);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),mk(h),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:h})}return c}async initAfcToolsMap(e){var t,n,i;const a=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(Mu(l)){const c=l,d=await c.tool();for(const h of(i=d.functionDeclarations)!==null&&i!==void 0?i:[]){if(!h.name)throw new Error("Function declaration name is required.");if(a.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);a.set(h.name,c)}}return a}async processAfcStream(e){var t,n,i;const a=(i=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&i!==void 0?i:WC;let l=!1,c=0;const d=await this.initAfcToolsMap(e);return(function(h,p,y){return Li(this,arguments,function*(){for(var _,S,A,E,N,R;c<a;){l&&(c++,l=!1);const z=yield Oe(h.processParamsMaybeAddMcpUsage(y)),H=yield Oe(h.generateContentStreamInternal(z)),F=[],X=[];try{for(var D=!0,P=(S=void 0,Oi(H)),L;L=yield Oe(P.next()),_=L.done,!_;D=!0){E=L.value,D=!1;const Y=E;if(yield yield Oe(Y),Y.candidates&&(!((N=Y.candidates[0])===null||N===void 0)&&N.content)){X.push(Y.candidates[0].content);for(const J of(R=Y.candidates[0].content.parts)!==null&&R!==void 0?R:[])if(c<a&&J.functionCall){if(!J.functionCall.name)throw new Error("Function call name was not returned by the model.");if(p.has(J.functionCall.name)){const ie=yield Oe(p.get(J.functionCall.name).callTool([J.functionCall]));F.push(...ie)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${p.keys()}, mising tool: ${J.functionCall.name}`)}}}}catch(Y){S={error:Y}}finally{try{!D&&!_&&(A=P.return)&&(yield Oe(A.call(P)))}finally{if(S)throw S.error}}if(F.length>0){l=!0;const Y=new Vh;Y.candidates=[{content:{role:"user",parts:F}}],yield yield Oe(Y);const J=[];J.push(...X),J.push({role:"user",parts:F});const ie=ui(y.contents).concat(J);y.contents=ie}else break}})})(this,d,e)}async generateContentInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=YC(this.apiClient,e);return c=ue("{model}:generateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=XC(p),_=new Vh;return Object.assign(_,y),_})}else{const h=$C(this.apiClient,e);return c=ue("{model}:generateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=KC(p),_=new Vh;return Object.assign(_,y),_})}}async generateContentStreamInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=YC(this.apiClient,e);return c=ue("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(y){return Li(this,arguments,function*(){var _,S,A,E;try{for(var N=!0,R=Oi(y),D;D=yield Oe(R.next()),_=D.done,!_;N=!0){E=D.value,N=!1;const P=E,L=XC(yield Oe(P.json()));L.sdkHttpResponse={headers:P.headers};const z=new Vh;Object.assign(z,L),yield yield Oe(z)}}catch(P){S={error:P}}finally{try{!N&&!_&&(A=R.return)&&(yield Oe(A.call(R)))}finally{if(S)throw S.error}}})})}else{const h=$C(this.apiClient,e);return c=ue("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(y){return Li(this,arguments,function*(){var _,S,A,E;try{for(var N=!0,R=Oi(y),D;D=yield Oe(R.next()),_=D.done,!_;N=!0){E=D.value,N=!1;const P=E,L=KC(yield Oe(P.json()));L.sdkHttpResponse={headers:P.headers};const z=new Vh;Object.assign(z,L),yield yield Oe(z)}}catch(P){S={error:P}}finally{try{!N&&!_&&(A=R.return)&&(yield Oe(A.call(R)))}finally{if(S)throw S.error}}})})}}async embedContent(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=Mj(this.apiClient,e);return c=ue("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=Dj(p),_=new RC;return Object.assign(_,y),_})}else{const h=kj(this.apiClient,e);return c=ue("{model}:batchEmbedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=Ij(p),_=new RC;return Object.assign(_,y),_})}}async generateImagesInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=qj(this.apiClient,e);return c=ue("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=$j(p),_=new kC;return Object.assign(_,y),_})}else{const h=Gj(this.apiClient,e);return c=ue("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=Vj(p),_=new kC;return Object.assign(_,y),_})}}async editImageInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=Tj(this.apiClient,e);return a=ue("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const h=Cj(d),p=new L3;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=qz(this.apiClient,e);return a=ue("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const h=Vz(d),p=new O3;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=Ez(this.apiClient,e);return a=ue("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=Tz(d),p=new U3;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=Iz(this.apiClient,e);return a=ue("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=Dz(d),p=new F3;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=cz(this.apiClient,e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>Gx(p))}else{const h=lz(this.apiClient,e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>Bx(p))}}async listInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=yz(this.apiClient,e);return c=ue("{models_url}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=_z(p),_=new MC;return Object.assign(_,y),_})}else{const h=vz(this.apiClient,e);return c=ue("{models_url}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=bz(p),_=new MC;return Object.assign(_,y),_})}}async update(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=Bz(this.apiClient,e);return c=ue("{model}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>Gx(p))}else{const h=Hz(this.apiClient,e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>Bx(p))}}async delete(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=wj(this.apiClient,e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=Aj(p),_=new IC;return Object.assign(_,y),_})}else{const h=xj(this.apiClient,e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=Sj(p),_=new IC;return Object.assign(_,y),_})}}async countTokens(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=yj(this.apiClient,e);return c=ue("{model}:countTokens",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=_j(p),_=new DC;return Object.assign(_,y),_})}else{const h=vj(this.apiClient,e);return c=ue("{model}:countTokens",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=bj(p),_=new DC;return Object.assign(_,y),_})}}async computeTokens(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=uj(this.apiClient,e);return a=ue("{model}:computeTokens",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const h=dj(d),p=new j3;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=Qj(this.apiClient,e);return c=ue("{model}:predictLongRunning",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>{const y=Jj(p),_=new C0;return Object.assign(_,y),_})}else{const h=Wj(this.apiClient,e);return c=ue("{model}:predictLongRunning",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>{const y=Xj(p),_=new C0;return Object.assign(_,y),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FH extends ga{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let a;n&&"httpOptions"in n&&(a=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let a;n&&"httpOptions"in n&&(a=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=R3(e);return c=ue("{operationName}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l}else{const h=N3(e);return c=ue("{operationName}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l}}async fetchPredictVideosOperationInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=x3(e);return a=ue("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jH(s){const e={},t=g(s,["data"]);if(t!=null&&v(e,["data"],t),g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function zH(s){const e={},t=g(s,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>XH(a))),v(e,["parts"],i)}const n=g(s,["role"]);return n!=null&&v(e,["role"],n),e}function HH(s,e,t){const n={},i=g(e,["expireTime"]);t!==void 0&&i!=null&&v(t,["expireTime"],i);const a=g(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&v(t,["newSessionExpireTime"],a);const l=g(e,["uses"]);t!==void 0&&l!=null&&v(t,["uses"],l);const c=g(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&v(t,["bidiGenerateContentSetup"],KH(s,c));const d=g(e,["lockAdditionalFields"]);return t!==void 0&&d!=null&&v(t,["fieldMask"],d),n}function BH(s,e){const t={},n=g(e,["config"]);return n!=null&&v(t,["config"],HH(s,n,t)),t}function GH(s){const e={};if(g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(s,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=g(s,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function qH(s){const e={},t=g(s,["id"]);t!=null&&v(e,["id"],t);const n=g(s,["args"]);n!=null&&v(e,["args"],n);const i=g(s,["name"]);if(i!=null&&v(e,["name"],i),g(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function VH(s){const e={};if(g(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(s,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function $H(s){const e={};if(g(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(s,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function YH(s,e){const t={},n=g(s,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],n);const i=g(s,["responseModalities"]);e!==void 0&&i!=null&&v(e,["setup","generationConfig","responseModalities"],i);const a=g(s,["temperature"]);e!==void 0&&a!=null&&v(e,["setup","generationConfig","temperature"],a);const l=g(s,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=g(s,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const d=g(s,["maxOutputTokens"]);e!==void 0&&d!=null&&v(e,["setup","generationConfig","maxOutputTokens"],d);const h=g(s,["mediaResolution"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","mediaResolution"],h);const p=g(s,["seed"]);e!==void 0&&p!=null&&v(e,["setup","generationConfig","seed"],p);const y=g(s,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],Aw(y));const _=g(s,["thinkingConfig"]);e!==void 0&&_!=null&&v(e,["setup","generationConfig","thinkingConfig"],_);const S=g(s,["enableAffectiveDialog"]);e!==void 0&&S!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],S);const A=g(s,["systemInstruction"]);e!==void 0&&A!=null&&v(e,["setup","systemInstruction"],zH(Fn(A)));const E=g(s,["tools"]);if(e!==void 0&&E!=null){let H=jd(E);Array.isArray(H)&&(H=H.map(F=>WH(Fd(F)))),v(e,["setup","tools"],H)}const N=g(s,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],JH(N));const R=g(s,["inputAudioTranscription"]);e!==void 0&&R!=null&&v(e,["setup","inputAudioTranscription"],R);const D=g(s,["outputAudioTranscription"]);e!==void 0&&D!=null&&v(e,["setup","outputAudioTranscription"],D);const P=g(s,["realtimeInputConfig"]);e!==void 0&&P!=null&&v(e,["setup","realtimeInputConfig"],P);const L=g(s,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const z=g(s,["proactivity"]);if(e!==void 0&&z!=null&&v(e,["setup","proactivity"],z),g(s,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function KH(s,e){const t={},n=g(e,["model"]);n!=null&&v(t,["setup","model"],it(s,n));const i=g(e,["config"]);return i!=null&&v(t,["config"],YH(i,t)),t}function XH(s){const e={},t=g(s,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=g(s,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const i=g(s,["executableCode"]);i!=null&&v(e,["executableCode"],i);const a=g(s,["fileData"]);a!=null&&v(e,["fileData"],GH(a));const l=g(s,["functionCall"]);l!=null&&v(e,["functionCall"],qH(l));const c=g(s,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const d=g(s,["inlineData"]);d!=null&&v(e,["inlineData"],jH(d));const h=g(s,["text"]);h!=null&&v(e,["text"],h);const p=g(s,["thought"]);p!=null&&v(e,["thought"],p);const y=g(s,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const _=g(s,["videoMetadata"]);return _!=null&&v(e,["videoMetadata"],_),e}function JH(s){const e={},t=g(s,["handle"]);if(t!=null&&v(e,["handle"],t),g(s,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function WH(s){const e={};if(g(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=g(s,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=g(s,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const i=g(s,["codeExecution"]);if(i!=null&&v(e,["codeExecution"],i),g(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(s,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(y=>y)),v(e,["functionDeclarations"],p)}const l=g(s,["googleMaps"]);l!=null&&v(e,["googleMaps"],VH(l));const c=g(s,["googleSearch"]);c!=null&&v(e,["googleSearch"],$H(c));const d=g(s,["googleSearchRetrieval"]);d!=null&&v(e,["googleSearchRetrieval"],d);const h=g(s,["urlContext"]);return h!=null&&v(e,["urlContext"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QH(s){const e=[];for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)){const n=s[t];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const i=Object.keys(n).map(a=>`${t}.${a}`);e.push(...i)}else e.push(t)}return e.join(",")}function ZH(s,e){let t=null;const n=s.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const a=n.setup;typeof a=="object"&&a!==null?(s.bidiGenerateContentSetup=a,t=a):delete s.bidiGenerateContentSetup}else n!==void 0&&delete s.bidiGenerateContentSetup;const i=s.fieldMask;if(t){const a=QH(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?s.fieldMask=a:delete s.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];i.length>0&&(c=i.map(h=>l.includes(h)?`generationConfig.${h}`:h));const d=[];a&&d.push(a),c.length>0&&d.push(...c),d.length>0?s.fieldMask=d.join(","):delete s.fieldMask}else delete s.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?s.fieldMask=i.join(","):delete s.fieldMask;return s}class eB extends ga{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=BH(this.apiClient,e);a=ue("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const d=ZH(c,e.config);return i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>h)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tB(s,e){const t={},n=g(s,["force"]);return e!==void 0&&n!=null&&v(e,["_query","force"],n),t}function nB(s){const e={},t=g(s,["name"]);t!=null&&v(e,["_url","name"],t);const n=g(s,["config"]);return n!=null&&tB(n,e),e}function sB(s){const e={},t=g(s,["name"]);return t!=null&&v(e,["_url","name"],t),e}function iB(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);return e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),t}function rB(s){const e={},t=g(s,["parent"]);t!=null&&v(e,["_url","parent"],t);const n=g(s,["config"]);return n!=null&&iB(n,e),e}function aB(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=g(s,["documents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),v(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oB extends ga{constructor(e){super(),this.apiClient=e,this.list=async t=>new yc(ha.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:t.parent,config:n.config}),await this.listInternal(t),t)}async get(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=sB(e);return a=ue("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var t,n;let i="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=nB(e);i=ue("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=rB(e);return a=ue("{parent}/documents",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=aB(d),p=new z3;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lB extends ga{constructor(e,t=new oB(e)){super(),this.apiClient=e,this.documents=t,this.list=async(n={})=>new yc(ha.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(n),n)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Qz(e);return a=ue("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async get(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=tH(e);return a=ue("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var t,n;let i="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=eH(e);i=ue("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=oH(e);return a=ue("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=lH(d),p=new H3;return Object.assign(p,h),p})}}async uploadToFileSearchStoreInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=cH(e);return a=ue("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=uH(d),p=new B3;return Object.assign(p,h),p})}}async importFile(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=iH(e);return a=ue("{file_search_store_name}:importFile",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=sH(d),p=new bw;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let gk=function(){const{crypto:s}=globalThis;if(s!=null&&s.randomUUID)return gk=s.randomUUID.bind(s),s.randomUUID();const e=new Uint8Array(1),t=s?()=>s.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))};const cB=()=>gk();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vx(s){return typeof s=="object"&&s!==null&&("name"in s&&s.name==="AbortError"||"message"in s&&String(s.message).includes("FetchRequestCanceledException"))}const $x=s=>{if(s instanceof Error)return s;if(typeof s=="object"&&s!==null){try{if(Object.prototype.toString.call(s)==="[object Error]"){const e=new Error(s.message,s.cause?{cause:s.cause}:{});return s.stack&&(e.stack=s.stack),s.cause&&!e.cause&&(e.cause=s.cause),s.name&&(e.name=s.name),e}}catch{}try{return new Error(JSON.stringify(s))}catch{}}return new Error(s)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hi extends Error{}class Qn extends hi{constructor(e,t,n,i){super(`${Qn.makeMessage(e,t,n)}`),this.status=e,this.headers=i,this.error=t}static makeMessage(e,t,n){const i=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,n,i){if(!e||!i)return new fv({message:n,cause:$x(t)});const a=t;return e===400?new yk(e,a,n,i):e===401?new bk(e,a,n,i):e===403?new _k(e,a,n,i):e===404?new xk(e,a,n,i):e===409?new wk(e,a,n,i):e===422?new Sk(e,a,n,i):e===429?new Ak(e,a,n,i):e>=500?new Ek(e,a,n,i):new Qn(e,a,n,i)}}class Yx extends Qn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class fv extends Qn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class vk extends fv{constructor({message:e}={}){super({message:e??"Request timed out."})}}class yk extends Qn{}class bk extends Qn{}class _k extends Qn{}class xk extends Qn{}class wk extends Qn{}class Sk extends Qn{}class Ak extends Qn{}class Ek extends Qn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const uB=/^[a-z][a-z0-9+.-]*:/i,dB=s=>uB.test(s);let Kx=s=>(Kx=Array.isArray,Kx(s));const hB=Kx;let fB=hB;const tN=fB;function pB(s){if(!s)return!0;for(const e in s)return!1;return!0}function mB(s,e){return Object.prototype.hasOwnProperty.call(s,e)}const gB=(s,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new hi(`${s} must be an integer`);if(e<0)throw new hi(`${s} must be a positive integer`);return e},vB=s=>{try{return JSON.parse(s)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yB=s=>new Promise(e=>setTimeout(e,s));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _u="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bB(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const _B=()=>{var s,e,t,n,i;const a=bB();if(a==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_u,"X-Stainless-OS":sN(Deno.build.os),"X-Stainless-Arch":nN(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(s=Deno.version)===null||s===void 0?void 0:s.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_u,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(a==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_u,"X-Stainless-OS":sN((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":nN((n=globalThis.process.arch)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const l=xB();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_u,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_u,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function xB(){if(typeof navigator>"u"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of s){const n=t.exec(navigator.userAgent);if(n){const i=n[1]||0,a=n[2]||0,l=n[3]||0;return{browser:e,version:`${i}.${a}.${l}`}}}return null}const nN=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",sN=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let Rg;const wB=()=>Rg??(Rg=_B());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SB(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Tk(...s){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...s)}function AB(s){let e=Symbol.asyncIterator in s?s[Symbol.asyncIterator]():s[Symbol.iterator]();return Tk({start(){},async pull(t){const{done:n,value:i}=await e.next();n?t.close():t.enqueue(i)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function Ck(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function EB(s){var e,t;if(s===null||typeof s!="object")return;if(s[Symbol.asyncIterator]){await((t=(e=s[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const n=s.getReader(),i=n.cancel();n.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const TB=({headers:s,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Nk=()=>{var s;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((s=e==null?void 0:e.versions)===null||s===void 0?void 0:s.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function r_(s,e,t){return Nk(),new File(s,e??"unknown_file",t)}function CB(s){return(typeof s=="object"&&s!==null&&("name"in s&&s.name&&String(s.name)||"url"in s&&s.url&&String(s.url)||"filename"in s&&s.filename&&String(s.filename)||"path"in s&&s.path&&String(s.path))||"").split(/[\\/]/).pop()||void 0}const NB=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Rk=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",RB=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&Rk(s),kB=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function";async function MB(s,e,t){if(Nk(),s=await s,RB(s))return s instanceof File?s:r_([await s.arrayBuffer()],s.name);if(kB(s)){const i=await s.blob();return e||(e=new URL(s.url).pathname.split(/[\\/]/).pop()),r_(await Xx(i),e,t)}const n=await Xx(s);if(e||(e=CB(s)),!(t!=null&&t.type)){const i=n.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof i=="string"&&(t=Object.assign(Object.assign({},t),{type:i}))}return r_(n,e,t)}async function Xx(s){var e,t,n,i,a;let l=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)l.push(s);else if(Rk(s))l.push(s instanceof Blob?s:await s.arrayBuffer());else if(NB(s))try{for(var c=!0,d=Oi(s),h;h=await d.next(),e=h.done,!e;c=!0){i=h.value,c=!1;const p=i;l.push(...await Xx(p))}}catch(p){t={error:p}}finally{try{!c&&!e&&(n=d.return)&&await n.call(d)}finally{if(t)throw t.error}}else{const p=(a=s==null?void 0:s.constructor)===null||a===void 0?void 0:a.name;throw new Error(`Unexpected data type: ${typeof s}${p?`; constructor: ${p}`:""}${IB(s)}`)}return l}function IB(s){return typeof s!="object"||s===null?"":`; props: [${Object.getOwnPropertyNames(s).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kk{constructor(e){this._client=e}}kk._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mk(s){return s.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const iN=Object.freeze(Object.create(null)),DB=(s=Mk)=>(function(t,...n){if(t.length===1)return t[0];let i=!1;const a=[],l=t.reduce((p,y,_)=>{var S,A,E;/[?#]/.test(y)&&(i=!0);const N=n[_];let R=(i?encodeURIComponent:s)(""+N);return _!==n.length&&(N==null||typeof N=="object"&&N.toString===((E=Object.getPrototypeOf((A=Object.getPrototypeOf((S=N.hasOwnProperty)!==null&&S!==void 0?S:iN))!==null&&A!==void 0?A:iN))===null||E===void 0?void 0:E.toString))&&(R=N+"",a.push({start:p.length+y.length,length:R.length,error:`Value of type ${Object.prototype.toString.call(N).slice(8,-1)} is not a valid path parameter`})),p+y+(_===n.length?"":R)},""),c=l.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=d.exec(c))!==null;)a.push({start:h.index,length:h[0].length,error:`Value "${h[0]}" can't be safely passed as a path parameter`});if(a.sort((p,y)=>p.start-y.start),a.length>0){let p=0;const y=a.reduce((_,S)=>{const A=" ".repeat(S.start-p),E="^".repeat(S.length);return p=S.start+S.length,_+A+E},"");throw new hi(`Path parameters result in path with invalid segments:
${a.map(_=>_.error).join(`
`)}
${l}
${y}`)}return l}),kg=DB(Mk);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ik extends kk{create(e,t){var n;const{api_version:i=this._client.apiVersion}=e,a=R0(e,["api_version"]);if("model"in a&&"agent_config"in a)throw new hi("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in a&&"generation_config"in a)throw new hi("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(kg`/${i}/interactions`,Object.assign(Object.assign({body:a},t),{stream:(n=e.stream)!==null&&n!==void 0?n:!1}))}delete(e,t={},n){const{api_version:i=this._client.apiVersion}=t??{};return this._client.delete(kg`/${i}/interactions/${e}`,n)}cancel(e,t={},n){const{api_version:i=this._client.apiVersion}=t??{};return this._client.post(kg`/${i}/interactions/${e}/cancel`,n)}get(e,t={},n){var i;const a=t??{},{api_version:l=this._client.apiVersion}=a,c=R0(a,["api_version"]);return this._client.get(kg`/${l}/interactions/${e}`,Object.assign(Object.assign({query:c},n),{stream:(i=t==null?void 0:t.stream)!==null&&i!==void 0?i:!1}))}}Ik._key=Object.freeze(["interactions"]);class Dk extends Ik{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PB(s){let e=0;for(const i of s)e+=i.length;const t=new Uint8Array(e);let n=0;for(const i of s)t.set(i,n),n+=i.length;return t}let Mg;function Tw(s){let e;return(Mg??(e=new globalThis.TextEncoder,Mg=e.encode.bind(e)))(s)}let Ig;function rN(s){let e;return(Ig??(e=new globalThis.TextDecoder,Ig=e.decode.bind(e)))(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pv{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Tw(e):e;this.buffer=PB([this.buffer,t]);const n=[];let i;for(;(i=LB(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){n.push(rN(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const a=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,l=rN(this.buffer.subarray(0,a));n.push(l),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode(`
`):[]}}pv.NEWLINE_CHARS=new Set([`
`,"\r"]);pv.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function LB(s,e){for(let i=e??0;i<s.length;i++){if(s[i]===10)return{preceding:i,index:i+1,carriage:!1};if(s[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function OB(s){for(let n=0;n<s.length-1;n++){if(s[n]===10&&s[n+1]===10||s[n]===13&&s[n+1]===13)return n+2;if(s[n]===13&&s[n+1]===10&&n+3<s.length&&s[n+2]===13&&s[n+3]===10)return n+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const k0={off:0,error:200,warn:300,info:400,debug:500},aN=(s,e,t)=>{if(s){if(mB(k0,s))return s;Kn(t).warn(`${e} was set to ${JSON.stringify(s)}, expected one of ${JSON.stringify(Object.keys(k0))}`)}};function hf(){}function Dg(s,e,t){return!e||k0[s]>k0[t]?hf:e[s].bind(e)}const UB={error:hf,warn:hf,info:hf,debug:hf};let oN=new WeakMap;function Kn(s){var e;const t=s.logger,n=(e=s.logLevel)!==null&&e!==void 0?e:"off";if(!t)return UB;const i=oN.get(t);if(i&&i[0]===n)return i[1];const a={error:Dg("error",t,n),warn:Dg("warn",t,n),info:Dg("info",t,n),debug:Dg("debug",t,n)};return oN.set(t,[n,a]),a}const nl=s=>(s.options&&(s.options=Object.assign({},s.options),delete s.options.headers),s.headers&&(s.headers=Object.fromEntries((s.headers instanceof Headers?[...s.headers]:Object.entries(s.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in s&&(s.retryOfRequestLogID&&(s.retryOf=s.retryOfRequestLogID),delete s.retryOfRequestLogID),s);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Su{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let i=!1;const a=n?Kn(n):console;function l(){return Li(this,arguments,function*(){var d,h,p,y;if(i)throw new hi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let _=!1;try{try{for(var S=!0,A=Oi(FB(e,t)),E;E=yield Oe(A.next()),d=E.done,!d;S=!0){y=E.value,S=!1;const N=y;if(!_)if(N.data.startsWith("[DONE]")){_=!0;continue}else try{yield yield Oe(JSON.parse(N.data))}catch(R){throw a.error("Could not parse message into JSON:",N.data),a.error("From chunk:",N.raw),R}}}catch(N){h={error:N}}finally{try{!S&&!d&&(p=A.return)&&(yield Oe(p.call(A)))}finally{if(h)throw h.error}}_=!0}catch(N){if(Vx(N))return yield Oe(void 0);throw N}finally{_||t.abort()}})}return new Su(l,t,n)}static fromReadableStream(e,t,n){let i=!1;function a(){return Li(this,arguments,function*(){var d,h,p,y;const _=new pv,S=Ck(e);try{for(var A=!0,E=Oi(S),N;N=yield Oe(E.next()),d=N.done,!d;A=!0){y=N.value,A=!1;const R=y;for(const D of _.decode(R))yield yield Oe(D)}}catch(R){h={error:R}}finally{try{!A&&!d&&(p=E.return)&&(yield Oe(p.call(E)))}finally{if(h)throw h.error}}for(const R of _.flush())yield yield Oe(R)})}function l(){return Li(this,arguments,function*(){var d,h,p,y;if(i)throw new hi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let _=!1;try{try{for(var S=!0,A=Oi(a()),E;E=yield Oe(A.next()),d=E.done,!d;S=!0){y=E.value,S=!1;const N=y;_||N&&(yield yield Oe(JSON.parse(N)))}}catch(N){h={error:N}}finally{try{!S&&!d&&(p=A.return)&&(yield Oe(p.call(A)))}finally{if(h)throw h.error}}_=!0}catch(N){if(Vx(N))return yield Oe(void 0);throw N}finally{_||t.abort()}})}return new Su(l,t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),i=a=>({next:()=>{if(a.length===0){const l=n.next();e.push(l),t.push(l)}return a.shift()}});return[new Su(()=>i(e),this.controller,this.client),new Su(()=>i(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return Tk({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:i,done:a}=await t.next();if(a)return n.close();const l=Tw(JSON.stringify(i)+`
`);n.enqueue(l)}catch(i){n.error(i)}},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}}function FB(s,e){return Li(this,arguments,function*(){var n,i,a,l;if(!s.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new hi("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new hi("Attempted to iterate over a response with no body");const c=new zB,d=new pv,h=Ck(s.body);try{for(var p=!0,y=Oi(jB(h)),_;_=yield Oe(y.next()),n=_.done,!n;p=!0){l=_.value,p=!1;const S=l;for(const A of d.decode(S)){const E=c.decode(A);E&&(yield yield Oe(E))}}}catch(S){i={error:S}}finally{try{!p&&!n&&(a=y.return)&&(yield Oe(a.call(y)))}finally{if(i)throw i.error}}for(const S of d.flush()){const A=c.decode(S);A&&(yield yield Oe(A))}})}function jB(s){return Li(this,arguments,function*(){var t,n,i,a;let l=new Uint8Array;try{for(var c=!0,d=Oi(s),h;h=yield Oe(d.next()),t=h.done,!t;c=!0){a=h.value,c=!1;const p=a;if(p==null)continue;const y=p instanceof ArrayBuffer?new Uint8Array(p):typeof p=="string"?Tw(p):p;let _=new Uint8Array(l.length+y.length);_.set(l),_.set(y,l.length),l=_;let S;for(;(S=OB(l))!==-1;)yield yield Oe(l.slice(0,S)),l=l.slice(S)}}catch(p){n={error:p}}finally{try{!c&&!t&&(i=d.return)&&(yield Oe(i.call(d)))}finally{if(n)throw n.error}}l.length>0&&(yield yield Oe(l))})}class zB{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,i]=HB(e,":");return i.startsWith(" ")&&(i=i.substring(1)),t==="event"?this.event=i:t==="data"&&this.data.push(i),null}}function HB(s,e){const t=s.indexOf(e);return t!==-1?[s.substring(0,t),e,s.substring(t+e.length)]:[s,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function BB(s,e){const{response:t,requestLogID:n,retryOfRequestLogID:i,startTime:a}=e,l=await(async()=>{var c;if(e.options.stream)return Kn(s).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,s):Su.fromSSEResponse(t,e.controller,s);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const d=t.headers.get("content-type"),h=(c=d==null?void 0:d.split(";")[0])===null||c===void 0?void 0:c.trim();return(h==null?void 0:h.includes("application/json"))||(h==null?void 0:h.endsWith("+json"))?await t.json():await t.text()})();return Kn(s).debug(`[${n}] response parsed`,nl({retryOfRequestLogID:i,url:t.url,status:t.status,body:l,durationMs:Date.now()-a})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Cw extends Promise{constructor(e,t,n=BB){super(i=>{i(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new Cw(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Pk=Symbol("brand.privateNullableHeaders");function*GB(s){if(!s)return;if(Pk in s){const{values:n,nulls:i}=s;yield*n.entries();for(const a of i)yield[a,null];return}let e=!1,t;s instanceof Headers?t=s.entries():tN(s)?t=s:(e=!0,t=Object.entries(s??{}));for(let n of t){const i=n[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const a=tN(n[1])?n[1]:[n[1]];let l=!1;for(const c of a)c!==void 0&&(e&&!l&&(l=!0,yield[i,null]),yield[i,c])}}const $h=s=>{const e=new Headers,t=new Set;for(const n of s){const i=new Set;for(const[a,l]of GB(n)){const c=a.toLowerCase();i.has(c)||(e.delete(a),i.add(c)),l===null?(e.delete(a),t.add(c)):(e.append(a,l),t.delete(c))}}return{[Pk]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const a_=s=>{var e,t,n,i,a,l;if(typeof globalThis.process<"u")return(n=(t=(e=m3)===null||e===void 0?void 0:e[s])===null||t===void 0?void 0:t.trim())!==null&&n!==void 0?n:void 0;if(typeof globalThis.Deno<"u")return(l=(a=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||a===void 0?void 0:a.call(i,s))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Lk;class mv{constructor(e){var t,n,i,a,l,c,d,{baseURL:h=a_("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:p=(t=a_("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:y="v1beta"}=e,_=R0(e,["baseURL","apiKey","apiVersion"]);const S=Object.assign(Object.assign({apiKey:p,apiVersion:y},_),{baseURL:h||"https://generativelanguage.googleapis.com"});this.baseURL=S.baseURL,this.timeout=(n=S.timeout)!==null&&n!==void 0?n:mv.DEFAULT_TIMEOUT,this.logger=(i=S.logger)!==null&&i!==void 0?i:console;const A="warn";this.logLevel=A,this.logLevel=(l=(a=aN(S.logLevel,"ClientOptions.logLevel",this))!==null&&a!==void 0?a:aN(a_("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:A,this.fetchOptions=S.fetchOptions,this.maxRetries=(c=S.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(d=S.fetch)!==null&&d!==void 0?d:SB(),this.encoder=TB,this._options=S,this.apiKey=p,this.apiVersion=y,this.clientAdapter=S.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=$h([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return $h([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return $h([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new hi(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${_u}`}defaultIdempotencyKey(){return`stainless-node-retry-${cB()}`}makeStatusError(e,t,n,i){return Qn.generate(e,t,n,i)}buildURL(e,t,n){const i=!this.baseURLOverridden()&&n||this.baseURL,a=dB(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return pB(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(a.search=this.stringifyQuery(t)),a.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(i=>Object.assign({method:e,path:t},i)))}request(e,t=null){return new Cw(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var i,a,l;const c=await e,d=(i=c.maxRetries)!==null&&i!==void 0?i:this.maxRetries;t==null&&(t=d),await this.prepareOptions(c);const{req:h,url:p,timeout:y}=await this.buildRequest(c,{retryCount:d-t});await this.prepareRequest(h,{url:p,options:c});const _="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),S=n===void 0?"":`, retryOf: ${n}`,A=Date.now();if(Kn(this).debug(`[${_}] sending request`,nl({retryOfRequestLogID:n,method:c.method,url:p,options:c,headers:h.headers})),!((a=c.signal)===null||a===void 0)&&a.aborted)throw new Yx;const E=new AbortController,N=await this.fetchWithTimeout(p,h,y,E).catch($x),R=Date.now();if(N instanceof globalThis.Error){const P=`retrying, ${t} attempts remaining`;if(!((l=c.signal)===null||l===void 0)&&l.aborted)throw new Yx;const L=Vx(N)||/timed? ?out/i.test(String(N)+("cause"in N?String(N.cause):""));if(t)return Kn(this).info(`[${_}] connection ${L?"timed out":"failed"} - ${P}`),Kn(this).debug(`[${_}] connection ${L?"timed out":"failed"} (${P})`,nl({retryOfRequestLogID:n,url:p,durationMs:R-A,message:N.message})),this.retryRequest(c,t,n??_);throw Kn(this).info(`[${_}] connection ${L?"timed out":"failed"} - error; no more retries left`),Kn(this).debug(`[${_}] connection ${L?"timed out":"failed"} (error; no more retries left)`,nl({retryOfRequestLogID:n,url:p,durationMs:R-A,message:N.message})),L?new vk:new fv({cause:N})}const D=`[${_}${S}] ${h.method} ${p} ${N.ok?"succeeded":"failed"} with status ${N.status} in ${R-A}ms`;if(!N.ok){const P=await this.shouldRetry(N);if(t&&P){const Y=`retrying, ${t} attempts remaining`;return await EB(N.body),Kn(this).info(`${D} - ${Y}`),Kn(this).debug(`[${_}] response error (${Y})`,nl({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,durationMs:R-A})),this.retryRequest(c,t,n??_,N.headers)}const L=P?"error; no more retries left":"error; not retryable";Kn(this).info(`${D} - ${L}`);const z=await N.text().catch(Y=>$x(Y).message),H=vB(z),F=H?void 0:z;throw Kn(this).debug(`[${_}] response error (${L})`,nl({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,message:F,durationMs:Date.now()-A})),this.makeStatusError(N.status,H,F,N.headers)}return Kn(this).info(D),Kn(this).debug(`[${_}] response start`,nl({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,durationMs:R-A})),{response:N,options:c,controller:E,requestLogID:_,retryOfRequestLogID:n,startTime:A}}async fetchWithTimeout(e,t,n,i){const a=t||{},{signal:l,method:c}=a,d=R0(a,["signal","method"]);l&&l.addEventListener("abort",()=>i.abort());const h=setTimeout(()=>i.abort(),n),p=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,y=Object.assign(Object.assign(Object.assign({signal:i.signal},p?{duplex:"half"}:{}),{method:"GET"}),d);c&&(y.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,y)}finally{clearTimeout(h)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n,i){var a;let l;const c=i==null?void 0:i.get("retry-after-ms");if(c){const h=parseFloat(c);Number.isNaN(h)||(l=h)}const d=i==null?void 0:i.get("retry-after");if(d&&!l){const h=parseFloat(d);Number.isNaN(h)?l=Date.parse(d)-Date.now():l=h*1e3}if(!(l&&0<=l&&l<60*1e3)){const h=(a=e.maxRetries)!==null&&a!==void 0?a:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,h)}return await yB(l),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,l=Math.min(.5*Math.pow(2,a),8),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(e,{retryCount:t=0}={}){var n,i,a;const l=Object.assign({},e),{method:c,path:d,query:h,defaultBaseURL:p}=l,y=this.buildURL(d,h,p);"timeout"in l&&gB("timeout",l.timeout),l.timeout=(n=l.timeout)!==null&&n!==void 0?n:this.timeout;const{bodyHeaders:_,body:S}=this.buildBody({options:l}),A=await this.buildHeaders({options:e,method:c,bodyHeaders:_,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:A},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&S instanceof globalThis.ReadableStream&&{duplex:"half"}),S&&{body:S}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(a=l.fetchOptions)!==null&&a!==void 0?a:{}),url:y,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:i}){let a={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let c=$h([a,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),wB()),this._options.defaultHeaders,n,e.headers,l]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=$h([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:AB(e)}:this.encoder({body:e,headers:n})}}mv.DEFAULT_TIMEOUT=6e4;class fn extends mv{constructor(){super(...arguments),this.interactions=new Dk(this)}}Lk=fn;fn.GeminiNextGenAPIClient=Lk;fn.GeminiNextGenAPIClientError=hi;fn.APIError=Qn;fn.APIConnectionError=fv;fn.APIConnectionTimeoutError=vk;fn.APIUserAbortError=Yx;fn.NotFoundError=xk;fn.ConflictError=wk;fn.RateLimitError=Ak;fn.BadRequestError=yk;fn.AuthenticationError=bk;fn.InternalServerError=Ek;fn.PermissionDeniedError=_k;fn.UnprocessableEntityError=Sk;fn.toFile=MB;fn.Interactions=Dk;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qB(s,e){const t={},n=g(s,["name"]);return n!=null&&v(t,["_url","name"],n),t}function VB(s,e){const t={},n=g(s,["name"]);return n!=null&&v(t,["_url","name"],n),t}function $B(s,e){const t={},n=g(s,["sdkHttpResponse"]);return n!=null&&v(t,["sdkHttpResponse"],n),t}function YB(s,e){const t={},n=g(s,["sdkHttpResponse"]);return n!=null&&v(t,["sdkHttpResponse"],n),t}function KB(s,e,t){const n={};if(g(s,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=g(s,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&v(e,["displayName"],i),g(s,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=g(s,["epochCount"]);e!==void 0&&a!=null&&v(e,["tuningTask","hyperparameters","epochCount"],a);const l=g(s,["learningRateMultiplier"]);if(l!=null&&v(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),g(s,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(g(s,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(g(s,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=g(s,["batchSize"]);e!==void 0&&c!=null&&v(e,["tuningTask","hyperparameters","batchSize"],c);const d=g(s,["learningRate"]);if(e!==void 0&&d!=null&&v(e,["tuningTask","hyperparameters","learningRate"],d),g(s,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(g(s,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function XB(s,e,t){const n={};let i=g(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const S=g(s,["validationDataset"]);e!==void 0&&S!=null&&v(e,["supervisedTuningSpec"],lN(S))}else if(i==="PREFERENCE_TUNING"){const S=g(s,["validationDataset"]);e!==void 0&&S!=null&&v(e,["preferenceOptimizationSpec"],lN(S))}const a=g(s,["tunedModelDisplayName"]);e!==void 0&&a!=null&&v(e,["tunedModelDisplayName"],a);const l=g(s,["description"]);e!==void 0&&l!=null&&v(e,["description"],l);let c=g(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const S=g(s,["epochCount"]);e!==void 0&&S!=null&&v(e,["supervisedTuningSpec","hyperParameters","epochCount"],S)}else if(c==="PREFERENCE_TUNING"){const S=g(s,["epochCount"]);e!==void 0&&S!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],S)}let d=g(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const S=g(s,["learningRateMultiplier"]);e!==void 0&&S!=null&&v(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],S)}else if(d==="PREFERENCE_TUNING"){const S=g(s,["learningRateMultiplier"]);e!==void 0&&S!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],S)}let h=g(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const S=g(s,["exportLastCheckpointOnly"]);e!==void 0&&S!=null&&v(e,["supervisedTuningSpec","exportLastCheckpointOnly"],S)}else if(h==="PREFERENCE_TUNING"){const S=g(s,["exportLastCheckpointOnly"]);e!==void 0&&S!=null&&v(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],S)}let p=g(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const S=g(s,["adapterSize"]);e!==void 0&&S!=null&&v(e,["supervisedTuningSpec","hyperParameters","adapterSize"],S)}else if(p==="PREFERENCE_TUNING"){const S=g(s,["adapterSize"]);e!==void 0&&S!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],S)}if(g(s,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(g(s,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const y=g(s,["labels"]);e!==void 0&&y!=null&&v(e,["labels"],y);const _=g(s,["beta"]);return e!==void 0&&_!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","beta"],_),n}function JB(s,e){const t={},n=g(s,["baseModel"]);n!=null&&v(t,["baseModel"],n);const i=g(s,["preTunedModel"]);i!=null&&v(t,["preTunedModel"],i);const a=g(s,["trainingDataset"]);a!=null&&oG(a);const l=g(s,["config"]);return l!=null&&KB(l,t),t}function WB(s,e){const t={},n=g(s,["baseModel"]);n!=null&&v(t,["baseModel"],n);const i=g(s,["preTunedModel"]);i!=null&&v(t,["preTunedModel"],i);const a=g(s,["trainingDataset"]);a!=null&&lG(a,t,e);const l=g(s,["config"]);return l!=null&&XB(l,t,e),t}function QB(s,e){const t={},n=g(s,["name"]);return n!=null&&v(t,["_url","name"],n),t}function ZB(s,e){const t={},n=g(s,["name"]);return n!=null&&v(t,["_url","name"],n),t}function eG(s,e,t){const n={},i=g(s,["pageSize"]);e!==void 0&&i!=null&&v(e,["_query","pageSize"],i);const a=g(s,["pageToken"]);e!==void 0&&a!=null&&v(e,["_query","pageToken"],a);const l=g(s,["filter"]);return e!==void 0&&l!=null&&v(e,["_query","filter"],l),n}function tG(s,e,t){const n={},i=g(s,["pageSize"]);e!==void 0&&i!=null&&v(e,["_query","pageSize"],i);const a=g(s,["pageToken"]);e!==void 0&&a!=null&&v(e,["_query","pageToken"],a);const l=g(s,["filter"]);return e!==void 0&&l!=null&&v(e,["_query","filter"],l),n}function nG(s,e){const t={},n=g(s,["config"]);return n!=null&&eG(n,t),t}function sG(s,e){const t={},n=g(s,["config"]);return n!=null&&tG(n,t),t}function iG(s,e){const t={},n=g(s,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const i=g(s,["nextPageToken"]);i!=null&&v(t,["nextPageToken"],i);const a=g(s,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>Ok(c))),v(t,["tuningJobs"],l)}return t}function rG(s,e){const t={},n=g(s,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const i=g(s,["nextPageToken"]);i!=null&&v(t,["nextPageToken"],i);const a=g(s,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>Jx(c))),v(t,["tuningJobs"],l)}return t}function aG(s,e){const t={},n=g(s,["name"]);n!=null&&v(t,["model"],n);const i=g(s,["name"]);return i!=null&&v(t,["endpoint"],i),t}function oG(s,e){const t={};if(g(s,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(s,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=g(s,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>a)),v(t,["examples","examples"],i)}return t}function lG(s,e,t){const n={};let i=g(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const l=g(s,["gcsUri"]);e!==void 0&&l!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(i==="PREFERENCE_TUNING"){const l=g(s,["gcsUri"]);e!==void 0&&l!=null&&v(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let a=g(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=g(s,["vertexDatasetResource"]);e!==void 0&&l!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=g(s,["vertexDatasetResource"]);e!==void 0&&l!=null&&v(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(g(s,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function Ok(s,e){const t={},n=g(s,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const i=g(s,["name"]);i!=null&&v(t,["name"],i);const a=g(s,["state"]);a!=null&&v(t,["state"],Q2(a));const l=g(s,["createTime"]);l!=null&&v(t,["createTime"],l);const c=g(s,["tuningTask","startTime"]);c!=null&&v(t,["startTime"],c);const d=g(s,["tuningTask","completeTime"]);d!=null&&v(t,["endTime"],d);const h=g(s,["updateTime"]);h!=null&&v(t,["updateTime"],h);const p=g(s,["description"]);p!=null&&v(t,["description"],p);const y=g(s,["baseModel"]);y!=null&&v(t,["baseModel"],y);const _=g(s,["_self"]);return _!=null&&v(t,["tunedModel"],aG(_)),t}function Jx(s,e){const t={},n=g(s,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const i=g(s,["name"]);i!=null&&v(t,["name"],i);const a=g(s,["state"]);a!=null&&v(t,["state"],Q2(a));const l=g(s,["createTime"]);l!=null&&v(t,["createTime"],l);const c=g(s,["startTime"]);c!=null&&v(t,["startTime"],c);const d=g(s,["endTime"]);d!=null&&v(t,["endTime"],d);const h=g(s,["updateTime"]);h!=null&&v(t,["updateTime"],h);const p=g(s,["error"]);p!=null&&v(t,["error"],p);const y=g(s,["description"]);y!=null&&v(t,["description"],y);const _=g(s,["baseModel"]);_!=null&&v(t,["baseModel"],_);const S=g(s,["tunedModel"]);S!=null&&v(t,["tunedModel"],S);const A=g(s,["preTunedModel"]);A!=null&&v(t,["preTunedModel"],A);const E=g(s,["supervisedTuningSpec"]);E!=null&&v(t,["supervisedTuningSpec"],E);const N=g(s,["preferenceOptimizationSpec"]);N!=null&&v(t,["preferenceOptimizationSpec"],N);const R=g(s,["tuningDataStats"]);R!=null&&v(t,["tuningDataStats"],R);const D=g(s,["encryptionSpec"]);D!=null&&v(t,["encryptionSpec"],D);const P=g(s,["partnerModelTuningSpec"]);P!=null&&v(t,["partnerModelTuningSpec"],P);const L=g(s,["customBaseModel"]);L!=null&&v(t,["customBaseModel"],L);const z=g(s,["experiment"]);z!=null&&v(t,["experiment"],z);const H=g(s,["labels"]);H!=null&&v(t,["labels"],H);const F=g(s,["outputUri"]);F!=null&&v(t,["outputUri"],F);const X=g(s,["pipelineJob"]);X!=null&&v(t,["pipelineJob"],X);const Y=g(s,["serviceAccount"]);Y!=null&&v(t,["serviceAccount"],Y);const J=g(s,["tunedModelDisplayName"]);J!=null&&v(t,["tunedModelDisplayName"],J);const ie=g(s,["veoTuningSpec"]);return ie!=null&&v(t,["veoTuningSpec"],ie),t}function cG(s,e){const t={},n=g(s,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const i=g(s,["name"]);i!=null&&v(t,["name"],i);const a=g(s,["metadata"]);a!=null&&v(t,["metadata"],a);const l=g(s,["done"]);l!=null&&v(t,["done"],l);const c=g(s,["error"]);return c!=null&&v(t,["error"],c),t}function lN(s,e){const t={},n=g(s,["gcsUri"]);n!=null&&v(t,["validationDatasetUri"],n);const i=g(s,["vertexDatasetResource"]);return i!=null&&v(t,["validationDatasetUri"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uG extends ga{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new yc(ha.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var n;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const i={tunedModelName:t.baseModel};!((n=t.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(i.checkpointId=t.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},t),{preTunedModel:i});return a.baseModel=void 0,await this.tuneInternal(a)}else{const i=Object.assign({},t);return await this.tuneInternal(i)}else{const i=Object.assign({},t),a=await this.tuneMldevInternal(i);let l="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?l=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(l=a.name.split("/operations/")[0]),{name:l,state:Fx.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=ZB(e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>Jx(p))}else{const h=QB(e);return c=ue("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>Ok(p))}}async listInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=sG(e);return c=ue("tuningJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=rG(p),_=new PC;return Object.assign(_,y),_})}else{const h=nG(e);return c=ue("tunedModels",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=iG(p),_=new PC;return Object.assign(_,y),_})}}async cancel(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=VB(e);return c=ue("{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=YB(p),_=new LC;return Object.assign(_,y),_})}else{const h=qB(e);return c=ue("{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(y=>{const _=y;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const y=$B(p),_=new LC;return Object.assign(_,y),_})}}async tuneInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=WB(e,e);return a=ue("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>Jx(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=JB(e);return a=ue("tunedModels",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>cG(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dG{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const hG=1024*1024*8,fG=3,pG=1e3,mG=2,M0="x-goog-upload-status";async function gG(s,e,t){var n;const i=await Uk(s,e,t),a=await(i==null?void 0:i.json());if(((n=i==null?void 0:i.headers)===null||n===void 0?void 0:n[M0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function vG(s,e,t){var n;const i=await Uk(s,e,t),a=await(i==null?void 0:i.json());if(((n=i==null?void 0:i.headers)===null||n===void 0?void 0:n[M0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=$2(a),c=new _w;return Object.assign(c,l),c}async function Uk(s,e,t){var n,i;let a=0,l=0,c=new jx(new Response),d="upload";for(a=s.size;l<a;){const h=Math.min(hG,a-l),p=s.slice(l,l+h);l+h>=a&&(d+=", finalize");let y=0,_=pG;for(;y<fG&&(c=await t.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(h)}}}),!(!((n=c==null?void 0:c.headers)===null||n===void 0)&&n[M0]));)y++,await bG(_),_=_*mG;if(l+=h,((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[M0])!=="active")break;if(a<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function yG(s){return{size:s.size,type:s.type}}function bG(s){return new Promise(e=>setTimeout(e,s))}class _G{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await gG(e,t,n)}async uploadToFileSearchStore(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await vG(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await yG(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xG{create(e,t,n){return new wG(e,t,n)}}class wG{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cN="x-goog-api-key";class SG{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(cN)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(cN,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const AG="gl-node/";class EG{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new fn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=b3(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new SG(this.apiKey);this.apiClient=new yH({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:AG+"web",uploader:new _G,downloader:new dG}),this.models=new UH(this.apiClient),this.live=new MH(this.apiClient,i,new xG),this.batches=new KF(this.apiClient),this.chats=new R6(this.models,this.apiClient),this.caches=new T6(this.apiClient),this.files=new j6(this.apiClient),this.operations=new FH(this.apiClient),this.authTokens=new eB(this.apiClient),this.tunings=new uG(this.apiClient),this.fileSearchStores=new lB(this.apiClient)}}const TG={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var CG={};const NG=()=>{let s="";try{typeof process<"u"&&CG&&(s="PLACEHOLDER_API_KEY")}catch{}if(!s)try{typeof import.meta<"u"&&TG&&(s="")}catch{}return s},Wx=NG(),uN=Wx?new EG({apiKey:Wx}):null,RG=async(s,e,t,n,i,a=20,l,c="ar",d)=>{try{if(!Wx||!uN)throw new Error(" API .");if(!s||s.trim().length<50)throw new Error("       .    PDF       .");const p=s.substring(0,5e5),y=10,_=Math.ceil(a/y);let S=[];const A=c==="ar"?"Output Language: ARABIC (Strictly)":"Output Language: ENGLISH (Strictly)",E=d?`CRITICAL FOCUS: ${d}. Prioritize extracting questions related ONLY or PRIMARILY to this focus.`:"";for(let N=0;N<_;N++){const R=Math.min(y,a-N*y);l&&l(S.length,a);const D=`
        Act as a strict academic professor. 
        Task: Create ${R} distinct exam questions based on the provided text for the subject "${e}".
        Context: College: ${t}, Major: ${n}, Exam Type: ${i}.
        ${A}
        ${E}
        
        STRICT QUESTION STYLE DISTRIBUTION:
        1. **70% Sentence Completion ( )**: 
           - The question must be a statement with one blank represented by "_______".
           - VARIETY IN BLANK POSITION IS MANDATORY. Distribute the blank across:
             A. Beginning: "_______ are considered the building blocks of life."
             B. Middle: "The process of _______ is essential for plant growth."
             C. End: "The main source of energy for the earth is the _______."
           - DO NOT put the blank only at the end. Mix it up.
           - MUST HAVE EXACTLY 4 OPTIONS.
        
        2. **15% Interrogative Form ()**:
           - Direct questions ending with "?".
           - MUST HAVE EXACTLY 4 OPTIONS.
        
        3. **15% True/False ( )**:
           - Factual statements. Options: ["", ""] or ["True", "False"].

        QUALITY RULES:
        1. **Strictly 4 Options**: Every multiple-choice / completion question MUST have exactly 4 options. No more, no less.
        2. **Concise Options**: Options should be short (1-3 words).
        3. **Logical Distractors**: Incorrect options must be plausible within the context.
        4. **Brief Explanations**: Exactly 1 sentence explaining the core fact.
        5. **Valid JSON**: Output strictly as a JSON array.
        
        JSON Schema per item:
        {
          "type": "multiple_choice" | "true_false",
          "question": "string",
          "options": ["string", "string", "string", "string"],
          "correct_answer_index": number,
          "explanation": "Brief reason why it is correct"
        }
        
        Source Content:
        ${p}
      `;try{const P=await uN.models.generateContent({model:"gemini-3-flash-preview",contents:D,config:{responseMimeType:"application/json",maxOutputTokens:4096,responseSchema:{type:Ln.ARRAY,items:{type:Ln.OBJECT,properties:{type:{type:Ln.STRING,enum:["multiple_choice","true_false"]},question:{type:Ln.STRING},options:{type:Ln.ARRAY,items:{type:Ln.STRING},minItems:2,maxItems:4},correct_answer_index:{type:Ln.INTEGER},explanation:{type:Ln.STRING}},required:["type","question","options","correct_answer_index","explanation"]}}}}),z=JSON.parse(P.text||"[]").map(H=>({subject:e,college:t,major:n,exam_type:i,type:H.type,question:H.question,options:H.options,correct_answer_index:H.correct_answer_index,explanation:H.explanation}));S=[...S,...z]}catch(P){console.error(`Error in batch ${N+1}:`,P)}}if(l&&l(a,a),S.length===0)throw new Error("    .      .");return S}catch(h){throw console.error("Gemini Bank Gen Error:",h),new Error("   : "+h.message)}},Fk=async()=>{var s;try{const{data:e,error:t}=await Ht.from("question_bank").select("subject, college, major");if(t){if(t.code==="42703"||(s=t.message)!=null&&s.includes("does not exist"))return kG();if(t.code==="42P01")return[];throw t}const n=new Map;return(e||[]).forEach(i=>{if(i.subject&&typeof i.subject=="string"&&i.subject.trim().length>0){const a=i.subject.trim();n.has(a)||n.set(a,{subject:a,college:i.college||" ",major:i.major||" "})}}),Array.from(n.values())}catch(e){return console.error("Error fetching subjects:",e),[]}},kG=async()=>{const{data:s,error:e}=await Ht.from("question_bank").select("subject");if(e)return[];const t=new Map;return(s||[]).forEach(n=>{if(n.subject&&typeof n.subject=="string"&&n.subject.trim().length>0){const i=n.subject.trim();t.has(i)||t.set(i,{subject:i,college:" ",major:" "})}}),Array.from(t.values())},MG=async(s,e,t)=>{try{let n=Ht.from("question_bank").select("*").eq("subject",s.trim());t&&t!=="all"&&(n=n.eq("exam_type",t));const{data:i,error:a}=await n;if(a)throw a;if(!i||i.length===0)throw new Error("      ");return i.sort(()=>.5-Math.random()).slice(0,e).map(c=>({id:c.id,type:c.type,question:c.question,options:typeof c.options=="string"?JSON.parse(c.options):c.options,correctAnswerIndex:c.correct_answer_index,explanation:c.explanation}))}catch(n){throw new Error(n.message||"   ")}},IG=async s=>{try{for(let t=0;t<s.length;t+=50){const n=s.slice(t,t+50),{error:i}=await Ht.from("question_bank").insert(n);if(i)throw i}}catch{throw new Error("     ")}},DG=async s=>{try{const{data:e,error:t}=await Ht.from("question_bank").select("*").eq("subject",s.trim()).order("id",{ascending:!1});if(t)throw t;return(e||[]).map(n=>({...n,options:typeof n.options=="string"?JSON.parse(n.options):n.options}))}catch{return[]}},PG=async s=>{try{const{error:e}=await Ht.from("question_bank").delete().eq("id",s);if(e)throw e}catch{throw new Error("   ")}},LG=async s=>{try{const e=s.trim(),{error:t,count:n}=await Ht.from("question_bank").delete({count:"exact"}).eq("subject",e);if(t)throw console.error("Supabase Delete Error:",t),t;console.log(`Deleted subject: ${e}. Rows affected: ${n}`)}catch(e){throw console.error("Error deleting subject service:",e),new Error(e.message||"   ")}},OG=({user:s,onLogout:e,onNavigate:t})=>{const[n,i]=se.useState({totalQuizzes:0,totalToolUsage:0,totalStudents:0,totalQuestionsInBank:0,loading:!0}),[a,l]=se.useState("dashboard"),[c,d]=se.useState("stats"),[h,p]=se.useState([]),[y,_]=se.useState(null),[S,A]=se.useState([]),[E,N]=se.useState(!1),[R,D]=se.useState(!1),[P,L]=se.useState(!1),[z,H]=se.useState(null),[F,X]=se.useState(null),[Y,J]=se.useState(""),[ie,pe]=se.useState(""),[ye,be]=se.useState("new"),[Se,j]=se.useState(""),[G,ae]=se.useState("midterm"),[we,Ne]=se.useState(20),[U,Q]=se.useState("ar"),[re,ne]=se.useState(""),[fe,ge]=se.useState(!1),[de,ot]=se.useState(""),[Ze,jn]=se.useState([]),[zi,hr]=se.useState(!1),Gs="w-full bg-[#0f0f0f] border border-white/10 rounded-xl p-3.5 text-white font-bold outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500/30 transition-all placeholder:text-slate-600 text-xs appearance-none cursor-pointer",Zn=async()=>{i(oe=>({...oe,loading:!0}));try{const{data:oe}=await Ht.from("quiz_history").select("user_id, quiz_title"),{count:qe}=await Ht.from("question_bank").select("*",{count:"exact",head:!0});if(oe){const es=new Set(oe.map(ya=>ya.user_id)).size,bc=oe.filter(ya=>{var Mo;return!((Mo=ya.quiz_title)!=null&&Mo.startsWith(": "))}),bv=oe.filter(ya=>{var Mo;return(Mo=ya.quiz_title)==null?void 0:Mo.startsWith(": ")});i({totalQuizzes:bc.length,totalToolUsage:bv.length,totalStudents:es,totalQuestionsInBank:qe||0,loading:!1})}const zn=await Fk();p(zn.map(es=>es.subject))}catch(oe){console.error("Admin stats error:",oe),i(qe=>({...qe,loading:!1}))}};se.useEffect(()=>{Zn()},[]);const Hd=async oe=>{_(oe),d("subject_details"),N(!0);const qe=await DG(oe);A(qe),N(!1)},Bd=async oe=>{if(confirm("      "))try{await PG(oe),A(qe=>qe.filter(zn=>zn.id!==oe)),Zn()}catch{alert(" ")}},gv=()=>{y&&D(!0)},sm=async()=>{if(!y)return;L(!0);const oe=y;try{await LG(oe),p(qe=>qe.filter(zn=>zn!==oe)),d("subjects"),_(null),D(!1),Zn()}catch(qe){console.error("Delete UI Error:",qe),alert("  : "+(qe.message||"   .")),D(!1)}finally{L(!1)}},Gd=()=>{y&&(be("existing"),j(y),S.length>0&&(J(S[0].college||""),pe(S[0].major||"")),l("generator"),d("stats"),H(null),X(null),jn([]))},qd=async oe=>{H(oe);try{const qe=await p3(oe);X(qe)}catch{alert("  .      .")}},Vd=async()=>{if(!(!F||!Se)){if(!Y||!ie){alert("   .");return}ge(!0),ot("  ...");try{const oe=await RG(F,Se,Y,ie,G,we,(qe,zn)=>{ot(`  ${qe}   ${zn} ...`)},U,re);jn(oe)}catch(oe){alert(oe.message)}finally{ge(!1),ot("")}}},vv=async()=>{hr(!0);try{await IG(Ze),alert("     !"),jn([]),H(null),X(null),ye==="new"&&j(""),Zn()}catch{alert("   ")}finally{hr(!1)}},yv=oe=>{jn(qe=>qe.filter((zn,es)=>es!==oe))};return b.jsxs("div",{className:"min-h-screen pt-24 pb-20 px-4 md:px-6 relative z-10 bg-[#020202] text-right",dir:"rtl",children:[b.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-20 overflow-hidden",children:b.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_center,#10b98115_0%,transparent_70%)]"})}),b.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[b.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6 mb-8 animate-lux-up",children:[b.jsxs("div",{className:"flex items-center gap-5",children:[b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"relative w-20 h-20 rounded-2xl bg-[#0a0a0a] border border-emerald-500/30 flex items-center justify-center overflow-hidden shadow-2xl",children:b.jsx("img",{src:"https://lh3.googleusercontent.com/d/1tbzVNKO3FGH46Pa6MZ58OWD4BXVKdK5P",alt:"Admin",className:"w-full h-full object-cover"})}),b.jsx("div",{className:"absolute -bottom-2 -right-2 bg-emerald-500 text-black p-1.5 rounded-lg shadow-lg border-2 border-[#020202]",children:b.jsx(jN,{size:16})})]}),b.jsxs("div",{children:[b.jsx("h1",{className:"text-2xl font-black text-white tracking-tight",children:" "}),b.jsx("p",{className:"text-emerald-400 font-bold text-xs",children:"   "})]})]}),b.jsxs("div",{className:"flex bg-white/5 p-1 rounded-xl border border-white/10",children:[b.jsx("button",{onClick:()=>{l("dashboard"),d("stats")},className:`px-6 py-2 rounded-lg text-sm font-bold transition-all ${a==="dashboard"?"bg-emerald-600 text-white":"text-slate-400 hover:text-white"}`,children:" "}),b.jsxs("button",{onClick:()=>l("generator"),className:`px-6 py-2 rounded-lg text-sm font-bold transition-all flex items-center gap-2 ${a==="generator"?"bg-emerald-600 text-white":"text-slate-400 hover:text-white"}`,children:[b.jsx(hT,{size:16}),"  "]})]})]}),a==="dashboard"?b.jsxs("div",{className:"animate-fade-in",children:[c==="stats"&&b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[{label:" ",value:n.totalStudents,icon:b.jsx(YN,{}),color:"text-blue-400",bg:"bg-blue-500/10"},{label:"  ",value:n.totalQuestionsInBank,icon:b.jsx(hT,{}),color:"text-fuchsia-400",bg:"bg-fuchsia-500/10"},{label:" ",value:n.totalQuizzes,icon:b.jsx(iw,{}),color:"text-emerald-400",bg:"bg-emerald-500/10"},{label:" ",value:n.totalToolUsage,icon:b.jsx(PN,{}),color:"text-amber-400",bg:"bg-amber-500/10"}].map((oe,qe)=>b.jsxs("div",{className:"glass-panel p-6 rounded-[2rem] bg-[#080808] border border-white/5 group",children:[b.jsx("div",{className:`w-12 h-12 rounded-2xl ${oe.bg} ${oe.color} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform`,children:oe.icon}),b.jsx("h4",{className:"text-3xl font-black text-white mb-1",children:n.loading?"...":oe.value}),b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:oe.label})]},qe))}),b.jsx("div",{className:"mb-8",children:b.jsxs("div",{className:"glass-panel p-8 rounded-[2rem] bg-[#050505] border border-white/5 flex items-center justify-between flex-col md:flex-row gap-6",children:[b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsx("div",{className:"w-16 h-16 rounded-2xl bg-violet-500/10 flex items-center justify-center text-violet-400",children:b.jsx(zO,{size:32})}),b.jsxs("div",{children:[b.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"  "}),b.jsx("p",{className:"text-slate-500 text-sm",children:"       ."})]})]}),b.jsxs(yt,{onClick:()=>d("subjects"),className:"!bg-violet-600",children:["  ",b.jsx(Cu,{size:16})]})]})}),b.jsx("div",{className:"flex justify-end",children:b.jsxs(yt,{onClick:e,variant:"danger",className:"shadow-lg shadow-red-900/20",children:[b.jsx(lU,{size:18}),"  "]})})]}),c==="subjects"&&b.jsxs("div",{className:"animate-fade-in",children:[b.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[b.jsx("button",{onClick:()=>d("stats"),className:"p-2 bg-white/5 rounded-full hover:bg-white/10 text-slate-400",children:b.jsx(Cu,{size:20,className:"rotate-180"})}),b.jsx("h2",{className:"text-2xl font-black text-white",children:"  "})]}),b.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:h.length===0?b.jsx("div",{className:"col-span-full text-center py-12 border border-dashed border-white/10 rounded-3xl text-slate-500",children:"    .     ."}):h.map((oe,qe)=>b.jsxs("div",{onClick:()=>Hd(oe),className:"glass-panel p-5 rounded-3xl bg-[#080808] border border-white/5 hover:border-violet-500/30 cursor-pointer group transition-all",children:[b.jsxs("div",{className:"flex items-center justify-between mb-4",children:[b.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500/10 flex items-center justify-center text-blue-400 group-hover:scale-110 transition-transform",children:b.jsx(FO,{size:20})}),b.jsx(vO,{size:16,className:"text-slate-600 group-hover:text-white transition-colors rotate-180"})]}),b.jsx("h3",{className:"font-bold text-white truncate",children:oe}),b.jsx("p",{className:"text-[10px] text-slate-500 mt-1",children:"  "})]},qe))})]}),c==="subject_details"&&y&&b.jsxs("div",{className:"animate-fade-in h-full",children:[b.jsxs("div",{className:"flex items-center justify-between mb-6 flex-col sm:flex-row gap-4",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("button",{onClick:()=>d("subjects"),className:"p-2 bg-white/5 rounded-full hover:bg-white/10 text-slate-400",children:b.jsx(Cu,{size:20,className:"rotate-180"})}),b.jsxs("div",{children:[b.jsx("h2",{className:"text-2xl font-black text-white",children:y}),b.jsxs("p",{className:"text-xs text-slate-500 font-bold",children:[" : ",S.length]})]})]}),b.jsxs("div",{className:"flex gap-2",children:[b.jsxs(yt,{onClick:Gd,className:"!py-2 !px-4 !text-xs !bg-emerald-600",children:[b.jsx(xO,{size:14}),"  "]}),b.jsxs(yt,{onClick:gv,variant:"danger",className:"!py-2 !px-4 !text-xs",children:[b.jsx(zh,{size:14}),"  "]})]})]}),E?b.jsx("div",{className:"flex justify-center py-20",children:b.jsx(Di,{className:"animate-spin text-violet-500"})}):b.jsx("div",{className:"glass-panel p-6 rounded-[2rem] bg-[#050505] border border-white/5 h-[600px] overflow-hidden flex flex-col",children:b.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-3 pr-2",children:S.length===0?b.jsx("p",{className:"text-center text-slate-500 py-10",children:"  ."}):S.map((oe,qe)=>b.jsxs("div",{className:"p-4 rounded-2xl bg-white/[0.02] border border-white/5 flex gap-4 group hover:bg-white/[0.04] transition-colors",children:[b.jsxs("div",{className:"flex-1",children:[b.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[b.jsx("span",{className:"text-[10px] bg-white/10 px-2 py-0.5 rounded text-slate-300",children:oe.type==="true_false"?"/":""}),b.jsx("span",{className:"text-[10px] bg-white/10 px-2 py-0.5 rounded text-slate-300",children:oe.exam_type}),oe.major&&b.jsx("span",{className:"text-[10px] bg-violet-500/10 text-violet-300 px-2 py-0.5 rounded border border-violet-500/20",children:oe.major})]}),b.jsx("p",{className:"text-sm font-bold text-white mb-2",children:oe.question}),b.jsx("div",{className:"grid grid-cols-2 gap-2",children:oe.options.map((zn,es)=>b.jsx("span",{className:`text-[10px] px-2 py-1 rounded border ${es===oe.correct_answer_index?"border-emerald-500/30 text-emerald-400 bg-emerald-500/10":"border-white/5 text-slate-500"}`,children:zn},es))})]}),b.jsx("button",{onClick:()=>Bd(oe.id),className:"self-start p-2 text-slate-600 hover:text-red-400 transition-colors",children:b.jsx(zh,{size:16})})]},oe.id||qe))})})]})]}):b.jsx("div",{className:"animate-fade-in space-y-8",children:b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[b.jsx("div",{className:"lg:col-span-1 space-y-6",children:b.jsxs("div",{className:"glass-panel p-6 rounded-[2rem] bg-[#050505] border border-white/5",children:[b.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[b.jsx(UN,{className:"text-emerald-400"}),"  "]}),b.jsxs("div",{className:"space-y-4",children:[z?b.jsxs("div",{className:"p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-xl flex items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[b.jsx(zN,{className:"text-emerald-400 shrink-0"}),b.jsx("span",{className:"text-xs font-bold text-white truncate",children:z.name})]}),b.jsx("button",{onClick:()=>{H(null),X(null)},className:"p-1 hover:bg-white/10 rounded-full",children:b.jsx(zh,{size:16,className:"text-red-400"})})]}):b.jsx("div",{className:"border-2 border-dashed border-white/10 rounded-2xl p-6 text-center hover:border-emerald-500/30 transition-colors",children:b.jsx(h5,{onFileSelect:qd,disabled:!1})}),b.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5 space-y-3",children:[b.jsxs("div",{className:"relative",children:[b.jsxs("label",{className:"text-xs font-bold text-slate-400 block mb-2 flex items-center gap-1",children:[b.jsx(dT,{size:12})," "]}),b.jsxs("div",{className:"relative",children:[b.jsxs("select",{value:Y,onChange:oe=>{J(oe.target.value),pe("")},className:Gs,children:[b.jsx("option",{value:"",className:"bg-[#0f0f0f]",children:"--   --"}),Object.keys(b_).map((oe,qe)=>b.jsx("option",{value:oe,className:"bg-[#0f0f0f] text-white",children:oe},qe))]}),b.jsx(Kh,{size:14,className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none"})]})]}),Y&&b.jsxs("div",{className:"animate-fade-in relative",children:[b.jsxs("label",{className:"text-xs font-bold text-slate-400 block mb-2 flex items-center gap-1",children:[b.jsx(Ud,{size:12})," "]}),b.jsxs("div",{className:"relative",children:[b.jsxs("select",{value:ie,onChange:oe=>pe(oe.target.value),className:Gs,children:[b.jsx("option",{value:"",className:"bg-[#0f0f0f]",children:"--   --"}),b_[Y].map((oe,qe)=>b.jsx("option",{value:oe,className:"bg-[#0f0f0f] text-white",children:oe},qe))]}),b.jsx(Kh,{size:14,className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none"})]})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2",children:" "}),b.jsxs("div",{className:"flex bg-[#0f0f0f] p-1 rounded-xl border border-white/10 mb-3",children:[b.jsxs("button",{onClick:()=>{be("new"),j("")},className:`flex-1 py-2 rounded-lg text-[10px] font-black transition-all flex items-center justify-center gap-2 ${ye==="new"?"bg-emerald-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:[b.jsx($N,{size:14}),"  "]}),b.jsxs("button",{onClick:()=>{be("existing")},className:`flex-1 py-2 rounded-lg text-[10px] font-black transition-all flex items-center justify-center gap-2 ${ye==="existing"?"bg-emerald-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:[b.jsx(tU,{size:14}),"  "]})]}),ye==="new"?b.jsx("input",{type:"text",value:Se,onChange:oe=>j(oe.target.value),className:Gs+" cursor-text appearance-auto",placeholder:":   1"}):b.jsxs("div",{className:"relative animate-fade-in",children:[b.jsxs("select",{value:Se,onChange:oe=>j(oe.target.value),className:Gs,children:[b.jsx("option",{value:"",className:"bg-[#0f0f0f]",children:"--   --"}),h.map((oe,qe)=>b.jsx("option",{value:oe,className:"bg-[#0f0f0f] text-white",children:oe},qe))]}),b.jsx(Kh,{size:14,className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none"})]})]}),b.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[b.jsxs("div",{className:"relative",children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2",children:" "}),b.jsxs("div",{className:"relative",children:[b.jsxs("select",{value:G,onChange:oe=>ae(oe.target.value),className:Gs,children:[b.jsx("option",{value:"midterm",className:"bg-[#0f0f0f]",children:" (Midterm)"}),b.jsx("option",{value:"final",className:"bg-[#0f0f0f]",children:" (Final)"}),b.jsx("option",{value:"quiz",className:"bg-[#0f0f0f]",children:" (Quiz)"})]}),b.jsx(Kh,{size:14,className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2",children:" "}),b.jsx("input",{type:"number",value:we,onChange:oe=>Ne(Number(oe.target.value)),className:Gs+" cursor-text appearance-auto px-4",min:"1",max:"100"})]})]}),b.jsxs("div",{children:[b.jsxs("label",{className:"text-xs font-bold text-slate-400 block mb-2 flex items-center gap-1",children:[b.jsx(yU,{size:12,className:"text-amber-500"}),"    ()"]}),b.jsx("textarea",{value:re,onChange:oe=>ne(oe.target.value),className:"w-full bg-[#0f0f0f] border border-white/10 rounded-xl p-4 text-white font-bold focus:border-emerald-500 outline-none text-xs h-24 resize-none placeholder:text-slate-700 transition-all",placeholder:":         ..."})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2",children:" "}),b.jsxs("div",{className:"flex bg-[#0f0f0f] p-1 rounded-xl border border-white/10",children:[b.jsx("button",{onClick:()=>Q("ar"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${U==="ar"?"bg-emerald-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:""}),b.jsx("button",{onClick:()=>Q("en"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${U==="en"?"bg-emerald-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"English"})]})]}),b.jsx(yt,{onClick:Vd,disabled:!F||!Se||!Y||!ie||fe,fullWidth:!0,className:"!py-4 shadow-xl !bg-gradient-to-r !from-emerald-600 !to-emerald-500",children:fe?b.jsxs("div",{className:"flex flex-col items-center",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx(Di,{className:"animate-spin",size:16}),"  ..."]}),de&&b.jsx("span",{className:"text-[9px] mt-1 text-emerald-100",children:de})]}):b.jsxs(b.Fragment,{children:[b.jsx(gc,{size:18}),"  "]})})]})]})}),b.jsx("div",{className:"lg:col-span-2",children:b.jsxs("div",{className:"glass-panel p-6 rounded-[2rem] bg-[#050505] border border-white/5 h-full min-h-[500px] flex flex-col",children:[b.jsxs("div",{className:"flex items-center justify-between mb-4 flex-wrap gap-4",children:[b.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[b.jsx(g0,{className:"text-emerald-400"}),"   (",Ze.length,")"]}),Ze.length>0&&b.jsx(yt,{onClick:vv,disabled:zi,className:"!py-2 !text-xs !bg-blue-600",children:zi?" ...":b.jsxs(b.Fragment,{children:[b.jsx(qN,{size:14}),"   "]})})]}),Y&&b.jsxs("div",{className:"mb-4 p-3 bg-white/5 rounded-xl border border-white/5 flex flex-wrap gap-2 text-xs text-slate-400",children:[b.jsxs("span",{className:"flex items-center gap-1",children:[b.jsx(dT,{size:12,className:"text-violet-400"})," ",Y]}),b.jsx("span",{className:"text-slate-600",children:"|"}),b.jsxs("span",{className:"flex items-center gap-1",children:[b.jsx(Ud,{size:12,className:"text-fuchsia-400"})," ",ie]})]}),b.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-4 pr-2 max-h-[600px]",children:Ze.length===0?b.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500 opacity-50",children:[b.jsx(m0,{size:48,className:"mb-4"}),b.jsx("p",{children:"    "})]}):Ze.map((oe,qe)=>b.jsxs("div",{className:`p-4 rounded-2xl bg-[#0a0a0a] border border-white/5 relative group ${U==="en"?"text-left":"text-right"}`,dir:U==="en"?"ltr":"rtl",children:[b.jsx("button",{onClick:()=>yv(qe),className:`absolute top-3 ${U==="en"?"right-3":"left-3"} text-slate-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity`,children:b.jsx(zh,{size:16})}),b.jsxs("p",{className:"font-bold text-white mb-2 text-sm",children:[b.jsxs("span",{className:"text-emerald-500 mx-2",children:["#",qe+1]}),oe.question]}),b.jsx("div",{className:"grid grid-cols-2 gap-2 mb-3",children:oe.options.map((zn,es)=>b.jsx("div",{className:`text-[10px] p-2 rounded-lg border font-bold ${es===oe.correct_answer_index?"bg-emerald-500/20 border-emerald-500/30 text-emerald-300":"bg-black/20 border-white/5 text-slate-400"}`,children:zn},es))}),b.jsxs("p",{className:"text-[10px] text-slate-500 bg-black/30 p-2 rounded-lg",children:[b.jsx("span",{className:"text-amber-500 font-black",children:U==="en"?"Explanation:":":"})," ",oe.explanation]})]},qe))})]})})]})}),R&&b.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[b.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>D(!1)}),b.jsxs("div",{className:"glass-panel w-full max-w-sm p-8 rounded-3xl text-center relative animate-lux-scale border border-white/10",children:[b.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20",children:P?b.jsx(Di,{size:32,className:"text-red-500 animate-spin"}):b.jsx(zh,{size:32,className:"text-red-500"})}),b.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),b.jsxs("p",{className:"text-slate-400 mb-8 text-sm leading-relaxed",children:["   ",b.jsxs("span",{className:"text-white font-bold",children:['"',y,'"']}),"    .      ."]}),b.jsxs("div",{className:"flex gap-3",children:[b.jsx(yt,{onClick:sm,variant:"danger",fullWidth:!0,className:"!py-3",disabled:P,children:P?b.jsx(Di,{size:18,className:"animate-spin"}):" "}),b.jsx(yt,{onClick:()=>D(!1),variant:"secondary",fullWidth:!0,className:"!py-3",disabled:P,children:""})]})]})]})]})]})},UG=s=>{switch(s){case"true_false":return{label:" / ",icon:b.jsx(ON,{size:12}),color:"bg-orange-500/10 text-orange-400 border-orange-500/20"};case"cloze":return{label:" ",icon:b.jsx($N,{size:12}),color:"bg-purple-500/10 text-purple-400 border-purple-500/20"};case"wh_question":return{label:" ",icon:b.jsx(SO,{size:12}),color:"bg-blue-500/10 text-blue-400 border-blue-500/20"};default:return{label:" ",icon:b.jsx(CU,{size:12}),color:"bg-slate-800/50 text-slate-300 border-slate-700/50"}}},FG=s=>/[\u0600-\u06FF]/.test(s),jG=({question:s,selectedOptionIndex:e,onSelectOption:t,showFeedback:n,language:i})=>{const a=UG(s.type),l=FG(s.question),c=l?"rtl":"ltr",d=l?"text-right":"text-left";return b.jsxs("div",{className:"w-full max-w-3xl mx-auto animate-fade-in-up",children:[b.jsxs("div",{className:"glass-panel bg-[#080808]/95 rounded-2xl p-5 md:p-6 relative overflow-hidden border border-white/5 shadow-xl",children:[b.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-2/3 h-0.5 bg-gradient-to-r from-transparent via-violet-500/30 to-transparent blur-sm"}),b.jsx("div",{className:"flex justify-start mb-4",dir:"rtl",children:b.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[10px] font-bold border ${a.color}`,children:[a.icon,b.jsx("span",{children:a.label})]})}),b.jsxs("div",{dir:c,children:[b.jsx("h2",{className:`text-[15px] sm:text-lg font-bold text-white leading-relaxed mb-6 ${d} drop-shadow-sm tracking-wide`,children:s.question}),b.jsx("div",{className:`grid grid-cols-1 ${s.options.length>2?"sm:grid-cols-2":""} gap-3`,children:s.options.map((h,p)=>{let y="border-white/5 bg-white/[0.02] hover:bg-white/[0.05] hover:border-violet-500/30",_=null,S="text-slate-300";return e===p&&(y="border-violet-500 bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.15)]",S="text-white font-semibold"),n&&(p===s.correctAnswerIndex?(y="border-emerald-500/50 bg-emerald-500/10",S="text-emerald-300 font-bold",_=b.jsx(g0,{className:`text-emerald-500 shrink-0 drop-shadow-[0_0_8px_rgba(16,185,129,0.5)] ${l?"mr-2":"ml-2"}`,size:16})):e===p&&p!==s.correctAnswerIndex?(y="border-red-500/50 bg-red-500/10",S="text-red-300 font-medium",_=b.jsx(TO,{className:`text-red-500 shrink-0 ${l?"mr-2":"ml-2"}`,size:16})):(y="border-transparent bg-black/20 opacity-40",S="text-slate-500")),b.jsxs("button",{onClick:()=>!n&&t(p),disabled:n,className:`group w-full ${d} p-3.5 rounded-xl border transition-all duration-200 flex ${l?"flex-row-reverse":"flex-row"} items-center justify-between gap-3 ${y}`,children:[b.jsxs("div",{className:`flex items-center gap-3 flex-1 ${l?"flex-row-reverse":"flex-row"}`,children:[b.jsx("div",{className:`shrink-0 w-7 h-7 rounded-md border flex items-center justify-center text-[10px] font-bold transition-all ${e===p?"border-violet-500 text-violet-300 bg-violet-500/20":"border-white/10 text-slate-500 bg-white/5 group-hover:border-violet-500/50 group-hover:text-violet-300"}`,children:String.fromCharCode(65+p)}),b.jsx("span",{className:`text-[13px] sm:text-sm leading-relaxed ${S}`,children:h})]}),_]},p)})})]})]}),n&&b.jsx("div",{className:`mt-4 bg-[#0A0A0A] border border-white/10 p-4 rounded-2xl shadow-lg animate-fade-in ${d}`,dir:c,children:b.jsxs("div",{className:`flex items-start gap-3 ${l?"flex-row-reverse":"flex-row"}`,children:[b.jsx("div",{className:"mt-0.5 text-emerald-400 shrink-0 p-1.5 bg-emerald-500/10 rounded-full",children:b.jsx(g0,{size:16})}),b.jsxs("div",{className:d,children:[b.jsx("p",{className:"font-bold text-sm mb-1 text-emerald-300",children:l?" ":"Explanation"}),b.jsx("p",{className:"text-slate-400 text-xs leading-relaxed",children:s.explanation})]})]})})]})},zG=({quiz:s,config:e,onFinish:t,onExit:n,isReview:i=!1})=>{const[a,l]=se.useState(0),[c,d]=se.useState(null),[h,p]=se.useState(i),[y,_]=se.useState(0),[S,A]=se.useState(!1),[E,N]=se.useState(null);se.useEffect(()=>{window.scrollTo(0,0)},[a]);const R=se.useMemo(()=>s.questions.length*60,[s.questions.length]),[D,P]=se.useState(R);se.useEffect(()=>{if(i)return;const J=setInterval(()=>{P(ie=>ie<=1?(clearInterval(J),t(y),0):ie-1)},1e3);return()=>clearInterval(J)},[y,t,i]);const L=J=>{const ie=Math.floor(J/60),pe=J%60;return`${ie}:${pe.toString().padStart(2,"0")}`},z=()=>{a<s.questions.length-1?(l(J=>J+1),d(null),p(i)):i?n():t(y)},H=()=>{a>0&&(l(J=>J-1),d(null),p(!0))},F=()=>{const J=s.questions[a];c===J.correctAnswerIndex?(_(ie=>ie+1),N("correct")):N("wrong"),p(!0),setTimeout(()=>{N(null)},1800)},X=s.questions[a],Y=D<60;return b.jsxs("div",{className:"min-h-screen pb-20 relative z-10 pt-24",children:[b.jsxs("div",{className:"fixed top-16 sm:top-20 left-0 right-0 z-40 bg-black/90 backdrop-blur-md border-b border-white/5",children:[b.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-3 flex justify-between items-center",children:[b.jsxs("div",{className:"text-lg font-black text-white",children:[b.jsx("span",{className:"text-violet-400",children:a+1})," / ",b.jsx("span",{className:"text-slate-500",children:s.questions.length})]}),b.jsxs("div",{className:"flex items-center gap-3",children:[i?b.jsx("div",{className:"px-3 py-1.5 rounded-xl font-bold bg-violet-600/10 text-violet-400 border border-violet-500/20 text-xs",children:" "}):b.jsxs("div",{className:`px-3 py-1.5 rounded-xl font-mono font-bold border ${Y?"bg-red-500/10 text-red-400 border-red-500/20":"bg-white/5 text-slate-300 border-white/5"}`,children:[b.jsx(NO,{size:16,className:"inline ml-1"})," ",L(D)]}),b.jsx("button",{onClick:()=>i?n():A(!0),className:"p-2 rounded-xl bg-red-500/10 text-red-400 border border-red-500/20 hover:bg-red-500/20 transition-all",children:b.jsx(Zp,{size:18})})]})]}),b.jsx("div",{className:"w-full h-1 bg-white/5",children:b.jsx("div",{className:"h-full bg-violet-600 transition-all duration-300",style:{width:`${(a+1)/s.questions.length*100}%`}})})]}),E&&b.jsx("div",{className:"fixed top-32 left-0 right-0 pointer-events-none z-50 flex justify-center px-4",children:b.jsxs("div",{className:`flex items-center gap-4 px-6 py-3 rounded-2xl border backdrop-blur-xl shadow-2xl animate-xp-drop ${E==="correct"?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400 shadow-emerald-500/20":"bg-red-500/10 border-red-500/30 text-red-400 shadow-red-500/20"}`,children:[b.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${E==="correct"?"bg-emerald-500 text-white":"bg-red-500 text-white"}`,children:E==="correct"?b.jsx(gc,{size:24,fill:"white"}):b.jsx(BO,{size:24})}),b.jsxs("div",{className:"flex flex-col text-right",children:[b.jsx("span",{className:"text-lg font-black leading-none",children:E==="correct"?"+50 XP":"0 XP"}),b.jsx("span",{className:"text-[10px] font-bold opacity-70 uppercase tracking-widest mt-1",children:E==="correct"?" !":" "})]}),E==="correct"&&b.jsx(da,{size:16,className:"animate-pulse text-yellow-400"})]})}),b.jsxs("div",{className:"max-w-3xl mx-auto px-4 pt-16",children:[b.jsx("div",{className:"animate-lux-scale",children:b.jsx(jG,{question:X,selectedOptionIndex:c,onSelectOption:d,showFeedback:h,language:e.language})}),b.jsx("div",{className:"mt-8 flex flex-col sm:flex-row justify-center gap-4",children:h?b.jsxs(b.Fragment,{children:[i&&a>0&&b.jsx(yt,{onClick:H,variant:"secondary",className:"flex-1 bg-white/5 text-white border-white/10",children:""}),b.jsx(yt,{onClick:z,variant:"secondary",className:`flex-1 ${i?"bg-violet-600 text-white":"bg-white text-black"} border-none shadow-xl`,children:a<s.questions.length-1?" ":i?" ":" "})]}):b.jsx(yt,{onClick:F,disabled:c===null,className:"w-full sm:w-2/3 shadow-xl",children:" "})})]}),S&&b.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[b.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>A(!1)}),b.jsxs("div",{className:"glass-panel w-full max-w-sm p-8 rounded-3xl text-center relative animate-lux-scale border border-white/10",children:[b.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:" "}),b.jsx("p",{className:"text-slate-400 mb-8 text-sm",children:"    ."}),b.jsxs("div",{className:"flex gap-3",children:[b.jsx(yt,{onClick:n,variant:"danger",fullWidth:!0,children:""}),b.jsx(yt,{onClick:()=>A(!1),variant:"secondary",fullWidth:!0,children:""})]})]})]}),b.jsx("style",{children:`
        @keyframes xpDrop {
          0% { opacity: 0; transform: translateY(-40px) scale(0.9); }
          15% { opacity: 1; transform: translateY(0) scale(1.05); }
          25% { transform: translateY(0) scale(1); }
          85% { opacity: 1; transform: translateY(0) scale(1); }
          100% { opacity: 0; transform: translateY(-20px) scale(0.95); }
        }
        .animate-xp-drop {
          animation: xpDrop 1.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        }
      `})]})},HG=({appState:s,onNavigate:e,onReset:t,onExamsClick:n,isVisible:i})=>{if(!i)return null;const a=s===he.EXAMS;return b.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-[60] animate-lux-up",children:b.jsx("div",{className:"bg-black border-t border-white/5 shadow-[0_-10px_40px_rgba(0,0,0,0.8)] pt-3 pb-6 px-2",children:b.jsxs("div",{className:"max-w-md mx-auto flex items-center justify-around relative",children:[b.jsxs("button",{onClick:()=>t(),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${s===he.HOME?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[b.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${s===he.HOME?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:b.jsx(ow,{size:20,strokeWidth:s===he.HOME?2.5:2})}),b.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${s===he.HOME?"text-violet-300":"text-slate-600"}`,children:""})]}),b.jsxs("button",{onClick:()=>e(he.SERVICES),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${s===he.SERVICES?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[b.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${s===he.SERVICES?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:b.jsx(JO,{size:20,strokeWidth:s===he.SERVICES?2.5:2})}),b.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${s===he.SERVICES?"text-violet-300":"text-slate-600"}`,children:""})]}),b.jsxs("button",{onClick:n,className:"flex flex-col items-center gap-1.5 flex-1 group",children:[b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:`absolute inset-0 bg-violet-600 blur-xl transition-opacity ${a?"opacity-40":"opacity-20 group-active:opacity-40"}`}),b.jsx("div",{className:`relative w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-700 rounded-xl flex items-center justify-center text-white shadow-lg border border-white/10 active:scale-90 transition-all ${a?"ring-2 ring-violet-400 ring-offset-2 ring-offset-black scale-110":""}`,children:b.jsx(Ud,{size:22,strokeWidth:3})})]}),b.jsx("span",{className:`text-[8px] font-black uppercase tracking-wider transition-colors ${a?"text-white":"text-violet-400"}`,children:""})]}),b.jsxs("button",{onClick:()=>e(he.DEVAI),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${s===he.DEVAI?"text-fuchsia-400":"text-slate-500 hover:text-slate-300"}`,children:[b.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${s===he.DEVAI?"bg-fuchsia-500/10 shadow-[0_0_15px_rgba(217,70,239,0.2)]":""}`,children:b.jsx(da,{size:20,strokeWidth:s===he.DEVAI?2.5:2})}),b.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${s===he.DEVAI?"text-fuchsia-300":"text-slate-600"}`,children:""})]}),b.jsxs("button",{onClick:()=>e(he.PROFILE),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${s===he.PROFILE?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[b.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${s===he.PROFILE?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:b.jsx(aw,{size:20,strokeWidth:s===he.PROFILE?2.5:2})}),b.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${s===he.PROFILE?"text-violet-300":"text-slate-600"}`,children:""})]})]})})})},BG=s=>{const e=s.toLowerCase();return e.includes("")||e.includes("")||e.includes("")?"https://images.unsplash.com/photo-1550751827-4bd374c3f58b?auto=format&fit=crop&q=80&w=800":e.includes("")||e.includes("")?"https://images.unsplash.com/photo-1635070041078-e363dbe005cb?auto=format&fit=crop&q=80&w=800":e.includes("")||e.includes("english")||e.includes("")?"https://images.unsplash.com/photo-1543167664-400296413346?auto=format&fit=crop&q=80&w=800":e.includes("")||e.includes("")?"https://images.unsplash.com/photo-1503676260728-1c00da094a0b?auto=format&fit=crop&q=80&w=800":e.includes("")||e.includes("")||e.includes("")?"https://images.unsplash.com/photo-1584285418504-0055d446979c?auto=format&fit=crop&q=80&w=800":"https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?auto=format&fit=crop&q=80&w=800"},GG=s=>{switch(s){case" ":return"https://images.unsplash.com/photo-1474932430478-367dbb6832c1?auto=format&fit=crop&q=80&w=800";case"":return"https://images.unsplash.com/photo-1456513080510-7bf3a84b82f8?auto=format&fit=crop&q=80&w=800";case" ":return"https://images.pexels.com/photos/7176036/pexels-photo-7176036.jpeg?auto=compress&cs=tinysrgb&w=800";case"  ":return"https://images.unsplash.com/photo-1589829545856-d10d557cf95f?auto=format&fit=crop&q=80&w=800";case" ":return"https://images.unsplash.com/photo-1509062522246-3755977927d7?auto=format&fit=crop&q=80&w=800";default:return"https://images.unsplash.com/photo-1516321318423-f06f85e504b3?auto=format&fit=crop&q=80&w=800"}},qG=({onNavigate:s,availableSubjects:e,loadingSubjects:t,onSubjectSelect:n})=>{const[i,a]=se.useState(null),[l,c]=se.useState(""),d=se.useMemo(()=>{const y=[];return Object.entries(b_).forEach(([_,S])=>{S.forEach(A=>y.push({name:A,college:_}))}),y},[]),h=se.useMemo(()=>e.filter(y=>{const _=!i||y.major===i,S=!l||y.subject.toLowerCase().includes(l.toLowerCase());return _&&S}),[e,i,l]),p=()=>{a(null),c("")};return b.jsxs("div",{className:"min-h-screen pt-24 pb-32 px-4 sm:px-8 relative z-10 animate-fade-in",dir:"rtl",children:[b.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden z-[-1]",children:[b.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[#030303]"}),b.jsx("div",{className:"absolute top-0 right-0 w-[80vw] h-[80vw] bg-violet-600/5 rounded-full blur-[140px]"})]}),b.jsx("div",{className:"max-w-7xl mx-auto",children:i?b.jsxs("div",{className:"animate-lux-up",children:[b.jsxs("div",{className:"mb-8 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[b.jsxs("div",{className:"space-y-3",children:[b.jsxs("button",{onClick:p,className:"flex items-center gap-2 text-[10px] font-black text-slate-500 hover:text-white transition-colors",children:[b.jsx(IN,{size:14,className:"rotate-180"}),"  "]}),b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"w-10 h-10 rounded-xl bg-violet-500/10 flex items-center justify-center text-violet-400 border border-violet-500/20",children:b.jsx(m0,{size:20})}),b.jsx("h2",{className:"text-xl sm:text-3xl font-black text-white truncate max-w-[250px] sm:max-w-none",children:i})]})]}),b.jsxs("div",{className:"relative w-full md:w-80 group",children:[b.jsx("div",{className:"absolute inset-0 bg-violet-600/10 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity"}),b.jsxs("div",{className:"relative flex items-center bg-[#0a0a0a]/80 backdrop-blur-xl border border-white/10 rounded-2xl px-5 py-3.5 focus-within:border-violet-500/50 transition-all",children:[b.jsx(OU,{className:"text-slate-600 ml-3",size:16}),b.jsx("input",{type:"text",value:l,onChange:y=>c(y.target.value),placeholder:"  ...",className:"bg-transparent border-none text-white text-xs font-bold w-full focus:outline-none placeholder:text-slate-800"})]})]})]}),t?b.jsxs("div",{className:"flex flex-col items-center justify-center p-24 space-y-4",children:[b.jsx(Di,{className:"animate-spin text-violet-500 w-10 h-10"}),b.jsx("p",{className:"text-slate-600 font-bold text-[10px] animate-pulse",children:"   ..."})]}):h.length===0?b.jsxs("div",{className:"text-center p-16 border border-dashed border-white/5 rounded-[2.5rem] bg-white/[0.01] flex flex-col items-center max-w-sm mx-auto animate-lux-up",children:[b.jsx("div",{className:"w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mb-4 text-slate-700",children:b.jsx(qO,{size:32})}),b.jsx("p",{className:"text-slate-500 font-black text-lg mb-2",children:"  !"}),b.jsx("p",{className:"text-[10px] text-slate-600 mb-8 leading-relaxed",children:"         ."}),b.jsx(yt,{onClick:p,variant:"outline",className:"!text-[10px]",children:" "})]}):b.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 animate-fade-in pb-20",children:h.map((y,_)=>b.jsxs("div",{onClick:()=>n(y.subject),className:"group relative cursor-pointer rounded-[2rem] overflow-hidden bg-[#0a0a0a] border border-white/5 hover:border-violet-500/40 transition-all duration-500 shadow-2xl h-72 flex flex-col",children:[b.jsxs("div",{className:"absolute inset-0 z-0",children:[b.jsx("img",{src:BG(y.subject),alt:y.subject,className:"w-full h-full object-cover opacity-60 group-hover:opacity-100 group-hover:scale-110 transition-all duration-700"}),b.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0a0a] via-[#0a0a0a]/40 to-transparent"})]}),b.jsxs("div",{className:"relative z-10 p-6 flex flex-col justify-end h-full",children:[b.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[b.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-600/30 backdrop-blur-md border border-white/20 flex items-center justify-center text-white group-hover:bg-violet-600 group-hover:scale-110 transition-all shadow-lg",children:b.jsx(m0,{size:16})}),b.jsx("div",{className:"bg-white/10 backdrop-blur-md px-2 py-1 rounded-md border border-white/20",children:b.jsx("span",{className:"text-[8px] font-black text-white uppercase tracking-widest",children:" "})})]}),b.jsx("h3",{className:"text-lg font-black text-white leading-tight mb-2 drop-shadow-lg group-hover:text-violet-300 transition-colors line-clamp-2",children:y.subject}),b.jsxs("div",{className:"flex items-center gap-1.5 text-[9px] font-bold text-slate-300 mb-4 drop-shadow-md",children:[b.jsx(Ud,{size:10}),b.jsx("span",{className:"truncate",children:y.major})]}),b.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-white/10 translate-y-4 opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-300",children:[b.jsxs("span",{className:"text-[10px] font-black text-violet-300 flex items-center gap-2 drop-shadow-md",children:["   ",b.jsx(Cu,{size:12})]}),b.jsx("div",{className:"flex -space-x-1.5",children:[1,2].map(S=>b.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-[#0a0a0a] bg-slate-800 flex items-center justify-center overflow-hidden",children:b.jsx("img",{src:`https://api.dicebear.com/9.x/notionists/svg?seed=${S*99}&backgroundColor=b6e3f4`,className:"w-full h-full"})},S))})]})]}),b.jsx("div",{className:"absolute top-4 left-4 z-20",children:b.jsxs("div",{className:"flex items-center gap-1 bg-black/60 backdrop-blur-xl border border-white/20 px-2 py-1 rounded-lg",children:[b.jsx(ev,{size:8,className:"text-yellow-400 fill-yellow-400"}),b.jsx("span",{className:"text-[8px] font-black text-white",children:"4.9"})]})})]},_))})]}):b.jsxs("div",{className:"animate-lux-up",children:[b.jsxs("div",{className:"text-center mb-10 space-y-3 px-4",children:[b.jsxs("div",{className:"inline-flex items-center gap-2 text-violet-400 font-black text-[9px] uppercase tracking-[0.4em] mb-1 bg-violet-500/10 px-4 py-1.5 rounded-full border border-violet-500/20",children:[b.jsx(da,{size:12}),"  "]}),b.jsxs("h1",{className:"text-4xl sm:text-6xl font-black text-white leading-tight tracking-tight",children:[" ",b.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-400 to-white",children:""})]}),b.jsx("p",{className:"text-slate-500 text-xs font-medium max-w-xs mx-auto",children:"      ."})]}),b.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 sm:gap-4 mb-20",children:d.map((y,_)=>b.jsxs("div",{onClick:()=>a(y.name),className:"group relative cursor-pointer aspect-[3/4] rounded-[1.8rem] overflow-hidden bg-[#0a0a0a] border border-white/10 active:scale-95 transition-all duration-300 shadow-2xl flex flex-col justify-end p-4 sm:p-5",children:[b.jsx("img",{src:GG(y.name),alt:y.name,className:"absolute inset-0 w-full h-full object-cover opacity-100 group-hover:scale-110 transition-all duration-700"}),b.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/30 to-transparent"}),b.jsxs("div",{className:"relative z-10",children:[b.jsx("h3",{className:"text-[13px] sm:text-sm font-black text-white mb-1.5 leading-tight drop-shadow-md",children:y.name}),b.jsxs("div",{className:"flex items-center gap-1 opacity-100 transition-opacity",children:[b.jsx(QO,{size:10,className:"text-violet-400 drop-shadow-md"}),b.jsx("span",{className:"text-[8px] font-black text-white/90 uppercase tracking-widest truncate drop-shadow-md",children:y.college.split(" ")[1]})]})]}),b.jsx("div",{className:"absolute top-3 right-3 w-6 h-6 rounded-full bg-white/20 backdrop-blur-md border border-white/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all",children:b.jsx(Cu,{size:12,className:"text-white rotate-180"})})]},_))})]})})]})},VG=Wp.memo(({appState:s,user:e,onReset:t,onNavigate:n,onAuthOpen:i,onLogout:a,onProfile:l,isMobileMenuOpen:c,setIsMobileMenuOpen:d})=>{var y,_;const h=s===he.QUIZ||s===he.PROCESSING||s===he.RESULT,p=((y=e==null?void 0:e.user_metadata)==null?void 0:y.role)==="admin";return b.jsxs("nav",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${h?"bg-black/95":"bg-black/80"} backdrop-blur-xl border-b border-white/5 animate-lux-up w-full`,children:[b.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 h-16 sm:h-20 flex items-center justify-between",children:[b.jsxs("div",{className:`flex items-center gap-3 sm:gap-5 group ${h?"cursor-default":"cursor-pointer"}`,onClick:()=>!h&&t(),children:[b.jsx("div",{className:"relative",children:b.jsx("div",{className:"relative w-10 h-10 sm:w-14 sm:h-14 bg-gradient-to-br from-violet-600 to-fuchsia-600 rounded-xl sm:rounded-2xl flex items-center justify-center shadow-2xl transition-transform group-hover:rotate-12",children:p?b.jsx(w_,{className:"text-white w-6 h-6 sm:w-8 sm:h-8"}):b.jsx(Ud,{className:"text-white w-6 h-6 sm:w-8 sm:h-8"})})}),b.jsxs("div",{className:"flex flex-col",children:[b.jsx("span",{className:"text-2xl sm:text-4xl font-black text-white tracking-tighter leading-none",children:""}),b.jsx("span",{className:"text-[7px] sm:text-[9px] text-violet-400 font-black tracking-[0.4em] hidden sm:block uppercase",children:"PREMIUM PLATFORM"})]})]}),!h&&b.jsxs("div",{className:"hidden lg:flex flex-1 items-center justify-center gap-10 text-xs font-black uppercase tracking-widest text-slate-500",children:[b.jsx("button",{onClick:()=>t(),className:`hover:text-white transition-colors relative py-2 ${s===he.HOME?"text-white":""}`,children:""}),b.jsx("button",{onClick:()=>n(he.EXAMS),className:`hover:text-white transition-colors relative py-2 ${s===he.EXAMS?"text-white":""}`,children:""}),b.jsx("button",{onClick:()=>n(he.SERVICES),className:`hover:text-white transition-colors relative py-2 ${s===he.SERVICES?"text-white":""}`,children:""}),b.jsx("button",{onClick:()=>n(he.DEVAI),className:`hover:text-white transition-colors relative py-2 ${s===he.DEVAI?"text-white":""}`,children:""}),b.jsx("button",{onClick:()=>n(he.ABOUT),className:`hover:text-white transition-colors relative py-2 ${s===he.ABOUT?"text-white":""}`,children:""})]}),b.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:!h&&e?b.jsx("div",{className:"hidden md:flex items-center gap-3",children:b.jsxs("button",{onClick:l,className:`flex items-center gap-2 px-4 py-2 rounded-xl border transition-all ${s===he.PROFILE?p?"bg-emerald-500 text-black border-emerald-600 font-bold":"bg-amber-400 text-slate-900 border-amber-500 font-bold":"bg-white/5 text-slate-300 border-white/10 hover:bg-white/10 hover:text-white"}`,children:[p?b.jsx(w_,{size:16}):b.jsx(aw,{size:16}),b.jsx("span",{className:"text-xs font-black",children:((_=e.user_metadata)==null?void 0:_.full_name)||""})]})}):!h&&b.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[b.jsx("button",{onClick:i,className:"text-white hover:text-violet-300 transition-colors font-black text-xs uppercase tracking-wider",children:""}),b.jsx("button",{onClick:i,className:"px-6 py-2.5 rounded-full bg-white text-black font-black text-[10px] hover:bg-slate-200 transition-all shadow-[0_0_15px_rgba(255,255,255,0.2)]",children:" "})]})}),!h&&b.jsx("button",{className:"lg:hidden p-2 text-slate-300 hover:bg-white/10 rounded-lg",onClick:()=>d(!c),children:c?b.jsx(Zp,{size:24}):b.jsx(mU,{size:24})})]}),c&&!h&&b.jsxs("div",{className:"md:hidden absolute top-16 sm:top-20 left-0 right-0 bg-black border-b border-white/10 p-8 flex flex-col gap-6 animate-lux-up shadow-2xl z-[100]",children:[b.jsx("button",{onClick:()=>{t(),d(!1)},className:"text-right font-black text-slate-300 hover:text-white text-lg",children:""}),b.jsx("button",{onClick:()=>{n(he.EXAMS),d(!1)},className:"text-right font-black text-slate-300 hover:text-white text-lg",children:""}),b.jsx("button",{onClick:()=>{n(he.SERVICES),d(!1)},className:"text-right font-black text-slate-300 hover:text-white text-lg",children:""}),b.jsx("button",{onClick:()=>{n(he.DEVAI),d(!1)},className:"text-right font-black text-slate-300 hover:text-white text-lg",children:""}),b.jsx("button",{onClick:()=>{n(he.ABOUT),d(!1)},className:"text-right font-black text-slate-300 hover:text-white text-lg",children:""}),e?b.jsx("button",{onClick:()=>{a(),d(!1)},className:"text-right font-black text-red-400 text-lg border-t border-white/5 pt-4",children:" "}):b.jsx("button",{onClick:()=>{i(),d(!1)},className:"text-right font-black text-violet-300 text-lg border-t border-white/5 pt-4",children:" "})]})]})});function $G(){var re;const[s,e]=se.useState(he.HOME),[t,n]=se.useState(null),[i,a]=se.useState(0),[l,c]=se.useState(""),[d,h]=se.useState(!1),[p,y]=se.useState(null),[_,S]=se.useState(!1),[A,E]=se.useState([]),[N,R]=se.useState(!1),[D,P]=se.useState(null),[L,z]=se.useState([]),[H,F]=se.useState(!0),[X,Y]=se.useState({language:"ar",questionCount:15,selectedSubject:"",examType:"midterm"}),[J,ie]=se.useState(!1),[pe,ye]=se.useState(!1),be=((re=p==null?void 0:p.user_metadata)==null?void 0:re.role)==="admin",Se=se.useCallback(ne=>{if(window.scrollTo({top:0,left:0,behavior:"auto"}),ne!==s){if(ne===he.PROFILE&&!p){P(he.PROFILE),S(!0);return}window.history.pushState({appState:ne},""),e(ne),ye(!1)}},[s,p]);se.useEffect(()=>{const ne=fe=>{window.scrollTo({top:0,left:0,behavior:"auto"}),fe.state&&fe.state.appState?e(fe.state.appState):e(he.HOME)};return window.addEventListener("popstate",ne),window.history.replaceState({appState:he.HOME},""),()=>window.removeEventListener("popstate",ne)},[]),se.useEffect(()=>{(async()=>{const{data:{session:fe}}=await Ht.auth.getSession();if(fe!=null&&fe.user)y(fe.user),j(fe.user.id,!1);else{const ge=localStorage.getItem("guest_user");if(ge){const de=JSON.parse(ge);y(de),j(de.id,!0)}}})()},[]),se.useEffect(()=>{(async()=>{F(!0);const fe=await Fk();z(fe),F(!1)})()},[s]);const j=async(ne,fe)=>{if(fe)E(JSON.parse(localStorage.getItem("guest_history")||"[]"));else{const{data:ge,error:de}=await Ht.from("quiz_history").select("*").eq("user_id",ne).order("created_at",{ascending:!1});ge&&!de&&E(ge)}},G=async()=>{R(!0),h(!1),setTimeout(async()=>{var ne;((ne=p==null?void 0:p.app_metadata)==null?void 0:ne.provider)==="guest"?localStorage.removeItem("guest_user"):await Ht.auth.signOut(),y(null),E([]),Se(he.HOME),R(!1)},1e3)},ae=async(ne,fe)=>{var ot,Ze,jn,zi,hr,Gs;if(!p)return;const ge=((ot=p.app_metadata)==null?void 0:ot.provider)==="guest",de={user_id:p.id,quiz_title:X.selectedSubject,score:ne,total_questions:fe,player_name:((Ze=p.user_metadata)==null?void 0:Ze.full_name)||" ",player_avatar:((jn=p.user_metadata)==null?void 0:jn.avatar)||"Felix",player_university:(zi=p.user_metadata)==null?void 0:zi.university,player_major:(hr=p.user_metadata)==null?void 0:hr.major,player_age:(Gs=p.user_metadata)==null?void 0:Gs.age,created_at:new Date().toISOString()};if(ge){const Zn=JSON.parse(localStorage.getItem("guest_history")||"[]");localStorage.setItem("guest_history",JSON.stringify([de,...Zn])),j(p.id,!0)}else await Ht.from("quiz_history").insert([de]),j(p.id,!1)},we=async()=>{ie(!1),e(he.PROCESSING),window.scrollTo(0,0);try{const ne=await MG(X.selectedSubject,X.questionCount,X.examType);n({title:`: ${X.selectedSubject}`,questions:ne}),e(he.QUIZ)}catch(ne){c(ne.message||" "),e(he.ERROR)}},Ne=()=>{window.scrollTo(0,0),Se(he.HOME),n(null),a(0),c(""),h(!1),ie(!1),ye(!1)},U=t?Math.round(i/t.questions.length*100):0,Q=i*50;return b.jsxs("div",{className:"min-h-screen text-slate-100 font-sans selection:bg-violet-500/30 overflow-x-hidden w-full relative bg-black",dir:"rtl",children:[b.jsx(VG,{appState:s,user:p,onReset:Ne,onNavigate:Se,onAuthOpen:()=>S(!0),onLogout:G,onProfile:()=>Se(he.PROFILE),isMobileMenuOpen:d,setIsMobileMenuOpen:h}),b.jsxs("main",{className:"w-full relative flex flex-col bg-black",children:[s===he.HOME&&b.jsxs("div",{className:"pt-32 sm:pt-48 pb-24 relative z-10 flex flex-col items-center min-h-screen animate-lux-up overflow-hidden w-full bg-black",children:[b.jsxs("div",{className:"stars-container-home",children:[b.jsx("div",{className:"stars-layer stars-small"}),b.jsx("div",{className:"stars-layer stars-medium"}),b.jsx("div",{className:"stars-layer stars-large"})]}),b.jsx("div",{className:"absolute top-1/4 left-1/2 -translate-x-1/2 w-[100vw] h-[50vh] bg-violet-600/10 blur-[150px] rounded-full pointer-events-none"}),b.jsxs("div",{className:"max-w-5xl w-full px-6 text-center mb-16 sm:mb-28 relative z-10",children:[b.jsxs("h1",{className:"text-5xl sm:text-8xl md:text-[10rem] font-black text-white leading-tight tracking-tighter mb-10 drop-shadow-[0_0_30px_rgba(255,255,255,0.1)]",children:[" ",b.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-400 to-white",children:""})," ",b.jsx("br",{})," "]}),b.jsxs("div",{className:"space-y-4 max-w-4xl mx-auto mb-12",children:[b.jsxs("p",{className:"text-slate-400 text-lg sm:text-2xl leading-relaxed font-medium",children:[" ",b.jsx("span",{className:"text-white font-bold italic",children:""}),":    .             ",b.jsx("span",{className:"text-violet-400 font-black",children:"  "}),"."]}),b.jsxs("p",{className:"text-white text-base sm:text-xl leading-relaxed font-black opacity-90 tracking-wide",children:["  ",b.jsx("span",{className:"text-fuchsia-400 underline decoration-fuchsia-600 underline-offset-4",children:"  "})]})]}),b.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-5 w-full max-w-xl mx-auto",children:[b.jsxs("button",{onClick:()=>Se(he.EXAMS),className:"group relative w-full sm:flex-1 px-10 py-5 bg-gradient-to-r from-violet-600 to-fuchsia-600 rounded-[2rem] flex items-center justify-center gap-3 transition-all active:scale-95 shadow-[0_0_40px_rgba(139,92,246,0.5)] overflow-hidden",children:[b.jsx("div",{className:"absolute inset-0 bg-white/10 opacity-0 group-hover:opacity-100 transition-opacity"}),b.jsx(da,{size:22,className:"text-white/80"}),b.jsx("span",{className:"font-black text-white text-lg sm:text-xl",children:" "})]}),b.jsx("button",{onClick:()=>Se(he.ABOUT),className:"w-full sm:w-auto px-10 py-5 bg-[#0a0a0a] rounded-[2rem] border border-white/10 flex items-center justify-center gap-2 font-black text-slate-200 active:scale-95 hover:bg-white/5 transition-all text-lg sm:text-xl",children:" "})]})]}),b.jsx(r5,{}),b.jsx(a5,{})]}),s===he.EXAMS&&b.jsx(qG,{onNavigate:Se,availableSubjects:L,loadingSubjects:H,onSubjectSelect:ne=>{Y({...X,selectedSubject:ne}),ie(!0)}}),s===he.SERVICES&&b.jsx(o5,{onNavigate:Se}),s===he.DEVAI&&b.jsx(l5,{onNavigate:Se}),s===he.ABOUT&&b.jsx(u5,{onNavigate:Se}),s===he.PROFILE&&(be?b.jsx(OG,{user:p,onLogout:G,onNavigate:Se}):b.jsx(d5,{user:p,quizHistory:A,onLogout:G,onSaveProfile:async ne=>{var ge;if(((ge=p.app_metadata)==null?void 0:ge.provider)==="guest"){const de={...p,user_metadata:ne};localStorage.setItem("guest_user",JSON.stringify(de)),y(de)}else{const{data:de}=await Ht.auth.updateUser({data:ne});de.user&&y(de.user)}},onNavigate:Se})),s===he.QUIZ&&t&&b.jsx(zG,{quiz:t,config:X,onFinish:ne=>{a(ne),ae(ne,t.questions.length),e(he.RESULT)},onExit:Ne,isReview:pe}),s===he.PROCESSING&&b.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen animate-lux-scale w-full bg-black",children:[b.jsx(Di,{className:"w-16 h-16 text-violet-500 animate-spin mb-8"}),b.jsx("h2",{className:"text-2xl font-black text-white",children:" ..."})]}),s===he.RESULT&&b.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 animate-lux-up w-full bg-black relative overflow-hidden",children:[b.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-violet-900/10 via-black to-black"}),b.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[80vw] h-[80vw] bg-violet-600/5 blur-[120px] rounded-full"}),b.jsxs("div",{className:"glass-panel relative z-10 p-10 rounded-[3rem] text-center max-w-md w-full border border-white/10 shadow-[0_0_60px_rgba(0,0,0,0.8)]",children:[b.jsxs("div",{className:"relative mb-8",children:[b.jsx("div",{className:"w-24 h-24 bg-yellow-500/10 rounded-full flex items-center justify-center mx-auto border border-yellow-500/20 shadow-[0_0_30px_rgba(234,179,8,0.2)]",children:b.jsx(v0,{size:48,className:"text-yellow-400 animate-bounce"})}),U>=90&&b.jsx(da,{className:"absolute top-0 right-1/4 text-fuchsia-400 animate-pulse"})]}),b.jsx("h2",{className:"text-2xl font-black text-white mb-2",children:" !"}),b.jsx("p",{className:"text-slate-500 text-sm font-bold mb-8",children:X.selectedSubject}),b.jsxs("div",{className:"flex justify-center items-center gap-10 mb-10",children:[b.jsxs("div",{className:"flex flex-col items-center",children:[b.jsxs("span",{className:"text-5xl font-black text-white",children:[U,"%"]}),b.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-1",children:""})]}),b.jsx("div",{className:"w-px h-12 bg-white/5"}),b.jsxs("div",{className:"flex flex-col items-center",children:[b.jsxs("div",{className:"flex items-center gap-1.5 text-emerald-400",children:[b.jsx(gc,{size:20,fill:"currentColor"}),b.jsxs("span",{className:"text-4xl font-black",children:["+",Q]})]}),b.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-1",children:" "})]})]}),b.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-10",children:[b.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5",children:[b.jsx("p",{className:"text-lg font-black text-white",children:i}),b.jsx("p",{className:"text-[9px] font-bold text-slate-500 uppercase",children:""})]}),b.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5",children:[b.jsx("p",{className:"text-lg font-black text-white",children:t.questions.length-i}),b.jsx("p",{className:"text-[9px] font-bold text-slate-500 uppercase",children:""})]})]}),b.jsxs("div",{className:"space-y-3",children:[b.jsxs(yt,{onClick:()=>{ye(!0),e(he.QUIZ)},variant:"secondary",fullWidth:!0,className:"!py-4 !bg-white/5 border-white/10 hover:!bg-white/10",children:[b.jsx(LN,{size:18}),"  "]}),b.jsxs(yt,{onClick:()=>Se(he.EXAMS),fullWidth:!0,className:"!py-4 !bg-gradient-to-r !from-violet-600 !to-fuchsia-600 shadow-xl",children:[b.jsx(DU,{size:18}),"  "]}),b.jsx("button",{onClick:Ne,className:"w-full py-3 text-slate-500 font-black text-xs hover:text-white transition-colors",children:" "})]})]})]})]}),b.jsx(HG,{appState:s,onNavigate:Se,onReset:Ne,onExamsClick:()=>Se(he.EXAMS),isVisible:s!==he.QUIZ&&s!==he.PROCESSING&&s!==he.RESULT}),b.jsx(s5,{isOpen:_,onClose:()=>S(!1),onSuccess:ne=>{var fe;y(ne),j(ne.id,((fe=ne.app_metadata)==null?void 0:fe.provider)==="guest"),D&&(Se(D),P(null))}}),J&&b.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[b.jsx("div",{className:"absolute inset-0 bg-black/85 backdrop-blur-lg",onClick:()=>ie(!1)}),b.jsxs("div",{className:"glass-panel w-full max-w-md bg-[#050505] rounded-[2.5rem] p-8 relative animate-lux-scale border border-white/10 shadow-[0_0_40px_rgba(0,0,0,0.5)]",children:[b.jsx("button",{onClick:()=>ie(!1),className:"absolute top-6 left-6 p-2 rounded-full bg-red-500/10 text-red-500 border border-red-500/20 hover:bg-red-500/20 transition-all active:scale-90",children:b.jsx(Zp,{size:20})}),b.jsx("h3",{className:"text-2xl font-black text-white mb-6 text-center",children:" "}),b.jsxs("div",{className:"space-y-6",children:[b.jsx("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:b.jsx("p",{className:"text-lg font-black text-white text-center",children:X.selectedSubject})}),b.jsxs("div",{className:"relative",children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2 mr-1",children:" "}),b.jsxs("div",{className:"relative group",children:[b.jsxs("select",{value:X.examType,onChange:ne=>Y({...X,examType:ne.target.value}),className:"w-full bg-[#0a0a0a] border border-white/10 rounded-xl p-3.5 text-white font-bold outline-none appearance-none hover:border-violet-500/50 transition-all cursor-pointer",children:[b.jsx("option",{value:"midterm",children:" (Midterm)"}),b.jsx("option",{value:"final",children:" (Final)"})]}),b.jsx(Kh,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2 mr-1",children:" "}),b.jsx("div",{className:"grid grid-cols-3 gap-3",children:[5,15,30].map(ne=>b.jsx("button",{onClick:()=>Y({...X,questionCount:ne}),className:`py-3 rounded-xl font-black border transition-all ${X.questionCount===ne?"bg-violet-600 border-violet-500 text-white":"bg-[#0a0a0a] border-white/10 text-slate-500"}`,children:ne},ne))})]}),b.jsx(yt,{onClick:we,fullWidth:!0,className:"!py-4 !bg-gradient-to-r !from-emerald-600 !to-emerald-500 shadow-xl font-black text-lg",children:" "})]})]})]})]})}const jk=document.getElementById("root");if(!jk)throw new Error("Could not find root element to mount to");const YG=pD.createRoot(jk);YG.render(b.jsx(Wp.StrictMode,{children:b.jsx($G,{})}));const o_=document.getElementById("splash-screen");o_&&setTimeout(()=>{o_.classList.add("hidden"),setTimeout(()=>{o_.remove()},600)},1200);

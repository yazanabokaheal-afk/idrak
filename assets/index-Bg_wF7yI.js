var SD=Object.defineProperty;var D1=s=>{throw TypeError(s)};var AD=(s,e,t)=>e in s?SD(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Me=(s,e,t)=>AD(s,typeof e!="symbol"?e+"":e,t),kb=(s,e,t)=>e.has(s)||D1("Cannot "+t);var m=(s,e,t)=>(kb(s,e,"read from private field"),t?t.call(s):e.get(s)),k=(s,e,t)=>e.has(s)?D1("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),C=(s,e,t,n)=>(kb(s,e,"write to private field"),n?n.call(s,t):e.set(s,t),t),M=(s,e,t)=>(kb(s,e,"access private method"),t);var Hn=(s,e,t,n)=>({set _(i){C(s,e,i,t)},get _(){return m(s,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function Wx(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function ED(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var e=s.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var i=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return s[n]}})}),t}var Mb={exports:{}},zh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P1;function TD(){if(P1)return zh;P1=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:s,type:n,key:l,ref:i!==void 0?i:null,props:a}}return zh.Fragment=e,zh.jsx=t,zh.jsxs=t,zh}var L1;function CD(){return L1||(L1=1,Mb.exports=TD()),Mb.exports}var b=CD(),Ib={exports:{}},Fe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O1;function ND(){if(O1)return Fe;O1=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),x=Symbol.iterator;function S(O){return O===null||typeof O!="object"?null:(O=x&&O[x]||O["@@iterator"],typeof O=="function"?O:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,N={};function R(O,$,se){this.props=O,this.context=$,this.refs=N,this.updater=se||A}R.prototype.isReactComponent={},R.prototype.setState=function(O,$){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,$,"setState")},R.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function D(){}D.prototype=R.prototype;function P(O,$,se){this.props=O,this.context=$,this.refs=N,this.updater=se||A}var L=P.prototype=new D;L.constructor=P,E(L,R.prototype),L.isPureReactComponent=!0;var H=Array.isArray;function z(){}var U={H:null,A:null,T:null,S:null},J=Object.prototype.hasOwnProperty;function K(O,$,se){var ce=se.ref;return{$$typeof:s,type:O,key:$,ref:ce!==void 0?ce:null,props:se}}function ie(O,$){return K(O.type,$,O.props)}function oe(O){return typeof O=="object"&&O!==null&&O.$$typeof===s}function ne(O){var $={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(se){return $[se]})}var ve=/\/+/g;function de(O,$){return typeof O=="object"&&O!==null&&O.key!=null?ne(""+O.key):$.toString(36)}function Re(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(z,z):(O.status="pending",O.then(function($){O.status==="pending"&&(O.status="fulfilled",O.value=$)},function($){O.status==="pending"&&(O.status="rejected",O.reason=$)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function j(O,$,se,ce,Ce){var re=typeof O;(re==="undefined"||re==="boolean")&&(O=null);var le=!1;if(O===null)le=!0;else switch(re){case"bigint":case"string":case"number":le=!0;break;case"object":switch(O.$$typeof){case s:case e:le=!0;break;case p:return le=O._init,j(le(O._payload),$,se,ce,Ce)}}if(le)return Ce=Ce(O),le=ce===""?"."+de(O,0):ce,H(Ce)?(se="",le!=null&&(se=le.replace(ve,"$&/")+"/"),j(Ce,$,se,"",function(Bt){return Bt})):Ce!=null&&(oe(Ce)&&(Ce=ie(Ce,se+(Ce.key==null||O&&O.key===Ce.key?"":(""+Ce.key).replace(ve,"$&/")+"/")+le)),$.push(Ce)),1;le=0;var ze=ce===""?".":ce+":";if(H(O))for(var Le=0;Le<O.length;Le++)ce=O[Le],re=ze+de(ce,Le),le+=j(ce,$,se,re,Ce);else if(Le=S(O),typeof Le=="function")for(O=Le.call(O),Le=0;!(ce=O.next()).done;)ce=ce.value,re=ze+de(ce,Le++),le+=j(ce,$,se,re,Ce);else if(re==="object"){if(typeof O.then=="function")return j(Re(O),$,se,ce,Ce);throw $=String(O),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return le}function X(O,$,se){if(O==null)return O;var ce=[],Ce=0;return j(O,ce,"","",function(re){return $.call(se,re,Ce++)}),ce}function me(O){if(O._status===-1){var $=O._result;$=$(),$.then(function(se){(O._status===0||O._status===-1)&&(O._status=1,O._result=se)},function(se){(O._status===0||O._status===-1)&&(O._status=2,O._result=se)}),O._status===-1&&(O._status=0,O._result=$)}if(O._status===1)return O._result.default;throw O._result}var ee=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},ue={map:X,forEach:function(O,$,se){X(O,function(){$.apply(this,arguments)},se)},count:function(O){var $=0;return X(O,function(){$++}),$},toArray:function(O){return X(O,function($){return $})||[]},only:function(O){if(!oe(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return Fe.Activity=v,Fe.Children=ue,Fe.Component=R,Fe.Fragment=t,Fe.Profiler=i,Fe.PureComponent=P,Fe.StrictMode=n,Fe.Suspense=d,Fe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,Fe.__COMPILER_RUNTIME={__proto__:null,c:function(O){return U.H.useMemoCache(O)}},Fe.cache=function(O){return function(){return O.apply(null,arguments)}},Fe.cacheSignal=function(){return null},Fe.cloneElement=function(O,$,se){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var ce=E({},O.props),Ce=O.key;if($!=null)for(re in $.key!==void 0&&(Ce=""+$.key),$)!J.call($,re)||re==="key"||re==="__self"||re==="__source"||re==="ref"&&$.ref===void 0||(ce[re]=$[re]);var re=arguments.length-2;if(re===1)ce.children=se;else if(1<re){for(var le=Array(re),ze=0;ze<re;ze++)le[ze]=arguments[ze+2];ce.children=le}return K(O.type,Ce,ce)},Fe.createContext=function(O){return O={$$typeof:l,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:a,_context:O},O},Fe.createElement=function(O,$,se){var ce,Ce={},re=null;if($!=null)for(ce in $.key!==void 0&&(re=""+$.key),$)J.call($,ce)&&ce!=="key"&&ce!=="__self"&&ce!=="__source"&&(Ce[ce]=$[ce]);var le=arguments.length-2;if(le===1)Ce.children=se;else if(1<le){for(var ze=Array(le),Le=0;Le<le;Le++)ze[Le]=arguments[Le+2];Ce.children=ze}if(O&&O.defaultProps)for(ce in le=O.defaultProps,le)Ce[ce]===void 0&&(Ce[ce]=le[ce]);return K(O,re,Ce)},Fe.createRef=function(){return{current:null}},Fe.forwardRef=function(O){return{$$typeof:c,render:O}},Fe.isValidElement=oe,Fe.lazy=function(O){return{$$typeof:p,_payload:{_status:-1,_result:O},_init:me}},Fe.memo=function(O,$){return{$$typeof:h,type:O,compare:$===void 0?null:$}},Fe.startTransition=function(O){var $=U.T,se={};U.T=se;try{var ce=O(),Ce=U.S;Ce!==null&&Ce(se,ce),typeof ce=="object"&&ce!==null&&typeof ce.then=="function"&&ce.then(z,ee)}catch(re){ee(re)}finally{$!==null&&se.types!==null&&($.types=se.types),U.T=$}},Fe.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},Fe.use=function(O){return U.H.use(O)},Fe.useActionState=function(O,$,se){return U.H.useActionState(O,$,se)},Fe.useCallback=function(O,$){return U.H.useCallback(O,$)},Fe.useContext=function(O){return U.H.useContext(O)},Fe.useDebugValue=function(){},Fe.useDeferredValue=function(O,$){return U.H.useDeferredValue(O,$)},Fe.useEffect=function(O,$){return U.H.useEffect(O,$)},Fe.useEffectEvent=function(O){return U.H.useEffectEvent(O)},Fe.useId=function(){return U.H.useId()},Fe.useImperativeHandle=function(O,$,se){return U.H.useImperativeHandle(O,$,se)},Fe.useInsertionEffect=function(O,$){return U.H.useInsertionEffect(O,$)},Fe.useLayoutEffect=function(O,$){return U.H.useLayoutEffect(O,$)},Fe.useMemo=function(O,$){return U.H.useMemo(O,$)},Fe.useOptimistic=function(O,$){return U.H.useOptimistic(O,$)},Fe.useReducer=function(O,$,se){return U.H.useReducer(O,$,se)},Fe.useRef=function(O){return U.H.useRef(O)},Fe.useState=function(O){return U.H.useState(O)},Fe.useSyncExternalStore=function(O,$,se){return U.H.useSyncExternalStore(O,$,se)},Fe.useTransition=function(){return U.H.useTransition()},Fe.version="19.2.3",Fe}var U1;function Qx(){return U1||(U1=1,Ib.exports=ND()),Ib.exports}var ae=Qx();const Hd=Wx(ae);var Db={exports:{}},jh={},Pb={exports:{}},Lb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F1;function RD(){return F1||(F1=1,(function(s){function e(j,X){var me=j.length;j.push(X);e:for(;0<me;){var ee=me-1>>>1,ue=j[ee];if(0<i(ue,X))j[ee]=X,j[me]=ue,me=ee;else break e}}function t(j){return j.length===0?null:j[0]}function n(j){if(j.length===0)return null;var X=j[0],me=j.pop();if(me!==X){j[0]=me;e:for(var ee=0,ue=j.length,O=ue>>>1;ee<O;){var $=2*(ee+1)-1,se=j[$],ce=$+1,Ce=j[ce];if(0>i(se,me))ce<ue&&0>i(Ce,se)?(j[ee]=Ce,j[ce]=me,ee=ce):(j[ee]=se,j[$]=me,ee=$);else if(ce<ue&&0>i(Ce,me))j[ee]=Ce,j[ce]=me,ee=ce;else break e}}return X}function i(j,X){var me=j.sortIndex-X.sortIndex;return me!==0?me:j.id-X.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;s.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();s.unstable_now=function(){return l.now()-c}}var d=[],h=[],p=1,v=null,x=3,S=!1,A=!1,E=!1,N=!1,R=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function L(j){for(var X=t(h);X!==null;){if(X.callback===null)n(h);else if(X.startTime<=j)n(h),X.sortIndex=X.expirationTime,e(d,X);else break;X=t(h)}}function H(j){if(E=!1,L(j),!A)if(t(d)!==null)A=!0,z||(z=!0,ne());else{var X=t(h);X!==null&&Re(H,X.startTime-j)}}var z=!1,U=-1,J=5,K=-1;function ie(){return N?!0:!(s.unstable_now()-K<J)}function oe(){if(N=!1,z){var j=s.unstable_now();K=j;var X=!0;try{e:{A=!1,E&&(E=!1,D(U),U=-1),S=!0;var me=x;try{t:{for(L(j),v=t(d);v!==null&&!(v.expirationTime>j&&ie());){var ee=v.callback;if(typeof ee=="function"){v.callback=null,x=v.priorityLevel;var ue=ee(v.expirationTime<=j);if(j=s.unstable_now(),typeof ue=="function"){v.callback=ue,L(j),X=!0;break t}v===t(d)&&n(d),L(j)}else n(d);v=t(d)}if(v!==null)X=!0;else{var O=t(h);O!==null&&Re(H,O.startTime-j),X=!1}}break e}finally{v=null,x=me,S=!1}X=void 0}}finally{X?ne():z=!1}}}var ne;if(typeof P=="function")ne=function(){P(oe)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,de=ve.port2;ve.port1.onmessage=oe,ne=function(){de.postMessage(null)}}else ne=function(){R(oe,0)};function Re(j,X){U=R(function(){j(s.unstable_now())},X)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(j){j.callback=null},s.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<j?Math.floor(1e3/j):5},s.unstable_getCurrentPriorityLevel=function(){return x},s.unstable_next=function(j){switch(x){case 1:case 2:case 3:var X=3;break;default:X=x}var me=x;x=X;try{return j()}finally{x=me}},s.unstable_requestPaint=function(){N=!0},s.unstable_runWithPriority=function(j,X){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var me=x;x=j;try{return X()}finally{x=me}},s.unstable_scheduleCallback=function(j,X,me){var ee=s.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?ee+me:ee):me=ee,j){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=me+ue,j={id:p++,callback:X,priorityLevel:j,startTime:me,expirationTime:ue,sortIndex:-1},me>ee?(j.sortIndex=me,e(h,j),t(d)===null&&j===t(h)&&(E?(D(U),U=-1):E=!0,Re(H,me-ee))):(j.sortIndex=ue,e(d,j),A||S||(A=!0,z||(z=!0,ne()))),j},s.unstable_shouldYield=ie,s.unstable_wrapCallback=function(j){var X=x;return function(){var me=x;x=X;try{return j.apply(this,arguments)}finally{x=me}}}})(Lb)),Lb}var z1;function kD(){return z1||(z1=1,Pb.exports=RD()),Pb.exports}var Ob={exports:{}},Nn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j1;function MD(){if(j1)return Nn;j1=1;var s=Qx();function e(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(d,h,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:v==null?null:""+v,children:d,containerInfo:h,implementation:p}}var l=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Nn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Nn.createPortal=function(d,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return a(d,h,null,p)},Nn.flushSync=function(d){var h=l.T,p=n.p;try{if(l.T=null,n.p=2,d)return d()}finally{l.T=h,n.p=p,n.d.f()}},Nn.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(d,h))},Nn.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},Nn.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var p=h.as,v=c(p,h.crossOrigin),x=typeof h.integrity=="string"?h.integrity:void 0,S=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?n.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:v,integrity:x,fetchPriority:S}):p==="script"&&n.d.X(d,{crossOrigin:v,integrity:x,fetchPriority:S,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Nn.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=c(h.as,h.crossOrigin);n.d.M(d,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(d)},Nn.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,v=c(p,h.crossOrigin);n.d.L(d,p,{crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Nn.preloadModule=function(d,h){if(typeof d=="string")if(h){var p=c(h.as,h.crossOrigin);n.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(d)},Nn.requestFormReset=function(d){n.d.r(d)},Nn.unstable_batchedUpdates=function(d,h){return d(h)},Nn.useFormState=function(d,h,p){return l.H.useFormState(d,h,p)},Nn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Nn.version="19.2.3",Nn}var H1;function wN(){if(H1)return Ob.exports;H1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ob.exports=MD(),Ob.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B1;function ID(){if(B1)return jh;B1=1;var s=kD(),e=Qx(),t=wN();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,u=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(u=o.return),r=o.return;while(r)}return o.tag===3?u:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function c(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function d(r){if(a(r)!==r)throw Error(n(188))}function h(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(n(188));return o!==r?null:r}for(var u=r,f=o;;){var _=u.return;if(_===null)break;var w=_.alternate;if(w===null){if(f=_.return,f!==null){u=f;continue}break}if(_.child===w.child){for(w=_.child;w;){if(w===u)return d(_),r;if(w===f)return d(_),o;w=w.sibling}throw Error(n(188))}if(u.return!==f.return)u=_,f=w;else{for(var T=!1,I=_.child;I;){if(I===u){T=!0,u=_,f=w;break}if(I===f){T=!0,f=_,u=w;break}I=I.sibling}if(!T){for(I=w.child;I;){if(I===u){T=!0,u=w,f=_;break}if(I===f){T=!0,f=w,u=_;break}I=I.sibling}if(!T)throw Error(n(189))}}if(u.alternate!==f)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?r:o}function p(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=p(r),o!==null)return o;r=r.sibling}return null}var v=Object.assign,x=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),P=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),ie=Symbol.for("react.memo_cache_sentinel"),oe=Symbol.iterator;function ne(r){return r===null||typeof r!="object"?null:(r=oe&&r[oe]||r["@@iterator"],typeof r=="function"?r:null)}var ve=Symbol.for("react.client.reference");function de(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===ve?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case E:return"Fragment";case R:return"Profiler";case N:return"StrictMode";case H:return"Suspense";case z:return"SuspenseList";case K:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case A:return"Portal";case P:return r.displayName||"Context";case D:return(r._context.displayName||"Context")+".Consumer";case L:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case U:return o=r.displayName||null,o!==null?o:de(r.type)||"Memo";case J:o=r._payload,r=r._init;try{return de(r(o))}catch{}}return null}var Re=Array.isArray,j=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},ee=[],ue=-1;function O(r){return{current:r}}function $(r){0>ue||(r.current=ee[ue],ee[ue]=null,ue--)}function se(r,o){ue++,ee[ue]=r.current,r.current=o}var ce=O(null),Ce=O(null),re=O(null),le=O(null);function ze(r,o){switch(se(re,o),se(Ce,r),se(ce,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?n1(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=n1(o),r=s1(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}$(ce),se(ce,r)}function Le(){$(ce),$(Ce),$(re)}function Bt(r){r.memoizedState!==null&&se(le,r);var o=ce.current,u=s1(o,r.type);o!==u&&(se(Ce,r),se(ce,u))}function ur(r){Ce.current===r&&($(ce),$(Ce)),le.current===r&&($(le),Lh._currentValue=me)}var ya,yc;function Hs(r){if(ya===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);ya=o&&o[1]||"",yc=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ya+r+yc}var we=!1;function rt(r,o){if(!r||we)return"";we=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var te=function(){throw Error()};if(Object.defineProperty(te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(te,[])}catch(W){var Y=W}Reflect.construct(r,[],te)}else{try{te.call()}catch(W){Y=W}r.call(te.prototype)}}else{try{throw Error()}catch(W){Y=W}(te=r())&&typeof te.catch=="function"&&te.catch(function(){})}}catch(W){if(W&&Y&&typeof W.stack=="string")return[W.stack,Y.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=f.DetermineComponentFrameRoot(),T=w[0],I=w[1];if(T&&I){var F=T.split(`
`),V=I.split(`
`);for(_=f=0;f<F.length&&!F[f].includes("DetermineComponentFrameRoot");)f++;for(;_<V.length&&!V[_].includes("DetermineComponentFrameRoot");)_++;if(f===F.length||_===V.length)for(f=F.length-1,_=V.length-1;1<=f&&0<=_&&F[f]!==V[_];)_--;for(;1<=f&&0<=_;f--,_--)if(F[f]!==V[_]){if(f!==1||_!==1)do if(f--,_--,0>_||F[f]!==V[_]){var Q=`
`+F[f].replace(" at new "," at ");return r.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",r.displayName)),Q}while(1<=f&&0<=_);break}}}finally{we=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?Hs(u):""}function Bs(r,o){switch(r.tag){case 26:case 27:case 5:return Hs(r.type);case 16:return Hs("Lazy");case 13:return r.child!==o&&o!==null?Hs("Suspense Fallback"):Hs("Suspense");case 19:return Hs("SuspenseList");case 0:case 15:return rt(r.type,!1);case 11:return rt(r.type.render,!1);case 1:return rt(r.type,!0);case 31:return Hs("Activity");default:return""}}function Gs(r){try{var o="",u=null;do o+=Bs(r,u),u=r,r=r.return;while(r);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Vd=Object.prototype.hasOwnProperty,$d=s.unstable_scheduleCallback,dr=s.unstable_cancelCallback,ko=s.unstable_shouldYield,nM=s.unstable_requestPaint,hs=s.unstable_now,sM=s.unstable_getCurrentPriorityLevel,Pw=s.unstable_ImmediatePriority,Lw=s.unstable_UserBlockingPriority,tm=s.unstable_NormalPriority,iM=s.unstable_LowPriority,Ow=s.unstable_IdlePriority,rM=s.log,aM=s.unstable_setDisableYieldValue,Yd=null,fs=null;function va(r){if(typeof rM=="function"&&aM(r),fs&&typeof fs.setStrictMode=="function")try{fs.setStrictMode(Yd,r)}catch{}}var ps=Math.clz32?Math.clz32:cM,oM=Math.log,lM=Math.LN2;function cM(r){return r>>>=0,r===0?32:31-(oM(r)/lM|0)|0}var nm=256,sm=262144,im=4194304;function Mo(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function rm(r,o,u){var f=r.pendingLanes;if(f===0)return 0;var _=0,w=r.suspendedLanes,T=r.pingedLanes;r=r.warmLanes;var I=f&134217727;return I!==0?(f=I&~w,f!==0?_=Mo(f):(T&=I,T!==0?_=Mo(T):u||(u=I&~r,u!==0&&(_=Mo(u))))):(I=f&~w,I!==0?_=Mo(I):T!==0?_=Mo(T):u||(u=f&~r,u!==0&&(_=Mo(u)))),_===0?0:o!==0&&o!==_&&(o&w)===0&&(w=_&-_,u=o&-o,w>=u||w===32&&(u&4194048)!==0)?o:_}function Kd(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function uM(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Uw(){var r=im;return im<<=1,(im&62914560)===0&&(im=4194304),r}function vy(r){for(var o=[],u=0;31>u;u++)o.push(r);return o}function Jd(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function dM(r,o,u,f,_,w){var T=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var I=r.entanglements,F=r.expirationTimes,V=r.hiddenUpdates;for(u=T&~u;0<u;){var Q=31-ps(u),te=1<<Q;I[Q]=0,F[Q]=-1;var Y=V[Q];if(Y!==null)for(V[Q]=null,Q=0;Q<Y.length;Q++){var W=Y[Q];W!==null&&(W.lane&=-536870913)}u&=~te}f!==0&&Fw(r,f,0),w!==0&&_===0&&r.tag!==0&&(r.suspendedLanes|=w&~(T&~o))}function Fw(r,o,u){r.pendingLanes|=o,r.suspendedLanes&=~o;var f=31-ps(o);r.entangledLanes|=o,r.entanglements[f]=r.entanglements[f]|1073741824|u&261930}function zw(r,o){var u=r.entangledLanes|=o;for(r=r.entanglements;u;){var f=31-ps(u),_=1<<f;_&o|r[f]&o&&(r[f]|=o),u&=~_}}function jw(r,o){var u=o&-o;return u=(u&42)!==0?1:by(u),(u&(r.suspendedLanes|o))!==0?0:u}function by(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function _y(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Hw(){var r=X.p;return r!==0?r:(r=window.event,r===void 0?32:T1(r.type))}function Bw(r,o){var u=X.p;try{return X.p=r,o()}finally{X.p=u}}var ba=Math.random().toString(36).slice(2),mn="__reactFiber$"+ba,Qn="__reactProps$"+ba,vc="__reactContainer$"+ba,xy="__reactEvents$"+ba,hM="__reactListeners$"+ba,fM="__reactHandles$"+ba,Gw="__reactResources$"+ba,Xd="__reactMarker$"+ba;function wy(r){delete r[mn],delete r[Qn],delete r[xy],delete r[hM],delete r[fM]}function bc(r){var o=r[mn];if(o)return o;for(var u=r.parentNode;u;){if(o=u[vc]||u[mn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(r=u1(r);r!==null;){if(u=r[mn])return u;r=u1(r)}return o}r=u,u=r.parentNode}return null}function _c(r){if(r=r[mn]||r[vc]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function Wd(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function xc(r){var o=r[Gw];return o||(o=r[Gw]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function rn(r){r[Xd]=!0}var qw=new Set,Vw={};function Io(r,o){wc(r,o),wc(r+"Capture",o)}function wc(r,o){for(Vw[r]=o,r=0;r<o.length;r++)qw.add(o[r])}var pM=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$w={},Yw={};function mM(r){return Vd.call(Yw,r)?!0:Vd.call($w,r)?!1:pM.test(r)?Yw[r]=!0:($w[r]=!0,!1)}function am(r,o,u){if(mM(o))if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+u)}}function om(r,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+u)}}function hr(r,o,u,f){if(f===null)r.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(o,u,""+f)}}function qs(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Kw(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function gM(r,o,u){var f=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var _=f.get,w=f.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return _.call(this)},set:function(T){u=""+T,w.call(this,T)}}),Object.defineProperty(r,o,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Sy(r){if(!r._valueTracker){var o=Kw(r)?"checked":"value";r._valueTracker=gM(r,o,""+r[o])}}function Jw(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var u=o.getValue(),f="";return r&&(f=Kw(r)?r.checked?"true":"false":r.value),r=f,r!==u?(o.setValue(r),!0):!1}function lm(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var yM=/[\n"\\]/g;function Vs(r){return r.replace(yM,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Ay(r,o,u,f,_,w,T,I){r.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?r.type=T:r.removeAttribute("type"),o!=null?T==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+qs(o)):r.value!==""+qs(o)&&(r.value=""+qs(o)):T!=="submit"&&T!=="reset"||r.removeAttribute("value"),o!=null?Ey(r,T,qs(o)):u!=null?Ey(r,T,qs(u)):f!=null&&r.removeAttribute("value"),_==null&&w!=null&&(r.defaultChecked=!!w),_!=null&&(r.checked=_&&typeof _!="function"&&typeof _!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?r.name=""+qs(I):r.removeAttribute("name")}function Xw(r,o,u,f,_,w,T,I){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(r.type=w),o!=null||u!=null){if(!(w!=="submit"&&w!=="reset"||o!=null)){Sy(r);return}u=u!=null?""+qs(u):"",o=o!=null?""+qs(o):u,I||o===r.value||(r.value=o),r.defaultValue=o}f=f??_,f=typeof f!="function"&&typeof f!="symbol"&&!!f,r.checked=I?r.checked:!!f,r.defaultChecked=!!f,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(r.name=T),Sy(r)}function Ey(r,o,u){o==="number"&&lm(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function Sc(r,o,u,f){if(r=r.options,o){o={};for(var _=0;_<u.length;_++)o["$"+u[_]]=!0;for(u=0;u<r.length;u++)_=o.hasOwnProperty("$"+r[u].value),r[u].selected!==_&&(r[u].selected=_),_&&f&&(r[u].defaultSelected=!0)}else{for(u=""+qs(u),o=null,_=0;_<r.length;_++){if(r[_].value===u){r[_].selected=!0,f&&(r[_].defaultSelected=!0);return}o!==null||r[_].disabled||(o=r[_])}o!==null&&(o.selected=!0)}}function Ww(r,o,u){if(o!=null&&(o=""+qs(o),o!==r.value&&(r.value=o),u==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=u!=null?""+qs(u):""}function Qw(r,o,u,f){if(o==null){if(f!=null){if(u!=null)throw Error(n(92));if(Re(f)){if(1<f.length)throw Error(n(93));f=f[0]}u=f}u==null&&(u=""),o=u}u=qs(o),r.defaultValue=u,f=r.textContent,f===u&&f!==""&&f!==null&&(r.value=f),Sy(r)}function Ac(r,o){if(o){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=o;return}}r.textContent=o}var vM=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zw(r,o,u){var f=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":f?r.setProperty(o,u):typeof u!="number"||u===0||vM.has(o)?o==="float"?r.cssFloat=u:r[o]=(""+u).trim():r[o]=u+"px"}function eS(r,o,u){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?r.setProperty(f,""):f==="float"?r.cssFloat="":r[f]="");for(var _ in o)f=o[_],o.hasOwnProperty(_)&&u[_]!==f&&Zw(r,_,f)}else for(var w in o)o.hasOwnProperty(w)&&Zw(r,w,o[w])}function Ty(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bM=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_M=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function cm(r){return _M.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function fr(){}var Cy=null;function Ny(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Ec=null,Tc=null;function tS(r){var o=_c(r);if(o&&(r=o.stateNode)){var u=r[Qn]||null;e:switch(r=o.stateNode,o.type){case"input":if(Ay(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Vs(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var f=u[o];if(f!==r&&f.form===r.form){var _=f[Qn]||null;if(!_)throw Error(n(90));Ay(f,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(o=0;o<u.length;o++)f=u[o],f.form===r.form&&Jw(f)}break e;case"textarea":Ww(r,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Sc(r,!!u.multiple,o,!1)}}}var Ry=!1;function nS(r,o,u){if(Ry)return r(o,u);Ry=!0;try{var f=r(o);return f}finally{if(Ry=!1,(Ec!==null||Tc!==null)&&(Xm(),Ec&&(o=Ec,r=Tc,Tc=Ec=null,tS(o),r)))for(o=0;o<r.length;o++)tS(r[o])}}function Qd(r,o){var u=r.stateNode;if(u===null)return null;var f=u[Qn]||null;if(f===null)return null;u=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(r=r.type,f=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!f;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(n(231,o,typeof u));return u}var pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ky=!1;if(pr)try{var Zd={};Object.defineProperty(Zd,"passive",{get:function(){ky=!0}}),window.addEventListener("test",Zd,Zd),window.removeEventListener("test",Zd,Zd)}catch{ky=!1}var _a=null,My=null,um=null;function sS(){if(um)return um;var r,o=My,u=o.length,f,_="value"in _a?_a.value:_a.textContent,w=_.length;for(r=0;r<u&&o[r]===_[r];r++);var T=u-r;for(f=1;f<=T&&o[u-f]===_[w-f];f++);return um=_.slice(r,1<f?1-f:void 0)}function dm(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function hm(){return!0}function iS(){return!1}function Zn(r){function o(u,f,_,w,T){this._reactName=u,this._targetInst=_,this.type=f,this.nativeEvent=w,this.target=T,this.currentTarget=null;for(var I in r)r.hasOwnProperty(I)&&(u=r[I],this[I]=u?u(w):w[I]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?hm:iS,this.isPropagationStopped=iS,this}return v(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=hm)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=hm)},persist:function(){},isPersistent:hm}),o}var Do={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fm=Zn(Do),eh=v({},Do,{view:0,detail:0}),xM=Zn(eh),Iy,Dy,th,pm=v({},eh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ly,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==th&&(th&&r.type==="mousemove"?(Iy=r.screenX-th.screenX,Dy=r.screenY-th.screenY):Dy=Iy=0,th=r),Iy)},movementY:function(r){return"movementY"in r?r.movementY:Dy}}),rS=Zn(pm),wM=v({},pm,{dataTransfer:0}),SM=Zn(wM),AM=v({},eh,{relatedTarget:0}),Py=Zn(AM),EM=v({},Do,{animationName:0,elapsedTime:0,pseudoElement:0}),TM=Zn(EM),CM=v({},Do,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),NM=Zn(CM),RM=v({},Do,{data:0}),aS=Zn(RM),kM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},MM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function DM(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=IM[r])?!!o[r]:!1}function Ly(){return DM}var PM=v({},eh,{key:function(r){if(r.key){var o=kM[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=dm(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?MM[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ly,charCode:function(r){return r.type==="keypress"?dm(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?dm(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),LM=Zn(PM),OM=v({},pm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oS=Zn(OM),UM=v({},eh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ly}),FM=Zn(UM),zM=v({},Do,{propertyName:0,elapsedTime:0,pseudoElement:0}),jM=Zn(zM),HM=v({},pm,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),BM=Zn(HM),GM=v({},Do,{newState:0,oldState:0}),qM=Zn(GM),VM=[9,13,27,32],Oy=pr&&"CompositionEvent"in window,nh=null;pr&&"documentMode"in document&&(nh=document.documentMode);var $M=pr&&"TextEvent"in window&&!nh,lS=pr&&(!Oy||nh&&8<nh&&11>=nh),cS=" ",uS=!1;function dS(r,o){switch(r){case"keyup":return VM.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hS(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Cc=!1;function YM(r,o){switch(r){case"compositionend":return hS(o);case"keypress":return o.which!==32?null:(uS=!0,cS);case"textInput":return r=o.data,r===cS&&uS?null:r;default:return null}}function KM(r,o){if(Cc)return r==="compositionend"||!Oy&&dS(r,o)?(r=sS(),um=My=_a=null,Cc=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return lS&&o.locale!=="ko"?null:o.data;default:return null}}var JM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fS(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!JM[r.type]:o==="textarea"}function pS(r,o,u,f){Ec?Tc?Tc.push(f):Tc=[f]:Ec=f,o=sg(o,"onChange"),0<o.length&&(u=new fm("onChange","change",null,u,f),r.push({event:u,listeners:o}))}var sh=null,ih=null;function XM(r){XE(r,0)}function mm(r){var o=Wd(r);if(Jw(o))return r}function mS(r,o){if(r==="change")return o}var gS=!1;if(pr){var Uy;if(pr){var Fy="oninput"in document;if(!Fy){var yS=document.createElement("div");yS.setAttribute("oninput","return;"),Fy=typeof yS.oninput=="function"}Uy=Fy}else Uy=!1;gS=Uy&&(!document.documentMode||9<document.documentMode)}function vS(){sh&&(sh.detachEvent("onpropertychange",bS),ih=sh=null)}function bS(r){if(r.propertyName==="value"&&mm(ih)){var o=[];pS(o,ih,r,Ny(r)),nS(XM,o)}}function WM(r,o,u){r==="focusin"?(vS(),sh=o,ih=u,sh.attachEvent("onpropertychange",bS)):r==="focusout"&&vS()}function QM(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return mm(ih)}function ZM(r,o){if(r==="click")return mm(o)}function eI(r,o){if(r==="input"||r==="change")return mm(o)}function tI(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var ms=typeof Object.is=="function"?Object.is:tI;function rh(r,o){if(ms(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var u=Object.keys(r),f=Object.keys(o);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var _=u[f];if(!Vd.call(o,_)||!ms(r[_],o[_]))return!1}return!0}function _S(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function xS(r,o){var u=_S(r);r=0;for(var f;u;){if(u.nodeType===3){if(f=r+u.textContent.length,r<=o&&f>=o)return{node:u,offset:o-r};r=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=_S(u)}}function wS(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?wS(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function SS(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=lm(r.document);o instanceof r.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)r=o.contentWindow;else break;o=lm(r.document)}return o}function zy(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var nI=pr&&"documentMode"in document&&11>=document.documentMode,Nc=null,jy=null,ah=null,Hy=!1;function AS(r,o,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Hy||Nc==null||Nc!==lm(f)||(f=Nc,"selectionStart"in f&&zy(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ah&&rh(ah,f)||(ah=f,f=sg(jy,"onSelect"),0<f.length&&(o=new fm("onSelect","select",null,o,u),r.push({event:o,listeners:f}),o.target=Nc)))}function Po(r,o){var u={};return u[r.toLowerCase()]=o.toLowerCase(),u["Webkit"+r]="webkit"+o,u["Moz"+r]="moz"+o,u}var Rc={animationend:Po("Animation","AnimationEnd"),animationiteration:Po("Animation","AnimationIteration"),animationstart:Po("Animation","AnimationStart"),transitionrun:Po("Transition","TransitionRun"),transitionstart:Po("Transition","TransitionStart"),transitioncancel:Po("Transition","TransitionCancel"),transitionend:Po("Transition","TransitionEnd")},By={},ES={};pr&&(ES=document.createElement("div").style,"AnimationEvent"in window||(delete Rc.animationend.animation,delete Rc.animationiteration.animation,delete Rc.animationstart.animation),"TransitionEvent"in window||delete Rc.transitionend.transition);function Lo(r){if(By[r])return By[r];if(!Rc[r])return r;var o=Rc[r],u;for(u in o)if(o.hasOwnProperty(u)&&u in ES)return By[r]=o[u];return r}var TS=Lo("animationend"),CS=Lo("animationiteration"),NS=Lo("animationstart"),sI=Lo("transitionrun"),iI=Lo("transitionstart"),rI=Lo("transitioncancel"),RS=Lo("transitionend"),kS=new Map,Gy="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Gy.push("scrollEnd");function fi(r,o){kS.set(r,o),Io(o,[r])}var gm=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},$s=[],kc=0,qy=0;function ym(){for(var r=kc,o=qy=kc=0;o<r;){var u=$s[o];$s[o++]=null;var f=$s[o];$s[o++]=null;var _=$s[o];$s[o++]=null;var w=$s[o];if($s[o++]=null,f!==null&&_!==null){var T=f.pending;T===null?_.next=_:(_.next=T.next,T.next=_),f.pending=_}w!==0&&MS(u,_,w)}}function vm(r,o,u,f){$s[kc++]=r,$s[kc++]=o,$s[kc++]=u,$s[kc++]=f,qy|=f,r.lanes|=f,r=r.alternate,r!==null&&(r.lanes|=f)}function Vy(r,o,u,f){return vm(r,o,u,f),bm(r)}function Oo(r,o){return vm(r,null,null,o),bm(r)}function MS(r,o,u){r.lanes|=u;var f=r.alternate;f!==null&&(f.lanes|=u);for(var _=!1,w=r.return;w!==null;)w.childLanes|=u,f=w.alternate,f!==null&&(f.childLanes|=u),w.tag===22&&(r=w.stateNode,r===null||r._visibility&1||(_=!0)),r=w,w=w.return;return r.tag===3?(w=r.stateNode,_&&o!==null&&(_=31-ps(u),r=w.hiddenUpdates,f=r[_],f===null?r[_]=[o]:f.push(o),o.lane=u|536870912),w):null}function bm(r){if(50<Nh)throw Nh=0,eb=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var Mc={};function aI(r,o,u,f){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gs(r,o,u,f){return new aI(r,o,u,f)}function $y(r){return r=r.prototype,!(!r||!r.isReactComponent)}function mr(r,o){var u=r.alternate;return u===null?(u=gs(r.tag,o,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=o,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,o=r.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function IS(r,o){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,o=u.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function _m(r,o,u,f,_,w){var T=0;if(f=r,typeof r=="function")$y(r)&&(T=1);else if(typeof r=="string")T=dD(r,u,ce.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case K:return r=gs(31,u,o,_),r.elementType=K,r.lanes=w,r;case E:return Uo(u.children,_,w,o);case N:T=8,_|=24;break;case R:return r=gs(12,u,o,_|2),r.elementType=R,r.lanes=w,r;case H:return r=gs(13,u,o,_),r.elementType=H,r.lanes=w,r;case z:return r=gs(19,u,o,_),r.elementType=z,r.lanes=w,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case P:T=10;break e;case D:T=9;break e;case L:T=11;break e;case U:T=14;break e;case J:T=16,f=null;break e}T=29,u=Error(n(130,r===null?"null":typeof r,"")),f=null}return o=gs(T,u,o,_),o.elementType=r,o.type=f,o.lanes=w,o}function Uo(r,o,u,f){return r=gs(7,r,f,o),r.lanes=u,r}function Yy(r,o,u){return r=gs(6,r,null,o),r.lanes=u,r}function DS(r){var o=gs(18,null,null,0);return o.stateNode=r,o}function Ky(r,o,u){return o=gs(4,r.children!==null?r.children:[],r.key,o),o.lanes=u,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var PS=new WeakMap;function Ys(r,o){if(typeof r=="object"&&r!==null){var u=PS.get(r);return u!==void 0?u:(o={value:r,source:o,stack:Gs(o)},PS.set(r,o),o)}return{value:r,source:o,stack:Gs(o)}}var Ic=[],Dc=0,xm=null,oh=0,Ks=[],Js=0,xa=null,zi=1,ji="";function gr(r,o){Ic[Dc++]=oh,Ic[Dc++]=xm,xm=r,oh=o}function LS(r,o,u){Ks[Js++]=zi,Ks[Js++]=ji,Ks[Js++]=xa,xa=r;var f=zi;r=ji;var _=32-ps(f)-1;f&=~(1<<_),u+=1;var w=32-ps(o)+_;if(30<w){var T=_-_%5;w=(f&(1<<T)-1).toString(32),f>>=T,_-=T,zi=1<<32-ps(o)+_|u<<_|f,ji=w+r}else zi=1<<w|u<<_|f,ji=r}function Jy(r){r.return!==null&&(gr(r,1),LS(r,1,0))}function Xy(r){for(;r===xm;)xm=Ic[--Dc],Ic[Dc]=null,oh=Ic[--Dc],Ic[Dc]=null;for(;r===xa;)xa=Ks[--Js],Ks[Js]=null,ji=Ks[--Js],Ks[Js]=null,zi=Ks[--Js],Ks[Js]=null}function OS(r,o){Ks[Js++]=zi,Ks[Js++]=ji,Ks[Js++]=xa,zi=o.id,ji=o.overflow,xa=r}var gn=null,wt=null,Qe=!1,wa=null,Xs=!1,Wy=Error(n(519));function Sa(r){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw lh(Ys(o,r)),Wy}function US(r){var o=r.stateNode,u=r.type,f=r.memoizedProps;switch(o[mn]=r,o[Qn]=f,u){case"dialog":Je("cancel",o),Je("close",o);break;case"iframe":case"object":case"embed":Je("load",o);break;case"video":case"audio":for(u=0;u<kh.length;u++)Je(kh[u],o);break;case"source":Je("error",o);break;case"img":case"image":case"link":Je("error",o),Je("load",o);break;case"details":Je("toggle",o);break;case"input":Je("invalid",o),Xw(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Je("invalid",o);break;case"textarea":Je("invalid",o),Qw(o,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||f.suppressHydrationWarning===!0||e1(o.textContent,u)?(f.popover!=null&&(Je("beforetoggle",o),Je("toggle",o)),f.onScroll!=null&&Je("scroll",o),f.onScrollEnd!=null&&Je("scrollend",o),f.onClick!=null&&(o.onclick=fr),o=!0):o=!1,o||Sa(r,!0)}function FS(r){for(gn=r.return;gn;)switch(gn.tag){case 5:case 31:case 13:Xs=!1;return;case 27:case 3:Xs=!0;return;default:gn=gn.return}}function Pc(r){if(r!==gn)return!1;if(!Qe)return FS(r),Qe=!0,!1;var o=r.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||mb(r.type,r.memoizedProps)),u=!u),u&&wt&&Sa(r),FS(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));wt=c1(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));wt=c1(r)}else o===27?(o=wt,Ua(r.type)?(r=_b,_b=null,wt=r):wt=o):wt=gn?Qs(r.stateNode.nextSibling):null;return!0}function Fo(){wt=gn=null,Qe=!1}function Qy(){var r=wa;return r!==null&&(ss===null?ss=r:ss.push.apply(ss,r),wa=null),r}function lh(r){wa===null?wa=[r]:wa.push(r)}var Zy=O(null),zo=null,yr=null;function Aa(r,o,u){se(Zy,o._currentValue),o._currentValue=u}function vr(r){r._currentValue=Zy.current,$(Zy)}function ev(r,o,u){for(;r!==null;){var f=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),r===u)break;r=r.return}}function tv(r,o,u,f){var _=r.child;for(_!==null&&(_.return=r);_!==null;){var w=_.dependencies;if(w!==null){var T=_.child;w=w.firstContext;e:for(;w!==null;){var I=w;w=_;for(var F=0;F<o.length;F++)if(I.context===o[F]){w.lanes|=u,I=w.alternate,I!==null&&(I.lanes|=u),ev(w.return,u,r),f||(T=null);break e}w=I.next}}else if(_.tag===18){if(T=_.return,T===null)throw Error(n(341));T.lanes|=u,w=T.alternate,w!==null&&(w.lanes|=u),ev(T,u,r),T=null}else T=_.child;if(T!==null)T.return=_;else for(T=_;T!==null;){if(T===r){T=null;break}if(_=T.sibling,_!==null){_.return=T.return,T=_;break}T=T.return}_=T}}function Lc(r,o,u,f){r=null;for(var _=o,w=!1;_!==null;){if(!w){if((_.flags&524288)!==0)w=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var T=_.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var I=_.type;ms(_.pendingProps.value,T.value)||(r!==null?r.push(I):r=[I])}}else if(_===le.current){if(T=_.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(r!==null?r.push(Lh):r=[Lh])}_=_.return}r!==null&&tv(o,r,u,f),o.flags|=262144}function wm(r){for(r=r.firstContext;r!==null;){if(!ms(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function jo(r){zo=r,yr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function yn(r){return zS(zo,r)}function Sm(r,o){return zo===null&&jo(r),zS(r,o)}function zS(r,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},yr===null){if(r===null)throw Error(n(308));yr=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else yr=yr.next=o;return u}var oI=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(u,f){r.push(f)}};this.abort=function(){o.aborted=!0,r.forEach(function(u){return u()})}},lI=s.unstable_scheduleCallback,cI=s.unstable_NormalPriority,Gt={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function nv(){return{controller:new oI,data:new Map,refCount:0}}function ch(r){r.refCount--,r.refCount===0&&lI(cI,function(){r.controller.abort()})}var uh=null,sv=0,Oc=0,Uc=null;function uI(r,o){if(uh===null){var u=uh=[];sv=0,Oc=ab(),Uc={status:"pending",value:void 0,then:function(f){u.push(f)}}}return sv++,o.then(jS,jS),o}function jS(){if(--sv===0&&uh!==null){Uc!==null&&(Uc.status="fulfilled");var r=uh;uh=null,Oc=0,Uc=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function dI(r,o){var u=[],f={status:"pending",value:null,reason:null,then:function(_){u.push(_)}};return r.then(function(){f.status="fulfilled",f.value=o;for(var _=0;_<u.length;_++)(0,u[_])(o)},function(_){for(f.status="rejected",f.reason=_,_=0;_<u.length;_++)(0,u[_])(void 0)}),f}var HS=j.S;j.S=function(r,o){AE=hs(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&uI(r,o),HS!==null&&HS(r,o)};var Ho=O(null);function iv(){var r=Ho.current;return r!==null?r:yt.pooledCache}function Am(r,o){o===null?se(Ho,Ho.current):se(Ho,o.pool)}function BS(){var r=iv();return r===null?null:{parent:Gt._currentValue,pool:r}}var Fc=Error(n(460)),rv=Error(n(474)),Em=Error(n(542)),Tm={then:function(){}};function GS(r){return r=r.status,r==="fulfilled"||r==="rejected"}function qS(r,o,u){switch(u=r[u],u===void 0?r.push(o):u!==o&&(o.then(fr,fr),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,$S(r),r;default:if(typeof o.status=="string")o.then(fr,fr);else{if(r=yt,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(f){if(o.status==="pending"){var _=o;_.status="fulfilled",_.value=f}},function(f){if(o.status==="pending"){var _=o;_.status="rejected",_.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,$S(r),r}throw Go=o,Fc}}function Bo(r){try{var o=r._init;return o(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Go=u,Fc):u}}var Go=null;function VS(){if(Go===null)throw Error(n(459));var r=Go;return Go=null,r}function $S(r){if(r===Fc||r===Em)throw Error(n(483))}var zc=null,dh=0;function Cm(r){var o=dh;return dh+=1,zc===null&&(zc=[]),qS(zc,r,o)}function hh(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Nm(r,o){throw o.$$typeof===x?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function YS(r){function o(G,B){if(r){var q=G.deletions;q===null?(G.deletions=[B],G.flags|=16):q.push(B)}}function u(G,B){if(!r)return null;for(;B!==null;)o(G,B),B=B.sibling;return null}function f(G){for(var B=new Map;G!==null;)G.key!==null?B.set(G.key,G):B.set(G.index,G),G=G.sibling;return B}function _(G,B){return G=mr(G,B),G.index=0,G.sibling=null,G}function w(G,B,q){return G.index=q,r?(q=G.alternate,q!==null?(q=q.index,q<B?(G.flags|=67108866,B):q):(G.flags|=67108866,B)):(G.flags|=1048576,B)}function T(G){return r&&G.alternate===null&&(G.flags|=67108866),G}function I(G,B,q,Z){return B===null||B.tag!==6?(B=Yy(q,G.mode,Z),B.return=G,B):(B=_(B,q),B.return=G,B)}function F(G,B,q,Z){var Ne=q.type;return Ne===E?Q(G,B,q.props.children,Z,q.key):B!==null&&(B.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===J&&Bo(Ne)===B.type)?(B=_(B,q.props),hh(B,q),B.return=G,B):(B=_m(q.type,q.key,q.props,null,G.mode,Z),hh(B,q),B.return=G,B)}function V(G,B,q,Z){return B===null||B.tag!==4||B.stateNode.containerInfo!==q.containerInfo||B.stateNode.implementation!==q.implementation?(B=Ky(q,G.mode,Z),B.return=G,B):(B=_(B,q.children||[]),B.return=G,B)}function Q(G,B,q,Z,Ne){return B===null||B.tag!==7?(B=Uo(q,G.mode,Z,Ne),B.return=G,B):(B=_(B,q),B.return=G,B)}function te(G,B,q){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=Yy(""+B,G.mode,q),B.return=G,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case S:return q=_m(B.type,B.key,B.props,null,G.mode,q),hh(q,B),q.return=G,q;case A:return B=Ky(B,G.mode,q),B.return=G,B;case J:return B=Bo(B),te(G,B,q)}if(Re(B)||ne(B))return B=Uo(B,G.mode,q,null),B.return=G,B;if(typeof B.then=="function")return te(G,Cm(B),q);if(B.$$typeof===P)return te(G,Sm(G,B),q);Nm(G,B)}return null}function Y(G,B,q,Z){var Ne=B!==null?B.key:null;if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return Ne!==null?null:I(G,B,""+q,Z);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case S:return q.key===Ne?F(G,B,q,Z):null;case A:return q.key===Ne?V(G,B,q,Z):null;case J:return q=Bo(q),Y(G,B,q,Z)}if(Re(q)||ne(q))return Ne!==null?null:Q(G,B,q,Z,null);if(typeof q.then=="function")return Y(G,B,Cm(q),Z);if(q.$$typeof===P)return Y(G,B,Sm(G,q),Z);Nm(G,q)}return null}function W(G,B,q,Z,Ne){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return G=G.get(q)||null,I(B,G,""+Z,Ne);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case S:return G=G.get(Z.key===null?q:Z.key)||null,F(B,G,Z,Ne);case A:return G=G.get(Z.key===null?q:Z.key)||null,V(B,G,Z,Ne);case J:return Z=Bo(Z),W(G,B,q,Z,Ne)}if(Re(Z)||ne(Z))return G=G.get(q)||null,Q(B,G,Z,Ne,null);if(typeof Z.then=="function")return W(G,B,q,Cm(Z),Ne);if(Z.$$typeof===P)return W(G,B,q,Sm(B,Z),Ne);Nm(B,Z)}return null}function be(G,B,q,Z){for(var Ne=null,tt=null,Se=B,Be=B=0,We=null;Se!==null&&Be<q.length;Be++){Se.index>Be?(We=Se,Se=null):We=Se.sibling;var nt=Y(G,Se,q[Be],Z);if(nt===null){Se===null&&(Se=We);break}r&&Se&&nt.alternate===null&&o(G,Se),B=w(nt,B,Be),tt===null?Ne=nt:tt.sibling=nt,tt=nt,Se=We}if(Be===q.length)return u(G,Se),Qe&&gr(G,Be),Ne;if(Se===null){for(;Be<q.length;Be++)Se=te(G,q[Be],Z),Se!==null&&(B=w(Se,B,Be),tt===null?Ne=Se:tt.sibling=Se,tt=Se);return Qe&&gr(G,Be),Ne}for(Se=f(Se);Be<q.length;Be++)We=W(Se,G,Be,q[Be],Z),We!==null&&(r&&We.alternate!==null&&Se.delete(We.key===null?Be:We.key),B=w(We,B,Be),tt===null?Ne=We:tt.sibling=We,tt=We);return r&&Se.forEach(function(Ba){return o(G,Ba)}),Qe&&gr(G,Be),Ne}function ke(G,B,q,Z){if(q==null)throw Error(n(151));for(var Ne=null,tt=null,Se=B,Be=B=0,We=null,nt=q.next();Se!==null&&!nt.done;Be++,nt=q.next()){Se.index>Be?(We=Se,Se=null):We=Se.sibling;var Ba=Y(G,Se,nt.value,Z);if(Ba===null){Se===null&&(Se=We);break}r&&Se&&Ba.alternate===null&&o(G,Se),B=w(Ba,B,Be),tt===null?Ne=Ba:tt.sibling=Ba,tt=Ba,Se=We}if(nt.done)return u(G,Se),Qe&&gr(G,Be),Ne;if(Se===null){for(;!nt.done;Be++,nt=q.next())nt=te(G,nt.value,Z),nt!==null&&(B=w(nt,B,Be),tt===null?Ne=nt:tt.sibling=nt,tt=nt);return Qe&&gr(G,Be),Ne}for(Se=f(Se);!nt.done;Be++,nt=q.next())nt=W(Se,G,Be,nt.value,Z),nt!==null&&(r&&nt.alternate!==null&&Se.delete(nt.key===null?Be:nt.key),B=w(nt,B,Be),tt===null?Ne=nt:tt.sibling=nt,tt=nt);return r&&Se.forEach(function(wD){return o(G,wD)}),Qe&&gr(G,Be),Ne}function pt(G,B,q,Z){if(typeof q=="object"&&q!==null&&q.type===E&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case S:e:{for(var Ne=q.key;B!==null;){if(B.key===Ne){if(Ne=q.type,Ne===E){if(B.tag===7){u(G,B.sibling),Z=_(B,q.props.children),Z.return=G,G=Z;break e}}else if(B.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===J&&Bo(Ne)===B.type){u(G,B.sibling),Z=_(B,q.props),hh(Z,q),Z.return=G,G=Z;break e}u(G,B);break}else o(G,B);B=B.sibling}q.type===E?(Z=Uo(q.props.children,G.mode,Z,q.key),Z.return=G,G=Z):(Z=_m(q.type,q.key,q.props,null,G.mode,Z),hh(Z,q),Z.return=G,G=Z)}return T(G);case A:e:{for(Ne=q.key;B!==null;){if(B.key===Ne)if(B.tag===4&&B.stateNode.containerInfo===q.containerInfo&&B.stateNode.implementation===q.implementation){u(G,B.sibling),Z=_(B,q.children||[]),Z.return=G,G=Z;break e}else{u(G,B);break}else o(G,B);B=B.sibling}Z=Ky(q,G.mode,Z),Z.return=G,G=Z}return T(G);case J:return q=Bo(q),pt(G,B,q,Z)}if(Re(q))return be(G,B,q,Z);if(ne(q)){if(Ne=ne(q),typeof Ne!="function")throw Error(n(150));return q=Ne.call(q),ke(G,B,q,Z)}if(typeof q.then=="function")return pt(G,B,Cm(q),Z);if(q.$$typeof===P)return pt(G,B,Sm(G,q),Z);Nm(G,q)}return typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint"?(q=""+q,B!==null&&B.tag===6?(u(G,B.sibling),Z=_(B,q),Z.return=G,G=Z):(u(G,B),Z=Yy(q,G.mode,Z),Z.return=G,G=Z),T(G)):u(G,B)}return function(G,B,q,Z){try{dh=0;var Ne=pt(G,B,q,Z);return zc=null,Ne}catch(Se){if(Se===Fc||Se===Em)throw Se;var tt=gs(29,Se,null,G.mode);return tt.lanes=Z,tt.return=G,tt}finally{}}}var qo=YS(!0),KS=YS(!1),Ea=!1;function av(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ov(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ta(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Ca(r,o,u){var f=r.updateQueue;if(f===null)return null;if(f=f.shared,(at&2)!==0){var _=f.pending;return _===null?o.next=o:(o.next=_.next,_.next=o),f.pending=o,o=bm(r),MS(r,null,u),o}return vm(r,f,o,u),bm(r)}function fh(r,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,zw(r,u)}}function lv(r,o){var u=r.updateQueue,f=r.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var _=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var T={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};w===null?_=w=T:w=w.next=T,u=u.next}while(u!==null);w===null?_=w=o:w=w.next=o}else _=w=o;u={baseState:f.baseState,firstBaseUpdate:_,lastBaseUpdate:w,shared:f.shared,callbacks:f.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=o:r.next=o,u.lastBaseUpdate=o}var cv=!1;function ph(){if(cv){var r=Uc;if(r!==null)throw r}}function mh(r,o,u,f){cv=!1;var _=r.updateQueue;Ea=!1;var w=_.firstBaseUpdate,T=_.lastBaseUpdate,I=_.shared.pending;if(I!==null){_.shared.pending=null;var F=I,V=F.next;F.next=null,T===null?w=V:T.next=V,T=F;var Q=r.alternate;Q!==null&&(Q=Q.updateQueue,I=Q.lastBaseUpdate,I!==T&&(I===null?Q.firstBaseUpdate=V:I.next=V,Q.lastBaseUpdate=F))}if(w!==null){var te=_.baseState;T=0,Q=V=F=null,I=w;do{var Y=I.lane&-536870913,W=Y!==I.lane;if(W?(Xe&Y)===Y:(f&Y)===Y){Y!==0&&Y===Oc&&(cv=!0),Q!==null&&(Q=Q.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var be=r,ke=I;Y=o;var pt=u;switch(ke.tag){case 1:if(be=ke.payload,typeof be=="function"){te=be.call(pt,te,Y);break e}te=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=ke.payload,Y=typeof be=="function"?be.call(pt,te,Y):be,Y==null)break e;te=v({},te,Y);break e;case 2:Ea=!0}}Y=I.callback,Y!==null&&(r.flags|=64,W&&(r.flags|=8192),W=_.callbacks,W===null?_.callbacks=[Y]:W.push(Y))}else W={lane:Y,tag:I.tag,payload:I.payload,callback:I.callback,next:null},Q===null?(V=Q=W,F=te):Q=Q.next=W,T|=Y;if(I=I.next,I===null){if(I=_.shared.pending,I===null)break;W=I,I=W.next,W.next=null,_.lastBaseUpdate=W,_.shared.pending=null}}while(!0);Q===null&&(F=te),_.baseState=F,_.firstBaseUpdate=V,_.lastBaseUpdate=Q,w===null&&(_.shared.lanes=0),Ia|=T,r.lanes=T,r.memoizedState=te}}function JS(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function XS(r,o){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)JS(u[r],o)}var jc=O(null),Rm=O(0);function WS(r,o){r=Cr,se(Rm,r),se(jc,o),Cr=r|o.baseLanes}function uv(){se(Rm,Cr),se(jc,jc.current)}function dv(){Cr=Rm.current,$(jc),$(Rm)}var ys=O(null),Ws=null;function Na(r){var o=r.alternate;se(Ut,Ut.current&1),se(ys,r),Ws===null&&(o===null||jc.current!==null||o.memoizedState!==null)&&(Ws=r)}function hv(r){se(Ut,Ut.current),se(ys,r),Ws===null&&(Ws=r)}function QS(r){r.tag===22?(se(Ut,Ut.current),se(ys,r),Ws===null&&(Ws=r)):Ra()}function Ra(){se(Ut,Ut.current),se(ys,ys.current)}function vs(r){$(ys),Ws===r&&(Ws=null),$(Ut)}var Ut=O(0);function km(r){for(var o=r;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||vb(u)||bb(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var br=0,je=null,ht=null,qt=null,Mm=!1,Hc=!1,Vo=!1,Im=0,gh=0,Bc=null,hI=0;function Pt(){throw Error(n(321))}function fv(r,o){if(o===null)return!1;for(var u=0;u<o.length&&u<r.length;u++)if(!ms(r[u],o[u]))return!1;return!0}function pv(r,o,u,f,_,w){return br=w,je=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,j.H=r===null||r.memoizedState===null?LA:Rv,Vo=!1,w=u(f,_),Vo=!1,Hc&&(w=eA(o,u,f,_)),ZS(r),w}function ZS(r){j.H=bh;var o=ht!==null&&ht.next!==null;if(br=0,qt=ht=je=null,Mm=!1,gh=0,Bc=null,o)throw Error(n(300));r===null||Vt||(r=r.dependencies,r!==null&&wm(r)&&(Vt=!0))}function eA(r,o,u,f){je=r;var _=0;do{if(Hc&&(Bc=null),gh=0,Hc=!1,25<=_)throw Error(n(301));if(_+=1,qt=ht=null,r.updateQueue!=null){var w=r.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}j.H=OA,w=o(u,f)}while(Hc);return w}function fI(){var r=j.H,o=r.useState()[0];return o=typeof o.then=="function"?yh(o):o,r=r.useState()[0],(ht!==null?ht.memoizedState:null)!==r&&(je.flags|=1024),o}function mv(){var r=Im!==0;return Im=0,r}function gv(r,o,u){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~u}function yv(r){if(Mm){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Mm=!1}br=0,qt=ht=je=null,Hc=!1,gh=Im=0,Bc=null}function jn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?je.memoizedState=qt=r:qt=qt.next=r,qt}function Ft(){if(ht===null){var r=je.alternate;r=r!==null?r.memoizedState:null}else r=ht.next;var o=qt===null?je.memoizedState:qt.next;if(o!==null)qt=o,ht=r;else{if(r===null)throw je.alternate===null?Error(n(467)):Error(n(310));ht=r,r={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},qt===null?je.memoizedState=qt=r:qt=qt.next=r}return qt}function Dm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function yh(r){var o=gh;return gh+=1,Bc===null&&(Bc=[]),r=qS(Bc,r,o),o=je,(qt===null?o.memoizedState:qt.next)===null&&(o=o.alternate,j.H=o===null||o.memoizedState===null?LA:Rv),r}function Pm(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return yh(r);if(r.$$typeof===P)return yn(r)}throw Error(n(438,String(r)))}function vv(r){var o=null,u=je.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var f=je.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(_){return _.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Dm(),je.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(r),f=0;f<r;f++)u[f]=ie;return o.index++,u}function _r(r,o){return typeof o=="function"?o(r):o}function Lm(r){var o=Ft();return bv(o,ht,r)}function bv(r,o,u){var f=r.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=u;var _=r.baseQueue,w=f.pending;if(w!==null){if(_!==null){var T=_.next;_.next=w.next,w.next=T}o.baseQueue=_=w,f.pending=null}if(w=r.baseState,_===null)r.memoizedState=w;else{o=_.next;var I=T=null,F=null,V=o,Q=!1;do{var te=V.lane&-536870913;if(te!==V.lane?(Xe&te)===te:(br&te)===te){var Y=V.revertLane;if(Y===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null}),te===Oc&&(Q=!0);else if((br&Y)===Y){V=V.next,Y===Oc&&(Q=!0);continue}else te={lane:0,revertLane:V.revertLane,gesture:null,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null},F===null?(I=F=te,T=w):F=F.next=te,je.lanes|=Y,Ia|=Y;te=V.action,Vo&&u(w,te),w=V.hasEagerState?V.eagerState:u(w,te)}else Y={lane:te,revertLane:V.revertLane,gesture:V.gesture,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null},F===null?(I=F=Y,T=w):F=F.next=Y,je.lanes|=te,Ia|=te;V=V.next}while(V!==null&&V!==o);if(F===null?T=w:F.next=I,!ms(w,r.memoizedState)&&(Vt=!0,Q&&(u=Uc,u!==null)))throw u;r.memoizedState=w,r.baseState=T,r.baseQueue=F,f.lastRenderedState=w}return _===null&&(f.lanes=0),[r.memoizedState,f.dispatch]}function _v(r){var o=Ft(),u=o.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=r;var f=u.dispatch,_=u.pending,w=o.memoizedState;if(_!==null){u.pending=null;var T=_=_.next;do w=r(w,T.action),T=T.next;while(T!==_);ms(w,o.memoizedState)||(Vt=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),u.lastRenderedState=w}return[w,f]}function tA(r,o,u){var f=je,_=Ft(),w=Qe;if(w){if(u===void 0)throw Error(n(407));u=u()}else u=o();var T=!ms((ht||_).memoizedState,u);if(T&&(_.memoizedState=u,Vt=!0),_=_.queue,Sv(iA.bind(null,f,_,r),[r]),_.getSnapshot!==o||T||qt!==null&&qt.memoizedState.tag&1){if(f.flags|=2048,Gc(9,{destroy:void 0},sA.bind(null,f,_,u,o),null),yt===null)throw Error(n(349));w||(br&127)!==0||nA(f,o,u)}return u}function nA(r,o,u){r.flags|=16384,r={getSnapshot:o,value:u},o=je.updateQueue,o===null?(o=Dm(),je.updateQueue=o,o.stores=[r]):(u=o.stores,u===null?o.stores=[r]:u.push(r))}function sA(r,o,u,f){o.value=u,o.getSnapshot=f,rA(o)&&aA(r)}function iA(r,o,u){return u(function(){rA(o)&&aA(r)})}function rA(r){var o=r.getSnapshot;r=r.value;try{var u=o();return!ms(r,u)}catch{return!0}}function aA(r){var o=Oo(r,2);o!==null&&is(o,r,2)}function xv(r){var o=jn();if(typeof r=="function"){var u=r;if(r=u(),Vo){va(!0);try{u()}finally{va(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_r,lastRenderedState:r},o}function oA(r,o,u,f){return r.baseState=u,bv(r,ht,typeof f=="function"?f:_r)}function pI(r,o,u,f,_){if(Fm(r))throw Error(n(485));if(r=o.action,r!==null){var w={payload:_,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){w.listeners.push(T)}};j.T!==null?u(!0):w.isTransition=!1,f(w),u=o.pending,u===null?(w.next=o.pending=w,lA(o,w)):(w.next=u.next,o.pending=u.next=w)}}function lA(r,o){var u=o.action,f=o.payload,_=r.state;if(o.isTransition){var w=j.T,T={};j.T=T;try{var I=u(_,f),F=j.S;F!==null&&F(T,I),cA(r,o,I)}catch(V){wv(r,o,V)}finally{w!==null&&T.types!==null&&(w.types=T.types),j.T=w}}else try{w=u(_,f),cA(r,o,w)}catch(V){wv(r,o,V)}}function cA(r,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){uA(r,o,f)},function(f){return wv(r,o,f)}):uA(r,o,u)}function uA(r,o,u){o.status="fulfilled",o.value=u,dA(o),r.state=u,o=r.pending,o!==null&&(u=o.next,u===o?r.pending=null:(u=u.next,o.next=u,lA(r,u)))}function wv(r,o,u){var f=r.pending;if(r.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=u,dA(o),o=o.next;while(o!==f)}r.action=null}function dA(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function hA(r,o){return o}function fA(r,o){if(Qe){var u=yt.formState;if(u!==null){e:{var f=je;if(Qe){if(wt){t:{for(var _=wt,w=Xs;_.nodeType!==8;){if(!w){_=null;break t}if(_=Qs(_.nextSibling),_===null){_=null;break t}}w=_.data,_=w==="F!"||w==="F"?_:null}if(_){wt=Qs(_.nextSibling),f=_.data==="F!";break e}}Sa(f)}f=!1}f&&(o=u[0])}}return u=jn(),u.memoizedState=u.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hA,lastRenderedState:o},u.queue=f,u=IA.bind(null,je,f),f.dispatch=u,f=xv(!1),w=Nv.bind(null,je,!1,f.queue),f=jn(),_={state:o,dispatch:null,action:r,pending:null},f.queue=_,u=pI.bind(null,je,_,w,u),_.dispatch=u,f.memoizedState=r,[o,u,!1]}function pA(r){var o=Ft();return mA(o,ht,r)}function mA(r,o,u){if(o=bv(r,o,hA)[0],r=Lm(_r)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=yh(o)}catch(T){throw T===Fc?Em:T}else f=o;o=Ft();var _=o.queue,w=_.dispatch;return u!==o.memoizedState&&(je.flags|=2048,Gc(9,{destroy:void 0},mI.bind(null,_,u),null)),[f,w,r]}function mI(r,o){r.action=o}function gA(r){var o=Ft(),u=ht;if(u!==null)return mA(o,u,r);Ft(),o=o.memoizedState,u=Ft();var f=u.queue.dispatch;return u.memoizedState=r,[o,f,!1]}function Gc(r,o,u,f){return r={tag:r,create:u,deps:f,inst:o,next:null},o=je.updateQueue,o===null&&(o=Dm(),je.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=r.next=r:(f=u.next,u.next=r,r.next=f,o.lastEffect=r),r}function yA(){return Ft().memoizedState}function Om(r,o,u,f){var _=jn();je.flags|=r,_.memoizedState=Gc(1|o,{destroy:void 0},u,f===void 0?null:f)}function Um(r,o,u,f){var _=Ft();f=f===void 0?null:f;var w=_.memoizedState.inst;ht!==null&&f!==null&&fv(f,ht.memoizedState.deps)?_.memoizedState=Gc(o,w,u,f):(je.flags|=r,_.memoizedState=Gc(1|o,w,u,f))}function vA(r,o){Om(8390656,8,r,o)}function Sv(r,o){Um(2048,8,r,o)}function gI(r){je.flags|=4;var o=je.updateQueue;if(o===null)o=Dm(),je.updateQueue=o,o.events=[r];else{var u=o.events;u===null?o.events=[r]:u.push(r)}}function bA(r){var o=Ft().memoizedState;return gI({ref:o,nextImpl:r}),function(){if((at&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function _A(r,o){return Um(4,2,r,o)}function xA(r,o){return Um(4,4,r,o)}function wA(r,o){if(typeof o=="function"){r=r();var u=o(r);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function SA(r,o,u){u=u!=null?u.concat([r]):null,Um(4,4,wA.bind(null,o,r),u)}function Av(){}function AA(r,o){var u=Ft();o=o===void 0?null:o;var f=u.memoizedState;return o!==null&&fv(o,f[1])?f[0]:(u.memoizedState=[r,o],r)}function EA(r,o){var u=Ft();o=o===void 0?null:o;var f=u.memoizedState;if(o!==null&&fv(o,f[1]))return f[0];if(f=r(),Vo){va(!0);try{r()}finally{va(!1)}}return u.memoizedState=[f,o],f}function Ev(r,o,u){return u===void 0||(br&1073741824)!==0&&(Xe&261930)===0?r.memoizedState=o:(r.memoizedState=u,r=TE(),je.lanes|=r,Ia|=r,u)}function TA(r,o,u,f){return ms(u,o)?u:jc.current!==null?(r=Ev(r,u,f),ms(r,o)||(Vt=!0),r):(br&42)===0||(br&1073741824)!==0&&(Xe&261930)===0?(Vt=!0,r.memoizedState=u):(r=TE(),je.lanes|=r,Ia|=r,o)}function CA(r,o,u,f,_){var w=X.p;X.p=w!==0&&8>w?w:8;var T=j.T,I={};j.T=I,Nv(r,!1,o,u);try{var F=_(),V=j.S;if(V!==null&&V(I,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var Q=dI(F,f);vh(r,o,Q,xs(r))}else vh(r,o,f,xs(r))}catch(te){vh(r,o,{then:function(){},status:"rejected",reason:te},xs())}finally{X.p=w,T!==null&&I.types!==null&&(T.types=I.types),j.T=T}}function yI(){}function Tv(r,o,u,f){if(r.tag!==5)throw Error(n(476));var _=NA(r).queue;CA(r,_,o,me,u===null?yI:function(){return RA(r),u(f)})}function NA(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_r,lastRenderedState:me},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_r,lastRenderedState:u},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function RA(r){var o=NA(r);o.next===null&&(o=r.alternate.memoizedState),vh(r,o.next.queue,{},xs())}function Cv(){return yn(Lh)}function kA(){return Ft().memoizedState}function MA(){return Ft().memoizedState}function vI(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var u=xs();r=Ta(u);var f=Ca(o,r,u);f!==null&&(is(f,o,u),fh(f,o,u)),o={cache:nv()},r.payload=o;return}o=o.return}}function bI(r,o,u){var f=xs();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Fm(r)?DA(o,u):(u=Vy(r,o,u,f),u!==null&&(is(u,r,f),PA(u,o,f)))}function IA(r,o,u){var f=xs();vh(r,o,u,f)}function vh(r,o,u,f){var _={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Fm(r))DA(o,_);else{var w=r.alternate;if(r.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var T=o.lastRenderedState,I=w(T,u);if(_.hasEagerState=!0,_.eagerState=I,ms(I,T))return vm(r,o,_,0),yt===null&&ym(),!1}catch{}finally{}if(u=Vy(r,o,_,f),u!==null)return is(u,r,f),PA(u,o,f),!0}return!1}function Nv(r,o,u,f){if(f={lane:2,revertLane:ab(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Fm(r)){if(o)throw Error(n(479))}else o=Vy(r,u,f,2),o!==null&&is(o,r,2)}function Fm(r){var o=r.alternate;return r===je||o!==null&&o===je}function DA(r,o){Hc=Mm=!0;var u=r.pending;u===null?o.next=o:(o.next=u.next,u.next=o),r.pending=o}function PA(r,o,u){if((u&4194048)!==0){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,zw(r,u)}}var bh={readContext:yn,use:Pm,useCallback:Pt,useContext:Pt,useEffect:Pt,useImperativeHandle:Pt,useLayoutEffect:Pt,useInsertionEffect:Pt,useMemo:Pt,useReducer:Pt,useRef:Pt,useState:Pt,useDebugValue:Pt,useDeferredValue:Pt,useTransition:Pt,useSyncExternalStore:Pt,useId:Pt,useHostTransitionStatus:Pt,useFormState:Pt,useActionState:Pt,useOptimistic:Pt,useMemoCache:Pt,useCacheRefresh:Pt};bh.useEffectEvent=Pt;var LA={readContext:yn,use:Pm,useCallback:function(r,o){return jn().memoizedState=[r,o===void 0?null:o],r},useContext:yn,useEffect:vA,useImperativeHandle:function(r,o,u){u=u!=null?u.concat([r]):null,Om(4194308,4,wA.bind(null,o,r),u)},useLayoutEffect:function(r,o){return Om(4194308,4,r,o)},useInsertionEffect:function(r,o){Om(4,2,r,o)},useMemo:function(r,o){var u=jn();o=o===void 0?null:o;var f=r();if(Vo){va(!0);try{r()}finally{va(!1)}}return u.memoizedState=[f,o],f},useReducer:function(r,o,u){var f=jn();if(u!==void 0){var _=u(o);if(Vo){va(!0);try{u(o)}finally{va(!1)}}}else _=o;return f.memoizedState=f.baseState=_,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:_},f.queue=r,r=r.dispatch=bI.bind(null,je,r),[f.memoizedState,r]},useRef:function(r){var o=jn();return r={current:r},o.memoizedState=r},useState:function(r){r=xv(r);var o=r.queue,u=IA.bind(null,je,o);return o.dispatch=u,[r.memoizedState,u]},useDebugValue:Av,useDeferredValue:function(r,o){var u=jn();return Ev(u,r,o)},useTransition:function(){var r=xv(!1);return r=CA.bind(null,je,r.queue,!0,!1),jn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,u){var f=je,_=jn();if(Qe){if(u===void 0)throw Error(n(407));u=u()}else{if(u=o(),yt===null)throw Error(n(349));(Xe&127)!==0||nA(f,o,u)}_.memoizedState=u;var w={value:u,getSnapshot:o};return _.queue=w,vA(iA.bind(null,f,w,r),[r]),f.flags|=2048,Gc(9,{destroy:void 0},sA.bind(null,f,w,u,o),null),u},useId:function(){var r=jn(),o=yt.identifierPrefix;if(Qe){var u=ji,f=zi;u=(f&~(1<<32-ps(f)-1)).toString(32)+u,o="_"+o+"R_"+u,u=Im++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=hI++,o="_"+o+"r_"+u.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:Cv,useFormState:fA,useActionState:fA,useOptimistic:function(r){var o=jn();o.memoizedState=o.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=Nv.bind(null,je,!0,u),u.dispatch=o,[r,o]},useMemoCache:vv,useCacheRefresh:function(){return jn().memoizedState=vI.bind(null,je)},useEffectEvent:function(r){var o=jn(),u={impl:r};return o.memoizedState=u,function(){if((at&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},Rv={readContext:yn,use:Pm,useCallback:AA,useContext:yn,useEffect:Sv,useImperativeHandle:SA,useInsertionEffect:_A,useLayoutEffect:xA,useMemo:EA,useReducer:Lm,useRef:yA,useState:function(){return Lm(_r)},useDebugValue:Av,useDeferredValue:function(r,o){var u=Ft();return TA(u,ht.memoizedState,r,o)},useTransition:function(){var r=Lm(_r)[0],o=Ft().memoizedState;return[typeof r=="boolean"?r:yh(r),o]},useSyncExternalStore:tA,useId:kA,useHostTransitionStatus:Cv,useFormState:pA,useActionState:pA,useOptimistic:function(r,o){var u=Ft();return oA(u,ht,r,o)},useMemoCache:vv,useCacheRefresh:MA};Rv.useEffectEvent=bA;var OA={readContext:yn,use:Pm,useCallback:AA,useContext:yn,useEffect:Sv,useImperativeHandle:SA,useInsertionEffect:_A,useLayoutEffect:xA,useMemo:EA,useReducer:_v,useRef:yA,useState:function(){return _v(_r)},useDebugValue:Av,useDeferredValue:function(r,o){var u=Ft();return ht===null?Ev(u,r,o):TA(u,ht.memoizedState,r,o)},useTransition:function(){var r=_v(_r)[0],o=Ft().memoizedState;return[typeof r=="boolean"?r:yh(r),o]},useSyncExternalStore:tA,useId:kA,useHostTransitionStatus:Cv,useFormState:gA,useActionState:gA,useOptimistic:function(r,o){var u=Ft();return ht!==null?oA(u,ht,r,o):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:vv,useCacheRefresh:MA};OA.useEffectEvent=bA;function kv(r,o,u,f){o=r.memoizedState,u=u(f,o),u=u==null?o:v({},o,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var Mv={enqueueSetState:function(r,o,u){r=r._reactInternals;var f=xs(),_=Ta(f);_.payload=o,u!=null&&(_.callback=u),o=Ca(r,_,f),o!==null&&(is(o,r,f),fh(o,r,f))},enqueueReplaceState:function(r,o,u){r=r._reactInternals;var f=xs(),_=Ta(f);_.tag=1,_.payload=o,u!=null&&(_.callback=u),o=Ca(r,_,f),o!==null&&(is(o,r,f),fh(o,r,f))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var u=xs(),f=Ta(u);f.tag=2,o!=null&&(f.callback=o),o=Ca(r,f,u),o!==null&&(is(o,r,u),fh(o,r,u))}};function UA(r,o,u,f,_,w,T){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(f,w,T):o.prototype&&o.prototype.isPureReactComponent?!rh(u,f)||!rh(_,w):!0}function FA(r,o,u,f){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,f),o.state!==r&&Mv.enqueueReplaceState(o,o.state,null)}function $o(r,o){var u=o;if("ref"in o){u={};for(var f in o)f!=="ref"&&(u[f]=o[f])}if(r=r.defaultProps){u===o&&(u=v({},u));for(var _ in r)u[_]===void 0&&(u[_]=r[_])}return u}function zA(r){gm(r)}function jA(r){console.error(r)}function HA(r){gm(r)}function zm(r,o){try{var u=r.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function BA(r,o,u){try{var f=r.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function Iv(r,o,u){return u=Ta(u),u.tag=3,u.payload={element:null},u.callback=function(){zm(r,o)},u}function GA(r){return r=Ta(r),r.tag=3,r}function qA(r,o,u,f){var _=u.type.getDerivedStateFromError;if(typeof _=="function"){var w=f.value;r.payload=function(){return _(w)},r.callback=function(){BA(o,u,f)}}var T=u.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(r.callback=function(){BA(o,u,f),typeof _!="function"&&(Da===null?Da=new Set([this]):Da.add(this));var I=f.stack;this.componentDidCatch(f.value,{componentStack:I!==null?I:""})})}function _I(r,o,u,f,_){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=u.alternate,o!==null&&Lc(o,u,_,!0),u=ys.current,u!==null){switch(u.tag){case 31:case 13:return Ws===null?Wm():u.alternate===null&&Lt===0&&(Lt=3),u.flags&=-257,u.flags|=65536,u.lanes=_,f===Tm?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([f]):o.add(f),sb(r,f,_)),!1;case 22:return u.flags|=65536,f===Tm?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([f]):u.add(f)),sb(r,f,_)),!1}throw Error(n(435,u.tag))}return sb(r,f,_),Wm(),!1}if(Qe)return o=ys.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=_,f!==Wy&&(r=Error(n(422),{cause:f}),lh(Ys(r,u)))):(f!==Wy&&(o=Error(n(423),{cause:f}),lh(Ys(o,u))),r=r.current.alternate,r.flags|=65536,_&=-_,r.lanes|=_,f=Ys(f,u),_=Iv(r.stateNode,f,_),lv(r,_),Lt!==4&&(Lt=2)),!1;var w=Error(n(520),{cause:f});if(w=Ys(w,u),Ch===null?Ch=[w]:Ch.push(w),Lt!==4&&(Lt=2),o===null)return!0;f=Ys(f,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,r=_&-_,u.lanes|=r,r=Iv(u.stateNode,f,r),lv(u,r),!1;case 1:if(o=u.type,w=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Da===null||!Da.has(w))))return u.flags|=65536,_&=-_,u.lanes|=_,_=GA(_),qA(_,r,u,f),lv(u,_),!1}u=u.return}while(u!==null);return!1}var Dv=Error(n(461)),Vt=!1;function vn(r,o,u,f){o.child=r===null?KS(o,null,u,f):qo(o,r.child,u,f)}function VA(r,o,u,f,_){u=u.render;var w=o.ref;if("ref"in f){var T={};for(var I in f)I!=="ref"&&(T[I]=f[I])}else T=f;return jo(o),f=pv(r,o,u,T,w,_),I=mv(),r!==null&&!Vt?(gv(r,o,_),xr(r,o,_)):(Qe&&I&&Jy(o),o.flags|=1,vn(r,o,f,_),o.child)}function $A(r,o,u,f,_){if(r===null){var w=u.type;return typeof w=="function"&&!$y(w)&&w.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=w,YA(r,o,w,f,_)):(r=_m(u.type,null,f,o,o.mode,_),r.ref=o.ref,r.return=o,o.child=r)}if(w=r.child,!Hv(r,_)){var T=w.memoizedProps;if(u=u.compare,u=u!==null?u:rh,u(T,f)&&r.ref===o.ref)return xr(r,o,_)}return o.flags|=1,r=mr(w,f),r.ref=o.ref,r.return=o,o.child=r}function YA(r,o,u,f,_){if(r!==null){var w=r.memoizedProps;if(rh(w,f)&&r.ref===o.ref)if(Vt=!1,o.pendingProps=f=w,Hv(r,_))(r.flags&131072)!==0&&(Vt=!0);else return o.lanes=r.lanes,xr(r,o,_)}return Pv(r,o,u,f,_)}function KA(r,o,u,f){var _=f.children,w=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((o.flags&128)!==0){if(w=w!==null?w.baseLanes|u:u,r!==null){for(f=o.child=r.child,_=0;f!==null;)_=_|f.lanes|f.childLanes,f=f.sibling;f=_&~w}else f=0,o.child=null;return JA(r,o,w,u,f)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Am(o,w!==null?w.cachePool:null),w!==null?WS(o,w):uv(),QS(o);else return f=o.lanes=536870912,JA(r,o,w!==null?w.baseLanes|u:u,u,f)}else w!==null?(Am(o,w.cachePool),WS(o,w),Ra(),o.memoizedState=null):(r!==null&&Am(o,null),uv(),Ra());return vn(r,o,_,u),o.child}function _h(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function JA(r,o,u,f,_){var w=iv();return w=w===null?null:{parent:Gt._currentValue,pool:w},o.memoizedState={baseLanes:u,cachePool:w},r!==null&&Am(o,null),uv(),QS(o),r!==null&&Lc(r,o,f,!0),o.childLanes=_,null}function jm(r,o){return o=Bm({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function XA(r,o,u){return qo(o,r.child,null,u),r=jm(o,o.pendingProps),r.flags|=2,vs(o),o.memoizedState=null,r}function xI(r,o,u){var f=o.pendingProps,_=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Qe){if(f.mode==="hidden")return r=jm(o,f),o.lanes=536870912,_h(null,r);if(hv(o),(r=wt)?(r=l1(r,Xs),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:xa!==null?{id:zi,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},u=DS(r),u.return=o,o.child=u,gn=o,wt=null)):r=null,r===null)throw Sa(o);return o.lanes=536870912,null}return jm(o,f)}var w=r.memoizedState;if(w!==null){var T=w.dehydrated;if(hv(o),_)if(o.flags&256)o.flags&=-257,o=XA(r,o,u);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(n(558));else if(Vt||Lc(r,o,u,!1),_=(u&r.childLanes)!==0,Vt||_){if(f=yt,f!==null&&(T=jw(f,u),T!==0&&T!==w.retryLane))throw w.retryLane=T,Oo(r,T),is(f,r,T),Dv;Wm(),o=XA(r,o,u)}else r=w.treeContext,wt=Qs(T.nextSibling),gn=o,Qe=!0,wa=null,Xs=!1,r!==null&&OS(o,r),o=jm(o,f),o.flags|=4096;return o}return r=mr(r.child,{mode:f.mode,children:f.children}),r.ref=o.ref,o.child=r,r.return=o,r}function Hm(r,o){var u=o.ref;if(u===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(r===null||r.ref!==u)&&(o.flags|=4194816)}}function Pv(r,o,u,f,_){return jo(o),u=pv(r,o,u,f,void 0,_),f=mv(),r!==null&&!Vt?(gv(r,o,_),xr(r,o,_)):(Qe&&f&&Jy(o),o.flags|=1,vn(r,o,u,_),o.child)}function WA(r,o,u,f,_,w){return jo(o),o.updateQueue=null,u=eA(o,f,u,_),ZS(r),f=mv(),r!==null&&!Vt?(gv(r,o,w),xr(r,o,w)):(Qe&&f&&Jy(o),o.flags|=1,vn(r,o,u,w),o.child)}function QA(r,o,u,f,_){if(jo(o),o.stateNode===null){var w=Mc,T=u.contextType;typeof T=="object"&&T!==null&&(w=yn(T)),w=new u(f,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=Mv,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=f,w.state=o.memoizedState,w.refs={},av(o),T=u.contextType,w.context=typeof T=="object"&&T!==null?yn(T):Mc,w.state=o.memoizedState,T=u.getDerivedStateFromProps,typeof T=="function"&&(kv(o,u,T,f),w.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(T=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),T!==w.state&&Mv.enqueueReplaceState(w,w.state,null),mh(o,f,w,_),ph(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(r===null){w=o.stateNode;var I=o.memoizedProps,F=$o(u,I);w.props=F;var V=w.context,Q=u.contextType;T=Mc,typeof Q=="object"&&Q!==null&&(T=yn(Q));var te=u.getDerivedStateFromProps;Q=typeof te=="function"||typeof w.getSnapshotBeforeUpdate=="function",I=o.pendingProps!==I,Q||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(I||V!==T)&&FA(o,w,f,T),Ea=!1;var Y=o.memoizedState;w.state=Y,mh(o,f,w,_),ph(),V=o.memoizedState,I||Y!==V||Ea?(typeof te=="function"&&(kv(o,u,te,f),V=o.memoizedState),(F=Ea||UA(o,u,F,f,Y,V,T))?(Q||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=V),w.props=f,w.state=V,w.context=T,f=F):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{w=o.stateNode,ov(r,o),T=o.memoizedProps,Q=$o(u,T),w.props=Q,te=o.pendingProps,Y=w.context,V=u.contextType,F=Mc,typeof V=="object"&&V!==null&&(F=yn(V)),I=u.getDerivedStateFromProps,(V=typeof I=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(T!==te||Y!==F)&&FA(o,w,f,F),Ea=!1,Y=o.memoizedState,w.state=Y,mh(o,f,w,_),ph();var W=o.memoizedState;T!==te||Y!==W||Ea||r!==null&&r.dependencies!==null&&wm(r.dependencies)?(typeof I=="function"&&(kv(o,u,I,f),W=o.memoizedState),(Q=Ea||UA(o,u,Q,f,Y,W,F)||r!==null&&r.dependencies!==null&&wm(r.dependencies))?(V||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(f,W,F),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(f,W,F)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||T===r.memoizedProps&&Y===r.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&Y===r.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=W),w.props=f,w.state=W,w.context=F,f=Q):(typeof w.componentDidUpdate!="function"||T===r.memoizedProps&&Y===r.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&Y===r.memoizedState||(o.flags|=1024),f=!1)}return w=f,Hm(r,o),f=(o.flags&128)!==0,w||f?(w=o.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,r!==null&&f?(o.child=qo(o,r.child,null,_),o.child=qo(o,null,u,_)):vn(r,o,u,_),o.memoizedState=w.state,r=o.child):r=xr(r,o,_),r}function ZA(r,o,u,f){return Fo(),o.flags|=256,vn(r,o,u,f),o.child}var Lv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ov(r){return{baseLanes:r,cachePool:BS()}}function Uv(r,o,u){return r=r!==null?r.childLanes&~u:0,o&&(r|=_s),r}function eE(r,o,u){var f=o.pendingProps,_=!1,w=(o.flags&128)!==0,T;if((T=w)||(T=r!==null&&r.memoizedState===null?!1:(Ut.current&2)!==0),T&&(_=!0,o.flags&=-129),T=(o.flags&32)!==0,o.flags&=-33,r===null){if(Qe){if(_?Na(o):Ra(),(r=wt)?(r=l1(r,Xs),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:xa!==null?{id:zi,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},u=DS(r),u.return=o,o.child=u,gn=o,wt=null)):r=null,r===null)throw Sa(o);return bb(r)?o.lanes=32:o.lanes=536870912,null}var I=f.children;return f=f.fallback,_?(Ra(),_=o.mode,I=Bm({mode:"hidden",children:I},_),f=Uo(f,_,u,null),I.return=o,f.return=o,I.sibling=f,o.child=I,f=o.child,f.memoizedState=Ov(u),f.childLanes=Uv(r,T,u),o.memoizedState=Lv,_h(null,f)):(Na(o),Fv(o,I))}var F=r.memoizedState;if(F!==null&&(I=F.dehydrated,I!==null)){if(w)o.flags&256?(Na(o),o.flags&=-257,o=zv(r,o,u)):o.memoizedState!==null?(Ra(),o.child=r.child,o.flags|=128,o=null):(Ra(),I=f.fallback,_=o.mode,f=Bm({mode:"visible",children:f.children},_),I=Uo(I,_,u,null),I.flags|=2,f.return=o,I.return=o,f.sibling=I,o.child=f,qo(o,r.child,null,u),f=o.child,f.memoizedState=Ov(u),f.childLanes=Uv(r,T,u),o.memoizedState=Lv,o=_h(null,f));else if(Na(o),bb(I)){if(T=I.nextSibling&&I.nextSibling.dataset,T)var V=T.dgst;T=V,f=Error(n(419)),f.stack="",f.digest=T,lh({value:f,source:null,stack:null}),o=zv(r,o,u)}else if(Vt||Lc(r,o,u,!1),T=(u&r.childLanes)!==0,Vt||T){if(T=yt,T!==null&&(f=jw(T,u),f!==0&&f!==F.retryLane))throw F.retryLane=f,Oo(r,f),is(T,r,f),Dv;vb(I)||Wm(),o=zv(r,o,u)}else vb(I)?(o.flags|=192,o.child=r.child,o=null):(r=F.treeContext,wt=Qs(I.nextSibling),gn=o,Qe=!0,wa=null,Xs=!1,r!==null&&OS(o,r),o=Fv(o,f.children),o.flags|=4096);return o}return _?(Ra(),I=f.fallback,_=o.mode,F=r.child,V=F.sibling,f=mr(F,{mode:"hidden",children:f.children}),f.subtreeFlags=F.subtreeFlags&65011712,V!==null?I=mr(V,I):(I=Uo(I,_,u,null),I.flags|=2),I.return=o,f.return=o,f.sibling=I,o.child=f,_h(null,f),f=o.child,I=r.child.memoizedState,I===null?I=Ov(u):(_=I.cachePool,_!==null?(F=Gt._currentValue,_=_.parent!==F?{parent:F,pool:F}:_):_=BS(),I={baseLanes:I.baseLanes|u,cachePool:_}),f.memoizedState=I,f.childLanes=Uv(r,T,u),o.memoizedState=Lv,_h(r.child,f)):(Na(o),u=r.child,r=u.sibling,u=mr(u,{mode:"visible",children:f.children}),u.return=o,u.sibling=null,r!==null&&(T=o.deletions,T===null?(o.deletions=[r],o.flags|=16):T.push(r)),o.child=u,o.memoizedState=null,u)}function Fv(r,o){return o=Bm({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function Bm(r,o){return r=gs(22,r,null,o),r.lanes=0,r}function zv(r,o,u){return qo(o,r.child,null,u),r=Fv(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function tE(r,o,u){r.lanes|=o;var f=r.alternate;f!==null&&(f.lanes|=o),ev(r.return,o,u)}function jv(r,o,u,f,_,w){var T=r.memoizedState;T===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:_,treeForkCount:w}:(T.isBackwards=o,T.rendering=null,T.renderingStartTime=0,T.last=f,T.tail=u,T.tailMode=_,T.treeForkCount=w)}function nE(r,o,u){var f=o.pendingProps,_=f.revealOrder,w=f.tail;f=f.children;var T=Ut.current,I=(T&2)!==0;if(I?(T=T&1|2,o.flags|=128):T&=1,se(Ut,T),vn(r,o,f,u),f=Qe?oh:0,!I&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&tE(r,u,o);else if(r.tag===19)tE(r,u,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(_){case"forwards":for(u=o.child,_=null;u!==null;)r=u.alternate,r!==null&&km(r)===null&&(_=u),u=u.sibling;u=_,u===null?(_=o.child,o.child=null):(_=u.sibling,u.sibling=null),jv(o,!1,_,u,w,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,_=o.child,o.child=null;_!==null;){if(r=_.alternate,r!==null&&km(r)===null){o.child=_;break}r=_.sibling,_.sibling=u,u=_,_=r}jv(o,!0,u,null,w,f);break;case"together":jv(o,!1,null,null,void 0,f);break;default:o.memoizedState=null}return o.child}function xr(r,o,u){if(r!==null&&(o.dependencies=r.dependencies),Ia|=o.lanes,(u&o.childLanes)===0)if(r!==null){if(Lc(r,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,u=mr(r,r.pendingProps),o.child=u,u.return=o;r.sibling!==null;)r=r.sibling,u=u.sibling=mr(r,r.pendingProps),u.return=o;u.sibling=null}return o.child}function Hv(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&wm(r)))}function wI(r,o,u){switch(o.tag){case 3:ze(o,o.stateNode.containerInfo),Aa(o,Gt,r.memoizedState.cache),Fo();break;case 27:case 5:Bt(o);break;case 4:ze(o,o.stateNode.containerInfo);break;case 10:Aa(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,hv(o),null;break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(Na(o),o.flags|=128,null):(u&o.child.childLanes)!==0?eE(r,o,u):(Na(o),r=xr(r,o,u),r!==null?r.sibling:null);Na(o);break;case 19:var _=(r.flags&128)!==0;if(f=(u&o.childLanes)!==0,f||(Lc(r,o,u,!1),f=(u&o.childLanes)!==0),_){if(f)return nE(r,o,u);o.flags|=128}if(_=o.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),se(Ut,Ut.current),f)break;return null;case 22:return o.lanes=0,KA(r,o,u,o.pendingProps);case 24:Aa(o,Gt,r.memoizedState.cache)}return xr(r,o,u)}function sE(r,o,u){if(r!==null)if(r.memoizedProps!==o.pendingProps)Vt=!0;else{if(!Hv(r,u)&&(o.flags&128)===0)return Vt=!1,wI(r,o,u);Vt=(r.flags&131072)!==0}else Vt=!1,Qe&&(o.flags&1048576)!==0&&LS(o,oh,o.index);switch(o.lanes=0,o.tag){case 16:e:{var f=o.pendingProps;if(r=Bo(o.elementType),o.type=r,typeof r=="function")$y(r)?(f=$o(r,f),o.tag=1,o=QA(null,o,r,f,u)):(o.tag=0,o=Pv(null,o,r,f,u));else{if(r!=null){var _=r.$$typeof;if(_===L){o.tag=11,o=VA(null,o,r,f,u);break e}else if(_===U){o.tag=14,o=$A(null,o,r,f,u);break e}}throw o=de(r)||r,Error(n(306,o,""))}}return o;case 0:return Pv(r,o,o.type,o.pendingProps,u);case 1:return f=o.type,_=$o(f,o.pendingProps),QA(r,o,f,_,u);case 3:e:{if(ze(o,o.stateNode.containerInfo),r===null)throw Error(n(387));f=o.pendingProps;var w=o.memoizedState;_=w.element,ov(r,o),mh(o,f,null,u);var T=o.memoizedState;if(f=T.cache,Aa(o,Gt,f),f!==w.cache&&tv(o,[Gt],u,!0),ph(),f=T.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:T.cache},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){o=ZA(r,o,f,u);break e}else if(f!==_){_=Ys(Error(n(424)),o),lh(_),o=ZA(r,o,f,u);break e}else{switch(r=o.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(wt=Qs(r.firstChild),gn=o,Qe=!0,wa=null,Xs=!0,u=KS(o,null,f,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Fo(),f===_){o=xr(r,o,u);break e}vn(r,o,f,u)}o=o.child}return o;case 26:return Hm(r,o),r===null?(u=p1(o.type,null,o.pendingProps,null))?o.memoizedState=u:Qe||(u=o.type,r=o.pendingProps,f=ig(re.current).createElement(u),f[mn]=o,f[Qn]=r,bn(f,u,r),rn(f),o.stateNode=f):o.memoizedState=p1(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Bt(o),r===null&&Qe&&(f=o.stateNode=d1(o.type,o.pendingProps,re.current),gn=o,Xs=!0,_=wt,Ua(o.type)?(_b=_,wt=Qs(f.firstChild)):wt=_),vn(r,o,o.pendingProps.children,u),Hm(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Qe&&((_=f=wt)&&(f=QI(f,o.type,o.pendingProps,Xs),f!==null?(o.stateNode=f,gn=o,wt=Qs(f.firstChild),Xs=!1,_=!0):_=!1),_||Sa(o)),Bt(o),_=o.type,w=o.pendingProps,T=r!==null?r.memoizedProps:null,f=w.children,mb(_,w)?f=null:T!==null&&mb(_,T)&&(o.flags|=32),o.memoizedState!==null&&(_=pv(r,o,fI,null,null,u),Lh._currentValue=_),Hm(r,o),vn(r,o,f,u),o.child;case 6:return r===null&&Qe&&((r=u=wt)&&(u=ZI(u,o.pendingProps,Xs),u!==null?(o.stateNode=u,gn=o,wt=null,r=!0):r=!1),r||Sa(o)),null;case 13:return eE(r,o,u);case 4:return ze(o,o.stateNode.containerInfo),f=o.pendingProps,r===null?o.child=qo(o,null,f,u):vn(r,o,f,u),o.child;case 11:return VA(r,o,o.type,o.pendingProps,u);case 7:return vn(r,o,o.pendingProps,u),o.child;case 8:return vn(r,o,o.pendingProps.children,u),o.child;case 12:return vn(r,o,o.pendingProps.children,u),o.child;case 10:return f=o.pendingProps,Aa(o,o.type,f.value),vn(r,o,f.children,u),o.child;case 9:return _=o.type._context,f=o.pendingProps.children,jo(o),_=yn(_),f=f(_),o.flags|=1,vn(r,o,f,u),o.child;case 14:return $A(r,o,o.type,o.pendingProps,u);case 15:return YA(r,o,o.type,o.pendingProps,u);case 19:return nE(r,o,u);case 31:return xI(r,o,u);case 22:return KA(r,o,u,o.pendingProps);case 24:return jo(o),f=yn(Gt),r===null?(_=iv(),_===null&&(_=yt,w=nv(),_.pooledCache=w,w.refCount++,w!==null&&(_.pooledCacheLanes|=u),_=w),o.memoizedState={parent:f,cache:_},av(o),Aa(o,Gt,_)):((r.lanes&u)!==0&&(ov(r,o),mh(o,null,null,u),ph()),_=r.memoizedState,w=o.memoizedState,_.parent!==f?(_={parent:f,cache:f},o.memoizedState=_,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=_),Aa(o,Gt,f)):(f=w.cache,Aa(o,Gt,f),f!==_.cache&&tv(o,[Gt],u,!0))),vn(r,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function wr(r){r.flags|=4}function Bv(r,o,u,f,_){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(_&335544128)===_)if(r.stateNode.complete)r.flags|=8192;else if(kE())r.flags|=8192;else throw Go=Tm,rv}else r.flags&=-16777217}function iE(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!b1(o))if(kE())r.flags|=8192;else throw Go=Tm,rv}function Gm(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?Uw():536870912,r.lanes|=o,Yc|=o)}function xh(r,o){if(!Qe)switch(r.tailMode){case"hidden":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:f.sibling=null}}function St(r){var o=r.alternate!==null&&r.alternate.child===r.child,u=0,f=0;if(o)for(var _=r.child;_!==null;)u|=_.lanes|_.childLanes,f|=_.subtreeFlags&65011712,f|=_.flags&65011712,_.return=r,_=_.sibling;else for(_=r.child;_!==null;)u|=_.lanes|_.childLanes,f|=_.subtreeFlags,f|=_.flags,_.return=r,_=_.sibling;return r.subtreeFlags|=f,r.childLanes=u,o}function SI(r,o,u){var f=o.pendingProps;switch(Xy(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(o),null;case 1:return St(o),null;case 3:return u=o.stateNode,f=null,r!==null&&(f=r.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),vr(Gt),Le(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(Pc(o)?wr(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Qy())),St(o),null;case 26:var _=o.type,w=o.memoizedState;return r===null?(wr(o),w!==null?(St(o),iE(o,w)):(St(o),Bv(o,_,null,f,u))):w?w!==r.memoizedState?(wr(o),St(o),iE(o,w)):(St(o),o.flags&=-16777217):(r=r.memoizedProps,r!==f&&wr(o),St(o),Bv(o,_,r,f,u)),null;case 27:if(ur(o),u=re.current,_=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&wr(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return St(o),null}r=ce.current,Pc(o)?US(o):(r=d1(_,f,u),o.stateNode=r,wr(o))}return St(o),null;case 5:if(ur(o),_=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&wr(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return St(o),null}if(w=ce.current,Pc(o))US(o);else{var T=ig(re.current);switch(w){case 1:w=T.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:w=T.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":w=T.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":w=T.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":w=T.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof f.is=="string"?T.createElement("select",{is:f.is}):T.createElement("select"),f.multiple?w.multiple=!0:f.size&&(w.size=f.size);break;default:w=typeof f.is=="string"?T.createElement(_,{is:f.is}):T.createElement(_)}}w[mn]=o,w[Qn]=f;e:for(T=o.child;T!==null;){if(T.tag===5||T.tag===6)w.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===o)break e;for(;T.sibling===null;){if(T.return===null||T.return===o)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}o.stateNode=w;e:switch(bn(w,_,f),_){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&wr(o)}}return St(o),Bv(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,u),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==f&&wr(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(n(166));if(r=re.current,Pc(o)){if(r=o.stateNode,u=o.memoizedProps,f=null,_=gn,_!==null)switch(_.tag){case 27:case 5:f=_.memoizedProps}r[mn]=o,r=!!(r.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||e1(r.nodeValue,u)),r||Sa(o,!0)}else r=ig(r).createTextNode(f),r[mn]=o,o.stateNode=r}return St(o),null;case 31:if(u=o.memoizedState,r===null||r.memoizedState!==null){if(f=Pc(o),u!==null){if(r===null){if(!f)throw Error(n(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[mn]=o}else Fo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;St(o),r=!1}else u=Qy(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return o.flags&256?(vs(o),o):(vs(o),null);if((o.flags&128)!==0)throw Error(n(558))}return St(o),null;case 13:if(f=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(_=Pc(o),f!==null&&f.dehydrated!==null){if(r===null){if(!_)throw Error(n(318));if(_=o.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(n(317));_[mn]=o}else Fo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;St(o),_=!1}else _=Qy(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=_),_=!0;if(!_)return o.flags&256?(vs(o),o):(vs(o),null)}return vs(o),(o.flags&128)!==0?(o.lanes=u,o):(u=f!==null,r=r!==null&&r.memoizedState!==null,u&&(f=o.child,_=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(_=f.alternate.memoizedState.cachePool.pool),w=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(w=f.memoizedState.cachePool.pool),w!==_&&(f.flags|=2048)),u!==r&&u&&(o.child.flags|=8192),Gm(o,o.updateQueue),St(o),null);case 4:return Le(),r===null&&ub(o.stateNode.containerInfo),St(o),null;case 10:return vr(o.type),St(o),null;case 19:if($(Ut),f=o.memoizedState,f===null)return St(o),null;if(_=(o.flags&128)!==0,w=f.rendering,w===null)if(_)xh(f,!1);else{if(Lt!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(w=km(r),w!==null){for(o.flags|=128,xh(f,!1),r=w.updateQueue,o.updateQueue=r,Gm(o,r),o.subtreeFlags=0,r=u,u=o.child;u!==null;)IS(u,r),u=u.sibling;return se(Ut,Ut.current&1|2),Qe&&gr(o,f.treeForkCount),o.child}r=r.sibling}f.tail!==null&&hs()>Km&&(o.flags|=128,_=!0,xh(f,!1),o.lanes=4194304)}else{if(!_)if(r=km(w),r!==null){if(o.flags|=128,_=!0,r=r.updateQueue,o.updateQueue=r,Gm(o,r),xh(f,!0),f.tail===null&&f.tailMode==="hidden"&&!w.alternate&&!Qe)return St(o),null}else 2*hs()-f.renderingStartTime>Km&&u!==536870912&&(o.flags|=128,_=!0,xh(f,!1),o.lanes=4194304);f.isBackwards?(w.sibling=o.child,o.child=w):(r=f.last,r!==null?r.sibling=w:o.child=w,f.last=w)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=hs(),r.sibling=null,u=Ut.current,se(Ut,_?u&1|2:u&1),Qe&&gr(o,f.treeForkCount),r):(St(o),null);case 22:case 23:return vs(o),dv(),f=o.memoizedState!==null,r!==null?r.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(u&536870912)!==0&&(o.flags&128)===0&&(St(o),o.subtreeFlags&6&&(o.flags|=8192)):St(o),u=o.updateQueue,u!==null&&Gm(o,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==u&&(o.flags|=2048),r!==null&&$(Ho),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),vr(Gt),St(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function AI(r,o){switch(Xy(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return vr(Gt),Le(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return ur(o),null;case 31:if(o.memoizedState!==null){if(vs(o),o.alternate===null)throw Error(n(340));Fo()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(vs(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Fo()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return $(Ut),null;case 4:return Le(),null;case 10:return vr(o.type),null;case 22:case 23:return vs(o),dv(),r!==null&&$(Ho),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return vr(Gt),null;case 25:return null;default:return null}}function rE(r,o){switch(Xy(o),o.tag){case 3:vr(Gt),Le();break;case 26:case 27:case 5:ur(o);break;case 4:Le();break;case 31:o.memoizedState!==null&&vs(o);break;case 13:vs(o);break;case 19:$(Ut);break;case 10:vr(o.type);break;case 22:case 23:vs(o),dv(),r!==null&&$(Ho);break;case 24:vr(Gt)}}function wh(r,o){try{var u=o.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var _=f.next;u=_;do{if((u.tag&r)===r){f=void 0;var w=u.create,T=u.inst;f=w(),T.destroy=f}u=u.next}while(u!==_)}}catch(I){ct(o,o.return,I)}}function ka(r,o,u){try{var f=o.updateQueue,_=f!==null?f.lastEffect:null;if(_!==null){var w=_.next;f=w;do{if((f.tag&r)===r){var T=f.inst,I=T.destroy;if(I!==void 0){T.destroy=void 0,_=o;var F=u,V=I;try{V()}catch(Q){ct(_,F,Q)}}}f=f.next}while(f!==w)}}catch(Q){ct(o,o.return,Q)}}function aE(r){var o=r.updateQueue;if(o!==null){var u=r.stateNode;try{XS(o,u)}catch(f){ct(r,r.return,f)}}}function oE(r,o,u){u.props=$o(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(f){ct(r,o,f)}}function Sh(r,o){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var f=r.stateNode;break;case 30:f=r.stateNode;break;default:f=r.stateNode}typeof u=="function"?r.refCleanup=u(f):u.current=f}}catch(_){ct(r,o,_)}}function Hi(r,o){var u=r.ref,f=r.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(_){ct(r,o,_)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(_){ct(r,o,_)}else u.current=null}function lE(r){var o=r.type,u=r.memoizedProps,f=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(_){ct(r,r.return,_)}}function Gv(r,o,u){try{var f=r.stateNode;$I(f,r.type,u,o),f[Qn]=o}catch(_){ct(r,r.return,_)}}function cE(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Ua(r.type)||r.tag===4}function qv(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||cE(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Ua(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Vv(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(r),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=fr));else if(f!==4&&(f===27&&Ua(r.type)&&(u=r.stateNode,o=null),r=r.child,r!==null))for(Vv(r,o,u),r=r.sibling;r!==null;)Vv(r,o,u),r=r.sibling}function qm(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?u.insertBefore(r,o):u.appendChild(r);else if(f!==4&&(f===27&&Ua(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(qm(r,o,u),r=r.sibling;r!==null;)qm(r,o,u),r=r.sibling}function uE(r){var o=r.stateNode,u=r.memoizedProps;try{for(var f=r.type,_=o.attributes;_.length;)o.removeAttributeNode(_[0]);bn(o,f,u),o[mn]=r,o[Qn]=u}catch(w){ct(r,r.return,w)}}var Sr=!1,$t=!1,$v=!1,dE=typeof WeakSet=="function"?WeakSet:Set,an=null;function EI(r,o){if(r=r.containerInfo,fb=dg,r=SS(r),zy(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var _=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var T=0,I=-1,F=-1,V=0,Q=0,te=r,Y=null;t:for(;;){for(var W;te!==u||_!==0&&te.nodeType!==3||(I=T+_),te!==w||f!==0&&te.nodeType!==3||(F=T+f),te.nodeType===3&&(T+=te.nodeValue.length),(W=te.firstChild)!==null;)Y=te,te=W;for(;;){if(te===r)break t;if(Y===u&&++V===_&&(I=T),Y===w&&++Q===f&&(F=T),(W=te.nextSibling)!==null)break;te=Y,Y=te.parentNode}te=W}u=I===-1||F===-1?null:{start:I,end:F}}else u=null}u=u||{start:0,end:0}}else u=null;for(pb={focusedElem:r,selectionRange:u},dg=!1,an=o;an!==null;)if(o=an,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,an=r;else for(;an!==null;){switch(o=an,w=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)_=r[u],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&w!==null){r=void 0,u=o,_=w.memoizedProps,w=w.memoizedState,f=u.stateNode;try{var be=$o(u.type,_);r=f.getSnapshotBeforeUpdate(be,w),f.__reactInternalSnapshotBeforeUpdate=r}catch(ke){ct(u,u.return,ke)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,u=r.nodeType,u===9)yb(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":yb(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,an=r;break}an=o.return}}function hE(r,o,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:Er(r,u),f&4&&wh(5,u);break;case 1:if(Er(r,u),f&4)if(r=u.stateNode,o===null)try{r.componentDidMount()}catch(T){ct(u,u.return,T)}else{var _=$o(u.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(_,o,r.__reactInternalSnapshotBeforeUpdate)}catch(T){ct(u,u.return,T)}}f&64&&aE(u),f&512&&Sh(u,u.return);break;case 3:if(Er(r,u),f&64&&(r=u.updateQueue,r!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{XS(r,o)}catch(T){ct(u,u.return,T)}}break;case 27:o===null&&f&4&&uE(u);case 26:case 5:Er(r,u),o===null&&f&4&&lE(u),f&512&&Sh(u,u.return);break;case 12:Er(r,u);break;case 31:Er(r,u),f&4&&mE(r,u);break;case 13:Er(r,u),f&4&&gE(r,u),f&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=PI.bind(null,u),eD(r,u))));break;case 22:if(f=u.memoizedState!==null||Sr,!f){o=o!==null&&o.memoizedState!==null||$t,_=Sr;var w=$t;Sr=f,($t=o)&&!w?Tr(r,u,(u.subtreeFlags&8772)!==0):Er(r,u),Sr=_,$t=w}break;case 30:break;default:Er(r,u)}}function fE(r){var o=r.alternate;o!==null&&(r.alternate=null,fE(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&wy(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Et=null,es=!1;function Ar(r,o,u){for(u=u.child;u!==null;)pE(r,o,u),u=u.sibling}function pE(r,o,u){if(fs&&typeof fs.onCommitFiberUnmount=="function")try{fs.onCommitFiberUnmount(Yd,u)}catch{}switch(u.tag){case 26:$t||Hi(u,o),Ar(r,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:$t||Hi(u,o);var f=Et,_=es;Ua(u.type)&&(Et=u.stateNode,es=!1),Ar(r,o,u),Ih(u.stateNode),Et=f,es=_;break;case 5:$t||Hi(u,o);case 6:if(f=Et,_=es,Et=null,Ar(r,o,u),Et=f,es=_,Et!==null)if(es)try{(Et.nodeType===9?Et.body:Et.nodeName==="HTML"?Et.ownerDocument.body:Et).removeChild(u.stateNode)}catch(w){ct(u,o,w)}else try{Et.removeChild(u.stateNode)}catch(w){ct(u,o,w)}break;case 18:Et!==null&&(es?(r=Et,a1(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),tu(r)):a1(Et,u.stateNode));break;case 4:f=Et,_=es,Et=u.stateNode.containerInfo,es=!0,Ar(r,o,u),Et=f,es=_;break;case 0:case 11:case 14:case 15:ka(2,u,o),$t||ka(4,u,o),Ar(r,o,u);break;case 1:$t||(Hi(u,o),f=u.stateNode,typeof f.componentWillUnmount=="function"&&oE(u,o,f)),Ar(r,o,u);break;case 21:Ar(r,o,u);break;case 22:$t=(f=$t)||u.memoizedState!==null,Ar(r,o,u),$t=f;break;default:Ar(r,o,u)}}function mE(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{tu(r)}catch(u){ct(o,o.return,u)}}}function gE(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{tu(r)}catch(u){ct(o,o.return,u)}}function TI(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new dE),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new dE),o;default:throw Error(n(435,r.tag))}}function Vm(r,o){var u=TI(r);o.forEach(function(f){if(!u.has(f)){u.add(f);var _=LI.bind(null,r,f);f.then(_,_)}})}function ts(r,o){var u=o.deletions;if(u!==null)for(var f=0;f<u.length;f++){var _=u[f],w=r,T=o,I=T;e:for(;I!==null;){switch(I.tag){case 27:if(Ua(I.type)){Et=I.stateNode,es=!1;break e}break;case 5:Et=I.stateNode,es=!1;break e;case 3:case 4:Et=I.stateNode.containerInfo,es=!0;break e}I=I.return}if(Et===null)throw Error(n(160));pE(w,T,_),Et=null,es=!1,w=_.alternate,w!==null&&(w.return=null),_.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)yE(o,r),o=o.sibling}var pi=null;function yE(r,o){var u=r.alternate,f=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:ts(o,r),ns(r),f&4&&(ka(3,r,r.return),wh(3,r),ka(5,r,r.return));break;case 1:ts(o,r),ns(r),f&512&&($t||u===null||Hi(u,u.return)),f&64&&Sr&&(r=r.updateQueue,r!==null&&(f=r.callbacks,f!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var _=pi;if(ts(o,r),ns(r),f&512&&($t||u===null||Hi(u,u.return)),f&4){var w=u!==null?u.memoizedState:null;if(f=r.memoizedState,u===null)if(f===null)if(r.stateNode===null){e:{f=r.type,u=r.memoizedProps,_=_.ownerDocument||_;t:switch(f){case"title":w=_.getElementsByTagName("title")[0],(!w||w[Xd]||w[mn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=_.createElement(f),_.head.insertBefore(w,_.querySelector("head > title"))),bn(w,f,u),w[mn]=r,rn(w),f=w;break e;case"link":var T=y1("link","href",_).get(f+(u.href||""));if(T){for(var I=0;I<T.length;I++)if(w=T[I],w.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&w.getAttribute("rel")===(u.rel==null?null:u.rel)&&w.getAttribute("title")===(u.title==null?null:u.title)&&w.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){T.splice(I,1);break t}}w=_.createElement(f),bn(w,f,u),_.head.appendChild(w);break;case"meta":if(T=y1("meta","content",_).get(f+(u.content||""))){for(I=0;I<T.length;I++)if(w=T[I],w.getAttribute("content")===(u.content==null?null:""+u.content)&&w.getAttribute("name")===(u.name==null?null:u.name)&&w.getAttribute("property")===(u.property==null?null:u.property)&&w.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&w.getAttribute("charset")===(u.charSet==null?null:u.charSet)){T.splice(I,1);break t}}w=_.createElement(f),bn(w,f,u),_.head.appendChild(w);break;default:throw Error(n(468,f))}w[mn]=r,rn(w),f=w}r.stateNode=f}else v1(_,r.type,r.stateNode);else r.stateNode=g1(_,f,r.memoizedProps);else w!==f?(w===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):w.count--,f===null?v1(_,r.type,r.stateNode):g1(_,f,r.memoizedProps)):f===null&&r.stateNode!==null&&Gv(r,r.memoizedProps,u.memoizedProps)}break;case 27:ts(o,r),ns(r),f&512&&($t||u===null||Hi(u,u.return)),u!==null&&f&4&&Gv(r,r.memoizedProps,u.memoizedProps);break;case 5:if(ts(o,r),ns(r),f&512&&($t||u===null||Hi(u,u.return)),r.flags&32){_=r.stateNode;try{Ac(_,"")}catch(be){ct(r,r.return,be)}}f&4&&r.stateNode!=null&&(_=r.memoizedProps,Gv(r,_,u!==null?u.memoizedProps:_)),f&1024&&($v=!0);break;case 6:if(ts(o,r),ns(r),f&4){if(r.stateNode===null)throw Error(n(162));f=r.memoizedProps,u=r.stateNode;try{u.nodeValue=f}catch(be){ct(r,r.return,be)}}break;case 3:if(og=null,_=pi,pi=rg(o.containerInfo),ts(o,r),pi=_,ns(r),f&4&&u!==null&&u.memoizedState.isDehydrated)try{tu(o.containerInfo)}catch(be){ct(r,r.return,be)}$v&&($v=!1,vE(r));break;case 4:f=pi,pi=rg(r.stateNode.containerInfo),ts(o,r),ns(r),pi=f;break;case 12:ts(o,r),ns(r);break;case 31:ts(o,r),ns(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Vm(r,f)));break;case 13:ts(o,r),ns(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Ym=hs()),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Vm(r,f)));break;case 22:_=r.memoizedState!==null;var F=u!==null&&u.memoizedState!==null,V=Sr,Q=$t;if(Sr=V||_,$t=Q||F,ts(o,r),$t=Q,Sr=V,ns(r),f&8192)e:for(o=r.stateNode,o._visibility=_?o._visibility&-2:o._visibility|1,_&&(u===null||F||Sr||$t||Yo(r)),u=null,o=r;;){if(o.tag===5||o.tag===26){if(u===null){F=u=o;try{if(w=F.stateNode,_)T=w.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{I=F.stateNode;var te=F.memoizedProps.style,Y=te!=null&&te.hasOwnProperty("display")?te.display:null;I.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(be){ct(F,F.return,be)}}}else if(o.tag===6){if(u===null){F=o;try{F.stateNode.nodeValue=_?"":F.memoizedProps}catch(be){ct(F,F.return,be)}}}else if(o.tag===18){if(u===null){F=o;try{var W=F.stateNode;_?o1(W,!0):o1(F.stateNode,!1)}catch(be){ct(F,F.return,be)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=r.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,Vm(r,u))));break;case 19:ts(o,r),ns(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Vm(r,f)));break;case 30:break;case 21:break;default:ts(o,r),ns(r)}}function ns(r){var o=r.flags;if(o&2){try{for(var u,f=r.return;f!==null;){if(cE(f)){u=f;break}f=f.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var _=u.stateNode,w=qv(r);qm(r,w,_);break;case 5:var T=u.stateNode;u.flags&32&&(Ac(T,""),u.flags&=-33);var I=qv(r);qm(r,I,T);break;case 3:case 4:var F=u.stateNode.containerInfo,V=qv(r);Vv(r,V,F);break;default:throw Error(n(161))}}catch(Q){ct(r,r.return,Q)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function vE(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;vE(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function Er(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)hE(r,o.alternate,o),o=o.sibling}function Yo(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:ka(4,o,o.return),Yo(o);break;case 1:Hi(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&oE(o,o.return,u),Yo(o);break;case 27:Ih(o.stateNode);case 26:case 5:Hi(o,o.return),Yo(o);break;case 22:o.memoizedState===null&&Yo(o);break;case 30:Yo(o);break;default:Yo(o)}r=r.sibling}}function Tr(r,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,_=r,w=o,T=w.flags;switch(w.tag){case 0:case 11:case 15:Tr(_,w,u),wh(4,w);break;case 1:if(Tr(_,w,u),f=w,_=f.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(V){ct(f,f.return,V)}if(f=w,_=f.updateQueue,_!==null){var I=f.stateNode;try{var F=_.shared.hiddenCallbacks;if(F!==null)for(_.shared.hiddenCallbacks=null,_=0;_<F.length;_++)JS(F[_],I)}catch(V){ct(f,f.return,V)}}u&&T&64&&aE(w),Sh(w,w.return);break;case 27:uE(w);case 26:case 5:Tr(_,w,u),u&&f===null&&T&4&&lE(w),Sh(w,w.return);break;case 12:Tr(_,w,u);break;case 31:Tr(_,w,u),u&&T&4&&mE(_,w);break;case 13:Tr(_,w,u),u&&T&4&&gE(_,w);break;case 22:w.memoizedState===null&&Tr(_,w,u),Sh(w,w.return);break;case 30:break;default:Tr(_,w,u)}o=o.sibling}}function Yv(r,o){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&ch(u))}function Kv(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&ch(r))}function mi(r,o,u,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)bE(r,o,u,f),o=o.sibling}function bE(r,o,u,f){var _=o.flags;switch(o.tag){case 0:case 11:case 15:mi(r,o,u,f),_&2048&&wh(9,o);break;case 1:mi(r,o,u,f);break;case 3:mi(r,o,u,f),_&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&ch(r)));break;case 12:if(_&2048){mi(r,o,u,f),r=o.stateNode;try{var w=o.memoizedProps,T=w.id,I=w.onPostCommit;typeof I=="function"&&I(T,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(F){ct(o,o.return,F)}}else mi(r,o,u,f);break;case 31:mi(r,o,u,f);break;case 13:mi(r,o,u,f);break;case 23:break;case 22:w=o.stateNode,T=o.alternate,o.memoizedState!==null?w._visibility&2?mi(r,o,u,f):Ah(r,o):w._visibility&2?mi(r,o,u,f):(w._visibility|=2,qc(r,o,u,f,(o.subtreeFlags&10256)!==0||!1)),_&2048&&Yv(T,o);break;case 24:mi(r,o,u,f),_&2048&&Kv(o.alternate,o);break;default:mi(r,o,u,f)}}function qc(r,o,u,f,_){for(_=_&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var w=r,T=o,I=u,F=f,V=T.flags;switch(T.tag){case 0:case 11:case 15:qc(w,T,I,F,_),wh(8,T);break;case 23:break;case 22:var Q=T.stateNode;T.memoizedState!==null?Q._visibility&2?qc(w,T,I,F,_):Ah(w,T):(Q._visibility|=2,qc(w,T,I,F,_)),_&&V&2048&&Yv(T.alternate,T);break;case 24:qc(w,T,I,F,_),_&&V&2048&&Kv(T.alternate,T);break;default:qc(w,T,I,F,_)}o=o.sibling}}function Ah(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=r,f=o,_=f.flags;switch(f.tag){case 22:Ah(u,f),_&2048&&Yv(f.alternate,f);break;case 24:Ah(u,f),_&2048&&Kv(f.alternate,f);break;default:Ah(u,f)}o=o.sibling}}var Eh=8192;function Vc(r,o,u){if(r.subtreeFlags&Eh)for(r=r.child;r!==null;)_E(r,o,u),r=r.sibling}function _E(r,o,u){switch(r.tag){case 26:Vc(r,o,u),r.flags&Eh&&r.memoizedState!==null&&hD(u,pi,r.memoizedState,r.memoizedProps);break;case 5:Vc(r,o,u);break;case 3:case 4:var f=pi;pi=rg(r.stateNode.containerInfo),Vc(r,o,u),pi=f;break;case 22:r.memoizedState===null&&(f=r.alternate,f!==null&&f.memoizedState!==null?(f=Eh,Eh=16777216,Vc(r,o,u),Eh=f):Vc(r,o,u));break;default:Vc(r,o,u)}}function xE(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Th(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];an=f,SE(f,r)}xE(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)wE(r),r=r.sibling}function wE(r){switch(r.tag){case 0:case 11:case 15:Th(r),r.flags&2048&&ka(9,r,r.return);break;case 3:Th(r);break;case 12:Th(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,$m(r)):Th(r);break;default:Th(r)}}function $m(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];an=f,SE(f,r)}xE(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:ka(8,o,o.return),$m(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,$m(o));break;default:$m(o)}r=r.sibling}}function SE(r,o){for(;an!==null;){var u=an;switch(u.tag){case 0:case 11:case 15:ka(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:ch(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,an=f;else e:for(u=r;an!==null;){f=an;var _=f.sibling,w=f.return;if(fE(f),f===u){an=null;break e}if(_!==null){_.return=w,an=_;break e}an=w}}}var CI={getCacheForType:function(r){var o=yn(Gt),u=o.data.get(r);return u===void 0&&(u=r(),o.data.set(r,u)),u},cacheSignal:function(){return yn(Gt).controller.signal}},NI=typeof WeakMap=="function"?WeakMap:Map,at=0,yt=null,Ke=null,Xe=0,lt=0,bs=null,Ma=!1,$c=!1,Jv=!1,Cr=0,Lt=0,Ia=0,Ko=0,Xv=0,_s=0,Yc=0,Ch=null,ss=null,Wv=!1,Ym=0,AE=0,Km=1/0,Jm=null,Da=null,Wt=0,Pa=null,Kc=null,Nr=0,Qv=0,Zv=null,EE=null,Nh=0,eb=null;function xs(){return(at&2)!==0&&Xe!==0?Xe&-Xe:j.T!==null?ab():Hw()}function TE(){if(_s===0)if((Xe&536870912)===0||Qe){var r=sm;sm<<=1,(sm&3932160)===0&&(sm=262144),_s=r}else _s=536870912;return r=ys.current,r!==null&&(r.flags|=32),_s}function is(r,o,u){(r===yt&&(lt===2||lt===9)||r.cancelPendingCommit!==null)&&(Jc(r,0),La(r,Xe,_s,!1)),Jd(r,u),((at&2)===0||r!==yt)&&(r===yt&&((at&2)===0&&(Ko|=u),Lt===4&&La(r,Xe,_s,!1)),Bi(r))}function CE(r,o,u){if((at&6)!==0)throw Error(n(327));var f=!u&&(o&127)===0&&(o&r.expiredLanes)===0||Kd(r,o),_=f?MI(r,o):nb(r,o,!0),w=f;do{if(_===0){$c&&!f&&La(r,o,0,!1);break}else{if(u=r.current.alternate,w&&!RI(u)){_=nb(r,o,!1),w=!1;continue}if(_===2){if(w=o,r.errorRecoveryDisabledLanes&w)var T=0;else T=r.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){o=T;e:{var I=r;_=Ch;var F=I.current.memoizedState.isDehydrated;if(F&&(Jc(I,T).flags|=256),T=nb(I,T,!1),T!==2){if(Jv&&!F){I.errorRecoveryDisabledLanes|=w,Ko|=w,_=4;break e}w=ss,ss=_,w!==null&&(ss===null?ss=w:ss.push.apply(ss,w))}_=T}if(w=!1,_!==2)continue}}if(_===1){Jc(r,0),La(r,o,0,!0);break}e:{switch(f=r,w=_,w){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:La(f,o,_s,!Ma);break e;case 2:ss=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(_=Ym+300-hs(),10<_)){if(La(f,o,_s,!Ma),rm(f,0,!0)!==0)break e;Nr=o,f.timeoutHandle=i1(NE.bind(null,f,u,ss,Jm,Wv,o,_s,Ko,Yc,Ma,w,"Throttled",-0,0),_);break e}NE(f,u,ss,Jm,Wv,o,_s,Ko,Yc,Ma,w,null,-0,0)}}break}while(!0);Bi(r)}function NE(r,o,u,f,_,w,T,I,F,V,Q,te,Y,W){if(r.timeoutHandle=-1,te=o.subtreeFlags,te&8192||(te&16785408)===16785408){te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:fr},_E(o,w,te);var be=(w&62914560)===w?Ym-hs():(w&4194048)===w?AE-hs():0;if(be=fD(te,be),be!==null){Nr=w,r.cancelPendingCommit=be(OE.bind(null,r,o,w,u,f,_,T,I,F,Q,te,null,Y,W)),La(r,w,T,!V);return}}OE(r,o,w,u,f,_,T,I,F)}function RI(r){for(var o=r;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var _=u[f],w=_.getSnapshot;_=_.value;try{if(!ms(w(),_))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function La(r,o,u,f){o&=~Xv,o&=~Ko,r.suspendedLanes|=o,r.pingedLanes&=~o,f&&(r.warmLanes|=o),f=r.expirationTimes;for(var _=o;0<_;){var w=31-ps(_),T=1<<w;f[w]=-1,_&=~T}u!==0&&Fw(r,u,o)}function Xm(){return(at&6)===0?(Rh(0),!1):!0}function tb(){if(Ke!==null){if(lt===0)var r=Ke.return;else r=Ke,yr=zo=null,yv(r),zc=null,dh=0,r=Ke;for(;r!==null;)rE(r.alternate,r),r=r.return;Ke=null}}function Jc(r,o){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,JI(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),Nr=0,tb(),yt=r,Ke=u=mr(r.current,null),Xe=o,lt=0,bs=null,Ma=!1,$c=Kd(r,o),Jv=!1,Yc=_s=Xv=Ko=Ia=Lt=0,ss=Ch=null,Wv=!1,(o&8)!==0&&(o|=o&32);var f=r.entangledLanes;if(f!==0)for(r=r.entanglements,f&=o;0<f;){var _=31-ps(f),w=1<<_;o|=r[_],f&=~w}return Cr=o,ym(),u}function RE(r,o){je=null,j.H=bh,o===Fc||o===Em?(o=VS(),lt=3):o===rv?(o=VS(),lt=4):lt=o===Dv?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,bs=o,Ke===null&&(Lt=1,zm(r,Ys(o,r.current)))}function kE(){var r=ys.current;return r===null?!0:(Xe&4194048)===Xe?Ws===null:(Xe&62914560)===Xe||(Xe&536870912)!==0?r===Ws:!1}function ME(){var r=j.H;return j.H=bh,r===null?bh:r}function IE(){var r=j.A;return j.A=CI,r}function Wm(){Lt=4,Ma||(Xe&4194048)!==Xe&&ys.current!==null||($c=!0),(Ia&134217727)===0&&(Ko&134217727)===0||yt===null||La(yt,Xe,_s,!1)}function nb(r,o,u){var f=at;at|=2;var _=ME(),w=IE();(yt!==r||Xe!==o)&&(Jm=null,Jc(r,o)),o=!1;var T=Lt;e:do try{if(lt!==0&&Ke!==null){var I=Ke,F=bs;switch(lt){case 8:tb(),T=6;break e;case 3:case 2:case 9:case 6:ys.current===null&&(o=!0);var V=lt;if(lt=0,bs=null,Xc(r,I,F,V),u&&$c){T=0;break e}break;default:V=lt,lt=0,bs=null,Xc(r,I,F,V)}}kI(),T=Lt;break}catch(Q){RE(r,Q)}while(!0);return o&&r.shellSuspendCounter++,yr=zo=null,at=f,j.H=_,j.A=w,Ke===null&&(yt=null,Xe=0,ym()),T}function kI(){for(;Ke!==null;)DE(Ke)}function MI(r,o){var u=at;at|=2;var f=ME(),_=IE();yt!==r||Xe!==o?(Jm=null,Km=hs()+500,Jc(r,o)):$c=Kd(r,o);e:do try{if(lt!==0&&Ke!==null){o=Ke;var w=bs;t:switch(lt){case 1:lt=0,bs=null,Xc(r,o,w,1);break;case 2:case 9:if(GS(w)){lt=0,bs=null,PE(o);break}o=function(){lt!==2&&lt!==9||yt!==r||(lt=7),Bi(r)},w.then(o,o);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:GS(w)?(lt=0,bs=null,PE(o)):(lt=0,bs=null,Xc(r,o,w,7));break;case 5:var T=null;switch(Ke.tag){case 26:T=Ke.memoizedState;case 5:case 27:var I=Ke;if(T?b1(T):I.stateNode.complete){lt=0,bs=null;var F=I.sibling;if(F!==null)Ke=F;else{var V=I.return;V!==null?(Ke=V,Qm(V)):Ke=null}break t}}lt=0,bs=null,Xc(r,o,w,5);break;case 6:lt=0,bs=null,Xc(r,o,w,6);break;case 8:tb(),Lt=6;break e;default:throw Error(n(462))}}II();break}catch(Q){RE(r,Q)}while(!0);return yr=zo=null,j.H=f,j.A=_,at=u,Ke!==null?0:(yt=null,Xe=0,ym(),Lt)}function II(){for(;Ke!==null&&!ko();)DE(Ke)}function DE(r){var o=sE(r.alternate,r,Cr);r.memoizedProps=r.pendingProps,o===null?Qm(r):Ke=o}function PE(r){var o=r,u=o.alternate;switch(o.tag){case 15:case 0:o=WA(u,o,o.pendingProps,o.type,void 0,Xe);break;case 11:o=WA(u,o,o.pendingProps,o.type.render,o.ref,Xe);break;case 5:yv(o);default:rE(u,o),o=Ke=IS(o,Cr),o=sE(u,o,Cr)}r.memoizedProps=r.pendingProps,o===null?Qm(r):Ke=o}function Xc(r,o,u,f){yr=zo=null,yv(o),zc=null,dh=0;var _=o.return;try{if(_I(r,_,o,u,Xe)){Lt=1,zm(r,Ys(u,r.current)),Ke=null;return}}catch(w){if(_!==null)throw Ke=_,w;Lt=1,zm(r,Ys(u,r.current)),Ke=null;return}o.flags&32768?(Qe||f===1?r=!0:$c||(Xe&536870912)!==0?r=!1:(Ma=r=!0,(f===2||f===9||f===3||f===6)&&(f=ys.current,f!==null&&f.tag===13&&(f.flags|=16384))),LE(o,r)):Qm(o)}function Qm(r){var o=r;do{if((o.flags&32768)!==0){LE(o,Ma);return}r=o.return;var u=SI(o.alternate,o,Cr);if(u!==null){Ke=u;return}if(o=o.sibling,o!==null){Ke=o;return}Ke=o=r}while(o!==null);Lt===0&&(Lt=5)}function LE(r,o){do{var u=AI(r.alternate,r);if(u!==null){u.flags&=32767,Ke=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(r=r.sibling,r!==null)){Ke=r;return}Ke=r=u}while(r!==null);Lt=6,Ke=null}function OE(r,o,u,f,_,w,T,I,F){r.cancelPendingCommit=null;do Zm();while(Wt!==0);if((at&6)!==0)throw Error(n(327));if(o!==null){if(o===r.current)throw Error(n(177));if(w=o.lanes|o.childLanes,w|=qy,dM(r,u,w,T,I,F),r===yt&&(Ke=yt=null,Xe=0),Kc=o,Pa=r,Nr=u,Qv=w,Zv=_,EE=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,OI(tm,function(){return HE(),null})):(r.callbackNode=null,r.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=j.T,j.T=null,_=X.p,X.p=2,T=at,at|=4;try{EI(r,o,u)}finally{at=T,X.p=_,j.T=f}}Wt=1,UE(),FE(),zE()}}function UE(){if(Wt===1){Wt=0;var r=Pa,o=Kc,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=j.T,j.T=null;var f=X.p;X.p=2;var _=at;at|=4;try{yE(o,r);var w=pb,T=SS(r.containerInfo),I=w.focusedElem,F=w.selectionRange;if(T!==I&&I&&I.ownerDocument&&wS(I.ownerDocument.documentElement,I)){if(F!==null&&zy(I)){var V=F.start,Q=F.end;if(Q===void 0&&(Q=V),"selectionStart"in I)I.selectionStart=V,I.selectionEnd=Math.min(Q,I.value.length);else{var te=I.ownerDocument||document,Y=te&&te.defaultView||window;if(Y.getSelection){var W=Y.getSelection(),be=I.textContent.length,ke=Math.min(F.start,be),pt=F.end===void 0?ke:Math.min(F.end,be);!W.extend&&ke>pt&&(T=pt,pt=ke,ke=T);var G=xS(I,ke),B=xS(I,pt);if(G&&B&&(W.rangeCount!==1||W.anchorNode!==G.node||W.anchorOffset!==G.offset||W.focusNode!==B.node||W.focusOffset!==B.offset)){var q=te.createRange();q.setStart(G.node,G.offset),W.removeAllRanges(),ke>pt?(W.addRange(q),W.extend(B.node,B.offset)):(q.setEnd(B.node,B.offset),W.addRange(q))}}}}for(te=[],W=I;W=W.parentNode;)W.nodeType===1&&te.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<te.length;I++){var Z=te[I];Z.element.scrollLeft=Z.left,Z.element.scrollTop=Z.top}}dg=!!fb,pb=fb=null}finally{at=_,X.p=f,j.T=u}}r.current=o,Wt=2}}function FE(){if(Wt===2){Wt=0;var r=Pa,o=Kc,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=j.T,j.T=null;var f=X.p;X.p=2;var _=at;at|=4;try{hE(r,o.alternate,o)}finally{at=_,X.p=f,j.T=u}}Wt=3}}function zE(){if(Wt===4||Wt===3){Wt=0,nM();var r=Pa,o=Kc,u=Nr,f=EE;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Wt=5:(Wt=0,Kc=Pa=null,jE(r,r.pendingLanes));var _=r.pendingLanes;if(_===0&&(Da=null),_y(u),o=o.stateNode,fs&&typeof fs.onCommitFiberRoot=="function")try{fs.onCommitFiberRoot(Yd,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=j.T,_=X.p,X.p=2,j.T=null;try{for(var w=r.onRecoverableError,T=0;T<f.length;T++){var I=f[T];w(I.value,{componentStack:I.stack})}}finally{j.T=o,X.p=_}}(Nr&3)!==0&&Zm(),Bi(r),_=r.pendingLanes,(u&261930)!==0&&(_&42)!==0?r===eb?Nh++:(Nh=0,eb=r):Nh=0,Rh(0)}}function jE(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,ch(o)))}function Zm(){return UE(),FE(),zE(),HE()}function HE(){if(Wt!==5)return!1;var r=Pa,o=Qv;Qv=0;var u=_y(Nr),f=j.T,_=X.p;try{X.p=32>u?32:u,j.T=null,u=Zv,Zv=null;var w=Pa,T=Nr;if(Wt=0,Kc=Pa=null,Nr=0,(at&6)!==0)throw Error(n(331));var I=at;if(at|=4,wE(w.current),bE(w,w.current,T,u),at=I,Rh(0,!1),fs&&typeof fs.onPostCommitFiberRoot=="function")try{fs.onPostCommitFiberRoot(Yd,w)}catch{}return!0}finally{X.p=_,j.T=f,jE(r,o)}}function BE(r,o,u){o=Ys(u,o),o=Iv(r.stateNode,o,2),r=Ca(r,o,2),r!==null&&(Jd(r,2),Bi(r))}function ct(r,o,u){if(r.tag===3)BE(r,r,u);else for(;o!==null;){if(o.tag===3){BE(o,r,u);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Da===null||!Da.has(f))){r=Ys(u,r),u=GA(2),f=Ca(o,u,2),f!==null&&(qA(u,f,o,r),Jd(f,2),Bi(f));break}}o=o.return}}function sb(r,o,u){var f=r.pingCache;if(f===null){f=r.pingCache=new NI;var _=new Set;f.set(o,_)}else _=f.get(o),_===void 0&&(_=new Set,f.set(o,_));_.has(u)||(Jv=!0,_.add(u),r=DI.bind(null,r,o,u),o.then(r,r))}function DI(r,o,u){var f=r.pingCache;f!==null&&f.delete(o),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,yt===r&&(Xe&u)===u&&(Lt===4||Lt===3&&(Xe&62914560)===Xe&&300>hs()-Ym?(at&2)===0&&Jc(r,0):Xv|=u,Yc===Xe&&(Yc=0)),Bi(r)}function GE(r,o){o===0&&(o=Uw()),r=Oo(r,o),r!==null&&(Jd(r,o),Bi(r))}function PI(r){var o=r.memoizedState,u=0;o!==null&&(u=o.retryLane),GE(r,u)}function LI(r,o){var u=0;switch(r.tag){case 31:case 13:var f=r.stateNode,_=r.memoizedState;_!==null&&(u=_.retryLane);break;case 19:f=r.stateNode;break;case 22:f=r.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(o),GE(r,u)}function OI(r,o){return $d(r,o)}var eg=null,Wc=null,ib=!1,tg=!1,rb=!1,Oa=0;function Bi(r){r!==Wc&&r.next===null&&(Wc===null?eg=Wc=r:Wc=Wc.next=r),tg=!0,ib||(ib=!0,FI())}function Rh(r,o){if(!rb&&tg){rb=!0;do for(var u=!1,f=eg;f!==null;){if(r!==0){var _=f.pendingLanes;if(_===0)var w=0;else{var T=f.suspendedLanes,I=f.pingedLanes;w=(1<<31-ps(42|r)+1)-1,w&=_&~(T&~I),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(u=!0,YE(f,w))}else w=Xe,w=rm(f,f===yt?w:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(w&3)===0||Kd(f,w)||(u=!0,YE(f,w));f=f.next}while(u);rb=!1}}function UI(){qE()}function qE(){tg=ib=!1;var r=0;Oa!==0&&KI()&&(r=Oa);for(var o=hs(),u=null,f=eg;f!==null;){var _=f.next,w=VE(f,o);w===0?(f.next=null,u===null?eg=_:u.next=_,_===null&&(Wc=u)):(u=f,(r!==0||(w&3)!==0)&&(tg=!0)),f=_}Wt!==0&&Wt!==5||Rh(r),Oa!==0&&(Oa=0)}function VE(r,o){for(var u=r.suspendedLanes,f=r.pingedLanes,_=r.expirationTimes,w=r.pendingLanes&-62914561;0<w;){var T=31-ps(w),I=1<<T,F=_[T];F===-1?((I&u)===0||(I&f)!==0)&&(_[T]=uM(I,o)):F<=o&&(r.expiredLanes|=I),w&=~I}if(o=yt,u=Xe,u=rm(r,r===o?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f=r.callbackNode,u===0||r===o&&(lt===2||lt===9)||r.cancelPendingCommit!==null)return f!==null&&f!==null&&dr(f),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||Kd(r,u)){if(o=u&-u,o===r.callbackPriority)return o;switch(f!==null&&dr(f),_y(u)){case 2:case 8:u=Lw;break;case 32:u=tm;break;case 268435456:u=Ow;break;default:u=tm}return f=$E.bind(null,r),u=$d(u,f),r.callbackPriority=o,r.callbackNode=u,o}return f!==null&&f!==null&&dr(f),r.callbackPriority=2,r.callbackNode=null,2}function $E(r,o){if(Wt!==0&&Wt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(Zm()&&r.callbackNode!==u)return null;var f=Xe;return f=rm(r,r===yt?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f===0?null:(CE(r,f,o),VE(r,hs()),r.callbackNode!=null&&r.callbackNode===u?$E.bind(null,r):null)}function YE(r,o){if(Zm())return null;CE(r,o,!0)}function FI(){XI(function(){(at&6)!==0?$d(Pw,UI):qE()})}function ab(){if(Oa===0){var r=Oc;r===0&&(r=nm,nm<<=1,(nm&261888)===0&&(nm=256)),Oa=r}return Oa}function KE(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:cm(""+r)}function JE(r,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,r.id&&u.setAttribute("form",r.id),o.parentNode.insertBefore(u,o),r=new FormData(r),u.parentNode.removeChild(u),r}function zI(r,o,u,f,_){if(o==="submit"&&u&&u.stateNode===_){var w=KE((_[Qn]||null).action),T=f.submitter;T&&(o=(o=T[Qn]||null)?KE(o.formAction):T.getAttribute("formAction"),o!==null&&(w=o,T=null));var I=new fm("action","action",null,f,_);r.push({event:I,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Oa!==0){var F=T?JE(_,T):new FormData(_);Tv(u,{pending:!0,data:F,method:_.method,action:w},null,F)}}else typeof w=="function"&&(I.preventDefault(),F=T?JE(_,T):new FormData(_),Tv(u,{pending:!0,data:F,method:_.method,action:w},w,F))},currentTarget:_}]})}}for(var ob=0;ob<Gy.length;ob++){var lb=Gy[ob],jI=lb.toLowerCase(),HI=lb[0].toUpperCase()+lb.slice(1);fi(jI,"on"+HI)}fi(TS,"onAnimationEnd"),fi(CS,"onAnimationIteration"),fi(NS,"onAnimationStart"),fi("dblclick","onDoubleClick"),fi("focusin","onFocus"),fi("focusout","onBlur"),fi(sI,"onTransitionRun"),fi(iI,"onTransitionStart"),fi(rI,"onTransitionCancel"),fi(RS,"onTransitionEnd"),wc("onMouseEnter",["mouseout","mouseover"]),wc("onMouseLeave",["mouseout","mouseover"]),wc("onPointerEnter",["pointerout","pointerover"]),wc("onPointerLeave",["pointerout","pointerover"]),Io("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Io("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Io("onBeforeInput",["compositionend","keypress","textInput","paste"]),Io("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Io("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Io("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(kh));function XE(r,o){o=(o&4)!==0;for(var u=0;u<r.length;u++){var f=r[u],_=f.event;f=f.listeners;e:{var w=void 0;if(o)for(var T=f.length-1;0<=T;T--){var I=f[T],F=I.instance,V=I.currentTarget;if(I=I.listener,F!==w&&_.isPropagationStopped())break e;w=I,_.currentTarget=V;try{w(_)}catch(Q){gm(Q)}_.currentTarget=null,w=F}else for(T=0;T<f.length;T++){if(I=f[T],F=I.instance,V=I.currentTarget,I=I.listener,F!==w&&_.isPropagationStopped())break e;w=I,_.currentTarget=V;try{w(_)}catch(Q){gm(Q)}_.currentTarget=null,w=F}}}}function Je(r,o){var u=o[xy];u===void 0&&(u=o[xy]=new Set);var f=r+"__bubble";u.has(f)||(WE(o,r,2,!1),u.add(f))}function cb(r,o,u){var f=0;o&&(f|=4),WE(u,r,f,o)}var ng="_reactListening"+Math.random().toString(36).slice(2);function ub(r){if(!r[ng]){r[ng]=!0,qw.forEach(function(u){u!=="selectionchange"&&(BI.has(u)||cb(u,!1,r),cb(u,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[ng]||(o[ng]=!0,cb("selectionchange",!1,o))}}function WE(r,o,u,f){switch(T1(o)){case 2:var _=gD;break;case 8:_=yD;break;default:_=Eb}u=_.bind(null,o,u,r),_=void 0,!ky||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(_=!0),f?_!==void 0?r.addEventListener(o,u,{capture:!0,passive:_}):r.addEventListener(o,u,!0):_!==void 0?r.addEventListener(o,u,{passive:_}):r.addEventListener(o,u,!1)}function db(r,o,u,f,_){var w=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var I=f.stateNode.containerInfo;if(I===_)break;if(T===4)for(T=f.return;T!==null;){var F=T.tag;if((F===3||F===4)&&T.stateNode.containerInfo===_)return;T=T.return}for(;I!==null;){if(T=bc(I),T===null)return;if(F=T.tag,F===5||F===6||F===26||F===27){f=w=T;continue e}I=I.parentNode}}f=f.return}nS(function(){var V=w,Q=Ny(u),te=[];e:{var Y=kS.get(r);if(Y!==void 0){var W=fm,be=r;switch(r){case"keypress":if(dm(u)===0)break e;case"keydown":case"keyup":W=LM;break;case"focusin":be="focus",W=Py;break;case"focusout":be="blur",W=Py;break;case"beforeblur":case"afterblur":W=Py;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=rS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=SM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=FM;break;case TS:case CS:case NS:W=TM;break;case RS:W=jM;break;case"scroll":case"scrollend":W=xM;break;case"wheel":W=BM;break;case"copy":case"cut":case"paste":W=NM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=oS;break;case"toggle":case"beforetoggle":W=qM}var ke=(o&4)!==0,pt=!ke&&(r==="scroll"||r==="scrollend"),G=ke?Y!==null?Y+"Capture":null:Y;ke=[];for(var B=V,q;B!==null;){var Z=B;if(q=Z.stateNode,Z=Z.tag,Z!==5&&Z!==26&&Z!==27||q===null||G===null||(Z=Qd(B,G),Z!=null&&ke.push(Mh(B,Z,q))),pt)break;B=B.return}0<ke.length&&(Y=new W(Y,be,null,u,Q),te.push({event:Y,listeners:ke}))}}if((o&7)===0){e:{if(Y=r==="mouseover"||r==="pointerover",W=r==="mouseout"||r==="pointerout",Y&&u!==Cy&&(be=u.relatedTarget||u.fromElement)&&(bc(be)||be[vc]))break e;if((W||Y)&&(Y=Q.window===Q?Q:(Y=Q.ownerDocument)?Y.defaultView||Y.parentWindow:window,W?(be=u.relatedTarget||u.toElement,W=V,be=be?bc(be):null,be!==null&&(pt=a(be),ke=be.tag,be!==pt||ke!==5&&ke!==27&&ke!==6)&&(be=null)):(W=null,be=V),W!==be)){if(ke=rS,Z="onMouseLeave",G="onMouseEnter",B="mouse",(r==="pointerout"||r==="pointerover")&&(ke=oS,Z="onPointerLeave",G="onPointerEnter",B="pointer"),pt=W==null?Y:Wd(W),q=be==null?Y:Wd(be),Y=new ke(Z,B+"leave",W,u,Q),Y.target=pt,Y.relatedTarget=q,Z=null,bc(Q)===V&&(ke=new ke(G,B+"enter",be,u,Q),ke.target=q,ke.relatedTarget=pt,Z=ke),pt=Z,W&&be)t:{for(ke=GI,G=W,B=be,q=0,Z=G;Z;Z=ke(Z))q++;Z=0;for(var Ne=B;Ne;Ne=ke(Ne))Z++;for(;0<q-Z;)G=ke(G),q--;for(;0<Z-q;)B=ke(B),Z--;for(;q--;){if(G===B||B!==null&&G===B.alternate){ke=G;break t}G=ke(G),B=ke(B)}ke=null}else ke=null;W!==null&&QE(te,Y,W,ke,!1),be!==null&&pt!==null&&QE(te,pt,be,ke,!0)}}e:{if(Y=V?Wd(V):window,W=Y.nodeName&&Y.nodeName.toLowerCase(),W==="select"||W==="input"&&Y.type==="file")var tt=mS;else if(fS(Y))if(gS)tt=eI;else{tt=QM;var Se=WM}else W=Y.nodeName,!W||W.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?V&&Ty(V.elementType)&&(tt=mS):tt=ZM;if(tt&&(tt=tt(r,V))){pS(te,tt,u,Q);break e}Se&&Se(r,Y,V),r==="focusout"&&V&&Y.type==="number"&&V.memoizedProps.value!=null&&Ey(Y,"number",Y.value)}switch(Se=V?Wd(V):window,r){case"focusin":(fS(Se)||Se.contentEditable==="true")&&(Nc=Se,jy=V,ah=null);break;case"focusout":ah=jy=Nc=null;break;case"mousedown":Hy=!0;break;case"contextmenu":case"mouseup":case"dragend":Hy=!1,AS(te,u,Q);break;case"selectionchange":if(nI)break;case"keydown":case"keyup":AS(te,u,Q)}var Be;if(Oy)e:{switch(r){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else Cc?dS(r,u)&&(We="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(We="onCompositionStart");We&&(lS&&u.locale!=="ko"&&(Cc||We!=="onCompositionStart"?We==="onCompositionEnd"&&Cc&&(Be=sS()):(_a=Q,My="value"in _a?_a.value:_a.textContent,Cc=!0)),Se=sg(V,We),0<Se.length&&(We=new aS(We,r,null,u,Q),te.push({event:We,listeners:Se}),Be?We.data=Be:(Be=hS(u),Be!==null&&(We.data=Be)))),(Be=$M?YM(r,u):KM(r,u))&&(We=sg(V,"onBeforeInput"),0<We.length&&(Se=new aS("onBeforeInput","beforeinput",null,u,Q),te.push({event:Se,listeners:We}),Se.data=Be)),zI(te,r,V,u,Q)}XE(te,o)})}function Mh(r,o,u){return{instance:r,listener:o,currentTarget:u}}function sg(r,o){for(var u=o+"Capture",f=[];r!==null;){var _=r,w=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||w===null||(_=Qd(r,u),_!=null&&f.unshift(Mh(r,_,w)),_=Qd(r,o),_!=null&&f.push(Mh(r,_,w))),r.tag===3)return f;r=r.return}return[]}function GI(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function QE(r,o,u,f,_){for(var w=o._reactName,T=[];u!==null&&u!==f;){var I=u,F=I.alternate,V=I.stateNode;if(I=I.tag,F!==null&&F===f)break;I!==5&&I!==26&&I!==27||V===null||(F=V,_?(V=Qd(u,w),V!=null&&T.unshift(Mh(u,V,F))):_||(V=Qd(u,w),V!=null&&T.push(Mh(u,V,F)))),u=u.return}T.length!==0&&r.push({event:o,listeners:T})}var qI=/\r\n?/g,VI=/\u0000|\uFFFD/g;function ZE(r){return(typeof r=="string"?r:""+r).replace(qI,`
`).replace(VI,"")}function e1(r,o){return o=ZE(o),ZE(r)===o}function ft(r,o,u,f,_,w){switch(u){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||Ac(r,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&Ac(r,""+f);break;case"className":om(r,"class",f);break;case"tabIndex":om(r,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":om(r,u,f);break;case"style":eS(r,f,w);break;case"data":if(o!=="object"){om(r,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||u!=="href")){r.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=cm(""+f),r.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(u==="formAction"?(o!=="input"&&ft(r,o,"name",_.name,_,null),ft(r,o,"formEncType",_.formEncType,_,null),ft(r,o,"formMethod",_.formMethod,_,null),ft(r,o,"formTarget",_.formTarget,_,null)):(ft(r,o,"encType",_.encType,_,null),ft(r,o,"method",_.method,_,null),ft(r,o,"target",_.target,_,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=cm(""+f),r.setAttribute(u,f);break;case"onClick":f!=null&&(r.onclick=fr);break;case"onScroll":f!=null&&Je("scroll",r);break;case"onScrollEnd":f!=null&&Je("scrollend",r);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(_.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"multiple":r.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":r.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){r.removeAttribute("xlink:href");break}u=cm(""+f),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""+f):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":f===!0?r.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,f):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?r.setAttribute(u,f):r.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?r.removeAttribute(u):r.setAttribute(u,f);break;case"popover":Je("beforetoggle",r),Je("toggle",r),am(r,"popover",f);break;case"xlinkActuate":hr(r,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":hr(r,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":hr(r,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":hr(r,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":hr(r,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":hr(r,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":hr(r,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":hr(r,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":hr(r,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":am(r,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=bM.get(u)||u,am(r,u,f))}}function hb(r,o,u,f,_,w){switch(u){case"style":eS(r,f,w);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(_.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"children":typeof f=="string"?Ac(r,f):(typeof f=="number"||typeof f=="bigint")&&Ac(r,""+f);break;case"onScroll":f!=null&&Je("scroll",r);break;case"onScrollEnd":f!=null&&Je("scrollend",r);break;case"onClick":f!=null&&(r.onclick=fr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Vw.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(_=u.endsWith("Capture"),o=u.slice(2,_?u.length-7:void 0),w=r[Qn]||null,w=w!=null?w[u]:null,typeof w=="function"&&r.removeEventListener(o,w,_),typeof f=="function")){typeof w!="function"&&w!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(o,f,_);break e}u in r?r[u]=f:f===!0?r.setAttribute(u,""):am(r,u,f)}}}function bn(r,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Je("error",r),Je("load",r);var f=!1,_=!1,w;for(w in u)if(u.hasOwnProperty(w)){var T=u[w];if(T!=null)switch(w){case"src":f=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:ft(r,o,w,T,u,null)}}_&&ft(r,o,"srcSet",u.srcSet,u,null),f&&ft(r,o,"src",u.src,u,null);return;case"input":Je("invalid",r);var I=w=T=_=null,F=null,V=null;for(f in u)if(u.hasOwnProperty(f)){var Q=u[f];if(Q!=null)switch(f){case"name":_=Q;break;case"type":T=Q;break;case"checked":F=Q;break;case"defaultChecked":V=Q;break;case"value":w=Q;break;case"defaultValue":I=Q;break;case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(n(137,o));break;default:ft(r,o,f,Q,u,null)}}Xw(r,w,I,F,V,T,_,!1);return;case"select":Je("invalid",r),f=T=w=null;for(_ in u)if(u.hasOwnProperty(_)&&(I=u[_],I!=null))switch(_){case"value":w=I;break;case"defaultValue":T=I;break;case"multiple":f=I;default:ft(r,o,_,I,u,null)}o=w,u=T,r.multiple=!!f,o!=null?Sc(r,!!f,o,!1):u!=null&&Sc(r,!!f,u,!0);return;case"textarea":Je("invalid",r),w=_=f=null;for(T in u)if(u.hasOwnProperty(T)&&(I=u[T],I!=null))switch(T){case"value":f=I;break;case"defaultValue":_=I;break;case"children":w=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(n(91));break;default:ft(r,o,T,I,u,null)}Qw(r,f,_,w);return;case"option":for(F in u)if(u.hasOwnProperty(F)&&(f=u[F],f!=null))switch(F){case"selected":r.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:ft(r,o,F,f,u,null)}return;case"dialog":Je("beforetoggle",r),Je("toggle",r),Je("cancel",r),Je("close",r);break;case"iframe":case"object":Je("load",r);break;case"video":case"audio":for(f=0;f<kh.length;f++)Je(kh[f],r);break;case"image":Je("error",r),Je("load",r);break;case"details":Je("toggle",r);break;case"embed":case"source":case"link":Je("error",r),Je("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(V in u)if(u.hasOwnProperty(V)&&(f=u[V],f!=null))switch(V){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:ft(r,o,V,f,u,null)}return;default:if(Ty(o)){for(Q in u)u.hasOwnProperty(Q)&&(f=u[Q],f!==void 0&&hb(r,o,Q,f,u,void 0));return}}for(I in u)u.hasOwnProperty(I)&&(f=u[I],f!=null&&ft(r,o,I,f,u,null))}function $I(r,o,u,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,w=null,T=null,I=null,F=null,V=null,Q=null;for(W in u){var te=u[W];if(u.hasOwnProperty(W)&&te!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":F=te;default:f.hasOwnProperty(W)||ft(r,o,W,null,f,te)}}for(var Y in f){var W=f[Y];if(te=u[Y],f.hasOwnProperty(Y)&&(W!=null||te!=null))switch(Y){case"type":w=W;break;case"name":_=W;break;case"checked":V=W;break;case"defaultChecked":Q=W;break;case"value":T=W;break;case"defaultValue":I=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(137,o));break;default:W!==te&&ft(r,o,Y,W,f,te)}}Ay(r,T,I,F,V,Q,w,_);return;case"select":W=T=I=Y=null;for(w in u)if(F=u[w],u.hasOwnProperty(w)&&F!=null)switch(w){case"value":break;case"multiple":W=F;default:f.hasOwnProperty(w)||ft(r,o,w,null,f,F)}for(_ in f)if(w=f[_],F=u[_],f.hasOwnProperty(_)&&(w!=null||F!=null))switch(_){case"value":Y=w;break;case"defaultValue":I=w;break;case"multiple":T=w;default:w!==F&&ft(r,o,_,w,f,F)}o=I,u=T,f=W,Y!=null?Sc(r,!!u,Y,!1):!!f!=!!u&&(o!=null?Sc(r,!!u,o,!0):Sc(r,!!u,u?[]:"",!1));return;case"textarea":W=Y=null;for(I in u)if(_=u[I],u.hasOwnProperty(I)&&_!=null&&!f.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:ft(r,o,I,null,f,_)}for(T in f)if(_=f[T],w=u[T],f.hasOwnProperty(T)&&(_!=null||w!=null))switch(T){case"value":Y=_;break;case"defaultValue":W=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(n(91));break;default:_!==w&&ft(r,o,T,_,f,w)}Ww(r,Y,W);return;case"option":for(var be in u)if(Y=u[be],u.hasOwnProperty(be)&&Y!=null&&!f.hasOwnProperty(be))switch(be){case"selected":r.selected=!1;break;default:ft(r,o,be,null,f,Y)}for(F in f)if(Y=f[F],W=u[F],f.hasOwnProperty(F)&&Y!==W&&(Y!=null||W!=null))switch(F){case"selected":r.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:ft(r,o,F,Y,f,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in u)Y=u[ke],u.hasOwnProperty(ke)&&Y!=null&&!f.hasOwnProperty(ke)&&ft(r,o,ke,null,f,Y);for(V in f)if(Y=f[V],W=u[V],f.hasOwnProperty(V)&&Y!==W&&(Y!=null||W!=null))switch(V){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(n(137,o));break;default:ft(r,o,V,Y,f,W)}return;default:if(Ty(o)){for(var pt in u)Y=u[pt],u.hasOwnProperty(pt)&&Y!==void 0&&!f.hasOwnProperty(pt)&&hb(r,o,pt,void 0,f,Y);for(Q in f)Y=f[Q],W=u[Q],!f.hasOwnProperty(Q)||Y===W||Y===void 0&&W===void 0||hb(r,o,Q,Y,f,W);return}}for(var G in u)Y=u[G],u.hasOwnProperty(G)&&Y!=null&&!f.hasOwnProperty(G)&&ft(r,o,G,null,f,Y);for(te in f)Y=f[te],W=u[te],!f.hasOwnProperty(te)||Y===W||Y==null&&W==null||ft(r,o,te,Y,f,W)}function t1(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function YI(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var _=u[f],w=_.transferSize,T=_.initiatorType,I=_.duration;if(w&&I&&t1(T)){for(T=0,I=_.responseEnd,f+=1;f<u.length;f++){var F=u[f],V=F.startTime;if(V>I)break;var Q=F.transferSize,te=F.initiatorType;Q&&t1(te)&&(F=F.responseEnd,T+=Q*(F<I?1:(I-V)/(F-V)))}if(--f,o+=8*(w+T)/(_.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var fb=null,pb=null;function ig(r){return r.nodeType===9?r:r.ownerDocument}function n1(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function s1(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function mb(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var gb=null;function KI(){var r=window.event;return r&&r.type==="popstate"?r===gb?!1:(gb=r,!0):(gb=null,!1)}var i1=typeof setTimeout=="function"?setTimeout:void 0,JI=typeof clearTimeout=="function"?clearTimeout:void 0,r1=typeof Promise=="function"?Promise:void 0,XI=typeof queueMicrotask=="function"?queueMicrotask:typeof r1<"u"?function(r){return r1.resolve(null).then(r).catch(WI)}:i1;function WI(r){setTimeout(function(){throw r})}function Ua(r){return r==="head"}function a1(r,o){var u=o,f=0;do{var _=u.nextSibling;if(r.removeChild(u),_&&_.nodeType===8)if(u=_.data,u==="/$"||u==="/&"){if(f===0){r.removeChild(_),tu(o);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")Ih(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,Ih(u);for(var w=u.firstChild;w;){var T=w.nextSibling,I=w.nodeName;w[Xd]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&w.rel.toLowerCase()==="stylesheet"||u.removeChild(w),w=T}}else u==="body"&&Ih(r.ownerDocument.body);u=_}while(u);tu(o)}function o1(r,o){var u=r;r=0;do{var f=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=f}while(u)}function yb(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":yb(u),wy(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function QI(r,o,u,f){for(;r.nodeType===1;){var _=u;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(f){if(!r[Xd])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(w=r.getAttribute("rel"),w==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(w!==_.rel||r.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||r.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||r.getAttribute("title")!==(_.title==null?null:_.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(w=r.getAttribute("src"),(w!==(_.src==null?null:_.src)||r.getAttribute("type")!==(_.type==null?null:_.type)||r.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&w&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var w=_.name==null?null:""+_.name;if(_.type==="hidden"&&r.getAttribute("name")===w)return r}else return r;if(r=Qs(r.nextSibling),r===null)break}return null}function ZI(r,o,u){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Qs(r.nextSibling),r===null))return null;return r}function l1(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Qs(r.nextSibling),r===null))return null;return r}function vb(r){return r.data==="$?"||r.data==="$~"}function bb(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function eD(r,o){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||u.readyState!=="loading")o();else{var f=function(){o(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),r._reactRetry=f}}function Qs(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var _b=null;function c1(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(o===0)return Qs(r.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}r=r.nextSibling}return null}function u1(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return r;o--}else u!=="/$"&&u!=="/&"||o++}r=r.previousSibling}return null}function d1(r,o,u){switch(o=ig(u),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function Ih(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);wy(r)}var Zs=new Map,h1=new Set;function rg(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Rr=X.d;X.d={f:tD,r:nD,D:sD,C:iD,L:rD,m:aD,X:lD,S:oD,M:cD};function tD(){var r=Rr.f(),o=Xm();return r||o}function nD(r){var o=_c(r);o!==null&&o.tag===5&&o.type==="form"?RA(o):Rr.r(r)}var Qc=typeof document>"u"?null:document;function f1(r,o,u){var f=Qc;if(f&&typeof o=="string"&&o){var _=Vs(o);_='link[rel="'+r+'"][href="'+_+'"]',typeof u=="string"&&(_+='[crossorigin="'+u+'"]'),h1.has(_)||(h1.add(_),r={rel:r,crossOrigin:u,href:o},f.querySelector(_)===null&&(o=f.createElement("link"),bn(o,"link",r),rn(o),f.head.appendChild(o)))}}function sD(r){Rr.D(r),f1("dns-prefetch",r,null)}function iD(r,o){Rr.C(r,o),f1("preconnect",r,o)}function rD(r,o,u){Rr.L(r,o,u);var f=Qc;if(f&&r&&o){var _='link[rel="preload"][as="'+Vs(o)+'"]';o==="image"&&u&&u.imageSrcSet?(_+='[imagesrcset="'+Vs(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(_+='[imagesizes="'+Vs(u.imageSizes)+'"]')):_+='[href="'+Vs(r)+'"]';var w=_;switch(o){case"style":w=Zc(r);break;case"script":w=eu(r)}Zs.has(w)||(r=v({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:r,as:o},u),Zs.set(w,r),f.querySelector(_)!==null||o==="style"&&f.querySelector(Dh(w))||o==="script"&&f.querySelector(Ph(w))||(o=f.createElement("link"),bn(o,"link",r),rn(o),f.head.appendChild(o)))}}function aD(r,o){Rr.m(r,o);var u=Qc;if(u&&r){var f=o&&typeof o.as=="string"?o.as:"script",_='link[rel="modulepreload"][as="'+Vs(f)+'"][href="'+Vs(r)+'"]',w=_;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=eu(r)}if(!Zs.has(w)&&(r=v({rel:"modulepreload",href:r},o),Zs.set(w,r),u.querySelector(_)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Ph(w)))return}f=u.createElement("link"),bn(f,"link",r),rn(f),u.head.appendChild(f)}}}function oD(r,o,u){Rr.S(r,o,u);var f=Qc;if(f&&r){var _=xc(f).hoistableStyles,w=Zc(r);o=o||"default";var T=_.get(w);if(!T){var I={loading:0,preload:null};if(T=f.querySelector(Dh(w)))I.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":o},u),(u=Zs.get(w))&&xb(r,u);var F=T=f.createElement("link");rn(F),bn(F,"link",r),F._p=new Promise(function(V,Q){F.onload=V,F.onerror=Q}),F.addEventListener("load",function(){I.loading|=1}),F.addEventListener("error",function(){I.loading|=2}),I.loading|=4,ag(T,o,f)}T={type:"stylesheet",instance:T,count:1,state:I},_.set(w,T)}}}function lD(r,o){Rr.X(r,o);var u=Qc;if(u&&r){var f=xc(u).hoistableScripts,_=eu(r),w=f.get(_);w||(w=u.querySelector(Ph(_)),w||(r=v({src:r,async:!0},o),(o=Zs.get(_))&&wb(r,o),w=u.createElement("script"),rn(w),bn(w,"link",r),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},f.set(_,w))}}function cD(r,o){Rr.M(r,o);var u=Qc;if(u&&r){var f=xc(u).hoistableScripts,_=eu(r),w=f.get(_);w||(w=u.querySelector(Ph(_)),w||(r=v({src:r,async:!0,type:"module"},o),(o=Zs.get(_))&&wb(r,o),w=u.createElement("script"),rn(w),bn(w,"link",r),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},f.set(_,w))}}function p1(r,o,u,f){var _=(_=re.current)?rg(_):null;if(!_)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Zc(u.href),u=xc(_).hoistableStyles,f=u.get(o),f||(f={type:"style",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=Zc(u.href);var w=xc(_).hoistableStyles,T=w.get(r);if(T||(_=_.ownerDocument||_,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(r,T),(w=_.querySelector(Dh(r)))&&!w._p&&(T.instance=w,T.state.loading=5),Zs.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Zs.set(r,u),w||uD(_,r,u,T.state))),o&&f===null)throw Error(n(528,""));return T}if(o&&f!==null)throw Error(n(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=eu(u),u=xc(_).hoistableScripts,f=u.get(o),f||(f={type:"script",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function Zc(r){return'href="'+Vs(r)+'"'}function Dh(r){return'link[rel="stylesheet"]['+r+"]"}function m1(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function uD(r,o,u,f){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=r.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),bn(o,"link",u),rn(o),r.head.appendChild(o))}function eu(r){return'[src="'+Vs(r)+'"]'}function Ph(r){return"script[async]"+r}function g1(r,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var f=r.querySelector('style[data-href~="'+Vs(u.href)+'"]');if(f)return o.instance=f,rn(f),f;var _=v({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(r.ownerDocument||r).createElement("style"),rn(f),bn(f,"style",_),ag(f,u.precedence,r),o.instance=f;case"stylesheet":_=Zc(u.href);var w=r.querySelector(Dh(_));if(w)return o.state.loading|=4,o.instance=w,rn(w),w;f=m1(u),(_=Zs.get(_))&&xb(f,_),w=(r.ownerDocument||r).createElement("link"),rn(w);var T=w;return T._p=new Promise(function(I,F){T.onload=I,T.onerror=F}),bn(w,"link",f),o.state.loading|=4,ag(w,u.precedence,r),o.instance=w;case"script":return w=eu(u.src),(_=r.querySelector(Ph(w)))?(o.instance=_,rn(_),_):(f=u,(_=Zs.get(w))&&(f=v({},u),wb(f,_)),r=r.ownerDocument||r,_=r.createElement("script"),rn(_),bn(_,"link",f),r.head.appendChild(_),o.instance=_);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,ag(f,u.precedence,r));return o.instance}function ag(r,o,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=f.length?f[f.length-1]:null,w=_,T=0;T<f.length;T++){var I=f[T];if(I.dataset.precedence===o)w=I;else if(w!==_)break}w?w.parentNode.insertBefore(r,w.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(r,o.firstChild))}function xb(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function wb(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var og=null;function y1(r,o,u){if(og===null){var f=new Map,_=og=new Map;_.set(u,f)}else _=og,f=_.get(u),f||(f=new Map,_.set(u,f));if(f.has(r))return f;for(f.set(r,null),u=u.getElementsByTagName(r),_=0;_<u.length;_++){var w=u[_];if(!(w[Xd]||w[mn]||r==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var T=w.getAttribute(o)||"";T=r+T;var I=f.get(T);I?I.push(w):f.set(T,[w])}}return f}function v1(r,o,u){r=r.ownerDocument||r,r.head.insertBefore(u,o==="title"?r.querySelector("head > title"):null)}function dD(r,o,u){if(u===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function b1(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function hD(r,o,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var _=Zc(f.href),w=o.querySelector(Dh(_));if(w){o=w._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=lg.bind(r),o.then(r,r)),u.state.loading|=4,u.instance=w,rn(w);return}w=o.ownerDocument||o,f=m1(f),(_=Zs.get(_))&&xb(f,_),w=w.createElement("link"),rn(w);var T=w;T._p=new Promise(function(I,F){T.onload=I,T.onerror=F}),bn(w,"link",f),u.instance=w}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=lg.bind(r),o.addEventListener("load",u),o.addEventListener("error",u))}}var Sb=0;function fD(r,o){return r.stylesheets&&r.count===0&&ug(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var f=setTimeout(function(){if(r.stylesheets&&ug(r,r.stylesheets),r.unsuspend){var w=r.unsuspend;r.unsuspend=null,w()}},6e4+o);0<r.imgBytes&&Sb===0&&(Sb=62500*YI());var _=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&ug(r,r.stylesheets),r.unsuspend)){var w=r.unsuspend;r.unsuspend=null,w()}},(r.imgBytes>Sb?50:800)+o);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(f),clearTimeout(_)}}:null}function lg(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ug(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var cg=null;function ug(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,cg=new Map,o.forEach(pD,r),cg=null,lg.call(r))}function pD(r,o){if(!(o.state.loading&4)){var u=cg.get(r);if(u)var f=u.get(null);else{u=new Map,cg.set(r,u);for(var _=r.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<_.length;w++){var T=_[w];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(u.set(T.dataset.precedence,T),f=T)}f&&u.set(null,f)}_=o.instance,T=_.getAttribute("data-precedence"),w=u.get(T)||f,w===f&&u.set(null,_),u.set(T,_),this.count++,f=lg.bind(this),_.addEventListener("load",f),_.addEventListener("error",f),w?w.parentNode.insertBefore(_,w.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(_,r.firstChild)),o.state.loading|=4}}var Lh={$$typeof:P,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function mD(r,o,u,f,_,w,T,I,F){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=vy(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vy(0),this.hiddenUpdates=vy(null),this.identifierPrefix=f,this.onUncaughtError=_,this.onCaughtError=w,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function _1(r,o,u,f,_,w,T,I,F,V,Q,te){return r=new mD(r,o,u,T,F,V,Q,te,I),o=1,w===!0&&(o|=24),w=gs(3,null,null,o),r.current=w,w.stateNode=r,o=nv(),o.refCount++,r.pooledCache=o,o.refCount++,w.memoizedState={element:f,isDehydrated:u,cache:o},av(w),r}function x1(r){return r?(r=Mc,r):Mc}function w1(r,o,u,f,_,w){_=x1(_),f.context===null?f.context=_:f.pendingContext=_,f=Ta(o),f.payload={element:u},w=w===void 0?null:w,w!==null&&(f.callback=w),u=Ca(r,f,o),u!==null&&(is(u,r,o),fh(u,r,o))}function S1(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<o?u:o}}function Ab(r,o){S1(r,o),(r=r.alternate)&&S1(r,o)}function A1(r){if(r.tag===13||r.tag===31){var o=Oo(r,67108864);o!==null&&is(o,r,67108864),Ab(r,67108864)}}function E1(r){if(r.tag===13||r.tag===31){var o=xs();o=by(o);var u=Oo(r,o);u!==null&&is(u,r,o),Ab(r,o)}}var dg=!0;function gD(r,o,u,f){var _=j.T;j.T=null;var w=X.p;try{X.p=2,Eb(r,o,u,f)}finally{X.p=w,j.T=_}}function yD(r,o,u,f){var _=j.T;j.T=null;var w=X.p;try{X.p=8,Eb(r,o,u,f)}finally{X.p=w,j.T=_}}function Eb(r,o,u,f){if(dg){var _=Tb(f);if(_===null)db(r,o,f,hg,u),C1(r,f);else if(bD(_,r,o,u,f))f.stopPropagation();else if(C1(r,f),o&4&&-1<vD.indexOf(r)){for(;_!==null;){var w=_c(_);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var T=Mo(w.pendingLanes);if(T!==0){var I=w;for(I.pendingLanes|=2,I.entangledLanes|=2;T;){var F=1<<31-ps(T);I.entanglements[1]|=F,T&=~F}Bi(w),(at&6)===0&&(Km=hs()+500,Rh(0))}}break;case 31:case 13:I=Oo(w,2),I!==null&&is(I,w,2),Xm(),Ab(w,2)}if(w=Tb(f),w===null&&db(r,o,f,hg,u),w===_)break;_=w}_!==null&&f.stopPropagation()}else db(r,o,f,null,u)}}function Tb(r){return r=Ny(r),Cb(r)}var hg=null;function Cb(r){if(hg=null,r=bc(r),r!==null){var o=a(r);if(o===null)r=null;else{var u=o.tag;if(u===13){if(r=l(o),r!==null)return r;r=null}else if(u===31){if(r=c(o),r!==null)return r;r=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return hg=r,null}function T1(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(sM()){case Pw:return 2;case Lw:return 8;case tm:case iM:return 32;case Ow:return 268435456;default:return 32}default:return 32}}var Nb=!1,Fa=null,za=null,ja=null,Oh=new Map,Uh=new Map,Ha=[],vD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function C1(r,o){switch(r){case"focusin":case"focusout":Fa=null;break;case"dragenter":case"dragleave":za=null;break;case"mouseover":case"mouseout":ja=null;break;case"pointerover":case"pointerout":Oh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uh.delete(o.pointerId)}}function Fh(r,o,u,f,_,w){return r===null||r.nativeEvent!==w?(r={blockedOn:o,domEventName:u,eventSystemFlags:f,nativeEvent:w,targetContainers:[_]},o!==null&&(o=_c(o),o!==null&&A1(o)),r):(r.eventSystemFlags|=f,o=r.targetContainers,_!==null&&o.indexOf(_)===-1&&o.push(_),r)}function bD(r,o,u,f,_){switch(o){case"focusin":return Fa=Fh(Fa,r,o,u,f,_),!0;case"dragenter":return za=Fh(za,r,o,u,f,_),!0;case"mouseover":return ja=Fh(ja,r,o,u,f,_),!0;case"pointerover":var w=_.pointerId;return Oh.set(w,Fh(Oh.get(w)||null,r,o,u,f,_)),!0;case"gotpointercapture":return w=_.pointerId,Uh.set(w,Fh(Uh.get(w)||null,r,o,u,f,_)),!0}return!1}function N1(r){var o=bc(r.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){r.blockedOn=o,Bw(r.priority,function(){E1(u)});return}}else if(o===31){if(o=c(u),o!==null){r.blockedOn=o,Bw(r.priority,function(){E1(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function fg(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var u=Tb(r.nativeEvent);if(u===null){u=r.nativeEvent;var f=new u.constructor(u.type,u);Cy=f,u.target.dispatchEvent(f),Cy=null}else return o=_c(u),o!==null&&A1(o),r.blockedOn=u,!1;o.shift()}return!0}function R1(r,o,u){fg(r)&&u.delete(o)}function _D(){Nb=!1,Fa!==null&&fg(Fa)&&(Fa=null),za!==null&&fg(za)&&(za=null),ja!==null&&fg(ja)&&(ja=null),Oh.forEach(R1),Uh.forEach(R1)}function pg(r,o){r.blockedOn===o&&(r.blockedOn=null,Nb||(Nb=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,_D)))}var mg=null;function k1(r){mg!==r&&(mg=r,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){mg===r&&(mg=null);for(var o=0;o<r.length;o+=3){var u=r[o],f=r[o+1],_=r[o+2];if(typeof f!="function"){if(Cb(f||u)===null)continue;break}var w=_c(u);w!==null&&(r.splice(o,3),o-=3,Tv(w,{pending:!0,data:_,method:u.method,action:f},f,_))}}))}function tu(r){function o(F){return pg(F,r)}Fa!==null&&pg(Fa,r),za!==null&&pg(za,r),ja!==null&&pg(ja,r),Oh.forEach(o),Uh.forEach(o);for(var u=0;u<Ha.length;u++){var f=Ha[u];f.blockedOn===r&&(f.blockedOn=null)}for(;0<Ha.length&&(u=Ha[0],u.blockedOn===null);)N1(u),u.blockedOn===null&&Ha.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var _=u[f],w=u[f+1],T=_[Qn]||null;if(typeof w=="function")T||k1(u);else if(T){var I=null;if(w&&w.hasAttribute("formAction")){if(_=w,T=w[Qn]||null)I=T.formAction;else if(Cb(_)!==null)continue}else I=T.action;typeof I=="function"?u[f+1]=I:(u.splice(f,3),f-=3),k1(u)}}}function M1(){function r(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(T){return _=T})},focusReset:"manual",scroll:"manual"})}function o(){_!==null&&(_(),_=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,_=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),_!==null&&(_(),_=null)}}}function Rb(r){this._internalRoot=r}gg.prototype.render=Rb.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var u=o.current,f=xs();w1(u,f,r,o,null,null)},gg.prototype.unmount=Rb.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;w1(r.current,2,null,r,null,null),Xm(),o[vc]=null}};function gg(r){this._internalRoot=r}gg.prototype.unstable_scheduleHydration=function(r){if(r){var o=Hw();r={blockedOn:null,target:r,priority:o};for(var u=0;u<Ha.length&&o!==0&&o<Ha[u].priority;u++);Ha.splice(u,0,r),u===0&&N1(r)}};var I1=e.version;if(I1!=="19.2.3")throw Error(n(527,I1,"19.2.3"));X.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=h(o),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var xD={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yg.isDisabled&&yg.supportsFiber)try{Yd=yg.inject(xD),fs=yg}catch{}}return jh.createRoot=function(r,o){if(!i(r))throw Error(n(299));var u=!1,f="",_=zA,w=jA,T=HA;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(_=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError)),o=_1(r,1,!1,null,null,u,f,null,_,w,T,M1),r[vc]=o.current,ub(r),new Rb(o)},jh.hydrateRoot=function(r,o,u){if(!i(r))throw Error(n(299));var f=!1,_="",w=zA,T=jA,I=HA,F=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(_=u.identifierPrefix),u.onUncaughtError!==void 0&&(w=u.onUncaughtError),u.onCaughtError!==void 0&&(T=u.onCaughtError),u.onRecoverableError!==void 0&&(I=u.onRecoverableError),u.formState!==void 0&&(F=u.formState)),o=_1(r,1,!0,o,u??null,f,_,F,w,T,I,M1),o.context=x1(null),u=o.current,f=xs(),f=by(f),_=Ta(f),_.callback=null,Ca(u,_,f),u=f,o.current.lanes=u,Jd(o,u),Bi(o),r[vc]=o.current,ub(r),new gg(o)},jh.version="19.2.3",jh}var G1;function DD(){if(G1)return Db.exports;G1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Db.exports=ID(),Db.exports}var PD=DD();const LD=Wx(PD);function W0(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(s);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(s,n[i])&&(t[n[i]]=s[n[i]]);return t}function OD(s,e,t,n){function i(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(p){try{h(n.next(p))}catch(v){l(v)}}function d(p){try{h(n.throw(p))}catch(v){l(v)}}function h(p){p.done?a(p.value):i(p.value).then(c,d)}h((n=n.apply(s,e||[])).next())})}const UD=s=>s?(...e)=>s(...e):(...e)=>fetch(...e);class Zx extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class FD extends Zx{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class q1 extends Zx{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class V1 extends Zx{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var a_;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(a_||(a_={}));class zD{constructor(e,{headers:t={},customFetch:n,region:i=a_.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=UD(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return OD(this,arguments,void 0,function*(t,n={}){var i;let a,l;try{const{headers:c,method:d,body:h,signal:p,timeout:v}=n;let x={},{region:S}=n;S||(S=this.region);const A=new URL(`${this.url}/${t}`);S&&S!=="any"&&(x["x-region"]=S,A.searchParams.set("forceFunctionRegion",S));let E;h&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",E=h):typeof h=="string"?(x["Content-Type"]="text/plain",E=h):typeof FormData<"u"&&h instanceof FormData?E=h:(x["Content-Type"]="application/json",E=JSON.stringify(h)):h&&typeof h!="string"&&!(typeof Blob<"u"&&h instanceof Blob)&&!(h instanceof ArrayBuffer)&&!(typeof FormData<"u"&&h instanceof FormData)?E=JSON.stringify(h):E=h;let N=p;v&&(l=new AbortController,a=setTimeout(()=>l.abort(),v),p?(N=l.signal,p.addEventListener("abort",()=>l.abort())):N=l.signal);const R=yield this.fetch(A.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),c),body:E,signal:N}).catch(H=>{throw new FD(H)}),D=R.headers.get("x-relay-error");if(D&&D==="true")throw new q1(R);if(!R.ok)throw new V1(R);let P=((i=R.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),L;return P==="application/json"?L=yield R.json():P==="application/octet-stream"||P==="application/pdf"?L=yield R.blob():P==="text/event-stream"?L=R:P==="multipart/form-data"?L=yield R.formData():L=yield R.text(),{data:L,error:null,response:R}}catch(c){return{data:null,error:c,response:c instanceof V1||c instanceof q1?c.context:void 0}}finally{a&&clearTimeout(a)}})}}var on={},nu={},su={},iu={},ru={},au={},jD=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},zd=jD();const HD=zd.fetch,SN=zd.fetch.bind(zd),AN=zd.Headers,BD=zd.Request,GD=zd.Response,qD=Object.freeze(Object.defineProperty({__proto__:null,Headers:AN,Request:BD,Response:GD,default:SN,fetch:HD},Symbol.toStringTag,{value:"Module"})),VD=ED(qD);var vg={},$1;function EN(){if($1)return vg;$1=1,Object.defineProperty(vg,"__esModule",{value:!0});class s extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return vg.default=s,vg}var Y1;function TN(){if(Y1)return au;Y1=1;var s=au&&au.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(au,"__esModule",{value:!0});const e=s(VD),t=s(EN());class n{constructor(a){var l,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(l=a.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=a.signal,this.isMaybeSingle=(c=a.isMaybeSingle)!==null&&c!==void 0?c:!1,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=new Headers(this.headers),this.headers.set(a,l),this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var p,v,x,S;let A=null,E=null,N=null,R=h.status,D=h.statusText;if(h.ok){if(this.method!=="HEAD"){const z=await h.text();z===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?E=z:E=JSON.parse(z))}const L=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),H=(x=h.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");L&&H&&H.length>1&&(N=parseInt(H[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(A={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,N=null,R=406,D="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const L=await h.text();try{A=JSON.parse(L),Array.isArray(A)&&h.status===404&&(E=[],A=null,R=200,D="OK")}catch{h.status===404&&L===""?(R=204,D="No Content"):A={message:L}}if(A&&this.isMaybeSingle&&(!((S=A==null?void 0:A.details)===null||S===void 0)&&S.includes("0 rows"))&&(A=null,R=200,D="OK"),A&&this.shouldThrowOnError)throw new t.default(A)}return{error:A,data:E,count:N,status:R,statusText:D}});return this.shouldThrowOnError||(d=d.catch(h=>{var p,v,x;return{error:{message:`${(p=h==null?void 0:h.name)!==null&&p!==void 0?p:"FetchError"}: ${h==null?void 0:h.message}`,details:`${(v=h==null?void 0:h.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(x=h==null?void 0:h.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),d.then(a,l)}returns(){return this}overrideTypes(){return this}}return au.default=n,au}var K1;function CN(){if(K1)return ru;K1=1;var s=ru&&ru.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ru,"__esModule",{value:!0});const e=s(TN());class t extends e.default{select(i){let a=!1;const l=(i??"*").split("").map(c=>/\s/.test(c)&&!a?"":(c==='"'&&(a=!a),c)).join("");return this.url.searchParams.set("select",l),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:a=!0,nullsFirst:l,foreignTable:c,referencedTable:d=c}={}){const h=d?`${d}.order`:"order",p=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${p?`${p},`:""}${i}.${a?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:a,referencedTable:l=a}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${i}`),this}range(i,a,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"offset":`${c}.offset`,h=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${i}`),this.url.searchParams.set(h,`${a-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:a=!1,settings:l=!1,buffers:c=!1,wal:d=!1,format:h="text"}={}){var p;const v=[i?"analyze":null,a?"verbose":null,l?"settings":null,c?"buffers":null,d?"wal":null].filter(Boolean).join("|"),x=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${x}"; options=${v};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return ru.default=t,ru}var J1;function ew(){if(J1)return iu;J1=1;var s=iu&&iu.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(iu,"__esModule",{value:!0});const e=s(CN());class t extends e.default{eq(i,a){return this.url.searchParams.append(i,`eq.${a}`),this}neq(i,a){return this.url.searchParams.append(i,`neq.${a}`),this}gt(i,a){return this.url.searchParams.append(i,`gt.${a}`),this}gte(i,a){return this.url.searchParams.append(i,`gte.${a}`),this}lt(i,a){return this.url.searchParams.append(i,`lt.${a}`),this}lte(i,a){return this.url.searchParams.append(i,`lte.${a}`),this}like(i,a){return this.url.searchParams.append(i,`like.${a}`),this}likeAllOf(i,a){return this.url.searchParams.append(i,`like(all).{${a.join(",")}}`),this}likeAnyOf(i,a){return this.url.searchParams.append(i,`like(any).{${a.join(",")}}`),this}ilike(i,a){return this.url.searchParams.append(i,`ilike.${a}`),this}ilikeAllOf(i,a){return this.url.searchParams.append(i,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(i,a){return this.url.searchParams.append(i,`ilike(any).{${a.join(",")}}`),this}is(i,a){return this.url.searchParams.append(i,`is.${a}`),this}in(i,a){const l=Array.from(new Set(a)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(i,`in.(${l})`),this}contains(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cs.{${a.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(a)}`),this}containedBy(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cd.{${a.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(a)}`),this}rangeGt(i,a){return this.url.searchParams.append(i,`sr.${a}`),this}rangeGte(i,a){return this.url.searchParams.append(i,`nxl.${a}`),this}rangeLt(i,a){return this.url.searchParams.append(i,`sl.${a}`),this}rangeLte(i,a){return this.url.searchParams.append(i,`nxr.${a}`),this}rangeAdjacent(i,a){return this.url.searchParams.append(i,`adj.${a}`),this}overlaps(i,a){return typeof a=="string"?this.url.searchParams.append(i,`ov.${a}`):this.url.searchParams.append(i,`ov.{${a.join(",")}}`),this}textSearch(i,a,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const h=l===void 0?"":`(${l})`;return this.url.searchParams.append(i,`${d}fts${h}.${a}`),this}match(i){return Object.entries(i).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(i,a,l){return this.url.searchParams.append(i,`not.${a}.${l}`),this}or(i,{foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${i})`),this}filter(i,a,l){return this.url.searchParams.append(i,`${a}.${l}`),this}}return iu.default=t,iu}var X1;function NN(){if(X1)return su;X1=1;var s=su&&su.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(su,"__esModule",{value:!0});const e=s(ew());class t{constructor(i,{headers:a={},schema:l,fetch:c}){this.url=i,this.headers=new Headers(a),this.schema=l,this.fetch=c}select(i,{head:a=!1,count:l}={}){const c=a?"HEAD":"GET";let d=!1;const h=(i??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",h),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:a,defaultToNull:l=!0}={}){var c;const d="POST";if(a&&this.headers.append("Prefer",`count=${a}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const h=i.reduce((p,v)=>p.concat(Object.keys(v)),[]);if(h.length>0){const p=[...new Set(h)].map(v=>`"${v}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}upsert(i,{onConflict:a,ignoreDuplicates:l=!1,count:c,defaultToNull:d=!0}={}){var h;const p="POST";if(this.headers.append("Prefer",`resolution=${l?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),c&&this.headers.append("Prefer",`count=${c}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const v=i.reduce((x,S)=>x.concat(Object.keys(S)),[]);if(v.length>0){const x=[...new Set(v)].map(S=>`"${S}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}update(i,{count:a}={}){var l;const c="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}delete({count:i}={}){var a;const l="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return su.default=t,su}var W1;function $D(){if(W1)return nu;W1=1;var s=nu&&nu.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(nu,"__esModule",{value:!0});const e=s(NN()),t=s(ew());class n{constructor(a,{headers:l={},schema:c,fetch:d}={}){this.url=a,this.headers=new Headers(l),this.schemaName=c,this.fetch=d}from(a){const l=new URL(`${this.url}/${a}`);return new e.default(l,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new n(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,l={},{head:c=!1,get:d=!1,count:h}={}){var p;let v;const x=new URL(`${this.url}/rpc/${a}`);let S;c||d?(v=c?"HEAD":"GET",Object.entries(l).filter(([E,N])=>N!==void 0).map(([E,N])=>[E,Array.isArray(N)?`{${N.join(",")}}`:`${N}`]).forEach(([E,N])=>{x.searchParams.append(E,N)})):(v="POST",S=l);const A=new Headers(this.headers);return h&&A.set("Prefer",`count=${h}`),new t.default({method:v,url:x,headers:A,schema:this.schemaName,body:S,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return nu.default=n,nu}var Q1;function YD(){if(Q1)return on;Q1=1;var s=on&&on.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(on,"__esModule",{value:!0}),on.PostgrestError=on.PostgrestBuilder=on.PostgrestTransformBuilder=on.PostgrestFilterBuilder=on.PostgrestQueryBuilder=on.PostgrestClient=void 0;const e=s($D());on.PostgrestClient=e.default;const t=s(NN());on.PostgrestQueryBuilder=t.default;const n=s(ew());on.PostgrestFilterBuilder=n.default;const i=s(CN());on.PostgrestTransformBuilder=i.default;const a=s(TN());on.PostgrestBuilder=a.default;const l=s(EN());return on.PostgrestError=l.default,on.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:a.default,PostgrestError:l.default},on}var KD=YD();const JD=Wx(KD),{PostgrestClient:XD,PostgrestQueryBuilder:lq,PostgrestFilterBuilder:cq,PostgrestTransformBuilder:uq,PostgrestBuilder:dq,PostgrestError:hq}=JD;class WD{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const n=t.versions;if(n&&n.node){const i=n.node,a=parseInt(i.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const QD="2.90.1",ZD=`realtime-js/${QD}`,RN="1.0.0",eP="2.0.0",Z1=RN,o_=1e4,tP=1e3,nP=100;var qa;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(qa||(qa={}));var Zt;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(Zt||(Zt={}));var Ii;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(Ii||(Ii={}));var l_;(function(s){s.websocket="websocket"})(l_||(l_={}));var nl;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(nl||(nl={}));class sP{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,n;const i=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(e){var t,n;const i=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(e,t,n){var i,a;const l=e.topic,c=(i=e.ref)!==null&&i!==void 0?i:"",d=(a=e.join_ref)!==null&&a!==void 0?a:"",h=e.payload.event,p=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},v=Object.keys(p).length===0?"":JSON.stringify(p);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`metadata length ${v.length} exceeds maximum of 255`);const x=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+c.length+l.length+h.length+v.length,S=new ArrayBuffer(this.HEADER_LENGTH+x);let A=new DataView(S),E=0;A.setUint8(E++,this.KINDS.userBroadcastPush),A.setUint8(E++,d.length),A.setUint8(E++,c.length),A.setUint8(E++,l.length),A.setUint8(E++,h.length),A.setUint8(E++,v.length),A.setUint8(E++,t),Array.from(d,R=>A.setUint8(E++,R.charCodeAt(0))),Array.from(c,R=>A.setUint8(E++,R.charCodeAt(0))),Array.from(l,R=>A.setUint8(E++,R.charCodeAt(0))),Array.from(h,R=>A.setUint8(E++,R.charCodeAt(0))),Array.from(v,R=>A.setUint8(E++,R.charCodeAt(0)));var N=new Uint8Array(S.byteLength+n.byteLength);return N.set(new Uint8Array(S),0),N.set(new Uint8Array(n),S.byteLength),N.buffer}decode(e,t){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return t(n)}if(typeof e=="string"){const n=JSON.parse(e),[i,a,l,c,d]=n;return t({join_ref:i,ref:a,topic:l,event:c,payload:d})}return t({})}_binaryDecode(e){const t=new DataView(e),n=t.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,i)}}_decodeUserBroadcast(e,t,n){const i=t.getUint8(1),a=t.getUint8(2),l=t.getUint8(3),c=t.getUint8(4);let d=this.HEADER_LENGTH+4;const h=n.decode(e.slice(d,d+i));d=d+i;const p=n.decode(e.slice(d,d+a));d=d+a;const v=n.decode(e.slice(d,d+l));d=d+l;const x=e.slice(d,e.byteLength),S=c===this.JSON_ENCODING?JSON.parse(n.decode(x)):x,A={type:this.BROADCAST_EVENT,event:p,payload:S};return l>0&&(A.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:A}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([n])=>t.includes(n)))}}class kN{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var bt;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(bt||(bt={}));const eT=(s,e,t={})=>{var n;const i=(n=t.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((a,l)=>(a[l]=iP(l,s,e,i),a),{}):{}},iP=(s,e,t,n)=>{const i=e.find(c=>c.name===s),a=i==null?void 0:i.type,l=t[s];return a&&!n.includes(a)?MN(a,l):c_(l)},MN=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return lP(e,t)}switch(s){case bt.bool:return rP(e);case bt.float4:case bt.float8:case bt.int2:case bt.int4:case bt.int8:case bt.numeric:case bt.oid:return aP(e);case bt.json:case bt.jsonb:return oP(e);case bt.timestamp:return cP(e);case bt.abstime:case bt.date:case bt.daterange:case bt.int4range:case bt.int8range:case bt.money:case bt.reltime:case bt.text:case bt.time:case bt.timestamptz:case bt.timetz:case bt.tsrange:case bt.tstzrange:return c_(e);default:return c_(e)}},c_=s=>s,rP=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},aP=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},oP=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch{return s}return s},lP=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,n=s[t];if(s[0]==="{"&&n==="}"){let a;const l=s.slice(1,t);try{a=JSON.parse("["+l+"]")}catch{a=l?l.split(","):[]}return a.map(c=>MN(e,c))}return s},cP=s=>typeof s=="string"?s.replace(" ","T"):s,IN=s=>{const e=new URL(s);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Ub{constructor(e,t,n={},i=o_){this.channel=e,this.event=t,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var tT;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(tT||(tT={}));class hf{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=hf.syncState(this.state,i,a,l),this.pendingDiffs.forEach(d=>{this.state=hf.syncDiff(this.state,d,a,l)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},i=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=hf.syncDiff(this.state,i,a,l),c())}),this.onJoin((i,a,l)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:l})}),this.onLeave((i,a,l)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,i){const a=this.cloneDeep(e),l=this.transformState(t),c={},d={};return this.map(a,(h,p)=>{l[h]||(d[h]=p)}),this.map(l,(h,p)=>{const v=a[h];if(v){const x=p.map(N=>N.presence_ref),S=v.map(N=>N.presence_ref),A=p.filter(N=>S.indexOf(N.presence_ref)<0),E=v.filter(N=>x.indexOf(N.presence_ref)<0);A.length>0&&(c[h]=A),E.length>0&&(d[h]=E)}else c[h]=p}),this.syncDiff(a,{joins:c,leaves:d},n,i)}static syncDiff(e,t,n,i){const{joins:a,leaves:l}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(a,(c,d)=>{var h;const p=(h=e[c])!==null&&h!==void 0?h:[];if(e[c]=this.cloneDeep(d),p.length>0){const v=e[c].map(S=>S.presence_ref),x=p.filter(S=>v.indexOf(S.presence_ref)<0);e[c].unshift(...x)}n(c,p,d)}),this.map(l,(c,d)=>{let h=e[c];if(!h)return;const p=d.map(v=>v.presence_ref);h=h.filter(v=>p.indexOf(v.presence_ref)<0),e[c]=h,i(c,h,d),h.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const i=e[n];return"metas"in i?t[n]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[n]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var nT;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(nT||(nT={}));var ff;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(ff||(ff={}));var Dr;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Dr||(Dr={}));class Au{constructor(e,t={config:{}},n){var i,a;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Zt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ub(this,Ii.join,this.params,this.timeout),this.rejoinTimer=new kN(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Zt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Zt.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Zt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ii.reply,{},(l,c)=>{this._trigger(this._replyEventName(c),l)}),this.presence=new hf(this),this.broadcastEndpointURL=IN(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var n,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Zt.closed){const{config:{broadcast:l,presence:c,private:d}}=this.params,h=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(S=>S.filter))!==null&&i!==void 0?i:[],p=!!this.bindings[ff.PRESENCE]&&this.bindings[ff.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,v={},x={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:p}),postgres_changes:h,private:d};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(S=>e==null?void 0:e(Dr.CHANNEL_ERROR,S)),this._onClose(()=>e==null?void 0:e(Dr.CLOSED)),this.updateJoinPayload(Object.assign({config:x},v)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:S})=>{var A;if(this.socket._isManualToken()||this.socket.setAuth(),S===void 0){e==null||e(Dr.SUBSCRIBED);return}else{const E=this.bindings.postgres_changes,N=(A=E==null?void 0:E.length)!==null&&A!==void 0?A:0,R=[];for(let D=0;D<N;D++){const P=E[D],{filter:{event:L,schema:H,table:z,filter:U}}=P,J=S&&S[D];if(J&&J.event===L&&Au.isFilterValueEqual(J.schema,H)&&Au.isFilterValueEqual(J.table,z)&&Au.isFilterValueEqual(J.filter,U))R.push(Object.assign(Object.assign({},P),{id:J.id}));else{this.unsubscribe(),this.state=Zt.errored,e==null||e(Dr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=R,e&&e(Dr.SUBSCRIBED);return}}).receive("error",S=>{this.state=Zt.errored,e==null||e(Dr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Dr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===Zt.joined&&e===ff.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,n)}async httpSend(e,t,n={}){var i;if(t==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(c.status===202)return{success:!0};let d=c.statusText;try{const h=await c.json();d=h.error||h.message||d}catch{}return Promise.reject(new Error(d))}async send(e,t={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:l}=e,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:l,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=h.body)===null||i===void 0?void 0:i.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var l,c,d;const h=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),h.receive("ok",()=>a("ok")),h.receive("error",()=>a("error")),h.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Zt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ii.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Ub(this,Ii.leave,{},e),n.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Zt.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const i=new AbortController,a=setTimeout(()=>i.abort(),n),l=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(a),l}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Ub(this,e,t,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>nP){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var i,a;const l=e.toLocaleLowerCase(),{close:c,error:d,leave:h,join:p}=Ii;if(n&&[c,d,h,p].indexOf(l)>=0&&n!==this._joinRef())return;let x=this._onMessage(l,t,n);if(t&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(S=>{var A,E,N;return((A=S.filter)===null||A===void 0?void 0:A.event)==="*"||((N=(E=S.filter)===null||E===void 0?void 0:E.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===l}).map(S=>S.callback(x,n)):(a=this.bindings[l])===null||a===void 0||a.filter(S=>{var A,E,N,R,D,P,L,H;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in S){const z=S.id,U=(A=S.filter)===null||A===void 0?void 0:A.event;return z&&((E=t.ids)===null||E===void 0?void 0:E.includes(z))&&(U==="*"||(U==null?void 0:U.toLocaleLowerCase())===((N=t.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))&&(!(!((R=S.filter)===null||R===void 0)&&R.table)||S.filter.table===((D=t.data)===null||D===void 0?void 0:D.table))}else{const z=(L=(P=S==null?void 0:S.filter)===null||P===void 0?void 0:P.event)===null||L===void 0?void 0:L.toLocaleLowerCase();return z==="*"||z===((H=t==null?void 0:t.event)===null||H===void 0?void 0:H.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===l}).map(S=>{if(typeof x=="object"&&"ids"in x){const A=x.data,{schema:E,table:N,commit_timestamp:R,type:D,errors:P}=A;x=Object.assign(Object.assign({},{schema:E,table:N,commit_timestamp:R,eventType:D,new:{},old:{},errors:P}),this._getPayloadRecords(A))}S.callback(x,n)})}_isClosed(){return this.state===Zt.closed}_isJoined(){return this.state===Zt.joined}_isJoining(){return this.state===Zt.joining}_isLeaving(){return this.state===Zt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const i=e.toLocaleLowerCase(),a={type:i,filter:t,callback:n};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&Au.isEqual(i.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ii.close,{},e)}_onError(e){this._on(Ii.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Zt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=eT(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=eT(e.columns,e.old_record)),t}}const Fb=()=>{},bg={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},uP=[1e3,2e3,5e3,1e4],dP=1e4,hP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class fP{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=o_,this.transport=null,this.heartbeatIntervalMs=bg.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Fb,this.ref=0,this.reconnectTimer=null,this.vsn=Z1,this.logger=Fb,this.conn=null,this.sendBuffer=[],this.serializer=new sP,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),!(!((n=t==null?void 0:t.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${l_.websocket}`,this.httpEndpoint=IN(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=WD.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case qa.connecting:return nl.Connecting;case qa.open:return nl.Open;case qa.closing:return nl.Closing;default:return nl.Closed}}isConnected(){return this.connectionState()===nl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(a=>a.topic===n);if(i)return i;{const a=new Au(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:n,payload:i,ref:a}=e,l=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${t} ${n} (${a})`,i),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(tP,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},bg.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const h=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",h)}catch(p){this.log("error","error in heartbeat callback",p)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:a,ref:l}=t,c=l?`(${l})`:"",d=a.status||"";this.log("receive",`${d} ${n} ${i} ${c}`.trim(),a),this.channels.filter(h=>h._isMember(n)).forEach(h=>h._trigger(i,a,l)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===qa.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===qa.open||this.conn.readyState===qa.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ii.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${n}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([hP],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,n=!1;if(e)t=e,n=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),t=this.accessTokenValue}else t=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(i=>{const a={access_token:t,version:ZD};t&&i.updateJoinPayload(a),i.joinedOnce&&i._isJoined()&&i._push(Ii.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new kN(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},bg.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,i,a,l,c,d,h,p,v,x,S;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:o_,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:bg.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(l=e==null?void 0:e.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(c=e==null?void 0:e.heartbeatCallback)!==null&&c!==void 0?c:Fb,this.vsn=(d=e==null?void 0:e.vsn)!==null&&d!==void 0?d:Z1,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e==null?void 0:e.reconnectAfterMs)!==null&&h!==void 0?h:(A=>uP[A-1]||dP),this.vsn){case RN:this.encode=(p=e==null?void 0:e.encode)!==null&&p!==void 0?p:((A,E)=>E(JSON.stringify(A))),this.decode=(v=e==null?void 0:e.decode)!==null&&v!==void 0?v:((A,E)=>E(JSON.parse(A)));break;case eP:this.encode=(x=e==null?void 0:e.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(S=e==null?void 0:e.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var gf=class extends Error{constructor(s,e){var t;super(s),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function pP(s,e,t){const n=new URL(e,s);if(t)for(const[i,a]of Object.entries(t))a!==void 0&&n.searchParams.set(i,a);return n.toString()}async function mP(s){return!s||s.type==="none"?{}:s.type==="bearer"?{Authorization:`Bearer ${s.token}`}:s.type==="header"?{[s.name]:s.value}:s.type==="custom"?await s.getHeaders():{}}function gP(s){const e=s.fetchImpl??globalThis.fetch;return{async request({method:t,path:n,query:i,body:a,headers:l}){const c=pP(s.baseUrl,n,i),d=await mP(s.auth),h=await e(c,{method:t,headers:{...a?{"Content-Type":"application/json"}:{},...d,...l},body:a?JSON.stringify(a):void 0}),p=await h.text(),v=(h.headers.get("content-type")||"").includes("application/json"),x=v&&p?JSON.parse(p):p;if(!h.ok){const S=v?x:void 0,A=S==null?void 0:S.error;throw new gf((A==null?void 0:A.message)??`Request failed with status ${h.status}`,{status:h.status,icebergType:A==null?void 0:A.type,icebergCode:A==null?void 0:A.code,details:S})}return{status:h.status,headers:h.headers,data:x}}}}function _g(s){return s.join("")}var yP=class{constructor(s,e=""){this.client=s,this.prefix=e}async listNamespaces(s){const e=s?{parent:_g(s.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(s,e){const t={namespace:s.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${_g(s.namespace)}`})}async loadNamespaceMetadata(s){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${_g(s.namespace)}`})).data.properties}}async namespaceExists(s){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${_g(s.namespace)}`}),!0}catch(e){if(e instanceof gf&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(s,e){try{return await this.createNamespace(s,e)}catch(t){if(t instanceof gf&&t.status===409)return;throw t}}};function ou(s){return s.join("")}var vP=class{constructor(s,e="",t){this.client=s,this.prefix=e,this.accessDelegation=t}async listTables(s){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ou(s.namespace)}/tables`})).data.identifiers}async createTable(s,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ou(s.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(s,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ou(s.namespace)}/tables/${s.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(s,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ou(s.namespace)}/tables/${s.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(s){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ou(s.namespace)}/tables/${s.name}`,headers:e})).data.metadata}async tableExists(s){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ou(s.namespace)}/tables/${s.name}`,headers:e}),!0}catch(t){if(t instanceof gf&&t.status===404)return!1;throw t}}async createTableIfNotExists(s,e){try{return await this.createTable(s,e)}catch(t){if(t instanceof gf&&t.status===409)return await this.loadTable({namespace:s.namespace,name:e.name});throw t}}},bP=class{constructor(s){var n;let e="v1";s.catalogName&&(e+=`/${s.catalogName}`);const t=s.baseUrl.endsWith("/")?s.baseUrl:`${s.baseUrl}/`;this.client=gP({baseUrl:t,auth:s.auth,fetchImpl:s.fetch}),this.accessDelegation=(n=s.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new yP(this.client,e),this.tableOps=new vP(this.client,e,this.accessDelegation)}async listNamespaces(s){return this.namespaceOps.listNamespaces(s)}async createNamespace(s,e){return this.namespaceOps.createNamespace(s,e)}async dropNamespace(s){await this.namespaceOps.dropNamespace(s)}async loadNamespaceMetadata(s){return this.namespaceOps.loadNamespaceMetadata(s)}async listTables(s){return this.tableOps.listTables(s)}async createTable(s,e){return this.tableOps.createTable(s,e)}async updateTable(s,e){return this.tableOps.updateTable(s,e)}async dropTable(s,e){await this.tableOps.dropTable(s,e)}async loadTable(s){return this.tableOps.loadTable(s)}async namespaceExists(s){return this.namespaceOps.namespaceExists(s)}async tableExists(s){return this.tableOps.tableExists(s)}async createNamespaceIfNotExists(s,e){return this.namespaceOps.createNamespaceIfNotExists(s,e)}async createTableIfNotExists(s,e){return this.tableOps.createTableIfNotExists(s,e)}},Q0=class extends Error{constructor(s){super(s),this.__isStorageError=!0,this.name="StorageError"}};function It(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}var _P=class extends Q0{constructor(s,e,t){super(s),this.name="StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},u_=class extends Q0{constructor(s,e){super(s),this.name="StorageUnknownError",this.originalError=e}};const tw=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),xP=()=>Response,d_=s=>{if(Array.isArray(s))return s.map(t=>d_(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,n])=>{const i=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[i]=d_(n)}),e},wP=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},SP=s=>!s||typeof s!="string"||s.length===0||s.length>100||s.trim()!==s||s.includes("/")||s.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(s);function yf(s){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yf(s)}function AP(s,e){if(yf(s)!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e);if(yf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function EP(s){var e=AP(s,"string");return yf(e)=="symbol"?e:e+""}function TP(s,e,t){return(e=EP(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function sT(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,n)}return t}function Pe(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sT(Object(t),!0).forEach(function(n){TP(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):sT(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}const zb=s=>{var e;return s.msg||s.message||s.error_description||(typeof s.error=="string"?s.error:(e=s.error)===null||e===void 0?void 0:e.message)||JSON.stringify(s)},CP=async(s,e,t)=>{s instanceof await xP()&&!(t!=null&&t.noResolveJson)?s.json().then(n=>{const i=s.status||500,a=(n==null?void 0:n.statusCode)||i+"";e(new _P(zb(n),i,a))}).catch(n=>{e(new u_(zb(n),n))}):e(new u_(zb(s),s))},NP=(s,e,t,n)=>{const i={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"||!n?i:(wP(n)?(i.headers=Pe({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,e!=null&&e.duplex&&(i.duplex=e.duplex),Pe(Pe({},i),t))};async function Xp(s,e,t,n,i,a){return new Promise((l,c)=>{s(t,NP(e,n,i,a)).then(d=>{if(!d.ok)throw d;return n!=null&&n.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>CP(d,c,n))})}async function vf(s,e,t,n){return Xp(s,"GET",e,t,n)}async function vi(s,e,t,n,i){return Xp(s,"POST",e,n,i,t)}async function h_(s,e,t,n,i){return Xp(s,"PUT",e,n,i,t)}async function RP(s,e,t,n){return Xp(s,"HEAD",e,Pe(Pe({},t),{},{noResolveJson:!0}),n)}async function nw(s,e,t,n,i){return Xp(s,"DELETE",e,n,i,t)}var kP=class{constructor(s,e){this.downloadFn=s,this.shouldThrowOnError=e}then(s,e){return this.execute().then(s,e)}async execute(){var s=this;try{return{data:(await s.downloadFn()).body,error:null}}catch(e){if(s.shouldThrowOnError)throw e;if(It(e))return{data:null,error:e};throw e}}};let DN;DN=Symbol.toStringTag;var MP=class{constructor(s,e){this.downloadFn=s,this.shouldThrowOnError=e,this[DN]="BlobDownloadBuilder",this.promise=null}asStream(){return new kP(this.downloadFn,this.shouldThrowOnError)}then(s,e){return this.getPromise().then(s,e)}catch(s){return this.getPromise().catch(s)}finally(s){return this.getPromise().finally(s)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var s=this;try{return{data:await(await s.downloadFn()).blob(),error:null}}catch(e){if(s.shouldThrowOnError)throw e;if(It(e))return{data:null,error:e};throw e}}};const IP={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},iT={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var DP=class{constructor(s,e={},t,n){this.shouldThrowOnError=!1,this.url=s,this.headers=e,this.bucketId=t,this.fetch=tw(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(s,e,t,n){var i=this;try{let a;const l=Pe(Pe({},iT),n);let c=Pe(Pe({},i.headers),s==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&t instanceof Blob?(a=new FormData,a.append("cacheControl",l.cacheControl),d&&a.append("metadata",i.encodeMetadata(d)),a.append("",t)):typeof FormData<"u"&&t instanceof FormData?(a=t,a.has("cacheControl")||a.append("cacheControl",l.cacheControl),d&&!a.has("metadata")&&a.append("metadata",i.encodeMetadata(d))):(a=t,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=i.toBase64(i.encodeMetadata(d))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(c=Pe(Pe({},c),n.headers));const h=i._removeEmptyFolders(e),p=i._getFinalPath(h),v=await(s=="PUT"?h_:vi)(i.fetch,`${i.url}/object/${p}`,a,Pe({headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{data:{path:h,id:v.Id,fullPath:v.Key},error:null}}catch(a){if(i.shouldThrowOnError)throw a;if(It(a))return{data:null,error:a};throw a}}async upload(s,e,t){return this.uploadOrUpdate("POST",s,e,t)}async uploadToSignedUrl(s,e,t,n){var i=this;const a=i._removeEmptyFolders(s),l=i._getFinalPath(a),c=new URL(i.url+`/object/upload/sign/${l}`);c.searchParams.set("token",e);try{let d;const h=Pe({upsert:iT.upsert},n),p=Pe(Pe({},i.headers),{"x-upsert":String(h.upsert)});return typeof Blob<"u"&&t instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",t)):typeof FormData<"u"&&t instanceof FormData?(d=t,d.append("cacheControl",h.cacheControl)):(d=t,p["cache-control"]=`max-age=${h.cacheControl}`,p["content-type"]=h.contentType),{data:{path:a,fullPath:(await h_(i.fetch,c.toString(),d,{headers:p})).Key},error:null}}catch(d){if(i.shouldThrowOnError)throw d;if(It(d))return{data:null,error:d};throw d}}async createSignedUploadUrl(s,e){var t=this;try{let n=t._getFinalPath(s);const i=Pe({},t.headers);e!=null&&e.upsert&&(i["x-upsert"]="true");const a=await vi(t.fetch,`${t.url}/object/upload/sign/${n}`,{},{headers:i}),l=new URL(t.url+a.url),c=l.searchParams.get("token");if(!c)throw new Q0("No token returned by API");return{data:{signedUrl:l.toString(),path:s,token:c},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}}async update(s,e,t){return this.uploadOrUpdate("PUT",s,e,t)}async move(s,e,t){var n=this;try{return{data:await vi(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:s,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(It(i))return{data:null,error:i};throw i}}async copy(s,e,t){var n=this;try{return{data:{path:(await vi(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:s,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:n.headers})).Key},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(It(i))return{data:null,error:i};throw i}}async createSignedUrl(s,e,t){var n=this;try{let i=n._getFinalPath(s),a=await vi(n.fetch,`${n.url}/object/sign/${i}`,Pe({expiresIn:e},t!=null&&t.transform?{transform:t.transform}:{}),{headers:n.headers});const l=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return a={signedUrl:encodeURI(`${n.url}${a.signedURL}${l}`)},{data:a,error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(It(i))return{data:null,error:i};throw i}}async createSignedUrls(s,e,t){var n=this;try{const i=await vi(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:e,paths:s},{headers:n.headers}),a=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:i.map(l=>Pe(Pe({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${a}`):null})),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(It(i))return{data:null,error:i};throw i}}download(s,e){const t=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),i=n?`?${n}`:"",a=this._getFinalPath(s),l=()=>vf(this.fetch,`${this.url}/${t}/${a}${i}`,{headers:this.headers,noResolveJson:!0});return new MP(l,this.shouldThrowOnError)}async info(s){var e=this;const t=e._getFinalPath(s);try{return{data:d_(await vf(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}}async exists(s){var e=this;const t=e._getFinalPath(s);try{return await RP(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(It(n)&&n instanceof u_){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(s,e){const t=this._getFinalPath(s),n=[],i=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";i!==""&&n.push(i);const a=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${t}${c}`)}}}async remove(s){var e=this;try{return{data:await nw(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:s},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async list(s,e,t){var n=this;try{const i=Pe(Pe(Pe({},IP),e),{},{prefix:s||""});return{data:await vi(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},t),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(It(i))return{data:null,error:i};throw i}}async listV2(s,e){var t=this;try{const n=Pe({},s);return{data:await vi(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,n,{headers:t.headers},e),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s.replace(/^\/+/,"")}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const e=[];return s.width&&e.push(`width=${s.width}`),s.height&&e.push(`height=${s.height}`),s.resize&&e.push(`resize=${s.resize}`),s.format&&e.push(`format=${s.format}`),s.quality&&e.push(`quality=${s.quality}`),e.join("&")}};const PN="2.90.1",LN={"X-Client-Info":`storage-js/${PN}`};var PP=class{constructor(s,e={},t,n){this.shouldThrowOnError=!1;const i=new URL(s);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Pe(Pe({},LN),e),this.fetch=tw(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(s){var e=this;try{const t=e.listBucketOptionsToQueryString(s);return{data:await vf(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async getBucket(s){var e=this;try{return{data:await vf(e.fetch,`${e.url}/bucket/${s}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async createBucket(s,e={public:!1}){var t=this;try{return{data:await vi(t.fetch,`${t.url}/bucket`,{id:s,name:s,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}}async updateBucket(s,e){var t=this;try{return{data:await h_(t.fetch,`${t.url}/bucket/${s}`,{id:s,name:s,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}}async emptyBucket(s){var e=this;try{return{data:await vi(e.fetch,`${e.url}/bucket/${s}/empty`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async deleteBucket(s){var e=this;try{return{data:await nw(e.fetch,`${e.url}/bucket/${s}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(s){const e={};return s&&("limit"in s&&(e.limit=String(s.limit)),"offset"in s&&(e.offset=String(s.offset)),s.search&&(e.search=s.search),s.sortColumn&&(e.sortColumn=s.sortColumn),s.sortOrder&&(e.sortOrder=s.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},LP=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},LN),e),this.fetch=tw(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(s){var e=this;try{return{data:await vi(e.fetch,`${e.url}/bucket`,{name:s},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async listBuckets(s){var e=this;try{const t=new URLSearchParams;(s==null?void 0:s.limit)!==void 0&&t.set("limit",s.limit.toString()),(s==null?void 0:s.offset)!==void 0&&t.set("offset",s.offset.toString()),s!=null&&s.sortColumn&&t.set("sortColumn",s.sortColumn),s!=null&&s.sortOrder&&t.set("sortOrder",s.sortOrder),s!=null&&s.search&&t.set("search",s.search);const n=t.toString(),i=n?`${e.url}/bucket?${n}`:`${e.url}/bucket`;return{data:await vf(e.fetch,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}async deleteBucket(s){var e=this;try{return{data:await nw(e.fetch,`${e.url}/bucket/${s}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}}from(s){var e=this;if(!SP(s))throw new Q0("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new bP({baseUrl:this.url,catalogName:s,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(t,{get(i,a){const l=i[a];return typeof l!="function"?l:async(...c)=>{try{return{data:await l.apply(i,c),error:null}}catch(d){if(n)throw d;return{data:null,error:d}}}}})}};const sw={"X-Client-Info":`storage-js/${PN}`,"Content-Type":"application/json"};var ON=class extends Error{constructor(s){super(s),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Us(s){return typeof s=="object"&&s!==null&&"__isStorageVectorsError"in s}var jb=class extends ON{constructor(s,e,t){super(s),this.name="StorageVectorsApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},OP=class extends ON{constructor(s,e){super(s),this.name="StorageVectorsUnknownError",this.originalError=e}};const iw=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),UP=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},rT=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),FP=async(s,e,t)=>{if(s&&typeof s=="object"&&"status"in s&&"ok"in s&&typeof s.status=="number"&&!(t!=null&&t.noResolveJson)){const n=s.status||500,i=s;if(typeof i.json=="function")i.json().then(a=>{const l=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||n+"";e(new jb(rT(a),n,l))}).catch(()=>{const a=n+"";e(new jb(i.statusText||`HTTP ${n} error`,n,a))});else{const a=n+"";e(new jb(i.statusText||`HTTP ${n} error`,n,a))}}else e(new OP(rT(s),s))},zP=(s,e,t,n)=>{const i={method:s,headers:(e==null?void 0:e.headers)||{}};return n?(UP(n)?(i.headers=Pe({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,Pe(Pe({},i),t)):i};async function jP(s,e,t,n,i,a){return new Promise((l,c)=>{s(t,zP(e,n,i,a)).then(d=>{if(!d.ok)throw d;if(n!=null&&n.noResolveJson)return d;const h=d.headers.get("content-type");return!h||!h.includes("application/json")?{}:d.json()}).then(d=>l(d)).catch(d=>FP(d,c,n))})}async function Fs(s,e,t,n,i){return jP(s,"POST",e,n,i,t)}var HP=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},sw),e),this.fetch=iw(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(s){var e=this;try{return{data:await Fs(e.fetch,`${e.url}/CreateIndex`,s,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Us(t))return{data:null,error:t};throw t}}async getIndex(s,e){var t=this;try{return{data:await Fs(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:s,indexName:e},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Us(n))return{data:null,error:n};throw n}}async listIndexes(s){var e=this;try{return{data:await Fs(e.fetch,`${e.url}/ListIndexes`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Us(t))return{data:null,error:t};throw t}}async deleteIndex(s,e){var t=this;try{return{data:await Fs(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:s,indexName:e},{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Us(n))return{data:null,error:n};throw n}}},BP=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},sw),e),this.fetch=iw(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(s){var e=this;try{if(s.vectors.length<1||s.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Fs(e.fetch,`${e.url}/PutVectors`,s,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Us(t))return{data:null,error:t};throw t}}async getVectors(s){var e=this;try{return{data:await Fs(e.fetch,`${e.url}/GetVectors`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Us(t))return{data:null,error:t};throw t}}async listVectors(s){var e=this;try{if(s.segmentCount!==void 0){if(s.segmentCount<1||s.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(s.segmentIndex!==void 0&&(s.segmentIndex<0||s.segmentIndex>=s.segmentCount))throw new Error(`segmentIndex must be between 0 and ${s.segmentCount-1}`)}return{data:await Fs(e.fetch,`${e.url}/ListVectors`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Us(t))return{data:null,error:t};throw t}}async queryVectors(s){var e=this;try{return{data:await Fs(e.fetch,`${e.url}/QueryVectors`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Us(t))return{data:null,error:t};throw t}}async deleteVectors(s){var e=this;try{if(s.keys.length<1||s.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Fs(e.fetch,`${e.url}/DeleteVectors`,s,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Us(t))return{data:null,error:t};throw t}}},GP=class{constructor(s,e={},t){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},sw),e),this.fetch=iw(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(s){var e=this;try{return{data:await Fs(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:s},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Us(t))return{data:null,error:t};throw t}}async getBucket(s){var e=this;try{return{data:await Fs(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:s},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Us(t))return{data:null,error:t};throw t}}async listBuckets(s={}){var e=this;try{return{data:await Fs(e.fetch,`${e.url}/ListVectorBuckets`,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Us(t))return{data:null,error:t};throw t}}async deleteBucket(s){var e=this;try{return{data:await Fs(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:s},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Us(t))return{data:null,error:t};throw t}}},qP=class extends GP{constructor(s,e={}){super(s,e.headers||{},e.fetch)}from(s){return new VP(this.url,this.headers,s,this.fetch)}async createBucket(s){var e=()=>super.createBucket,t=this;return e().call(t,s)}async getBucket(s){var e=()=>super.getBucket,t=this;return e().call(t,s)}async listBuckets(s={}){var e=()=>super.listBuckets,t=this;return e().call(t,s)}async deleteBucket(s){var e=()=>super.deleteBucket,t=this;return e().call(t,s)}},VP=class extends HP{constructor(s,e,t,n){super(s,e,n),this.vectorBucketName=t}async createIndex(s){var e=()=>super.createIndex,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(s={}){var e=()=>super.listIndexes,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(s){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,s)}async deleteIndex(s){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,s)}index(s){return new $P(this.url,this.headers,this.vectorBucketName,s,this.fetch)}},$P=class extends BP{constructor(s,e,t,n,i){super(s,e,i),this.vectorBucketName=t,this.indexName=n}async putVectors(s){var e=()=>super.putVectors,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(s){var e=()=>super.getVectors,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(s={}){var e=()=>super.listVectors,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(s){var e=()=>super.queryVectors,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(s){var e=()=>super.deleteVectors,t=this;return e().call(t,Pe(Pe({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},YP=class extends PP{constructor(s,e={},t,n){super(s,e,t,n)}from(s){return new DP(this.url,this.headers,s,this.fetch)}get vectors(){return new qP(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new LP(this.url+"/iceberg",this.headers,this.fetch)}};const KP="2.39.3";let Yh="";typeof Deno<"u"?Yh="deno":typeof document<"u"?Yh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Yh="react-native":Yh="node";const JP={"X-Client-Info":`supabase-js-${Yh}/${KP}`};var XP=function(s,e,t,n){function i(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(p){try{h(n.next(p))}catch(v){l(v)}}function d(p){try{h(n.throw(p))}catch(v){l(v)}}function h(p){p.done?a(p.value):i(p.value).then(c,d)}h((n=n.apply(s,e||[])).next())})};const WP=s=>{let e;return s?e=s:typeof fetch>"u"?e=SN:e=fetch,(...t)=>e(...t)},QP=()=>typeof Headers>"u"?AN:Headers,ZP=(s,e,t)=>{const n=WP(t),i=QP();return(a,l)=>XP(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:s;let h=new i(l==null?void 0:l.headers);return h.has("apikey")||h.set("apikey",s),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),n(a,Object.assign(Object.assign({},l),{headers:h}))})};function eL(s){return s.replace(/\/$/,"")}function tL(s,e){const{db:t,auth:n,realtime:i,global:a}=s,{db:l,auth:c,realtime:d,global:h}=e;return{db:Object.assign(Object.assign({},l),t),auth:Object.assign(Object.assign({},c),n),realtime:Object.assign(Object.assign({},d),i),global:Object.assign(Object.assign({},h),a)}}const UN="2.90.1",fu=30*1e3,f_=3,Hb=f_*fu,nL="http://localhost:9999",sL="supabase.auth.token",iL={"X-Client-Info":`gotrue-js/${UN}`},p_="X-Supabase-Api-Version",FN={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rL=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,aL=600*1e3;class bf extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Ee(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class oL extends bf{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function lL(s){return Ee(s)&&s.name==="AuthApiError"}class sl extends bf{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class pa extends bf{constructor(e,t,n,i){super(e,n,i),this.name=t,this.status=n}}class ws extends pa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function cL(s){return Ee(s)&&s.name==="AuthSessionMissingError"}class lu extends pa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class xg extends pa{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class wg extends pa{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function uL(s){return Ee(s)&&s.name==="AuthImplicitGrantRedirectError"}class aT extends pa{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class dL extends pa{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class m_ extends pa{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Bb(s){return Ee(s)&&s.name==="AuthRetryableFetchError"}class oT extends pa{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class g_ extends pa{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const h0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),lT=` 	
\r=`.split(""),hL=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<lT.length;e+=1)s[lT[e].charCodeAt(0)]=-2;for(let e=0;e<h0.length;e+=1)s[h0[e].charCodeAt(0)]=e;return s})();function cT(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(h0[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(h0[n]),e.queuedBits-=6}}function zN(s,e,t){const n=hL[s];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function uT(s){const e=[],t=l=>{e.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=l=>{mL(l,n,t)};for(let l=0;l<s.length;l+=1)zN(s.charCodeAt(l),i,a);return e.join("")}function fL(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function pL(s,e){for(let t=0;t<s.length;t+=1){let n=s.charCodeAt(t);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(s.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}fL(n,e)}}function mL(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let n=1;n<6;n+=1)if((s>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Ru(s){const e=[],t={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<s.length;i+=1)zN(s.charCodeAt(i),t,n);return new Uint8Array(e)}function gL(s){const e=[];return pL(s,t=>e.push(t)),new Uint8Array(e)}function al(s){const e=[],t={queue:0,queuedBits:0},n=i=>{e.push(i)};return s.forEach(i=>cT(i,t,n)),cT(null,t,n),e.join("")}function yL(s){return Math.round(Date.now()/1e3)+s}function vL(){return Symbol("auth-callback")}const xn=()=>typeof window<"u"&&typeof document<"u",Jo={tested:!1,writable:!1},jN=()=>{if(!xn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Jo.tested)return Jo.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Jo.tested=!0,Jo.writable=!0}catch{Jo.tested=!0,Jo.writable=!1}return Jo.writable};function bL(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,a)=>{e[a]=i})}catch{}return t.searchParams.forEach((n,i)=>{e[i]=n}),e}const HN=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),_L=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",pu=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},Xo=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},_n=async(s,e)=>{await s.removeItem(e)};class Z0{constructor(){this.promise=new Z0.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Z0.promiseConstructor=Promise;function Gb(s){const e=s.split(".");if(e.length!==3)throw new g_("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!rL.test(e[n]))throw new g_("JWT not in base64url format");return{header:JSON.parse(uT(e[0])),payload:JSON.parse(uT(e[1])),signature:Ru(e[2]),raw:{header:e[0],payload:e[1]}}}async function xL(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function wL(s,e){return new Promise((n,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const l=await s(a);if(!e(a,null,l)){n(l);return}}catch(l){if(!e(a,l)){i(l);return}}})()})}function SL(s){return("0"+s.toString(16)).substr(-2)}function AL(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let i="";for(let a=0;a<56;a++)i+=t.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,SL).join("")}async function EL(s){const t=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function TL(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await EL(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function cu(s,e,t=!1){const n=AL();let i=n;t&&(i+="/PASSWORD_RECOVERY"),await pu(s,`${e}-code-verifier`,i);const a=await TL(n);return[a,n===a?"plain":"s256"]}const CL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function NL(s){const e=s.headers.get(p_);if(!e||!e.match(CL))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function RL(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function kL(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ML=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function uu(s){if(!ML.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function qb(){const s={};return new Proxy(s,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function IL(s,e){return new Proxy(s,{get:(t,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,n,i)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,n,i)}})}function dT(s){return JSON.parse(JSON.stringify(s))}const Wo=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),DL=[502,503,504];async function hT(s){var e;if(!_L(s))throw new m_(Wo(s),0);if(DL.includes(s.status))throw new m_(Wo(s),s.status);let t;try{t=await s.json()}catch(a){throw new sl(Wo(a),a)}let n;const i=NL(s);if(i&&i.getTime()>=FN["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new oT(Wo(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new ws}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0))throw new oT(Wo(t),s.status,t.weak_password.reasons);throw new oL(Wo(t),s.status||500,n)}const PL=(s,e,t,n)=>{const i={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),t))};async function De(s,e,t,n){var i;const a=Object.assign({},n==null?void 0:n.headers);a[p_]||(a[p_]=FN["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const l=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await LL(s,e,t+c,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(d):{data:Object.assign({},d),error:null}}async function LL(s,e,t,n,i,a){const l=PL(e,n,i,a);let c;try{c=await s(t,Object.assign({},l))}catch(d){throw console.error(d),new m_(Wo(d),0)}if(c.ok||await hT(c),n!=null&&n.noResolveJson)return c;try{return await c.json()}catch(d){await hT(d)}}function gi(s){var e;let t=null;FL(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=yL(s.expires_in)));const n=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:n},error:null}}function fT(s){const e=gi(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=s.weak_password),e}function Va(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function OL(s){return{data:s,error:null}}function UL(s){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:a}=s,l=W0(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:a},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function pT(s){return s}function FL(s){return s.access_token&&s.refresh_token&&s.expires_in}const Vb=["global","local","others"];class zL{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=HN(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Vb[0]){if(Vb.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Vb.join(", ")}`);try{return await De(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ee(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await De(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Va})}catch(n){if(Ee(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=W0(e,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await De(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:UL,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Ee(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await De(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Va})}catch(t){if(Ee(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,i,a,l,c,d;try{const h={nextPage:null,lastPage:0,total:0},p=await De(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:pT});if(p.error)throw p.error;const v=await p.json(),x=(l=p.headers.get("x-total-count"))!==null&&l!==void 0?l:0,S=(d=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return S.length>0&&(S.forEach(A=>{const E=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(A.split(";")[1].split("=")[1]);h[`${N}Page`]=E}),h.total=parseInt(x)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(Ee(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){uu(e);try{return await De(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Va})}catch(t){if(Ee(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){uu(e);try{return await De(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Va})}catch(n){if(Ee(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){uu(e);try{return await De(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Va})}catch(n){if(Ee(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){uu(e.userId);try{const{data:t,error:n}=await De(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:n}}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _deleteFactor(e){uu(e.userId),uu(e.id);try{return{data:await De(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,i,a,l,c,d;try{const h={nextPage:null,lastPage:0,total:0},p=await De(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:pT});if(p.error)throw p.error;const v=await p.json(),x=(l=p.headers.get("x-total-count"))!==null&&l!==void 0?l:0,S=(d=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return S.length>0&&(S.forEach(A=>{const E=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(A.split(";")[1].split("=")[1]);h[`${N}Page`]=E}),h.total=parseInt(x)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(Ee(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(e){try{return await De(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await De(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await De(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ee(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await De(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await De(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ee(t))return{data:null,error:t};throw t}}}function mT(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}const du={debug:!!(globalThis&&jN()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class BN extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class jL extends BN{}async function HL(s,e,t){du.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),du.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){du.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,i.name);try{return await t()}finally{du.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,i.name)}}else{if(e===0)throw du.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new jL(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(du.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function BL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function GN(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function GL(s){return parseInt(s,16)}function qL(s){const e=new TextEncoder().encode(s);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function VL(s){var e;const{chainId:t,domain:n,expirationTime:i,issuedAt:a=new Date,nonce:l,notBefore:c,requestId:d,resources:h,scheme:p,uri:v,version:x}=s;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((e=s.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const S=GN(s.address),A=p?`${p}://${n}`:n,E=s.statement?`${s.statement}
`:"",N=`${A} wants you to sign in with your Ethereum account:
${S}

${E}`;let R=`URI: ${v}
Version: ${x}
Chain ID: ${t}${l?`
Nonce: ${l}`:""}
Issued At: ${a.toISOString()}`;if(i&&(R+=`
Expiration Time: ${i.toISOString()}`),c&&(R+=`
Not Before: ${c.toISOString()}`),d&&(R+=`
Request ID: ${d}`),h){let D=`
Resources:`;for(const P of h){if(!P||typeof P!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${P}`);D+=`
- ${P}`}R+=D}return`${N}
${R}`}class Kt extends Error{constructor({message:e,code:t,cause:n,name:i}){var a;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=i??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=t}}class f0 extends Kt{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function $L({error:s,options:e}){var t,n,i;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Kt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((t=a.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Kt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(e.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Kt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((i=a.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Kt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new Kt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new Kt({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return a.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Kt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new Kt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const l=window.location.hostname;if(qN(l)){if(a.rp.id!==l)return new Kt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new Kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Kt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new Kt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new Kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function YL({error:s,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Kt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new Kt({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const n=window.location.hostname;if(qN(n)){if(t.rpId!==n)return new Kt({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new Kt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new Kt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new Kt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}class KL{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const JL=new KL;function XL(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:e,user:t,excludeCredentials:n}=s,i=W0(s,["challenge","user","excludeCredentials"]),a=Ru(e).buffer,l=Object.assign(Object.assign({},t),{id:Ru(t.id).buffer}),c=Object.assign(Object.assign({},i),{challenge:a,user:l});if(n&&n.length>0){c.excludeCredentials=new Array(n.length);for(let d=0;d<n.length;d++){const h=n[d];c.excludeCredentials[d]=Object.assign(Object.assign({},h),{id:Ru(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return c}function WL(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:e,allowCredentials:t}=s,n=W0(s,["challenge","allowCredentials"]),i=Ru(e).buffer,a=Object.assign(Object.assign({},n),{challenge:i});if(t&&t.length>0){a.allowCredentials=new Array(t.length);for(let l=0;l<t.length;l++){const c=t[l];a.allowCredentials[l]=Object.assign(Object.assign({},c),{id:Ru(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function QL(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s;return{id:s.id,rawId:s.id,response:{attestationObject:al(new Uint8Array(s.response.attestationObject)),clientDataJSON:al(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function ZL(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s,n=s.getClientExtensionResults(),i=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:al(new Uint8Array(i.authenticatorData)),clientDataJSON:al(new Uint8Array(i.clientDataJSON)),signature:al(new Uint8Array(i.signature)),userHandle:i.userHandle?al(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function qN(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function gT(){var s,e;return!!(xn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator==null?void 0:navigator.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function eO(s){try{const e=await navigator.credentials.create(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new f0("Browser returned unexpected credential type",e)}:{data:null,error:new f0("Empty credential response",e)}}catch(e){return{data:null,error:$L({error:e,options:s})}}}async function tO(s){try{const e=await navigator.credentials.get(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new f0("Browser returned unexpected credential type",e)}:{data:null,error:new f0("Empty credential response",e)}}catch(e){return{data:null,error:YL({error:e,options:s})}}}const nO={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},sO={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function p0(...s){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),t=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of s)if(i)for(const a in i){const l=i[a];if(l!==void 0)if(Array.isArray(l))n[a]=l;else if(t(l))n[a]=l;else if(e(l)){const c=n[a];e(c)?n[a]=p0(c,l):n[a]=p0(l)}else n[a]=l}return n}function iO(s,e){return p0(nO,s,e||{})}function rO(s,e){return p0(sO,s,e||{})}class aO{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:n,signal:i},a){try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!l)return{data:null,error:c};const d=i??JL.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:h}=l.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${n}`),h.displayName||(h.displayName=h.name)}switch(l.webauthn.type){case"create":{const h=iO(l.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:p,error:v}=await eO({publicKey:h,signal:d});return p?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:p}},error:null}:{data:null,error:v}}case"request":{const h=rO(l.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:p,error:v}=await tO(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:h,signal:d}));return p?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:p}},error:null}:{data:null,error:v}}}}catch(l){return Ee(l)?{data:null,error:l}:{data:null,error:new sl("Unexpected error in challenge",l)}}}async _verify({challengeId:e,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!t)return{data:null,error:new bf("rpId is required for WebAuthn authentication")};try{if(!gT())return{data:null,error:new sl("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:n},signal:i},{request:a});if(!l)return{data:null,error:c};const{webauthn:d}=l;return this._verify({factorId:e,challengeId:l.challengeId,webauthn:{type:d.type,rpId:t,rpOrigins:n,credential_response:d.credential_response}})}catch(l){return Ee(l)?{data:null,error:l}:{data:null,error:new sl("Unexpected error in authenticate",l)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!t)return{data:null,error:new bf("rpId is required for WebAuthn registration")};try{if(!gT())return{data:null,error:new sl("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this._enroll({friendlyName:e});if(!l)return await this.client.mfa.listFactors().then(p=>{var v;return(v=p.data)===null||v===void 0?void 0:v.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===e&&x.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p==null?void 0:p.id}):void 0),{data:null,error:c};const{data:d,error:h}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:i},{create:a});return d?this._verify({factorId:l.id,challengeId:d.challengeId,webauthn:{rpId:t,rpOrigins:n,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:h}}catch(l){return Ee(l)?{data:null,error:l}:{data:null,error:new sl("Unexpected error in register",l)}}}}BL();const oO={url:nL,storageKey:sL,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:iL,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function yT(s,e,t){return await t()}const hu={};class _f{get jwks(){var e,t;return(t=(e=hu[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){hu[this.storageKey]=Object.assign(Object.assign({},hu[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=hu[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){hu[this.storageKey]=Object.assign(Object.assign({},hu[this.storageKey]),{cachedAt:e})}constructor(e){var t,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},oO),e);if(this.storageKey=a.storageKey,this.instanceID=(t=_f.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,_f.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&xn()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new zL({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=HN(a.fetch),this.lock=a.lock||yT,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&xn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=HL:this.lock=yT,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new aO(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:jN()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=mT(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=mT(this.memoryStorage)),xn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${UN}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},n="none";if(xn()&&(t=bL(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),xn()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:a}=await this._getSessionFromURL(t,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),uL(a)){const d=(e=a.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return{error:a}}const{session:l,redirectType:c}=i;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ee(t)?this._returnResult({error:t}):this._returnResult({error:new sl("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,i;try{const a=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:gi}),{data:l,error:c}=a;if(c||!l)return this._returnResult({data:{user:null,session:null},error:c});const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(a){if(Ee(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,n,i;try{let a;if("email"in e){const{email:p,password:v,options:x}=e;let S=null,A=null;this.flowType==="pkce"&&([S,A]=await cu(this.storage,this.storageKey)),a=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x==null?void 0:x.emailRedirectTo,body:{email:p,password:v,data:(t=x==null?void 0:x.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken},code_challenge:S,code_challenge_method:A},xform:gi})}else if("phone"in e){const{phone:p,password:v,options:x}=e;a=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:v,data:(n=x==null?void 0:x.data)!==null&&n!==void 0?n:{},channel:(i=x==null?void 0:x.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken}},xform:gi})}else throw new xg("You must provide either an email or phone number and a password");const{data:l,error:c}=a;if(c||!l)return await _n(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(a){if(await _n(this.storage,`${this.storageKey}-code-verifier`),Ee(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:l,options:c}=e;t=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:fT})}else if("phone"in e){const{phone:a,password:l,options:c}=e;t=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:fT})}else throw new xg("You must provide either an email or phone number and a password");const{data:n,error:i}=t;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const a=new lu;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(t){if(Ee(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,n,i,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,n,i,a,l,c,d,h,p,v,x;let S,A;if("message"in e)S=e.message,A=e.signature;else{const{chain:E,wallet:N,statement:R,options:D}=e;let P;if(xn())if(typeof N=="object")P=N;else{const K=window;if("ethereum"in K&&typeof K.ethereum=="object"&&"request"in K.ethereum&&typeof K.ethereum.request=="function")P=K.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(D!=null&&D.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=N}const L=new URL((t=D==null?void 0:D.url)!==null&&t!==void 0?t:window.location.href),H=await P.request({method:"eth_requestAccounts"}).then(K=>K).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!H||H.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const z=GN(H[0]);let U=(n=D==null?void 0:D.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!U){const K=await P.request({method:"eth_chainId"});U=GL(K)}const J={domain:L.host,address:z,statement:R,uri:L.href,version:"1",chainId:U,nonce:(i=D==null?void 0:D.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(l=(a=D==null?void 0:D.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(c=D==null?void 0:D.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(d=D==null?void 0:D.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(h=D==null?void 0:D.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(p=D==null?void 0:D.signInWithEthereum)===null||p===void 0?void 0:p.resources};S=VL(J),A=await P.request({method:"personal_sign",params:[qL(S),z]})}try{const{data:E,error:N}=await De(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:S,signature:A},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:gi});if(N)throw N;if(!E||!E.session||!E.user){const R=new lu;return this._returnResult({data:{user:null,session:null},error:R})}return E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),this._returnResult({data:Object.assign({},E),error:N})}catch(E){if(Ee(E))return this._returnResult({data:{user:null,session:null},error:E});throw E}}async signInWithSolana(e){var t,n,i,a,l,c,d,h,p,v,x,S;let A,E;if("message"in e)A=e.message,E=e.signature;else{const{chain:N,wallet:R,statement:D,options:P}=e;let L;if(xn())if(typeof R=="object")L=R;else{const z=window;if("solana"in z&&typeof z.solana=="object"&&("signIn"in z.solana&&typeof z.solana.signIn=="function"||"signMessage"in z.solana&&typeof z.solana.signMessage=="function"))L=z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!(P!=null&&P.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");L=R}const H=new URL((t=P==null?void 0:P.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in L&&L.signIn){const z=await L.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},P==null?void 0:P.signInWithSolana),{version:"1",domain:H.host,uri:H.href}),D?{statement:D}:null));let U;if(Array.isArray(z)&&z[0]&&typeof z[0]=="object")U=z[0];else if(z&&typeof z=="object"&&"signedMessage"in z&&"signature"in z)U=z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in U&&"signature"in U&&(typeof U.signedMessage=="string"||U.signedMessage instanceof Uint8Array)&&U.signature instanceof Uint8Array)A=typeof U.signedMessage=="string"?U.signedMessage:new TextDecoder().decode(U.signedMessage),E=U.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in L)||typeof L.signMessage!="function"||!("publicKey"in L)||typeof L!="object"||!L.publicKey||!("toBase58"in L.publicKey)||typeof L.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");A=[`${H.host} wants you to sign in with your Solana account:`,L.publicKey.toBase58(),...D?["",D,""]:[""],"Version: 1",`URI: ${H.href}`,`Issued At: ${(i=(n=P==null?void 0:P.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=P==null?void 0:P.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${P.signInWithSolana.notBefore}`]:[],...!((l=P==null?void 0:P.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${P.signInWithSolana.expirationTime}`]:[],...!((c=P==null?void 0:P.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${P.signInWithSolana.chainId}`]:[],...!((d=P==null?void 0:P.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${P.signInWithSolana.nonce}`]:[],...!((h=P==null?void 0:P.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${P.signInWithSolana.requestId}`]:[],...!((v=(p=P==null?void 0:P.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||v===void 0)&&v.length?["Resources",...P.signInWithSolana.resources.map(U=>`- ${U}`)]:[]].join(`
`);const z=await L.signMessage(new TextEncoder().encode(A),"utf8");if(!z||!(z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");E=z}}try{const{data:N,error:R}=await De(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:A,signature:al(E)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(S=e.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:gi});if(R)throw R;if(!N||!N.session||!N.user){const D=new lu;return this._returnResult({data:{user:null,session:null},error:D})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:R})}catch(N){if(Ee(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async _exchangeCodeForSession(e){const t=await Xo(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(t??"").split("/");try{if(!n&&this.flowType==="pkce")throw new dL;const{data:a,error:l}=await De(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:gi});if(await _n(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!a||!a.session||!a.user){const c=new lu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:l})}catch(a){if(await _n(this.storage,`${this.storageKey}-code-verifier`),Ee(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:n,token:i,access_token:a,nonce:l}=e,c=await De(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:l,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:gi}),{data:d,error:h}=c;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!d||!d.session||!d.user){const p=new lu;return this._returnResult({data:{user:null,session:null},error:p})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:h})}catch(t){if(Ee(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,n,i,a,l;try{if("email"in e){const{email:c,options:d}=e;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await cu(this.storage,this.storageKey));const{error:v}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},create_user:(n=d==null?void 0:d.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:p},redirectTo:d==null?void 0:d.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in e){const{phone:c,options:d}=e,{data:h,error:p}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(i=d==null?void 0:d.data)!==null&&i!==void 0?i:{},create_user:(a=d==null?void 0:d.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:p})}throw new xg("You must provide either an email or phone number.")}catch(c){if(await _n(this.storage,`${this.storageKey}-code-verifier`),Ee(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var t,n;try{let i,a;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:c}=await De(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:gi});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,h=l.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(i){if(Ee(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(e){var t,n,i,a,l;try{let c=null,d=null;this.flowType==="pkce"&&([c,d]=await cu(this.storage,this.storageKey));const h=await De(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:OL});return!((a=h.data)===null||a===void 0)&&a.url&&xn()&&!(!((l=e.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(c){if(await _n(this.storage,`${this.storageKey}-code-verifier`),Ee(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new ws;const{error:i}=await De(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(e){if(Ee(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:a}=e,{error:l}=await De(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in e){const{phone:n,type:i,options:a}=e,{data:l,error:c}=await De(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c})}throw new xg("You must provide either an email or phone number and a type")}catch(t){if(Ee(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Xo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Hb:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const l=await Xo(this.userStorage,this.storageKey+"-user");l!=null&&l.user?e.user=l.user:e.user=qb()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};e.user=IL(e.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Va}):await this._useSession(async t=>{var n,i,a;const{data:l,error:c}=t;if(c)throw c;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ws}:await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:Va})})}catch(t){if(Ee(t))return cL(t)&&(await this._removeSession(),await _n(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:i,error:a}=n;if(a)throw a;if(!i.session)throw new ws;const l=i.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await cu(this.storage,this.storageKey));const{data:h,error:p}=await De(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:Va});if(p)throw p;return l.user=h.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await _n(this.storage,`${this.storageKey}-code-verifier`),Ee(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ws;const t=Date.now()/1e3;let n=t,i=!0,a=null;const{payload:l}=Gb(e.access_token);if(l.exp&&(n=l.exp,i=n<=t),i){const{data:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c)return{data:{user:null,session:null},error:null};a=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;a={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(Ee(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:l,error:c}=t;if(c)throw c;e=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new ws;const{data:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(Ee(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!xn())throw new wg("No browser detected.");if(e.error||e.error_description||e.error_code)throw new wg(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new aT("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wg("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new aT("No code detected.");const{data:D,error:P}=await this._exchangeCodeForSession(e.code);if(P)throw P;const L=new URL(window.location.href);return L.searchParams.delete("code"),window.history.replaceState(window.history.state,"",L.toString()),{data:{session:D.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:l,expires_in:c,expires_at:d,token_type:h}=e;if(!a||!c||!l||!h)throw new wg("No session defined in URL");const p=Math.round(Date.now()/1e3),v=parseInt(c);let x=p+v;d&&(x=parseInt(d));const S=x-p;S*1e3<=fu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${v}s`);const A=x-v;p-A>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",A,x,p):p-A<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",A,x,p);const{data:E,error:N}=await this._getUser(a);if(N)throw N;const R={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:v,expires_at:x,refresh_token:l,token_type:h,user:E.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:R,redirectType:e.type},error:null})}catch(n){if(Ee(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Xo(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:i,error:a}=t;if(a)return this._returnResult({error:a});const l=(n=i.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(lL(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await _n(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=vL(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,i;try{const{data:{session:a},error:l}=t;if(l)throw l;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await cu(this.storage,this.storageKey,!0));try{return await De(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(await _n(this.storage,`${this.storageKey}-code-verifier`),Ee(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:i}=await this._useSession(async a=>{var l,c,d,h,p;const{data:v,error:x}=a;if(x)throw x;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await De(this.fetch,"GET",S,{headers:this.headers,jwt:(p=(h=v.session)===null||h===void 0?void 0:h.access_token)!==null&&p!==void 0?p:void 0})});if(i)throw i;return xn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:e.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Ee(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:i,data:{session:a}}=t;if(i)throw i;const{options:l,provider:c,token:d,access_token:h,nonce:p}=e,v=await De(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:c,id_token:d,access_token:h,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:gi}),{data:x,error:S}=v;return S?this._returnResult({data:{user:null,session:null},error:S}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new lu}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:S}))}catch(i){if(await _n(this.storage,`${this.storageKey}-code-verifier`),Ee(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,i;const{data:a,error:l}=t;if(l)throw l;return await De(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await wL(async i=>(i>0&&await xL(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await De(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:gi})),(i,a)=>{const l=200*Math.pow(2,i);return a&&Bb(a)&&Date.now()+l-n<fu})}catch(n){if(this._debug(t,"error",n),Ee(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),xn()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Xo(this.storage,this.storageKey);if(i&&this.userStorage){let l=await Xo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:i.user},await pu(this.userStorage,this.storageKey+"-user",l)),i.user=(e=l==null?void 0:l.user)!==null&&e!==void 0?e:qb()}else if(i&&!i.user&&!i.user){const l=await Xo(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(i.user=l.user,await _n(this.storage,this.storageKey+"-user"),await pu(this.storage,this.storageKey,i)):i.user=qb()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const a=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Hb;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${Hb}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:l}=await this._callRefreshToken(i.refresh_token);l&&(console.error(l),Bb(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:c}=await this._getUser(i.access_token);!c&&(l!=null&&l.user)?(i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new ws;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Z0;const{data:a,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!a.session)throw new ws;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const c={data:a.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(a){if(this._debug(i,"error",a),Ee(a)){const l={data:null,error:a};return Bb(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(d){a.push(d)}});if(await Promise.all(l),a.length>0){for(let c=0;c<a.length;c+=1)console.error(a[c]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await _n(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await pu(this.userStorage,this.storageKey+"-user",{user:t.user});const i=Object.assign({},t);delete i.user;const a=dT(i);await pu(this.storage,this.storageKey,a)}else{const i=dT(t);await pu(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await _n(this.storage,this.storageKey),await _n(this.storage,this.storageKey+"-code-verifier"),await _n(this.storage,this.storageKey+"-user"),this.userStorage&&await _n(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&xn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),fu);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/fu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${fu}ms, refresh threshold is ${f_} ticks`),i<=f_&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof BN)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const i=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,l]=await cu(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});i.push(c.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:i,error:a}=t;return a?this._returnResult({data:null,error:a}):await De(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,i;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:d,error:h}=await De(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return h?this._returnResult({data:null,error:h}):(e.factorType==="totp"&&d.type==="totp"&&(!((i=d==null?void 0:d.totp)===null||i===void 0)&&i.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:a}=t;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?QL(e.webauthn.credential_response):ZL(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:d}=await De(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:d}))})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:a}=t;if(a)return this._returnResult({data:null,error:a});const l=await De(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:c}=l;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:XL(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:WL(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])i.all.push(a),a.status==="verified"&&i[a.factor_type].push(a);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Gb(n.access_token);let l=null;a.aal&&(l=a.aal);let c=l;((t=(e=n.user.factors)===null||e===void 0?void 0:e.filter(p=>p.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(c="aal2");const h=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;return i?this._returnResult({data:null,error:i}):n?await De(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ws})})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new ws});const l=await De(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&xn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Ee(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new ws});const l=await De(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&xn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(Ee(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;return n?this._returnResult({data:null,error:n}):t?await De(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new ws})})}catch(e){if(Ee(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;return i?this._returnResult({data:null,error:i}):n?(await De(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ws})})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(c=>c.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(c=>c.kid===e),n&&this.jwks_cached_at+aL>i)return n;const{data:a,error:l}=await De(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,n=a.keys.find(c=>c.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:S,error:A}=await this.getSession();if(A||!S.session)return this._returnResult({data:null,error:A});n=S.session.access_token}const{header:i,payload:a,signature:l,raw:{header:c,payload:d}}=Gb(n);t!=null&&t.allowExpired||RL(a.exp);const h=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!h){const{error:S}=await this.getUser(n);if(S)throw S;return{data:{claims:a,header:i,signature:l},error:null}}const p=kL(i.alg),v=await crypto.subtle.importKey("jwk",h,p,!0,["verify"]);if(!await crypto.subtle.verify(p,v,l,gL(`${c}.${d}`)))throw new g_("Invalid JWT signature");return{data:{claims:a,header:i,signature:l},error:null}}catch(n){if(Ee(n))return this._returnResult({data:null,error:n});throw n}}}_f.nextInstanceID={};class lO extends _f{constructor(e){super(e)}}var cO=function(s,e,t,n){function i(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(p){try{h(n.next(p))}catch(v){l(v)}}function d(p){try{h(n.throw(p))}catch(v){l(v)}}function h(p){p.done?a(p.value):i(p.value).then(c,d)}h((n=n.apply(s,e||[])).next())})};const uO={headers:JP},dO={schema:"public"},hO={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},fO={};class pO{constructor(e,t,n){var i,a,l,c,d,h,p,v;if(this.supabaseUrl=e,this.supabaseKey=t,this.from=N=>this.rest.from(N),this.schema=N=>this.rest.schema(N),this.rpc=(N,R={},D)=>this.rest.rpc(N,R,D),!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const x=eL(e);this.realtimeUrl=`${x}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${x}/auth/v1`,this.storageUrl=`${x}/storage/v1`,this.functionsUrl=`${x}/functions/v1`;const S=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,A={db:dO,realtime:fO,auth:Object.assign(Object.assign({},hO),{storageKey:S}),global:uO},E=tL(n??{},A);this.storageKey=(a=(i=E.auth)===null||i===void 0?void 0:i.storageKey)!==null&&a!==void 0?a:"",this.headers=(c=(l=E.global)===null||l===void 0?void 0:l.headers)!==null&&c!==void 0?c:{},this.auth=this._initSupabaseAuthClient((d=E.auth)!==null&&d!==void 0?d:{},this.headers,(h=E.global)===null||h===void 0?void 0:h.fetch),this.fetch=ZP(t,this._getAccessToken.bind(this),(p=E.global)===null||p===void 0?void 0:p.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},E.realtime)),this.rest=new XD(`${x}/rest/v1`,{headers:this.headers,schema:(v=E.db)===null||v===void 0?void 0:v.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new zD(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new YP(this.storageUrl,this.headers,this.fetch)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return cO(this,void 0,void 0,function*(){const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,storageKey:a,flowType:l,debug:c},d,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lO({url:this.authUrl,headers:Object.assign(Object.assign({},p),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,flowType:l,debug:c,fetch:h})}_initRealtimeClient(e){return new fP(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.realtime.setAuth(n??null),this.changedAccessToken=n):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const mO=(s,e,t)=>new pO(s,e,t),gO="https://dnwczvokxloyzjnqqfbd.supabase.co",yO="sb_publishable_evp59khbQk9e0LE6YnjzxQ_4ByKuJaq",Nt=mO(gO,yO);var xe=(s=>(s.HOME="HOME",s.PROCESSING="PROCESSING",s.QUIZ="QUIZ",s.RESULT="RESULT",s.ERROR="ERROR",s.SERVICES="SERVICES",s.PROFILE="PROFILE",s.DEVAI="DEVAI",s.ABOUT="ABOUT",s))(xe||{});const xt=({children:s,variant:e="primary",fullWidth:t=!1,className:n="",...i})=>{const a="px-6 py-3.5 rounded-xl font-bold transition-all duration-300 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 relative overflow-hidden",l={primary:"bg-gradient-to-r from-violet-600 via-purple-600 to-fuchsia-600 text-white shadow-[0_0_20px_rgba(139,92,246,0.3)] hover:shadow-[0_0_30px_rgba(139,92,246,0.5)] border border-white/10",secondary:"bg-white/5 hover:bg-white/10 text-white border border-white/10 hover:border-white/20 backdrop-blur-md",outline:"bg-transparent border border-white/20 text-slate-300 hover:text-white hover:border-violet-500 hover:shadow-[0_0_15px_rgba(139,92,246,0.2)]",danger:"bg-red-500/10 text-red-400 hover:bg-red-500/20 border border-red-500/20"};return b.jsx("button",{className:`${a} ${l[e]} ${t?"w-full":""} ${n}`,...i,children:b.jsx("span",{className:"relative z-10 flex items-center gap-2",children:s})})};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vO=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),bO=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),vT=s=>{const e=bO(s);return e.charAt(0).toUpperCase()+e.slice(1)},VN=(...s)=>s.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),_O=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var xO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wO=ae.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:l,...c},d)=>ae.createElement("svg",{ref:d,...xO,width:e,height:e,stroke:s,strokeWidth:n?Number(t)*24/Number(e):t,className:VN("lucide",i),...!a&&!_O(c)&&{"aria-hidden":"true"},...c},[...l.map(([h,p])=>ae.createElement(h,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=(s,e)=>{const t=ae.forwardRef(({className:n,...i},a)=>ae.createElement(wO,{ref:a,iconNode:e,className:VN(`lucide-${vO(vT(s))}`,`lucide-${s}`,n),...i}));return t.displayName=vT(s),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SO=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],AO=fe("arrow-left",SO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EO=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Dg=fe("arrow-right",EO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TO=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],CO=fe("arrow-up-down",TO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NO=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],RO=fe("award",NO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kO=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],m0=fe("book-open",kO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MO=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],rw=fe("brain-circuit",MO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IO=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],DO=fe("briefcase",IO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PO=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],y_=fe("building-2",PO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LO=[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h.01",key:"1bh4kh"}],["path",{d:"M12 4h.01",key:"1ujb9j"}],["path",{d:"M17 4h.01",key:"1upcoc"}]],$N=fe("cake",LO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],YN=fe("calculator",OO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UO=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],FO=fe("calendar-days",UO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zO=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],bT=fe("calendar",zO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jO=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],HO=fe("chart-column",jO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BO=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],xf=fe("chevron-left",BO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GO=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],_T=fe("chevron-right",GO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],KN=fe("circle-alert",qO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],g0=fe("circle-check",VO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $O=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],YO=fe("circle-plus",$O);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],JN=fe("circle-question-mark",KO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JO=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],aw=fe("circle-user-round",JO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],WO=fe("circle-x",XO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QO=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],XN=fe("clock",QO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZO=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],WN=fe("cloud-upload",ZO);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eU=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],QN=fe("code-xml",eU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tU=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],v_=fe("cpu",tU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nU=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],ZN=fe("crown",nU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sU=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],xT=fe("database",sU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iU=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],rU=fe("facebook",iU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aU=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],eR=fe("file-text",aU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oU=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],lU=fe("folder-open",oU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cU=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],uU=fe("folder",cU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dU=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],ey=fe("graduation-cap",dU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hU=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],fU=fe("history",hU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pU=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],ty=fe("house",pU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],gU=fe("info",mU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yU=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],vU=fe("layers",yU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bU=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],b_=fe("library",bU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _U=[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]],xU=fe("list-filter",_U);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wU=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ua=fe("loader-circle",wU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SU=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],AU=fe("lock",SU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EU=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],TU=fe("log-in",EU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CU=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],tR=fe("log-out",CU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NU=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],RU=fe("mail",NU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kU=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],MU=fe("map-pin",kU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IU=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],nR=fe("medal",IU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DU=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],PU=fe("menu",DU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LU=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],__=fe("message-circle",LU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OU=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],sR=fe("monitor",OU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UU=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],FU=fe("palette",UU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zU=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],jU=fe("panels-top-left",zU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HU=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],BU=fe("pen",HU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GU=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],qU=fe("percent",GU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VU=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],iR=fe("plus",VU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $U=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],YU=fe("puzzle",$U);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KU=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],JU=fe("refresh-cw",KU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XU=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],wT=fe("repeat",XU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WU=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],QU=fe("rocket",WU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZU=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],rR=fe("save",ZU);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e5=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],t5=fe("send",e5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],x_=fe("shield-alert",n5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s5=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],i5=fe("shield-check",s5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r5=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],aR=fe("smartphone",r5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a5=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Wp=fe("sparkles",a5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o5=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ow=fe("star",o5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],mu=fe("trash-2",l5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],oR=fe("triangle-alert",c5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u5=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],y0=fe("trophy",u5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d5=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],lR=fe("type",d5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],f5=fe("user-plus",h5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p5=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],m5=fe("user-round",p5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g5=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],y5=fe("user",g5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],cR=fe("users",v5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b5=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ny=fe("x",b5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _5=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],jd=fe("zap",_5),x5=({isOpen:s,onClose:e,onSuccess:t})=>{const[n,i]=ae.useState("LOGIN"),[a,l]=ae.useState(""),[c,d]=ae.useState(""),[h,p]=ae.useState(""),[v,x]=ae.useState(!1),[S,A]=ae.useState(""),[E,N]=ae.useState(!1),[R,D]=ae.useState(!1),[P,L]=ae.useState(!1);if(!s)return null;const H=()=>{e(),setTimeout(()=>{i("LOGIN"),l(""),d(""),p(""),A(""),N(!1),x(!1),D(!1),L(!1)},300)},z=async J=>{if(J.preventDefault(),n!=="LOGIN"&&!R){A("     ");return}x(!0),A("");try{let K=null;if(n==="GUEST"){if(!h.trim())throw new Error("  ");const ie=h.trim()==="2001",oe=ie?"":h,ne={id:ie?"admin-yazan-2001":"guest-"+Date.now(),email:ie?"admin@idraak.ai":"guest@local",user_metadata:{full_name:oe,role:ie?"admin":"student",avatar:ie?"Joshua":"Felix"},app_metadata:{provider:"guest"},aud:"authenticated",created_at:new Date().toISOString()};localStorage.setItem("guest_user",JSON.stringify(ne)),K=ne}else if(n==="LOGIN"){const ie=await Nt.auth.signInWithPassword({email:a,password:c});if(ie.error)throw ie.error;K=ie.data.user}else{if(!h.trim())throw new Error("   ");const ie=await Nt.auth.signUp({email:a,password:c,options:{data:{full_name:h}}});if(ie.error)throw ie.error;K=ie.data.user}K&&(N(!0),setTimeout(()=>{t(K),H()},1500))}catch(K){A(K.message||"   "),x(!1)}},U=()=>b.jsxs("div",{className:"absolute inset-0 bg-[#050505] z-50 p-8 flex flex-col",children:[b.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[b.jsx("button",{onClick:()=>L(!1),className:"p-2 bg-white/5 rounded-full text-slate-400 hover:text-white transition-colors",children:b.jsx(AO,{size:18})}),b.jsx("h3",{className:"text-xl font-black text-white",children:" "})]}),b.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 text-slate-400 text-sm leading-relaxed space-y-4 text-right",dir:"rtl",children:[b.jsx("p",{className:"font-bold text-white text-lg",children:"   ."}),b.jsx("p",{children:"1.            ."}),b.jsx("p",{children:"2.   PDF                     ."}),b.jsx("p",{children:"3.        .             ."}),b.jsx("p",{children:"4.    Google Gemini         ."}),b.jsx("p",{children:"5.        ."})]}),b.jsx(xt,{onClick:()=>L(!1),className:"mt-6 shadow-lg shadow-emerald-500/10",children:" "})]});return b.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[b.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>!E&&H()}),b.jsxs("div",{className:"glass-panel w-full max-w-md bg-[#050505] rounded-[2.5rem] p-8 relative border border-white/10 shadow-[0_0_50px_rgba(139,92,246,0.15)] min-h-[580px] flex flex-col justify-center overflow-hidden",children:[P&&U(),E?b.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-10",children:[b.jsx("div",{className:"w-24 h-24 bg-emerald-500/10 rounded-full flex items-center justify-center mb-6 border border-emerald-500/20 shadow-[0_0_30px_rgba(16,185,129,0.2)]",children:b.jsx(g0,{className:"text-emerald-400 w-12 h-12"})}),b.jsx("h2",{className:"text-3xl font-black text-white mb-2 tracking-tight",children:" !"}),b.jsx("p",{className:"text-emerald-400 font-bold text-lg",children:"   "}),b.jsx("div",{className:"mt-8",children:b.jsx(ua,{className:"animate-spin text-slate-600"})})]}):b.jsxs(b.Fragment,{children:[b.jsx("button",{onClick:H,className:"absolute top-6 left-6 p-2 text-slate-500 hover:text-white hover:bg-white/10 rounded-full z-10 transition-all",children:b.jsx(ny,{size:20})}),b.jsxs("div",{className:"text-center mb-8",children:[b.jsxs("div",{className:"w-16 h-16 bg-violet-500/10 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-violet-500/20 shadow-inner",children:[n==="LOGIN"&&b.jsx(TU,{className:"text-violet-400",size:32}),n==="SIGNUP"&&b.jsx(f5,{className:"text-violet-400",size:32}),n==="GUEST"&&b.jsx(aw,{className:"text-violet-400",size:32})]}),b.jsx("h2",{className:"text-2xl font-black text-white mb-2 tracking-tight",children:n==="LOGIN"?" ":n==="SIGNUP"?"  ":" "}),b.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"    "})]}),b.jsxs("div",{className:"flex p-1 bg-white/5 rounded-2xl mb-8 relative z-10 border border-white/5 shadow-inner",children:[b.jsx("button",{onClick:()=>{i("LOGIN"),A("")},className:`flex-1 py-3 text-sm font-black rounded-xl transition-all ${n==="LOGIN"||n==="SIGNUP"?"bg-violet-600 text-white shadow-lg shadow-violet-600/20":"text-slate-500 hover:text-white"}`,children:""}),b.jsx("button",{onClick:()=>{i("GUEST"),A("")},className:`flex-1 py-3 text-sm font-black rounded-xl transition-all ${n==="GUEST"?"bg-violet-600 text-white shadow-lg shadow-violet-600/20":"text-slate-500 hover:text-white"}`,children:""})]}),S&&b.jsxs("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-2xl flex items-start gap-3 animate-lux-up",children:[b.jsx(KN,{className:"text-red-400 shrink-0 mt-0.5",size:18}),b.jsx("p",{className:"text-red-300 text-sm font-bold leading-tight",children:S})]}),b.jsxs("form",{onSubmit:z,className:"space-y-5 flex-1 flex flex-col",children:[n==="GUEST"&&b.jsxs("div",{className:"bg-amber-500/5 border border-amber-500/10 p-4 rounded-2xl mb-2 flex items-start gap-3 text-right",children:[b.jsx(x_,{size:20,className:"text-amber-500 shrink-0 mt-0.5"}),b.jsxs("p",{className:"text-amber-200/80 text-[11px] leading-relaxed font-medium",children:[b.jsx("span",{className:"font-black text-amber-300 block mb-0.5",children:" :"}),"         .     ."]})]}),(n==="SIGNUP"||n==="GUEST")&&b.jsxs("div",{className:"space-y-2",children:[b.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:n==="GUEST"?"   ":" "}),b.jsxs("div",{className:"relative",children:[b.jsx(y5,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),b.jsx("input",{type:"text",required:!0,value:h,onChange:J=>p(J.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:n==="GUEST"?"   ":" "})]})]}),n!=="GUEST"&&b.jsxs(b.Fragment,{children:[b.jsxs("div",{className:"space-y-2",children:[b.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:" "}),b.jsxs("div",{className:"relative",children:[b.jsx(RU,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),b.jsx("input",{type:"email",required:!0,value:a,onChange:J=>l(J.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:"name@example.com"})]})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:" "}),b.jsxs("div",{className:"relative",children:[b.jsx(AU,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),b.jsx("input",{type:"password",required:!0,minLength:6,value:c,onChange:J=>d(J.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:""})]})]})]}),n!=="LOGIN"&&b.jsxs("div",{className:"flex items-start gap-3 mt-2 py-2 px-1",children:[b.jsx("input",{type:"checkbox",checked:R,onChange:J=>D(J.target.checked),className:"mt-1 w-5 h-5 rounded-lg border-white/10 accent-emerald-500 cursor-pointer transition-all"}),b.jsxs("label",{className:"text-xs text-slate-500 font-bold text-right leading-relaxed select-none",children:["  ",b.jsx("button",{type:"button",onClick:()=>L(!0),className:"text-emerald-400 underline hover:text-emerald-300 transition-colors",children:"   "}),"   ."]})]}),b.jsxs("div",{className:"mt-auto pt-4",children:[b.jsx(xt,{type:"submit",fullWidth:!0,disabled:v,className:"py-4 shadow-xl",children:v?b.jsxs("span",{className:"animate-pulse flex items-center gap-2",children:[b.jsx(ua,{className:"animate-spin",size:18}),"  ..."]}):n==="LOGIN"?"":" "}),n==="LOGIN"&&b.jsx("button",{type:"button",onClick:()=>{i("SIGNUP"),A("")},className:"w-full text-center mt-6 text-emerald-400 hover:text-emerald-300 transition-all font-black text-lg md:text-xl underline decoration-emerald-800 underline-offset-8 decoration-2",children:"      "}),n==="SIGNUP"&&b.jsx("button",{type:"button",onClick:()=>{i("LOGIN"),A("")},className:"w-full text-center mt-6 text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"      "}),n==="GUEST"&&b.jsx("button",{type:"button",onClick:()=>{i("SIGNUP"),A("")},className:"w-full text-center mt-6 text-xs font-bold text-slate-500 hover:text-emerald-400 transition-colors",children:"      "})]})]})]})]})]})};var w5=wN();const S5=()=>{const[s,e]=ae.useState([]),[t,n]=ae.useState(!0),[i,a]=ae.useState(null),[l,c]=ae.useState(null);ae.useEffect(()=>{d();let S;try{S=Nt.channel("leaderboard-realtime").on("postgres_changes",{event:"*",schema:"public",table:"quiz_history"},()=>{d()}).subscribe()}catch{console.warn("Realtime subscription failed, falling back to manual fetch only.")}return()=>{S&&Nt.removeChannel(S)}},[]);const d=async()=>{try{c(null);const{data:S,error:A}=await Nt.from("quiz_history").select("*").order("created_at",{ascending:!1});if(A)throw A;if(!S){e([]);return}const E=new Map;S.forEach(R=>{const D=(R.score||0)*10,P=R.score||0,L=R.total_questions||10,H=R.player_name||" ",z=R.player_avatar||"Felix",U=R.player_university,J=R.player_major,K=R.player_age;if(E.has(R.user_id)){const ie=E.get(R.user_id);E.set(R.user_id,{...ie,exp:ie.exp+D,quizCount:ie.quizCount+1,rawScoreSum:ie.rawScoreSum+P,maxScoreSum:ie.maxScoreSum+L})}else E.set(R.user_id,{name:H,avatar:z,exp:D,quizCount:1,rawScoreSum:P,maxScoreSum:L,university:U,major:J,age:K})});const N=Array.from(E.entries()).map(([R,D])=>{const P=D.maxScoreSum>0?Math.round(D.rawScoreSum/D.maxScoreSum*100):0;return{userId:R,name:D.name,avatar:D.avatar,totalExp:D.exp,totalQuizzes:D.quizCount,averageScore:P,university:D.university,major:D.major,age:D.age,rank:0}}).sort((R,D)=>D.totalExp-R.totalExp).slice(0,10).map((R,D)=>({...R,rank:D+1}));e(N)}catch(S){console.error("Leaderboard fetch error:",S),c(S.message==="Failed to fetch"?"  .     .":"     .")}finally{n(!1)}},h=S=>{switch(S){case 1:return"bg-gradient-to-r from-black via-[#0a0a0a] to-[#453a15] border-[#d4af37]/20 shadow-[0_0_20px_rgba(0,0,0,0.5)]";case 2:return"bg-gradient-to-r from-[#0a0a0a] via-[#150a1c] to-[#420a15] border-[#c31432]/20 shadow-lg";case 3:return"bg-gradient-to-r from-[#030712] via-[#051125] to-[#3a3324] border-[#a89166]/20 shadow-lg";default:return"bg-gradient-to-r from-[#18181b] via-[#27272a] to-[#3f3f46] border-white/5 opacity-80 hover:opacity-100 transition-opacity"}},p=S=>["  "," "," "," "," ","  "," "," "," "," "][S-1]||" ",v=S=>["   !    ."," !      .","   !    .","     .  !"," !      .","  !      .","   .   !","    .    .","     .  !","   .    !"][S-1]||"    !",x=S=>S===1?b.jsx(ZN,{size:28,className:"text-yellow-400/80 drop-shadow-[0_0_8px_rgba(250,204,21,0.6)] animate-bounce"}):S===2?b.jsx(ow,{size:24,className:"text-fuchsia-400/80 drop-shadow-[0_0_6px_rgba(192,38,211,0.5)]"}):S===3?b.jsx(nR,{size:24,className:"text-amber-500/80 drop-shadow-[0_0_6px_rgba(245,158,11,0.5)]"}):b.jsxs("span",{className:`text-lg font-black font-mono ${S<=5?"text-white/80":"text-slate-600"}`,children:["#",S]});return b.jsxs("div",{className:"w-full max-w-4xl mx-auto mt-2 mb-10 px-4",children:[b.jsxs("div",{className:"text-center mb-10 animate-lux-up",children:[b.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-2xl bg-gradient-to-br from-yellow-500/10 to-amber-600/10 text-yellow-500/70 mb-4 border border-yellow-500/20 shadow-[0_0_20px_rgba(234,179,8,0.1)]",children:b.jsx(y0,{size:32})}),b.jsx("h2",{className:"text-3xl md:text-4xl font-black text-white mb-3",children:" "})]}),t?b.jsx("div",{className:"flex justify-center py-10",children:b.jsx(ua,{className:"animate-spin text-violet-500/50",size:32})}):l?b.jsxs("div",{className:"text-center py-8 bg-red-500/5 border border-red-500/10 rounded-3xl",children:[b.jsx("p",{className:"text-red-400 font-bold mb-4",children:l}),b.jsxs("button",{onClick:()=>{n(!0),d()},className:"flex items-center gap-2 mx-auto text-xs font-black text-slate-400 hover:text-white uppercase tracking-widest bg-white/5 px-4 py-2 rounded-xl transition-all",children:[b.jsx(JU,{size:14}),"  "]})]}):b.jsx("div",{className:"grid gap-4",children:s.map((S,A)=>b.jsxs("div",{onClick:()=>a(S),className:`relative flex items-center justify-between p-4 md:p-5 rounded-[1.8rem] md:rounded-[2.2rem] border transition-all duration-700 group hover:scale-[1.01] cursor-pointer ${h(S.rank)} animate-lux-up`,style:{animationDelay:`${A*.08}s`},children:[b.jsxs("div",{className:"flex items-center gap-4 md:gap-8",children:[b.jsx("div",{className:"w-10 flex justify-center shrink-0",children:x(S.rank)}),b.jsx("div",{className:"relative",children:b.jsx("div",{className:`w-14 h-14 md:w-16 md:h-16 rounded-full border overflow-hidden bg-black/60 ${S.rank===1?"border-yellow-400/20 ring-4 ring-yellow-400/5":"border-white/5"}`,children:b.jsx("img",{src:`https://api.dicebear.com/9.x/notionists/svg?seed=${S.avatar||"default"}&backgroundColor=b6e3f4,c0aede,d1d4f9`,alt:S.name,className:"w-full h-full object-cover opacity-90"})})}),b.jsxs("div",{children:[b.jsx("h3",{className:`font-black text-base md:text-lg tracking-tight ${S.rank<=5?"text-white/90":"text-slate-400"}`,children:S.name}),b.jsx("p",{className:`text-[10px] font-black uppercase tracking-widest ${S.rank===1?"text-yellow-500/60":"text-slate-500"}`,children:p(S.rank)})]})]}),b.jsxs("div",{className:"flex flex-col items-end shrink-0",children:[b.jsxs("div",{className:"flex items-center gap-1.5",children:[b.jsx("span",{className:`text-xl md:text-2xl font-black font-mono leading-none ${S.rank===1?"text-yellow-500/80":"text-white/80"}`,children:S.totalExp}),b.jsx(rw,{size:14,className:"text-slate-600"})]}),b.jsx("span",{className:"text-[8px] font-black uppercase tracking-tighter text-slate-700",children:" "})]})]},S.userId))}),i&&w5.createPortal(b.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4",children:[b.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-3xl",onClick:()=>a(null)}),b.jsxs("div",{className:`glass-panel w-[90%] sm:w-full max-w-md rounded-[3rem] relative animate-lux-scale border border-white/10 shadow-[0_0_80px_rgba(0,0,0,1)] overflow-hidden ${h(i.rank)}`,children:[b.jsx("button",{onClick:()=>a(null),className:"absolute top-6 right-6 w-9 h-9 flex items-center justify-center bg-red-500/20 text-red-400 border border-red-500/30 hover:bg-red-500/30 hover:text-red-300 rounded-full transition-all z-20",children:b.jsx(ny,{size:22})}),b.jsx("div",{className:"p-8 md:p-10 flex flex-col items-center text-center relative z-10",children:(()=>{const S={1:"text-yellow-400",2:"text-fuchsia-400",3:"text-amber-500"},A=S[i.rank]||"text-white/80",E=S[i.rank]?S[i.rank].replace("400","300"):"text-white/70";return b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"w-32 h-32 rounded-full border-2 shadow-2xl mb-6 overflow-hidden bg-black/80",children:b.jsx("img",{src:`https://api.dicebear.com/9.x/notionists/svg?seed=${i.avatar||"default"}&backgroundColor=b6e3f4,c0aede,d1d4f9`,alt:i.name,className:"w-full h-full object-cover opacity-90"})}),b.jsx("h3",{className:"text-3xl font-black text-white/90 mb-1 tracking-tight",children:i.name}),b.jsx("p",{className:"text-sm font-black text-white/40 mb-8",children:p(i.rank)}),b.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full mb-8 text-center",children:[b.jsxs("div",{className:"bg-black/40 backdrop-blur-md rounded-[2rem] p-6 border border-white/5 flex flex-col items-center",children:[b.jsx("span",{className:`text-3xl font-black ${A}`,children:i.totalQuizzes}),b.jsx("span",{className:"text-[10px] text-white/30 font-bold uppercase tracking-widest",children:" "})]}),b.jsxs("div",{className:"bg-black/40 backdrop-blur-md rounded-[2rem] p-6 border border-white/5 flex flex-col items-center",children:[b.jsxs("span",{className:`text-3xl font-black ${A}`,children:[i.averageScore,"%"]}),b.jsx("span",{className:"text-[10px] text-white/30 font-bold uppercase tracking-widest",children:" "})]})]}),b.jsxs("div",{className:"w-full space-y-3 mb-8",children:[b.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[b.jsx(y_,{size:20,className:"text-slate-500 shrink-0"}),b.jsxs("div",{className:"text-right",children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),b.jsx("p",{className:`text-sm font-bold ${E}`,children:i.university||" "})]})]}),b.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[b.jsx(b_,{size:20,className:"text-slate-500 shrink-0"}),b.jsxs("div",{className:"text-right",children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),b.jsx("p",{className:`text-sm font-bold ${E}`,children:i.major||" "})]})]}),b.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[b.jsx($N,{size:20,className:"text-slate-500 shrink-0"}),b.jsxs("div",{className:"text-right",children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),b.jsx("p",{className:`text-sm font-bold ${E}`,children:i.age||" "})]})]})]}),b.jsx("div",{className:"w-full text-center px-4 py-4 rounded-2xl bg-black/20 border border-white/5",children:b.jsxs("p",{className:"text-xs italic text-slate-400",children:['"',v(i.rank),'"']})})]})})()})]})]}),document.body)]})},A5=()=>{const[s,e]=ae.useState({quizzes:0,students:125,loading:!0});ae.useEffect(()=>{(async()=>{try{const{count:a,error:l}=await Nt.from("quiz_history").select("*",{count:"exact",head:!0}),{data:c,error:d}=await Nt.from("quiz_history").select("user_id");if(l||d)throw new Error("Error fetching stats");const h=new Set(c==null?void 0:c.map(p=>p.user_id)).size;e({quizzes:a||0,students:125+h,loading:!1})}catch(a){console.error("Failed to fetch live stats:",a),e(l=>({...l,loading:!1}))}})()},[]);const t=[{label:"  ",value:s.loading?"...":`+${s.quizzes.toLocaleString()}`,icon:b.jsx(jd,{size:20}),color:"text-amber-400",bg:"bg-amber-500/10"},{label:" ",value:s.loading?"...":`+${s.students.toLocaleString()}`,icon:b.jsx(cR,{size:20}),color:"text-violet-400",bg:"bg-violet-500/10"},{label:" ",value:"99.2%",icon:b.jsx(i5,{size:20}),color:"text-emerald-400",bg:"bg-emerald-500/10"}],n=[{title:"  ",desc:"   Gemini        .",icon:b.jsx(Wp,{className:"text-violet-400"})},{title:"  ",desc:"   10   100      .",icon:b.jsx(m0,{className:"text-blue-400"})},{title:"  ",desc:"            .",icon:b.jsx(HO,{className:"text-fuchsia-400"})}];return b.jsxs("div",{className:"w-full max-w-5xl mx-auto mt-16 mb-24 px-4",children:[b.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-16",children:t.map((i,a)=>b.jsxs("div",{className:"glass-panel p-6 rounded-[2rem] border border-white/5 flex items-center gap-5 hover:border-white/10 transition-all animate-lux-up",style:{animationDelay:`${a*.1}s`},children:[b.jsx("div",{className:`w-12 h-12 rounded-2xl ${i.bg} ${i.color} flex items-center justify-center shrink-0`,children:s.loading&&a<2?b.jsx(ua,{size:18,className:"animate-spin"}):i.icon}),b.jsxs("div",{children:[b.jsx("p",{className:"text-2xl font-black text-white leading-none mb-1",children:i.value}),b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:i.label})]})]},a))}),b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"absolute inset-0 bg-violet-600/5 blur-[100px] rounded-full pointer-events-none"}),b.jsxs("div",{className:"text-center mb-12 animate-lux-up",children:[b.jsx("h2",{className:"text-3xl font-black text-white mb-3",children:"   "}),b.jsx("div",{className:"h-1 w-20 bg-gradient-to-r from-violet-600 to-fuchsia-600 mx-auto rounded-full"})]}),b.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 relative z-10",children:n.map((i,a)=>b.jsxs("div",{className:"group glass-panel p-8 rounded-[2.5rem] border border-white/5 hover:border-violet-500/30 transition-all animate-lux-up",style:{animationDelay:`${(a+3)*.1}s`},children:[b.jsx("div",{className:"w-14 h-14 rounded-2xl bg-white/5 flex items-center justify-center mb-6 group-hover:scale-110 group-hover:bg-violet-500/10 transition-all duration-500",children:Hd.cloneElement(i.icon,{size:28})}),b.jsx("h3",{className:"text-xl font-bold text-white mb-3 group-hover:text-violet-300 transition-colors",children:i.title}),b.jsx("p",{className:"text-sm text-slate-500 leading-relaxed font-medium",children:i.desc})]},a))})]}),b.jsx("div",{className:"mt-16 glass-panel p-1 border-white/5 rounded-[2rem] overflow-hidden animate-lux-up",style:{animationDelay:"0.8s"},children:b.jsxs("div",{className:"bg-gradient-to-r from-violet-900/20 via-black to-fuchsia-900/20 p-8 rounded-[1.9rem] flex flex-col items-center text-center",children:[b.jsx(ow,{className:"text-yellow-500/50 mb-4 animate-pulse",size:32,fill:"currentColor"}),b.jsx("p",{className:"text-xl md:text-2xl font-medium text-slate-300 italic leading-relaxed",children:'"      ."'}),b.jsx("p",{className:"mt-4 text-xs font-black text-violet-400 uppercase tracking-widest",children:"  "})]})})]})},E5=({onNavigate:s,onLogActivity:e})=>{const[t,n]=ae.useState("selection");ae.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[t]);const[i,a]=ae.useState(""),[l,c]=ae.useState(""),[d,h]=ae.useState(""),[p,v]=ae.useState(null),[x,S]=ae.useState(""),[A,E]=ae.useState("100to4"),[N,R]=ae.useState(null),[D,P]=ae.useState(""),[L,H]=ae.useState(""),[z,U]=ae.useState([{id:"1",grade:"",hours:"3",isRepeated:!1,isExcluded:!1},{id:"2",grade:"",hours:"3",isRepeated:!1,isExcluded:!1},{id:"3",grade:"",hours:"3",isRepeated:!1,isExcluded:!1},{id:"4",grade:"",hours:"3",isRepeated:!1,isExcluded:!1}]),[J,K]=ae.useState(null),ie=()=>{U([...z,{id:Date.now().toString(),grade:"",hours:"3",isRepeated:!1,isExcluded:!1}])},oe=ee=>{z.length>1&&U(z.filter(ue=>ue.id!==ee))},ne=(ee,ue)=>{U(z.map(O=>O.id===ee?{...O,...ue}:O))},ve=()=>{const ee=parseFloat(i),ue=parseFloat(l),O=parseFloat(d);if(isNaN(ee)||isNaN(ue)||isNaN(O)){v({type:"error",message:"    "});return}const $=ee*.45+ue*.1,se=(O-$)/.45;se<0?v({type:"error",message:"    "}):(v({type:"success",message:"   :",value:se.toFixed(2)}),e==null||e("  "))},de=()=>{const ee=parseFloat(x);if(isNaN(ee)){R(null);return}if(A==="100to4"){if(ee>100||ee<0){R({type:"error",message:"     0  100"});return}let ue="0.00",O="";ee>=97?(ue="4.00",O=" "):ee>=50&&(ue=(2.14+(ee-50)*.04).toFixed(2),ee>=90?O="":ee>=80?O=" ":ee>=70?O="":ee>=60?O="":O=""),R({type:"success",message:"  4.00 :",value:ue,label:O}),e==null||e("  (100  4)")}else{if(ee>4||ee<0){R({type:"error",message:"     0.00  4.00"});return}let ue="< 50",O="";if(ee>=4)ue="97",O=" ";else if(ee>=2.14){const $=Math.min(96,Math.round((ee-2.14)/.04+50));ue=$.toString(),$>=90?O="":$>=80?O=" ":$>=70?O="":$>=60?O="":O=""}R({type:"success",message:"  :",value:ue,label:O}),e==null||e("  (4  100)")}},Re=()=>{let ee=(parseFloat(D)||0)*(parseFloat(L)||0),ue=parseFloat(L)||0;z.forEach(O=>{const $=parseFloat(O.grade),se=parseFloat(O.hours),ce=parseFloat(O.oldGrade||"");isNaN($)||isNaN(se)||se<=0||O.isExcluded||$<60||(O.isRepeated?(!isNaN(ce)&&ce>=60&&(ee-=ce*se),ee+=$*se,(isNaN(ce)||ce<60)&&(ue+=se)):(ee+=$*se,ue+=se))}),K({gpa:ue>0?(ee/ue).toFixed(2):"0.00",hours:ue}),e==null||e("  ")},j=()=>{const ee=()=>{switch(t){case"final_calc":return"  ";case"gpa_calc":return" ";case"cumulative_gpa_100":return" ";default:return""}};return b.jsxs("div",{className:"flex items-center gap-2 mb-4 sm:mb-6 text-[10px] sm:text-xs font-bold text-slate-500 overflow-x-auto whitespace-nowrap py-2",dir:"rtl",children:[b.jsxs("button",{onClick:()=>s(xe.HOME),className:"flex items-center gap-1 hover:text-white transition-colors",children:[b.jsx(ty,{size:14})," "]}),b.jsx(xf,{size:12,className:"shrink-0 opacity-40"}),b.jsx("button",{onClick:()=>n("selection"),className:`hover:text-white transition-colors ${t==="selection"?"text-violet-400":""}`,children:" "}),t!=="selection"&&b.jsxs(b.Fragment,{children:[b.jsx(xf,{size:12,className:"shrink-0 opacity-40"}),b.jsx("span",{className:"text-white bg-violet-500/10 px-2 py-0.5 rounded-md border border-violet-500/20",children:ee()})]})]})},X=()=>b.jsxs("div",{className:"animate-fade-in space-y-10",children:[b.jsxs("div",{className:"text-center mb-12",children:[b.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-2xl bg-violet-500/10 text-violet-400 mb-6 border border-violet-500/20 shadow-xl",children:b.jsx(jd,{size:32})}),b.jsx("h2",{className:"text-3xl md:text-5xl font-black text-white mb-4 tracking-tight",children:"  "}),b.jsx("p",{className:"text-slate-500 text-sm max-w-xl mx-auto font-medium",children:"        ."})]}),b.jsx("div",{className:"max-w-5xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[{id:"final_calc",title:"  ",desc:"    .",icon:b.jsx(YN,{}),color:"violet",view:"final_calc"},{id:"gpa_calc",title:"  ",desc:"   100%  4.0.",icon:b.jsx(CO,{}),color:"emerald",view:"gpa_calc"},{id:"cumulative_gpa_100",title:"  ",desc:"    .",icon:b.jsx(qU,{}),color:"blue",view:"cumulative_gpa_100"}].map(ee=>b.jsxs("div",{onClick:()=>n(ee.view),className:"glass-panel group p-6 rounded-[2rem] bg-[#080808] border border-white/5 hover:border-white/20 cursor-pointer transition-all flex flex-col items-center text-center h-full",children:[b.jsx("div",{className:`w-12 h-12 bg-${ee.color}-500/10 rounded-xl flex items-center justify-center text-${ee.color}-400 mb-4 group-hover:scale-110 transition-transform`,children:Hd.cloneElement(ee.icon,{size:24})}),b.jsx("h3",{className:"text-sm font-bold text-white mb-2 leading-tight px-2",children:ee.title}),b.jsx("p",{className:"text-slate-500 text-[10px] leading-relaxed mb-5",children:ee.desc}),b.jsxs("div",{className:"mt-auto w-full flex items-center justify-center gap-2 py-2.5 rounded-xl bg-white/5 group-hover:bg-white/10 transition-all text-[10px] font-black uppercase tracking-widest text-slate-400",children:["  ",b.jsx(Dg,{size:14})]})]},ee.id))})]}),me=()=>b.jsxs("div",{className:"animate-fade-in space-y-6",children:[b.jsx("div",{className:"flex items-center justify-between mb-4",children:b.jsx("div",{className:"text-[9px] font-black text-blue-400 uppercase tracking-[0.2em] bg-blue-500/5 px-3 py-1 rounded-full border border-blue-500/10",children:"   (100%)"})}),b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start text-right",children:[b.jsx("div",{className:"lg:col-span-7",children:b.jsxs("div",{className:"glass-panel p-6 rounded-[2.5rem] bg-[#080808] border border-white/10 shadow-2xl relative overflow-hidden space-y-8",children:[b.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-600 to-indigo-600"}),b.jsxs("div",{children:[b.jsxs("h3",{className:"text-base font-bold text-white mb-2 flex items-center gap-2 justify-end",children:["  ",b.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/10 text-blue-400 rounded-full",children:""})]}),b.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-black/20 p-4 rounded-2xl border border-white/5",children:[b.jsxs("div",{className:"space-y-1",children:[b.jsx("label",{className:"text-[10px] font-bold text-slate-400 mr-1 block",children:"  "}),b.jsx("input",{type:"number",step:"0.01",value:D,onChange:ee=>P(ee.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-xl py-3 px-4 text-white font-bold text-sm text-right focus:border-blue-500 outline-none",placeholder:"85.50"})]}),b.jsxs("div",{className:"space-y-1",children:[b.jsx("label",{className:"text-[10px] font-bold text-slate-400 mr-1 block",children:" "}),b.jsx("input",{type:"number",value:L,onChange:ee=>H(ee.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-xl py-3 px-4 text-white font-bold text-sm text-right focus:border-blue-500 outline-none",placeholder:"60"})]})]})]}),b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsx("button",{onClick:ie,className:"p-2 bg-blue-500/10 text-blue-400 rounded-lg border border-blue-500/20 hover:bg-blue-500/20",children:b.jsx(iR,{size:16})}),b.jsxs("h3",{className:"text-base font-bold text-white flex items-center gap-2",children:["   ",b.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/10 text-blue-400 rounded-full",children:""})]})]}),z.map(ee=>b.jsxs("div",{className:"p-4 rounded-2xl bg-white/[0.02] border border-white/5 space-y-4 transition-all",children:[b.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[b.jsxs("div",{className:"col-span-2",children:[b.jsx("label",{className:"text-[10px] font-bold text-amber-400 block mb-1 text-right",children:""}),b.jsxs("div",{className:"relative",children:[b.jsx(ey,{size:14,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500"}),b.jsx("input",{type:"number",value:ee.grade,onChange:ue=>ne(ee.id,{grade:ue.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-lg py-2.5 pr-9 text-white text-xs text-right",placeholder:" 100"})]})]}),b.jsxs("div",{className:"col-span-2",children:[b.jsx("label",{className:"text-[10px] font-bold text-amber-400 block mb-1 text-right",children:""}),b.jsxs("div",{className:"relative",children:[b.jsx(XN,{size:14,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500"}),b.jsx("input",{type:"number",value:ee.hours,onChange:ue=>ne(ee.id,{hours:ue.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-lg py-2.5 pr-9 text-white text-xs text-right",placeholder:"3"})]})]}),b.jsx("div",{className:"col-span-1 flex items-end",children:b.jsx("button",{onClick:()=>oe(ee.id),className:"w-full h-10 text-red-500/40 hover:text-red-500 flex justify-center items-center bg-black/40 border border-white/5 rounded-lg",children:b.jsx(mu,{size:16})})})]}),ee.isRepeated&&b.jsxs("div",{className:"pt-3 border-t border-white/10 animate-fade-in",children:[b.jsxs("label",{className:"text-[10px] font-bold text-amber-400 block mb-1 text-right flex items-center gap-1.5 justify-end",children:[b.jsx(wT,{size:12}),"  "]}),b.jsxs("div",{className:"relative",children:[b.jsx(wT,{size:14,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500"}),b.jsx("input",{type:"number",value:ee.oldGrade||"",onChange:ue=>ne(ee.id,{oldGrade:ue.target.value}),className:"w-full bg-black/40 border border-amber-500/20 rounded-lg py-2.5 pr-9 text-white text-xs text-right",placeholder:"  "})]})]}),b.jsxs("div",{className:"flex justify-end gap-4 pt-3 border-t border-white/5",children:[b.jsxs("label",{className:"flex items-center gap-2 text-[10px] text-slate-400 font-bold cursor-pointer",children:["  ",b.jsx("input",{type:"checkbox",checked:ee.isRepeated,onChange:ue=>ne(ee.id,{isRepeated:ue.target.checked,oldGrade:""}),className:"w-4 h-4 accent-amber-500"})]}),b.jsxs("label",{className:"flex items-center gap-2 text-[10px] text-slate-400 font-bold cursor-pointer",children:["   ",b.jsx("input",{type:"checkbox",checked:ee.isExcluded,onChange:ue=>ne(ee.id,{isExcluded:ue.target.checked}),className:"w-4 h-4 accent-slate-500"})]})]})]},ee.id))]}),b.jsx(xt,{onClick:Re,fullWidth:!0,className:"!bg-blue-600 hover:!bg-blue-500 shadow-xl shadow-blue-900/30 !py-4",children:" "}),J&&b.jsxs("div",{className:"p-6 rounded-3xl bg-emerald-500/5 border border-emerald-500/10 text-center animate-fade-in",children:[b.jsx("p",{className:"text-[10px] font-bold text-emerald-400/60 mb-1 uppercase tracking-widest",children:"  "}),b.jsx("p",{className:"text-5xl font-black text-white italic",children:J.gpa}),b.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["  : ",b.jsx("span",{className:"font-bold text-white",children:J.hours})]})]})]})}),b.jsxs("div",{className:"lg:col-span-5 space-y-6",children:[b.jsxs("div",{className:"glass-panel p-6 rounded-3xl bg-white/[0.02] border border-white/5",children:[b.jsxs("h3",{className:"text-base font-bold text-white mb-4 flex items-center gap-3 justify-end",children:[b.jsx(gU,{size:18,className:"text-blue-400"}),"   "]}),b.jsxs("div",{className:"space-y-4 text-xs text-slate-400 leading-relaxed border-t border-white/5 pt-4",children:[b.jsxs("p",{children:[b.jsx("strong",{className:"font-black text-blue-300",children:":"}),"         ."]}),b.jsxs("p",{children:[b.jsx("strong",{className:"font-black text-blue-300",children:":"}),"         (    )."]}),b.jsxs("p",{children:[b.jsx("strong",{className:"font-black text-blue-300",children:":"}),"     .      ."]})]})]}),b.jsxs("div",{className:"glass-panel p-6 rounded-3xl bg-white/[0.02] border border-white/5",children:[b.jsxs("h3",{className:"text-base font-bold text-white mb-4 flex items-center gap-3 justify-end",children:[b.jsx(JN,{size:18,className:"text-amber-400"}),"  "]}),b.jsxs("div",{className:"space-y-3 text-xs text-slate-400 leading-relaxed border-t border-white/5 pt-4",children:[b.jsxs("p",{children:[b.jsx("strong",{className:"font-black text-amber-300",children:" :"}),"                  ."]}),b.jsxs("p",{children:[b.jsx("strong",{className:"font-black text-amber-300",children:"  :"}),"           ."]})]})]})]})]})]});return b.jsx("div",{className:"min-h-screen pt-20 sm:pt-28 pb-20 relative z-10 px-4",children:b.jsxs("div",{className:"max-w-6xl mx-auto",children:[b.jsx(j,{}),t==="selection"&&X(),t==="final_calc"&&b.jsx("div",{className:"animate-fade-in max-w-lg mx-auto space-y-6",children:b.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#080808] border border-white/10 shadow-2xl space-y-6 text-right",children:[b.jsx("h3",{className:"text-xl font-black text-white",children:"  "}),b.jsx("input",{type:"number",value:i,onChange:ee=>a(ee.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:"  (100)"}),b.jsx("input",{type:"number",value:l,onChange:ee=>c(ee.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:"  (100)"}),b.jsx("input",{type:"number",value:d,onChange:ee=>h(ee.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:"   "}),b.jsx(xt,{onClick:ve,fullWidth:!0,children:" "}),p&&b.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl text-center",children:[b.jsx("p",{className:"text-xs text-slate-400",children:p.message}),b.jsx("p",{className:"text-3xl font-black text-white mt-1",children:p.value})]})]})}),t==="gpa_calc"&&b.jsx("div",{className:"animate-fade-in max-w-lg mx-auto space-y-6",children:b.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#080808] border border-white/10 shadow-2xl space-y-6 text-right",children:[b.jsxs("div",{className:"flex bg-white/5 p-1 rounded-xl",children:[b.jsx("button",{onClick:()=>E("100to4"),className:`flex-1 py-2 rounded-lg text-xs font-bold ${A==="100to4"?"bg-emerald-600 text-white":"text-slate-500"}`,children:"100  4"}),b.jsx("button",{onClick:()=>E("4to100"),className:`flex-1 py-2 rounded-lg text-xs font-bold ${A==="4to100"?"bg-emerald-600 text-white":"text-slate-500"}`,children:"4  100"})]}),b.jsx("input",{type:"number",step:"0.01",value:x,onChange:ee=>S(ee.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white text-right font-bold",placeholder:A==="100to4"?"  100":"  4.00"}),b.jsx(xt,{onClick:de,fullWidth:!0,className:"!bg-emerald-600",children:""}),N&&(N.type==="error"?b.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-xl text-center text-red-400 text-xs font-bold",children:N.message}):b.jsxs("div",{className:"p-6 bg-emerald-500/5 border border-emerald-500/10 rounded-3xl text-center",children:[b.jsx("p",{className:"text-xs text-emerald-500/60 mb-1",children:N.message}),b.jsx("p",{className:"text-5xl font-black text-white italic",children:N.value}),b.jsx("p",{className:"text-[10px] font-black text-emerald-400 mt-2 uppercase tracking-widest",children:N.label})]})),b.jsxs("div",{className:"pt-4 border-t border-white/5 grid grid-cols-2 gap-2 text-[9px] text-slate-600 text-center",children:[b.jsx("span",{children:"90+:  (3.74+)"}),b.jsx("span",{children:"80-89:   (3.34+)"}),b.jsx("span",{children:"70-79:  (2.94+)"}),b.jsx("span",{children:"60-69:  (2.54+)"})]})]})}),t==="cumulative_gpa_100"&&me()]})})},Sg=()=>{const[s,e]=ae.useState(!1),t=ae.useRef(null);return ae.useEffect(()=>{const n=new IntersectionObserver(([i])=>{i.isIntersecting&&(e(!0),n.unobserve(i.target))},{threshold:.1,rootMargin:"0px 0px -50px 0px"});return t.current&&n.observe(t.current),()=>{t.current&&n.unobserve(t.current)}},[]),{ref:t,isVisible:s}},T5=({onNavigate:s})=>{const e=Sg(),t=Sg(),n=Sg(),i=Sg(),a=()=>b.jsxs("div",{className:"flex items-center gap-2 mb-8 text-[10px] sm:text-xs font-bold text-slate-500 overflow-x-auto whitespace-nowrap py-2",dir:"rtl",children:[b.jsxs("button",{onClick:()=>s(xe.HOME),className:"flex items-center gap-1 hover:text-white transition-colors",children:[b.jsx(ty,{size:14})," "]}),b.jsx(xf,{size:12,className:"shrink-0 opacity-40"}),b.jsx("span",{className:"text-white bg-violet-500/10 px-2 py-0.5 rounded-md border border-violet-500/20",children:" "})]});return b.jsxs("div",{className:"min-h-screen pt-20 sm:pt-28 pb-32 px-4 relative z-10 bg-[#000000] text-right overflow-x-hidden",dir:"rtl",children:[b.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none",children:[b.jsx("div",{className:"absolute top-[-10%] left-[20%] w-[80vw] h-[80vw] bg-violet-600/10 rounded-full blur-[120px]"}),b.jsx("div",{className:"absolute bottom-[-5%] right-[-10%] w-[60vw] h-[60vw] bg-fuchsia-600/10 rounded-full blur-[100px]"})]}),b.jsxs("div",{className:"max-w-6xl mx-auto relative z-10",children:[b.jsxs("div",{className:"flex items-center justify-between mb-8 animate-lux-up",children:[b.jsx(a,{}),b.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 px-4 py-2 rounded-full bg-[#0f172a]/50 border border-violet-500/20 shadow-[0_0_20px_rgba(139,92,246,0.15)] backdrop-blur-xl",children:[b.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-violet-500 animate-pulse"}),b.jsx("span",{className:"text-[9px] sm:text-[11px] font-black text-violet-100 tracking-widest",children:" "})]})]}),b.jsxs("div",{ref:e.ref,className:`grid grid-cols-1 lg:grid-cols-2 gap-12 items-center mb-24 transition-all duration-1000 transform ${e.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-12"}`,children:[b.jsxs("div",{className:"text-right space-y-6 sm:space-y-8",children:[b.jsx("div",{className:"space-y-4",children:b.jsxs("h1",{className:"text-4xl sm:text-6xl md:text-8xl font-black text-white leading-tight tracking-tighter",children:[" ",b.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-400 to-blue-400",children:""})," ",b.jsx("br",{})," ."]})}),b.jsxs("p",{className:"text-slate-400 text-base sm:text-lg md:text-xl leading-relaxed max-w-xl font-medium",children:[" ",b.jsx("span",{className:"text-white font-bold italic",children:" "}),"   ",b.jsx("span",{className:"text-violet-400 font-bold",children:"  "}),".            ."]}),b.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-4",children:[b.jsxs("a",{href:"https://wa.me/962790000000",target:"_blank",className:"px-8 py-4 bg-gradient-to-r from-violet-600 to-fuchsia-600 rounded-2xl text-white font-black flex items-center justify-center gap-3 hover:shadow-[0_0_30px_rgba(139,92,246,0.4)] transition-all transform hover:-translate-y-1 active:scale-95 text-sm sm:text-base",children:[b.jsx(__,{size:20}),"  "]}),b.jsx("button",{className:"px-8 py-4 bg-white/5 border border-white/10 rounded-2xl text-slate-300 font-black hover:bg-white/10 transition-all text-sm sm:text-base",children:" "})]})]}),b.jsx("div",{className:"relative order-first lg:order-last overflow-hidden sm:overflow-visible",children:b.jsxs("div",{className:"relative aspect-square w-full max-w-[280px] sm:max-w-lg mx-auto flex items-center justify-center",children:[b.jsx("div",{className:"absolute w-24 h-24 sm:w-32 sm:h-32 bg-violet-600/20 rounded-full blur-[40px] sm:blur-[60px] animate-pulse"}),b.jsxs("svg",{viewBox:"0 0 200 200",className:"w-full h-full relative z-10 overflow-visible",children:[b.jsx("defs",{children:b.jsxs("radialGradient",{id:"grad1",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%",children:[b.jsx("stop",{offset:"0%",style:{stopColor:"#8b5cf6",stopOpacity:.4}}),b.jsx("stop",{offset:"100%",style:{stopColor:"transparent",stopOpacity:0}})]})}),b.jsx("g",{className:"animate-spin",style:{transformOrigin:"center",animationDuration:"60s"},children:[...Array(15)].map((l,c)=>{const d=c/15*Math.PI*2,h=60+Math.random()*30,p=100+Math.cos(d)*h,v=100+Math.sin(d)*h;return b.jsx("circle",{cx:p,cy:v,r:Math.random()*1,fill:"white",className:"animate-pulse",style:{animationDelay:`${c*.3}s`}},c)})}),b.jsx("circle",{cx:"100",cy:"100",r:"45",fill:"none",stroke:"url(#grad1)",strokeWidth:"0.5",className:"animate-pulse"}),b.jsx("circle",{cx:"100",cy:"100",r:"65",fill:"none",stroke:"#8b5cf6",strokeWidth:"0.2",strokeDasharray:"4,10",className:"opacity-40"})]}),b.jsx("div",{className:"absolute top-1/4 right-[10%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-violet-400 shadow-[0_0_20px_rgba(139,92,246,0.3)] animate-bounce",style:{animationDuration:"4.5s"},children:b.jsx(QN,{size:24})}),b.jsx("div",{className:"absolute bottom-[20%] left-[5%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-fuchsia-400 shadow-[0_0_20px_rgba(217,70,239,0.3)] animate-bounce",style:{animationDuration:"5.5s",animationDelay:"1.2s"},children:b.jsx(aR,{size:24})}),b.jsx("div",{className:"absolute top-[45%] left-[-5%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-blue-400 shadow-[0_0_20px_rgba(59,130,246,0.3)] animate-bounce",style:{animationDuration:"6.5s",animationDelay:"2.5s"},children:b.jsx(sR,{size:24})}),b.jsx("div",{className:"absolute w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-violet-500/10 to-transparent rounded-full flex items-center justify-center border border-white/5 backdrop-blur-sm",children:b.jsx(v_,{size:28,className:"text-white/80 animate-pulse"})})]})})]}),b.jsxs("div",{ref:t.ref,className:`mb-12 flex flex-col md:flex-row md:items-end justify-between gap-6 transition-all duration-1000 transform ${t.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:[b.jsxs("div",{className:"text-right",children:[b.jsx("h3",{className:"text-2xl sm:text-3xl font-black text-white mb-2",children:" "}),b.jsx("p",{className:"text-yellow-400 text-sm sm:text-base font-bold mb-3",children:"       "}),b.jsx("div",{className:"h-1.5 w-32 bg-gradient-to-r from-violet-600 via-fuchsia-500 to-transparent rounded-full"})]}),b.jsx("p",{className:"text-slate-500 text-[9px] sm:text-[10px] font-bold uppercase tracking-[0.3em]",children:"Etqan Excellence Solutions"})]}),b.jsx("div",{ref:n.ref,className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-24",children:[{icon:b.jsx(jU,{className:"text-violet-400"}),title:"  ",subtitle:"Premium Web Experiences",desc:b.jsxs("div",{className:"space-y-3",children:[b.jsx("p",{children:"     (Portfolios)       ."}),b.jsxs("div",{className:"text-yellow-400 font-bold text-[11px] sm:text-xs bg-yellow-400/5 p-3 rounded-xl border border-yellow-400/10",children:[b.jsx("p",{className:"mb-2 opacity-80 border-b border-yellow-400/20 pb-1 inline-block",children:":"}),b.jsxs("ul",{className:"space-y-1",children:[b.jsx("li",{children:"   "}),b.jsx("li",{children:"   "}),b.jsx("li",{children:"    "})]})]})]}),tags:["React","Tailwind","Motion"],color:"violet"},{icon:b.jsx(v_,{className:"text-blue-400"}),title:"  ",subtitle:"Academic & Enterprise Solutions",desc:"            .",tags:["Architecture","Database","AI"],color:"blue"}].map((l,c)=>b.jsx(C5,{index:c,icon:l.icon,title:l.title,subtitle:l.subtitle,desc:l.desc,tags:l.tags,color:l.color,isVisible:n.isVisible},c))}),b.jsxs("div",{ref:i.ref,className:`glass-panel p-8 sm:p-16 rounded-[2.5rem] sm:rounded-[3rem] bg-gradient-to-br from-[#0a0a0a] via-[#050505] to-[#111] border border-white/5 relative overflow-hidden text-center transition-all duration-1000 transform shadow-2xl ${i.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-12"}`,children:[b.jsx("div",{className:"absolute -top-24 -left-24 w-64 h-64 bg-violet-600/10 rounded-full blur-[100px] pointer-events-none"}),b.jsx("div",{className:"absolute -bottom-24 -right-24 w-64 h-64 bg-fuchsia-600/10 rounded-full blur-[100px] pointer-events-none"}),b.jsxs("div",{className:"relative z-10 space-y-6 sm:space-y-8",children:[b.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 sm:w-16 sm:h-16 rounded-2xl bg-white/5 border border-white/10 mb-2",children:b.jsx(QU,{className:"text-violet-500 animate-pulse",size:28})}),b.jsx("h2",{className:"text-3xl sm:text-5xl font-black text-white tracking-tight",children:"   "}),b.jsx("p",{className:"text-slate-400 text-base sm:text-lg max-w-2xl mx-auto font-medium px-4",children:"        .   ."}),b.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 pt-6 px-4",children:[b.jsxs("a",{href:"https://wa.me/962790000000",className:"w-full sm:w-auto px-10 py-4 bg-emerald-600 hover:bg-emerald-500 rounded-2xl text-white font-black flex items-center justify-center gap-3 transition-all shadow-xl shadow-emerald-900/20 text-sm sm:text-base",children:[b.jsx(__,{size:22}),"   "]}),b.jsx("button",{className:"w-full sm:w-auto px-10 py-4 bg-white/5 border border-white/10 rounded-2xl text-slate-300 font-black hover:bg-white/10 transition-all text-sm sm:text-base",children:"  "})]})]})]}),b.jsxs("div",{className:"mt-20 text-center space-y-4 px-4 pb-12",children:[b.jsxs("div",{className:"flex items-center justify-center gap-4 sm:gap-6 text-slate-600",children:[b.jsx("div",{className:"w-6 sm:w-8 h-px bg-white/5"}),b.jsx("span",{className:"text-[9px] sm:text-[10px] font-black uppercase tracking-[0.3em] whitespace-nowrap",children:"Etqan Group Jordan"}),b.jsx("div",{className:"w-6 sm:w-8 h-px bg-white/5"})]}),b.jsx("p",{className:"text-[9px] sm:text-[10px] font-bold text-slate-700",children:"      2024"})]})]})]})},C5=({index:s,icon:e,title:t,subtitle:n,desc:i,tags:a,color:l,isVisible:c})=>{const d={violet:"text-violet-400",fuchsia:"text-fuchsia-400",blue:"text-blue-400",emerald:"text-emerald-400",amber:"text-amber-400",rose:"text-rose-400"};return b.jsxs("div",{className:`group glass-panel p-6 sm:p-8 rounded-[2rem] sm:rounded-[2.5rem] bg-[#050505] border backdrop-blur-xl transition-all duration-700 hover:-translate-y-2 flex flex-col h-full relative overflow-hidden transform ${c?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,style:{transitionDelay:`${s*150}ms`},children:[b.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"}),b.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-2xl bg-white/5 flex items-center justify-center mb-5 sm:mb-6 group-hover:scale-110 transition-transform duration-500",children:Hd.cloneElement(e,{size:24})}),b.jsxs("div",{className:"mb-2",children:[b.jsx("h3",{className:"text-lg sm:text-xl font-black text-white mb-1 group-hover:text-white transition-colors",children:t}),b.jsx("p",{className:`text-[9px] sm:text-[10px] font-black uppercase tracking-widest ${d[l]} opacity-70`,children:n})]}),b.jsx("div",{className:"text-slate-500 text-xs sm:text-sm leading-relaxed mb-6 sm:mb-8 flex-1 font-medium",children:i}),b.jsx("div",{className:"flex flex-wrap gap-2",children:a.map((h,p)=>b.jsx("span",{className:"px-2.5 py-1 rounded-lg bg-white/5 border border-white/5 text-[8px] sm:text-[9px] font-bold text-slate-400 uppercase tracking-wider",children:h},p))}),b.jsx("div",{className:"absolute -bottom-10 -right-10 w-20 h-20 sm:w-24 sm:h-24 rounded-full blur-[30px] sm:blur-[40px] opacity-0 group-hover:opacity-20 transition-opacity bg-current"})]})},$b=()=>{const[s,e]=ae.useState(!1),t=ae.useRef(null);return ae.useEffect(()=>{const n=new IntersectionObserver(([i])=>{i.isIntersecting&&(e(!0),n.unobserve(i.target))},{threshold:.1});return t.current&&n.observe(t.current),()=>{t.current&&n.unobserve(t.current)}},[]),{ref:t,isVisible:s}},N5=({onNavigate:s})=>{const e=$b(),t=$b(),n=$b(),i="https://lh3.googleusercontent.com/d/1tbzVNKO3FGH46Pa6MZ58OWD4BXVKdK5P",a=()=>b.jsxs("div",{className:"flex items-center gap-2 mb-0 text-[10px] sm:text-xs font-bold text-slate-500 overflow-x-auto whitespace-nowrap py-2",dir:"rtl",children:[b.jsxs("button",{onClick:()=>s(xe.HOME),className:"flex items-center gap-1 hover:text-white transition-colors",children:[b.jsx(ty,{size:14})," "]}),b.jsx(xf,{size:12,className:"shrink-0 opacity-40"}),b.jsx("span",{className:"text-white bg-violet-500/10 px-2 py-0.5 rounded-md border border-violet-500/20",children:" "})]});return b.jsxs("div",{className:"min-h-screen pt-16 sm:pt-40 pb-32 px-4 relative bg-[#020205] text-right overflow-x-hidden",dir:"rtl",children:[b.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden",children:[b.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[100vw] h-[100vw] bg-violet-900/5 rounded-full blur-[120px]"}),b.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[80vw] h-[80vw] bg-fuchsia-900/5 rounded-full blur-[100px]"})]}),b.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[b.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-8 animate-lux-up px-2 sm:px-0",children:[b.jsx(a,{}),b.jsx("div",{className:"px-4 py-1.5 sm:px-5 sm:py-2 rounded-full bg-violet-500/10 border border-violet-500/20 text-violet-400 text-[10px] sm:text-[11px] font-black tracking-widest uppercase",children:" "})]}),b.jsx("div",{ref:e.ref,className:`relative mb-12 sm:mb-20 transition-all duration-1000 transform ${e.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:b.jsxs("div",{className:"glass-panel p-6 sm:p-12 rounded-[2.5rem] sm:rounded-[3rem] bg-gradient-to-br from-[#0a0a0a] to-black border border-white/10 relative overflow-hidden flex flex-col items-center text-center",children:[b.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-1/2 bg-gradient-to-b from-violet-600/5 to-transparent"}),b.jsxs("div",{className:"relative mb-6 sm:mb-8",children:[b.jsx("div",{className:"absolute inset-0 bg-violet-600/10 blur-3xl"}),b.jsx("div",{className:"relative w-28 h-28 sm:w-44 sm:h-44 bg-[#050505] rounded-[2rem] sm:rounded-[2.5rem] border border-white/10 flex items-center justify-center shadow-2xl mx-auto overflow-hidden group",children:b.jsx("img",{src:i,alt:"  ",className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",onError:l=>{l.target.src="https://api.dicebear.com/9.x/notionists/svg?seed=Joshua&backgroundColor=b6e3f4,c0aede,d1d4f9"}})}),b.jsx("div",{className:"absolute -bottom-1 -right-1 sm:-bottom-2 sm:-right-2 bg-violet-600 p-2 sm:p-2.5 rounded-xl sm:rounded-2xl border-2 sm:border-4 border-[#0a0a0a] text-white shadow-lg",children:b.jsx(Wp,{size:16,className:"sm:w-5 sm:h-5"})})]}),b.jsxs("div",{className:"space-y-4 relative z-10 w-full",children:[b.jsxs("h1",{className:"text-3xl sm:text-6xl font-black text-white tracking-tighter",children:[" ",b.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-400 to-white",children:" "})]}),b.jsx("p",{className:"text-slate-400 text-xs sm:text-base font-bold max-w-lg mx-auto leading-relaxed px-2",children:"            ."}),b.jsx("div",{className:"flex items-center justify-center gap-4 text-[10px] sm:text-xs font-black text-slate-500 uppercase tracking-widest pt-1",children:b.jsxs("span",{className:"flex items-center gap-1.5",children:[b.jsx(MU,{size:12,className:"text-violet-500 sm:w-3.5 sm:h-3.5"}),"  "]})}),b.jsxs("div",{className:"pt-6 sm:pt-8 flex flex-col items-center gap-3",children:[b.jsx("span",{className:"text-yellow-400 text-[11px] sm:text-sm font-black uppercase tracking-[0.25em] drop-shadow-[0_0_8px_rgba(250,204,21,0.3)]",children:" "}),b.jsxs("div",{className:"flex items-center justify-center gap-4 sm:gap-6",children:[b.jsx("a",{href:"https://www.facebook.com/yazanabokaheal2",target:"_blank",rel:"noopener noreferrer",className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-[#1877F2]/10 border border-[#1877F2]/20 flex items-center justify-center text-[#1877F2] hover:bg-[#1877F2]/20 hover:scale-110 transition-all shadow-[0_0_15px_rgba(24,119,242,0.15)] group",title:"",children:b.jsx(rU,{size:24,className:"sm:w-8 sm:h-8 group-hover:drop-shadow-[0_0_8px_rgba(24,119,242,0.5)] transition-all"})}),b.jsx("a",{href:"https://wa.me/972568401548",target:"_blank",rel:"noopener noreferrer",className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-[#25D366]/10 border border-[#25D366]/20 flex items-center justify-center text-[#25D366] hover:bg-[#25D366]/20 hover:scale-110 transition-all shadow-[0_0_15px_rgba(37,211,102,0.15)] group",title:"",children:b.jsx(__,{size:24,className:"sm:w-8 sm:h-8 group-hover:drop-shadow-[0_0_8px_rgba(37,211,102,0.5)] transition-all"})}),b.jsx("a",{href:"https://t.me/yazan1342",target:"_blank",rel:"noopener noreferrer",className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-[#0088cc]/10 border border-[#0088cc]/20 flex items-center justify-center text-[#0088cc] hover:bg-[#0088cc]/20 hover:scale-110 transition-all shadow-[0_0_15px_rgba(0,136,204,0.15)] group",title:"",children:b.jsx(t5,{size:24,className:"sm:w-8 sm:h-8 group-hover:drop-shadow-[0_0_8px_rgba(0,136,204,0.5)] transition-all"})})]})]})]})]})}),b.jsxs("div",{ref:t.ref,className:`grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-12 transition-all duration-1000 transform ${t.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:[b.jsxs("div",{className:"group relative",children:[b.jsx("div",{className:"absolute inset-0 bg-violet-600/20 blur-2xl opacity-0 group-hover:opacity-100 transition-opacity rounded-[2.5rem]"}),b.jsxs("div",{className:"glass-panel relative p-6 sm:p-8 rounded-[2rem] sm:rounded-[2.5rem] bg-[#050505] border border-white/5 h-full flex flex-col items-start text-right transition-all group-hover:border-violet-500/30",children:[b.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-xl sm:rounded-2xl bg-violet-500/10 flex items-center justify-center text-violet-400 mb-5 group-hover:scale-110 transition-transform shadow-inner",children:b.jsx(ey,{size:24,className:"sm:w-7 sm:h-7"})}),b.jsx("h3",{className:"text-lg sm:text-xl font-black text-white mb-2",children:" "}),b.jsxs("p",{className:"text-slate-400 text-xs sm:text-sm leading-relaxed font-medium",children:["  ",b.jsx("span",{className:"text-violet-400 font-bold",children:" "}),"     -    ",b.jsx("span",{className:"text-yellow-400 font-bold",children:""}),"."]})]})]}),b.jsxs("div",{className:"group relative",children:[b.jsx("div",{className:"absolute inset-0 bg-fuchsia-600/20 blur-2xl opacity-0 group-hover:opacity-100 transition-opacity rounded-[2.5rem]"}),b.jsxs("div",{className:"glass-panel relative p-6 sm:p-8 rounded-[2rem] sm:rounded-[2.5rem] bg-[#050505] border border-white/5 h-full flex flex-col items-start text-right transition-all group-hover:border-fuchsia-500/30",children:[b.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-xl sm:rounded-2xl bg-fuchsia-500/10 flex items-center justify-center text-fuchsia-400 mb-5 group-hover:scale-110 transition-transform shadow-inner",children:b.jsx(DO,{size:24,className:"sm:w-7 sm:h-7"})}),b.jsx("h3",{className:"text-lg sm:text-xl font-black text-white mb-2",children:" "}),b.jsxs("p",{className:"text-slate-400 text-xs sm:text-sm leading-relaxed font-medium",children:["    ",b.jsx("span",{className:"text-fuchsia-400 font-bold",children:"   - "}),".            ."]})]})]})]}),b.jsx("div",{ref:n.ref,className:`relative transition-all duration-1000 transform ${n.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:b.jsxs("div",{className:"glass-panel p-6 sm:p-12 rounded-[2.5rem] sm:rounded-[3rem] bg-[#030303] border border-white/5 relative overflow-hidden",children:[b.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-violet-600/5 rounded-full blur-3xl"}),b.jsxs("div",{className:"flex flex-col items-center text-center space-y-6 sm:space-y-8 relative z-10",children:[b.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 rounded-full bg-white/5 border border-white/10 text-violet-400 text-[9px] sm:text-[10px] font-black tracking-widest uppercase",children:[b.jsx(QN,{size:12}),"  "]}),b.jsxs("div",{className:"space-y-3",children:[b.jsx("h3",{className:"text-xl sm:text-4xl font-black text-white tracking-tight leading-tight px-4",children:"   "}),b.jsx("p",{className:"text-slate-500 text-xs sm:text-base max-w-2xl mx-auto leading-relaxed font-medium px-2",children:"              :"})]}),b.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 w-full",children:[{icon:b.jsx(sR,{}),label:"  ",color:"text-blue-400",bg:"bg-blue-500/5"},{icon:b.jsx(aR,{}),label:" ",color:"text-violet-400",bg:"bg-violet-500/5"},{icon:b.jsx(v_,{}),label:" ",color:"text-fuchsia-400",bg:"bg-fuchsia-500/5"}].map((l,c)=>b.jsxs("div",{className:"bg-white/5 p-5 rounded-[2rem] border border-white/5 flex flex-col items-center gap-3 sm:gap-4 group hover:bg-white/10 hover:-translate-y-1 transition-all",children:[b.jsx("div",{className:`${l.color} ${l.bg} p-3 sm:p-4 rounded-xl sm:rounded-2xl group-hover:scale-110 transition-transform`,children:Hd.cloneElement(l.icon,{size:24,className:"sm:w-7 sm:h-7"})}),b.jsx("span",{className:"text-[10px] sm:text-sm font-black text-slate-200 tracking-tight",children:l.label})]},c))}),b.jsx("div",{className:"pt-6 sm:pt-10 w-full px-2",children:b.jsx("div",{className:"p-0.5 sm:p-1 rounded-[2rem] sm:rounded-[2.5rem] bg-gradient-to-r from-violet-600 via-fuchsia-600 to-violet-600",children:b.jsx("div",{className:"bg-[#0a0a0a] rounded-[1.8rem] sm:rounded-[2.3rem] p-4 sm:p-6 flex flex-wrap justify-center gap-2 sm:gap-4",children:[" "," "," "," "].map((l,c)=>b.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-white/5 rounded-full text-[9px] sm:text-[10px] font-black text-slate-300 border border-white/5 uppercase tracking-wider",children:[b.jsx(jd,{size:12,className:"text-yellow-500"})," ",l]},c))})})})]})]})}),b.jsxs("div",{className:"mt-16 sm:mt-24 text-center space-y-6 pb-20",children:[b.jsxs("div",{className:"flex items-center justify-center gap-4 sm:gap-6 opacity-30",children:[b.jsx("div",{className:"h-px w-8 sm:w-12 bg-white"}),b.jsx("p",{className:"text-[8px] sm:text-[10px] font-black uppercase tracking-[0.3em] text-white",children:"Etqan Group  2026"}),b.jsx("div",{className:"h-px w-8 sm:w-12 bg-white"})]}),b.jsx("p",{className:"text-[8px] sm:text-[9px] text-slate-600 font-bold italic tracking-wide",children:'"      ."'})]})]})]})},Yb=["Felix","Joshua","Nolan","Liam","Caleb","Mason","Jack","Ethan","Aiden","Leo","Aneka","Selena","Molly","Sophia","Zoe","Lily","Maya","Chloe","Ruby","Eva"],Kb=s=>`https://api.dicebear.com/9.x/notionists/svg?seed=${s}&backgroundColor=b6e3f4,c0aede,d1d4f9`,Jb=({src:s,alt:e,className:t})=>{const[n,i]=ae.useState(!1);return b.jsxs("div",{className:`relative overflow-hidden bg-white/5 ${t}`,children:[!n&&b.jsx("div",{className:"absolute inset-0 bg-white/5 z-10 flex items-center justify-center"}),b.jsx("img",{src:s,alt:e,loading:"lazy",onLoad:()=>i(!0),className:`w-full h-full object-cover transition-opacity duration-300 ${n?"opacity-100":"opacity-0"}`})]})},R5=({user:s,quizHistory:e,onLogout:t,onSaveProfile:n,onNavigate:i})=>{const[a,l]=ae.useState(!1),[c,d]=ae.useState(!1),h=(s==null?void 0:s.user_metadata)||{};ae.useEffect(()=>{a&&window.scrollTo({top:0,behavior:"smooth"})},[a]);const p=ae.useMemo(()=>{const ne=e.reduce((ee,ue)=>ee+ue.score*10,0),ve=e.length>0?Math.round(e.reduce((ee,ue)=>ee+ue.score/ue.total_questions,0)/e.length*100):0;let de=1,Re=200,j=0;ne>=2e3?(de=5,Re=5e3,j=2e3):ne>=1e3?(de=4,Re=2e3,j=1e3):ne>=500?(de=3,Re=1e3,j=500):ne>=200&&(de=2,Re=500,j=200);const X=Math.min(100,Math.max(0,(ne-j)/(Re-j)*100)),me=[{id:"first",icon:b.jsx(Wp,{}),title:" ",earned:e.length>=1,desc:"  "},{id:"master",icon:b.jsx(y0,{}),title:"",earned:e.length>=5,desc:" 5 "},{id:"exp",icon:b.jsx(jd,{}),title:" ",earned:ne>=500,desc:" 500  "},{id:"perfect",icon:b.jsx(nR,{}),title:" ",earned:e.some(ee=>ee.score===ee.total_questions),desc:"   100%"}];return{totalExp:ne,avgScore:ve,level:de,nextLevelXp:Re,progress:X,achievements:me}},[e]),[v,x]=ae.useState(h.full_name||""),[S,A]=ae.useState(h.gender||"male"),[E,N]=ae.useState(h.age||"18-22"),[R,D]=ae.useState(h.avatar||Yb[0]),[P,L]=ae.useState(h.university||""),[H,z]=ae.useState(h.major||""),[U,J]=ae.useState(h.academic_year||"1"),K=async()=>{d(!0),await n({full_name:v,gender:S,avatar:R,university:P,major:H,academic_year:U,age:E}),d(!1),l(!1)},ie=ne=>{if(!ne)return" ";const ve=new Date(ne);return new Intl.DateTimeFormat("ar-EG",{year:"numeric",month:"numeric",day:"numeric"}).format(ve)},oe=["  18","18-22","23-25","  25"];return b.jsx("div",{className:"min-h-screen pt-24 pb-20 px-4 md:px-6 relative z-10 bg-[#0A192F] animate-lux-up",children:b.jsx("div",{className:"max-w-7xl mx-auto",children:a?b.jsx("div",{className:"glass-panel p-8 rounded-3xl border border-blue-900/80 bg-[#112240] animate-lux-scale",children:b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10",children:[b.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[b.jsxs("div",{children:[b.jsxs("h3",{className:"text-lg font-bold text-slate-200 mb-4 flex items-center gap-2 border-b border-blue-900/80 pb-2",children:[b.jsx(m5,{className:"text-amber-400",size:20}),"  "]}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:" "}),b.jsx("input",{type:"text",value:v,onChange:ne=>x(ne.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 px-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all",placeholder:" "})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:""}),b.jsx("select",{value:E,onChange:ne=>N(ne.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 px-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all appearance-none",children:oe.map(ne=>b.jsx("option",{children:ne},ne))})]}),b.jsxs("div",{className:"md:col-span-2",children:[b.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:""}),b.jsxs("div",{className:"flex bg-black/30 p-1 rounded-xl border border-blue-900/80",children:[b.jsx("button",{onClick:()=>A("male"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${S==="male"?"bg-blue-600 text-white":"text-slate-500 hover:text-white"}`,children:""}),b.jsx("button",{onClick:()=>A("female"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${S==="female"?"bg-pink-600 text-white":"text-slate-500 hover:text-white"}`,children:""})]})]})]})]}),b.jsxs("div",{children:[b.jsxs("h3",{className:"text-lg font-bold text-slate-200 mb-4 flex items-center gap-2 border-b border-blue-900/80 pb-2",children:[b.jsx(ey,{className:"text-amber-400",size:20}),"  "]}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:" / "}),b.jsxs("div",{className:"relative",children:[b.jsx(y_,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:16}),b.jsx("input",{type:"text",value:P,onChange:ne=>L(ne.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 pr-12 pl-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all",placeholder:" "})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:""}),b.jsxs("div",{className:"relative",children:[b.jsx(b_,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:16}),b.jsx("input",{type:"text",value:H,onChange:ne=>z(ne.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 pr-12 pl-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all",placeholder:" "})]})]}),b.jsxs("div",{className:"md:col-span-2",children:[b.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:" "}),b.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 custom-scrollbar",children:["1","2","3","4","5",""].map(ne=>b.jsx("button",{onClick:()=>J(ne),className:`px-6 py-2 rounded-xl border font-bold text-sm transition-all whitespace-nowrap ${U===ne?"bg-amber-500 border-amber-400 text-slate-900":"bg-black/30 border-blue-900/80 text-slate-500 hover:bg-white/5"}`,children:ne===""?"":` ${ne}`},ne))})]})]})]}),b.jsxs("div",{className:"pt-6 flex gap-4 border-t border-blue-900/80",children:[b.jsxs(xt,{onClick:K,disabled:c,className:"!bg-amber-500 hover:!bg-amber-600 !text-slate-900 !border-amber-600 px-8",children:[c?b.jsx(ua,{size:18,className:"animate-spin"}):b.jsx(rR,{size:18}),c?" ...":" "]}),b.jsx(xt,{onClick:()=>l(!1),variant:"secondary",children:""})]})]}),b.jsxs("div",{className:"lg:col-span-4 flex flex-col h-full bg-black/20 rounded-2xl p-6 border border-blue-900/80",children:[b.jsxs("h3",{className:"text-sm font-bold text-slate-400 mb-4 flex items-center gap-2",children:[b.jsx(FU,{size:16}),"   "]}),b.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-6 mb-6 relative",children:b.jsx("div",{className:"w-48 h-48 rounded-full border-4 border-amber-500 shadow-[0_0_30px_rgba(245,158,11,0.2)] relative z-10 bg-white/5 overflow-hidden",children:b.jsx(Jb,{src:Kb(R),alt:"Selected Avatar",className:"w-full h-full"})})}),b.jsx("label",{className:"text-xs font-bold text-slate-500 block mb-3",children:" :"}),b.jsx("div",{className:"grid grid-cols-5 gap-2 h-auto overflow-y-auto max-h-[200px] pr-2 custom-scrollbar",children:Yb.map(ne=>b.jsx("div",{onClick:()=>D(ne),className:`aspect-square rounded-xl cursor-pointer transition-all border-2 overflow-hidden ${R===ne?"border-amber-500 scale-105 shadow-lg shadow-amber-500/20":"border-transparent hover:border-white/20 hover:scale-105"}`,children:b.jsx(Jb,{src:Kb(ne),alt:ne,className:"w-full h-full"})},ne))})]})]})}):b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8 mt-6",children:[b.jsx("div",{className:"lg:col-span-1 space-y-6",children:b.jsxs("div",{className:"glass-panel bg-[#112240] p-6 sm:p-8 rounded-[2.5rem] border border-blue-900/80 flex flex-col items-center text-center relative overflow-hidden group",children:[b.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-amber-500/5 via-transparent to-transparent opacity-50 group-hover:opacity-100 transition-opacity"}),b.jsx("div",{className:"w-40 h-40 rounded-full border-[6px] border-[#0A192F] shadow-2xl mb-4 relative z-10 bg-violet-200 overflow-hidden transform group-hover:scale-105 transition-transform duration-500",children:b.jsx(Jb,{src:Kb(h.avatar||Yb[0]),alt:"Profile",className:"w-full h-full"})}),b.jsx("h2",{className:"text-3xl font-black text-slate-200 mb-1 relative z-10",children:h.full_name}),b.jsx("p",{className:"text-sm text-slate-500 font-mono mb-4 sm:mb-6 relative z-10",children:s==null?void 0:s.email}),b.jsxs("div",{className:"w-full space-y-3 sm:space-y-4 text-right relative z-10",children:[b.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[b.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-blue-500/10 flex items-center justify-center text-blue-400 shrink-0",children:b.jsx(y_,{size:20})}),b.jsxs("div",{children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),b.jsx("p",{className:"text-sm font-bold text-slate-300 truncate max-w-[150px]",children:h.university||"  "})]})]}),b.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[b.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-fuchsia-500/10 flex items-center justify-center text-fuchsia-400 shrink-0",children:b.jsx(b_,{size:20})}),b.jsxs("div",{children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),b.jsx("p",{className:"text-sm font-bold text-slate-300 truncate max-w-[150px]",children:h.major||"  "})]})]}),b.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[b.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-emerald-500/10 flex items-center justify-center text-emerald-400 shrink-0",children:b.jsx(FO,{size:20})}),b.jsxs("div",{children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:" "}),b.jsx("p",{className:"text-sm font-bold text-slate-300",children:h.academic_year?h.academic_year===""?"":` ${h.academic_year}`:" "})]})]}),b.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[b.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-amber-500/10 flex items-center justify-center text-amber-400 shrink-0",children:b.jsx($N,{size:20})}),b.jsxs("div",{children:[b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),b.jsx("p",{className:"text-sm font-bold text-slate-300",children:h.age||" "})]})]})]}),b.jsx("div",{className:"w-full mt-4 relative z-10",children:b.jsxs(xt,{onClick:()=>l(!0),variant:"secondary",fullWidth:!0,className:"!py-3 !text-sm !rounded-xl bg-white/5 hover:bg-white/10 border-blue-900/50 text-slate-300 hover:text-white",children:[b.jsx(BU,{size:16}),"  "]})}),b.jsx("div",{className:"w-full mt-3 pt-6 border-t border-blue-900/50 relative z-10",children:b.jsxs(xt,{onClick:t,variant:"danger",fullWidth:!0,className:"!py-3 !text-sm !rounded-xl opacity-80 hover:opacity-100",children:[b.jsx(tR,{size:16}),"  "]})})]})}),b.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 sm:gap-4",children:[b.jsxs("div",{className:"glass-panel p-4 sm:p-5 rounded-[2rem] bg-[#050505] border border-blue-900/80 flex items-center gap-3 sm:gap-4 group",children:[b.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-2xl bg-amber-400/10 flex items-center justify-center text-amber-400 transition-transform group-hover:scale-110",children:b.jsx(rw,{size:24})}),b.jsxs("div",{children:[b.jsx("h4",{className:"text-2xl font-black text-white",children:e.length}),b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:" "})]})]}),b.jsxs("div",{className:"glass-panel p-4 sm:p-5 rounded-[2rem] bg-[#050505] border border-blue-900/80 flex items-center gap-3 sm:gap-4 group",children:[b.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-400 transition-transform group-hover:scale-110",children:b.jsx(y0,{size:24})}),b.jsxs("div",{children:[b.jsxs("h4",{className:"text-2xl font-black text-white",children:[p.avgScore,"%"]}),b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:" "})]})]}),b.jsxs("div",{className:"glass-panel p-4 sm:p-5 rounded-[2rem] bg-[#050505] border border-blue-900/80 flex items-center gap-3 sm:gap-4 group",children:[b.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-blue-400 transition-transform group-hover:scale-110",children:b.jsx(bT,{size:24})}),b.jsxs("div",{children:[b.jsx("h4",{className:"text-xs font-black text-white",children:ie(s==null?void 0:s.created_at)}),b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:" "})]})]})]}),b.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-gradient-to-br from-[#112240] to-black border border-blue-900/80 relative overflow-hidden",children:[b.jsx("div",{className:"absolute top-0 right-0 p-10 opacity-5",children:b.jsx(RO,{size:120})}),b.jsxs("div",{className:"relative z-10",children:[b.jsxs("div",{className:"flex items-center justify-between mb-6",children:[b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsx("div",{className:"w-14 h-14 rounded-2xl bg-amber-500/20 border border-amber-400/30 flex items-center justify-center text-amber-400 shadow-[0_0_20px_rgba(245,158,11,0.2)]",children:b.jsx("span",{className:"text-3xl font-black italic",children:p.level})}),b.jsxs("div",{children:[b.jsx("h3",{className:"text-xl font-black text-slate-200 tracking-tight",children:" "}),b.jsxs("p",{className:"text-xs text-slate-500 font-bold uppercase tracking-widest",children:[p.totalExp,"   "]})]})]}),b.jsxs("div",{className:"text-right",children:[b.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1",children:" "}),b.jsxs("p",{className:"text-sm font-black text-slate-300 italic",children:[p.nextLevelXp," XP"]})]})]}),b.jsx("div",{className:"relative h-4 bg-white/5 rounded-full overflow-hidden border border-blue-900/50 p-1 mb-10",children:b.jsx("div",{className:"h-full bg-gradient-to-r from-amber-500 to-yellow-400 rounded-full transition-all duration-1000 shadow-[0_0_15px_rgba(245,158,11,0.4)]",style:{width:`${p.progress}%`}})}),b.jsxs("h4",{className:"text-xs font-black text-slate-400 uppercase tracking-[0.2em] mb-6 flex items-center gap-2",children:[b.jsx(ow,{size:14,className:"text-yellow-500"}),"  "]}),b.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:p.achievements.map(ne=>b.jsxs("div",{className:`p-4 rounded-2xl border transition-all flex flex-col items-center text-center ${ne.earned?"bg-white/5 border-amber-400/20":"bg-black/20 border-blue-900/50 opacity-40 grayscale"}`,children:[b.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mb-3 ${ne.earned?"bg-amber-400/20 text-amber-400":"bg-white/5 text-slate-700"}`,children:ne.icon}),b.jsx("p",{className:`text-xs font-black mb-1 ${ne.earned?"text-slate-200":"text-slate-600"}`,children:ne.title}),b.jsx("p",{className:"text-[9px] text-slate-500 leading-tight",children:ne.desc})]},ne.id))})]})]}),b.jsxs("div",{className:"glass-panel bg-[#112240] rounded-[2.5rem] p-8 border border-blue-900/80",children:[b.jsxs("div",{className:"flex items-center justify-between mb-6",children:[b.jsxs("h3",{className:"text-xl font-bold text-slate-200 flex items-center gap-3",children:[b.jsx(fU,{className:"text-amber-400",size:24}),"  "]}),b.jsxs("span",{className:"text-xs font-bold text-slate-500 bg-white/5 px-3 py-1 rounded-full",children:[e.length," "]})]}),b.jsxs("div",{className:"space-y-3",children:[e.length===0?b.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-blue-900/50 rounded-3xl",children:[b.jsx("div",{className:"w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-600",children:b.jsx(eR,{size:32})}),b.jsx("h4",{className:"text-lg font-bold text-slate-200 mb-2",children:"   "}),b.jsx("p",{className:"text-slate-500 mb-6 text-sm",children:"      ."}),b.jsx(xt,{onClick:()=>i(xe.HOME),className:"!bg-amber-500 hover:!bg-amber-600 !text-slate-900 !py-2 !px-6 !text-sm",children:" "})]}):e.slice(0,10).map((ne,ve)=>{const de=Math.round(ne.score/ne.total_questions*100);return b.jsxs("div",{className:"group p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:border-amber-400/30 hover:bg-black/40 transition-all flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsxs("div",{className:`w-14 h-14 shrink-0 rounded-2xl flex items-center justify-center font-black text-lg border ${de>=50?"bg-emerald-500/10 border-emerald-500/20 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":"bg-red-500/10 border-red-500/20 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]"}`,children:[de,"%"]}),b.jsxs("div",{children:[b.jsx("h4",{className:"font-bold text-slate-200 text-base mb-1 group-hover:text-amber-300 transition-colors",children:ne.quiz_title}),b.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500 font-medium",children:[b.jsxs("span",{className:"flex items-center gap-1",children:[b.jsx(bT,{size:12})," ",ne.created_at?new Intl.DateTimeFormat("ar-EG",{day:"numeric",month:"numeric",year:"numeric"}).format(new Date(ne.created_at)):" "]}),b.jsxs("span",{className:"flex items-center gap-1",children:[b.jsx(jd,{size:12,className:"text-amber-500"})," +",ne.score*10," XP"]})]})]})]}),b.jsxs("div",{className:"flex items-center justify-between sm:block sm:text-right border-t border-blue-900/50 sm:border-0 pt-3 sm:pt-0",children:[b.jsxs("span",{className:"text-sm font-bold text-slate-300 bg-black/30 px-3 py-1 rounded-lg border border-blue-900/50 sm:bg-transparent sm:border-0 sm:p-0",children:[ne.score," / ",ne.total_questions]}),b.jsx("p",{className:"text-[10px] text-slate-500 uppercase sm:mt-1 hidden sm:block",children:""})]})]},ve)}),e.length>10&&b.jsx("p",{className:"text-center text-xs text-slate-600 mt-4 font-medium",children:"   10  ."})]})]})]})]})})})},k5=({onFileSelect:s,disabled:e})=>{const t=ae.useRef(null),n=i=>{i.target.files&&i.target.files.length>0&&(s(i.target.files[0]),i.target.value="")};return b.jsx("div",{className:"flex justify-center w-full",children:b.jsxs("div",{className:`uiverse-upload-card ${e?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{var i;return!e&&((i=t.current)==null?void 0:i.click())},children:[b.jsx("input",{type:"file",accept:"application/pdf",className:"hidden",ref:t,onChange:n,disabled:e}),b.jsx("div",{className:"w-16 h-16 bg-gradient-to-tr from-violet-500/20 to-fuchsia-500/20 text-violet-300 rounded-2xl flex items-center justify-center mb-4 border border-white/5 shadow-inner transition-transform duration-500",children:b.jsx(WN,{size:32,className:"drop-shadow-[0_0_10px_rgba(167,139,250,0.5)]"})}),b.jsx("h3",{className:"text-xl font-black text-white mb-2 tracking-tight transition-colors",children:"  PDF"}),b.jsx("p",{className:"text-slate-400 text-[10px] px-6 mb-6 leading-relaxed font-medium text-center",children:"         ."}),b.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-violet-300 bg-violet-500/10 border border-violet-500/20 px-3 py-1.5 rounded-full shadow-[0_0_15px_rgba(139,92,246,0.1)]",children:[b.jsx(Wp,{size:12}),b.jsx("span",{children:"  "})]})]})})};var pf={};pf.d=(s,e)=>{for(var t in e)pf.o(e,t)&&!pf.o(s,t)&&Object.defineProperty(s,t,{enumerable:!0,get:e[t]})};pf.o=(s,e)=>Object.prototype.hasOwnProperty.call(s,e);var Oe=globalThis.pdfjsLib={};pf.d(Oe,{AbortException:()=>Eo,AnnotationEditorLayer:()=>kx,AnnotationEditorParamsType:()=>Ze,AnnotationEditorType:()=>Ge,AnnotationEditorUIManager:()=>hc,AnnotationLayer:()=>E3,AnnotationMode:()=>$a,ColorPicker:()=>S0,DOMSVGFactory:()=>gw,DrawLayer:()=>Dx,FeatureTest:()=>Kn,GlobalWorkerOptions:()=>oa,ImageKind:()=>Pg,InvalidPDFException:()=>S_,MissingPDFException:()=>wf,OPS:()=>bi,OutputScale:()=>E_,PDFDataRangeTransport:()=>d2,PDFDateString:()=>hw,PDFWorker:()=>Mu,PasswordResponses:()=>P5,PermissionFlag:()=>D5,PixelsPerInch:()=>To,RenderingCancelledException:()=>uw,TextLayer:()=>Sf,TouchManager:()=>x0,UnexpectedResponseException:()=>v0,Util:()=>Te,VerbosityLevel:()=>sy,XfaLayer:()=>f2,build:()=>r3,createValidAbsoluteUrl:()=>F5,fetchData:()=>oy,getDocument:()=>X4,getFilenameFromUrl:()=>Y5,getPdfFilenameFromUrl:()=>K5,getXfaPageViewport:()=>J5,isDataScheme:()=>ly,isPdfFile:()=>dw,noContextMenu:()=>Oi,normalizeUnicode:()=>q5,setLayerDimensions:()=>dc,shadow:()=>Ye,stopEvent:()=>zs,version:()=>i3});const Fn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),uR=[1,0,0,1,0,0],w_=[.001,0,0,.001,0,0],M5=1e7,Xb=1.35,Ls={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},$a={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},I5="pdfjs_internal_editor_",Ge={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Ze={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},D5={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Rn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Pg={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Qt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Hh={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},sy={ERRORS:0,WARNINGS:1,INFOS:5},bi={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},P5={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let iy=sy.WARNINGS;function L5(s){Number.isInteger(s)&&(iy=s)}function O5(){return iy}function ry(s){iy>=sy.INFOS&&console.log(`Info: ${s}`)}function qe(s){iy>=sy.WARNINGS&&console.log(`Warning: ${s}`)}function vt(s){throw new Error(s)}function Jt(s,e){s||vt(e)}function U5(s){switch(s==null?void 0:s.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function F5(s,e=null,t=null){if(!s)return null;try{if(t&&typeof s=="string"){if(t.addDefaultProtocol&&s.startsWith("www.")){const i=s.match(/\./g);(i==null?void 0:i.length)>=2&&(s=`http://${s}`)}if(t.tryConvertEncoding)try{s=G5(s)}catch{}}const n=e?new URL(s,e):new URL(s);if(U5(n))return n}catch{}return null}function Ye(s,e,t,n=!1){return Object.defineProperty(s,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const No=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class ST extends No{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Wb extends No{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class S_ extends No{constructor(e){super(e,"InvalidPDFException")}}class wf extends No{constructor(e){super(e,"MissingPDFException")}}class v0 extends No{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class z5 extends No{constructor(e){super(e,"FormatError")}}class Eo extends No{constructor(e){super(e,"AbortException")}}function dR(s){(typeof s!="object"||(s==null?void 0:s.length)===void 0)&&vt("Invalid argument for bytesToString");const e=s.length,t=8192;if(e<t)return String.fromCharCode.apply(null,s);const n=[];for(let i=0;i<e;i+=t){const a=Math.min(i+t,e),l=s.subarray(i,a);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function ay(s){typeof s!="string"&&vt("Invalid argument for stringToBytes");const e=s.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=s.charCodeAt(n)&255;return t}function j5(s){return String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255)}function lw(s){const e=Object.create(null);for(const[t,n]of s)e[t]=n;return e}function H5(){const s=new Uint8Array(4);return s[0]=1,new Uint32Array(s.buffer,0,1)[0]===1}function B5(){try{return new Function(""),!0}catch{return!1}}class Kn{static get isLittleEndian(){return Ye(this,"isLittleEndian",H5())}static get isEvalSupported(){return Ye(this,"isEvalSupported",B5())}static get isOffscreenCanvasSupported(){return Ye(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ye(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Ye(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):Ye(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return Ye(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Qb=Array.from(Array(256).keys(),s=>s.toString(16).padStart(2,"0"));var la,Lg,A_;class Te{static makeHexColor(e,t,n){return`#${Qb[e]}${Qb[t]}${Qb[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const n=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[n,i]}static applyInverseTransform(e,t){const n=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,a=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n;return[i,a]}static getAxialAlignedBoundingBox(e,t){const n=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),a=this.applyTransform([e[0],e[3]],t),l=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],i[0],a[0],l[0]),Math.min(n[1],i[1],a[1],l[1]),Math.max(n[0],i[0],a[0],l[0]),Math.max(n[1],i[1],a[1],l[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],a=e[2]*t[0]+e[3]*t[2],l=e[2]*t[1]+e[3]*t[3],c=(n+l)/2,d=Math.sqrt((n+l)**2-4*(n*l-a*i))/2,h=c+d||1,p=c-d||1;return[Math.sqrt(h),Math.sqrt(p)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>l?null:[n,a,i,l]}static bezierBoundingBox(e,t,n,i,a,l,c,d,h){return h?(h[0]=Math.min(h[0],e,c),h[1]=Math.min(h[1],t,d),h[2]=Math.max(h[2],e,c),h[3]=Math.max(h[3],t,d)):h=[Math.min(e,c),Math.min(t,d),Math.max(e,c),Math.max(t,d)],M(this,la,A_).call(this,e,n,a,c,t,i,l,d,3*(-e+3*(n-a)+c),6*(e-2*n+a),3*(n-e),h),M(this,la,A_).call(this,e,n,a,c,t,i,l,d,3*(-t+3*(i-l)+d),6*(t-2*i+l),3*(i-t),h),h}}la=new WeakSet,Lg=function(e,t,n,i,a,l,c,d,h,p){if(h<=0||h>=1)return;const v=1-h,x=h*h,S=x*h,A=v*(v*(v*e+3*h*t)+3*x*n)+S*i,E=v*(v*(v*a+3*h*l)+3*x*c)+S*d;p[0]=Math.min(p[0],A),p[1]=Math.min(p[1],E),p[2]=Math.max(p[2],A),p[3]=Math.max(p[3],E)},A_=function(e,t,n,i,a,l,c,d,h,p,v,x){if(Math.abs(h)<1e-12){Math.abs(p)>=1e-12&&M(this,la,Lg).call(this,e,t,n,i,a,l,c,d,-v/p,x);return}const S=p**2-4*v*h;if(S<0)return;const A=Math.sqrt(S),E=2*h;M(this,la,Lg).call(this,e,t,n,i,a,l,c,d,(-p+A)/E,x),M(this,la,Lg).call(this,e,t,n,i,a,l,c,d,(-p-A)/E,x)},k(Te,la);function G5(s){return decodeURIComponent(escape(s))}let Zb=null,AT=null;function q5(s){return Zb||(Zb=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,AT=new Map([["","t"]])),s.replaceAll(Zb,(e,t,n)=>t?t.normalize("NFKC"):AT.get(n))}function V5(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const s=new Uint8Array(32);return crypto.getRandomValues(s),dR(s)}const cw="pdfjs_internal_id_";function $5(s){return Uint8Array.prototype.toBase64?s.toBase64():btoa(dR(s))}typeof Promise.try!="function"&&(Promise.try=function(s,...e){return new Promise(t=>{t(s(...e))})});const kr="http://www.w3.org/2000/svg",il=class il{};Me(il,"CSS",96),Me(il,"PDF",72),Me(il,"PDF_TO_CSS_UNITS",il.CSS/il.PDF);let To=il;async function oy(s,e="text"){if(Kh(s,document.baseURI)){const t=await fetch(s);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const i=new XMLHttpRequest;i.open("GET",s,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}class Qp{constructor({viewBox:e,userUnit:t,scale:n,rotation:i,offsetX:a=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=i,this.offsetX=a,this.offsetY=l,n*=t;const d=(e[2]+e[0])/2,h=(e[3]+e[1])/2;let p,v,x,S;switch(i%=360,i<0&&(i+=360),i){case 180:p=-1,v=0,x=0,S=1;break;case 90:p=0,v=1,x=1,S=0;break;case 270:p=0,v=-1,x=-1,S=0;break;case 0:p=1,v=0,x=0,S=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(x=-x,S=-S);let A,E,N,R;p===0?(A=Math.abs(h-e[1])*n+a,E=Math.abs(d-e[0])*n+l,N=(e[3]-e[1])*n,R=(e[2]-e[0])*n):(A=Math.abs(d-e[0])*n+a,E=Math.abs(h-e[1])*n+l,N=(e[2]-e[0])*n,R=(e[3]-e[1])*n),this.transform=[p*n,v*n,x*n,S*n,A-p*n*d-x*n*h,E-v*n*d-S*n*h],this.width=N,this.height=R}get rawDims(){const{userUnit:e,viewBox:t}=this,n=t.map(i=>i*e);return Ye(this,"rawDims",{pageWidth:n[2]-n[0],pageHeight:n[3]-n[1],pageX:n[0],pageY:n[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:a=!1}={}){return new Qp({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:a})}convertToViewportPoint(e,t){return Te.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=Te.applyTransform([e[0],e[1]],this.transform),n=Te.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return Te.applyInverseTransform([e,t],this.transform)}}class uw extends No{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function ly(s){const e=s.length;let t=0;for(;t<e&&s[t].trim()==="";)t++;return s.substring(t,t+5).toLowerCase()==="data:"}function dw(s){return typeof s=="string"&&/\.pdf$/i.test(s)}function Y5(s){return[s]=s.split(/[#?]/,1),s.substring(s.lastIndexOf("/")+1)}function K5(s,e="document.pdf"){if(typeof s!="string")return e;if(ly(s))return qe('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(s);let a=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(a&&(a=a[0],a.includes("%")))try{a=n.exec(decodeURIComponent(a))[0]}catch{}return a||e}class ET{constructor(){Me(this,"started",Object.create(null));Me(this,"times",[])}time(e){e in this.started&&qe(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||qe(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:i,end:a}of this.times)e.push(`${n.padEnd(t)} ${a-i}ms
`);return e.join("")}}function Kh(s,e){try{const{protocol:t}=e?new URL(s,e):new URL(s);return t==="http:"||t==="https:"}catch{return!1}}function Oi(s){s.preventDefault()}function zs(s){s.preventDefault(),s.stopPropagation()}var Ef;class hw{static toDateObject(e){if(!e||typeof e!="string")return null;m(this,Ef)||C(this,Ef,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=m(this,Ef).exec(e);if(!t)return null;const n=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let d=parseInt(t[6],10);d=d>=0&&d<=59?d:0;const h=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let v=parseInt(t[9],10)||0;return v=v>=0&&v<=59?v:0,h==="-"?(l+=p,c+=v):h==="+"&&(l-=p,c-=v),new Date(Date.UTC(n,i,a,l,c,d))}}Ef=new WeakMap,k(hw,Ef);function J5(s,{scale:e=1,rotation:t=0}){const{width:n,height:i}=s.attributes.style,a=[0,0,parseInt(n),parseInt(i)];return new Qp({viewBox:a,userUnit:1,scale:e,rotation:t})}function fw(s){if(s.startsWith("#")){const e=parseInt(s.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return s.startsWith("rgb(")?s.slice(4,-1).split(",").map(e=>parseInt(e)):s.startsWith("rgba(")?s.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(qe(`Not a valid color format: "${s}"`),[0,0,0])}function X5(s){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of s.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;s.set(t,fw(n))}e.remove()}function Ct(s){const{a:e,b:t,c:n,d:i,e:a,f:l}=s.getTransform();return[e,t,n,i,a,l]}function Gi(s){const{a:e,b:t,c:n,d:i,e:a,f:l}=s.getTransform().invertSelf();return[e,t,n,i,a,l]}function dc(s,e,t=!1,n=!0){if(e instanceof Qp){const{pageWidth:i,pageHeight:a}=e.rawDims,{style:l}=s,c=Kn.isCSSRoundSupported,d=`var(--scale-factor) * ${i}px`,h=`var(--scale-factor) * ${a}px`,p=c?`round(down, ${d}, var(--scale-round-x, 1px))`:`calc(${d})`,v=c?`round(down, ${h}, var(--scale-round-y, 1px))`:`calc(${h})`;!t||e.rotation%180===0?(l.width=p,l.height=v):(l.width=v,l.height=p)}n&&s.setAttribute("data-main-rotation",e.rotation)}class E_{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Ya,ol,_i,ll,Tf,Cf,I0,hR,Jn,fR,pR,Og,mR,C_;const Pr=class Pr{constructor(e){k(this,Jn);k(this,Ya,null);k(this,ol,null);k(this,_i);k(this,ll,null);k(this,Tf,null);C(this,_i,e),m(Pr,Cf)||C(Pr,Cf,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=C(this,Ya,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=m(this,_i)._uiManager._signal;e.addEventListener("contextmenu",Oi,{signal:t}),e.addEventListener("pointerdown",M(Pr,I0,hR),{signal:t});const n=C(this,ll,document.createElement("div"));n.className="buttons",e.append(n);const i=m(this,_i).toolbarPosition;if(i){const{style:a}=e,l=m(this,_i)._uiManager.direction==="ltr"?1-i[0]:i[0];a.insetInlineEnd=`${100*l}%`,a.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return M(this,Jn,mR).call(this),e}get div(){return m(this,Ya)}hide(){var e;m(this,Ya).classList.add("hidden"),(e=m(this,ol))==null||e.hideDropdown()}show(){var e;m(this,Ya).classList.remove("hidden"),(e=m(this,Tf))==null||e.shown()}async addAltText(e){const t=await e.render();M(this,Jn,Og).call(this,t),m(this,ll).prepend(t,m(this,Jn,C_)),C(this,Tf,e)}addColorPicker(e){C(this,ol,e);const t=e.renderButton();M(this,Jn,Og).call(this,t),m(this,ll).prepend(t,m(this,Jn,C_))}remove(){var e;m(this,Ya).remove(),(e=m(this,ol))==null||e.destroy(),C(this,ol,null)}};Ya=new WeakMap,ol=new WeakMap,_i=new WeakMap,ll=new WeakMap,Tf=new WeakMap,Cf=new WeakMap,I0=new WeakSet,hR=function(e){e.stopPropagation()},Jn=new WeakSet,fR=function(e){m(this,_i)._focusEventsAllowed=!1,zs(e)},pR=function(e){m(this,_i)._focusEventsAllowed=!0,zs(e)},Og=function(e){const t=m(this,_i)._uiManager._signal;e.addEventListener("focusin",M(this,Jn,fR).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",M(this,Jn,pR).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Oi,{signal:t})},mR=function(){const{editorType:e,_uiManager:t}=m(this,_i),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",m(Pr,Cf)[e]),M(this,Jn,Og).call(this,n),n.addEventListener("click",i=>{t.delete()},{signal:t._signal}),m(this,ll).append(n)},C_=function(){const e=document.createElement("div");return e.className="divider",e},k(Pr,I0),k(Pr,Cf,null);let T_=Pr;var Nf,cl,ul,Co,gR,yR,vR;class W5{constructor(e){k(this,Co);k(this,Nf,null);k(this,cl,null);k(this,ul);C(this,ul,e)}show(e,t,n){const[i,a]=M(this,Co,yR).call(this,t,n),{style:l}=m(this,cl)||C(this,cl,M(this,Co,gR).call(this));e.append(m(this,cl)),l.insetInlineEnd=`${100*i}%`,l.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){m(this,cl).remove()}}Nf=new WeakMap,cl=new WeakMap,ul=new WeakMap,Co=new WeakSet,gR=function(){const e=C(this,cl,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Oi,{signal:m(this,ul)._signal});const t=C(this,Nf,document.createElement("div"));return t.className="buttons",e.append(t),M(this,Co,vR).call(this),e},yR=function(e,t){let n=0,i=0;for(const a of e){const l=a.y+a.height;if(l<n)continue;const c=a.x+(t?a.width:0);if(l>n){i=c,n=l;continue}t?c>i&&(i=c):c<i&&(i=c)}return[t?1-i:i,n]},vR=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=m(this,ul)._signal;e.addEventListener("contextmenu",Oi,{signal:n}),e.addEventListener("click",()=>{m(this,ul).highlightSelection("floating_button")},{signal:n}),m(this,Nf).append(e)};function b0(s,e,t){for(const n of t)e.addEventListener(n,s[n].bind(s))}var D0;class Q5{constructor(){k(this,D0,0)}get id(){return`${I5}${Hn(this,D0)._++}`}}D0=new WeakMap;var Pu,Rf,In,Lu,Ug;const Nw=class Nw{constructor(){k(this,Lu);k(this,Pu,V5());k(this,Rf,0);k(this,In,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const a=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ye(this,"_isSVGFittingCanvas",a)}async getFromFile(e){const{lastModified:t,name:n,size:i,type:a}=e;return M(this,Lu,Ug).call(this,`${t}_${n}_${i}_${a}`,e)}async getFromUrl(e){return M(this,Lu,Ug).call(this,e,e)}async getFromBlob(e,t){const n=await t;return M(this,Lu,Ug).call(this,e,n)}async getFromId(e){m(this,In)||C(this,In,new Map);const t=m(this,In).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){m(this,In)||C(this,In,new Map);let n=m(this,In).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${m(this,Pu)}_${Hn(this,Rf)._++}`,refCounter:1,isSvg:!1},m(this,In).set(e,n),m(this,In).set(n.id,n),n}getSvgUrl(e){const t=m(this,In).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;m(this,In)||C(this,In,new Map);const t=m(this,In).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const a=new OffscreenCanvas(n.width,n.height);a.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=a.convertToBlob()}(i=n.close)==null||i.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${m(this,Pu)}_`)}};Pu=new WeakMap,Rf=new WeakMap,In=new WeakMap,Lu=new WeakSet,Ug=async function(e,t){m(this,In)||C(this,In,new Map);let n=m(this,In).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${m(this,Pu)}_${Hn(this,Rf)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(n.url=t,i=await oy(t,"blob")):t instanceof File?i=n.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const a=Nw._isSVGFittingCanvas,l=new FileReader,c=new Image,d=new Promise((h,p)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,h()},l.onload=async()=>{const v=n.svgUrl=l.result;c.src=await a?`${v}#svgView(preserveAspectRatio(none))`:v},c.onerror=l.onerror=p});l.readAsDataURL(i),await d}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){qe(i),n=null}return m(this,In).set(e,n),n&&m(this,In).set(n.id,n),n};let N_=Nw;var zt,Ka,kf,kt;class Z5{constructor(e=128){k(this,zt,[]);k(this,Ka,!1);k(this,kf);k(this,kt,-1);C(this,kf,e)}add({cmd:e,undo:t,post:n,mustExec:i,type:a=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(i&&e(),m(this,Ka))return;const d={cmd:e,undo:t,post:n,type:a};if(m(this,kt)===-1){m(this,zt).length>0&&(m(this,zt).length=0),C(this,kt,0),m(this,zt).push(d);return}if(l&&m(this,zt)[m(this,kt)].type===a){c&&(d.undo=m(this,zt)[m(this,kt)].undo),m(this,zt)[m(this,kt)]=d;return}const h=m(this,kt)+1;h===m(this,kf)?m(this,zt).splice(0,1):(C(this,kt,h),h<m(this,zt).length&&m(this,zt).splice(h)),m(this,zt).push(d)}undo(){if(m(this,kt)===-1)return;C(this,Ka,!0);const{undo:e,post:t}=m(this,zt)[m(this,kt)];e(),t==null||t(),C(this,Ka,!1),C(this,kt,m(this,kt)-1)}redo(){if(m(this,kt)<m(this,zt).length-1){C(this,kt,m(this,kt)+1),C(this,Ka,!0);const{cmd:e,post:t}=m(this,zt)[m(this,kt)];e(),t==null||t(),C(this,Ka,!1)}}hasSomethingToUndo(){return m(this,kt)!==-1}hasSomethingToRedo(){return m(this,kt)<m(this,zt).length-1}cleanType(e){if(m(this,kt)!==-1){for(let t=m(this,kt);t>=0;t--)if(m(this,zt)[t].type!==e){m(this,zt).splice(t+1,m(this,kt)-t),C(this,kt,t);return}m(this,zt).length=0,C(this,kt,-1)}}destroy(){C(this,zt,null)}}zt=new WeakMap,Ka=new WeakMap,kf=new WeakMap,kt=new WeakMap;var P0,bR;class Zp{constructor(e){k(this,P0);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Kn.platform;for(const[n,i,a={}]of e)for(const l of n){const c=l.startsWith("mac+");t&&c?(this.callbacks.set(l.slice(4),{callback:i,options:a}),this.allKeys.add(l.split("+").at(-1))):!t&&!c&&(this.callbacks.set(l,{callback:i,options:a}),this.allKeys.add(l.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(M(this,P0,bR).call(this,t));if(!n)return;const{callback:i,options:{bubbles:a=!1,args:l=[],checker:c=null}}=n;c&&!c(e,t)||(i.bind(e,...l,t)(),a||zs(t))}}P0=new WeakSet,bR=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const L0=class L0{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return X5(e),Ye(this,"_colors",e)}convert(e){const t=fw(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,i]of this._colors)if(i.every((a,l)=>a===t[l]))return L0._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?Te.makeHexColor(...t):e}};Me(L0,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let R_=L0;var Ou,Ss,tn,wn,Uu,Or,Fu,ti,Ja,dl,zu,hl,$i,xi,fl,Mf,If,ju,Df,Yi,Xa,Hu,Wa,Ki,O0,Qa,Pf,Za,pl,Lf,Of,ln,ut,Ur,ml,Uf,Ff,eo,Ji,Fr,zf,ni,he,Fg,k_,_R,xR,zg,wR,SR,AR,M_,ER,I_,D_,TR,Bn,Mr,CR,NR,P_,RR,Jh,L_;const Cu=class Cu{constructor(e,t,n,i,a,l,c,d,h,p,v,x,S){k(this,he);k(this,Ou,new AbortController);k(this,Ss,null);k(this,tn,new Map);k(this,wn,new Map);k(this,Uu,null);k(this,Or,null);k(this,Fu,null);k(this,ti,new Z5);k(this,Ja,null);k(this,dl,null);k(this,zu,0);k(this,hl,new Set);k(this,$i,null);k(this,xi,null);k(this,fl,new Set);Me(this,"_editorUndoBar",null);k(this,Mf,!1);k(this,If,!1);k(this,ju,!1);k(this,Df,null);k(this,Yi,null);k(this,Xa,null);k(this,Hu,null);k(this,Wa,!1);k(this,Ki,null);k(this,O0,new Q5);k(this,Qa,!1);k(this,Pf,!1);k(this,Za,null);k(this,pl,null);k(this,Lf,null);k(this,Of,null);k(this,ln,Ge.NONE);k(this,ut,new Set);k(this,Ur,null);k(this,ml,null);k(this,Uf,null);k(this,Ff,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});k(this,eo,[0,0]);k(this,Ji,null);k(this,Fr,null);k(this,zf,null);k(this,ni,null);const A=this._signal=m(this,Ou).signal;C(this,Fr,e),C(this,zf,t),C(this,Uu,n),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:A}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:A}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:A}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:A}),i._on("setpreference",this.onSetPreference.bind(this),{signal:A}),i._on("switchannotationeditorparams",E=>this.updateParams(E.type,E.value),{signal:A}),M(this,he,wR).call(this),M(this,he,TR).call(this),M(this,he,M_).call(this),C(this,Or,a.annotationStorage),C(this,Df,a.filterFactory),C(this,ml,l),C(this,Hu,c||null),C(this,Mf,d),C(this,If,h),C(this,ju,p),C(this,Of,v||null),this.viewParameters={realScale:To.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=x||null,this._supportsPinchToZoom=S!==!1}static get _keyboardManager(){const e=Cu.prototype,t=l=>m(l,Fr).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:d}=c;return d!=="text"&&d!=="number"}return!0},i=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Ye(this,"_keyboardManager",new Zp([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&m(l,Fr).contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&m(l,Fr).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}]]))}destroy(){var e,t,n,i,a;(e=m(this,ni))==null||e.resolve(),C(this,ni,null),(t=m(this,Ou))==null||t.abort(),C(this,Ou,null),this._signal=null;for(const l of m(this,wn).values())l.destroy();m(this,wn).clear(),m(this,tn).clear(),m(this,fl).clear(),C(this,Ss,null),m(this,ut).clear(),m(this,ti).destroy(),(n=m(this,Uu))==null||n.destroy(),(i=m(this,Ki))==null||i.hide(),C(this,Ki,null),m(this,Yi)&&(clearTimeout(m(this,Yi)),C(this,Yi,null)),m(this,Ji)&&(clearTimeout(m(this,Ji)),C(this,Ji,null)),(a=this._editorUndoBar)==null||a.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return m(this,Of)}get useNewAltTextFlow(){return m(this,If)}get useNewAltTextWhenAddingImage(){return m(this,ju)}get hcmFilter(){return Ye(this,"hcmFilter",m(this,ml)?m(this,Df).addHCMFilter(m(this,ml).foreground,m(this,ml).background):"none")}get direction(){return Ye(this,"direction",getComputedStyle(m(this,Fr)).direction)}get highlightColors(){return Ye(this,"highlightColors",m(this,Hu)?new Map(m(this,Hu).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return Ye(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),C(this,dl,e)}setMainHighlightColorPicker(e){C(this,Lf,e)}editAltText(e,t=!1){var n;(n=m(this,Uu))==null||n.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":C(this,ju,t);break}}onPageChanging({pageNumber:e}){C(this,zu,e-1)}focusMainContainer(){m(this,Fr).focus()}findParent(e,t){for(const n of m(this,wn).values()){const{x:i,y:a,width:l,height:c}=n.div.getBoundingClientRect();if(e>=i&&e<=i+l&&t>=a&&t<=a+c)return n}return null}disableUserSelect(e=!1){m(this,zf).classList.toggle("noUserSelect",e)}addShouldRescale(e){m(this,fl).add(e)}removeShouldRescale(e){m(this,fl).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*To.PDF_TO_CSS_UNITS;for(const n of m(this,fl))n.onScaleChanging();(t=m(this,dl))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:a,focusOffset:l}=t,c=t.toString(),h=M(this,he,Fg).call(this,t).closest(".textLayer"),p=this.getSelectionBoxes(h);if(!p)return;t.empty();const v=M(this,he,k_).call(this,h),x=m(this,ln)===Ge.NONE,S=()=>{v==null||v.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:p,anchorNode:n,anchorOffset:i,focusNode:a,focusOffset:l,text:c}),x&&this.showAllEditors("highlight",!0,!0)};if(x){this.switchToMode(Ge.HIGHLIGHT,S);return}S()}addToAnnotationStorage(e){!e.isEmpty()&&m(this,Or)&&!m(this,Or).has(e.id)&&m(this,Or).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,m(this,Wa)&&(C(this,Wa,!1),M(this,he,zg).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of m(this,ut))if(t.div.contains(e)){C(this,pl,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!m(this,pl))return;const[e,t]=m(this,pl);C(this,pl,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){M(this,he,M_).call(this),M(this,he,I_).call(this)}removeEditListeners(){M(this,he,ER).call(this),M(this,he,D_).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of m(this,xi))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of m(this,xi))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=m(this,Ss))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of m(this,ut)){const a=i.serialize(!0);a&&t.push(a)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const l of m(this,xi))if(l.isHandlingMimeForPasting(a.type)){l.paste(a,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(a){qe(`paste: "${a.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const a=[];for(const d of n){const h=await i.deserialize(d);if(!h)return;a.push(h)}const l=()=>{for(const d of a)M(this,he,P_).call(this,d);M(this,he,L_).call(this,a)},c=()=>{for(const d of a)d.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(a){qe(`paste: "${a.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),m(this,ln)!==Ge.NONE&&!this.isEditorHandlingKeyboard&&Cu._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,m(this,Wa)&&(C(this,Wa,!1),M(this,he,zg).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(M(this,he,SR).call(this),M(this,he,I_).call(this),M(this,he,Bn).call(this,{isEditing:m(this,ln)!==Ge.NONE,isEmpty:M(this,he,Jh).call(this),hasSomethingToUndo:m(this,ti).hasSomethingToUndo(),hasSomethingToRedo:m(this,ti).hasSomethingToRedo(),hasSelectedEditor:!1})):(M(this,he,AR).call(this),M(this,he,D_).call(this),M(this,he,Bn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!m(this,xi)){C(this,xi,e);for(const t of m(this,xi))M(this,he,Mr).call(this,t.defaultPropertiesToUpdate)}}getId(){return m(this,O0).id}get currentLayer(){return m(this,wn).get(m(this,zu))}getLayer(e){return m(this,wn).get(e)}get currentPageIndex(){return m(this,zu)}addLayer(e){m(this,wn).set(e.pageIndex,e),m(this,Qa)?e.enable():e.disable()}removeLayer(e){m(this,wn).delete(e.pageIndex)}async updateMode(e,t=null,n=!1){var i;if(m(this,ln)!==e&&!(m(this,ni)&&(await m(this,ni).promise,!m(this,ni)))){if(C(this,ni,Promise.withResolvers()),C(this,ln,e),e===Ge.NONE){this.setEditingState(!1),M(this,he,NR).call(this),(i=this._editorUndoBar)==null||i.hide(),m(this,ni).resolve();return}this.setEditingState(!0),await M(this,he,CR).call(this),this.unselectAll();for(const a of m(this,wn).values())a.updateMode(e);if(!t){n&&this.addNewEditorFromKeyboard(),m(this,ni).resolve();return}for(const a of m(this,tn).values())a.annotationElementId===t?(this.setSelected(a),a.enterInEditMode()):a.unselect();m(this,ni).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==m(this,ln)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var n;if(m(this,xi)){switch(e){case Ze.CREATE:this.currentLayer.addNewEditor();return;case Ze.HIGHLIGHT_DEFAULT_COLOR:(n=m(this,Lf))==null||n.updateColor(t);break;case Ze.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(m(this,Uf)||C(this,Uf,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of m(this,ut))i.updateParams(e,t);for(const i of m(this,xi))i.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var a;for(const l of m(this,tn).values())l.editorType===e&&l.show(t);(((a=m(this,Uf))==null?void 0:a.get(Ze.HIGHLIGHT_SHOW_ALL))??!0)!==t&&M(this,he,Mr).call(this,[[Ze.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(m(this,Pf)!==e){C(this,Pf,e);for(const t of m(this,wn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const n of m(this,tn).values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return m(this,tn).get(e)}addEditor(e){m(this,tn).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(m(this,Yi)&&clearTimeout(m(this,Yi)),C(this,Yi,setTimeout(()=>{this.focusMainContainer(),C(this,Yi,null)},0))),m(this,tn).delete(e.id),this.unselect(e),(!e.annotationElementId||!m(this,hl).has(e.annotationElementId))&&((t=m(this,Or))==null||t.remove(e.id))}addDeletedAnnotationElement(e){m(this,hl).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return m(this,hl).has(e)}removeDeletedAnnotationElement(e){m(this,hl).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){m(this,Ss)!==e&&(C(this,Ss,e),e&&M(this,he,Mr).call(this,e.propertiesToUpdate))}updateUI(e){m(this,he,RR)===e&&M(this,he,Mr).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){M(this,he,Mr).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(m(this,ut).has(e)){m(this,ut).delete(e),e.unselect(),M(this,he,Bn).call(this,{hasSelectedEditor:this.hasSelection});return}m(this,ut).add(e),e.select(),M(this,he,Mr).call(this,e.propertiesToUpdate),M(this,he,Bn).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=m(this,dl))==null||t.commitOrRemove();for(const n of m(this,ut))n!==e&&n.unselect();m(this,ut).clear(),m(this,ut).add(e),e.select(),M(this,he,Mr).call(this,e.propertiesToUpdate),M(this,he,Bn).call(this,{hasSelectedEditor:!0})}isSelected(e){return m(this,ut).has(e)}get firstSelectedEditor(){return m(this,ut).values().next().value}unselect(e){e.unselect(),m(this,ut).delete(e),M(this,he,Bn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return m(this,ut).size!==0}get isEnterHandled(){return m(this,ut).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;m(this,ti).undo(),M(this,he,Bn).call(this,{hasSomethingToUndo:m(this,ti).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:M(this,he,Jh).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){m(this,ti).redo(),M(this,he,Bn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:m(this,ti).hasSomethingToRedo(),isEmpty:M(this,he,Jh).call(this)})}addCommands(e){m(this,ti).add(e),M(this,he,Bn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:M(this,he,Jh).call(this)})}cleanUndoStack(e){m(this,ti).cleanType(e)}delete(){var a;this.commitOrRemove();const e=(a=this.currentLayer)==null?void 0:a.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...m(this,ut)],n=()=>{var l;(l=this._editorUndoBar)==null||l.show(i,t.length===1?t[0].editorType:t.length);for(const c of t)c.remove()},i=()=>{for(const l of t)M(this,he,P_).call(this,l)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=m(this,Ss))==null||e.commitOrRemove()}hasSomethingToControl(){return m(this,Ss)||this.hasSelection}selectAll(){for(const e of m(this,ut))e.commit();M(this,he,L_).call(this,m(this,tn).values())}unselectAll(){var e;if(!(m(this,Ss)&&(m(this,Ss).commitOrRemove(),m(this,ln)!==Ge.NONE))&&!((e=m(this,dl))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of m(this,ut))t.unselect();m(this,ut).clear(),M(this,he,Bn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;m(this,eo)[0]+=e,m(this,eo)[1]+=t;const[i,a]=m(this,eo),l=[...m(this,ut)],c=1e3;m(this,Ji)&&clearTimeout(m(this,Ji)),C(this,Ji,setTimeout(()=>{C(this,Ji,null),m(this,eo)[0]=m(this,eo)[1]=0,this.addCommands({cmd:()=>{for(const d of l)m(this,tn).has(d.id)&&d.translateInPage(i,a)},undo:()=>{for(const d of l)m(this,tn).has(d.id)&&d.translateInPage(-i,-a)},mustExec:!1})},c));for(const d of l)d.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),C(this,$i,new Map);for(const e of m(this,ut))m(this,$i).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!m(this,$i))return!1;this.disableUserSelect(!1);const e=m(this,$i);C(this,$i,null);let t=!1;for(const[{x:i,y:a,pageIndex:l},c]of e)c.newX=i,c.newY=a,c.newPageIndex=l,t||(t=i!==c.savedX||a!==c.savedY||l!==c.savedPageIndex);if(!t)return!1;const n=(i,a,l,c)=>{if(m(this,tn).has(i.id)){const d=m(this,wn).get(c);d?i._setParentAndPosition(d,a,l):(i.pageIndex=c,i.x=a,i.y=l)}};return this.addCommands({cmd:()=>{for(const[i,{newX:a,newY:l,newPageIndex:c}]of e)n(i,a,l,c)},undo:()=>{for(const[i,{savedX:a,savedY:l,savedPageIndex:c}]of e)n(i,a,l,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(m(this,$i))for(const n of m(this,$i).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||m(this,ut).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return m(this,Ss)===e}getActive(){return m(this,Ss)}getMode(){return m(this,ln)}get imageManager(){return Ye(this,"imageManager",new N_)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,p=t.rangeCount;h<p;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:n,y:i,width:a,height:l}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(h,p,v,x)=>({x:(p-i)/l,y:1-(h+v-n)/a,width:x/l,height:v/a});break;case"180":c=(h,p,v,x)=>({x:1-(h+v-n)/a,y:1-(p+x-i)/l,width:v/a,height:x/l});break;case"270":c=(h,p,v,x)=>({x:1-(p+x-i)/l,y:(h-n)/a,width:x/l,height:v/a});break;default:c=(h,p,v,x)=>({x:(h-n)/a,y:(p-i)/l,width:v/a,height:x/l});break}const d=[];for(let h=0,p=t.rangeCount;h<p;h++){const v=t.getRangeAt(h);if(!v.collapsed)for(const{x,y:S,width:A,height:E}of v.getClientRects())A===0||E===0||d.push(c(x,S,A,E))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:e,id:t}){(m(this,Fu)||C(this,Fu,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=m(this,Fu))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=m(this,Fu))==null?void 0:i.get(e.data.id);if(!t)return;const n=m(this,Or).getRawValue(t);n&&(m(this,ln)===Ge.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}};Ou=new WeakMap,Ss=new WeakMap,tn=new WeakMap,wn=new WeakMap,Uu=new WeakMap,Or=new WeakMap,Fu=new WeakMap,ti=new WeakMap,Ja=new WeakMap,dl=new WeakMap,zu=new WeakMap,hl=new WeakMap,$i=new WeakMap,xi=new WeakMap,fl=new WeakMap,Mf=new WeakMap,If=new WeakMap,ju=new WeakMap,Df=new WeakMap,Yi=new WeakMap,Xa=new WeakMap,Hu=new WeakMap,Wa=new WeakMap,Ki=new WeakMap,O0=new WeakMap,Qa=new WeakMap,Pf=new WeakMap,Za=new WeakMap,pl=new WeakMap,Lf=new WeakMap,Of=new WeakMap,ln=new WeakMap,ut=new WeakMap,Ur=new WeakMap,ml=new WeakMap,Uf=new WeakMap,Ff=new WeakMap,eo=new WeakMap,Ji=new WeakMap,Fr=new WeakMap,zf=new WeakMap,ni=new WeakMap,he=new WeakSet,Fg=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},k_=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of m(this,wn).values())if(n.hasTextLayer(e))return n;return null},_R=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=M(this,he,Fg).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(m(this,Ki)||C(this,Ki,new W5(this)),m(this,Ki).show(n,i,this.direction==="ltr"))},xR=function(){var a,l,c;const e=document.getSelection();if(!e||e.isCollapsed){m(this,Ur)&&((a=m(this,Ki))==null||a.hide(),C(this,Ur,null),M(this,he,Bn).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===m(this,Ur))return;const i=M(this,he,Fg).call(this,e).closest(".textLayer");if(!i){m(this,Ur)&&((l=m(this,Ki))==null||l.hide(),C(this,Ur,null),M(this,he,Bn).call(this,{hasSelectedText:!1}));return}if((c=m(this,Ki))==null||c.hide(),C(this,Ur,t),M(this,he,Bn).call(this,{hasSelectedText:!0}),!(m(this,ln)!==Ge.HIGHLIGHT&&m(this,ln)!==Ge.NONE)&&(m(this,ln)===Ge.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),C(this,Wa,this.isShiftKeyDown),!this.isShiftKeyDown)){const d=m(this,ln)===Ge.HIGHLIGHT?M(this,he,k_).call(this,i):null;d==null||d.toggleDrawing();const h=new AbortController,p=this.combinedSignal(h),v=x=>{x.type==="pointerup"&&x.button!==0||(h.abort(),d==null||d.toggleDrawing(!0),x.type==="pointerup"&&M(this,he,zg).call(this,"main_toolbar"))};window.addEventListener("pointerup",v,{signal:p}),window.addEventListener("blur",v,{signal:p})}},zg=function(e=""){m(this,ln)===Ge.HIGHLIGHT?this.highlightSelection(e):m(this,Mf)&&M(this,he,_R).call(this)},wR=function(){document.addEventListener("selectionchange",M(this,he,xR).bind(this),{signal:this._signal})},SR=function(){if(m(this,Xa))return;C(this,Xa,new AbortController);const e=this.combinedSignal(m(this,Xa));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},AR=function(){var e;(e=m(this,Xa))==null||e.abort(),C(this,Xa,null)},M_=function(){if(m(this,Za))return;C(this,Za,new AbortController);const e=this.combinedSignal(m(this,Za));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},ER=function(){var e;(e=m(this,Za))==null||e.abort(),C(this,Za,null)},I_=function(){if(m(this,Ja))return;C(this,Ja,new AbortController);const e=this.combinedSignal(m(this,Ja));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},D_=function(){var e;(e=m(this,Ja))==null||e.abort(),C(this,Ja,null)},TR=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Bn=function(e){Object.entries(e).some(([n,i])=>m(this,Ff)[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(m(this,Ff),e)}),m(this,ln)===Ge.HIGHLIGHT&&e.hasSelectedEditor===!1&&M(this,he,Mr).call(this,[[Ze.HIGHLIGHT_FREE,!0]]))},Mr=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},CR=async function(){if(!m(this,Qa)){C(this,Qa,!0);const e=[];for(const t of m(this,wn).values())e.push(t.enable());await Promise.all(e);for(const t of m(this,tn).values())t.enable()}},NR=function(){if(this.unselectAll(),m(this,Qa)){C(this,Qa,!1);for(const e of m(this,wn).values())e.disable();for(const e of m(this,tn).values())e.disable()}},P_=function(e){const t=m(this,wn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},RR=function(){let e=null;for(e of m(this,ut));return e},Jh=function(){if(m(this,tn).size===0)return!0;if(m(this,tn).size===1)for(const e of m(this,tn).values())return e.isEmpty();return!1},L_=function(e){for(const t of m(this,ut))t.unselect();m(this,ut).clear();for(const t of e)t.isEmpty()||(m(this,ut).add(t),t.select());M(this,he,Bn).call(this,{hasSelectedEditor:this.hasSelection})},Me(Cu,"TRANSLATE_SMALL",1),Me(Cu,"TRANSLATE_BIG",10);let hc=Cu;var cn,Xi,wi,Bu,Wi,As,Gu,Qi,ls,zr,gl,Zi,to,Di,Xh,jg;const Gn=class Gn{constructor(e){k(this,Di);k(this,cn,null);k(this,Xi,!1);k(this,wi,null);k(this,Bu,null);k(this,Wi,null);k(this,As,null);k(this,Gu,!1);k(this,Qi,null);k(this,ls,null);k(this,zr,null);k(this,gl,null);k(this,Zi,!1);C(this,ls,e),C(this,Zi,e._uiManager.useNewAltTextFlow),m(Gn,to)||C(Gn,to,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Gn._l10n??(Gn._l10n=e)}async render(){const e=C(this,wi,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=C(this,Bu,document.createElement("span"));e.append(t),m(this,Zi)?(e.classList.add("new"),e.setAttribute("data-l10n-id",m(Gn,to).missing),t.setAttribute("data-l10n-id",m(Gn,to)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=m(this,ls)._uiManager._signal;e.addEventListener("contextmenu",Oi,{signal:n}),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const i=a=>{a.preventDefault(),m(this,ls)._uiManager.editAltText(m(this,ls)),m(this,Zi)&&m(this,ls)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:m(this,Di,Xh)}})};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(C(this,Gu,!0),i(a))},{signal:n}),await M(this,Di,jg).call(this),e}finish(){m(this,wi)&&(m(this,wi).focus({focusVisible:m(this,Gu)}),C(this,Gu,!1))}isEmpty(){return m(this,Zi)?m(this,cn)===null:!m(this,cn)&&!m(this,Xi)}hasData(){return m(this,Zi)?m(this,cn)!==null||!!m(this,zr):this.isEmpty()}get guessedText(){return m(this,zr)}async setGuessedText(e){m(this,cn)===null&&(C(this,zr,e),C(this,gl,await Gn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),M(this,Di,jg).call(this))}toggleAltTextBadge(e=!1){var t;if(!m(this,Zi)||m(this,cn)){(t=m(this,Qi))==null||t.remove(),C(this,Qi,null);return}if(!m(this,Qi)){const n=C(this,Qi,document.createElement("div"));n.className="noAltTextBadge",m(this,ls).div.append(n)}m(this,Qi).classList.toggle("hidden",!e)}serialize(e){let t=m(this,cn);return!e&&m(this,zr)===t&&(t=m(this,gl)),{altText:t,decorative:m(this,Xi),guessedText:m(this,zr),textWithDisclaimer:m(this,gl)}}get data(){return{altText:m(this,cn),decorative:m(this,Xi)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:i,cancel:a=!1}){n&&(C(this,zr,n),C(this,gl,i)),!(m(this,cn)===e&&m(this,Xi)===t)&&(a||(C(this,cn,e),C(this,Xi,t)),M(this,Di,jg).call(this))}toggle(e=!1){m(this,wi)&&(!e&&m(this,As)&&(clearTimeout(m(this,As)),C(this,As,null)),m(this,wi).disabled=!e)}shown(){m(this,ls)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:m(this,Di,Xh)}})}destroy(){var e,t;(e=m(this,wi))==null||e.remove(),C(this,wi,null),C(this,Bu,null),C(this,Wi,null),(t=m(this,Qi))==null||t.remove(),C(this,Qi,null)}};cn=new WeakMap,Xi=new WeakMap,wi=new WeakMap,Bu=new WeakMap,Wi=new WeakMap,As=new WeakMap,Gu=new WeakMap,Qi=new WeakMap,ls=new WeakMap,zr=new WeakMap,gl=new WeakMap,Zi=new WeakMap,to=new WeakMap,Di=new WeakSet,Xh=function(){return m(this,cn)&&"added"||m(this,cn)===null&&this.guessedText&&"review"||"missing"},jg=async function(){var i,a,l;const e=m(this,wi);if(!e)return;if(m(this,Zi)){if(e.classList.toggle("done",!!m(this,cn)),e.setAttribute("data-l10n-id",m(Gn,to)[m(this,Di,Xh)]),(i=m(this,Bu))==null||i.setAttribute("data-l10n-id",m(Gn,to)[`${m(this,Di,Xh)}-label`]),!m(this,cn)){(a=m(this,Wi))==null||a.remove();return}}else{if(!m(this,cn)&&!m(this,Xi)){e.classList.remove("done"),(l=m(this,Wi))==null||l.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=m(this,Wi);if(!t){C(this,Wi,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${m(this,ls).id}`;const c=100,d=m(this,ls)._uiManager._signal;d.addEventListener("abort",()=>{clearTimeout(m(this,As)),C(this,As,null)},{once:!0}),e.addEventListener("mouseenter",()=>{C(this,As,setTimeout(()=>{C(this,As,null),m(this,Wi).classList.add("show"),m(this,ls)._reportTelemetry({action:"alt_text_tooltip"})},c))},{signal:d}),e.addEventListener("mouseleave",()=>{var h;m(this,As)&&(clearTimeout(m(this,As)),C(this,As,null)),(h=m(this,Wi))==null||h.classList.remove("show")},{signal:d})}m(this,Xi)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=m(this,cn)),t.parentNode||e.append(t);const n=m(this,ls).getImageForAltText();n==null||n.setAttribute("aria-describedby",t.id)},k(Gn,to,null),Me(Gn,"_l10n",null);let _0=Gn;var jf,yl,Hf,Bf,Gf,qf,Vf,qu,jr,vl,no,ha,kR,MR,O_;const Rw=class Rw{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:a=null,onPinchEnd:l=null,signal:c}){k(this,ha);k(this,jf);k(this,yl,!1);k(this,Hf,null);k(this,Bf);k(this,Gf);k(this,qf);k(this,Vf);k(this,qu);k(this,jr,null);k(this,vl);k(this,no,null);C(this,jf,e),C(this,Hf,n),C(this,Bf,t),C(this,Gf,i),C(this,qf,a),C(this,Vf,l),C(this,vl,new AbortController),C(this,qu,AbortSignal.any([c,m(this,vl).signal])),e.addEventListener("touchstart",M(this,ha,kR).bind(this),{passive:!1,signal:m(this,qu)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Ye(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=m(this,vl))==null||e.abort(),C(this,vl,null)}};jf=new WeakMap,yl=new WeakMap,Hf=new WeakMap,Bf=new WeakMap,Gf=new WeakMap,qf=new WeakMap,Vf=new WeakMap,qu=new WeakMap,jr=new WeakMap,vl=new WeakMap,no=new WeakMap,ha=new WeakSet,kR=function(e){var i,a,l;if((i=m(this,Bf))!=null&&i.call(this)||e.touches.length<2)return;if(!m(this,no)){C(this,no,new AbortController);const c=AbortSignal.any([m(this,qu),m(this,no).signal]),d=m(this,jf),h={signal:c,passive:!1};d.addEventListener("touchmove",M(this,ha,MR).bind(this),h),d.addEventListener("touchend",M(this,ha,O_).bind(this),h),d.addEventListener("touchcancel",M(this,ha,O_).bind(this),h),(a=m(this,Gf))==null||a.call(this)}if(zs(e),e.touches.length!==2||(l=m(this,Hf))!=null&&l.call(this)){C(this,jr,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),C(this,jr,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},MR=function(e){var L;if(!m(this,jr)||e.touches.length!==2)return;let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:i,screenY:a}=t,{screenX:l,screenY:c}=n,d=m(this,jr),{touch0X:h,touch0Y:p,touch1X:v,touch1Y:x}=d,S=v-h,A=x-p,E=l-i,N=c-a,R=Math.hypot(E,N)||1,D=Math.hypot(S,A)||1;if(!m(this,yl)&&Math.abs(D-R)<=Rw.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=i,d.touch0Y=a,d.touch1X=l,d.touch1Y=c,e.preventDefault(),!m(this,yl)){C(this,yl,!0);return}const P=[(i+l)/2,(a+c)/2];(L=m(this,qf))==null||L.call(this,P,D,R)},O_=function(e){var t;m(this,no).abort(),C(this,no,null),(t=m(this,Vf))==null||t.call(this),m(this,jr)&&(e.preventDefault(),C(this,jr,null),C(this,yl,!1))};let x0=Rw;var bl,Si,At,Vu,so,$f,_l,Sn,xl,Hr,io,Yf,wl,Es,Kf,Sl,Br,er,$u,Yu,si,Al,Jf,U0,Ie,U_,Xf,F_,Hg,IR,DR,z_,Bg,j_,PR,LR,OR,H_,UR,B_,FR,zR,jR,G_,Wh;const Ve=class Ve{constructor(e){k(this,Ie);k(this,bl,null);k(this,Si,null);k(this,At,null);k(this,Vu,!1);k(this,so,null);k(this,$f,"");k(this,_l,!1);k(this,Sn,null);k(this,xl,null);k(this,Hr,null);k(this,io,null);k(this,Yf,"");k(this,wl,!1);k(this,Es,null);k(this,Kf,!1);k(this,Sl,!1);k(this,Br,!1);k(this,er,null);k(this,$u,0);k(this,Yu,0);k(this,si,null);k(this,Al,null);Me(this,"_editToolbar",null);Me(this,"_initialOptions",Object.create(null));Me(this,"_initialData",null);Me(this,"_isVisible",!0);Me(this,"_uiManager",null);Me(this,"_focusEventsAllowed",!0);k(this,Jf,!1);k(this,U0,Ve._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[a,l];const[c,d]=this.parentDimensions;this.x=e.x/c,this.y=e.y/d,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Ve.prototype._resizeWithKeyboard,t=hc.TRANSLATE_SMALL,n=hc.TRANSLATE_BIG;return Ye(this,"_resizerKeyboardManager",new Zp([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Ve.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Ye(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new e4({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Ve._l10n??(Ve._l10n=e),Ve._l10nResizer||(Ve._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Ve._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Ve._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){vt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return m(this,Jf)}set _isDraggable(e){var t;C(this,Jf,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=m(this,U0)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):M(this,Ie,Wh).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(m(this,wl)?C(this,wl,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[a,l]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/a,this.y=(t+i)/l,this.fixAndSetPosition()}translate(e,t){M(this,Ie,U_).call(this,this.parentDimensions,e,t)}translateInPage(e,t){m(this,Es)||C(this,Es,[this.x,this.y,this.width,this.height]),M(this,Ie,U_).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){m(this,Es)||C(this,Es,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[i,a]}=this;if(this.x+=e/i,this.y+=t/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:v,y:x}=this.div.getBoundingClientRect();this.parent.findNewParent(this,v,x)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[d,h]=this.getBaseTranslation();l+=d,c+=h;const{style:p}=n;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!m(this,Es)&&(m(this,Es)[0]!==this.x||m(this,Es)[1]!==this.y)}get _hasBeenResized(){return!!m(this,Es)&&(m(this,Es)[2]!==this.width||m(this,Es)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Ve,i=n/e,a=n/t;switch(this.rotation){case 90:return[-i,a];case 180:return[i,a];case 270:return[i,-a];default:return[-i,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,i]}=this;let{x:a,y:l,width:c,height:d}=this;if(c*=n,d*=i,a*=n,l*=i,this._mustFixPosition)switch(e){case 0:a=Math.max(0,Math.min(n-c,a)),l=Math.max(0,Math.min(i-d,l));break;case 90:a=Math.max(0,Math.min(n-d,a)),l=Math.min(i,Math.max(c,l));break;case 180:a=Math.min(n,Math.max(c,a)),l=Math.min(i,Math.max(d,l));break;case 270:a=Math.min(n,Math.max(d,a)),l=Math.max(0,Math.min(i-c,l));break}this.x=a/=n,this.y=l/=i;const[h,p]=this.getBaseTranslation();a+=h,l+=p,t.left=`${(100*a).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return M(n=Ve,Xf,F_).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return M(n=Ve,Xf,F_).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,i]=this.parentDimensions,{style:a}=this.div;a.width=`${(100*e/n).toFixed(2)}%`,m(this,_l)||(a.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,i=n.endsWith("%"),a=!m(this,_l)&&t.endsWith("%");if(i&&a)return;const[l,c]=this.parentDimensions;i||(e.width=`${(100*parseFloat(n)/l).toFixed(2)}%`),!m(this,_l)&&!a&&(e.height=`${(100*parseFloat(t)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=m(this,At))==null||e.finish()}async addEditToolbar(){return this._editToolbar||m(this,Sl)?this._editToolbar:(this._editToolbar=new T_(this),this.div.append(this._editToolbar.render()),m(this,At)&&await this._editToolbar.addAltText(m(this,At)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=m(this,At))==null||e.destroy())}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){m(this,At)||(_0.initialize(Ve._l10n),C(this,At,new _0(this)),m(this,bl)&&(m(this,At).data=m(this,bl),C(this,bl,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=m(this,At))==null?void 0:e.data}set altTextData(e){m(this,At)&&(m(this,At).data=e)}get guessedAltText(){var e;return(e=m(this,At))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=m(this,At))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=m(this,At))==null?void 0:t.serialize(e)}hasAltText(){return!!m(this,At)&&!m(this,At).isEmpty()}hasAltTextData(){var e;return((e=m(this,At))==null?void 0:e.hasData())??!1}render(){var a;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=m(this,Vu)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),M(this,Ie,B_).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[n,i]=this.getInitialTranslation();return this.translate(n,i),b0(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(m(this,Al)||C(this,Al,new x0({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:M(this,Ie,PR).bind(this),onPinching:M(this,Ie,LR).bind(this),onPinchEnd:M(this,Ie,OR).bind(this),signal:this._uiManager._signal}))),(a=this._uiManager._editorUndoBar)==null||a.hide(),this.div}pointerdown(e){const{isMac:t}=Kn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(C(this,wl,!0),this._isDraggable){M(this,Ie,UR).call(this,e);return}M(this,Ie,H_).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){m(this,er)&&clearTimeout(m(this,er)),C(this,er,setTimeout(()=>{var e;C(this,er,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const i=this.parentScale,[a,l]=this.pageDimensions,[c,d]=this.pageTranslation,h=e/i,p=t/i,v=this.x*a,x=this.y*l,S=this.width*a,A=this.height*l;switch(n){case 0:return[v+h+c,l-x-p-A+d,v+h+S+c,l-x-p+d];case 90:return[v+p+c,l-x+h+d,v+p+A+c,l-x+h+S+d];case 180:return[v-h-S+c,l-x+p+d,v-h+c,l-x+p+A+d];case 270:return[v-p-A+c,l-x-h-S+d,v-p+c,l-x-h+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,a,l]=e,c=a-n,d=l-i;switch(this.rotation){case 0:return[n,t-l,c,d];case 90:return[n,t-i,d,c];case 180:return[a,t-i,c,d];case 270:return[a,t-l,d,c];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){C(this,Sl,!0)}disableEditMode(){C(this,Sl,!1)}isInEditMode(){return m(this,Sl)}shouldGetKeyboardEvents(){return m(this,Br)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:a,innerWidth:l}=window;return t<l&&i>0&&e<a&&n>0}rebuild(){M(this,Ie,B_).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){vt("An editor must be serializable")}static async deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});i.rotation=e.rotation,C(i,bl,e.accessibilityData);const[a,l]=i.pageDimensions,[c,d,h,p]=i.getRectInCurrentCoords(e.rect,l);return i.x=c/a,i.y=d/l,i.width=h/a,i.height=p/l,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=m(this,io))==null||e.abort(),C(this,io,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),m(this,er)&&(clearTimeout(m(this,er)),C(this,er,null)),M(this,Ie,Wh).call(this),this.removeEditToolbar(),m(this,si)){for(const n of m(this,si).values())clearTimeout(n);C(this,si,null)}this.parent=null,(t=m(this,Al))==null||t.destroy(),C(this,Al,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(M(this,Ie,IR).call(this),m(this,Sn).classList.remove("hidden"),b0(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),C(this,Hr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=m(this,Sn).children;if(!m(this,Si)){C(this,Si,Array.from(t));const l=M(this,Ie,FR).bind(this),c=M(this,Ie,zR).bind(this),d=this._uiManager._signal;for(const h of m(this,Si)){const p=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",l,{signal:d}),h.addEventListener("blur",c,{signal:d}),h.addEventListener("focus",M(this,Ie,jR).bind(this,p),{signal:d}),h.setAttribute("data-l10n-id",Ve._l10nResizer[p])}}const n=m(this,Si)[0];let i=0;for(const l of t){if(l===n)break;i++}const a=(360-this.rotation+this.parentRotation)%360/90*(m(this,Si).length/4);if(a!==i){if(a<i)for(let c=0;c<i-a;c++)m(this,Sn).append(m(this,Sn).firstChild);else if(a>i)for(let c=0;c<a-i;c++)m(this,Sn).firstChild.before(m(this,Sn).lastChild);let l=0;for(const c of t){const h=m(this,Si)[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Ve._l10nResizer[h])}}M(this,Ie,G_).call(this,0),C(this,Br,!0),m(this,Sn).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){m(this,Br)&&M(this,Ie,j_).call(this,m(this,Yf),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){M(this,Ie,Wh).call(this),this.div.focus()}select(){var e,t,n;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,a;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((a=this._editToolbar)==null||a.show())});return}(t=this._editToolbar)==null||t.show(),(n=m(this,At))==null||n.toggleAltTextBadge(!1)}unselect(){var e,t,n,i,a;(e=m(this,Sn))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(a=m(this,At))==null||a.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return m(this,Kf)}set isEditing(e){C(this,Kf,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){C(this,_l,!0);const n=e/t,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){m(this,si)||C(this,si,new Map);const{action:n}=e;let i=m(this,si).get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),m(this,si).delete(n),m(this,si).size===0&&C(this,si,null)},Ve._telemetryTimeout),m(this,si).set(n,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),C(this,Vu,!1)}disable(){this.div&&(this.div.tabIndex=-1),C(this,Vu,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};bl=new WeakMap,Si=new WeakMap,At=new WeakMap,Vu=new WeakMap,so=new WeakMap,$f=new WeakMap,_l=new WeakMap,Sn=new WeakMap,xl=new WeakMap,Hr=new WeakMap,io=new WeakMap,Yf=new WeakMap,wl=new WeakMap,Es=new WeakMap,Kf=new WeakMap,Sl=new WeakMap,Br=new WeakMap,er=new WeakMap,$u=new WeakMap,Yu=new WeakMap,si=new WeakMap,Al=new WeakMap,Jf=new WeakMap,U0=new WeakMap,Ie=new WeakSet,U_=function([e,t],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Xf=new WeakSet,F_=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Hg=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},IR=function(){if(m(this,Sn))return;C(this,Sn,document.createElement("div")),m(this,Sn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const i=document.createElement("div");m(this,Sn).append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",M(this,Ie,DR).bind(this,n),{signal:t}),i.addEventListener("contextmenu",Oi,{signal:t}),i.tabIndex=-1}this.div.prepend(m(this,Sn))},DR=function(e,t){var p;t.preventDefault();const{isMac:n}=Kn.platform;if(t.button!==0||t.ctrlKey&&n)return;(p=m(this,At))==null||p.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,C(this,xl,[t.screenX,t.screenY]);const a=new AbortController,l=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",M(this,Ie,j_).bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",zs,{passive:!1,signal:l}),window.addEventListener("contextmenu",Oi,{signal:l}),C(this,Hr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const c=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const h=()=>{var v;a.abort(),this.parent.togglePointerEvents(!0),(v=m(this,At))==null||v.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=c,this.div.style.cursor=d,M(this,Ie,Bg).call(this)};window.addEventListener("pointerup",h,{signal:l}),window.addEventListener("blur",h,{signal:l})},z_=function(e,t,n,i){this.width=n,this.height=i,this.x=e,this.y=t;const[a,l]=this.parentDimensions;this.setDims(a*n,l*i),this.fixAndSetPosition(),this._onResized()},Bg=function(){if(!m(this,Hr))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=m(this,Hr);C(this,Hr,null);const a=this.x,l=this.y,c=this.width,d=this.height;a===e&&l===t&&c===n&&d===i||this.addCommands({cmd:M(this,Ie,z_).bind(this,a,l,c,d),undo:M(this,Ie,z_).bind(this,e,t,n,i),mustExec:!0})},j_=function(e,t){const[n,i]=this.parentDimensions,a=this.x,l=this.y,c=this.width,d=this.height,h=Ve.MIN_SIZE/n,p=Ve.MIN_SIZE/i,v=M(this,Ie,Hg).call(this,this.rotation),x=(j,X)=>[v[0]*j+v[2]*X,v[1]*j+v[3]*X],S=M(this,Ie,Hg).call(this,360-this.rotation),A=(j,X)=>[S[0]*j+S[2]*X,S[1]*j+S[3]*X];let E,N,R=!1,D=!1;switch(e){case"topLeft":R=!0,E=(j,X)=>[0,0],N=(j,X)=>[j,X];break;case"topMiddle":E=(j,X)=>[j/2,0],N=(j,X)=>[j/2,X];break;case"topRight":R=!0,E=(j,X)=>[j,0],N=(j,X)=>[0,X];break;case"middleRight":D=!0,E=(j,X)=>[j,X/2],N=(j,X)=>[0,X/2];break;case"bottomRight":R=!0,E=(j,X)=>[j,X],N=(j,X)=>[0,0];break;case"bottomMiddle":E=(j,X)=>[j/2,X],N=(j,X)=>[j/2,0];break;case"bottomLeft":R=!0,E=(j,X)=>[0,X],N=(j,X)=>[j,0];break;case"middleLeft":D=!0,E=(j,X)=>[0,X/2],N=(j,X)=>[j,X/2];break}const P=E(c,d),L=N(c,d);let H=x(...L);const z=Ve._round(a+H[0]),U=Ve._round(l+H[1]);let J=1,K=1,ie,oe;if(t.fromKeyboard)({deltaX:ie,deltaY:oe}=t);else{const{screenX:j,screenY:X}=t,[me,ee]=m(this,xl);[ie,oe]=this.screenToPageTranslation(j-me,X-ee),m(this,xl)[0]=j,m(this,xl)[1]=X}if([ie,oe]=A(ie/n,oe/i),R){const j=Math.hypot(c,d);J=K=Math.max(Math.min(Math.hypot(L[0]-P[0]-ie,L[1]-P[1]-oe)/j,1/c,1/d),h/c,p/d)}else D?J=Math.max(h,Math.min(1,Math.abs(L[0]-P[0]-ie)))/c:K=Math.max(p,Math.min(1,Math.abs(L[1]-P[1]-oe)))/d;const ne=Ve._round(c*J),ve=Ve._round(d*K);H=x(...N(ne,ve));const de=z-H[0],Re=U-H[1];m(this,Es)||C(this,Es,[this.x,this.y,this.width,this.height]),this.width=ne,this.height=ve,this.x=de,this.y=Re,this.setDims(n*ne,i*ve),this.fixAndSetPosition(),this._onResizing()},PR=function(){var e;C(this,Hr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=m(this,At))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},LR=function(e,t,n){let a=.7*(n/t)+1-.7;if(a===1)return;const l=M(this,Ie,Hg).call(this,this.rotation),c=(z,U)=>[l[0]*z+l[2]*U,l[1]*z+l[3]*U],[d,h]=this.parentDimensions,p=this.x,v=this.y,x=this.width,S=this.height,A=Ve.MIN_SIZE/d,E=Ve.MIN_SIZE/h;a=Math.max(Math.min(a,1/x,1/S),A/x,E/S);const N=Ve._round(x*a),R=Ve._round(S*a);if(N===x&&R===S)return;m(this,Es)||C(this,Es,[p,v,x,S]);const D=c(x/2,S/2),P=Ve._round(p+D[0]),L=Ve._round(v+D[1]),H=c(N/2,R/2);this.x=P-H[0],this.y=L-H[1],this.width=N,this.height=R,this.setDims(d*N,h*R),this.fixAndSetPosition(),this._onResizing()},OR=function(){var e;(e=m(this,At))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),M(this,Ie,Bg).call(this)},H_=function(e){const{isMac:t}=Kn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},UR=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,a=this._uiManager.combinedSignal(i),l={capture:!0,passive:!1,signal:a},c=h=>{i.abort(),C(this,so,null),C(this,wl,!1),this._uiManager.endDragSession()||M(this,Ie,H_).call(this,h),n&&this._onStopDragging()};t&&(C(this,$u,e.clientX),C(this,Yu,e.clientY),C(this,so,e.pointerId),C(this,$f,e.pointerType),window.addEventListener("pointermove",h=>{n||(n=!0,this._onStartDragging());const{clientX:p,clientY:v,pointerId:x}=h;if(x!==m(this,so)){zs(h);return}const[S,A]=this.screenToPageTranslation(p-m(this,$u),v-m(this,Yu));C(this,$u,p),C(this,Yu,v),this._uiManager.dragSelectedEditors(S,A)},l),window.addEventListener("touchmove",zs,l),window.addEventListener("pointerdown",h=>{h.pointerType===m(this,$f)&&(m(this,Al)||h.isPrimary)&&c(h),zs(h)},l));const d=h=>{if(!m(this,so)||m(this,so)===h.pointerId){c(h);return}zs(h)};window.addEventListener("pointerup",d,{signal:a}),window.addEventListener("blur",d,{signal:a})},B_=function(){if(m(this,io)||!this.div)return;C(this,io,new AbortController);const e=this._uiManager.combinedSignal(m(this,io));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},FR=function(e){Ve._resizerKeyboardManager.exec(this,e)},zR=function(e){var t;m(this,Br)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==m(this,Sn)&&M(this,Ie,Wh).call(this)},jR=function(e){C(this,Yf,m(this,Br)?e:"")},G_=function(e){if(m(this,Si))for(const t of m(this,Si))t.tabIndex=e},Wh=function(){C(this,Br,!1),M(this,Ie,G_).call(this,-1),M(this,Ie,Bg).call(this)},k(Ve,Xf),Me(Ve,"_l10n",null),Me(Ve,"_l10nResizer",null),Me(Ve,"_borderLineWidth",-1),Me(Ve,"_colorManager",new R_),Me(Ve,"_zIndex",1),Me(Ve,"_telemetryTimeout",1e3);let Dt=Ve;class e4 extends Dt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const TT=3285377520,ei=4294901760,qi=65535;class HR{constructor(e){this.h1=e?e&4294967295:TT,this.h2=e?e&4294967295:TT}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let E=0,N=e.length;E<N;E++){const R=e.charCodeAt(E);R<=255?t[n++]=R:(t[n++]=R>>>8,t[n++]=R&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,a=n-i*4,l=new Uint32Array(t.buffer,0,i);let c=0,d=0,h=this.h1,p=this.h2;const v=3432918353,x=461845907,S=v&qi,A=x&qi;for(let E=0;E<i;E++)E&1?(c=l[E],c=c*v&ei|c*S&qi,c=c<<15|c>>>17,c=c*x&ei|c*A&qi,h^=c,h=h<<13|h>>>19,h=h*5+3864292196):(d=l[E],d=d*v&ei|d*S&qi,d=d<<15|d>>>17,d=d*x&ei|d*A&qi,p^=d,p=p<<13|p>>>19,p=p*5+3864292196);switch(c=0,a){case 3:c^=t[i*4+2]<<16;case 2:c^=t[i*4+1]<<8;case 1:c^=t[i*4],c=c*v&ei|c*S&qi,c=c<<15|c>>>17,c=c*x&ei|c*A&qi,i&1?h^=c:p^=c}this.h1=h,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ei|e*36045&qi,t=t*4283543511&ei|((t<<16|e>>>16)*2950163797&ei)>>>16,e^=t>>>1,e=e*444984403&ei|e*60499&qi,t=t*3301882366&ei|((t<<16|e>>>16)*3120437893&ei)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const q_=Object.freeze({map:null,hash:"",transfer:void 0});var El,Tl,un,F0,BR;class pw{constructor(){k(this,F0);k(this,El,!1);k(this,Tl,null);k(this,un,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=m(this,un).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return m(this,un).get(e)}remove(e){if(m(this,un).delete(e),m(this,un).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of m(this,un).values())if(t instanceof Dt)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=m(this,un).get(e);let i=!1;if(n!==void 0)for(const[a,l]of Object.entries(t))n[a]!==l&&(i=!0,n[a]=l);else i=!0,m(this,un).set(e,t);i&&M(this,F0,BR).call(this),t instanceof Dt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return m(this,un).has(e)}getAll(){return m(this,un).size>0?lw(m(this,un)):null}setAll(e){for(const[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return m(this,un).size}resetModified(){m(this,El)&&(C(this,El,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new GR(this)}get serializable(){if(m(this,un).size===0)return q_;const e=new Map,t=new HR,n=[],i=Object.create(null);let a=!1;for(const[l,c]of m(this,un)){const d=c instanceof Dt?c.serialize(!1,i):c;d&&(e.set(l,d),t.update(`${l}:${JSON.stringify(d)}`),a||(a=!!d.bitmap))}if(a)for(const l of e.values())l.bitmap&&n.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:q_}get editorStats(){let e=null;const t=new Map;for(const n of m(this,un).values()){if(!(n instanceof Dt))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:a}=i;t.has(a)||t.set(a,Object.getPrototypeOf(n).constructor),e||(e=Object.create(null));const l=e[a]||(e[a]=new Map);for(const[c,d]of Object.entries(i)){if(c==="type")continue;let h=l.get(c);h||(h=new Map,l.set(c,h));const p=h.get(d)??0;h.set(d,p+1)}}for(const[n,i]of t)e[n]=i.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){C(this,Tl,null)}get modifiedIds(){if(m(this,Tl))return m(this,Tl);const e=[];for(const t of m(this,un).values())!(t instanceof Dt)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return C(this,Tl,{ids:new Set(e),hash:e.join(",")})}}El=new WeakMap,Tl=new WeakMap,un=new WeakMap,F0=new WeakSet,BR=function(){m(this,El)||(C(this,El,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Wf;class GR extends pw{constructor(t){super();k(this,Wf);const{map:n,hash:i,transfer:a}=t.serializable,l=structuredClone(n,a?{transfer:a}:null);C(this,Wf,{map:l,hash:i,transfer:a})}get print(){vt("Should not call PrintAnnotationStorage.print")}get serializable(){return m(this,Wf)}get modifiedIds(){return Ye(this,"modifiedIds",{ids:new Set,hash:""})}}Wf=new WeakMap;var Ku;class t4{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){k(this,Ku,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),m(this,Ku).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||m(this,Ku).has(e.loadedName))){if(Jt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:a}=e,l=new FontFace(n,i,a);this.addNativeFontFace(l);try{await l.load(),m(this,Ku).add(n),t==null||t(e)}catch{qe(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}vt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw qe(`Failed to load font '${n.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Ye(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Fn||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Ye(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Jt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const a=n.shift();setTimeout(a.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:t,callback:e};return n.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ye(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(L,H){return L.charCodeAt(H)<<24|L.charCodeAt(H+1)<<16|L.charCodeAt(H+2)<<8|L.charCodeAt(H+3)&255}function i(L,H,z,U){const J=L.substring(0,H),K=L.substring(H+z);return J+U+K}let a,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const d=c.getContext("2d");let h=0;function p(L,H){if(++h>30){qe("Load test font never loaded."),H();return}if(d.font="30px "+L,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){H();return}setTimeout(p.bind(null,L,H))}const v=`lt${Date.now()}${this.loadTestFontId++}`;let x=this._loadTestFont;x=i(x,976,v.length,v);const A=16,E=1482184792;let N=n(x,A);for(a=0,l=v.length-3;a<l;a+=4)N=N-E+n(v,a)|0;a<v.length&&(N=N-E+n(v+"XXX",a)|0),x=i(x,A,4,j5(N));const R=`url(data:font/opentype;base64,${btoa(x)});`,D=`@font-face {font-family:"${v}";src:${R}}`;this.insertRule(D);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const L of[e.loadedName,v]){const H=this._document.createElement("span");H.textContent="Hi",H.style.fontFamily=L,P.append(H)}this._document.body.append(P),p(v,()=>{P.remove(),t.complete()})}}Ku=new WeakMap;class n4{constructor(e,{disableFontFace:t=!1,fontExtraProperties:n=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const a in e)this[a]=e[a];this.disableFontFace=t===!0,this.fontExtraProperties=n===!0,this._inspectFont=i}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${$5(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let i;try{i=e.get(n)}catch(l){qe(`getPathGenerator - ignoring character: "${l}".`)}const a=new Path2D(i||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=a}}const Ag={DATA:1,ERROR:2},Yt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function CT(){}function as(s){if(s instanceof Eo||s instanceof S_||s instanceof wf||s instanceof ST||s instanceof v0||s instanceof Wb)return s;switch(s instanceof Error||typeof s=="object"&&s!==null||vt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),s.name){case"AbortException":return new Eo(s.message);case"InvalidPDFException":return new S_(s.message);case"MissingPDFException":return new wf(s.message);case"PasswordException":return new ST(s.message,s.code);case"UnexpectedResponseException":return new v0(s.message,s.status);case"UnknownErrorException":return new Wb(s.message,s.details)}return new Wb(s.message,s.toString())}var Ju,di,qR,VR,$R,Gg;class Qh{constructor(e,t,n){k(this,di);k(this,Ju,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",M(this,di,qR).bind(this),{signal:m(this,Ju).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const i=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[i]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(l){a.reject(l)}return a.promise}sendWithStream(e,t,n,i){const a=this.streamId++,l=this.sourceName,c=this.targetName,d=this.comObj;return new ReadableStream({start:h=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:h,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:l,targetName:c,action:e,streamId:a,data:t,desiredSize:h.desiredSize},i),p.promise},pull:h=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,d.postMessage({sourceName:l,targetName:c,stream:Yt.PULL,streamId:a,desiredSize:h.desiredSize}),p.promise},cancel:h=>{Jt(h instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,d.postMessage({sourceName:l,targetName:c,stream:Yt.CANCEL,streamId:a,reason:as(h)}),p.promise}},n)}destroy(){var e;(e=m(this,Ju))==null||e.abort(),C(this,Ju,null)}}Ju=new WeakMap,di=new WeakSet,qR=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){M(this,di,$R).call(this,e);return}if(e.callback){const n=e.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===Ag.DATA)i.resolve(e.data);else if(e.callback===Ag.ERROR)i.reject(as(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,i=e.sourceName,a=this.comObj;Promise.try(t,e.data).then(function(l){a.postMessage({sourceName:n,targetName:i,callback:Ag.DATA,callbackId:e.callbackId,data:l})},function(l){a.postMessage({sourceName:n,targetName:i,callback:Ag.ERROR,callbackId:e.callbackId,reason:as(l)})});return}if(e.streamId){M(this,di,VR).call(this,e);return}t(e.data)},VR=function(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,a=this.comObj,l=this,c=this.actionHandler[e.action],d={enqueue(h,p=1,v){if(this.isCancelled)return;const x=this.desiredSize;this.desiredSize-=p,x>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:i,stream:Yt.ENQUEUE,streamId:t,chunk:h},v)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:Yt.CLOSE,streamId:t}),delete l.streamSinks[t])},error(h){Jt(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:Yt.ERROR,streamId:t,reason:as(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[t]=d,Promise.try(c,e.data,d).then(function(){a.postMessage({sourceName:n,targetName:i,stream:Yt.START_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:i,stream:Yt.START_COMPLETE,streamId:t,reason:as(h)})})},$R=function(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,a=this.comObj,l=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case Yt.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(as(e.reason));break;case Yt.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(as(e.reason));break;case Yt.PULL:if(!c){a.postMessage({sourceName:n,targetName:i,stream:Yt.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||CT).then(function(){a.postMessage({sourceName:n,targetName:i,stream:Yt.PULL_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:i,stream:Yt.PULL_COMPLETE,streamId:t,reason:as(h)})});break;case Yt.ENQUEUE:if(Jt(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case Yt.CLOSE:if(Jt(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),M(this,di,Gg).call(this,l,t);break;case Yt.ERROR:Jt(l,"error should have stream controller"),l.controller.error(as(e.reason)),M(this,di,Gg).call(this,l,t);break;case Yt.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(as(e.reason)),M(this,di,Gg).call(this,l,t);break;case Yt.CANCEL:if(!c)break;const d=as(e.reason);Promise.try(c.onCancel||CT,d).then(function(){a.postMessage({sourceName:n,targetName:i,stream:Yt.CANCEL_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:i,stream:Yt.CANCEL_COMPLETE,streamId:t,reason:as(h)})}),c.sinkCapability.reject(d),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Gg=async function(e,t){var n,i,a;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(i=e.pullCall)==null?void 0:i.promise,(a=e.cancelCall)==null?void 0:a.promise]),delete this.streamControllers[t]};var Qf;class YR{constructor({enableHWA:e=!1}){k(this,Qf,!1);C(this,Qf,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!m(this,Qf)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){vt("Abstract method `_createCanvas` called.")}}Qf=new WeakMap;class s4 extends YR{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class KR{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){vt("Abstract method `_fetch` called.")}}class JR extends KR{async _fetch(e){const t=await oy(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):ay(t)}}class XR{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,a){return"none"}destroy(e=!1){}}var Cl,Xu,Gr,qr,Dn,Nl,Rl,ge,kn,Zh,gu,qg,yu,WR,V_,vu,ef,tf,$_,nf;class i4 extends XR{constructor({docId:t,ownerDocument:n=globalThis.document}){super();k(this,ge);k(this,Cl);k(this,Xu);k(this,Gr);k(this,qr);k(this,Dn);k(this,Nl);k(this,Rl,0);C(this,qr,t),C(this,Dn,n)}addFilter(t){if(!t)return"none";let n=m(this,ge,kn).get(t);if(n)return n;const[i,a,l]=M(this,ge,qg).call(this,t),c=t.length===1?i:`${i}${a}${l}`;if(n=m(this,ge,kn).get(c),n)return m(this,ge,kn).set(t,n),n;const d=`g_${m(this,qr)}_transfer_map_${Hn(this,Rl)._++}`,h=M(this,ge,yu).call(this,d);m(this,ge,kn).set(t,h),m(this,ge,kn).set(c,h);const p=M(this,ge,vu).call(this,d);return M(this,ge,tf).call(this,i,a,l,p),h}addHCMFilter(t,n){var A;const i=`${t}-${n}`,a="base";let l=m(this,ge,Zh).get(a);if((l==null?void 0:l.key)===i||(l?((A=l.filter)==null||A.remove(),l.key=i,l.url="none",l.filter=null):(l={key:i,url:"none",filter:null},m(this,ge,Zh).set(a,l)),!t||!n))return l.url;const c=M(this,ge,nf).call(this,t);t=Te.makeHexColor(...c);const d=M(this,ge,nf).call(this,n);if(n=Te.makeHexColor(...d),m(this,ge,gu).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return l.url;const h=new Array(256);for(let E=0;E<=255;E++){const N=E/255;h[E]=N<=.03928?N/12.92:((N+.055)/1.055)**2.4}const p=h.join(","),v=`g_${m(this,qr)}_hcm_filter`,x=l.filter=M(this,ge,vu).call(this,v);M(this,ge,tf).call(this,p,p,p,x),M(this,ge,V_).call(this,x);const S=(E,N)=>{const R=c[E]/255,D=d[E]/255,P=new Array(N+1);for(let L=0;L<=N;L++)P[L]=R+L/N*(D-R);return P.join(",")};return M(this,ge,tf).call(this,S(0,5),S(1,5),S(2,5),x),l.url=M(this,ge,yu).call(this,v),l.url}addAlphaFilter(t){let n=m(this,ge,kn).get(t);if(n)return n;const[i]=M(this,ge,qg).call(this,[t]),a=`alpha_${i}`;if(n=m(this,ge,kn).get(a),n)return m(this,ge,kn).set(t,n),n;const l=`g_${m(this,qr)}_alpha_map_${Hn(this,Rl)._++}`,c=M(this,ge,yu).call(this,l);m(this,ge,kn).set(t,c),m(this,ge,kn).set(a,c);const d=M(this,ge,vu).call(this,l);return M(this,ge,$_).call(this,i,d),c}addLuminosityFilter(t){let n=m(this,ge,kn).get(t||"luminosity");if(n)return n;let i,a;if(t?([i]=M(this,ge,qg).call(this,[t]),a=`luminosity_${i}`):a="luminosity",n=m(this,ge,kn).get(a),n)return m(this,ge,kn).set(t,n),n;const l=`g_${m(this,qr)}_luminosity_map_${Hn(this,Rl)._++}`,c=M(this,ge,yu).call(this,l);m(this,ge,kn).set(t,c),m(this,ge,kn).set(a,c);const d=M(this,ge,vu).call(this,l);return M(this,ge,WR).call(this,d),t&&M(this,ge,$_).call(this,i,d),c}addHighlightHCMFilter(t,n,i,a,l){var D;const c=`${n}-${i}-${a}-${l}`;let d=m(this,ge,Zh).get(t);if((d==null?void 0:d.key)===c||(d?((D=d.filter)==null||D.remove(),d.key=c,d.url="none",d.filter=null):(d={key:c,url:"none",filter:null},m(this,ge,Zh).set(t,d)),!n||!i))return d.url;const[h,p]=[n,i].map(M(this,ge,nf).bind(this));let v=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),x=Math.round(.2126*p[0]+.7152*p[1]+.0722*p[2]),[S,A]=[a,l].map(M(this,ge,nf).bind(this));x<v&&([v,x,S,A]=[x,v,A,S]),m(this,ge,gu).style.color="";const E=(P,L,H)=>{const z=new Array(256),U=(x-v)/H,J=P/255,K=(L-P)/(255*H);let ie=0;for(let oe=0;oe<=H;oe++){const ne=Math.round(v+oe*U),ve=J+oe*K;for(let de=ie;de<=ne;de++)z[de]=ve;ie=ne+1}for(let oe=ie;oe<256;oe++)z[oe]=z[ie-1];return z.join(",")},N=`g_${m(this,qr)}_hcm_${t}_filter`,R=d.filter=M(this,ge,vu).call(this,N);return M(this,ge,V_).call(this,R),M(this,ge,tf).call(this,E(S[0],A[0],5),E(S[1],A[1],5),E(S[2],A[2],5),R),d.url=M(this,ge,yu).call(this,N),d.url}destroy(t=!1){var n,i,a,l;t&&((n=m(this,Nl))!=null&&n.size)||((i=m(this,Gr))==null||i.parentNode.parentNode.remove(),C(this,Gr,null),(a=m(this,Xu))==null||a.clear(),C(this,Xu,null),(l=m(this,Nl))==null||l.clear(),C(this,Nl,null),C(this,Rl,0))}}Cl=new WeakMap,Xu=new WeakMap,Gr=new WeakMap,qr=new WeakMap,Dn=new WeakMap,Nl=new WeakMap,Rl=new WeakMap,ge=new WeakSet,kn=function(){return m(this,Xu)||C(this,Xu,new Map)},Zh=function(){return m(this,Nl)||C(this,Nl,new Map)},gu=function(){if(!m(this,Gr)){const t=m(this,Dn).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const i=m(this,Dn).createElementNS(kr,"svg");i.setAttribute("width",0),i.setAttribute("height",0),C(this,Gr,m(this,Dn).createElementNS(kr,"defs")),t.append(i),i.append(m(this,Gr)),m(this,Dn).body.append(t)}return m(this,Gr)},qg=function(t){if(t.length===1){const h=t[0],p=new Array(256);for(let x=0;x<256;x++)p[x]=h[x]/255;const v=p.join(",");return[v,v,v]}const[n,i,a]=t,l=new Array(256),c=new Array(256),d=new Array(256);for(let h=0;h<256;h++)l[h]=n[h]/255,c[h]=i[h]/255,d[h]=a[h]/255;return[l.join(","),c.join(","),d.join(",")]},yu=function(t){if(m(this,Cl)===void 0){C(this,Cl,"");const n=m(this,Dn).URL;n!==m(this,Dn).baseURI&&(ly(n)?qe('#createUrl: ignore "data:"-URL for performance reasons.'):C(this,Cl,n.split("#",1)[0]))}return`url(${m(this,Cl)}#${t})`},WR=function(t){const n=m(this,Dn).createElementNS(kr,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},V_=function(t){const n=m(this,Dn).createElementNS(kr,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},vu=function(t){const n=m(this,Dn).createElementNS(kr,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),m(this,ge,gu).append(n),n},ef=function(t,n,i){const a=m(this,Dn).createElementNS(kr,n);a.setAttribute("type","discrete"),a.setAttribute("tableValues",i),t.append(a)},tf=function(t,n,i,a){const l=m(this,Dn).createElementNS(kr,"feComponentTransfer");a.append(l),M(this,ge,ef).call(this,l,"feFuncR",t),M(this,ge,ef).call(this,l,"feFuncG",n),M(this,ge,ef).call(this,l,"feFuncB",i)},$_=function(t,n){const i=m(this,Dn).createElementNS(kr,"feComponentTransfer");n.append(i),M(this,ge,ef).call(this,i,"feFuncA",t)},nf=function(t){return m(this,ge,gu).style.color=t,fw(getComputedStyle(m(this,ge,gu)).getPropertyValue("color"))};class QR{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){vt("Abstract method `_fetch` called.")}}class ZR extends QR{async _fetch(e){const t=await oy(e,"arraybuffer");return new Uint8Array(t)}}Fn&&qe("Please use the `legacy` build in Node.js environments.");async function e2(s){const t=await process.getBuiltinModule("fs").promises.readFile(s);return new Uint8Array(t)}class r4 extends XR{}class a4 extends YR{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class o4 extends KR{async _fetch(e){return e2(e)}}class l4 extends QR{async _fetch(e){return e2(e)}}const Un={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Y_(s,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,n),s.clip(i)}class mw{getPattern(){vt("Abstract method `getPattern` called.")}}class c4 extends mw{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,i){let a;if(i===Un.STROKE||i===Un.FILL){const l=t.current.getClippedPathBoundingBox(i,Ct(e))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,d=Math.ceil(l[3]-l[1])||1,h=t.cachedCanvases.getCanvas("pattern",c,d),p=h.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),n=Te.transform(n,[1,0,0,1,l[0],l[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),Y_(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=e.createPattern(h.canvas,"no-repeat");const v=new DOMMatrix(n);a.setTransform(v)}else Y_(e,this._bbox),a=this._createGradient(e);return a}}function e_(s,e,t,n,i,a,l,c){const d=e.coords,h=e.colors,p=s.data,v=s.width*4;let x;d[t+1]>d[n+1]&&(x=t,t=n,n=x,x=a,a=l,l=x),d[n+1]>d[i+1]&&(x=n,n=i,i=x,x=l,l=c,c=x),d[t+1]>d[n+1]&&(x=t,t=n,n=x,x=a,a=l,l=x);const S=(d[t]+e.offsetX)*e.scaleX,A=(d[t+1]+e.offsetY)*e.scaleY,E=(d[n]+e.offsetX)*e.scaleX,N=(d[n+1]+e.offsetY)*e.scaleY,R=(d[i]+e.offsetX)*e.scaleX,D=(d[i+1]+e.offsetY)*e.scaleY;if(A>=D)return;const P=h[a],L=h[a+1],H=h[a+2],z=h[l],U=h[l+1],J=h[l+2],K=h[c],ie=h[c+1],oe=h[c+2],ne=Math.round(A),ve=Math.round(D);let de,Re,j,X,me,ee,ue,O;for(let $=ne;$<=ve;$++){if($<N){const le=$<A?0:(A-$)/(A-N);de=S-(S-E)*le,Re=P-(P-z)*le,j=L-(L-U)*le,X=H-(H-J)*le}else{let le;$>D?le=1:N===D?le=0:le=(N-$)/(N-D),de=E-(E-R)*le,Re=z-(z-K)*le,j=U-(U-ie)*le,X=J-(J-oe)*le}let se;$<A?se=0:$>D?se=1:se=(A-$)/(A-D),me=S-(S-R)*se,ee=P-(P-K)*se,ue=L-(L-ie)*se,O=H-(H-oe)*se;const ce=Math.round(Math.min(de,me)),Ce=Math.round(Math.max(de,me));let re=v*$+ce*4;for(let le=ce;le<=Ce;le++)se=(de-le)/(de-me),se<0?se=0:se>1&&(se=1),p[re++]=Re-(Re-ee)*se|0,p[re++]=j-(j-ue)*se|0,p[re++]=X-(X-O)*se|0,p[re++]=255}}function u4(s,e,t){const n=e.coords,i=e.colors;let a,l;switch(e.type){case"lattice":const c=e.verticesPerRow,d=Math.floor(n.length/c)-1,h=c-1;for(a=0;a<d;a++){let p=a*c;for(let v=0;v<h;v++,p++)e_(s,t,n[p],n[p+1],n[p+c],i[p],i[p+1],i[p+c]),e_(s,t,n[p+c+1],n[p+1],n[p+c],i[p+c+1],i[p+1],i[p+c])}break;case"triangles":for(a=0,l=n.length;a<l;a+=3)e_(s,t,n[a],n[a+1],n[a+2],i[a],i[a+1],i[a+2]);break;default:throw new Error("illegal figure")}}class d4 extends mw{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-c,p=Math.ceil(this._bounds[3])-d,v=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),x=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),S=h/v,A=p/x,E={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-d,scaleX:1/S,scaleY:1/A},N=v+4,R=x+4,D=n.getCanvas("mesh",N,R),P=D.context,L=P.createImageData(v,x);if(t){const z=L.data;for(let U=0,J=z.length;U<J;U+=4)z[U]=t[0],z[U+1]=t[1],z[U+2]=t[2],z[U+3]=255}for(const z of this._figures)u4(L,z,E);return P.putImageData(L,2,2),{canvas:D.canvas,offsetX:c-2*S,offsetY:d-2*A,scaleX:S,scaleY:A}}getPattern(e,t,n,i){Y_(e,this._bbox);let a;if(i===Un.SHADING)a=Te.singularValueDecompose2dScale(Ct(e));else if(a=Te.singularValueDecompose2dScale(t.baseTransform),this.matrix){const c=Te.singularValueDecompose2dScale(this.matrix);a=[a[0]*c[0],a[1]*c[1]]}const l=this._createMeshCanvas(a,i===Un.SHADING?null:this._background,t.cachedCanvases);return i!==Un.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class h4 extends mw{getPattern(){return"hotpink"}}function f4(s){switch(s[0]){case"RadialAxial":return new c4(s);case"Mesh":return new d4(s);case"Dummy":return new h4}throw new Error(`Unknown IR type: ${s[0]}`)}const NT={COLORED:1,UNCOLORED:2},z0=class z0{constructor(e,t,n,i,a){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=n,this.canvasGraphicsFactory=i,this.baseTransform=a}createPatternCanvas(e){const{bbox:t,operatorList:n,paintType:i,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:d,ystep:h}=this;d=Math.abs(d),h=Math.abs(h),ry("TilingType: "+a);const p=t[0],v=t[1],x=t[2],S=t[3],A=x-p,E=S-v,N=Te.singularValueDecompose2dScale(this.matrix),R=Te.singularValueDecompose2dScale(this.baseTransform),D=N[0]*R[0],P=N[1]*R[1];let L=A,H=E,z=!1,U=!1;const J=Math.ceil(d*D),K=Math.ceil(h*P),ie=Math.ceil(A*D),oe=Math.ceil(E*P);J>=ie?L=d:z=!0,K>=oe?H=h:U=!0;const ne=this.getSizeAndScale(L,this.ctx.canvas.width,D),ve=this.getSizeAndScale(H,this.ctx.canvas.height,P),de=e.cachedCanvases.getCanvas("pattern",ne.size,ve.size),Re=de.context,j=c.createCanvasGraphics(Re);if(j.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(j,i,l),Re.translate(-ne.scale*p,-ve.scale*v),j.transform(ne.scale,0,0,ve.scale,0,0),Re.save(),this.clipBbox(j,p,v,x,S),j.baseTransform=Ct(j.ctx),j.executeOperatorList(n),j.endDrawing(),Re.restore(),z||U){const X=de.canvas;z&&(L=d),U&&(H=h);const me=this.getSizeAndScale(L,this.ctx.canvas.width,D),ee=this.getSizeAndScale(H,this.ctx.canvas.height,P),ue=me.size,O=ee.size,$=e.cachedCanvases.getCanvas("pattern-workaround",ue,O),se=$.context,ce=z?Math.floor(A/d):0,Ce=U?Math.floor(E/h):0;for(let re=0;re<=ce;re++)for(let le=0;le<=Ce;le++)se.drawImage(X,ue*re,O*le,ue,O,0,0,ue,O);return{canvas:$.canvas,scaleX:me.scale,scaleY:ee.scale,offsetX:p,offsetY:v}}return{canvas:de.canvas,scaleX:ne.scale,scaleY:ve.scale,offsetX:p,offsetY:v}}getSizeAndScale(e,t,n){const i=Math.max(z0.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*n);return a>=i?a=i:n=a/e,{scale:n,size:a}}clipBbox(e,t,n,i,a){const l=i-t,c=a-n;e.ctx.rect(t,n,l,c),e.current.updateRectMinMax(Ct(e.ctx),[t,n,i,a]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const i=e.ctx,a=e.current;switch(t){case NT.COLORED:const l=this.ctx;i.fillStyle=l.fillStyle,i.strokeStyle=l.strokeStyle,a.fillColor=l.fillStyle,a.strokeColor=l.strokeStyle;break;case NT.UNCOLORED:const c=Te.makeHexColor(n[0],n[1],n[2]);i.fillStyle=c,i.strokeStyle=c,a.fillColor=c,a.strokeColor=c;break;default:throw new z5(`Unsupported paint type: ${t}`)}}getPattern(e,t,n,i){let a=n;i!==Un.SHADING&&(a=Te.transform(a,t.baseTransform),this.matrix&&(a=Te.transform(a,this.matrix)));const l=this.createPatternCanvas(t);let c=new DOMMatrix(a);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const d=e.createPattern(l.canvas,"repeat");return d.setTransform(c),d}};Me(z0,"MAX_PATTERN_SIZE",3e3);let K_=z0;function p4({src:s,srcPos:e=0,dest:t,width:n,height:i,nonBlackColor:a=4294967295,inverseDecode:l=!1}){const c=Kn.isLittleEndian?4278190080:255,[d,h]=l?[a,c]:[c,a],p=n>>3,v=n&7,x=s.length;t=new Uint32Array(t.buffer);let S=0;for(let A=0;A<i;A++){for(const N=e+p;e<N;e++){const R=e<x?s[e]:255;t[S++]=R&128?h:d,t[S++]=R&64?h:d,t[S++]=R&32?h:d,t[S++]=R&16?h:d,t[S++]=R&8?h:d,t[S++]=R&4?h:d,t[S++]=R&2?h:d,t[S++]=R&1?h:d}if(v===0)continue;const E=e<x?s[e++]:255;for(let N=0;N<v;N++)t[S++]=E&1<<7-N?h:d}return{srcPos:e,destPos:S}}const RT=16,kT=100,m4=15,MT=10,IT=1e3,ds=16;function g4(s,e){if(s._removeMirroring)throw new Error("Context is already forwarding operations.");s.__originalSave=s.save,s.__originalRestore=s.restore,s.__originalRotate=s.rotate,s.__originalScale=s.scale,s.__originalTranslate=s.translate,s.__originalTransform=s.transform,s.__originalSetTransform=s.setTransform,s.__originalResetTransform=s.resetTransform,s.__originalClip=s.clip,s.__originalMoveTo=s.moveTo,s.__originalLineTo=s.lineTo,s.__originalBezierCurveTo=s.bezierCurveTo,s.__originalRect=s.rect,s.__originalClosePath=s.closePath,s.__originalBeginPath=s.beginPath,s._removeMirroring=()=>{s.save=s.__originalSave,s.restore=s.__originalRestore,s.rotate=s.__originalRotate,s.scale=s.__originalScale,s.translate=s.__originalTranslate,s.transform=s.__originalTransform,s.setTransform=s.__originalSetTransform,s.resetTransform=s.__originalResetTransform,s.clip=s.__originalClip,s.moveTo=s.__originalMoveTo,s.lineTo=s.__originalLineTo,s.bezierCurveTo=s.__originalBezierCurveTo,s.rect=s.__originalRect,s.closePath=s.__originalClosePath,s.beginPath=s.__originalBeginPath,delete s._removeMirroring},s.save=function(){e.save(),this.__originalSave()},s.restore=function(){e.restore(),this.__originalRestore()},s.translate=function(n,i){e.translate(n,i),this.__originalTranslate(n,i)},s.scale=function(n,i){e.scale(n,i),this.__originalScale(n,i)},s.transform=function(n,i,a,l,c,d){e.transform(n,i,a,l,c,d),this.__originalTransform(n,i,a,l,c,d)},s.setTransform=function(n,i,a,l,c,d){e.setTransform(n,i,a,l,c,d),this.__originalSetTransform(n,i,a,l,c,d)},s.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},s.rotate=function(n){e.rotate(n),this.__originalRotate(n)},s.clip=function(n){e.clip(n),this.__originalClip(n)},s.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},s.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},s.bezierCurveTo=function(t,n,i,a,l,c){e.bezierCurveTo(t,n,i,a,l,c),this.__originalBezierCurveTo(t,n,i,a,l,c)},s.rect=function(t,n,i,a){e.rect(t,n,i,a),this.__originalRect(t,n,i,a)},s.closePath=function(){e.closePath(),this.__originalClosePath()},s.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class y4{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Eg(s,e,t,n,i,a,l,c,d,h){const[p,v,x,S,A,E]=Ct(s);if(v===0&&x===0){const D=l*p+A,P=Math.round(D),L=c*S+E,H=Math.round(L),z=(l+d)*p+A,U=Math.abs(Math.round(z)-P)||1,J=(c+h)*S+E,K=Math.abs(Math.round(J)-H)||1;return s.setTransform(Math.sign(p),0,0,Math.sign(S),P,H),s.drawImage(e,t,n,i,a,0,0,U,K),s.setTransform(p,v,x,S,A,E),[U,K]}if(p===0&&S===0){const D=c*x+A,P=Math.round(D),L=l*v+E,H=Math.round(L),z=(c+h)*x+A,U=Math.abs(Math.round(z)-P)||1,J=(l+d)*v+E,K=Math.abs(Math.round(J)-H)||1;return s.setTransform(0,Math.sign(v),Math.sign(x),0,P,H),s.drawImage(e,t,n,i,a,0,0,K,U),s.setTransform(p,v,x,S,A,E),[K,U]}s.drawImage(e,t,n,i,a,l,c,d,h);const N=Math.hypot(p,v),R=Math.hypot(x,S);return[N*d,R*h]}function v4(s){const{width:e,height:t}=s;if(e>IT||t>IT)return null;const n=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),a=e+1;let l=new Uint8Array(a*(t+1)),c,d,h;const p=e+7&-8;let v=new Uint8Array(p*t),x=0;for(const R of s.data){let D=128;for(;D>0;)v[x++]=R&D?0:255,D>>=1}let S=0;for(x=0,v[x]!==0&&(l[0]=1,++S),d=1;d<e;d++)v[x]!==v[x+1]&&(l[d]=v[x]?2:1,++S),x++;for(v[x]!==0&&(l[d]=2,++S),c=1;c<t;c++){x=c*p,h=c*a,v[x-p]!==v[x]&&(l[h]=v[x]?1:8,++S);let R=(v[x]?4:0)+(v[x-p]?8:0);for(d=1;d<e;d++)R=(R>>2)+(v[x+1]?4:0)+(v[x-p+1]?8:0),i[R]&&(l[h+d]=i[R],++S),x++;if(v[x-p]!==v[x]&&(l[h+d]=v[x]?2:4,++S),S>n)return null}for(x=p*(t-1),h=c*a,v[x]!==0&&(l[h]=8,++S),d=1;d<e;d++)v[x]!==v[x+1]&&(l[h+d]=v[x]?4:8,++S),x++;if(v[x]!==0&&(l[h+d]=4,++S),S>n)return null;const A=new Int32Array([0,a,-1,0,-a,0,0,0,1]),E=new Path2D;for(c=0;S&&c<=t;c++){let R=c*a;const D=R+e;for(;R<D&&!l[R];)R++;if(R===D)continue;E.moveTo(R%a,c);const P=R;let L=l[R];do{const H=A[L];do R+=H;while(!l[R]);const z=l[R];z!==5&&z!==10?(L=z,l[R]=0):(L=z&51*L>>4,l[R]&=L>>2|L<<2),E.lineTo(R%a,R/a|0),l[R]||--S}while(P!==R);--c}return v=null,l=null,function(R){R.save(),R.scale(1/e,-1/t),R.translate(0,-t),R.fill(E),R.beginPath(),R.restore()}}class DT{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=uR,this.textMatrixScale=1,this.fontMatrix=w_,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Rn.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=Te.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){const n=Te.applyTransform(t,e),i=Te.applyTransform(t.slice(2),e),a=Te.applyTransform([t[0],t[3]],e),l=Te.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,n[0],i[0],a[0],l[0]),this.minY=Math.min(this.minY,n[1],i[1],a[1],l[1]),this.maxX=Math.max(this.maxX,n[0],i[0],a[0],l[0]),this.maxY=Math.max(this.maxY,n[1],i[1],a[1],l[1])}updateScalingPathMinMax(e,t){Te.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,i,a,l,c,d,h,p){const v=Te.bezierBoundingBox(t,n,i,a,l,c,d,h,p);p||this.updateRectMinMax(e,v)}getPathBoundingBox(e=Un.FILL,t=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(e===Un.STROKE){t||vt("Stroke bounding box must include transform.");const i=Te.singularValueDecompose2dScale(t),a=i[0]*this.lineWidth/2,l=i[1]*this.lineWidth/2;n[0]-=a,n[1]-=l,n[2]+=a,n[3]+=l}return n}updateClipFromPath(){const e=Te.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Un.FILL,t=null){return Te.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function PT(s,e){if(e instanceof ImageData){s.putImageData(e,0,0);return}const t=e.height,n=e.width,i=t%ds,a=(t-i)/ds,l=i===0?a:a+1,c=s.createImageData(n,ds);let d=0,h;const p=e.data,v=c.data;let x,S,A,E;if(e.kind===Pg.GRAYSCALE_1BPP){const N=p.byteLength,R=new Uint32Array(v.buffer,0,v.byteLength>>2),D=R.length,P=n+7>>3,L=4294967295,H=Kn.isLittleEndian?4278190080:255;for(x=0;x<l;x++){for(A=x<a?ds:i,h=0,S=0;S<A;S++){const z=N-d;let U=0;const J=z>P?n:z*8-7,K=J&-8;let ie=0,oe=0;for(;U<K;U+=8)oe=p[d++],R[h++]=oe&128?L:H,R[h++]=oe&64?L:H,R[h++]=oe&32?L:H,R[h++]=oe&16?L:H,R[h++]=oe&8?L:H,R[h++]=oe&4?L:H,R[h++]=oe&2?L:H,R[h++]=oe&1?L:H;for(;U<J;U++)ie===0&&(oe=p[d++],ie=128),R[h++]=oe&ie?L:H,ie>>=1}for(;h<D;)R[h++]=0;s.putImageData(c,0,x*ds)}}else if(e.kind===Pg.RGBA_32BPP){for(S=0,E=n*ds*4,x=0;x<a;x++)v.set(p.subarray(d,d+E)),d+=E,s.putImageData(c,0,S),S+=ds;x<l&&(E=n*i*4,v.set(p.subarray(d,d+E)),s.putImageData(c,0,S))}else if(e.kind===Pg.RGB_24BPP)for(A=ds,E=n*A,x=0;x<l;x++){for(x>=a&&(A=i,E=n*A),h=0,S=E;S--;)v[h++]=p[d++],v[h++]=p[d++],v[h++]=p[d++],v[h++]=255;s.putImageData(c,0,x*ds)}else throw new Error(`bad image kind: ${e.kind}`)}function LT(s,e){if(e.bitmap){s.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,i=t%ds,a=(t-i)/ds,l=i===0?a:a+1,c=s.createImageData(n,ds);let d=0;const h=e.data,p=c.data;for(let v=0;v<l;v++){const x=v<a?ds:i;({srcPos:d}=p4({src:h,srcPos:d,dest:p,width:n,height:x,nonBlackColor:0})),s.putImageData(c,0,v*ds)}}function Bh(s,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)s[n]!==void 0&&(e[n]=s[n]);s.setLineDash!==void 0&&(e.setLineDash(s.getLineDash()),e.lineDashOffset=s.lineDashOffset)}function Tg(s){if(s.strokeStyle=s.fillStyle="#000000",s.fillRule="nonzero",s.globalAlpha=1,s.lineWidth=1,s.lineCap="butt",s.lineJoin="miter",s.miterLimit=10,s.globalCompositeOperation="source-over",s.font="10px sans-serif",s.setLineDash!==void 0&&(s.setLineDash([]),s.lineDashOffset=0),!Fn){const{filter:e}=s;e!=="none"&&e!==""&&(s.filter="none")}}function OT(s,e){if(e)return!0;const t=Te.singularValueDecompose2dScale(s);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*To.PDF_TO_CSS_UNITS);return t[0]<=n&&t[1]<=n}const b4=["butt","round","square"],_4=["miter","round","bevel"],x4={},UT={};var Ui,J_,X_,W_;const kw=class kw{constructor(e,t,n,i,a,{optionalContentConfig:l,markedContentStack:c=null},d,h){k(this,Ui);this.ctx=e,this.current=new DT(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new y4(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:i=null}){const a=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,a,l),this.ctx.fillStyle=c,n){const d=this.cachedCanvases.getCanvas("transparent",a,l);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...Ct(this.compositeCtx))}this.ctx.save(),Tg(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ct(this.ctx)}executeOperatorList(e,t,n,i){const a=e.argsArray,l=e.fnArray;let c=t||0;const d=a.length;if(d===c)return c;const h=d-c>MT&&typeof n=="function",p=h?Date.now()+m4:0;let v=0;const x=this.commonObjs,S=this.objs;let A;for(;;){if(i!==void 0&&c===i.nextBreakPoint)return i.breakIt(c,n),c;if(A=l[c],A!==bi.dependency)this[A].apply(this,a[c]);else for(const E of a[c]){const N=E.startsWith("g_")?x:S;if(!N.has(E))return N.get(E,n),c}if(c++,c===d)return c;if(h&&++v>MT){if(Date.now()>p)return n(),c;v=0}}}endDrawing(){M(this,Ui,J_).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),M(this,Ui,X_).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,i=e.height??e.displayHeight;let a=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),c=n,d=i,h="prescale1",p,v;for(;a>2&&c>1||l>2&&d>1;){let x=c,S=d;a>2&&c>1&&(x=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),a/=c/x),l>2&&d>1&&(S=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,l/=d/S),p=this.cachedCanvases.getCanvas(h,x,S),v=p.context,v.clearRect(0,0,x,S),v.drawImage(e,0,0,c,d,0,0,x,S),e=p.canvas,c=x,d=S,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:d}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:i}=e,a=this.current.fillColor,l=this.current.patternFill,c=Ct(t);let d,h,p,v;if((e.bitmap||e.data)&&e.count>1){const J=e.bitmap||e.data.buffer;h=JSON.stringify(l?c:[c.slice(0,4),a]),d=this._cachedBitmapsMap.get(J),d||(d=new Map,this._cachedBitmapsMap.set(J,d));const K=d.get(h);if(K&&!l){const ie=Math.round(Math.min(c[0],c[2])+c[4]),oe=Math.round(Math.min(c[1],c[3])+c[5]);return{canvas:K,offsetX:ie,offsetY:oe}}p=K}p||(v=this.cachedCanvases.getCanvas("maskCanvas",n,i),LT(v.context,e));let x=Te.transform(c,[1/n,0,0,-1/i,0,0]);x=Te.transform(x,[1,0,0,1,0,-i]);const[S,A,E,N]=Te.getAxialAlignedBoundingBox([0,0,n,i],x),R=Math.round(E-S)||1,D=Math.round(N-A)||1,P=this.cachedCanvases.getCanvas("fillCanvas",R,D),L=P.context,H=S,z=A;L.translate(-H,-z),L.transform(...x),p||(p=this._scaleImage(v.canvas,Gi(L)),p=p.img,d&&l&&d.set(h,p)),L.imageSmoothingEnabled=OT(Ct(L),e.interpolate),Eg(L,p,0,0,p.width,p.height,0,0,n,i),L.globalCompositeOperation="source-in";const U=Te.transform(Gi(L),[1,0,0,1,-H,-z]);return L.fillStyle=l?a.getPattern(t,this,U,Un.FILL):a,L.fillRect(0,0,n,i),d&&!l&&(this.cachedCanvases.delete("fillCanvas"),d.set(h,P.canvas)),{canvas:P.canvas,offsetX:Math.round(H),offsetY:Math.round(z)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=b4[e]}setLineJoin(e){this.ctx.lineJoin=_4[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const a=this.ctx;a.setTransform(...Ct(this.suspendedCtx)),Bh(this.suspendedCtx,a),g4(a,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Bh(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){const a=i[0],l=i[1],c=i[2]-a,d=i[3]-l;c===0||d===0||(this.genericComposeSMask(t.context,n,c,d,t.subtype,t.backdrop,t.transferMap,a,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,a,l,c,d,h,p,v){let x=e.canvas,S=d-p,A=h-v;if(l){const N=Te.makeHexColor(...l);if(S<0||A<0||S+n>x.width||A+i>x.height){const R=this.cachedCanvases.getCanvas("maskExtension",n,i),D=R.context;D.drawImage(x,-S,-A),D.globalCompositeOperation="destination-atop",D.fillStyle=N,D.fillRect(0,0,n,i),D.globalCompositeOperation="source-over",x=R.canvas,S=A=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const R=new Path2D;R.rect(S,A,n,i),e.clip(R),e.globalCompositeOperation="destination-atop",e.fillStyle=N,e.fillRect(S,A,n,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),a==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):a==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const E=new Path2D;E.rect(d,h,n,i),t.clip(E),t.globalCompositeOperation="destination-in",t.drawImage(x,S,A,n,i,d,h,n,i),t.restore()}save(){this.inSMaskMode?(Bh(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Bh(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,i,a,l){this.ctx.transform(e,t,n,i,a,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){const i=this.ctx,a=this.current;let l=a.x,c=a.y,d,h;const p=Ct(i),v=p[0]===0&&p[3]===0||p[1]===0&&p[2]===0,x=v?n.slice(0):null;for(let S=0,A=0,E=e.length;S<E;S++)switch(e[S]|0){case bi.rectangle:l=t[A++],c=t[A++];const N=t[A++],R=t[A++],D=l+N,P=c+R;i.moveTo(l,c),N===0||R===0?i.lineTo(D,P):(i.lineTo(D,c),i.lineTo(D,P),i.lineTo(l,P)),v||a.updateRectMinMax(p,[l,c,D,P]),i.closePath();break;case bi.moveTo:l=t[A++],c=t[A++],i.moveTo(l,c),v||a.updatePathMinMax(p,l,c);break;case bi.lineTo:l=t[A++],c=t[A++],i.lineTo(l,c),v||a.updatePathMinMax(p,l,c);break;case bi.curveTo:d=l,h=c,l=t[A+4],c=t[A+5],i.bezierCurveTo(t[A],t[A+1],t[A+2],t[A+3],l,c),a.updateCurvePathMinMax(p,d,h,t[A],t[A+1],t[A+2],t[A+3],l,c,x),A+=6;break;case bi.curveTo2:d=l,h=c,i.bezierCurveTo(l,c,t[A],t[A+1],t[A+2],t[A+3]),a.updateCurvePathMinMax(p,d,h,l,c,t[A],t[A+1],t[A+2],t[A+3],x),l=t[A+2],c=t[A+3],A+=4;break;case bi.curveTo3:d=l,h=c,l=t[A+2],c=t[A+3],i.bezierCurveTo(t[A],t[A+1],l,c,l,c),a.updateCurvePathMinMax(p,d,h,t[A],t[A+1],l,c,l,c,x),A+=4;break;case bi.closePath:i.closePath();break}v&&a.updateScalingPathMinMax(p,x),a.setCurrentPoint(l,c)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&(n!=null&&n.getPattern)?(t.save(),t.strokeStyle=n.getPattern(t,this,Gi(t),Un.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,n=this.current.fillColor,i=this.current.patternFill;let a=!1;i&&(t.save(),t.fillStyle=n.getPattern(t,this,Gi(t),Un.FILL),a=!0);const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),a&&t.restore(),e&&this.consumePath(l)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=x4}eoClip(){this.pendingClip=UT}beginText(){this.current.textMatrix=uR,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const n=new Path2D,i=t.getTransform().invertSelf();for(const{transform:a,x:l,y:c,fontSize:d,path:h}of e)n.addPath(h,new DOMMatrix(a).preMultiplySelf(i).translate(l,c).scale(d,-d));t.clip(n),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var p;const n=this.commonObjs.get(e),i=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=n.fontMatrix||w_,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&qe("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const a=n.loadedName||"sans-serif",l=((p=n.systemFontInfo)==null?void 0:p.css)||`"${a}", ${n.fallbackName}`;let c="normal";n.black?c="900":n.bold&&(c="bold");const d=n.italic?"italic":"normal";let h=t;t<RT?h=RT:t>kT&&(h=kT),this.current.fontSizeScale=t/h,this.ctx.font=`${d} ${c} ${h}px ${l}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,i,a,l){this.current.textMatrix=[e,t,n,i,a,l],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,i,a){const l=this.ctx,c=this.current,d=c.font,h=c.textRenderingMode,p=c.fontSize/c.fontSizeScale,v=h&Rn.FILL_STROKE_MASK,x=!!(h&Rn.ADD_TO_PATH_FLAG),S=c.patternFill&&!d.missingFile,A=c.patternStroke&&!d.missingFile;let E;if((d.disableFontFace||x||S||A)&&(E=d.getPathGenerator(this.commonObjs,e)),d.disableFontFace||S||A){if(l.save(),l.translate(t,n),l.scale(p,-p),v===Rn.FILL||v===Rn.FILL_STROKE)if(i){const N=l.getTransform();l.setTransform(...i),l.fill(M(this,Ui,W_).call(this,E,N,i))}else l.fill(E);if(v===Rn.STROKE||v===Rn.FILL_STROKE)if(a){const N=l.getTransform();l.setTransform(...a),l.stroke(M(this,Ui,W_).call(this,E,N,a))}else l.lineWidth/=p,l.stroke(E);l.restore()}else(v===Rn.FILL||v===Rn.FILL_STROKE)&&l.fillText(e,t,n),(v===Rn.STROKE||v===Rn.FILL_STROKE)&&l.strokeText(e,t,n);x&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ct(l),x:t,y:n,fontSize:p,path:E})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return Ye(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const a=this.ctx,l=t.fontSizeScale,c=t.charSpacing,d=t.wordSpacing,h=t.fontDirection,p=t.textHScale*h,v=e.length,x=n.vertical,S=x?1:-1,A=n.defaultVMetrics,E=i*t.fontMatrix[0],N=t.textRenderingMode===Rn.FILL&&!n.disableFontFace&&!t.patternFill;a.save(),a.transform(...t.textMatrix),a.translate(t.x,t.y+t.textRise),h>0?a.scale(p,-1):a.scale(p,1);let R,D;if(t.patternFill){a.save();const U=t.fillColor.getPattern(a,this,Gi(a),Un.FILL);R=Ct(a),a.restore(),a.fillStyle=U}if(t.patternStroke){a.save();const U=t.strokeColor.getPattern(a,this,Gi(a),Un.STROKE);D=Ct(a),a.restore(),a.strokeStyle=U}let P=t.lineWidth;const L=t.textMatrixScale;if(L===0||P===0){const U=t.textRenderingMode&Rn.FILL_STROKE_MASK;(U===Rn.STROKE||U===Rn.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=L;if(l!==1&&(a.scale(l,l),P/=l),a.lineWidth=P,n.isInvalidPDFjsFont){const U=[];let J=0;for(const K of e)U.push(K.unicode),J+=K.width;a.fillText(U.join(""),0,0),t.x+=J*E*p,a.restore(),this.compose();return}let H=0,z;for(z=0;z<v;++z){const U=e[z];if(typeof U=="number"){H+=S*U*i/1e3;continue}let J=!1;const K=(U.isSpace?d:0)+c,ie=U.fontChar,oe=U.accent;let ne,ve,de=U.width;if(x){const j=U.vmetric||A,X=-(U.vmetric?j[1]:de*.5)*E,me=j[2]*E;de=j?-j[0]:de,ne=X/l,ve=(H+me)/l}else ne=H/l,ve=0;if(n.remeasure&&de>0){const j=a.measureText(ie).width*1e3/i*l;if(de<j&&this.isFontSubpixelAAEnabled){const X=de/j;J=!0,a.save(),a.scale(X,1),ne/=X}else de!==j&&(ne+=(de-j)/2e3*i/l)}if(this.contentVisible&&(U.isInFont||n.missingFile)){if(N&&!oe)a.fillText(ie,ne,ve);else if(this.paintChar(ie,ne,ve,R,D),oe){const j=ne+i*oe.offset.x/l,X=ve-i*oe.offset.y/l;this.paintChar(oe.fontChar,j,X,R,D)}}const Re=x?de*E-K*h:de*E+K*h;H+=Re,J&&a.restore()}x?t.y-=H:t.x+=H*p,a.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,i=n.font,a=n.fontSize,l=n.fontDirection,c=i.vertical?1:-1,d=n.charSpacing,h=n.wordSpacing,p=n.textHScale*l,v=n.fontMatrix||w_,x=e.length,S=n.textRenderingMode===Rn.INVISIBLE;let A,E,N,R;if(!(S||a===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(p,l),A=0;A<x;++A){if(E=e[A],typeof E=="number"){R=c*E*a/1e3,this.ctx.translate(R,0),n.x+=R*p;continue}const D=(E.isSpace?h:0)+d,P=i.charProcOperatorList[E.operatorListId];if(!P){qe(`Type3 character "${E.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=E,this.save(),t.scale(a,a),t.transform(...v),this.executeOperatorList(P),this.restore()),N=Te.applyTransform([E.width,0],v)[0]*a+D,t.translate(N,0),n.x+=N*p}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,i,a,l){this.ctx.rect(n,i,a-n,l-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const n=e[1],i=this.baseTransform||Ct(this.ctx),a={createCanvasGraphics:l=>new kw(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new K_(e,n,this.ctx,a,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){this.ctx.strokeStyle=this.current.strokeColor=Te.makeHexColor(e,t,n),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,n){this.ctx.fillStyle=this.current.fillColor=Te.makeHexColor(e,t,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=f4(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,Gi(t),Un.SHADING);const i=Gi(t);if(i){const{width:a,height:l}=t.canvas,[c,d,h,p]=Te.getAxialAlignedBoundingBox([0,0,a,l],i);this.ctx.fillRect(c,d,h-c,p-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){vt("Should not call beginInlineImage")}beginImageData(){vt("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Ct(this.ctx),t)){const n=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],n,i),this.current.updateRectMinMax(Ct(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||ry("TODO: Support non-isolated groups."),e.knockout&&qe("Knockout groups not supported.");const n=Ct(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=Te.getAxialAlignedBoundingBox(e.bbox,Ct(t));const a=[0,0,t.canvas.width,t.canvas.height];i=Te.intersect(i,a)||[0,0,0,0];const l=Math.floor(i[0]),c=Math.floor(i[1]),d=Math.max(Math.ceil(i[2])-l,1),h=Math.max(Math.ceil(i[3])-c,1);this.current.startNewPathAndClipBox([0,0,d,h]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(p,d,h),x=v.context;x.translate(-l,-c),x.transform(...n),e.smask?this.smaskStack.push({canvas:v.canvas,context:x,offsetX:l,offsetY:c,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(l,c),t.save()),Bh(t,x),this.ctx=x,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Ct(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const a=Te.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,n,i,a){if(M(this,Ui,J_).call(this),Tg(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const l=t[2]-t[0],c=t[3]-t[1];if(a&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=l,t[3]=c;const[d,h]=Te.singularValueDecompose2dScale(Ct(this.ctx)),{viewportScale:p}=this,v=Math.ceil(l*this.outputScaleX*p),x=Math.ceil(c*this.outputScaleY*p);this.annotationCanvas=this.canvasFactory.create(v,x);const{canvas:S,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(e,S),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(d,0,0,-h,0,c*h),Tg(this.ctx)}else Tg(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],l,c),this.ctx.clip(),this.ctx.beginPath()}this.current=new DT(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),M(this,Ui,X_).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const n=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=v4(e)),i.compiled)){i.compiled(n);return}const a=this._createMaskCanvas(e),l=a.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(l,a.offsetX,a.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,i=0,a,l){if(!this.contentVisible)return;e=this.getObject(e.data,e);const c=this.ctx;c.save();const d=Ct(c);c.transform(t,n,i,a,0,0);const h=this._createMaskCanvas(e);c.setTransform(1,0,0,1,h.offsetX-d[4],h.offsetY-d[5]);for(let p=0,v=l.length;p<v;p+=2){const x=Te.transform(d,[t,n,i,a,l[p],l[p+1]]),[S,A]=Te.applyTransform([0,0],x);c.drawImage(h.canvas,S,A)}c.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const a of e){const{data:l,width:c,height:d,transform:h}=a,p=this.cachedCanvases.getCanvas("maskCanvas",c,d),v=p.context;v.save();const x=this.getObject(l,a);LT(v,x),v.globalCompositeOperation="source-in",v.fillStyle=i?n.getPattern(v,this,Gi(t),Un.FILL):n,v.fillRect(0,0,c,d),v.restore(),t.save(),t.transform(...h),t.scale(1,-1),Eg(t,p.canvas,0,0,c,d,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){qe("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,i){if(!this.contentVisible)return;const a=this.getObject(e);if(!a){qe("Dependent image isn't ready yet");return}const l=a.width,c=a.height,d=[];for(let h=0,p=i.length;h<p;h+=2)d.push({transform:[t,0,0,n,i[h],i[h+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(a,d)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:i}=e,a=this.cachedCanvases.getCanvas("inlineImage",n,i),l=a.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",a.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,i=this.ctx;if(this.save(),!Fn){const{filter:c}=i;c!=="none"&&c!==""&&(i.filter="none")}i.scale(1/t,-1/n);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const d=this.cachedCanvases.getCanvas("inlineImage",t,n).context;PT(d,e),a=this.applyTransferMapsToCanvas(d)}const l=this._scaleImage(a,Gi(i));i.imageSmoothingEnabled=OT(Ct(i),e.interpolate),Eg(i,l.img,0,0,l.paintWidth,l.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const a=e.width,l=e.height,d=this.cachedCanvases.getCanvas("inlineImage",a,l).context;PT(d,e),i=this.applyTransferMapsToCanvas(d)}for(const a of t)n.save(),n.transform(...a.transform),n.scale(1,-1),Eg(n,i,a.x,a.y,a.w,a.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const n=this.ctx;this.pendingClip&&(t||(this.pendingClip===UT?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ct(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:a}=this.ctx.getTransform();let l,c;if(n===0&&i===0){const d=Math.abs(t),h=Math.abs(a);if(d===h)if(e===0)l=c=1/d;else{const p=d*e;l=c=p<1?1/p:1}else if(e===0)l=1/d,c=1/h;else{const p=d*e,v=h*e;l=p<1?1/p:1,c=v<1?1/v:1}}else{const d=Math.abs(t*a-n*i),h=Math.hypot(t,n),p=Math.hypot(i,a);if(e===0)l=p/d,c=h/d;else{const v=e*d;l=p>v?p/v:1,c=h>v?h/v:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:n}=this.current,[i,a]=this.getScaleForStroking();if(t.lineWidth=n||1,i===1&&a===1){t.stroke();return}const l=t.getLineDash();if(e&&t.save(),t.scale(i,a),l.length>0){const c=Math.max(i,a);t.setLineDash(l.map(d=>d/c)),t.lineDashOffset/=c}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Ui=new WeakSet,J_=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},X_=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},W_=function(e,t,n){const i=new Path2D;return i.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),i};let ku=kw;for(const s in bi)ku.prototype[s]!==void 0&&(ku.prototype[bi[s]]=ku.prototype[s]);var Zf,ep;class oa{static get workerPort(){return m(this,Zf)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");C(this,Zf,e)}static get workerSrc(){return m(this,ep)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");C(this,ep,e)}}Zf=new WeakMap,ep=new WeakMap,k(oa,Zf,null),k(oa,ep,"");var kl,tp;class w4{constructor({parsedData:e,rawData:t}){k(this,kl);k(this,tp);C(this,kl,e),C(this,tp,t)}getRaw(){return m(this,tp)}get(e){return m(this,kl).get(e)??null}getAll(){return lw(m(this,kl))}has(e){return m(this,kl).has(e)}}kl=new WeakMap,tp=new WeakMap;const bu=Symbol("INTERNAL");var np,sp,ip,Wu;class S4{constructor(e,{name:t,intent:n,usage:i,rbGroups:a}){k(this,np,!1);k(this,sp,!1);k(this,ip,!1);k(this,Wu,!0);C(this,np,!!(e&Ls.DISPLAY)),C(this,sp,!!(e&Ls.PRINT)),this.name=t,this.intent=n,this.usage=i,this.rbGroups=a}get visible(){if(m(this,ip))return m(this,Wu);if(!m(this,Wu))return!1;const{print:e,view:t}=this.usage;return m(this,np)?(t==null?void 0:t.viewState)!=="OFF":m(this,sp)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==bu&&vt("Internal method `_setVisible` called."),C(this,ip,n),C(this,Wu,t)}}np=new WeakMap,sp=new WeakMap,ip=new WeakMap,Wu=new WeakMap;var ro,dt,Qu,Zu,rp,Q_;class A4{constructor(e,t=Ls.DISPLAY){k(this,rp);k(this,ro,null);k(this,dt,new Map);k(this,Qu,null);k(this,Zu,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,C(this,Zu,e.order);for(const n of e.groups)m(this,dt).set(n.id,new S4(t,n));if(e.baseState==="OFF")for(const n of m(this,dt).values())n._setVisible(bu,!1);for(const n of e.on)m(this,dt).get(n)._setVisible(bu,!0);for(const n of e.off)m(this,dt).get(n)._setVisible(bu,!1);C(this,Qu,this.getHash())}}isVisible(e){if(m(this,dt).size===0)return!0;if(!e)return ry("Optional content group not defined."),!0;if(e.type==="OCG")return m(this,dt).has(e.id)?m(this,dt).get(e.id).visible:(qe(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return M(this,rp,Q_).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!m(this,dt).has(t))return qe(`Optional content group not found: ${t}`),!0;if(m(this,dt).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!m(this,dt).has(t))return qe(`Optional content group not found: ${t}`),!0;if(!m(this,dt).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!m(this,dt).has(t))return qe(`Optional content group not found: ${t}`),!0;if(!m(this,dt).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!m(this,dt).has(t))return qe(`Optional content group not found: ${t}`),!0;if(m(this,dt).get(t).visible)return!1}return!0}return qe(`Unknown optional content policy ${e.policy}.`),!0}return qe(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var a;const i=m(this,dt).get(e);if(!i){qe(`Optional content group not found: ${e}`);return}if(n&&t&&i.rbGroups.length)for(const l of i.rbGroups)for(const c of l)c!==e&&((a=m(this,dt).get(c))==null||a._setVisible(bu,!1,!0));i._setVisible(bu,!!t,!0),C(this,ro,null)}setOCGState({state:e,preserveRB:t}){let n;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const a=m(this,dt).get(i);if(a)switch(n){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!a.visible,t);break}}C(this,ro,null)}get hasInitialVisibility(){return m(this,Qu)===null||this.getHash()===m(this,Qu)}getOrder(){return m(this,dt).size?m(this,Zu)?m(this,Zu).slice():[...m(this,dt).keys()]:null}getGroups(){return m(this,dt).size>0?lw(m(this,dt)):null}getGroup(e){return m(this,dt).get(e)||null}getHash(){if(m(this,ro)!==null)return m(this,ro);const e=new HR;for(const[t,n]of m(this,dt))e.update(`${t}:${n.visible}`);return C(this,ro,e.hexdigest())}}ro=new WeakMap,dt=new WeakMap,Qu=new WeakMap,Zu=new WeakMap,rp=new WeakSet,Q_=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let i=1;i<t;i++){const a=e[i];let l;if(Array.isArray(a))l=M(this,rp,Q_).call(this,a);else if(m(this,dt).has(a))l=m(this,dt).get(a).visible;else return qe(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"};class E4{constructor(e,{disableRange:t=!1,disableStream:n=!1}){Jt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:a,progressiveDone:l,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,(a==null?void 0:a.length)>0){const d=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((d,h)=>{this._onReceiveData({begin:d,chunk:h})}),e.addProgressListener((d,h)=>{this._onProgress({loaded:d,total:h})}),e.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(a){return a._begin!==e?!1:(a._enqueue(n),!0)});Jt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,n,i,a;e.total===void 0?(n=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||n.call(t,{loaded:e.loaded}):(a=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||a.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Jt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new T4(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new C4(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class T4{constructor(e,t,n=!1,i=null){this._stream=e,this._done=n||!1,this._filename=dw(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class C4{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function N4(s){let e=!0,t=n("filename\\*","i").exec(s);if(t){t=t[1];let p=c(t);return p=unescape(p),p=d(p),p=h(p),a(p)}if(t=l(s),t){const p=h(t);return a(p)}if(t=n("filename","i").exec(s),t){t=t[1];let p=c(t);return p=h(p),a(p)}function n(p,v){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',v)}function i(p,v){if(p){if(!/^[\x00-\xFF]+$/.test(v))return v;try{const x=new TextDecoder(p,{fatal:!0}),S=ay(v);v=x.decode(S),e=!1}catch{}}return v}function a(p){return e&&/[\x80-\xff]/.test(p)&&(p=i("utf-8",p),e&&(p=i("iso-8859-1",p))),p}function l(p){const v=[];let x;const S=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(x=S.exec(p))!==null;){let[,E,N,R]=x;if(E=parseInt(E,10),E in v){if(E===0)break;continue}v[E]=[N,R]}const A=[];for(let E=0;E<v.length&&E in v;++E){let[N,R]=v[E];R=c(R),N&&(R=unescape(R),E===0&&(R=d(R))),A.push(R)}return A.join("")}function c(p){if(p.startsWith('"')){const v=p.slice(1).split('\\"');for(let x=0;x<v.length;++x){const S=v[x].indexOf('"');S!==-1&&(v[x]=v[x].slice(0,S),v.length=x+1),v[x]=v[x].replaceAll(/\\(.)/g,"$1")}p=v.join('"')}return p}function d(p){const v=p.indexOf("'");if(v===-1)return p;const x=p.slice(0,v),A=p.slice(v+1).replace(/^[^']*'/,"");return i(x,A)}function h(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(v,x,S,A){if(S==="q"||S==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(E,N){return String.fromCharCode(parseInt(N,16))}),i(x,A);try{A=atob(A)}catch{}return i(x,A)})}return""}function t2(s,e){const t=new Headers;if(!s||!e||typeof e!="object")return t;for(const n in e){const i=e[n];i!==void 0&&t.append(n,i)}return t}function cy(s){try{return new URL(s).origin}catch{}return null}function n2({responseHeaders:s,isHttp:e,rangeChunkSize:t,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(s.get("Content-Length"),10);return!Number.isInteger(a)||(i.suggestedLength=a,a<=2*t)||n||!e||s.get("Accept-Ranges")!=="bytes"||(s.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function s2(s){const e=s.get("Content-Disposition");if(e){let t=N4(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(dw(t))return t}return null}function uy(s,e){return s===404||s===0&&e.startsWith("file:")?new wf('Missing PDF "'+e+'".'):new v0(`Unexpected server response (${s}) while retrieving PDF "${e}".`,s)}function i2(s){return s===200||s===206}function r2(s,e,t){return{method:"GET",headers:s,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function a2(s){return s instanceof Uint8Array?s.buffer:s instanceof ArrayBuffer?s:(qe(`getArrayBuffer - unexpected data format: ${s}`),new Uint8Array(s).buffer)}class FT{constructor(e){Me(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=t2(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Jt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new R4(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new k4(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class R4{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),i=t.url;fetch(i,r2(n,this._withCredentials,this._abortController)).then(a=>{if(e._responseOrigin=cy(a.url),!i2(a.status))throw uy(a.status,i);this._reader=a.body.getReader(),this._headersCapability.resolve();const l=a.headers,{allowRangeRequests:c,suggestedLength:d}=n2({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=d||this._contentLength,this._filename=s2(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Eo("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:a2(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class k4{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const a=new Headers(e.headers);a.append("Range",`bytes=${t}-${n-1}`);const l=i.url;fetch(l,r2(a,this._withCredentials,this._abortController)).then(c=>{const d=cy(c.url);if(d!==e._responseOrigin)throw new Error(`Expected range response-origin "${d}" to match "${e._responseOrigin}".`);if(!i2(c.status))throw uy(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:a2(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const t_=200,n_=206;function M4(s){const e=s.response;return typeof e!="string"?e:ay(e).buffer}class I4{constructor({url:e,httpHeaders:t,withCredentials:n}){Me(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=t2(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[a,l]of this.headers)t.setRequestHeader(a,l);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=n_):i.expectedStatus=t_,t.responseType="arraybuffer",Jt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var i;const n=this.pendingRequests[e];n&&((i=n.onProgress)==null||i.call(n,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){n.onError(i.status);return}const a=i.status||t_;if(!(a===t_&&n.expectedStatus===n_)&&a!==n.expectedStatus){n.onError(i.status);return}const c=M4(i);if(a===n_){const d=i.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);h?n.onDone({begin:parseInt(h[1],10),chunk:c}):(qe('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class D4{constructor(e){this._source=e,this._manager=new I4(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Jt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new P4(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new L4(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class P4{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=cy(t.responseURL);const n=t.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[d,...h]=c.split(": ");return[d,h.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:l}=n2({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=s2(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=uy(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L4{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=cy((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=uy(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const O4=/^[a-z][a-z0-9\-+.]+:/i;function U4(s){if(O4.test(s))return new URL(s);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(s))}class F4{constructor(e){this.source=e,this.url=U4(e.url),Jt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Jt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new z4(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new j4(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class z4{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new wf(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Eo("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class j4{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const H4=1e5,rs=30,B4=.8;var xN,ao,cs,ap,op,Ml,Vr,lp,cp,Il,ed,td,oo,nd,up,sd,Dl,dp,hp,Pl,Ll,fp,lo,id,fa,o2,l2,Z_,js,Vg,ex,c2,u2;const en=class en{constructor({textContentSource:e,container:t,viewport:n}){k(this,fa);k(this,ao,Promise.withResolvers());k(this,cs,null);k(this,ap,!1);k(this,op,!!((xN=globalThis.FontInspector)!=null&&xN.enabled));k(this,Ml,null);k(this,Vr,null);k(this,lp,0);k(this,cp,0);k(this,Il,null);k(this,ed,null);k(this,td,0);k(this,oo,0);k(this,nd,Object.create(null));k(this,up,[]);k(this,sd,null);k(this,Dl,[]);k(this,dp,new WeakMap);k(this,hp,null);var d;if(e instanceof ReadableStream)C(this,sd,e);else if(typeof e=="object")C(this,sd,new ReadableStream({start(h){h.enqueue(e),h.close()}}));else throw new Error('No "textContentSource" parameter specified.');C(this,cs,C(this,ed,t)),C(this,oo,n.scale*(globalThis.devicePixelRatio||1)),C(this,td,n.rotation),C(this,Vr,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:a,pageX:l,pageY:c}=n.rawDims;C(this,hp,[1,0,0,-1,-l,c+a]),C(this,cp,i),C(this,lp,a),M(d=en,js,c2).call(d),dc(t,n),m(this,ao).promise.finally(()=>{m(en,id).delete(this),C(this,Vr,null),C(this,nd,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Kn.platform;return Ye(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{m(this,Il).read().then(({value:t,done:n})=>{if(n){m(this,ao).resolve();return}m(this,Ml)??C(this,Ml,t.lang),Object.assign(m(this,nd),t.styles),M(this,fa,o2).call(this,t.items),e()},m(this,ao).reject)};return C(this,Il,m(this,sd).getReader()),m(en,id).add(this),e(),m(this,ao).promise}update({viewport:e,onBefore:t=null}){var a;const n=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==m(this,td)&&(t==null||t(),C(this,td,i),dc(m(this,ed),{rotation:i})),n!==m(this,oo)){t==null||t(),C(this,oo,n);const l={div:null,properties:null,ctx:M(a=en,js,Vg).call(a,m(this,Ml))};for(const c of m(this,Dl))l.properties=m(this,dp).get(c),l.div=c,M(this,fa,Z_).call(this,l)}}cancel(){var t;const e=new Eo("TextLayer task cancelled.");(t=m(this,Il))==null||t.cancel(e).catch(()=>{}),C(this,Il,null),m(this,ao).reject(e)}get textDivs(){return m(this,Dl)}get textContentItemsStr(){return m(this,up)}static cleanup(){if(!(m(this,id).size>0)){m(this,Pl).clear();for(const{canvas:e}of m(this,Ll).values())e.remove();m(this,Ll).clear()}}};ao=new WeakMap,cs=new WeakMap,ap=new WeakMap,op=new WeakMap,Ml=new WeakMap,Vr=new WeakMap,lp=new WeakMap,cp=new WeakMap,Il=new WeakMap,ed=new WeakMap,td=new WeakMap,oo=new WeakMap,nd=new WeakMap,up=new WeakMap,sd=new WeakMap,Dl=new WeakMap,dp=new WeakMap,hp=new WeakMap,Pl=new WeakMap,Ll=new WeakMap,fp=new WeakMap,lo=new WeakMap,id=new WeakMap,fa=new WeakSet,o2=function(e){var i,a;if(m(this,ap))return;(a=m(this,Vr)).ctx??(a.ctx=M(i=en,js,Vg).call(i,m(this,Ml)));const t=m(this,Dl),n=m(this,up);for(const l of e){if(t.length>H4){qe("Ignoring additional textDivs for performance reasons."),C(this,ap,!0);return}if(l.str===void 0){if(l.type==="beginMarkedContentProps"||l.type==="beginMarkedContent"){const c=m(this,cs);C(this,cs,document.createElement("span")),m(this,cs).classList.add("markedContent"),l.id!==null&&m(this,cs).setAttribute("id",`${l.id}`),c.append(m(this,cs))}else l.type==="endMarkedContent"&&C(this,cs,m(this,cs).parentNode);continue}n.push(l.str),M(this,fa,l2).call(this,l)}},l2=function(e){var E;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};m(this,Dl).push(t);const i=Te.transform(m(this,hp),e.transform);let a=Math.atan2(i[1],i[0]);const l=m(this,nd)[e.fontName];l.vertical&&(a+=Math.PI/2);let c=m(this,op)&&l.fontSubstitution||l.fontFamily;c=en.fontFamilyMap.get(c)||c;const d=Math.hypot(i[2],i[3]),h=d*M(E=en,js,u2).call(E,c,m(this,Ml));let p,v;a===0?(p=i[4],v=i[5]-h):(p=i[4]+h*Math.sin(a),v=i[5]-h*Math.cos(a));const x="calc(var(--scale-factor)*",S=t.style;m(this,cs)===m(this,ed)?(S.left=`${(100*p/m(this,cp)).toFixed(2)}%`,S.top=`${(100*v/m(this,lp)).toFixed(2)}%`):(S.left=`${x}${p.toFixed(2)}px)`,S.top=`${x}${v.toFixed(2)}px)`),S.fontSize=`${x}${(m(en,lo)*d).toFixed(2)}px)`,S.fontFamily=c,n.fontSize=d,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,m(this,op)&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),a!==0&&(n.angle=a*(180/Math.PI));let A=!1;if(e.str.length>1)A=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const N=Math.abs(e.transform[0]),R=Math.abs(e.transform[3]);N!==R&&Math.max(N,R)/Math.min(N,R)>1.5&&(A=!0)}if(A&&(n.canvasWidth=l.vertical?e.height:e.width),m(this,dp).set(t,n),m(this,Vr).div=t,m(this,Vr).properties=n,M(this,fa,Z_).call(this,m(this,Vr)),n.hasText&&m(this,cs).append(t),n.hasEOL){const N=document.createElement("br");N.setAttribute("role","presentation"),m(this,cs).append(N)}},Z_=function(e){var c;const{div:t,properties:n,ctx:i}=e,{style:a}=t;let l="";if(m(en,lo)>1&&(l=`scale(${1/m(en,lo)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:d}=a,{canvasWidth:h,fontSize:p}=n;M(c=en,js,ex).call(c,i,p*m(this,oo),d);const{width:v}=i.measureText(t.textContent);v>0&&(l=`scaleX(${h*m(this,oo)/v}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(a.transform=l)},js=new WeakSet,Vg=function(e=null){let t=m(this,Ll).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),m(this,Ll).set(e,t),m(this,fp).set(t,{size:0,family:""})}return t},ex=function(e,t,n){const i=m(this,fp).get(e);t===i.size&&n===i.family||(e.font=`${t}px ${n}`,i.size=t,i.family=n)},c2=function(){if(m(this,lo)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),C(this,lo,e.getBoundingClientRect().height),e.remove()},u2=function(e,t){const n=m(this,Pl).get(e);if(n)return n;const i=M(this,js,Vg).call(this,t);i.canvas.width=i.canvas.height=rs,M(this,js,ex).call(this,i,rs,e);const a=i.measureText("");let l=a.fontBoundingBoxAscent,c=Math.abs(a.fontBoundingBoxDescent);if(l){const p=l/(l+c);return m(this,Pl).set(e,p),i.canvas.width=i.canvas.height=0,p}i.strokeStyle="red",i.clearRect(0,0,rs,rs),i.strokeText("g",0,0);let d=i.getImageData(0,0,rs,rs).data;c=0;for(let p=d.length-1-3;p>=0;p-=4)if(d[p]>0){c=Math.ceil(p/4/rs);break}i.clearRect(0,0,rs,rs),i.strokeText("A",0,rs),d=i.getImageData(0,0,rs,rs).data,l=0;for(let p=0,v=d.length;p<v;p+=4)if(d[p]>0){l=rs-Math.floor(p/4/rs);break}i.canvas.width=i.canvas.height=0;const h=l?l/(l+c):B4;return m(this,Pl).set(e,h),h},k(en,js),k(en,Pl,new Map),k(en,Ll,new Map),k(en,fp,new WeakMap),k(en,lo,null),k(en,id,new Set);let Sf=en;class Af{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function i(a){var d;if(!a)return;let l=null;const c=a.name;if(c==="#text")l=a.value;else if(Af.shouldBuildText(c))(d=a==null?void 0:a.attributes)!=null&&d.textContent?l=a.attributes.textContent:a.value&&(l=a.value);else return;if(l!==null&&t.push({str:l}),!!a.children)for(const h of a.children)i(h)}return i(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const G4=65536,q4=100,V4=5e3,$4=Fn?a4:s4,Y4=Fn?o4:JR,K4=Fn?r4:i4,J4=Fn?l4:ZR;function X4(s={}){typeof s=="string"||s instanceof URL?s={url:s}:(s instanceof ArrayBuffer||ArrayBuffer.isView(s))&&(s={data:s});const e=new tx,{docId:t}=e,n=s.url?W4(s.url):null,i=s.data?Q4(s.data):null,a=s.httpHeaders||null,l=s.withCredentials===!0,c=s.password??null,d=s.range instanceof d2?s.range:null,h=Number.isInteger(s.rangeChunkSize)&&s.rangeChunkSize>0?s.rangeChunkSize:G4;let p=s.worker instanceof Mu?s.worker:null;const v=s.verbosity,x=typeof s.docBaseUrl=="string"&&!ly(s.docBaseUrl)?s.docBaseUrl:null,S=typeof s.cMapUrl=="string"?s.cMapUrl:null,A=s.cMapPacked!==!1,E=s.CMapReaderFactory||Y4,N=typeof s.standardFontDataUrl=="string"?s.standardFontDataUrl:null,R=s.StandardFontDataFactory||J4,D=s.stopAtErrors!==!0,P=Number.isInteger(s.maxImageSize)&&s.maxImageSize>-1?s.maxImageSize:-1,L=s.isEvalSupported!==!1,H=typeof s.isOffscreenCanvasSupported=="boolean"?s.isOffscreenCanvasSupported:!Fn,z=typeof s.isImageDecoderSupported=="boolean"?s.isImageDecoderSupported:!Fn&&(Kn.platform.isFirefox||!globalThis.chrome),U=Number.isInteger(s.canvasMaxAreaInBytes)?s.canvasMaxAreaInBytes:-1,J=typeof s.disableFontFace=="boolean"?s.disableFontFace:Fn,K=s.fontExtraProperties===!0,ie=s.enableXfa===!0,oe=s.ownerDocument||globalThis.document,ne=s.disableRange===!0,ve=s.disableStream===!0,de=s.disableAutoFetch===!0,Re=s.pdfBug===!0,j=s.CanvasFactory||$4,X=s.FilterFactory||K4,me=s.enableHWA===!0,ee=d?d.length:s.length??NaN,ue=typeof s.useSystemFonts=="boolean"?s.useSystemFonts:!Fn&&!J,O=typeof s.useWorkerFetch=="boolean"?s.useWorkerFetch:E===JR&&R===ZR&&S&&N&&Kh(S,document.baseURI)&&Kh(N,document.baseURI),$=null;L5(v);const se={canvasFactory:new j({ownerDocument:oe,enableHWA:me}),filterFactory:new X({docId:t,ownerDocument:oe}),cMapReaderFactory:O?null:new E({baseUrl:S,isCompressed:A}),standardFontDataFactory:O?null:new R({baseUrl:N})};if(!p){const re={verbosity:v,port:oa.workerPort};p=re.port?Mu.fromPort(re):new Mu(re),e._worker=p}const ce={docId:t,apiVersion:"4.10.38",data:i,password:c,disableAutoFetch:de,rangeChunkSize:h,length:ee,docBaseUrl:x,enableXfa:ie,evaluatorOptions:{maxImageSize:P,disableFontFace:J,ignoreErrors:D,isEvalSupported:L,isOffscreenCanvasSupported:H,isImageDecoderSupported:z,canvasMaxAreaInBytes:U,fontExtraProperties:K,useSystemFonts:ue,cMapUrl:O?S:null,standardFontDataUrl:O?N:null}},Ce={disableFontFace:J,fontExtraProperties:K,ownerDocument:oe,pdfBug:Re,styleElement:$,loadingParams:{disableAutoFetch:de,enableXfa:ie}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const re=p.messageHandler.sendWithPromise("GetDocRequest",ce,i?[i.buffer]:null);let le;if(d)le=new E4(d,{disableRange:ne,disableStream:ve});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");let ze;if(Fn)if(Kh(n)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");ze=FT}else ze=F4;else ze=Kh(n)?FT:D4;le=new ze({url:n,length:ee,httpHeaders:a,withCredentials:l,rangeChunkSize:h,disableRange:ne,disableStream:ve})}return re.then(ze=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Le=new Qh(t,ze,p.port),Bt=new n3(Le,e,le,Ce,se);e._transport=Bt,Le.send("Ready",null)})}).catch(e._capability.reject),e}function W4(s){if(s instanceof URL)return s.href;try{return new URL(s,window.location).href}catch{if(Fn&&typeof s=="string")return s}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Q4(s){if(Fn&&typeof Buffer<"u"&&s instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength)return s;if(typeof s=="string")return ay(s);if(s instanceof ArrayBuffer||ArrayBuffer.isView(s)||typeof s=="object"&&!isNaN(s==null?void 0:s.length))return new Uint8Array(s);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function zT(s){return typeof s=="object"&&Number.isInteger(s==null?void 0:s.num)&&s.num>=0&&Number.isInteger(s==null?void 0:s.gen)&&s.gen>=0}var j0;const H0=class H0{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Hn(H0,j0)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,n,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(a){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,a}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};j0=new WeakMap,k(H0,j0,0);let tx=H0;class d2{constructor(e,t,n=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){vt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Z4{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ye(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var co,$r,li,_u,$g;class e3{constructor(e,t,n,i=!1){k(this,li);k(this,co,null);k(this,$r,!1);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new ET:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new h2,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:a=!1}={}){return new Qp({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:a})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ye(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:i=$a.ENABLE,transform:a=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:d=null,pageColors:h=null,printAnnotationStorage:p=null,isEditing:v=!1}){var L,H;(L=this._stats)==null||L.time("Overall");const x=this._transport.getRenderingIntent(n,i,p,v),{renderingIntent:S,cacheKey:A}=x;C(this,$r,!1),M(this,li,$g).call(this),c||(c=this._transport.getOptionalContentConfig(S));let E=this._intentStates.get(A);E||(E=Object.create(null),this._intentStates.set(A,E)),E.streamReaderCancelTimeout&&(clearTimeout(E.streamReaderCancelTimeout),E.streamReaderCancelTimeout=null);const N=!!(S&Ls.PRINT);E.displayReadyCapability||(E.displayReadyCapability=Promise.withResolvers(),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(H=this._stats)==null||H.time("Page Request"),this._pumpOperatorList(x));const R=z=>{var U;E.renderTasks.delete(D),(this._maybeCleanupAfterRender||N)&&C(this,$r,!0),M(this,li,_u).call(this,!N),z?(D.capability.reject(z),this._abortOperatorList({intentState:E,reason:z instanceof Error?z:new Error(z)})):D.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(U=globalThis.Stats)!=null&&U.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},D=new sx({callback:R,params:{canvasContext:e,viewport:t,transform:a,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:E.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!N,pdfBug:this._pdfBug,pageColors:h});(E.renderTasks||(E.renderTasks=new Set)).add(D);const P=D.task;return Promise.all([E.displayReadyCapability.promise,c]).then(([z,U])=>{var J;if(this.destroyed){R();return}if((J=this._stats)==null||J.time("Rendering"),!(U.renderingIntent&S))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");D.initializeGraphics({transparency:z,optionalContentConfig:U}),D.operatorListChanged()}).catch(R),P}getOperatorList({intent:e="display",annotationMode:t=$a.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){var h;function a(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(d))}const l=this._transport.getRenderingIntent(e,t,n,i,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let d;return c.opListReadCapability||(d=Object.create(null),d.operatorListChanged=a,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(d),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Af.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,i){function a(){l.read().then(function({value:d,done:h}){if(h){n(c);return}c.lang??(c.lang=d.lang),Object.assign(c.styles,d.styles),c.items.push(...d.items),a()},i)}const l=t.getReader(),c={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),C(this,$r,!1),M(this,li,$g).call(this),Promise.all(e)}cleanup(e=!1){C(this,$r,!0);const t=M(this,li,_u).call(this,!1);return e&&t&&this._stats&&(this._stats=new ET),t}_startRenderPage(e,t){var i,a;const n=this._intentStates.get(t);n&&((i=this._stats)==null||i.timeEnd("Page Request"),(a=n.displayReadyCapability)==null||a.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&M(this,li,_u).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:i}){const{map:a,transfer:l}=n,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:a,modifiedIds:i},l).getReader(),h=this._intentStates.get(t);h.streamReader=d;const p=()=>{d.read().then(({value:v,done:x})=>{if(x){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(v,h),p())},v=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const x of h.renderTasks)x.operatorListChanged();M(this,li,_u).call(this,!0)}if(h.displayReadyCapability)h.displayReadyCapability.reject(v);else if(h.opListReadCapability)h.opListReadCapability.reject(v);else throw v}})};p()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof uw){let i=q4;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Eo(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,a]of this._intentStates)if(a===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}co=new WeakMap,$r=new WeakMap,li=new WeakSet,_u=function(e=!1){if(M(this,li,$g).call(this),!m(this,$r)||this.destroyed)return!1;if(e)return C(this,co,setTimeout(()=>{C(this,co,null),M(this,li,_u).call(this,!1)},V4)),!1;for(const{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),C(this,$r,!1),!0},$g=function(){m(this,co)&&(clearTimeout(m(this,co)),C(this,co,null))};var Yr,B0;class t3{constructor(){k(this,Yr,new Map);k(this,B0,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};m(this,B0).then(()=>{for(const[i]of m(this,Yr))i.call(this,n)})}addEventListener(e,t,n=null){let i=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:a}=n;if(a.aborted){qe("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);i=()=>a.removeEventListener("abort",l),a.addEventListener("abort",l)}m(this,Yr).set(t,i)}removeEventListener(e,t){const n=m(this,Yr).get(t);n==null||n(),m(this,Yr).delete(t)}terminate(){for(const[,e]of m(this,Yr))e==null||e();m(this,Yr).clear()}}Yr=new WeakMap,B0=new WeakMap;var G0,Ol,Ul,rd,Yg,ad,Kg;const Tt=class Tt{constructor({name:e=null,port:t=null,verbosity:n=O5()}={}){k(this,rd);var i;if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((i=m(Tt,Ul))!=null&&i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(m(Tt,Ul)||C(Tt,Ul,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Qh("main","worker",e),this._messageHandler.on("ready",function(){}),M(this,rd,Yg).call(this)}_initialize(){if(m(Tt,Ol)||m(Tt,ad,Kg)){this._setupFakeWorker();return}let{workerSrc:e}=Tt;try{Tt._isSameOrigin(window.location.href,e)||(e=Tt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Qh("main","worker",t),i=()=>{a.abort(),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:a.signal}),n.on("test",c=>{if(a.abort(),this.destroyed||!c){i();return}this._messageHandler=n,this._port=t,this._webWorker=t,M(this,rd,Yg).call(this)}),n.on("ready",c=>{if(a.abort(),this.destroyed){i();return}try{l()}catch{this._setupFakeWorker()}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{ry("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){m(Tt,Ol)||(qe("Setting up fake worker."),C(Tt,Ol,!0)),Tt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new t3;this._port=t;const n=`fake${Hn(Tt,G0)._++}`,i=new Qh(n+"_worker",n,t);e.setup(i,t),this._messageHandler=new Qh(n,n+"_worker",t),M(this,rd,Yg).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,n;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=m(Tt,Ul))==null||t.delete(this._port),this._port=null,(n=this._messageHandler)==null||n.destroy(),this._messageHandler=null}static fromPort(e){var n;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(n=m(this,Ul))==null?void 0:n.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Tt(e)}static get workerSrc(){if(oa.workerSrc)return oa.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ye(this,"_setupFakeWorkerGlobal",(async()=>m(this,ad,Kg)?m(this,ad,Kg):(await import(this.workerSrc)).WorkerMessageHandler)())}};G0=new WeakMap,Ol=new WeakMap,Ul=new WeakMap,rd=new WeakSet,Yg=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},ad=new WeakSet,Kg=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},k(Tt,ad),k(Tt,G0,0),k(Tt,Ol,!1),k(Tt,Ul),Fn&&(C(Tt,Ol,!0),oa.workerSrc||(oa.workerSrc="./pdf.worker.mjs")),Tt._isSameOrigin=(e,t)=>{let n;try{if(n=new URL(e),!n.origin||n.origin==="null")return!1}catch{return!1}const i=new URL(t,n);return n.origin===i.origin},Tt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let Mu=Tt;var Kr,tr,od,ld,Jr,Fl,sf;class n3{constructor(e,t,n,i,a){k(this,Fl);k(this,Kr,new Map);k(this,tr,new Map);k(this,od,new Map);k(this,ld,new Map);k(this,Jr,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new h2,this.fontLoader=new t4({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Ye(this,"annotationStorage",new pw)}getRenderingIntent(e,t=$a.ENABLE,n=null,i=!1,a=!1){let l=Ls.DISPLAY,c=q_;switch(e){case"any":l=Ls.ANY;break;case"display":break;case"print":l=Ls.PRINT;break;default:qe(`getRenderingIntent - invalid intent: ${e}`)}const d=l&Ls.PRINT&&n instanceof GR?n:this.annotationStorage;switch(t){case $a.DISABLE:l+=Ls.ANNOTATIONS_DISABLE;break;case $a.ENABLE:break;case $a.ENABLE_FORMS:l+=Ls.ANNOTATIONS_FORMS;break;case $a.ENABLE_STORAGE:l+=Ls.ANNOTATIONS_STORAGE,c=d.serializable;break;default:qe(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(l+=Ls.IS_EDITING),a&&(l+=Ls.OPLIST);const{ids:h,hash:p}=d.modifiedIds,v=[l,c.hash,p];return{renderingIntent:l,cacheKey:v.join("_"),annotationStorageSerializable:c,modifiedIds:h}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=m(this,Jr))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of m(this,tr).values())e.push(i._destroy());m(this,tr).clear(),m(this,od).clear(),m(this,ld).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,a;this.commonObjs.clear(),this.fontLoader.clear(),m(this,Kr).clear(),this.filterFactory.destroy(),Sf.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Eo("Worker was terminated.")),(a=this.messageHandler)==null||a.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,i)=>{Jt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},i.onPull=()=>{this._fullReader.read().then(function({value:a,done:l}){if(l){i.close();return}Jt(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{this._fullReader.cancel(a),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async n=>{var c;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:a,contentLength:l}=this._fullReader;return(!i||!a)&&(this._lastProgress&&((c=t.onProgress)==null||c.call(t,this._lastProgress)),this._fullReader.onProgress=d=>{var h;(h=t.onProgress)==null||h.call(t,{loaded:d.loaded,total:d.total})}),{isStreamingSupported:i,isRangeSupported:a,contentLength:l}}),e.on("GetRangeReader",(n,i)=>{Jt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(n.begin,n.end);if(!a){i.close();return}i.onPull=()=>{a.read().then(function({value:l,done:c}){if(c){i.close();return}Jt(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{i.error(l)})},i.onCancel=l=>{a.cancel(l),i.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new Z4(n,this))}),e.on("DocException",n=>{t._capability.reject(as(n))}),e.on("PasswordRequest",n=>{C(this,Jr,Promise.withResolvers());try{if(!t.onPassword)throw as(n);const i=a=>{a instanceof Error?m(this,Jr).reject(a):m(this,Jr).resolve({password:a})};t.onPassword(i,n.code)}catch(i){m(this,Jr).reject(i)}return m(this,Jr).promise}),e.on("DataLoaded",n=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;m(this,tr).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,i,a])=>{var l;if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":const{disableFontFace:c,fontExtraProperties:d,pdfBug:h}=this._params;if("error"in a){const S=a.error;qe(`Error during font loading: ${S}`),this.commonObjs.resolve(n,S);break}const p=h&&((l=globalThis.FontInspector)!=null&&l.enabled)?(S,A)=>globalThis.FontInspector.fontAdded(S,A):null,v=new n4(a,{disableFontFace:c,fontExtraProperties:d,inspectFont:p});this.fontLoader.bind(v).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!d&&v.data&&(v.data=null),this.commonObjs.resolve(n,v)});break;case"CopyLocalImage":const{imageRef:x}=a;Jt(x,"The imageRef must be defined.");for(const S of m(this,tr).values())for(const[,A]of S.objs)if((A==null?void 0:A.ref)===x)return A.dataLen?(this.commonObjs.resolve(n,structuredClone(A)),A.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,a);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([n,i,a,l])=>{var d;if(this.destroyed)return;const c=m(this,tr).get(i);if(!c.objs.has(n)){if(c._intentStates.size===0){(d=l==null?void 0:l.bitmap)==null||d.close();return}switch(a){case"Image":c.objs.resolve(n,l),(l==null?void 0:l.dataLen)>M5&&(c._maybeCleanupAfterRender=!0);break;case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${a}`)}}}),e.on("DocProgress",n=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:n.loaded,total:n.total})}),e.on("FetchBuiltInCMap",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)}),e.on("FetchStandardFontData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&qe("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=this._fullReader)==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=m(this,od).get(t);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&m(this,ld).set(a.refStr,e);const l=new e3(t,a,this,this._params.pdfBug);return m(this,tr).set(t,l),l});return m(this,od).set(t,i),i}getPageIndex(e){return zT(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return M(this,Fl,sf).call(this,"GetFieldObjects")}hasJSActions(){return M(this,Fl,sf).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return M(this,Fl,sf).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return M(this,Fl,sf).call(this,"GetOptionalContentConfig").then(t=>new A4(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=m(this,Kr).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(i=>{var a,l;return{info:i[0],metadata:i[1]?new w4(i[1]):null,contentDispositionFilename:((a=this._fullReader)==null?void 0:a.filename)??null,contentLength:((l=this._fullReader)==null?void 0:l.contentLength)??null}});return m(this,Kr).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of m(this,tr).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),m(this,Kr).clear(),this.filterFactory.destroy(!0),Sf.cleanup()}}cachedPageNumber(e){if(!zT(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return m(this,ld).get(t)??null}}Kr=new WeakMap,tr=new WeakMap,od=new WeakMap,ld=new WeakMap,Jr=new WeakMap,Fl=new WeakSet,sf=function(e,t=null){const n=m(this,Kr).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return m(this,Kr).set(e,i),i};const Gh=Symbol("INITIAL_DATA");var Ts,pp,nx;class h2{constructor(){k(this,pp);k(this,Ts,Object.create(null))}get(e,t=null){if(t){const i=M(this,pp,nx).call(this,e);return i.promise.then(()=>t(i.data)),null}const n=m(this,Ts)[e];if(!n||n.data===Gh)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=m(this,Ts)[e];return!!t&&t.data!==Gh}delete(e){const t=m(this,Ts)[e];return!t||t.data===Gh?!1:(delete m(this,Ts)[e],!0)}resolve(e,t=null){const n=M(this,pp,nx).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in m(this,Ts)){const{data:n}=m(this,Ts)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}C(this,Ts,Object.create(null))}*[Symbol.iterator](){for(const e in m(this,Ts)){const{data:t}=m(this,Ts)[e];t!==Gh&&(yield[e,t])}}}Ts=new WeakMap,pp=new WeakSet,nx=function(e){var t;return(t=m(this,Ts))[e]||(t[e]={...Promise.withResolvers(),data:Gh})};var uo;class s3{constructor(e){k(this,uo,null);C(this,uo,e),this.onContinue=null}get promise(){return m(this,uo).capability.promise}cancel(e=0){m(this,uo).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=m(this,uo).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=m(this,uo);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}uo=new WeakMap;var ho,zl;const rl=class rl{constructor({callback:e,params:t,objs:n,commonObjs:i,annotationCanvasMap:a,operatorList:l,pageIndex:c,canvasFactory:d,filterFactory:h,useRequestAnimationFrame:p=!1,pdfBug:v=!1,pageColors:x=null}){k(this,ho,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=d,this.filterFactory=h,this._pdfBug=v,this.pageColors=x,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new s3(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var c,d;if(this.cancelled)return;if(this._canvas){if(m(rl,zl).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");m(rl,zl).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:a,background:l}=this.params;this.gfx=new ku(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:i,transparency:e,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,(d=this.graphicsReadyCallback)==null||d.call(this)}cancel(e=null,t=0){var n;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),m(this,ho)&&(window.cancelAnimationFrame(m(this,ho)),C(this,ho,null)),m(rl,zl).delete(this._canvas),this.callback(e||new uw(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?C(this,ho,window.requestAnimationFrame(()=>{C(this,ho,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),m(rl,zl).delete(this._canvas),this.callback())))}};ho=new WeakMap,zl=new WeakMap,k(rl,zl,new WeakSet);let sx=rl;const i3="4.10.38",r3="f9bea397f";function jT(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}function qh(s){return Math.max(0,Math.min(255,255*s))}class HT{static CMYK_G([e,t,n,i]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=qh(e),[e,e,e]}static G_HTML([e]){const t=jT(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(qh)}static RGB_HTML(e){return`#${e.map(jT).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,n+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,n,i]){return[qh(1-Math.min(1,e+i)),qh(1-Math.min(1,n+i)),qh(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const i=1-e,a=1-t,l=1-n,c=Math.min(i,a,l);return["CMYK",i,a,l,c]}}class a3{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){vt("Abstract method `_createSVG` called.")}}class gw extends a3{_createSVG(e){return document.createElementNS(kr,e)}}class f2{static setupStorage(e,t,n,i,a){const l=i.getValue(t,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),a==="print")break;e.addEventListener("input",c=>{i.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?e.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&e.removeAttribute("checked"),a==="print")break;e.addEventListener("change",c=>{i.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),a==="print")break;e.addEventListener("input",c=>{i.setValue(t,{value:c.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const d=c.target.options,h=d.selectedIndex===-1?"":d[d.selectedIndex].value;i.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:i,linkService:a}){const{attributes:l}=t,c=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${i}`);for(const[d,h]of Object.entries(l))if(h!=null)switch(d){case"class":h.length&&e.setAttribute(d,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!c||d!=="href"&&d!=="newWindow")&&e.setAttribute(d,h)}c&&a.addLinkAttributes(e,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(e,l.dataId,t,n)}static render(e){var v,x;const t=e.annotationStorage,n=e.linkService,i=e.xfaHtml,a=e.intent||"display",l=document.createElement(i.name);i.attributes&&this.setAttributes({html:l,element:i,intent:a,linkService:n});const c=a!=="richText",d=e.div;if(d.append(l),e.viewport){const S=`matrix(${e.viewport.transform.join(",")})`;d.style.transform=S}c&&d.setAttribute("class","xfaLayer xfaFont");const h=[];if(i.children.length===0){if(i.value){const S=document.createTextNode(i.value);l.append(S),c&&Af.shouldBuildText(i.name)&&h.push(S)}return{textDivs:h}}const p=[[i,-1,l]];for(;p.length>0;){const[S,A,E]=p.at(-1);if(A+1===S.children.length){p.pop();continue}const N=S.children[++p.at(-1)[1]];if(N===null)continue;const{name:R}=N;if(R==="#text"){const P=document.createTextNode(N.value);h.push(P),E.append(P);continue}const D=(v=N==null?void 0:N.attributes)!=null&&v.xmlns?document.createElementNS(N.attributes.xmlns,R):document.createElement(R);if(E.append(D),N.attributes&&this.setAttributes({html:D,element:N,storage:t,intent:a,linkService:n}),((x=N.children)==null?void 0:x.length)>0)p.push([N,-1,D]);else if(N.value){const P=document.createTextNode(N.value);c&&Af.shouldBuildText(R)&&h.push(P),D.append(P)}}for(const S of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))S.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const em=1e3,o3=9,fc=new WeakSet;function Ao(s){return{width:s[2]-s[0],height:s[3]-s[1]}}class l3{static create(e){switch(e.data.annotationType){case Qt.LINK:return new p2(e);case Qt.TEXT:return new c3(e);case Qt.WIDGET:switch(e.data.fieldType){case"Tx":return new u3(e);case"Btn":return e.data.radioButton?new y2(e):e.data.checkBox?new h3(e):new f3(e);case"Ch":return new p3(e);case"Sig":return new d3(e)}return new mc(e);case Qt.POPUP:return new rx(e);case Qt.FREETEXT:return new w2(e);case Qt.LINE:return new g3(e);case Qt.SQUARE:return new y3(e);case Qt.CIRCLE:return new v3(e);case Qt.POLYLINE:return new S2(e);case Qt.CARET:return new _3(e);case Qt.INK:return new yw(e);case Qt.POLYGON:return new b3(e);case Qt.HIGHLIGHT:return new A2(e);case Qt.UNDERLINE:return new x3(e);case Qt.SQUIGGLY:return new w3(e);case Qt.STRIKEOUT:return new S3(e);case Qt.STAMP:return new E2(e);case Qt.FILEATTACHMENT:return new A3(e);default:return new Ht(e)}}}var jl,cd,ud,mp,ix;const Mw=class Mw{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){k(this,mp);k(this,jl,null);k(this,cd,!1);k(this,ud,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e!=null&&e.str||t!=null&&t.str||n!=null&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Mw._hasPopupData(this.data)}updateEdited(e){var n;if(!this.container)return;m(this,jl)||C(this,jl,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&M(this,mp,ix).call(this,t),(n=m(this,ud))==null||n.popup.updateEdited(e)}resetEdited(){var e;m(this,jl)&&(M(this,mp,ix).call(this,m(this,jl).rect),(e=m(this,ud))==null||e.popup.resetEdited(),C(this,jl,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:i}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",t.id),this instanceof mc||(a.tabIndex=em);const{style:l}=a;if(l.zIndex=this.parent.zIndex++,t.alternativeText&&(a.title=t.alternativeText),t.noRotate&&a.classList.add("norotate"),!t.rect||this instanceof rx){const{rotation:E}=t;return!t.hasOwnCanvas&&E!==0&&this.setRotation(E,a),a}const{width:c,height:d}=Ao(t.rect);if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const E=t.borderStyle.horizontalCornerRadius,N=t.borderStyle.verticalCornerRadius;if(E>0||N>0){const D=`calc(${E}px * var(--scale-factor)) / calc(${N}px * var(--scale-factor))`;l.borderRadius=D}else if(this instanceof y2){const D=`calc(${c}px * var(--scale-factor)) / calc(${d}px * var(--scale-factor))`;l.borderRadius=D}switch(t.borderStyle.style){case Hh.SOLID:l.borderStyle="solid";break;case Hh.DASHED:l.borderStyle="dashed";break;case Hh.BEVELED:qe("Unimplemented border style: beveled");break;case Hh.INSET:qe("Unimplemented border style: inset");break;case Hh.UNDERLINE:l.borderBottomStyle="solid";break}const R=t.borderColor||null;R?(C(this,cd,!0),l.borderColor=Te.makeHexColor(R[0]|0,R[1]|0,R[2]|0)):l.borderWidth=0}const h=Te.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:v,pageX:x,pageY:S}=i.rawDims;l.left=`${100*(h[0]-x)/p}%`,l.top=`${100*(h[1]-S)/v}%`;const{rotation:A}=t;return t.hasOwnCanvas||A===0?(l.width=`${100*c/p}%`,l.height=`${100*d/v}%`):this.setRotation(A,a),a}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims,{width:a,height:l}=Ao(this.data.rect);let c,d;e%180===0?(c=100*a/n,d=100*l/i):(c=100*l/n,d=100*a/i),t.style.width=`${c}%`,t.style.height=`${d}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,i)=>{const a=i.detail[t],l=a[0],c=a.slice(1);i.target.style[n]=HT[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:HT[`${l}_rgb`](c)})};return Ye(this,"_commonActions",{display:t=>{const{display:n}=t.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail)){const a=e[i]||n[i];a==null||a(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,a]of Object.entries(t)){const l=n[i];if(l){const c={detail:{[i]:a},target:e};l(c),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,a]=this.data.rect.map(E=>Math.fround(E));if(e.length===8){const[E,N,R,D]=e.subarray(2,6);if(i===E&&a===N&&t===R&&n===D)return}const{style:l}=this.container;let c;if(m(this,cd)){const{borderColor:E,borderWidth:N}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${E}" stroke-width="${N}">`],this.container.classList.add("hasBorder")}const d=i-t,h=a-n,{svgFactory:p}=this,v=p.createElement("svg");v.classList.add("quadrilateralsContainer"),v.setAttribute("width",0),v.setAttribute("height",0);const x=p.createElement("defs");v.append(x);const S=p.createElement("clipPath"),A=`clippath_${this.data.id}`;S.setAttribute("id",A),S.setAttribute("clipPathUnits","objectBoundingBox"),x.append(S);for(let E=2,N=e.length;E<N;E+=8){const R=e[E],D=e[E+1],P=e[E+2],L=e[E+3],H=p.createElement("rect"),z=(P-t)/d,U=(a-D)/h,J=(R-P)/d,K=(D-L)/h;H.setAttribute("x",z),H.setAttribute("y",U),H.setAttribute("width",J),H.setAttribute("height",K),S.append(H),c==null||c.push(`<rect vector-effect="non-scaling-stroke" x="${z}" y="${U}" width="${J}" height="${K}"/>`)}m(this,cd)&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(v),this.container.style.clipPath=`url(#${A})`}_createPopup(){const{data:e}=this,t=C(this,ud,new rx({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){vt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:a,id:l,exportValues:c}of i){if(a===-1||l===t)continue;const d=typeof c=="string"?c:null,h=document.querySelector(`[data-element-id="${l}"]`);if(h&&!fc.has(h)){qe(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:d,domElement:h})}return n}for(const i of document.getElementsByName(e)){const{exportValue:a}=i,l=i.getAttribute("data-element-id");l!==t&&fc.has(i)&&n.push({id:l,exportValue:a,domElement:i})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};jl=new WeakMap,cd=new WeakMap,ud=new WeakMap,mp=new WeakSet,ix=function(e){const{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:d}}}}=this;n==null||n.splice(0,4,...e);const{width:h,height:p}=Ao(e);t.left=`${100*(e[0]-c)/a}%`,t.top=`${100*(l-e[3]+d)/l}%`,i===0?(t.width=`${100*h/a}%`,t.height=`${100*p/l}%`):this.setRotation(i)};let Ht=Mw;var Os,Qo,m2,g2;class p2 extends Ht{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});k(this,Os);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let a=!1;return t.url?(n.addLinkAttributes(i,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(i,t.action),a=!0):t.attachment?(M(this,Os,m2).call(this,i,t.attachment,t.attachmentDest),a=!0):t.setOCGState?(M(this,Os,g2).call(this,i,t.setOCGState),a=!0):t.dest?(this._bindLink(i,t.dest),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),a=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(i,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&this.container.append(i),this.container}_bindLink(t,n){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&M(this,Os,Qo).call(this)}_bindNamedAction(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),M(this,Os,Qo).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(n.actions)){const l=i.get(a);l&&(t[l]=()=>{var c;return(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:a}}),!1})}t.onclick||(t.onclick=()=>!1),M(this,Os,Qo).call(this)}_bindResetFormAction(t,n){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),M(this,Os,Qo).call(this),!this._fieldObjects){qe('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var v;i==null||i();const{fields:a,refs:l,include:c}=n,d=[];if(a.length!==0||l.length!==0){const x=new Set(l);for(const S of a){const A=this._fieldObjects[S]||[];for(const{id:E}of A)x.add(E)}for(const S of Object.values(this._fieldObjects))for(const A of S)x.has(A.id)===c&&d.push(A)}else for(const x of Object.values(this._fieldObjects))d.push(...x);const h=this.annotationStorage,p=[];for(const x of d){const{id:S}=x;switch(p.push(S),x.type){case"text":{const E=x.defaultValue||"";h.setValue(S,{value:E});break}case"checkbox":case"radiobutton":{const E=x.defaultValue===x.exportValues;h.setValue(S,{value:E});break}case"combobox":case"listbox":{const E=x.defaultValue||"";h.setValue(S,{value:E});break}default:continue}const A=document.querySelector(`[data-element-id="${S}"]`);if(A){if(!fc.has(A)){qe(`_bindResetFormAction - element not allowed: ${S}`);continue}}else continue;A.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:p,name:"ResetForm"}})),!1}}}Os=new WeakSet,Qo=function(){this.container.setAttribute("data-internal-link","")},m2=function(t,n,i=null){t.href=this.linkService.getAnchorUrl(""),n.description&&(t.title=n.description),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(n.content,n.filename,i),!1},M(this,Os,Qo).call(this)},g2=function(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),M(this,Os,Qo).call(this)};class c3 extends Ht{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class mc extends Ht{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Kn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,a){n.includes("mouse")?e.addEventListener(n,l=>{var c;(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(n,l=>{var c;if(n==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}a&&((c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(l)}}))})}_setEventListeners(e,t,n,i){var a,l,c;for(const[d,h]of n)(h==="Action"||(a=this.data.actions)!=null&&a[h])&&((h==="Focus"||h==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,d,h,i),h==="Focus"&&!((l=this.data.actions)!=null&&l.Blur)?this._setEventListener(e,t,"blur","Blur",null):h==="Blur"&&!((c=this.data.actions)!=null&&c.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Te.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||o3,a=e.style;let l;const c=2,d=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c),p=Math.round(h/(Xb*i))||1,v=h/p;l=Math.min(i,d(v/Xb))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(i,d(h/Xb))}a.fontSize=`calc(${l}px * var(--scale-factor))`,a.color=Te.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(a.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class u3 extends mc{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,i){const a=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=n),a.setValue(l.id,{[i]:n})}render(){var i,a;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const l=e.getValue(t,{value:this.data.fieldValue});let c=l.value||"";const d=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;d&&c.length>d&&(c=c.slice(0,d));let h=l.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const p={userValue:c,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=h??c,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",h??c),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),fc.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=em,this._setRequired(n,this.data.required),d&&(n.maxLength=d),n.addEventListener("input",x=>{e.setValue(t,{value:x.target.value}),this.setPropertyOnSiblings(n,"value",x.target.value,"value"),p.formattedValue=null}),n.addEventListener("resetform",x=>{const S=this.data.defaultFieldValue??"";n.value=p.userValue=S,p.formattedValue=null});let v=x=>{const{formattedValue:S}=p;S!=null&&(x.target.value=S),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",S=>{var E;if(p.focused)return;const{target:A}=S;p.userValue&&(A.value=p.userValue),p.lastCommittedValue=A.value,p.commitKey=1,(E=this.data.actions)!=null&&E.Focus||(p.focused=!0)}),n.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const A={value(E){p.userValue=E.detail.value??"",e.setValue(t,{value:p.userValue.toString()}),E.target.value=p.userValue},formattedValue(E){const{formattedValue:N}=E.detail;p.formattedValue=N,N!=null&&E.target!==document.activeElement&&(E.target.value=N),e.setValue(t,{formattedValue:N})},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{var P;const{charLimit:N}=E.detail,{target:R}=E;if(N===0){R.removeAttribute("maxLength");return}R.setAttribute("maxLength",N);let D=p.userValue;!D||D.length<=N||(D=D.slice(0,N),R.value=p.userValue=D,e.setValue(t,{value:D}),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:D,willCommit:!0,commitKey:1,selStart:R.selectionStart,selEnd:R.selectionEnd}}))}};this._dispatchEventFromSandbox(A,S)}),n.addEventListener("keydown",S=>{var N;p.commitKey=1;let A=-1;if(S.key==="Escape"?A=0:S.key==="Enter"&&!this.data.multiLine?A=2:S.key==="Tab"&&(p.commitKey=3),A===-1)return;const{value:E}=S.target;p.lastCommittedValue!==E&&(p.lastCommittedValue=E,p.userValue=E,(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:A,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const x=v;v=null,n.addEventListener("blur",S=>{var E,N;if(!p.focused||!S.relatedTarget)return;(E=this.data.actions)!=null&&E.Blur||(p.focused=!1);const{value:A}=S.target;p.userValue=A,p.lastCommittedValue!==A&&((N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:p.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}})),x(S)}),(a=this.data.actions)!=null&&a.Keystroke&&n.addEventListener("beforeinput",S=>{var H;p.lastCommittedValue=null;const{data:A,target:E}=S,{value:N,selectionStart:R,selectionEnd:D}=E;let P=R,L=D;switch(S.inputType){case"deleteWordBackward":{const z=N.substring(0,R).match(/\w*[^\w]*$/);z&&(P-=z[0].length);break}case"deleteWordForward":{const z=N.substring(R).match(/^[^\w]*\w*/);z&&(L+=z[0].length);break}case"deleteContentBackward":R===D&&(P-=1);break;case"deleteContentForward":R===D&&(L+=1);break}S.preventDefault(),(H=this.linkService.eventBus)==null||H.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:N,change:A||"",willCommit:!1,selStart:P,selEnd:L}})}),this._setEventListeners(n,p,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(v&&n.addEventListener("blur",v),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/d;n.classList.add("comb"),n.style.letterSpacing=`calc(${S}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class d3 extends mc{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class h3 extends mc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return fc.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=em,a.addEventListener("change",l=>{const{name:c,checked:d}=l.target;for(const h of this._getElementsByName(c,n)){const p=d&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=p),e.setValue(h.id,{value:p})}e.setValue(n,{value:d})}),a.addEventListener("resetform",l=>{const c=t.defaultFieldValue||"Off";l.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",l=>{const c={value(d){d.target.checked=d.detail.value!=="Off",e.setValue(n,{value:d.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class y2 extends mc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(const l of this._getElementsByName(t.fieldName,n))e.setValue(l.id,{value:!1});const a=document.createElement("input");if(fc.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.tabIndex=em,a.addEventListener("change",l=>{const{name:c,checked:d}=l.target;for(const h of this._getElementsByName(c,n))e.setValue(h.id,{value:!1});e.setValue(n,{value:d})}),a.addEventListener("resetform",l=>{const c=t.defaultFieldValue;l.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;a.addEventListener("updatefromsandbox",c=>{const d={value:h=>{const p=l===h.detail.value;for(const v of this._getElementsByName(h.target.name)){const x=p&&v.id===n;v.domElement&&(v.domElement.checked=x),e.setValue(v.id,{value:x})}}};this._dispatchEventFromSandbox(d,c)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class f3 extends p2{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class p3 extends mc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");fc.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=em;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",p=>{const v=this.data.defaultFieldValue;for(const x of i.options)x.selected=x.value===v});for(const p of this.data.options){const v=document.createElement("option");v.textContent=p.displayValue,v.value=p.exportValue,n.value.includes(p.exportValue)&&(v.setAttribute("selected",!0),a=!1),i.append(v)}let l=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),i.prepend(p),l=()=>{p.remove(),i.removeEventListener("input",l),l=null},i.addEventListener("input",l)}const c=p=>{const v=p?"value":"textContent",{options:x,multiple:S}=i;return S?Array.prototype.filter.call(x,A=>A.selected).map(A=>A[v]):x.selectedIndex===-1?null:x[x.selectedIndex][v]};let d=c(!1);const h=p=>{const v=p.target.options;return Array.prototype.map.call(v,x=>({displayValue:x.textContent,exportValue:x.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",p=>{const v={value(x){l==null||l();const S=x.detail.value,A=new Set(Array.isArray(S)?S:[S]);for(const E of i.options)E.selected=A.has(E.value);e.setValue(t,{value:c(!0)}),d=c(!1)},multipleSelection(x){i.multiple=!0},remove(x){const S=i.options,A=x.detail.remove;S[A].selected=!1,i.remove(A),S.length>0&&Array.prototype.findIndex.call(S,N=>N.selected)===-1&&(S[0].selected=!0),e.setValue(t,{value:c(!0),items:h(x)}),d=c(!1)},clear(x){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),d=c(!1)},insert(x){const{index:S,displayValue:A,exportValue:E}=x.detail.insert,N=i.children[S],R=document.createElement("option");R.textContent=A,R.value=E,N?N.before(R):i.append(R),e.setValue(t,{value:c(!0),items:h(x)}),d=c(!1)},items(x){const{items:S}=x.detail;for(;i.length!==0;)i.remove(0);for(const A of S){const{displayValue:E,exportValue:N}=A,R=document.createElement("option");R.textContent=E,R.value=N,i.append(R)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:c(!0),items:h(x)}),d=c(!1)},indices(x){const S=new Set(x.detail.indices);for(const A of x.target.options)A.selected=S.has(A.index);e.setValue(t,{value:c(!0)}),d=c(!1)},editable(x){x.target.disabled=!x.detail.editable}};this._dispatchEventFromSandbox(v,p)}),i.addEventListener("input",p=>{var S;const v=c(!0),x=c(!1);e.setValue(t,{value:v}),p.preventDefault(),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:d,change:x,changeEx:v,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):i.addEventListener("input",function(p){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class rx extends Ht{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:Ht._hasPopupData(t)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new m3({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(n=>`${cw}${n}`).join(",")),this.container}}var dd,q0,V0,hd,Hl,Ot,Xr,fd,gp,yp,pd,Wr,Ai,Qr,vp,Zr,bp,Bl,Gl,gt,Jg,ax,v2,b2,_2,x2,Xg,Wg,ox;class m3{constructor({container:e,color:t,elements:n,titleObj:i,modificationDate:a,contentsObj:l,richText:c,parent:d,rect:h,parentRect:p,open:v}){k(this,gt);k(this,dd,M(this,gt,_2).bind(this));k(this,q0,M(this,gt,ox).bind(this));k(this,V0,M(this,gt,Wg).bind(this));k(this,hd,M(this,gt,Xg).bind(this));k(this,Hl,null);k(this,Ot,null);k(this,Xr,null);k(this,fd,null);k(this,gp,null);k(this,yp,null);k(this,pd,null);k(this,Wr,!1);k(this,Ai,null);k(this,Qr,null);k(this,vp,null);k(this,Zr,null);k(this,bp,null);k(this,Bl,null);k(this,Gl,!1);var x;C(this,Ot,e),C(this,bp,i),C(this,Xr,l),C(this,Zr,c),C(this,yp,d),C(this,Hl,t),C(this,vp,h),C(this,pd,p),C(this,gp,n),C(this,fd,hw.toDateObject(a)),this.trigger=n.flatMap(S=>S.getElementsToTriggerPopup());for(const S of this.trigger)S.addEventListener("click",m(this,hd)),S.addEventListener("mouseenter",m(this,V0)),S.addEventListener("mouseleave",m(this,q0)),S.classList.add("popupTriggerArea");for(const S of n)(x=S.container)==null||x.addEventListener("keydown",m(this,dd));m(this,Ot).hidden=!0,v&&M(this,gt,Xg).call(this)}render(){if(m(this,Ai))return;const e=C(this,Ai,document.createElement("div"));if(e.className="popup",m(this,Hl)){const a=e.style.outlineColor=Te.makeHexColor(...m(this,Hl));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${a} 30%, white)`:e.style.backgroundColor=Te.makeHexColor(...m(this,Hl).map(c=>Math.floor(.7*(255-c)+c)))}const t=document.createElement("span");t.className="header";const n=document.createElement("h1");if(t.append(n),{dir:n.dir,str:n.textContent}=m(this,bp),e.append(t),m(this,fd)){const a=document.createElement("span");a.classList.add("popupDate"),a.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),a.setAttribute("data-l10n-args",JSON.stringify({dateObj:m(this,fd).valueOf()})),t.append(a)}const i=m(this,gt,Jg);if(i)f2.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const a=this._formatContents(m(this,Xr));e.append(a)}m(this,Ot).append(e)}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let a=0,l=i.length;a<l;++a){const c=i[a];n.append(document.createTextNode(c)),a<l-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:e,popupContent:t}){var n;m(this,Bl)||C(this,Bl,{contentsObj:m(this,Xr),richText:m(this,Zr)}),e&&C(this,Qr,null),t&&(C(this,Zr,M(this,gt,b2).call(this,t)),C(this,Xr,null)),(n=m(this,Ai))==null||n.remove(),C(this,Ai,null)}resetEdited(){var e;m(this,Bl)&&({contentsObj:Hn(this,Xr)._,richText:Hn(this,Zr)._}=m(this,Bl),C(this,Bl,null),(e=m(this,Ai))==null||e.remove(),C(this,Ai,null),C(this,Qr,null))}forceHide(){C(this,Gl,this.isVisible),m(this,Gl)&&(m(this,Ot).hidden=!0)}maybeShow(){m(this,Gl)&&(m(this,Ai)||M(this,gt,Wg).call(this),C(this,Gl,!1),m(this,Ot).hidden=!1)}get isVisible(){return m(this,Ot).hidden===!1}}dd=new WeakMap,q0=new WeakMap,V0=new WeakMap,hd=new WeakMap,Hl=new WeakMap,Ot=new WeakMap,Xr=new WeakMap,fd=new WeakMap,gp=new WeakMap,yp=new WeakMap,pd=new WeakMap,Wr=new WeakMap,Ai=new WeakMap,Qr=new WeakMap,vp=new WeakMap,Zr=new WeakMap,bp=new WeakMap,Bl=new WeakMap,Gl=new WeakMap,gt=new WeakSet,Jg=function(){const e=m(this,Zr),t=m(this,Xr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&m(this,Zr).html||null},ax=function(){var e,t,n;return((n=(t=(e=m(this,gt,Jg))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},v2=function(){var e,t,n;return((n=(t=(e=m(this,gt,Jg))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},b2=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:m(this,gt,v2),fontSize:m(this,gt,ax)?`calc(${m(this,gt,ax)}px * var(--scale-factor))`:""}};for(const a of e.split(`
`))t.push({name:"span",value:a,attributes:i});return n},_2=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&m(this,Wr))&&M(this,gt,Xg).call(this)},x2=function(){if(m(this,Qr)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:a}}}=m(this,yp);let l=!!m(this,pd),c=l?m(this,pd):m(this,vp);for(const A of m(this,gp))if(!c||Te.intersect(A.data.rect,c)!==null){c=A.data.rect,l=!0;break}const d=Te.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),p=l?c[2]-c[0]+5:0,v=d[0]+p,x=d[1];C(this,Qr,[100*(v-i)/t,100*(x-a)/n]);const{style:S}=m(this,Ot);S.left=`${m(this,Qr)[0]}%`,S.top=`${m(this,Qr)[1]}%`},Xg=function(){C(this,Wr,!m(this,Wr)),m(this,Wr)?(M(this,gt,Wg).call(this),m(this,Ot).addEventListener("click",m(this,hd)),m(this,Ot).addEventListener("keydown",m(this,dd))):(M(this,gt,ox).call(this),m(this,Ot).removeEventListener("click",m(this,hd)),m(this,Ot).removeEventListener("keydown",m(this,dd)))},Wg=function(){m(this,Ai)||this.render(),this.isVisible?m(this,Wr)&&m(this,Ot).classList.add("focused"):(M(this,gt,x2).call(this),m(this,Ot).hidden=!1,m(this,Ot).style.zIndex=parseInt(m(this,Ot).style.zIndex)+1e3)},ox=function(){m(this,Ot).classList.remove("focused"),!(m(this,Wr)||!this.isVisible)&&(m(this,Ot).hidden=!0,m(this,Ot).style.zIndex=parseInt(m(this,Ot).style.zIndex)-1e3)};class w2 extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ge.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var _p;class g3 extends Ht{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});k(this,_p,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:n,height:i}=Ao(t.rect),a=this.svgFactory.create(n,i,!0),l=C(this,_p,this.svgFactory.createElement("svg:line"));return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return m(this,_p)}addHighlightArea(){this.container.classList.add("highlightArea")}}_p=new WeakMap;var xp;class y3 extends Ht{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});k(this,xp,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:n,height:i}=Ao(t.rect),a=this.svgFactory.create(n,i,!0),l=t.borderStyle.width,c=C(this,xp,this.svgFactory.createElement("svg:rect"));return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",n-l),c.setAttribute("height",i-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return m(this,xp)}addHighlightArea(){this.container.classList.add("highlightArea")}}xp=new WeakMap;var wp;class v3 extends Ht{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});k(this,wp,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:n,height:i}=Ao(t.rect),a=this.svgFactory.create(n,i,!0),l=t.borderStyle.width,c=C(this,wp,this.svgFactory.createElement("svg:ellipse"));return c.setAttribute("cx",n/2),c.setAttribute("cy",i/2),c.setAttribute("rx",n/2-l/2),c.setAttribute("ry",i/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return m(this,wp)}addHighlightArea(){this.container.classList.add("highlightArea")}}wp=new WeakMap;var Sp;class S2 extends Ht{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});k(this,Sp,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:i,popupRef:a}}=this;if(!n)return this.container;const{width:l,height:c}=Ao(t),d=this.svgFactory.create(l,c,!0);let h=[];for(let v=0,x=n.length;v<x;v+=2){const S=n[v]-t[0],A=t[3]-n[v+1];h.push(`${S},${A}`)}h=h.join(" ");const p=C(this,Sp,this.svgFactory.createElement(this.svgElementName));return p.setAttribute("points",h),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),d.append(p),this.container.append(d),!a&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return m(this,Sp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Sp=new WeakMap;class b3 extends S2{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class _3 extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Ap,ql,Ep,lx;class yw extends Ht{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});k(this,Ep);k(this,Ap,null);k(this,ql,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ge.HIGHLIGHT:Ge.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:i,borderStyle:a,popupRef:l}}=this,{transform:c,width:d,height:h}=M(this,Ep,lx).call(this,n,t),p=this.svgFactory.create(d,h,!0),v=C(this,Ap,this.svgFactory.createElement("svg:g"));p.append(v),v.setAttribute("stroke-width",a.width||1),v.setAttribute("stroke-linecap","round"),v.setAttribute("stroke-linejoin","round"),v.setAttribute("stroke-miterlimit",10),v.setAttribute("stroke","transparent"),v.setAttribute("fill","transparent"),v.setAttribute("transform",c);for(let x=0,S=i.length;x<S;x++){const A=this.svgFactory.createElement(this.svgElementName);m(this,ql).push(A),A.setAttribute("points",i[x].join(",")),v.append(A)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(p),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:i,rect:a}=t,l=m(this,Ap);if(n>=0&&l.setAttribute("stroke-width",n||1),i)for(let c=0,d=m(this,ql).length;c<d;c++)m(this,ql)[c].setAttribute("points",i[c].join(","));if(a){const{transform:c,width:d,height:h}=M(this,Ep,lx).call(this,this.data.rotation,a);l.parentElement.setAttribute("viewBox",`0 0 ${d} ${h}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return m(this,ql)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ap=new WeakMap,ql=new WeakMap,Ep=new WeakSet,lx=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class A2 extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ge.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class x3 extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class w3 extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class S3 extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class E2 extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ge.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Tp,Cp,cx;class A3 extends Ht{constructor(t){var i;super(t,{isRenderable:!0});k(this,Cp);k(this,Tp,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let i;n.hasAppearance||n.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),i.addEventListener("dblclick",M(this,Cp,cx).bind(this)),C(this,Tp,i);const{isMac:a}=Kn.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(a?l.metaKey:l.ctrlKey)&&M(this,Cp,cx).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return m(this,Tp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Tp=new WeakMap,Cp=new WeakSet,cx=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Np,Vl,$l,Rp,pc,T2,ux;class E3{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:i,page:a,viewport:l,structTreeLayer:c}){k(this,pc);k(this,Np,null);k(this,Vl,null);k(this,$l,new Map);k(this,Rp,null);this.div=e,C(this,Np,t),C(this,Vl,n),C(this,Rp,c||null),this.page=a,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return m(this,$l).size>0}async render(e){var l;const{annotations:t}=e,n=this.div;dc(n,this.viewport);const i=new Map,a={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new gw,annotationStorage:e.annotationStorage||new pw,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const d=c.annotationType===Qt.POPUP;if(d){const v=i.get(c.id);if(!v)continue;a.elements=v}else{const{width:v,height:x}=Ao(c.rect);if(v<=0||x<=0)continue}a.data=c;const h=l3.create(a);if(!h.isRenderable)continue;if(!d&&c.popupRef){const v=i.get(c.popupRef);v?v.push(h):i.set(c.popupRef,[h])}const p=h.render();c.hidden&&(p.style.visibility="hidden"),await M(this,pc,T2).call(this,p,c.id),h._isEditable&&(m(this,$l).set(h.data.id,h),(l=this._annotationEditorUIManager)==null||l.renderAnnotationElement(h))}M(this,pc,ux).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,dc(t,{rotation:e.rotation}),M(this,pc,ux).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(m(this,$l).values())}getEditableAnnotation(e){return m(this,$l).get(e)}}Np=new WeakMap,Vl=new WeakMap,$l=new WeakMap,Rp=new WeakMap,pc=new WeakSet,T2=async function(e,t){var l,c;const n=e.firstChild||e,i=n.id=`${cw}${t}`,a=await((l=m(this,Rp))==null?void 0:l.getAriaAttributes(i));if(a)for(const[d,h]of a)n.setAttribute(d,h);this.div.append(e),(c=m(this,Np))==null||c.moveElementInDOM(this.div,e,n,!1)},ux=function(){if(!m(this,Vl))return;const e=this.div;for(const[t,n]of m(this,Vl)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:a}=i;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):i.append(n)}m(this,Vl).clear()};const Cg=/\r\n?|\n/g;var Ei,Cs,kp,Yl,Ns,Xt,C2,N2,R2,Qg,ca,Zg,e0,k2,hx,M2;const _t=class _t extends Dt{constructor(t){super({...t,name:"freeTextEditor"});k(this,Xt);k(this,Ei);k(this,Cs,"");k(this,kp,`${this.id}-editor`);k(this,Yl,null);k(this,Ns);C(this,Ei,t.color||_t._defaultColor||Dt._defaultLineColor),C(this,Ns,t.fontSize||_t._defaultFontSize)}static get _keyboardManager(){const t=_t.prototype,n=l=>l.isEmpty(),i=hc.TRANSLATE_SMALL,a=hc.TRANSLATE_BIG;return Ye(this,"_keyboardManager",new Zp([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:n}]]))}static initialize(t,n){Dt.initialize(t,n);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case Ze.FREETEXT_SIZE:_t._defaultFontSize=n;break;case Ze.FREETEXT_COLOR:_t._defaultColor=n;break}}updateParams(t,n){switch(t){case Ze.FREETEXT_SIZE:M(this,Xt,C2).call(this,n);break;case Ze.FREETEXT_COLOR:M(this,Xt,N2).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Ze.FREETEXT_SIZE,_t._defaultFontSize],[Ze.FREETEXT_COLOR,_t._defaultColor||Dt._defaultLineColor]]}get propertiesToUpdate(){return[[Ze.FREETEXT_SIZE,m(this,Ns)],[Ze.FREETEXT_COLOR,m(this,Ei)]]}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-_t._internalPadding*t,-(_t._internalPadding+m(this,Ns))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Ge.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),C(this,Yl,new AbortController);const t=this._uiManager.combinedSignal(m(this,Yl));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",m(this,kp)),this._isDraggable=!0,(t=m(this,Yl))==null||t.abort(),C(this,Yl,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=m(this,Cs),n=C(this,Cs,M(this,Xt,R2).call(this).trimEnd());if(t===n)return;const i=a=>{if(C(this,Cs,a),!a){this.remove();return}M(this,Xt,e0).call(this),this._uiManager.rebuild(this),M(this,Xt,Qg).call(this)};this.addCommands({cmd:()=>{i(n)},undo:()=>{i(t)},mustExec:!1}),M(this,Xt,Qg).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){_t._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,n;this.width&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",m(this,kp)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${m(this,Ns)}px * var(--scale-factor))`,i.color=m(this,Ei),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),b0(this,this.div,["dblclick","keydown"]),this.width){const[a,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[d,h]=this.getInitialTranslation();[d,h]=this.pageTranslationToScreen(d,h);const[p,v]=this.pageDimensions,[x,S]=this.pageTranslation;let A,E;switch(this.rotation){case 0:A=t+(c[0]-x)/p,E=n+this.height-(c[1]-S)/v;break;case 90:A=t+(c[0]-x)/p,E=n-(c[1]-S)/v,[d,h]=[h,-d];break;case 180:A=t-this.width+(c[0]-x)/p,E=n-(c[1]-S)/v,[d,h]=[-d,-h];break;case 270:A=t+(c[0]-x-this.height*v)/p,E=n+(c[1]-S-this.width*p)/v,[d,h]=[-h,d];break}this.setAt(A*a,E*l,d,h)}else this.setAt(t*a,n*l,this.width*a,this.height*l);M(this,Xt,e0).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var A,E,N;const n=t.clipboardData||window.clipboardData,{types:i}=n;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const a=M(A=_t,ca,hx).call(A,n.getData("text")||"").replaceAll(Cg,`
`);if(!a)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!a.includes(`
`)){c.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:d,startOffset:h}=c,p=[],v=[];if(d.nodeType===Node.TEXT_NODE){const R=d.parentElement;if(v.push(d.nodeValue.slice(h).replaceAll(Cg,"")),R!==this.editorDiv){let D=p;for(const P of this.editorDiv.childNodes){if(P===R){D=v;continue}D.push(M(E=_t,ca,Zg).call(E,P))}}p.push(d.nodeValue.slice(0,h).replaceAll(Cg,""))}else if(d===this.editorDiv){let R=p,D=0;for(const P of this.editorDiv.childNodes)D++===h&&(R=v),R.push(M(N=_t,ca,Zg).call(N,P))}C(this,Cs,`${p.join(`
`)}${a}${v.join(`
`)}`),M(this,Xt,e0).call(this);const x=new Range;let S=p.reduce((R,D)=>R+D.length,0);for(const{firstChild:R}of this.editorDiv.childNodes)if(R.nodeType===Node.TEXT_NODE){const D=R.nodeValue.length;if(S<=D){x.setStart(R,S),x.setEnd(R,S);break}S-=D}l.removeAllRanges(),l.addRange(x)}get contentDiv(){return this.editorDiv}static async deserialize(t,n,i){var c;let a=null;if(t instanceof w2){const{data:{defaultAppearanceData:{fontSize:d,fontColor:h},rect:p,rotation:v,id:x,popupRef:S},textContent:A,textPosition:E,parent:{page:{pageNumber:N}}}=t;if(!A||A.length===0)return null;a=t={annotationType:Ge.FREETEXT,color:Array.from(h),fontSize:d,value:A.join(`
`),position:E,pageIndex:N-1,rect:p.slice(0),rotation:v,id:x,deleted:!1,popupRef:S}}const l=await super.deserialize(t,n,i);return C(l,Ns,t.fontSize),C(l,Ei,Te.makeHexColor(...t.color)),C(l,Cs,M(c=_t,ca,hx).call(c,t.value)),l.annotationElementId=t.id||null,l._initialData=a,l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=_t._internalPadding*this.parentScale,i=this.getRect(n,n),a=Dt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:m(this,Ei)),l={annotationType:Ge.FREETEXT,color:a,fontSize:m(this,Ns),value:M(this,Xt,k2).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?l:this.annotationElementId&&!M(this,Xt,M2).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(this.deleted)return n;const{style:i}=n;i.fontSize=`calc(${m(this,Ns)}px * var(--scale-factor))`,i.color=m(this,Ei),n.replaceChildren();for(const l of m(this,Cs).split(`
`)){const c=document.createElement("div");c.append(l?document.createTextNode(l):document.createElement("br")),n.append(c)}const a=_t._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(a,a),popupContent:m(this,Cs)}),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Ei=new WeakMap,Cs=new WeakMap,kp=new WeakMap,Yl=new WeakMap,Ns=new WeakMap,Xt=new WeakSet,C2=function(t){const n=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--scale-factor))`,this.translate(0,-(a-m(this,Ns))*this.parentScale),C(this,Ns,a),M(this,Xt,Qg).call(this)},i=m(this,Ns);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},N2=function(t){const n=a=>{C(this,Ei,this.editorDiv.style.color=a)},i=m(this,Ei);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},R2=function(){var i;const t=[];this.editorDiv.normalize();let n=null;for(const a of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&a.nodeName==="BR"||(t.push(M(i=_t,ca,Zg).call(i,a)),n=a);return t.join(`
`)},Qg=function(){const[t,n]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:a,div:l}=this,c=l.style.display,d=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",a.div.append(this.div),i=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",d)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/n):(this.width=i.height/t,this.height=i.width/n),this.fixAndSetPosition()},ca=new WeakSet,Zg=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Cg,"")},e0=function(){if(this.editorDiv.replaceChildren(),!!m(this,Cs))for(const t of m(this,Cs).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},k2=function(){return m(this,Cs).replaceAll(""," ")},hx=function(t){return t.replaceAll(" ","")},M2=function(t){const{value:n,fontSize:i,color:a,pageIndex:l}=this._initialData;return this._hasBeenMoved||t.value!==n||t.fontSize!==i||t.color.some((c,d)=>c!==a[d])||t.pageIndex!==l},k(_t,ca),Me(_t,"_freeTextDefaultContent",""),Me(_t,"_internalPadding",0),Me(_t,"_defaultColor",null),Me(_t,"_defaultFontSize",10),Me(_t,"_type","freetext"),Me(_t,"_editorType",Ge.FREETEXT);let dx=_t;class ye{toSVGPath(){vt("Abstract method `toSVGPath` must be implemented.")}get box(){vt("Abstract getter `box` must be implemented.")}serialize(e,t){vt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,i,a,l){l||(l=new Float32Array(e.length));for(let c=0,d=e.length;c<d;c+=2)l[c]=t+e[c]*i,l[c+1]=n+e[c+1]*a;return l}static _rescaleAndSwap(e,t,n,i,a,l){l||(l=new Float32Array(e.length));for(let c=0,d=e.length;c<d;c+=2)l[c]=t+e[c+1]*i,l[c+1]=n+e[c]*a;return l}static _translate(e,t,n,i){i||(i=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)i[a]=t+e[a],i[a+1]=n+e[a+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,i,a){switch(a){case 90:return[1-t/n,e/i];case 180:return[1-e/n,1-t/i];case 270:return[t/n,1-e/i];default:return[e/n,t/i]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,i,a,l){return[(e+5*n)/6,(t+5*i)/6,(5*n+a)/6,(5*i+l)/6,(n+a)/2,(i+l)/2]}}Me(ye,"PRECISION",1e-4);var Rs,Ti,md,gd,nr,$e,Kl,Jl,Mp,Ip,yd,vd,fo,Dp,$0,Y0,sn,rf,I2,D2,P2,L2,O2,U2;const Lr=class Lr{constructor({x:e,y:t},n,i,a,l,c=0){k(this,sn);k(this,Rs);k(this,Ti,[]);k(this,md);k(this,gd);k(this,nr,[]);k(this,$e,new Float32Array(18));k(this,Kl);k(this,Jl);k(this,Mp);k(this,Ip);k(this,yd);k(this,vd);k(this,fo,[]);C(this,Rs,n),C(this,vd,a*i),C(this,gd,l),m(this,$e).set([NaN,NaN,NaN,NaN,e,t],6),C(this,md,c),C(this,Ip,m(Lr,Dp)*i),C(this,Mp,m(Lr,Y0)*i),C(this,yd,i),m(this,fo).push(e,t)}isEmpty(){return isNaN(m(this,$e)[8])}add({x:e,y:t}){var K;C(this,Kl,e),C(this,Jl,t);const[n,i,a,l]=m(this,Rs);let[c,d,h,p]=m(this,$e).subarray(8,12);const v=e-h,x=t-p,S=Math.hypot(v,x);if(S<m(this,Mp))return!1;const A=S-m(this,Ip),E=A/S,N=E*v,R=E*x;let D=c,P=d;c=h,d=p,h+=N,p+=R,(K=m(this,fo))==null||K.push(e,t);const L=-R/A,H=N/A,z=L*m(this,vd),U=H*m(this,vd);return m(this,$e).set(m(this,$e).subarray(2,8),0),m(this,$e).set([h+z,p+U],4),m(this,$e).set(m(this,$e).subarray(14,18),12),m(this,$e).set([h-z,p-U],16),isNaN(m(this,$e)[6])?(m(this,nr).length===0&&(m(this,$e).set([c+z,d+U],2),m(this,nr).push(NaN,NaN,NaN,NaN,(c+z-n)/a,(d+U-i)/l),m(this,$e).set([c-z,d-U],14),m(this,Ti).push(NaN,NaN,NaN,NaN,(c-z-n)/a,(d-U-i)/l)),m(this,$e).set([D,P,c,d,h,p],6),!this.isEmpty()):(m(this,$e).set([D,P,c,d,h,p],6),Math.abs(Math.atan2(P-d,D-c)-Math.atan2(R,N))<Math.PI/2?([c,d,h,p]=m(this,$e).subarray(2,6),m(this,nr).push(NaN,NaN,NaN,NaN,((c+h)/2-n)/a,((d+p)/2-i)/l),[c,d,D,P]=m(this,$e).subarray(14,18),m(this,Ti).push(NaN,NaN,NaN,NaN,((D+c)/2-n)/a,((P+d)/2-i)/l),!0):([D,P,c,d,h,p]=m(this,$e).subarray(0,6),m(this,nr).push(((D+5*c)/6-n)/a,((P+5*d)/6-i)/l,((5*c+h)/6-n)/a,((5*d+p)/6-i)/l,((c+h)/2-n)/a,((d+p)/2-i)/l),[h,p,c,d,D,P]=m(this,$e).subarray(12,18),m(this,Ti).push(((D+5*c)/6-n)/a,((P+5*d)/6-i)/l,((5*c+h)/6-n)/a,((5*d+p)/6-i)/l,((c+h)/2-n)/a,((d+p)/2-i)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=m(this,nr),t=m(this,Ti);if(isNaN(m(this,$e)[6])&&!this.isEmpty())return M(this,sn,I2).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);M(this,sn,P2).call(this,n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return M(this,sn,D2).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,i,a,l){return new F2(e,t,n,i,a,l)}getOutlines(){var v;const e=m(this,nr),t=m(this,Ti),n=m(this,$e),[i,a,l,c]=m(this,Rs),d=new Float32Array((((v=m(this,fo))==null?void 0:v.length)??0)+2);for(let x=0,S=d.length-2;x<S;x+=2)d[x]=(m(this,fo)[x]-i)/l,d[x+1]=(m(this,fo)[x+1]-a)/c;if(d[d.length-2]=(m(this,Kl)-i)/l,d[d.length-1]=(m(this,Jl)-a)/c,isNaN(n[6])&&!this.isEmpty())return M(this,sn,L2).call(this,d);const h=new Float32Array(m(this,nr).length+24+m(this,Ti).length);let p=e.length;for(let x=0;x<p;x+=2){if(isNaN(e[x])){h[x]=h[x+1]=NaN;continue}h[x]=e[x],h[x+1]=e[x+1]}p=M(this,sn,U2).call(this,h,p);for(let x=t.length-6;x>=6;x-=6)for(let S=0;S<6;S+=2){if(isNaN(t[x+S])){h[p]=h[p+1]=NaN,p+=2;continue}h[p]=t[x+S],h[p+1]=t[x+S+1],p+=2}return M(this,sn,O2).call(this,h,p),this.newFreeDrawOutline(h,d,m(this,Rs),m(this,yd),m(this,md),m(this,gd))}};Rs=new WeakMap,Ti=new WeakMap,md=new WeakMap,gd=new WeakMap,nr=new WeakMap,$e=new WeakMap,Kl=new WeakMap,Jl=new WeakMap,Mp=new WeakMap,Ip=new WeakMap,yd=new WeakMap,vd=new WeakMap,fo=new WeakMap,Dp=new WeakMap,$0=new WeakMap,Y0=new WeakMap,sn=new WeakSet,rf=function(){const e=m(this,$e).subarray(4,6),t=m(this,$e).subarray(16,18),[n,i,a,l]=m(this,Rs);return[(m(this,Kl)+(e[0]-t[0])/2-n)/a,(m(this,Jl)+(e[1]-t[1])/2-i)/l,(m(this,Kl)+(t[0]-e[0])/2-n)/a,(m(this,Jl)+(t[1]-e[1])/2-i)/l]},I2=function(){const[e,t,n,i]=m(this,Rs),[a,l,c,d]=M(this,sn,rf).call(this);return`M${(m(this,$e)[2]-e)/n} ${(m(this,$e)[3]-t)/i} L${(m(this,$e)[4]-e)/n} ${(m(this,$e)[5]-t)/i} L${a} ${l} L${c} ${d} L${(m(this,$e)[16]-e)/n} ${(m(this,$e)[17]-t)/i} L${(m(this,$e)[14]-e)/n} ${(m(this,$e)[15]-t)/i} Z`},D2=function(e){const t=m(this,Ti);e.push(`L${t[4]} ${t[5]} Z`)},P2=function(e){const[t,n,i,a]=m(this,Rs),l=m(this,$e).subarray(4,6),c=m(this,$e).subarray(16,18),[d,h,p,v]=M(this,sn,rf).call(this);e.push(`L${(l[0]-t)/i} ${(l[1]-n)/a} L${d} ${h} L${p} ${v} L${(c[0]-t)/i} ${(c[1]-n)/a}`)},L2=function(e){const t=m(this,$e),[n,i,a,l]=m(this,Rs),[c,d,h,p]=M(this,sn,rf).call(this),v=new Float32Array(36);return v.set([NaN,NaN,NaN,NaN,(t[2]-n)/a,(t[3]-i)/l,NaN,NaN,NaN,NaN,(t[4]-n)/a,(t[5]-i)/l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,h,p,NaN,NaN,NaN,NaN,(t[16]-n)/a,(t[17]-i)/l,NaN,NaN,NaN,NaN,(t[14]-n)/a,(t[15]-i)/l],0),this.newFreeDrawOutline(v,e,m(this,Rs),m(this,yd),m(this,md),m(this,gd))},O2=function(e,t){const n=m(this,Ti);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},U2=function(e,t){const n=m(this,$e).subarray(4,6),i=m(this,$e).subarray(16,18),[a,l,c,d]=m(this,Rs),[h,p,v,x]=M(this,sn,rf).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-a)/c,(n[1]-l)/d,NaN,NaN,NaN,NaN,h,p,NaN,NaN,NaN,NaN,v,x,NaN,NaN,NaN,NaN,(i[0]-a)/c,(i[1]-l)/d],t),t+=24},k(Lr,Dp,8),k(Lr,$0,2),k(Lr,Y0,m(Lr,Dp)+m(Lr,$0));let w0=Lr;var bd,Xl,ea,Pp,ks,Lp,jt,K0,z2;class F2 extends ye{constructor(t,n,i,a,l,c){super();k(this,K0);k(this,bd);k(this,Xl,new Float32Array(4));k(this,ea);k(this,Pp);k(this,ks);k(this,Lp);k(this,jt);C(this,jt,t),C(this,ks,n),C(this,bd,i),C(this,Lp,a),C(this,ea,l),C(this,Pp,c),this.lastPoint=[NaN,NaN],M(this,K0,z2).call(this,c);const[d,h,p,v]=m(this,Xl);for(let x=0,S=t.length;x<S;x+=2)t[x]=(t[x]-d)/p,t[x+1]=(t[x+1]-h)/v;for(let x=0,S=n.length;x<S;x+=2)n[x]=(n[x]-d)/p,n[x+1]=(n[x+1]-h)/v}toSVGPath(){const t=[`M${m(this,jt)[4]} ${m(this,jt)[5]}`];for(let n=6,i=m(this,jt).length;n<i;n+=6){if(isNaN(m(this,jt)[n])){t.push(`L${m(this,jt)[n+4]} ${m(this,jt)[n+5]}`);continue}t.push(`C${m(this,jt)[n]} ${m(this,jt)[n+1]} ${m(this,jt)[n+2]} ${m(this,jt)[n+3]} ${m(this,jt)[n+4]} ${m(this,jt)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,i,a],l){const c=i-t,d=a-n;let h,p;switch(l){case 0:h=ye._rescale(m(this,jt),t,a,c,-d),p=ye._rescale(m(this,ks),t,a,c,-d);break;case 90:h=ye._rescaleAndSwap(m(this,jt),t,n,c,d),p=ye._rescaleAndSwap(m(this,ks),t,n,c,d);break;case 180:h=ye._rescale(m(this,jt),i,n,-c,d),p=ye._rescale(m(this,ks),i,n,-c,d);break;case 270:h=ye._rescaleAndSwap(m(this,jt),i,a,-c,-d),p=ye._rescaleAndSwap(m(this,ks),i,a,-c,-d);break}return{outline:Array.from(h),points:[Array.from(p)]}}get box(){return m(this,Xl)}newOutliner(t,n,i,a,l,c=0){return new w0(t,n,i,a,l,c)}getNewOutline(t,n){const[i,a,l,c]=m(this,Xl),[d,h,p,v]=m(this,bd),x=l*p,S=c*v,A=i*p+d,E=a*v+h,N=this.newOutliner({x:m(this,ks)[0]*x+A,y:m(this,ks)[1]*S+E},m(this,bd),m(this,Lp),t,m(this,Pp),n??m(this,ea));for(let R=2;R<m(this,ks).length;R+=2)N.add({x:m(this,ks)[R]*x+A,y:m(this,ks)[R+1]*S+E});return N.getOutlines()}}bd=new WeakMap,Xl=new WeakMap,ea=new WeakMap,Pp=new WeakMap,ks=new WeakMap,Lp=new WeakMap,jt=new WeakMap,K0=new WeakSet,z2=function(t){const n=m(this,jt);let i=n[4],a=n[5],l=i,c=a,d=i,h=a,p=i,v=a;const x=t?Math.max:Math.min;for(let A=6,E=n.length;A<E;A+=6){if(isNaN(n[A]))l=Math.min(l,n[A+4]),c=Math.min(c,n[A+5]),d=Math.max(d,n[A+4]),h=Math.max(h,n[A+5]),v<n[A+5]?(p=n[A+4],v=n[A+5]):v===n[A+5]&&(p=x(p,n[A+4]));else{const N=Te.bezierBoundingBox(i,a,...n.slice(A,A+6));l=Math.min(l,N[0]),c=Math.min(c,N[1]),d=Math.max(d,N[2]),h=Math.max(h,N[3]),v<N[3]?(p=N[2],v=N[3]):v===N[3]&&(p=x(p,N[2]))}i=n[A+4],a=n[A+5]}const S=m(this,Xl);S[0]=l-m(this,ea),S[1]=c-m(this,ea),S[2]=d-l+2*m(this,ea),S[3]=h-c+2*m(this,ea),this.lastPoint=[p,v]};var Op,Up,po,Ci,Xn,j2,t0,H2,B2,px;class fx{constructor(e,t=0,n=0,i=!0){k(this,Xn);k(this,Op);k(this,Up);k(this,po,[]);k(this,Ci,[]);let a=1/0,l=-1/0,c=1/0,d=-1/0;const h=10**-4;for(const{x:N,y:R,width:D,height:P}of e){const L=Math.floor((N-t)/h)*h,H=Math.ceil((N+D+t)/h)*h,z=Math.floor((R-t)/h)*h,U=Math.ceil((R+P+t)/h)*h,J=[L,z,U,!0],K=[H,z,U,!1];m(this,po).push(J,K),a=Math.min(a,L),l=Math.max(l,H),c=Math.min(c,z),d=Math.max(d,U)}const p=l-a+2*n,v=d-c+2*n,x=a-n,S=c-n,A=m(this,po).at(i?-1:-2),E=[A[0],A[2]];for(const N of m(this,po)){const[R,D,P]=N;N[0]=(R-x)/p,N[1]=(D-S)/v,N[2]=(P-S)/v}C(this,Op,new Float32Array([x,S,p,v])),C(this,Up,E)}getOutlines(){m(this,po).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of m(this,po))t[3]?(e.push(...M(this,Xn,px).call(this,t)),M(this,Xn,H2).call(this,t)):(M(this,Xn,B2).call(this,t),e.push(...M(this,Xn,px).call(this,t)));return M(this,Xn,j2).call(this,e)}}Op=new WeakMap,Up=new WeakMap,po=new WeakMap,Ci=new WeakMap,Xn=new WeakSet,j2=function(e){const t=[],n=new Set;for(const l of e){const[c,d,h]=l;t.push([c,d,l],[c,h,l])}t.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=t.length;l<c;l+=2){const d=t[l][2],h=t[l+1][2];d.push(h),h.push(d),n.add(d),n.add(h)}const i=[];let a;for(;n.size>0;){const l=n.values().next().value;let[c,d,h,p,v]=l;n.delete(l);let x=c,S=d;for(a=[c,h],i.push(a);;){let A;if(n.has(p))A=p;else if(n.has(v))A=v;else break;n.delete(A),[c,d,h,p,v]=A,x!==c&&(a.push(x,S,c,S===d?d:h),x=c),S=S===d?h:d}a.push(x,S)}return new T3(i,m(this,Op),m(this,Up))},t0=function(e){const t=m(this,Ci);let n=0,i=t.length-1;for(;n<=i;){const a=n+i>>1,l=t[a][0];if(l===e)return a;l<e?n=a+1:i=a-1}return i+1},H2=function([,e,t]){const n=M(this,Xn,t0).call(this,e);m(this,Ci).splice(n,0,[e,t])},B2=function([,e,t]){const n=M(this,Xn,t0).call(this,e);for(let i=n;i<m(this,Ci).length;i++){const[a,l]=m(this,Ci)[i];if(a!==e)break;if(a===e&&l===t){m(this,Ci).splice(i,1);return}}for(let i=n-1;i>=0;i--){const[a,l]=m(this,Ci)[i];if(a!==e)break;if(a===e&&l===t){m(this,Ci).splice(i,1);return}}},px=function(e){const[t,n,i]=e,a=[[t,n,i]],l=M(this,Xn,t0).call(this,i);for(let c=0;c<l;c++){const[d,h]=m(this,Ci)[c];for(let p=0,v=a.length;p<v;p++){const[,x,S]=a[p];if(!(h<=x||S<=d)){if(x>=d){if(S>h)a[p][1]=h;else{if(v===1)return[];a.splice(p,1),p--,v--}continue}a[p][2]=d,S>h&&a.push([t,h,S])}}}return a};var Fp,_d;class T3 extends ye{constructor(t,n,i){super();k(this,Fp);k(this,_d);C(this,_d,t),C(this,Fp,n),this.lastPoint=i}toSVGPath(){const t=[];for(const n of m(this,_d)){let[i,a]=n;t.push(`M${i} ${a}`);for(let l=2;l<n.length;l+=2){const c=n[l],d=n[l+1];c===i?(t.push(`V${d}`),a=d):d===a&&(t.push(`H${c}`),i=c)}t.push("Z")}return t.join(" ")}serialize([t,n,i,a],l){const c=[],d=i-t,h=a-n;for(const p of m(this,_d)){const v=new Array(p.length);for(let x=0;x<p.length;x+=2)v[x]=t+p[x]*d,v[x+1]=a-p[x+1]*h;c.push(v)}return c}get box(){return m(this,Fp)}get classNamesForOutlining(){return["highlightOutline"]}}Fp=new WeakMap,_d=new WeakMap;class mx extends w0{newFreeDrawOutline(e,t,n,i,a,l){return new C3(e,t,n,i,a,l)}}class C3 extends F2{newOutliner(e,t,n,i,a,l=0){return new mx(e,t,n,i,a,l)}}var Ni,Wl,xd,nn,zp,wd,jp,Hp,mo,Ri,Sd,Bp,mt,gx,yx,vx,Zo,G2,Ga;const os=class os{constructor({editor:e=null,uiManager:t=null}){k(this,mt);k(this,Ni,null);k(this,Wl,null);k(this,xd);k(this,nn,null);k(this,zp,!1);k(this,wd,!1);k(this,jp,null);k(this,Hp);k(this,mo,null);k(this,Ri,null);k(this,Sd);var n;e?(C(this,wd,!1),C(this,Sd,Ze.HIGHLIGHT_COLOR),C(this,jp,e)):(C(this,wd,!0),C(this,Sd,Ze.HIGHLIGHT_DEFAULT_COLOR)),C(this,Ri,(e==null?void 0:e._uiManager)||t),C(this,Hp,m(this,Ri)._eventBus),C(this,xd,(e==null?void 0:e.color)||((n=m(this,Ri))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),m(os,Bp)||C(os,Bp,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Ye(this,"_keyboardManager",new Zp([[["Escape","mac+Escape"],os.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],os.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],os.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],os.prototype._moveToPrevious],[["Home","mac+Home"],os.prototype._moveToBeginning],[["End","mac+End"],os.prototype._moveToEnd]]))}renderButton(){const e=C(this,Ni,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=m(this,Ri)._signal;e.addEventListener("click",M(this,mt,Zo).bind(this),{signal:t}),e.addEventListener("keydown",M(this,mt,vx).bind(this),{signal:t});const n=C(this,Wl,document.createElement("span"));return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=m(this,xd),e.append(n),e}renderMainDropdown(){const e=C(this,nn,M(this,mt,gx).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===m(this,Ni)){M(this,mt,Zo).call(this,e);return}const t=e.target.getAttribute("data-color");t&&M(this,mt,yx).call(this,t,e)}_moveToNext(e){var t,n;if(!m(this,mt,Ga)){M(this,mt,Zo).call(this,e);return}if(e.target===m(this,Ni)){(t=m(this,nn).firstChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=m(this,nn))==null?void 0:t.firstChild)||e.target===m(this,Ni)){m(this,mt,Ga)&&this._hideDropdownFromKeyboard();return}m(this,mt,Ga)||M(this,mt,Zo).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!m(this,mt,Ga)){M(this,mt,Zo).call(this,e);return}(t=m(this,nn).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!m(this,mt,Ga)){M(this,mt,Zo).call(this,e);return}(t=m(this,nn).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=m(this,nn))==null||e.classList.add("hidden"),(t=m(this,mo))==null||t.abort(),C(this,mo,null)}_hideDropdownFromKeyboard(){var e;if(!m(this,wd)){if(!m(this,mt,Ga)){(e=m(this,jp))==null||e.unselect();return}this.hideDropdown(),m(this,Ni).focus({preventScroll:!0,focusVisible:m(this,zp)})}}updateColor(e){if(m(this,Wl)&&(m(this,Wl).style.backgroundColor=e),!m(this,nn))return;const t=m(this,Ri).highlightColors.values();for(const n of m(this,nn).children)n.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=m(this,Ni))==null||e.remove(),C(this,Ni,null),C(this,Wl,null),(t=m(this,nn))==null||t.remove(),C(this,nn,null)}};Ni=new WeakMap,Wl=new WeakMap,xd=new WeakMap,nn=new WeakMap,zp=new WeakMap,wd=new WeakMap,jp=new WeakMap,Hp=new WeakMap,mo=new WeakMap,Ri=new WeakMap,Sd=new WeakMap,Bp=new WeakMap,mt=new WeakSet,gx=function(){const e=document.createElement("div"),t=m(this,Ri)._signal;e.addEventListener("contextmenu",Oi,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,i]of m(this,Ri).highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",i),a.title=n,a.setAttribute("data-l10n-id",m(os,Bp)[n]);const l=document.createElement("span");a.append(l),l.className="swatch",l.style.backgroundColor=i,a.setAttribute("aria-selected",i===m(this,xd)),a.addEventListener("click",M(this,mt,yx).bind(this,i),{signal:t}),e.append(a)}return e.addEventListener("keydown",M(this,mt,vx).bind(this),{signal:t}),e},yx=function(e,t){t.stopPropagation(),m(this,Hp).dispatch("switchannotationeditorparams",{source:this,type:m(this,Sd),value:e})},vx=function(e){os._keyboardManager.exec(this,e)},Zo=function(e){if(m(this,mt,Ga)){this.hideDropdown();return}if(C(this,zp,e.detail===0),m(this,mo)||(C(this,mo,new AbortController),window.addEventListener("pointerdown",M(this,mt,G2).bind(this),{signal:m(this,Ri).combinedSignal(m(this,mo))})),m(this,nn)){m(this,nn).classList.remove("hidden");return}const t=C(this,nn,M(this,mt,gx).call(this));m(this,Ni).append(t)},G2=function(e){var t;(t=m(this,nn))!=null&&t.contains(e.target)||this.hideDropdown()},Ga=function(){return m(this,nn)&&!m(this,nn).classList.contains("hidden")},k(os,Bp,null);let S0=os;var Ad,Gp,ta,Ql,Ed,us,qp,Vp,Zl,ii,Ms,An,Td,na,Pn,Cd,ri,$p,He,bx,n0,q2,V2,$2,_x,el,ci,xu,Y2,s0,af,K2,J2,X2,W2,Q2;const ot=class ot extends Dt{constructor(t){super({...t,name:"highlightEditor"});k(this,He);k(this,Ad,null);k(this,Gp,0);k(this,ta);k(this,Ql,null);k(this,Ed,null);k(this,us,null);k(this,qp,null);k(this,Vp,0);k(this,Zl,null);k(this,ii,null);k(this,Ms,null);k(this,An,!1);k(this,Td,null);k(this,na);k(this,Pn,null);k(this,Cd,"");k(this,ri);k(this,$p,"");this.color=t.color||ot._defaultColor,C(this,ri,t.thickness||ot._defaultThickness),C(this,na,t.opacity||ot._defaultOpacity),C(this,ta,t.boxes||null),C(this,$p,t.methodOfCreation||""),C(this,Cd,t.text||""),this._isDraggable=!1,t.highlightId>-1?(C(this,An,!0),M(this,He,n0).call(this,t),M(this,He,el).call(this)):m(this,ta)&&(C(this,Ad,t.anchorNode),C(this,Gp,t.anchorOffset),C(this,qp,t.focusNode),C(this,Vp,t.focusOffset),M(this,He,bx).call(this),M(this,He,el).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=ot.prototype;return Ye(this,"_keyboardManager",new Zp([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:m(this,An)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:m(this,ri),methodOfCreation:m(this,$p)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var i;Dt.initialize(t,n),ot._defaultColor||(ot._defaultColor=((i=n.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case Ze.HIGHLIGHT_DEFAULT_COLOR:ot._defaultColor=n;break;case Ze.HIGHLIGHT_THICKNESS:ot._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return m(this,Td)}updateParams(t,n){switch(t){case Ze.HIGHLIGHT_COLOR:M(this,He,q2).call(this,n);break;case Ze.HIGHLIGHT_THICKNESS:M(this,He,V2).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Ze.HIGHLIGHT_DEFAULT_COLOR,ot._defaultColor],[Ze.HIGHLIGHT_THICKNESS,ot._defaultThickness]]}get propertiesToUpdate(){return[[Ze.HIGHLIGHT_COLOR,this.color||ot._defaultColor],[Ze.HIGHLIGHT_THICKNESS,m(this,ri)||ot._defaultThickness],[Ze.HIGHLIGHT_FREE,m(this,An)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(C(this,Ed,new S0({editor:this})),t.addColorPicker(m(this,Ed))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(M(this,He,af).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,M(this,He,af).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){M(this,He,_x).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,He,el).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let n=!1;this.parent&&!t?M(this,He,_x).call(this):t&&(M(this,He,el).call(this,t),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var a,l,c;const{drawLayer:n}=this.parent;let i;m(this,An)?(t=(t-this.rotation+360)%360,i=M(a=ot,ci,xu).call(a,m(this,ii).box,t)):i=M(l=ot,ci,xu).call(l,[this.x,this.y,this.width,this.height],t),n.updateProperties(m(this,Ms),{bbox:i,root:{"data-main-rotation":t}}),n.updateProperties(m(this,Pn),{bbox:M(c=ot,ci,xu).call(c,m(this,us).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();m(this,Cd)&&(t.setAttribute("aria-label",m(this,Cd)),t.setAttribute("role","mark")),m(this,An)?t.classList.add("free"):this.div.addEventListener("keydown",M(this,He,Y2).bind(this),{signal:this._uiManager._signal});const n=C(this,Zl,document.createElement("div"));t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=m(this,Ql);const[i,a]=this.parentDimensions;return this.setDims(this.width*i,this.height*a),b0(this,m(this,Zl),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(m(this,Pn),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(m(this,Pn),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:M(this,He,s0).call(this,!0);break;case 1:case 3:M(this,He,s0).call(this,!1);break}}select(){var t;super.select(),m(this,Pn)&&((t=this.parent)==null||t.drawLayer.updateProperties(m(this,Pn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),m(this,Pn)&&((t=this.parent)==null||t.drawLayer.updateProperties(m(this,Pn),{rootClass:{selected:!1}}),m(this,An)||M(this,He,s0).call(this,!1))}get _mustFixPosition(){return!m(this,An)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(m(this,Ms),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(m(this,Pn),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:i,x:a,y:l}){const{x:c,y:d,width:h,height:p}=i.getBoundingClientRect(),v=new AbortController,x=t.combinedSignal(v),S=A=>{v.abort(),M(this,ci,W2).call(this,t,A)};window.addEventListener("blur",S,{signal:x}),window.addEventListener("pointerup",S,{signal:x}),window.addEventListener("pointerdown",zs,{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",Oi,{signal:x}),i.addEventListener("pointermove",M(this,ci,X2).bind(this,t),{signal:x}),this._freeHighlight=new mx({x:a,y:l},[c,d,h,p],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,i){var E,N,R,D;let a=null;if(t instanceof A2){const{data:{quadPoints:P,rect:L,rotation:H,id:z,color:U,opacity:J,popupRef:K},parent:{page:{pageNumber:ie}}}=t;a=t={annotationType:Ge.HIGHLIGHT,color:Array.from(U),opacity:J,quadPoints:P,boxes:null,pageIndex:ie-1,rect:L.slice(0),rotation:H,id:z,deleted:!1,popupRef:K}}else if(t instanceof yw){const{data:{inkLists:P,rect:L,rotation:H,id:z,color:U,borderStyle:{rawWidth:J},popupRef:K},parent:{page:{pageNumber:ie}}}=t;a=t={annotationType:Ge.HIGHLIGHT,color:Array.from(U),thickness:J,inkLists:P,boxes:null,pageIndex:ie-1,rect:L.slice(0),rotation:H,id:z,deleted:!1,popupRef:K}}const{color:l,quadPoints:c,inkLists:d,opacity:h}=t,p=await super.deserialize(t,n,i);p.color=Te.makeHexColor(...l),C(p,na,h||1),d&&C(p,ri,t.thickness),p.annotationElementId=t.id||null,p._initialData=a;const[v,x]=p.pageDimensions,[S,A]=p.pageTranslation;if(c){const P=C(p,ta,[]);for(let L=0;L<c.length;L+=8)P.push({x:(c[L]-S)/v,y:1-(c[L+1]-A)/x,width:(c[L+2]-c[L])/v,height:(c[L+1]-c[L+5])/x});M(E=p,He,bx).call(E),M(N=p,He,el).call(N),p.rotate(p.rotation)}else if(d){C(p,An,!0);const P=d[0],L={x:P[0]-S,y:x-(P[1]-A)},H=new mx(L,[0,0,v,x],1,m(p,ri)/2,!0,.001);for(let J=0,K=P.length;J<K;J+=2)L.x=P[J]-S,L.y=x-(P[J+1]-A),H.add(L);const{id:z,clipPathId:U}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:p.color,"fill-opacity":p._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:H.toSVGPath()}},!0,!0);M(R=p,He,n0).call(R,{highlightOutlines:H.getOutlines(),highlightId:z,clipPathId:U}),M(D=p,He,el).call(D)}return p}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),i=Dt._colorManager.convert(this.color),a={annotationType:Ge.HIGHLIGHT,color:i,opacity:m(this,na),thickness:m(this,ri),quadPoints:M(this,He,K2).call(this),outlines:M(this,He,J2).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:M(this,He,af).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!M(this,He,Q2).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ad=new WeakMap,Gp=new WeakMap,ta=new WeakMap,Ql=new WeakMap,Ed=new WeakMap,us=new WeakMap,qp=new WeakMap,Vp=new WeakMap,Zl=new WeakMap,ii=new WeakMap,Ms=new WeakMap,An=new WeakMap,Td=new WeakMap,na=new WeakMap,Pn=new WeakMap,Cd=new WeakMap,ri=new WeakMap,$p=new WeakMap,He=new WeakSet,bx=function(){const t=new fx(m(this,ta),.001);C(this,ii,t.getOutlines()),[this.x,this.y,this.width,this.height]=m(this,ii).box;const n=new fx(m(this,ta),.0025,.001,this._uiManager.direction==="ltr");C(this,us,n.getOutlines());const{lastPoint:i}=m(this,us);C(this,Td,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},n0=function({highlightOutlines:t,highlightId:n,clipPathId:i}){var v,x;if(C(this,ii,t),C(this,us,t.getNewOutline(m(this,ri)/2+1.5,.0025)),n>=0)C(this,Ms,n),C(this,Ql,i),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),C(this,Pn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:m(this,us).box,path:{d:m(this,us).toSVGPath()}},!0));else if(this.parent){const S=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(m(this,Ms),{bbox:M(v=ot,ci,xu).call(v,m(this,ii).box,(S-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(m(this,Pn),{bbox:M(x=ot,ci,xu).call(x,m(this,us).box,S),path:{d:m(this,us).toSVGPath()}})}const[l,c,d,h]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=d,this.height=h;break;case 90:{const[S,A]=this.parentDimensions;this.x=c,this.y=1-l,this.width=d*A/S,this.height=h*S/A;break}case 180:this.x=1-l,this.y=1-c,this.width=d,this.height=h;break;case 270:{const[S,A]=this.parentDimensions;this.x=1-c,this.y=l,this.width=d*A/S,this.height=h*S/A;break}}const{lastPoint:p}=m(this,us);C(this,Td,[(p[0]-l)/d,(p[1]-c)/h])},q2=function(t){const n=(l,c)=>{var d,h;this.color=l,C(this,na,c),(d=this.parent)==null||d.drawLayer.updateProperties(m(this,Ms),{root:{fill:l,"fill-opacity":c}}),(h=m(this,Ed))==null||h.updateColor(l)},i=this.color,a=m(this,na);this.addCommands({cmd:n.bind(this,t,ot._defaultOpacity),undo:n.bind(this,i,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},V2=function(t){const n=m(this,ri),i=a=>{C(this,ri,a),M(this,He,$2).call(this,a)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},$2=function(t){if(!m(this,An))return;M(this,He,n0).call(this,{highlightOutlines:m(this,ii).getNewOutline(t/2)}),this.fixAndSetPosition();const[n,i]=this.parentDimensions;this.setDims(this.width*n,this.height*i)},_x=function(){m(this,Ms)===null||!this.parent||(this.parent.drawLayer.remove(m(this,Ms)),C(this,Ms,null),this.parent.drawLayer.remove(m(this,Pn)),C(this,Pn,null))},el=function(t=this.parent){m(this,Ms)===null&&({id:Hn(this,Ms)._,clipPathId:Hn(this,Ql)._}=t.drawLayer.draw({bbox:m(this,ii).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":m(this,na)},rootClass:{highlight:!0,free:m(this,An)},path:{d:m(this,ii).toSVGPath()}},!1,!0),C(this,Pn,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:m(this,An)},bbox:m(this,us).box,path:{d:m(this,us).toSVGPath()}},m(this,An))),m(this,Zl)&&(m(this,Zl).style.clipPath=m(this,Ql)))},ci=new WeakSet,xu=function([t,n,i,a],l){switch(l){case 90:return[1-n-a,t,a,i];case 180:return[1-t-i,1-n-a,i,a];case 270:return[n,1-t-i,a,i]}return[t,n,i,a]},Y2=function(t){ot._keyboardManager.exec(this,t)},s0=function(t){if(!m(this,Ad))return;const n=window.getSelection();t?n.setPosition(m(this,Ad),m(this,Gp)):n.setPosition(m(this,qp),m(this,Vp))},af=function(){return m(this,An)?this.rotation:0},K2=function(){if(m(this,An))return null;const[t,n]=this.pageDimensions,[i,a]=this.pageTranslation,l=m(this,ta),c=new Float32Array(l.length*8);let d=0;for(const{x:h,y:p,width:v,height:x}of l){const S=h*t+i,A=(1-p)*n+a;c[d]=c[d+4]=S,c[d+1]=c[d+3]=A,c[d+2]=c[d+6]=S+v*t,c[d+5]=c[d+7]=A-x*n,d+=8}return c},J2=function(t){return m(this,ii).serialize(t,M(this,He,af).call(this))},X2=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},W2=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Q2=function(t){const{color:n}=this._initialData;return t.color.some((i,a)=>i!==n[a])},k(ot,ci),Me(ot,"_defaultColor",null),Me(ot,"_defaultOpacity",1),Me(ot,"_defaultThickness",12),Me(ot,"_type","highlight"),Me(ot,"_editorType",Ge.HIGHLIGHT),Me(ot,"_freeHighlightId",-1),Me(ot,"_freeHighlight",null),Me(ot,"_freeHighlightClipId","");let A0=ot;var ec;class N3{constructor(){k(this,ec,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))this.updateProperty(t,n)}updateSVGProperty(e,t){m(this,ec)[e]=t}toSVGProperties(){const e=m(this,ec);return C(this,ec,Object.create(null)),{root:e}}reset(){C(this,ec,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){vt("Not implemented")}}ec=new WeakMap;var Is,Nd,dn,tc,nc,go,yo,vo,sc,et,wx,Sx,Ax,of,Z2,i0,lf,wu;const _e=class _e extends Dt{constructor(t){super(t);k(this,et);k(this,Is,null);k(this,Nd);Me(this,"_drawId",null);C(this,Nd,t.mustBeCommitted||!1),t.drawOutlines&&(M(this,et,wx).call(this,t),M(this,et,of).call(this))}static _mergeSVGProperties(t,n){const i=new Set(Object.keys(t));for(const[a,l]of Object.entries(n))i.has(a)?Object.assign(t[a],l):t[a]=l;return t}static getDefaultDrawingOptions(t){vt("Not implemented")}static get typesMap(){vt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,n),this._currentParent&&(m(_e,dn).updateProperty(i,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[i,a]of this.typesMap)t.push([i,n[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[i,a]of this.constructor.typesMap)t.push([i,n[a]]);return t}_updateProperty(t,n,i){const a=this._drawingOptions,l=a[n],c=d=>{var p;a.updateProperty(n,d);const h=m(this,Is).updateProperty(n,d);h&&M(this,et,lf).call(this,h),(p=this.parent)==null||p.drawLayer.updateProperties(this._drawId,a.toSVGProperties())};this.addCommands({cmd:c.bind(this,i),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(m(this,Is).getPathResizingSVGProperties(M(this,et,i0).call(this)),{bbox:M(this,et,wu).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(m(this,Is).getPathResizedSVGProperties(M(this,et,i0).call(this)),{bbox:M(this,et,wu).call(this)}))}_onTranslating(t,n){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:M(this,et,wu).call(this,t,n)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(m(this,Is).getPathTranslatedSVGProperties(M(this,et,i0).call(this),this.parentDimensions),{bbox:M(this,et,wu).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,m(this,Nd)&&(C(this,Nd,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){M(this,et,Ax).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,et,of).call(this),M(this,et,lf).call(this,m(this,Is).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),M(this,et,Ax).call(this)):t&&(this._uiManager.addShouldRescale(this),M(this,et,of).call(this,t),n=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties({bbox:M(this,et,wu).call(this)},m(this,Is).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&M(this,et,lf).call(this,m(this,Is).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const n=document.createElement("div");t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal";const[i,a]=this.parentDimensions;return this.setDims(this.width*i,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,n,i,a,l){vt("Not implemented")}static startDrawing(t,n,i,a){var N;const{target:l,offsetX:c,offsetY:d,pointerId:h,pointerType:p}=a;if(m(_e,yo)&&m(_e,yo)!==p)return;const{viewport:{rotation:v}}=t,{width:x,height:S}=l.getBoundingClientRect(),A=C(_e,tc,new AbortController),E=t.combinedSignal(A);if(m(_e,go)||C(_e,go,h),m(_e,yo)??C(_e,yo,p),window.addEventListener("pointerup",R=>{var D;m(_e,go)===R.pointerId?this._endDraw(R):(D=m(_e,vo))==null||D.delete(R.pointerId)},{signal:E}),window.addEventListener("pointercancel",R=>{var D;m(_e,go)===R.pointerId?this._currentParent.endDrawingSession():(D=m(_e,vo))==null||D.delete(R.pointerId)},{signal:E}),window.addEventListener("pointerdown",R=>{m(_e,yo)===R.pointerType&&((m(_e,vo)||C(_e,vo,new Set)).add(R.pointerId),m(_e,dn).isCancellable()&&(m(_e,dn).removeLastElement(),m(_e,dn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:E}),window.addEventListener("contextmenu",Oi,{signal:E}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:E}),l.addEventListener("touchmove",R=>{R.timeStamp===m(_e,sc)&&zs(R)},{signal:E}),t.toggleDrawing(),(N=n._editorUndoBar)==null||N.hide(),m(_e,dn)){t.drawLayer.updateProperties(this._currentDrawId,m(_e,dn).startNew(c,d,x,S,v));return}n.updateUIForDefaultProperties(this),C(_e,dn,this.createDrawerInstance(c,d,x,S,v)),C(_e,nc,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(m(_e,nc).toSVGProperties(),m(_e,dn).defaultSVGProperties),!0,!1)}static _drawMove(t){var l;if(C(_e,sc,-1),!m(_e,dn))return;const{offsetX:n,offsetY:i,pointerId:a}=t;if(m(_e,go)===a){if(((l=m(_e,vo))==null?void 0:l.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,m(_e,dn).add(n,i)),C(_e,sc,t.timeStamp),zs(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,C(_e,dn,null),C(_e,nc,null),C(_e,yo,null),C(_e,sc,NaN)),m(_e,tc)&&(m(_e,tc).abort(),C(_e,tc,null),C(_e,go,NaN),C(_e,vo,null))}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),t&&n.drawLayer.updateProperties(this._currentDrawId,m(_e,dn).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=m(_e,dn),a=this._currentDrawId,l=i.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(a,i.setLastElement(l))},undo:()=>{n.drawLayer.updateProperties(a,i.removeLastElement())},mustExec:!1,type:Ze.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(Ze.DRAW_STEP),!m(_e,dn).isEmpty()){const{pageDimensions:[i,a],scale:l}=n,c=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:m(_e,dn).getOutlines(i*l,a*l,l,this._INNER_MARGIN),drawingOptions:m(_e,nc),mustBeCommitted:!t});return this._cleanup(!0),c}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,i,a,l,c){vt("Not implemented")}static async deserialize(t,n,i){var v,x;const{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:d}}=n.viewport,h=this.deserializeDraw(c,d,a,l,this._INNER_MARGIN,t),p=await super.deserialize(t,n,i);return p.createDrawingOptions(t),M(v=p,et,wx).call(v,{drawOutlines:h}),M(x=p,et,of).call(x),p.onScaleChanging(),p.rotate(),p}serializeDraw(t){const[n,i]=this.pageTranslation,[a,l]=this.pageDimensions;return m(this,Is).serialize([n,i,a,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Is=new WeakMap,Nd=new WeakMap,dn=new WeakMap,tc=new WeakMap,nc=new WeakMap,go=new WeakMap,yo=new WeakMap,vo=new WeakMap,sc=new WeakMap,et=new WeakSet,wx=function({drawOutlines:t,drawId:n,drawingOptions:i}){C(this,Is,t),this._drawingOptions||(this._drawingOptions=i),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=M(this,et,Sx).call(this,t,this.parent),M(this,et,lf).call(this,t.box)},Sx=function(t,n){const{id:i}=n.drawLayer.draw(_e._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},Ax=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},of=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=M(this,et,Sx).call(this,m(this,Is),t)}},Z2=function([t,n,i,a]){const{parentDimensions:[l,c],rotation:d}=this;switch(d){case 90:return[n,1-t,i*(c/l),a*(l/c)];case 180:return[1-t,1-n,i,a];case 270:return[1-n,t,i*(c/l),a*(l/c)];default:return[t,n,i,a]}},i0=function(){const{x:t,y:n,width:i,height:a,parentDimensions:[l,c],rotation:d}=this;switch(d){case 90:return[1-n,t,i*(l/c),a*(c/l)];case 180:return[1-t,1-n,i,a];case 270:return[n,1-t,i*(l/c),a*(c/l)];default:return[t,n,i,a]}},lf=function(t){if([this.x,this.y,this.width,this.height]=M(this,et,Z2).call(this,t),this.div){this.fixAndSetPosition();const[n,i]=this.parentDimensions;this.setDims(this.width*n,this.height*i)}this._onResized()},wu=function(){const{x:t,y:n,width:i,height:a,rotation:l,parentRotation:c,parentDimensions:[d,h]}=this;switch((l*4+c)/90){case 1:return[1-n-a,t,a,i];case 2:return[1-t-i,1-n-a,i,a];case 3:return[n,1-t-i,a,i];case 4:return[t,n-i*(d/h),a*(h/d),i*(d/h)];case 5:return[1-n,t,i*(d/h),a*(h/d)];case 6:return[1-t-a*(h/d),1-n,a*(h/d),i*(d/h)];case 7:return[n-i*(d/h),1-t-a*(h/d),i*(d/h),a*(h/d)];case 8:return[t-i,n-a,i,a];case 9:return[1-n,t-i,a,i];case 10:return[1-t,1-n,i,a];case 11:return[n-a,1-t,a,i];case 12:return[t-a*(h/d),n,a*(h/d),i*(d/h)];case 13:return[1-n-i*(d/h),t-a*(h/d),i*(d/h),a*(h/d)];case 14:return[1-t,1-n-i*(d/h),a*(h/d),i*(d/h)];case 15:return[n,1-t,i*(d/h),a*(h/d)];default:return[t,n,i,a]}},Me(_e,"_currentDrawId",-1),Me(_e,"_currentParent",null),k(_e,dn,null),k(_e,tc,null),k(_e,nc,null),k(_e,go,NaN),k(_e,yo,null),k(_e,vo,null),k(_e,sc,NaN),Me(_e,"_INNER_MARGIN",3);let xx=_e;var sr,hn,fn,ic,Rd,qn,En,ai,rc,ac,oc,kd,r0;class R3{constructor(e,t,n,i,a,l){k(this,kd);k(this,sr,new Float64Array(6));k(this,hn);k(this,fn);k(this,ic);k(this,Rd);k(this,qn);k(this,En,"");k(this,ai,0);k(this,rc,new E0);k(this,ac);k(this,oc);C(this,ac,n),C(this,oc,i),C(this,ic,a),C(this,Rd,l),[e,t]=M(this,kd,r0).call(this,e,t);const c=C(this,hn,[NaN,NaN,NaN,NaN,e,t]);C(this,qn,[e,t]),C(this,fn,[{line:c,points:m(this,qn)}]),m(this,sr).set(c,0)}updateProperty(e,t){e==="stroke-width"&&C(this,Rd,t)}isEmpty(){return!m(this,fn)||m(this,fn).length===0}isCancellable(){return m(this,qn).length<=10}add(e,t){[e,t]=M(this,kd,r0).call(this,e,t);const[n,i,a,l]=m(this,sr).subarray(2,6),c=e-a,d=t-l;return Math.hypot(m(this,ac)*c,m(this,oc)*d)<=2?null:(m(this,qn).push(e,t),isNaN(n)?(m(this,sr).set([a,l,e,t],2),m(this,hn).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(m(this,sr)[0])&&m(this,hn).splice(6,6),m(this,sr).set([n,i,a,l,e,t],0),m(this,hn).push(...ye.createBezierPoints(n,i,a,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(m(this,qn).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,i,a){C(this,ac,n),C(this,oc,i),C(this,ic,a),[e,t]=M(this,kd,r0).call(this,e,t);const l=C(this,hn,[NaN,NaN,NaN,NaN,e,t]);C(this,qn,[e,t]);const c=m(this,fn).at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),m(this,fn).push({line:l,points:m(this,qn)}),m(this,sr).set(l,0),C(this,ai,0),this.toSVGPath(),null}getLastElement(){return m(this,fn).at(-1)}setLastElement(e){return m(this,fn)?(m(this,fn).push(e),C(this,hn,e.line),C(this,qn,e.points),C(this,ai,0),{path:{d:this.toSVGPath()}}):m(this,rc).setLastElement(e)}removeLastElement(){if(!m(this,fn))return m(this,rc).removeLastElement();m(this,fn).pop(),C(this,En,"");for(let e=0,t=m(this,fn).length;e<t;e++){const{line:n,points:i}=m(this,fn)[e];C(this,hn,n),C(this,qn,i),C(this,ai,0),this.toSVGPath()}return{path:{d:m(this,En)}}}toSVGPath(){const e=ye.svgRound(m(this,hn)[4]),t=ye.svgRound(m(this,hn)[5]);if(m(this,qn).length===2)return C(this,En,`${m(this,En)} M ${e} ${t} Z`),m(this,En);if(m(this,qn).length<=6){const i=m(this,En).lastIndexOf("M");C(this,En,`${m(this,En).slice(0,i)} M ${e} ${t}`),C(this,ai,6)}if(m(this,qn).length===4){const i=ye.svgRound(m(this,hn)[10]),a=ye.svgRound(m(this,hn)[11]);return C(this,En,`${m(this,En)} L ${i} ${a}`),C(this,ai,12),m(this,En)}const n=[];m(this,ai)===0&&(n.push(`M ${e} ${t}`),C(this,ai,6));for(let i=m(this,ai),a=m(this,hn).length;i<a;i+=6){const[l,c,d,h,p,v]=m(this,hn).slice(i,i+6).map(ye.svgRound);n.push(`C${l} ${c} ${d} ${h} ${p} ${v}`)}return C(this,En,m(this,En)+n.join(" ")),C(this,ai,m(this,hn).length),m(this,En)}getOutlines(e,t,n,i){const a=m(this,fn).at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),m(this,rc).build(m(this,fn),e,t,n,m(this,ic),m(this,Rd),i),C(this,sr,null),C(this,hn,null),C(this,fn,null),C(this,En,null),m(this,rc)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}sr=new WeakMap,hn=new WeakMap,fn=new WeakMap,ic=new WeakMap,Rd=new WeakMap,qn=new WeakMap,En=new WeakMap,ai=new WeakMap,rc=new WeakMap,ac=new WeakMap,oc=new WeakMap,kd=new WeakSet,r0=function(e,t){return ye._normalizePoint(e,t,m(this,ac),m(this,oc),m(this,ic))};var Vn,Yp,Kp,Ds,ir,rr,Md,Id,Dd,Cn,Ir,ek,tk,nk;const Iw=class Iw extends ye{constructor(){super(...arguments);k(this,Cn);k(this,Vn);k(this,Yp,0);k(this,Kp);k(this,Ds);k(this,ir);k(this,rr);k(this,Md);k(this,Id);k(this,Dd)}build(t,n,i,a,l,c,d){C(this,ir,n),C(this,rr,i),C(this,Md,a),C(this,Id,l),C(this,Dd,c),C(this,Kp,d??0),C(this,Ds,t),M(this,Cn,tk).call(this)}setLastElement(t){return m(this,Ds).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return m(this,Ds).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of m(this,Ds)){if(t.push(`M${ye.svgRound(n[4])} ${ye.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12){t.push(`L${ye.svgRound(n[10])} ${ye.svgRound(n[11])}`);continue}for(let i=6,a=n.length;i<a;i+=6){const[l,c,d,h,p,v]=n.subarray(i,i+6).map(ye.svgRound);t.push(`C${l} ${c} ${d} ${h} ${p} ${v}`)}}return t.join("")}serialize([t,n,i,a],l){const c=[],d=[],[h,p,v,x]=M(this,Cn,ek).call(this);let S,A,E,N,R,D,P,L,H;switch(m(this,Id)){case 0:H=ye._rescale,S=t,A=n+a,E=i,N=-a,R=t+h*i,D=n+(1-p-x)*a,P=t+(h+v)*i,L=n+(1-p)*a;break;case 90:H=ye._rescaleAndSwap,S=t,A=n,E=i,N=a,R=t+p*i,D=n+h*a,P=t+(p+x)*i,L=n+(h+v)*a;break;case 180:H=ye._rescale,S=t+i,A=n,E=-i,N=a,R=t+(1-h-v)*i,D=n+p*a,P=t+(1-h)*i,L=n+(p+x)*a;break;case 270:H=ye._rescaleAndSwap,S=t+i,A=n+a,E=-i,N=-a,R=t+(1-p-x)*i,D=n+(1-h-v)*a,P=t+(1-p)*i,L=n+(1-h)*a;break}for(const{line:z,points:U}of m(this,Ds))c.push(H(z,S,A,E,N,l?new Array(z.length):null)),d.push(H(U,S,A,E,N,l?new Array(U.length):null));return{lines:c,points:d,rect:[R,D,P,L]}}static deserialize(t,n,i,a,l,{paths:{lines:c,points:d},rotation:h,thickness:p}){const v=[];let x,S,A,E,N;switch(h){case 0:N=ye._rescale,x=-t/i,S=n/a+1,A=1/i,E=-1/a;break;case 90:N=ye._rescaleAndSwap,x=-n/a,S=-t/i,A=1/a,E=1/i;break;case 180:N=ye._rescale,x=t/i+1,S=-n/a,A=-1/i,E=1/a;break;case 270:N=ye._rescaleAndSwap,x=n/a+1,S=t/i+1,A=-1/a,E=-1/i;break}if(!c){c=[];for(const D of d){const P=D.length;if(P===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,D[0],D[1]]));continue}if(P===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,D[0],D[1],NaN,NaN,NaN,NaN,D[2],D[3]]));continue}const L=new Float32Array(3*(P-2));c.push(L);let[H,z,U,J]=D.subarray(0,4);L.set([NaN,NaN,NaN,NaN,H,z],0);for(let K=4;K<P;K+=2){const ie=D[K],oe=D[K+1];L.set(ye.createBezierPoints(H,z,U,J,ie,oe),(K-2)*3),[H,z,U,J]=[U,J,ie,oe]}}}for(let D=0,P=c.length;D<P;D++)v.push({line:N(c[D].map(L=>L??NaN),x,S,A,E),points:N(d[D].map(L=>L??NaN),x,S,A,E)});const R=new Iw;return R.build(v,i,a,1,h,p,l),R}get box(){return m(this,Vn)}updateProperty(t,n){return t==="stroke-width"?M(this,Cn,nk).call(this,n):null}updateParentDimensions([t,n],i){const[a,l]=M(this,Cn,Ir).call(this);C(this,ir,t),C(this,rr,n),C(this,Md,i);const[c,d]=M(this,Cn,Ir).call(this),h=c-a,p=d-l,v=m(this,Vn);return v[0]-=h,v[1]-=p,v[2]+=2*h,v[3]+=2*p,v}updateRotation(t){return C(this,Yp,t),{path:{transform:this.rotationTransform}}}get viewBox(){return m(this,Vn).map(ye.svgRound).join(" ")}get defaultProperties(){const[t,n]=m(this,Vn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ye.svgRound(t)} ${ye.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=m(this,Vn);let i=0,a=0,l=0,c=0,d=0,h=0;switch(m(this,Yp)){case 90:a=n/t,l=-t/n,d=t;break;case 180:i=-1,c=-1,d=t,h=n;break;case 270:a=-n/t,l=t/n,h=n;break;default:return""}return`matrix(${i} ${a} ${l} ${c} ${ye.svgRound(d)} ${ye.svgRound(h)})`}getPathResizingSVGProperties([t,n,i,a]){const[l,c]=M(this,Cn,Ir).call(this),[d,h,p,v]=m(this,Vn);if(Math.abs(p-l)<=ye.PRECISION||Math.abs(v-c)<=ye.PRECISION){const N=t+i/2-(d+p/2),R=n+a/2-(h+v/2);return{path:{"transform-origin":`${ye.svgRound(t)} ${ye.svgRound(n)}`,transform:`${this.rotationTransform} translate(${N} ${R})`}}}const x=(i-2*l)/(p-2*l),S=(a-2*c)/(v-2*c),A=p/i,E=v/a;return{path:{"transform-origin":`${ye.svgRound(d)} ${ye.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${E}) translate(${ye.svgRound(l)} ${ye.svgRound(c)}) scale(${x} ${S}) translate(${ye.svgRound(-l)} ${ye.svgRound(-c)})`}}}getPathResizedSVGProperties([t,n,i,a]){const[l,c]=M(this,Cn,Ir).call(this),d=m(this,Vn),[h,p,v,x]=d;if(d[0]=t,d[1]=n,d[2]=i,d[3]=a,Math.abs(v-l)<=ye.PRECISION||Math.abs(x-c)<=ye.PRECISION){const R=t+i/2-(h+v/2),D=n+a/2-(p+x/2);for(const{line:P,points:L}of m(this,Ds))ye._translate(P,R,D,P),ye._translate(L,R,D,L);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ye.svgRound(t)} ${ye.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const S=(i-2*l)/(v-2*l),A=(a-2*c)/(x-2*c),E=-S*(h+l)+t+l,N=-A*(p+c)+n+c;if(S!==1||A!==1||E!==0||N!==0)for(const{line:R,points:D}of m(this,Ds))ye._rescale(R,E,N,S,A,R),ye._rescale(D,E,N,S,A,D);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ye.svgRound(t)} ${ye.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],i){const[a,l]=i,c=m(this,Vn),d=t-c[0],h=n-c[1];if(m(this,ir)===a&&m(this,rr)===l)for(const{line:p,points:v}of m(this,Ds))ye._translate(p,d,h,p),ye._translate(v,d,h,v);else{const p=m(this,ir)/a,v=m(this,rr)/l;C(this,ir,a),C(this,rr,l);for(const{line:x,points:S}of m(this,Ds))ye._rescale(x,d,h,p,v,x),ye._rescale(S,d,h,p,v,S);c[2]*=p,c[3]*=v}return c[0]=t,c[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ye.svgRound(t)} ${ye.svgRound(n)}`}}}get defaultSVGProperties(){const t=m(this,Vn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ye.svgRound(t[0])} ${ye.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Vn=new WeakMap,Yp=new WeakMap,Kp=new WeakMap,Ds=new WeakMap,ir=new WeakMap,rr=new WeakMap,Md=new WeakMap,Id=new WeakMap,Dd=new WeakMap,Cn=new WeakSet,Ir=function(t=m(this,Dd)){const n=m(this,Kp)+t/2*m(this,Md);return m(this,Id)%180===0?[n/m(this,ir),n/m(this,rr)]:[n/m(this,rr),n/m(this,ir)]},ek=function(){const[t,n,i,a]=m(this,Vn),[l,c]=M(this,Cn,Ir).call(this,0);return[t+l,n+c,i-2*l,a-2*c]},tk=function(){const t=C(this,Vn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:a}of m(this,Ds)){if(a.length<=12){for(let d=4,h=a.length;d<h;d+=6){const[p,v]=a.subarray(d,d+2);t[0]=Math.min(t[0],p),t[1]=Math.min(t[1],v),t[2]=Math.max(t[2],p),t[3]=Math.max(t[3],v)}continue}let l=a[4],c=a[5];for(let d=6,h=a.length;d<h;d+=6){const[p,v,x,S,A,E]=a.subarray(d,d+6);Te.bezierBoundingBox(l,c,p,v,x,S,A,E,t),l=A,c=E}}const[n,i]=M(this,Cn,Ir).call(this);t[0]=Math.min(1,Math.max(0,t[0]-n)),t[1]=Math.min(1,Math.max(0,t[1]-i)),t[2]=Math.min(1,Math.max(0,t[2]+n)),t[3]=Math.min(1,Math.max(0,t[3]+i)),t[2]-=t[0],t[3]-=t[1]},nk=function(t){const[n,i]=M(this,Cn,Ir).call(this);C(this,Dd,t);const[a,l]=M(this,Cn,Ir).call(this),[c,d]=[a-n,l-i],h=m(this,Vn);return h[0]-=c,h[1]-=d,h[2]+=2*c,h[3]+=2*d,h};let E0=Iw;var Pd;const Dw=class Dw extends N3{constructor(t){super();k(this,Pd);C(this,Pd,t),super.updateProperties({fill:"none",stroke:Dt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,n){t==="stroke-width"&&(n??(n=this["stroke-width"]),n*=m(this,Pd).realScale),super.updateSVGProperty(t,n)}clone(){const t=new Dw(m(this,Pd));return t.updateAll(this),t}};Pd=new WeakMap;let Ex=Dw;var J0,sk;const Nu=class Nu extends xx{constructor(t){super({...t,name:"inkEditor"});k(this,J0);this._willKeepAspectRatio=!0}static initialize(t,n){Dt.initialize(t,n),this._defaultDrawingOptions=new Ex(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ye(this,"typesMap",new Map([[Ze.INK_THICKNESS,"stroke-width"],[Ze.INK_COLOR,"stroke"],[Ze.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,i,a,l){return new R3(t,n,i,a,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,i,a,l,c){return E0.deserialize(t,n,i,a,l,c)}static async deserialize(t,n,i){let a=null;if(t instanceof yw){const{data:{inkLists:c,rect:d,rotation:h,id:p,color:v,opacity:x,borderStyle:{rawWidth:S},popupRef:A},parent:{page:{pageNumber:E}}}=t;a=t={annotationType:Ge.INK,color:Array.from(v),thickness:S,opacity:x,paths:{points:c},boxes:null,pageIndex:E-1,rect:d.slice(0),rotation:h,id:p,deleted:!1,popupRef:A}}const l=await super.deserialize(t,n,i);return l.annotationElementId=t.id||null,l._initialData=a,l}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:i}=this;n.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:i}){this._drawingOptions=Nu.getDefaultDrawingOptions({stroke:Te.makeHexColor(...t),"stroke-width":n,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:i,rect:a}=this.serializeDraw(t),{_drawingOptions:{stroke:l,"stroke-opacity":c,"stroke-width":d}}=this,h={annotationType:Ge.INK,color:Dt._colorManager.convert(l),opacity:c,thickness:d,paths:{lines:n,points:i},pageIndex:this.pageIndex,rect:a,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?h:this.annotationElementId&&!M(this,J0,sk).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(t){const{points:n,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:n}),null}};J0=new WeakSet,sk=function(t){const{color:n,thickness:i,opacity:a,pageIndex:l}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((c,d)=>c!==n[d])||t.thickness!==i||t.opacity!==a||t.pageIndex!==l},Me(Nu,"_type","ink"),Me(Nu,"_editorType",Ge.INK),Me(Nu,"_defaultDrawingOptions",null);let Tx=Nu;var Mt,Tn,bo,sa,_o,Ld,ar,or,Ps,Od,st,cf,uf,a0,Nx,o0,Rx,l0,ik;const mf=class mf extends Dt{constructor(t){super({...t,name:"stampEditor"});k(this,st);k(this,Mt,null);k(this,Tn,null);k(this,bo,null);k(this,sa,null);k(this,_o,null);k(this,Ld,"");k(this,ar,null);k(this,or,null);k(this,Ps,!1);k(this,Od,!1);C(this,sa,t.bitmapUrl),C(this,_o,t.bitmapFile)}static initialize(t,n){Dt.initialize(t,n)}static get supportedTypes(){return Ye(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(n=>`image/${n}`))}static get supportedTypesStr(){return Ye(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,n){n.pasteEditor(Ge.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,d=await i.guess({name:"altText",request:{data:a,width:l,height:c,channels:a.length/(l*c)}});if(!d)throw new Error("No response from the AI service.");if(d.error)throw new Error("Error from the AI service.");if(d.cancel)return null;if(!d.output)throw new Error("No valid response from the AI service.");const h=d.output;return await this.setGuessedAltText(h),n&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}remove(){var t;m(this,Tn)&&(C(this,Mt,null),this._uiManager.imageManager.deleteId(m(this,Tn)),(t=m(this,ar))==null||t.remove(),C(this,ar,null),m(this,or)&&(clearTimeout(m(this,or)),C(this,or,null))),super.remove()}rebuild(){if(!this.parent){m(this,Tn)&&M(this,st,a0).call(this);return}super.rebuild(),this.div!==null&&(m(this,Tn)&&m(this,ar)===null&&M(this,st,a0).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(m(this,bo)||m(this,Mt)||m(this,sa)||m(this,_o)||m(this,Tn))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;if(this.width&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),m(this,Mt)?M(this,st,Nx).call(this):M(this,st,a0).call(this),this.width&&!this.annotationElementId){const[i,a]=this.parentDimensions;this.setAt(t*i,n*a,this.width*i,this.height*a)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;m(this,or)!==null&&clearTimeout(m(this,or)),C(this,or,setTimeout(()=>{C(this,or,null),M(this,st,Rx).call(this)},200))}copyCanvas(t,n,i=!1){var S;t||(t=224);const{width:a,height:l}=m(this,Mt),c=new E_;let d=m(this,Mt),h=a,p=l,v=null;if(n){if(a>n||l>n){const J=Math.min(n/a,n/l);h=Math.floor(a*J),p=Math.floor(l*J)}v=document.createElement("canvas");const A=v.width=Math.ceil(h*c.sx),E=v.height=Math.ceil(p*c.sy);m(this,Ps)||(d=M(this,st,o0).call(this,A,E));const N=v.getContext("2d");N.filter=this._uiManager.hcmFilter;let R="white",D="#cfcfd8";this._uiManager.hcmFilter!=="none"?D="black":(S=window.matchMedia)!=null&&S.call(window,"(prefers-color-scheme: dark)").matches&&(R="#8f8f9d",D="#42414d");const P=15,L=P*c.sx,H=P*c.sy,z=new OffscreenCanvas(L*2,H*2),U=z.getContext("2d");U.fillStyle=R,U.fillRect(0,0,L*2,H*2),U.fillStyle=D,U.fillRect(0,0,L,H),U.fillRect(L,H,L,H),N.fillStyle=N.createPattern(z,"repeat"),N.fillRect(0,0,A,E),N.drawImage(d,0,0,d.width,d.height,0,0,A,E)}let x=null;if(i){let A,E;if(c.symmetric&&d.width<t&&d.height<t)A=d.width,E=d.height;else if(d=m(this,Mt),a>t||l>t){const D=Math.min(t/a,t/l);A=Math.floor(a*D),E=Math.floor(l*D),m(this,Ps)||(d=M(this,st,o0).call(this,A,E))}const R=new OffscreenCanvas(A,E).getContext("2d",{willReadFrequently:!0});R.drawImage(d,0,0,d.width,d.height,0,0,A,E),x={width:A,height:E,data:R.getImageData(0,0,A,E).data}}return{canvas:v,width:h,height:p,imageData:x}}getImageForAltText(){return m(this,ar)}static async deserialize(t,n,i){var E;let a=null;if(t instanceof E2){const{data:{rect:N,rotation:R,id:D,structParent:P,popupRef:L},container:H,parent:{page:{pageNumber:z}}}=t,U=H.querySelector("canvas"),J=i.imageManager.getFromCanvas(H.id,U);U.remove();const K=((E=await n._structTree.getAriaAttributes(`${cw}${D}`))==null?void 0:E.get("aria-label"))||"";a=t={annotationType:Ge.STAMP,bitmapId:J.id,bitmap:J.bitmap,pageIndex:z-1,rect:N.slice(0),rotation:R,id:D,deleted:!1,accessibilityData:{decorative:!1,altText:K},isSvg:!1,structParent:P,popupRef:L}}const l=await super.deserialize(t,n,i),{rect:c,bitmap:d,bitmapUrl:h,bitmapId:p,isSvg:v,accessibilityData:x}=t;p&&i.imageManager.isValidId(p)?(C(l,Tn,p),d&&C(l,Mt,d)):C(l,sa,h),C(l,Ps,v);const[S,A]=l.pageDimensions;return l.width=(c[2]-c[0])/S,l.height=(c[3]-c[1])/A,l.annotationElementId=t.id||null,x&&(l.altTextData=x),l._initialData=a,C(l,Od,!!a),l}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Ge.STAMP,bitmapId:m(this,Tn),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:m(this,Ps),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=M(this,st,l0).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:a,altText:l}=this.serializeAltText(!1);if(!a&&l&&(i.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const d=M(this,st,ik).call(this,i);if(d.isSame)return null;d.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,n===null)return i;n.stamps||(n.stamps=new Map);const c=m(this,Ps)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!n.stamps.has(m(this,Tn)))n.stamps.set(m(this,Tn),{area:c,serialized:i}),i.bitmap=M(this,st,l0).call(this,!1);else if(m(this,Ps)){const d=n.stamps.get(m(this,Tn));c>d.area&&(d.area=c,d.serialized.bitmap.close(),d.serialized.bitmap=M(this,st,l0).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};Mt=new WeakMap,Tn=new WeakMap,bo=new WeakMap,sa=new WeakMap,_o=new WeakMap,Ld=new WeakMap,ar=new WeakMap,or=new WeakMap,Ps=new WeakMap,Od=new WeakMap,st=new WeakSet,cf=function(t,n=!1){if(!t){this.remove();return}C(this,Mt,t.bitmap),n||(C(this,Tn,t.id),C(this,Ps,t.isSvg)),t.file&&C(this,Ld,t.file.name),M(this,st,Nx).call(this)},uf=function(){if(C(this,bo,null),this._uiManager.enableWaiting(!1),!!m(this,ar)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&m(this,Mt)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&m(this,Mt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},a0=function(){if(m(this,Tn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(m(this,Tn)).then(i=>M(this,st,cf).call(this,i,!0)).finally(()=>M(this,st,uf).call(this));return}if(m(this,sa)){const i=m(this,sa);C(this,sa,null),this._uiManager.enableWaiting(!0),C(this,bo,this._uiManager.imageManager.getFromUrl(i).then(a=>M(this,st,cf).call(this,a)).finally(()=>M(this,st,uf).call(this)));return}if(m(this,_o)){const i=m(this,_o);C(this,_o,null),this._uiManager.enableWaiting(!0),C(this,bo,this._uiManager.imageManager.getFromFile(i).then(a=>M(this,st,cf).call(this,a)).finally(()=>M(this,st,uf).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=mf.supportedTypesStr;const n=this._uiManager._signal;C(this,bo,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),M(this,st,cf).call(this,a)}i()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:n})}).finally(()=>M(this,st,uf).call(this))),t.click()},Nx=function(){var v;const{div:t}=this;let{width:n,height:i}=m(this,Mt);const[a,l]=this.pageDimensions,c=.75;if(this.width)n=this.width*a,i=this.height*l;else if(n>c*a||i>c*l){const x=Math.min(c*a/n,c*l/i);n*=x,i*=x}const[d,h]=this.parentDimensions;this.setDims(n*d/a,i*h/l),this._uiManager.enableWaiting(!1);const p=C(this,ar,document.createElement("canvas"));p.setAttribute("role","img"),this.addContainer(p),this.width=n/a,this.height=i/l,(v=this._initialOptions)!=null&&v.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),M(this,st,Rx).call(this),m(this,Od)||(this.parent.addUndoableEditor(this),C(this,Od,!0)),this._reportTelemetry({action:"inserted_image"}),m(this,Ld)&&p.setAttribute("aria-label",m(this,Ld))},o0=function(t,n){const{width:i,height:a}=m(this,Mt);let l=i,c=a,d=m(this,Mt);for(;l>2*t||c>2*n;){const h=l,p=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*n&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const v=new OffscreenCanvas(l,c);v.getContext("2d").drawImage(d,0,0,h,p,0,0,l,c),d=v.transferToImageBitmap()}return d},Rx=function(){const[t,n]=this.parentDimensions,{width:i,height:a}=this,l=new E_,c=Math.ceil(i*t*l.sx),d=Math.ceil(a*n*l.sy),h=m(this,ar);if(!h||h.width===c&&h.height===d)return;h.width=c,h.height=d;const p=m(this,Ps)?m(this,Mt):M(this,st,o0).call(this,c,d),v=h.getContext("2d");v.filter=this._uiManager.hcmFilter,v.drawImage(p,0,0,p.width,p.height,0,0,c,d)},l0=function(t){if(t){if(m(this,Ps)){const a=this._uiManager.imageManager.getSvgUrl(m(this,Tn));if(a)return a}const n=document.createElement("canvas");return{width:n.width,height:n.height}=m(this,Mt),n.getContext("2d").drawImage(m(this,Mt),0,0),n.toDataURL()}if(m(this,Ps)){const[n,i]=this.pageDimensions,a=Math.round(this.width*n*To.PDF_TO_CSS_UNITS),l=Math.round(this.height*i*To.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(a,l);return c.getContext("2d").drawImage(m(this,Mt),0,0,m(this,Mt).width,m(this,Mt).height,0,0,a,l),c.transferToImageBitmap()}return structuredClone(m(this,Mt))},ik=function(t){var c;const{pageIndex:n,accessibilityData:{altText:i}}=this._initialData,a=t.pageIndex===n,l=(((c=t.accessibilityData)==null?void 0:c.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&a&&l,isSameAltText:l}},Me(mf,"_type","stamp"),Me(mf,"_editorType",Ge.STAMP);let Cx=mf;var lc,Ud,lr,xo,ia,oi,wo,Fd,cc,ki,ra,Ln,aa,Ae,So,Rt,rk,Vi,Mx,Ix,c0;const yi=class yi{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:i,accessibilityManager:a,annotationLayer:l,drawLayer:c,textLayer:d,viewport:h,l10n:p}){k(this,Rt);k(this,lc);k(this,Ud,!1);k(this,lr,null);k(this,xo,null);k(this,ia,null);k(this,oi,new Map);k(this,wo,!1);k(this,Fd,!1);k(this,cc,!1);k(this,ki,null);k(this,ra,null);k(this,Ln,null);k(this,aa,null);k(this,Ae);const v=[...m(yi,So).values()];if(!yi._initialized){yi._initialized=!0;for(const x of v)x.initialize(p,e)}e.registerEditorTypes(v),C(this,Ae,e),this.pageIndex=t,this.div=n,C(this,lc,a),C(this,lr,l),this.viewport=h,C(this,Ln,d),this.drawLayer=c,this._structTree=i,m(this,Ae).addLayer(this)}get isEmpty(){return m(this,oi).size===0}get isInvisible(){return this.isEmpty&&m(this,Ae).getMode()===Ge.NONE}updateToolbar(e){m(this,Ae).updateToolbar(e)}updateMode(e=m(this,Ae).getMode()){switch(M(this,Rt,c0).call(this),e){case Ge.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ge.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ge.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of m(yi,So).values())t.toggle(`${n._type}Editing`,e===n._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=m(this,Ln))==null?void 0:t.div)}setEditingState(e){m(this,Ae).setEditingState(e)}addCommands(e){m(this,Ae).addCommands(e)}cleanUndoStack(e){m(this,Ae).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=m(this,lr))==null||t.div.classList.toggle("disabled",!e)}async enable(){C(this,cc,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const n of m(this,oi).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(m(this,Ae).removeChangedExistingAnnotation(n),e.add(n.annotationElementId));if(!m(this,lr)){C(this,cc,!1);return}const t=m(this,lr).getEditableAnnotations();for(const n of t){if(n.hide(),m(this,Ae).isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}C(this,cc,!1)}disable(){var i;C(this,Fd,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const a of m(this,oi).values())if(a.disableEditing(),!!a.annotationElementId){if(a.serialize()!==null){e.set(a.annotationElementId,a);continue}else t.set(a.annotationElementId,a);(i=this.getEditableAnnotation(a.annotationElementId))==null||i.show(),a.remove()}if(m(this,lr)){const a=m(this,lr).getEditableAnnotations();for(const l of a){const{id:c}=l.data;if(m(this,Ae).isDeletedAnnotationElement(c))continue;let d=t.get(c);if(d){d.resetAnnotationElement(l),d.show(!1),l.show();continue}d=e.get(c),d&&(m(this,Ae).addChangedExistingAnnotation(d),d.renderAnnotationElement(l)&&d.show(!1)),l.show()}}M(this,Rt,c0).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const a of m(yi,So).values())n.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),C(this,Fd,!1)}getEditableAnnotation(e){var t;return((t=m(this,lr))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){m(this,Ae).getActive()!==e&&m(this,Ae).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=m(this,Ln))!=null&&e.div&&!m(this,aa)){C(this,aa,new AbortController);const t=m(this,Ae).combinedSignal(m(this,aa));m(this,Ln).div.addEventListener("pointerdown",M(this,Rt,rk).bind(this),{signal:t}),m(this,Ln).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=m(this,Ln))!=null&&e.div&&m(this,aa)&&(m(this,aa).abort(),C(this,aa,null),m(this,Ln).div.classList.remove("highlighting"))}enableClick(){if(m(this,xo))return;C(this,xo,new AbortController);const e=m(this,Ae).combinedSignal(m(this,xo));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=m(this,xo))==null||e.abort(),C(this,xo,null)}attach(e){m(this,oi).set(e.id,e);const{annotationElementId:t}=e;t&&m(this,Ae).isDeletedAnnotationElement(t)&&m(this,Ae).removeDeletedAnnotationElement(e)}detach(e){var t;m(this,oi).delete(e.id),(t=m(this,lc))==null||t.removePointerInTextLayer(e.contentDiv),!m(this,Fd)&&e.annotationElementId&&m(this,Ae).addDeletedAnnotationElement(e)}remove(e){this.detach(e),m(this,Ae).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(m(this,Ae).addDeletedAnnotationElement(e.annotationElementId),Dt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),m(this,Ae).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!m(this,cc)),m(this,Ae).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!m(this,ia)&&(e._focusEventsAllowed=!1,C(this,ia,setTimeout(()=>{C(this,ia,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:m(this,Ae)._signal}),t.focus())},0))),e._structTreeParentId=(n=m(this,lc))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getNextId(){return m(this,Ae).getId()}combinedSignal(e){return m(this,Ae).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=m(this,Rt,Vi))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){m(this,Ae).updateToolbar(e),m(this,Ae).updateMode(e);const{offsetX:n,offsetY:i}=M(this,Rt,Ix).call(this),a=this.getNextId(),l=M(this,Rt,Mx).call(this,{parent:this,id:a,x:n,y:i,uiManager:m(this,Ae),isCentered:!0,...t});l&&this.add(l)}async deserialize(e){var t;return await((t=m(yi,So).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,m(this,Ae)))||null}createAndAddNewEditor(e,t,n={}){const i=this.getNextId(),a=M(this,Rt,Mx).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:m(this,Ae),isCentered:t,...n});return a&&this.add(a),a}addNewEditor(){this.createAndAddNewEditor(M(this,Rt,Ix).call(this),!0)}setSelected(e){m(this,Ae).setSelected(e)}toggleSelected(e){m(this,Ae).toggleSelected(e)}unselect(e){m(this,Ae).unselect(e)}pointerup(e){var n;const{isMac:t}=Kn.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&m(this,wo)&&(C(this,wo,!1),!((n=m(this,Rt,Vi))!=null&&n.isDrawer&&m(this,Rt,Vi).supportMultipleDrawings))){if(!m(this,Ud)){C(this,Ud,!0);return}if(m(this,Ae).getMode()===Ge.STAMP){m(this,Ae).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var i;if(m(this,Ae).getMode()===Ge.HIGHLIGHT&&this.enableTextSelection(),m(this,wo)){C(this,wo,!1);return}const{isMac:t}=Kn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(C(this,wo,!0),(i=m(this,Rt,Vi))!=null&&i.isDrawer){this.startDrawingSession(e);return}const n=m(this,Ae).getActive();C(this,Ud,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus(),m(this,ki)){m(this,Rt,Vi).startDrawing(this,m(this,Ae),!1,e);return}m(this,Ae).setCurrentDrawingSession(this),C(this,ki,new AbortController);const t=m(this,Ae).combinedSignal(m(this,ki));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(C(this,ra,null),this.commitOrRemove())},{signal:t}),m(this,Rt,Vi).startDrawing(this,m(this,Ae),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&C(this,ra,t);return}m(this,ra)&&setTimeout(()=>{var t;(t=m(this,ra))==null||t.focus(),C(this,ra,null)},0)}endDrawingSession(e=!1){return m(this,ki)?(m(this,Ae).setCurrentDrawingSession(null),m(this,ki).abort(),C(this,ki,null),C(this,ra,null),m(this,Rt,Vi).endDrawing(e)):null}findNewParent(e,t,n){const i=m(this,Ae).findParent(t,n);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return m(this,ki)?(this.endDrawingSession(),!0):!1}onScaleChanging(){m(this,ki)&&m(this,Rt,Vi).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=m(this,Ae).getActive())==null?void 0:e.parent)===this&&(m(this,Ae).commitOrRemove(),m(this,Ae).setActiveEditor(null)),m(this,ia)&&(clearTimeout(m(this,ia)),C(this,ia,null));for(const n of m(this,oi).values())(t=m(this,lc))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,m(this,oi).clear(),m(this,Ae).removeLayer(this)}render({viewport:e}){this.viewport=e,dc(this.div,e);for(const t of m(this,Ae).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){m(this,Ae).commitOrRemove(),M(this,Rt,c0).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,dc(this.div,{rotation:n}),t!==n)for(const i of m(this,oi).values())i.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return m(this,Ae).viewParameters.realScale}};lc=new WeakMap,Ud=new WeakMap,lr=new WeakMap,xo=new WeakMap,ia=new WeakMap,oi=new WeakMap,wo=new WeakMap,Fd=new WeakMap,cc=new WeakMap,ki=new WeakMap,ra=new WeakMap,Ln=new WeakMap,aa=new WeakMap,Ae=new WeakMap,So=new WeakMap,Rt=new WeakSet,rk=function(e){m(this,Ae).unselectAll();const{target:t}=e;if(t===m(this,Ln).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&m(this,Ln).div.contains(t)){const{isMac:n}=Kn.platform;if(e.button!==0||e.ctrlKey&&n)return;m(this,Ae).showAllEditors("highlight",!0,!0),m(this,Ln).div.classList.add("free"),this.toggleDrawing(),A0.startHighlighting(this,m(this,Ae).direction==="ltr",{target:m(this,Ln).div,x:e.x,y:e.y}),m(this,Ln).div.addEventListener("pointerup",()=>{m(this,Ln).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:m(this,Ae)._signal}),e.preventDefault()}},Vi=function(){return m(yi,So).get(m(this,Ae).getMode())},Mx=function(e){const t=m(this,Rt,Vi);return t?new t.prototype.constructor(e):null},Ix=function(){const{x:e,y:t,width:n,height:i}=this.div.getBoundingClientRect(),a=Math.max(0,e),l=Math.max(0,t),c=Math.min(window.innerWidth,e+n),d=Math.min(window.innerHeight,t+i),h=(a+c)/2-e,p=(l+d)/2-t,[v,x]=this.viewport.rotation%180===0?[h,p]:[p,h];return{offsetX:v,offsetY:x}},c0=function(){for(const e of m(this,oi).values())e.isEmpty()&&e.remove()},Me(yi,"_initialized",!1),k(yi,So,new Map([dx,Tx,Cx,A0].map(e=>[e._editorType,e])));let kx=yi;var Mi,Jp,$n,uc,X0,ak,cr,Px,ok,Lx;const Mn=class Mn{constructor({pageIndex:e}){k(this,cr);k(this,Mi,null);k(this,Jp,0);k(this,$n,new Map);k(this,uc,new Map);this.pageIndex=e}setParent(e){if(!m(this,Mi)){C(this,Mi,e);return}if(m(this,Mi)!==e){if(m(this,$n).size>0)for(const t of m(this,$n).values())t.remove(),e.append(t);C(this,Mi,e)}}static get _svgFactory(){return Ye(this,"_svgFactory",new gw)}draw(e,t=!1,n=!1){const i=Hn(this,Jp)._++,a=M(this,cr,Px).call(this),l=Mn._svgFactory.createElement("defs");a.append(l);const c=Mn._svgFactory.createElement("path");l.append(c);const d=`path_p${this.pageIndex}_${i}`;c.setAttribute("id",d),c.setAttribute("vector-effect","non-scaling-stroke"),t&&m(this,uc).set(i,c);const h=n?M(this,cr,ok).call(this,l,d):null,p=Mn._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${d}`),this.updateProperties(a,e),m(this,$n).set(i,a),{id:i,clipPathId:`url(#${h})`}}drawOutline(e,t){const n=Hn(this,Jp)._++,i=M(this,cr,Px).call(this),a=Mn._svgFactory.createElement("defs");i.append(a);const l=Mn._svgFactory.createElement("path");a.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let d;if(t){const v=Mn._svgFactory.createElement("mask");a.append(v),d=`mask_p${this.pageIndex}_${n}`,v.setAttribute("id",d),v.setAttribute("maskUnits","objectBoundingBox");const x=Mn._svgFactory.createElement("rect");v.append(x),x.setAttribute("width","1"),x.setAttribute("height","1"),x.setAttribute("fill","white");const S=Mn._svgFactory.createElement("use");v.append(S),S.setAttribute("href",`#${c}`),S.setAttribute("stroke","none"),S.setAttribute("fill","black"),S.setAttribute("fill-rule","nonzero"),S.classList.add("mask")}const h=Mn._svgFactory.createElement("use");i.append(h),h.setAttribute("href",`#${c}`),d&&h.setAttribute("mask",`url(#${d})`);const p=h.cloneNode();return i.append(p),h.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(i,e),m(this,$n).set(n,i),n}finalizeDraw(e,t){m(this,uc).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var d;if(!t)return;const{root:n,bbox:i,rootClass:a,path:l}=t,c=typeof e=="number"?m(this,$n).get(e):e;if(c){if(n&&M(this,cr,Lx).call(this,c,n),i&&M(d=Mn,X0,ak).call(d,c,i),a){const{classList:h}=c;for(const[p,v]of Object.entries(a))h.toggle(p,v)}if(l){const p=c.firstChild.firstChild;M(this,cr,Lx).call(this,p,l)}}}updateParent(e,t){if(t===this)return;const n=m(this,$n).get(e);n&&(m(t,Mi).append(n),m(this,$n).delete(e),m(t,$n).set(e,n))}remove(e){m(this,uc).delete(e),m(this,Mi)!==null&&(m(this,$n).get(e).remove(),m(this,$n).delete(e))}destroy(){C(this,Mi,null);for(const e of m(this,$n).values())e.remove();m(this,$n).clear(),m(this,uc).clear()}};Mi=new WeakMap,Jp=new WeakMap,$n=new WeakMap,uc=new WeakMap,X0=new WeakSet,ak=function(e,[t,n,i,a]){const{style:l}=e;l.top=`${100*n}%`,l.left=`${100*t}%`,l.width=`${100*i}%`,l.height=`${100*a}%`},cr=new WeakSet,Px=function(){const e=Mn._svgFactory.create(1,1,!0);return m(this,Mi).append(e),e.setAttribute("aria-hidden",!0),e},ok=function(e,t){const n=Mn._svgFactory.createElement("clipPath");e.append(n);const i=`clip_${t}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const a=Mn._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${t}`),a.classList.add("clip"),i},Lx=function(e,t){for(const[n,i]of Object.entries(t))i===null?e.removeAttribute(n):e.setAttribute(n,i)},k(Mn,X0);let Dx=Mn;globalThis.pdfjsTestingUtils={HighlightOutliner:fx};Oe.AbortException;Oe.AnnotationEditorLayer;Oe.AnnotationEditorParamsType;Oe.AnnotationEditorType;Oe.AnnotationEditorUIManager;Oe.AnnotationLayer;Oe.AnnotationMode;Oe.ColorPicker;Oe.DOMSVGFactory;Oe.DrawLayer;Oe.FeatureTest;var k3=Oe.GlobalWorkerOptions;Oe.ImageKind;Oe.InvalidPDFException;Oe.MissingPDFException;Oe.OPS;Oe.OutputScale;Oe.PDFDataRangeTransport;Oe.PDFDateString;Oe.PDFWorker;Oe.PasswordResponses;Oe.PermissionFlag;Oe.PixelsPerInch;Oe.RenderingCancelledException;Oe.TextLayer;Oe.TouchManager;Oe.UnexpectedResponseException;Oe.Util;Oe.VerbosityLevel;Oe.XfaLayer;Oe.build;Oe.createValidAbsoluteUrl;Oe.fetchData;var M3=Oe.getDocument;Oe.getFilenameFromUrl;Oe.getPdfFilenameFromUrl;Oe.getXfaPageViewport;Oe.isDataScheme;Oe.isPdfFile;Oe.noContextMenu;Oe.normalizeUnicode;Oe.setLayerDimensions;Oe.shadow;Oe.stopEvent;Oe.version;k3.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.10.38/build/pdf.worker.min.mjs";const I3=async s=>{try{const e=await s.arrayBuffer(),n=await M3({data:e,cMapUrl:"https://cdn.jsdelivr.net/npm/pdfjs-dist@4.10.38/cmaps/",cMapPacked:!0}).promise;let i="";const a=n.numPages;for(let l=1;l<=a;l++){const p=(await(await n.getPage(l)).getTextContent()).items.map(v=>v.str).join(" ").replace(/\s+/g," ").trim();i+=`Page ${l}:
${p}

`}return i}catch(e){throw console.error("PDF Extraction Error:",e),new Error("    PDF.         .")}};var D3={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let P3,L3;function O3(){return{geminiUrl:P3,vertexUrl:L3}}function U3(s,e,t,n){var i,a;if(!(s!=null&&s.baseUrl)){const l=O3();return e?(i=l.vertexUrl)!==null&&i!==void 0?i:t:(a=l.geminiUrl)!==null&&a!==void 0?a:n}return s.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ma{}function pe(s,e){const t=/\{([^}]+)\}/g;return s.replace(t,(n,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const a=e[i];return a!=null?String(a):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function y(s,e,t){for(let a=0;a<e.length-1;a++){const l=e[a];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in s))if(Array.isArray(t))s[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(s[c])){const d=s[c];if(Array.isArray(t))for(let h=0;h<d.length;h++){const p=d[h];y(p,e.slice(a+1),t[h])}else for(const h of d)y(h,e.slice(a+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in s||(s[c]=[{}]);const d=s[c];y(d[0],e.slice(a+1),t);return}(!s[l]||typeof s[l]!="object")&&(s[l]={}),s=s[l]}const n=e[e.length-1],i=s[n];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(s,t):s[n]=t}function g(s,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return s;for(let n=0;n<e.length;n++){if(typeof s!="object"||s===null)return t;const i=e[n];if(i.endsWith("[]")){const a=i.slice(0,-2);if(a in s){const l=s[a];return Array.isArray(l)?l.map(c=>g(c,e.slice(n+1),t)):t}else return t}else s=s[i]}return s}catch(n){if(n instanceof TypeError)return t;throw n}}function F3(s,e){for(const[t,n]of Object.entries(e)){const i=t.split("."),a=n.split("."),l=new Set;let c=-1;for(let d=0;d<i.length;d++)if(i[d]==="*"){c=d;break}if(c!==-1&&a.length>c)for(let d=c;d<a.length;d++){const h=a[d];h!=="*"&&!h.endsWith("[]")&&!h.endsWith("[0]")&&l.add(h)}Ox(s,i,a,0,l)}}function Ox(s,e,t,n,i){if(n>=e.length||typeof s!="object"||s===null)return;const a=e[n];if(a.endsWith("[]")){const l=a.slice(0,-2),c=s;if(l in c&&Array.isArray(c[l]))for(const d of c[l])Ox(d,e,t,n+1,i)}else if(a==="*"){if(typeof s=="object"&&s!==null&&!Array.isArray(s)){const l=s,c=Object.keys(l).filter(h=>!h.startsWith("_")&&!i.has(h)),d={};for(const h of c)d[h]=l[h];for(const[h,p]of Object.entries(d)){const v=[];for(const x of t.slice(n))x==="*"?v.push(h):v.push(x);y(l,v,p)}for(const h of c)delete l[h]}}else{const l=s;a in l&&Ox(l[a],e,t,n+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vw(s){if(typeof s!="string")throw new Error("fromImageBytes must be a string");return s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function z3(s){const e={},t=g(s,["operationName"]);t!=null&&y(e,["operationName"],t);const n=g(s,["resourceName"]);return n!=null&&y(e,["_url","resourceName"],n),e}function j3(s){const e={},t=g(s,["name"]);t!=null&&y(e,["name"],t);const n=g(s,["metadata"]);n!=null&&y(e,["metadata"],n);const i=g(s,["done"]);i!=null&&y(e,["done"],i);const a=g(s,["error"]);a!=null&&y(e,["error"],a);const l=g(s,["response","generateVideoResponse"]);return l!=null&&y(e,["response"],B3(l)),e}function H3(s){const e={},t=g(s,["name"]);t!=null&&y(e,["name"],t);const n=g(s,["metadata"]);n!=null&&y(e,["metadata"],n);const i=g(s,["done"]);i!=null&&y(e,["done"],i);const a=g(s,["error"]);a!=null&&y(e,["error"],a);const l=g(s,["response"]);return l!=null&&y(e,["response"],G3(l)),e}function B3(s){const e={},t=g(s,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>q3(l))),y(e,["generatedVideos"],a)}const n=g(s,["raiMediaFilteredCount"]);n!=null&&y(e,["raiMediaFilteredCount"],n);const i=g(s,["raiMediaFilteredReasons"]);return i!=null&&y(e,["raiMediaFilteredReasons"],i),e}function G3(s){const e={},t=g(s,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>V3(l))),y(e,["generatedVideos"],a)}const n=g(s,["raiMediaFilteredCount"]);n!=null&&y(e,["raiMediaFilteredCount"],n);const i=g(s,["raiMediaFilteredReasons"]);return i!=null&&y(e,["raiMediaFilteredReasons"],i),e}function q3(s){const e={},t=g(s,["video"]);return t!=null&&y(e,["video"],W3(t)),e}function V3(s){const e={},t=g(s,["_self"]);return t!=null&&y(e,["video"],Q3(t)),e}function $3(s){const e={},t=g(s,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function Y3(s){const e={},t=g(s,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function K3(s){const e={},t=g(s,["name"]);t!=null&&y(e,["name"],t);const n=g(s,["metadata"]);n!=null&&y(e,["metadata"],n);const i=g(s,["done"]);i!=null&&y(e,["done"],i);const a=g(s,["error"]);a!=null&&y(e,["error"],a);const l=g(s,["response"]);return l!=null&&y(e,["response"],J3(l)),e}function J3(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["parent"]);n!=null&&y(e,["parent"],n);const i=g(s,["documentName"]);return i!=null&&y(e,["documentName"],i),e}function lk(s){const e={},t=g(s,["name"]);t!=null&&y(e,["name"],t);const n=g(s,["metadata"]);n!=null&&y(e,["metadata"],n);const i=g(s,["done"]);i!=null&&y(e,["done"],i);const a=g(s,["error"]);a!=null&&y(e,["error"],a);const l=g(s,["response"]);return l!=null&&y(e,["response"],X3(l)),e}function X3(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["parent"]);n!=null&&y(e,["parent"],n);const i=g(s,["documentName"]);return i!=null&&y(e,["documentName"],i),e}function W3(s){const e={},t=g(s,["uri"]);t!=null&&y(e,["uri"],t);const n=g(s,["encodedVideo"]);n!=null&&y(e,["videoBytes"],vw(n));const i=g(s,["encoding"]);return i!=null&&y(e,["mimeType"],i),e}function Q3(s){const e={},t=g(s,["gcsUri"]);t!=null&&y(e,["uri"],t);const n=g(s,["bytesBase64Encoded"]);n!=null&&y(e,["videoBytes"],vw(n));const i=g(s,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var BT;(function(s){s.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",s.OUTCOME_OK="OUTCOME_OK",s.OUTCOME_FAILED="OUTCOME_FAILED",s.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(BT||(BT={}));var GT;(function(s){s.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",s.PYTHON="PYTHON"})(GT||(GT={}));var qT;(function(s){s.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",s.SILENT="SILENT",s.WHEN_IDLE="WHEN_IDLE",s.INTERRUPT="INTERRUPT"})(qT||(qT={}));var On;(function(s){s.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",s.STRING="STRING",s.NUMBER="NUMBER",s.INTEGER="INTEGER",s.BOOLEAN="BOOLEAN",s.ARRAY="ARRAY",s.OBJECT="OBJECT",s.NULL="NULL"})(On||(On={}));var VT;(function(s){s.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",s.SIMPLE_SEARCH="SIMPLE_SEARCH",s.ELASTIC_SEARCH="ELASTIC_SEARCH"})(VT||(VT={}));var $T;(function(s){s.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",s.NO_AUTH="NO_AUTH",s.API_KEY_AUTH="API_KEY_AUTH",s.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",s.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",s.OAUTH="OAUTH",s.OIDC_AUTH="OIDC_AUTH"})($T||($T={}));var YT;(function(s){s.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",s.HTTP_IN_QUERY="HTTP_IN_QUERY",s.HTTP_IN_HEADER="HTTP_IN_HEADER",s.HTTP_IN_PATH="HTTP_IN_PATH",s.HTTP_IN_BODY="HTTP_IN_BODY",s.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(YT||(YT={}));var KT;(function(s){s.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",s.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",s.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",s.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(KT||(KT={}));var JT;(function(s){s.UNSPECIFIED="UNSPECIFIED",s.BLOCKING="BLOCKING",s.NON_BLOCKING="NON_BLOCKING"})(JT||(JT={}));var XT;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.MODE_DYNAMIC="MODE_DYNAMIC"})(XT||(XT={}));var WT;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.AUTO="AUTO",s.ANY="ANY",s.NONE="NONE",s.VALIDATED="VALIDATED"})(WT||(WT={}));var QT;(function(s){s.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",s.LOW="LOW",s.MEDIUM="MEDIUM",s.HIGH="HIGH",s.MINIMAL="MINIMAL"})(QT||(QT={}));var ZT;(function(s){s.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",s.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",s.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",s.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",s.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",s.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",s.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",s.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",s.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",s.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",s.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(ZT||(ZT={}));var eC;(function(s){s.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",s.SEVERITY="SEVERITY",s.PROBABILITY="PROBABILITY"})(eC||(eC={}));var tC;(function(s){s.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",s.BLOCK_NONE="BLOCK_NONE",s.OFF="OFF"})(tC||(tC={}));var nC;(function(s){s.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",s.STOP="STOP",s.MAX_TOKENS="MAX_TOKENS",s.SAFETY="SAFETY",s.RECITATION="RECITATION",s.LANGUAGE="LANGUAGE",s.OTHER="OTHER",s.BLOCKLIST="BLOCKLIST",s.PROHIBITED_CONTENT="PROHIBITED_CONTENT",s.SPII="SPII",s.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",s.IMAGE_SAFETY="IMAGE_SAFETY",s.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",s.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",s.NO_IMAGE="NO_IMAGE",s.IMAGE_RECITATION="IMAGE_RECITATION",s.IMAGE_OTHER="IMAGE_OTHER"})(nC||(nC={}));var sC;(function(s){s.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",s.NEGLIGIBLE="NEGLIGIBLE",s.LOW="LOW",s.MEDIUM="MEDIUM",s.HIGH="HIGH"})(sC||(sC={}));var iC;(function(s){s.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",s.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",s.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",s.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",s.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(iC||(iC={}));var rC;(function(s){s.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",s.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",s.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",s.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",s.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(rC||(rC={}));var aC;(function(s){s.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",s.SAFETY="SAFETY",s.OTHER="OTHER",s.BLOCKLIST="BLOCKLIST",s.PROHIBITED_CONTENT="PROHIBITED_CONTENT",s.IMAGE_SAFETY="IMAGE_SAFETY",s.MODEL_ARMOR="MODEL_ARMOR",s.JAILBREAK="JAILBREAK"})(aC||(aC={}));var oC;(function(s){s.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",s.ON_DEMAND="ON_DEMAND",s.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(oC||(oC={}));var T0;(function(s){s.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",s.TEXT="TEXT",s.IMAGE="IMAGE",s.AUDIO="AUDIO"})(T0||(T0={}));var lC;(function(s){s.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",s.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",s.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",s.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(lC||(lC={}));var cC;(function(s){s.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",s.TUNING_MODE_FULL="TUNING_MODE_FULL",s.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(cC||(cC={}));var uC;(function(s){s.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",s.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",s.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",s.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",s.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",s.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",s.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(uC||(uC={}));var Ux;(function(s){s.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",s.JOB_STATE_QUEUED="JOB_STATE_QUEUED",s.JOB_STATE_PENDING="JOB_STATE_PENDING",s.JOB_STATE_RUNNING="JOB_STATE_RUNNING",s.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",s.JOB_STATE_FAILED="JOB_STATE_FAILED",s.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",s.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",s.JOB_STATE_PAUSED="JOB_STATE_PAUSED",s.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",s.JOB_STATE_UPDATING="JOB_STATE_UPDATING",s.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Ux||(Ux={}));var dC;(function(s){s.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",s.TUNING_TASK_I2V="TUNING_TASK_I2V",s.TUNING_TASK_T2V="TUNING_TASK_T2V",s.TUNING_TASK_R2V="TUNING_TASK_R2V"})(dC||(dC={}));var hC;(function(s){s.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",s.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",s.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",s.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",s.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(hC||(hC={}));var fC;(function(s){s.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",s.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",s.BALANCED="BALANCED",s.PRIORITIZE_COST="PRIORITIZE_COST"})(fC||(fC={}));var pC;(function(s){s.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",s.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(pC||(pC={}));var mC;(function(s){s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",s.BLOCK_NONE="BLOCK_NONE"})(mC||(mC={}));var gC;(function(s){s.DONT_ALLOW="DONT_ALLOW",s.ALLOW_ADULT="ALLOW_ADULT",s.ALLOW_ALL="ALLOW_ALL"})(gC||(gC={}));var yC;(function(s){s.auto="auto",s.en="en",s.ja="ja",s.ko="ko",s.hi="hi",s.zh="zh",s.pt="pt",s.es="es"})(yC||(yC={}));var vC;(function(s){s.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",s.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",s.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",s.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",s.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(vC||(vC={}));var bC;(function(s){s.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",s.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",s.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",s.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(bC||(bC={}));var _C;(function(s){s.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",s.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",s.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",s.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(_C||(_C={}));var xC;(function(s){s.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",s.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",s.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",s.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",s.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",s.EDIT_MODE_STYLE="EDIT_MODE_STYLE",s.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",s.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(xC||(xC={}));var wC;(function(s){s.FOREGROUND="FOREGROUND",s.BACKGROUND="BACKGROUND",s.PROMPT="PROMPT",s.SEMANTIC="SEMANTIC",s.INTERACTIVE="INTERACTIVE"})(wC||(wC={}));var SC;(function(s){s.ASSET="ASSET",s.STYLE="STYLE"})(SC||(SC={}));var AC;(function(s){s.INSERT="INSERT",s.REMOVE="REMOVE",s.REMOVE_STATIC="REMOVE_STATIC",s.OUTPAINT="OUTPAINT"})(AC||(AC={}));var EC;(function(s){s.OPTIMIZED="OPTIMIZED",s.LOSSLESS="LOSSLESS"})(EC||(EC={}));var TC;(function(s){s.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",s.PREFERENCE_TUNING="PREFERENCE_TUNING"})(TC||(TC={}));var CC;(function(s){s.STATE_UNSPECIFIED="STATE_UNSPECIFIED",s.STATE_PENDING="STATE_PENDING",s.STATE_ACTIVE="STATE_ACTIVE",s.STATE_FAILED="STATE_FAILED"})(CC||(CC={}));var NC;(function(s){s.STATE_UNSPECIFIED="STATE_UNSPECIFIED",s.PROCESSING="PROCESSING",s.ACTIVE="ACTIVE",s.FAILED="FAILED"})(NC||(NC={}));var RC;(function(s){s.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",s.UPLOADED="UPLOADED",s.GENERATED="GENERATED",s.REGISTERED="REGISTERED"})(RC||(RC={}));var kC;(function(s){s.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",s.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",s.RESPONSE_REJECTED="RESPONSE_REJECTED",s.NEED_MORE_INPUT="NEED_MORE_INPUT"})(kC||(kC={}));var MC;(function(s){s.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",s.TEXT="TEXT",s.IMAGE="IMAGE",s.VIDEO="VIDEO",s.AUDIO="AUDIO",s.DOCUMENT="DOCUMENT"})(MC||(MC={}));var IC;(function(s){s.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",s.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",s.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(IC||(IC={}));var DC;(function(s){s.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",s.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",s.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(DC||(DC={}));var PC;(function(s){s.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",s.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",s.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(PC||(PC={}));var LC;(function(s){s.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",s.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",s.NO_INTERRUPTION="NO_INTERRUPTION"})(LC||(LC={}));var OC;(function(s){s.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",s.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",s.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(OC||(OC={}));var UC;(function(s){s.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",s.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",s.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",s.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",s.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",s.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",s.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",s.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",s.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",s.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",s.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",s.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",s.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(UC||(UC={}));var FC;(function(s){s.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",s.QUALITY="QUALITY",s.DIVERSITY="DIVERSITY",s.VOCALIZATION="VOCALIZATION"})(FC||(FC={}));var Eu;(function(s){s.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",s.PLAY="PLAY",s.PAUSE="PAUSE",s.STOP="STOP",s.RESET_CONTEXT="RESET_CONTEXT"})(Eu||(Eu={}));class Fx{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Vh{get text(){var e,t,n,i,a,l,c,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",p=!1;const v=[];for(const x of(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[S,A]of Object.entries(x))S!=="text"&&S!=="thought"&&S!=="thoughtSignature"&&(A!==null||A!==void 0)&&v.push(S);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;p=!0,h+=x.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?h:void 0}get data(){var e,t,n,i,a,l,c,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const p=[];for(const v of(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[x,S]of Object.entries(v))x!=="inlineData"&&(S!==null||S!==void 0)&&p.push(x);v.inlineData&&typeof v.inlineData.data=="string"&&(h+=atob(v.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var e,t,n,i,a,l,c,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var e,t,n,i,a,l,c,d,h;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((p==null?void 0:p.length)!==0)return(h=p==null?void 0:p[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var e,t,n,i,a,l,c,d,h;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((p==null?void 0:p.length)!==0)return(h=p==null?void 0:p[0])===null||h===void 0?void 0:h.output}}class zC{}class jC{}class Z3{}class eF{}class tF{}class nF{}class HC{}class BC{}class GC{}class sF{}class C0{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new C0;let i;const a=e;return t?i=H3(a):i=j3(a),Object.assign(n,i),n}}class qC{}class VC{}class $C{}class YC{}class iF{}class rF{}class aF{}class bw{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new bw,a=K3(e);return Object.assign(n,a),n}}class oF{}class lF{}class cF{}class KC{}class uF{get text(){var e,t,n;let i="",a=!1;const l=[];for(const c of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[d,h]of Object.entries(c))d!=="text"&&d!=="thought"&&h!==null&&l.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;a=!0,i+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?i:void 0}get data(){var e,t,n;let i="";const a=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[c,d]of Object.entries(l))c!=="inlineData"&&d!==null&&a.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(i+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class dF{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class _w{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new _w,a=lk(e);return Object.assign(n,a),n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function it(s,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(s.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function ck(s,e){const t=it(s,e);return t?t.startsWith("publishers/")&&s.isVertexAI()?`projects/${s.getProject()}/locations/${s.getLocation()}/${t}`:t.startsWith("models/")&&s.isVertexAI()?`projects/${s.getProject()}/locations/${s.getLocation()}/publishers/google/${t}`:t:""}function uk(s){return Array.isArray(s)?s.map(e=>N0(e)):[N0(s)]}function N0(s){if(typeof s=="object"&&s!==null)return s;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof s}`)}function dk(s){const e=N0(s);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function hk(s){const e=N0(s);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function JC(s){if(s==null)throw new Error("PartUnion is required");if(typeof s=="object")return s;if(typeof s=="string")return{text:s};throw new Error(`Unsupported part type: ${typeof s}`)}function fk(s){if(s==null||Array.isArray(s)&&s.length===0)throw new Error("PartListUnion is required");return Array.isArray(s)?s.map(e=>JC(e)):[JC(s)]}function zx(s){return s!=null&&typeof s=="object"&&"parts"in s&&Array.isArray(s.parts)}function XC(s){return s!=null&&typeof s=="object"&&"functionCall"in s}function WC(s){return s!=null&&typeof s=="object"&&"functionResponse"in s}function zn(s){if(s==null)throw new Error("ContentUnion is required");return zx(s)?s:{role:"user",parts:fk(s)}}function xw(s,e){if(!e)return[];if(s.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=zn(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(s.isVertexAI()){const t=zn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>zn(t)):[zn(e)]}function ui(s){if(s==null||Array.isArray(s)&&s.length===0)throw new Error("contents are required");if(!Array.isArray(s)){if(XC(s)||WC(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[zn(s)]}const e=[],t=[],n=zx(s[0]);for(const i of s){const a=zx(i);if(a!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(i);else{if(XC(i)||WC(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(i)}}return n||e.push({role:"user",parts:fk(t)}),e}function hF(s,e){s.includes("null")&&(e.nullable=!0);const t=s.filter(n=>n!=="null");if(t.length===1)e.type=Object.values(On).includes(t[0].toUpperCase())?t[0].toUpperCase():On.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.values(On).includes(n.toUpperCase())?n.toUpperCase():On.TYPE_UNSPECIFIED})}}function Iu(s){const e={},t=["items"],n=["anyOf"],i=["properties"];if(s.type&&s.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=s.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,s=a[1]):a[1].type==="null"&&(e.nullable=!0,s=a[0])),s.type instanceof Array&&hF(s.type,e);for(const[l,c]of Object.entries(s))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(On).includes(c.toUpperCase())?c.toUpperCase():On.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=Iu(c);else if(n.includes(l)){const d=[];for(const h of c){if(h.type=="null"){e.nullable=!0;continue}d.push(Iu(h))}e[l]=d}else if(i.includes(l)){const d={};for(const[h,p]of Object.entries(c))d[h]=Iu(p);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=c}return e}function ww(s){return Iu(s)}function Sw(s){if(typeof s=="object")return s;if(typeof s=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:s}}};throw new Error(`Unsupported speechConfig type: ${typeof s}`)}function Aw(s){if("multiSpeakerVoiceConfig"in s)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return s}function Bd(s){if(s.functionDeclarations)for(const e of s.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Iu(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Iu(e.response));return s}function Gd(s){if(s==null)throw new Error("tools is required");if(!Array.isArray(s))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of s)e.push(t);return e}function fF(s,e,t,n=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===n;return s.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${s.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${s.getProject()}/locations/${s.getLocation()}/${e}`:i?`projects/${s.getProject()}/locations/${s.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function ga(s,e){if(typeof e!="string")throw new Error("name must be a string");return fF(s,e,"cachedContents")}function pk(s){switch(s){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return s}}function Ro(s){return vw(s)}function pF(s){return s!=null&&typeof s=="object"&&"name"in s}function mF(s){return s!=null&&typeof s=="object"&&"video"in s}function gF(s){return s!=null&&typeof s=="object"&&"uri"in s}function mk(s){var e;let t;if(pF(s)&&(t=s.name),!(gF(s)&&(t=s.uri,t===void 0))&&!(mF(s)&&(t=(e=s.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof s=="string"&&(t=s),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const i=t.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${t}`);t=i[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function gk(s,e){let t;return s.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function yk(s){for(const e of["models","tunedModels","publisherModels"])if(yF(s,e))return s[e];return[]}function yF(s,e){return s!==null&&typeof s=="object"&&e in s}function vF(s,e={}){const t=s,n={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(n.responseJsonSchema=t.outputSchema),e.behavior&&(n.behavior=e.behavior),{functionDeclarations:[n]}}function bF(s,e={}){const t=[],n=new Set;for(const i of s){const a=i.name;if(n.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);n.add(a);const l=vF(i,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function vk(s,e){let t;if(typeof e=="string")if(s.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(s.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const n=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,i=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(s.isVertexAI()){if(i>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function _F(s){if(typeof s!="string")return s;const e=s;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function bk(s){if(typeof s!="object"||s===null)return{};const e=s,t=e.inlinedResponses;if(typeof t!="object"||t===null)return s;const i=t.inlinedResponses;if(!Array.isArray(i)||i.length===0)return s;let a=!1;for(const l of i){if(typeof l!="object"||l===null)continue;const d=l.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),s}function qd(s,e){const t=e;if(!s.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function _k(s){const e=s;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xF(s){const e={},t=g(s,["responsesFile"]);t!=null&&y(e,["fileName"],t);const n=g(s,["inlinedResponses","inlinedResponses"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>t6(l))),y(e,["inlinedResponses"],a)}const i=g(s,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["inlinedEmbedContentResponses"],a)}return e}function wF(s){const e={},t=g(s,["predictionsFormat"]);t!=null&&y(e,["format"],t);const n=g(s,["gcsDestination","outputUriPrefix"]);n!=null&&y(e,["gcsUri"],n);const i=g(s,["bigqueryDestination","outputUri"]);return i!=null&&y(e,["bigqueryUri"],i),e}function SF(s){const e={},t=g(s,["format"]);t!=null&&y(e,["predictionsFormat"],t);const n=g(s,["gcsUri"]);n!=null&&y(e,["gcsDestination","outputUriPrefix"],n);const i=g(s,["bigqueryUri"]);if(i!=null&&y(e,["bigqueryDestination","outputUri"],i),g(s,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(s,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(g(s,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function u0(s){const e={},t=g(s,["name"]);t!=null&&y(e,["name"],t);const n=g(s,["metadata","displayName"]);n!=null&&y(e,["displayName"],n);const i=g(s,["metadata","state"]);i!=null&&y(e,["state"],_k(i));const a=g(s,["metadata","createTime"]);a!=null&&y(e,["createTime"],a);const l=g(s,["metadata","endTime"]);l!=null&&y(e,["endTime"],l);const c=g(s,["metadata","updateTime"]);c!=null&&y(e,["updateTime"],c);const d=g(s,["metadata","model"]);d!=null&&y(e,["model"],d);const h=g(s,["metadata","output"]);return h!=null&&y(e,["dest"],xF(bk(h))),e}function jx(s){const e={},t=g(s,["name"]);t!=null&&y(e,["name"],t);const n=g(s,["displayName"]);n!=null&&y(e,["displayName"],n);const i=g(s,["state"]);i!=null&&y(e,["state"],_k(i));const a=g(s,["error"]);a!=null&&y(e,["error"],a);const l=g(s,["createTime"]);l!=null&&y(e,["createTime"],l);const c=g(s,["startTime"]);c!=null&&y(e,["startTime"],c);const d=g(s,["endTime"]);d!=null&&y(e,["endTime"],d);const h=g(s,["updateTime"]);h!=null&&y(e,["updateTime"],h);const p=g(s,["model"]);p!=null&&y(e,["model"],p);const v=g(s,["inputConfig"]);v!=null&&y(e,["src"],AF(v));const x=g(s,["outputConfig"]);x!=null&&y(e,["dest"],wF(bk(x)));const S=g(s,["completionStats"]);return S!=null&&y(e,["completionStats"],S),e}function AF(s){const e={},t=g(s,["instancesFormat"]);t!=null&&y(e,["format"],t);const n=g(s,["gcsSource","uris"]);n!=null&&y(e,["gcsUri"],n);const i=g(s,["bigquerySource","inputUri"]);return i!=null&&y(e,["bigqueryUri"],i),e}function EF(s,e){const t={};if(g(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(g(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=g(e,["fileName"]);n!=null&&y(t,["fileName"],n);const i=g(e,["inlinedRequests"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>e6(s,l))),y(t,["requests","requests"],a)}return t}function TF(s){const e={},t=g(s,["format"]);t!=null&&y(e,["instancesFormat"],t);const n=g(s,["gcsUri"]);n!=null&&y(e,["gcsSource","uris"],n);const i=g(s,["bigqueryUri"]);if(i!=null&&y(e,["bigquerySource","inputUri"],i),g(s,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(s,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function CF(s){const e={},t=g(s,["data"]);if(t!=null&&y(e,["data"],t),g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function NF(s,e){const t={},n=g(e,["name"]);return n!=null&&y(t,["_url","name"],qd(s,n)),t}function RF(s,e){const t={},n=g(e,["name"]);return n!=null&&y(t,["_url","name"],qd(s,n)),t}function kF(s){const e={},t=g(s,["content"]);t!=null&&y(e,["content"],t);const n=g(s,["citationMetadata"]);n!=null&&y(e,["citationMetadata"],MF(n));const i=g(s,["tokenCount"]);i!=null&&y(e,["tokenCount"],i);const a=g(s,["finishReason"]);a!=null&&y(e,["finishReason"],a);const l=g(s,["avgLogprobs"]);l!=null&&y(e,["avgLogprobs"],l);const c=g(s,["groundingMetadata"]);c!=null&&y(e,["groundingMetadata"],c);const d=g(s,["index"]);d!=null&&y(e,["index"],d);const h=g(s,["logprobsResult"]);h!=null&&y(e,["logprobsResult"],h);const p=g(s,["safetyRatings"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(S=>S)),y(e,["safetyRatings"],x)}const v=g(s,["urlContextMetadata"]);return v!=null&&y(e,["urlContextMetadata"],v),e}function MF(s){const e={},t=g(s,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>i)),y(e,["citations"],n)}return e}function xk(s){const e={},t=g(s,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>l6(a))),y(e,["parts"],i)}const n=g(s,["role"]);return n!=null&&y(e,["role"],n),e}function IF(s,e){const t={},n=g(s,["displayName"]);if(e!==void 0&&n!=null&&y(e,["batch","displayName"],n),g(s,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function DF(s,e){const t={},n=g(s,["displayName"]);e!==void 0&&n!=null&&y(e,["displayName"],n);const i=g(s,["dest"]);return e!==void 0&&i!=null&&y(e,["outputConfig"],SF(_F(i))),t}function QC(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["src"]);i!=null&&y(t,["batch","inputConfig"],EF(s,vk(s,i)));const a=g(e,["config"]);return a!=null&&IF(a,t),t}function PF(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["model"],it(s,n));const i=g(e,["src"]);i!=null&&y(t,["inputConfig"],TF(vk(s,i)));const a=g(e,["config"]);return a!=null&&DF(a,t),t}function LF(s,e){const t={},n=g(s,["displayName"]);return e!==void 0&&n!=null&&y(e,["batch","displayName"],n),t}function OF(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["src"]);i!=null&&y(t,["batch","inputConfig"],GF(s,i));const a=g(e,["config"]);return a!=null&&LF(a,t),t}function UF(s,e){const t={},n=g(e,["name"]);return n!=null&&y(t,["_url","name"],qd(s,n)),t}function FF(s,e){const t={},n=g(e,["name"]);return n!=null&&y(t,["_url","name"],qd(s,n)),t}function zF(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["name"]);n!=null&&y(e,["name"],n);const i=g(s,["done"]);i!=null&&y(e,["done"],i);const a=g(s,["error"]);return a!=null&&y(e,["error"],a),e}function jF(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["name"]);n!=null&&y(e,["name"],n);const i=g(s,["done"]);i!=null&&y(e,["done"],i);const a=g(s,["error"]);return a!=null&&y(e,["error"],a),e}function HF(s,e){const t={},n=g(e,["contents"]);if(n!=null){let a=xw(s,n);Array.isArray(a)&&(a=a.map(l=>l)),y(t,["requests[]","request","content"],a)}const i=g(e,["config"]);return i!=null&&(y(t,["_self"],BF(i,t)),F3(t,{"requests[].*":"requests[].request.*"})),t}function BF(s,e){const t={},n=g(s,["taskType"]);e!==void 0&&n!=null&&y(e,["requests[]","taskType"],n);const i=g(s,["title"]);e!==void 0&&i!=null&&y(e,["requests[]","title"],i);const a=g(s,["outputDimensionality"]);if(e!==void 0&&a!=null&&y(e,["requests[]","outputDimensionality"],a),g(s,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(s,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function GF(s,e){const t={},n=g(e,["fileName"]);n!=null&&y(t,["file_name"],n);const i=g(e,["inlinedRequests"]);return i!=null&&y(t,["requests"],HF(s,i)),t}function qF(s){const e={};if(g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(s,["fileUri"]);t!=null&&y(e,["fileUri"],t);const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function VF(s){const e={},t=g(s,["id"]);t!=null&&y(e,["id"],t);const n=g(s,["args"]);n!=null&&y(e,["args"],n);const i=g(s,["name"]);if(i!=null&&y(e,["name"],i),g(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function $F(s){const e={},t=g(s,["allowedFunctionNames"]);t!=null&&y(e,["allowedFunctionNames"],t);const n=g(s,["mode"]);if(n!=null&&y(e,["mode"],n),g(s,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function YF(s,e,t){const n={},i=g(e,["systemInstruction"]);t!==void 0&&i!=null&&y(t,["systemInstruction"],xk(zn(i)));const a=g(e,["temperature"]);a!=null&&y(n,["temperature"],a);const l=g(e,["topP"]);l!=null&&y(n,["topP"],l);const c=g(e,["topK"]);c!=null&&y(n,["topK"],c);const d=g(e,["candidateCount"]);d!=null&&y(n,["candidateCount"],d);const h=g(e,["maxOutputTokens"]);h!=null&&y(n,["maxOutputTokens"],h);const p=g(e,["stopSequences"]);p!=null&&y(n,["stopSequences"],p);const v=g(e,["responseLogprobs"]);v!=null&&y(n,["responseLogprobs"],v);const x=g(e,["logprobs"]);x!=null&&y(n,["logprobs"],x);const S=g(e,["presencePenalty"]);S!=null&&y(n,["presencePenalty"],S);const A=g(e,["frequencyPenalty"]);A!=null&&y(n,["frequencyPenalty"],A);const E=g(e,["seed"]);E!=null&&y(n,["seed"],E);const N=g(e,["responseMimeType"]);N!=null&&y(n,["responseMimeType"],N);const R=g(e,["responseSchema"]);R!=null&&y(n,["responseSchema"],ww(R));const D=g(e,["responseJsonSchema"]);if(D!=null&&y(n,["responseJsonSchema"],D),g(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=g(e,["safetySettings"]);if(t!==void 0&&P!=null){let ve=P;Array.isArray(ve)&&(ve=ve.map(de=>c6(de))),y(t,["safetySettings"],ve)}const L=g(e,["tools"]);if(t!==void 0&&L!=null){let ve=Gd(L);Array.isArray(ve)&&(ve=ve.map(de=>d6(Bd(de)))),y(t,["tools"],ve)}const H=g(e,["toolConfig"]);if(t!==void 0&&H!=null&&y(t,["toolConfig"],u6(H)),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=g(e,["cachedContent"]);t!==void 0&&z!=null&&y(t,["cachedContent"],ga(s,z));const U=g(e,["responseModalities"]);U!=null&&y(n,["responseModalities"],U);const J=g(e,["mediaResolution"]);J!=null&&y(n,["mediaResolution"],J);const K=g(e,["speechConfig"]);if(K!=null&&y(n,["speechConfig"],Sw(K)),g(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ie=g(e,["thinkingConfig"]);ie!=null&&y(n,["thinkingConfig"],ie);const oe=g(e,["imageConfig"]);oe!=null&&y(n,["imageConfig"],ZF(oe));const ne=g(e,["enableEnhancedCivicAnswers"]);return ne!=null&&y(n,["enableEnhancedCivicAnswers"],ne),n}function KF(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>kF(h))),y(e,["candidates"],d)}const i=g(s,["modelVersion"]);i!=null&&y(e,["modelVersion"],i);const a=g(s,["promptFeedback"]);a!=null&&y(e,["promptFeedback"],a);const l=g(s,["responseId"]);l!=null&&y(e,["responseId"],l);const c=g(s,["usageMetadata"]);return c!=null&&y(e,["usageMetadata"],c),e}function JF(s,e){const t={},n=g(e,["name"]);return n!=null&&y(t,["_url","name"],qd(s,n)),t}function XF(s,e){const t={},n=g(e,["name"]);return n!=null&&y(t,["_url","name"],qd(s,n)),t}function WF(s){const e={};if(g(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(s,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function QF(s){const e={};if(g(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(s,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function ZF(s){const e={},t=g(s,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const n=g(s,["imageSize"]);if(n!=null&&y(e,["imageSize"],n),g(s,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(g(s,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(s,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function e6(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["request","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let c=ui(i);Array.isArray(c)&&(c=c.map(d=>xk(d))),y(t,["request","contents"],c)}const a=g(e,["metadata"]);a!=null&&y(t,["metadata"],a);const l=g(e,["config"]);return l!=null&&y(t,["request","generationConfig"],YF(s,l,g(t,["request"],{}))),t}function t6(s){const e={},t=g(s,["response"]);t!=null&&y(e,["response"],KF(t));const n=g(s,["error"]);return n!=null&&y(e,["error"],n),e}function n6(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);if(e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),g(s,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function s6(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);e!==void 0&&i!=null&&y(e,["_query","pageToken"],i);const a=g(s,["filter"]);return e!==void 0&&a!=null&&y(e,["_query","filter"],a),t}function i6(s){const e={},t=g(s,["config"]);return t!=null&&n6(t,e),e}function r6(s){const e={},t=g(s,["config"]);return t!=null&&s6(t,e),e}function a6(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const i=g(s,["operations"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>u0(l))),y(e,["batchJobs"],a)}return e}function o6(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const i=g(s,["batchPredictionJobs"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>jx(l))),y(e,["batchJobs"],a)}return e}function l6(s){const e={},t=g(s,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const n=g(s,["codeExecutionResult"]);n!=null&&y(e,["codeExecutionResult"],n);const i=g(s,["executableCode"]);i!=null&&y(e,["executableCode"],i);const a=g(s,["fileData"]);a!=null&&y(e,["fileData"],qF(a));const l=g(s,["functionCall"]);l!=null&&y(e,["functionCall"],VF(l));const c=g(s,["functionResponse"]);c!=null&&y(e,["functionResponse"],c);const d=g(s,["inlineData"]);d!=null&&y(e,["inlineData"],CF(d));const h=g(s,["text"]);h!=null&&y(e,["text"],h);const p=g(s,["thought"]);p!=null&&y(e,["thought"],p);const v=g(s,["thoughtSignature"]);v!=null&&y(e,["thoughtSignature"],v);const x=g(s,["videoMetadata"]);return x!=null&&y(e,["videoMetadata"],x),e}function c6(s){const e={},t=g(s,["category"]);if(t!=null&&y(e,["category"],t),g(s,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=g(s,["threshold"]);return n!=null&&y(e,["threshold"],n),e}function u6(s){const e={},t=g(s,["retrievalConfig"]);t!=null&&y(e,["retrievalConfig"],t);const n=g(s,["functionCallingConfig"]);return n!=null&&y(e,["functionCallingConfig"],$F(n)),e}function d6(s){const e={};if(g(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=g(s,["computerUse"]);t!=null&&y(e,["computerUse"],t);const n=g(s,["fileSearch"]);n!=null&&y(e,["fileSearch"],n);const i=g(s,["codeExecution"]);if(i!=null&&y(e,["codeExecution"],i),g(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(s,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(v=>v)),y(e,["functionDeclarations"],p)}const l=g(s,["googleMaps"]);l!=null&&y(e,["googleMaps"],WF(l));const c=g(s,["googleSearch"]);c!=null&&y(e,["googleSearch"],QF(c));const d=g(s,["googleSearchRetrieval"]);d!=null&&y(e,["googleSearchRetrieval"],d);const h=g(s,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var da;(function(s){s.PAGED_ITEM_BATCH_JOBS="batchJobs",s.PAGED_ITEM_MODELS="models",s.PAGED_ITEM_TUNING_JOBS="tuningJobs",s.PAGED_ITEM_FILES="files",s.PAGED_ITEM_CACHED_CONTENTS="cachedContents",s.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",s.PAGED_ITEM_DOCUMENTS="documents"})(da||(da={}));class gc{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i)}init(e,t,n){var i,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!n||Object.keys(n).length===0?l={config:{}}:typeof n=="object"?l=Object.assign({},n):l=n,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(i=l.config)===null||i===void 0?void 0:i.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class h6 extends ma{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new gc(da.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=QC(this.apiClient,e),n=t._url,i=pe("{model}:batchGenerateContent",n),c=t.batch.inputConfig.requests,d=c.requests,h=[];for(const p of d){const v=Object.assign({},p);if(v.systemInstruction){const x=v.systemInstruction;delete v.systemInstruction;const S=v.request;S.systemInstruction=x,v.request=S}h.push(v)}return c.requests=h,delete t.config,delete t._url,delete t._query,{path:i,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},i=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${i}`),n.dest===void 0){const a=this.getGcsUri(e),l=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?n.dest=`${a.slice(0,-6)}/dest`:n.dest=`${a}_dest_${i}`;else if(l)n.dest=`${l}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=PF(this.apiClient,e);return c=pe("batchPredictionJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>jx(p))}else{const h=QC(this.apiClient,e);return c=pe("{model}:batchGenerateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>u0(p))}}async createEmbeddingsInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=OF(this.apiClient,e);return a=pe("{model}:asyncBatchEmbedContent",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>u0(d))}}async get(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=XF(this.apiClient,e);return c=pe("batchPredictionJobs/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>jx(p))}else{const h=JF(this.apiClient,e);return c=pe("batches/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>u0(p))}}async cancel(e){var t,n,i,a;let l="",c={};if(this.apiClient.isVertexAI()){const d=RF(this.apiClient,e);l=pe("batchPredictionJobs/{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}else{const d=NF(this.apiClient,e);l=pe("batches/{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=r6(e);return c=pe("batchPredictionJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=o6(p),x=new KC;return Object.assign(x,v),x})}else{const h=i6(e);return c=pe("batches",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=a6(p),x=new KC;return Object.assign(x,v),x})}}async delete(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=FF(this.apiClient,e);return c=pe("batchPredictionJobs/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>jF(p))}else{const h=UF(this.apiClient,e);return c=pe("batches/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>zF(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f6(s){const e={},t=g(s,["data"]);if(t!=null&&y(e,["data"],t),g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function ZC(s){const e={},t=g(s,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>O6(a))),y(e,["parts"],i)}const n=g(s,["role"]);return n!=null&&y(e,["role"],n),e}function p6(s,e){const t={},n=g(s,["ttl"]);e!==void 0&&n!=null&&y(e,["ttl"],n);const i=g(s,["expireTime"]);e!==void 0&&i!=null&&y(e,["expireTime"],i);const a=g(s,["displayName"]);e!==void 0&&a!=null&&y(e,["displayName"],a);const l=g(s,["contents"]);if(e!==void 0&&l!=null){let p=ui(l);Array.isArray(p)&&(p=p.map(v=>ZC(v))),y(e,["contents"],p)}const c=g(s,["systemInstruction"]);e!==void 0&&c!=null&&y(e,["systemInstruction"],ZC(zn(c)));const d=g(s,["tools"]);if(e!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(v=>F6(v))),y(e,["tools"],p)}const h=g(s,["toolConfig"]);if(e!==void 0&&h!=null&&y(e,["toolConfig"],U6(h)),g(s,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function m6(s,e){const t={},n=g(s,["ttl"]);e!==void 0&&n!=null&&y(e,["ttl"],n);const i=g(s,["expireTime"]);e!==void 0&&i!=null&&y(e,["expireTime"],i);const a=g(s,["displayName"]);e!==void 0&&a!=null&&y(e,["displayName"],a);const l=g(s,["contents"]);if(e!==void 0&&l!=null){let v=ui(l);Array.isArray(v)&&(v=v.map(x=>x)),y(e,["contents"],v)}const c=g(s,["systemInstruction"]);e!==void 0&&c!=null&&y(e,["systemInstruction"],zn(c));const d=g(s,["tools"]);if(e!==void 0&&d!=null){let v=d;Array.isArray(v)&&(v=v.map(x=>z6(x))),y(e,["tools"],v)}const h=g(s,["toolConfig"]);e!==void 0&&h!=null&&y(e,["toolConfig"],h);const p=g(s,["kmsKeyName"]);return e!==void 0&&p!=null&&y(e,["encryption_spec","kmsKeyName"],p),t}function g6(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["model"],ck(s,n));const i=g(e,["config"]);return i!=null&&p6(i,t),t}function y6(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["model"],ck(s,n));const i=g(e,["config"]);return i!=null&&m6(i,t),t}function v6(s,e){const t={},n=g(e,["name"]);return n!=null&&y(t,["_url","name"],ga(s,n)),t}function b6(s,e){const t={},n=g(e,["name"]);return n!=null&&y(t,["_url","name"],ga(s,n)),t}function _6(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function x6(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function w6(s){const e={};if(g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(s,["fileUri"]);t!=null&&y(e,["fileUri"],t);const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function S6(s){const e={},t=g(s,["id"]);t!=null&&y(e,["id"],t);const n=g(s,["args"]);n!=null&&y(e,["args"],n);const i=g(s,["name"]);if(i!=null&&y(e,["name"],i),g(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function A6(s){const e={},t=g(s,["allowedFunctionNames"]);t!=null&&y(e,["allowedFunctionNames"],t);const n=g(s,["mode"]);if(n!=null&&y(e,["mode"],n),g(s,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function E6(s){const e={},t=g(s,["description"]);t!=null&&y(e,["description"],t);const n=g(s,["name"]);n!=null&&y(e,["name"],n);const i=g(s,["parameters"]);i!=null&&y(e,["parameters"],i);const a=g(s,["parametersJsonSchema"]);a!=null&&y(e,["parametersJsonSchema"],a);const l=g(s,["response"]);l!=null&&y(e,["response"],l);const c=g(s,["responseJsonSchema"]);if(c!=null&&y(e,["responseJsonSchema"],c),g(s,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function T6(s,e){const t={},n=g(e,["name"]);return n!=null&&y(t,["_url","name"],ga(s,n)),t}function C6(s,e){const t={},n=g(e,["name"]);return n!=null&&y(t,["_url","name"],ga(s,n)),t}function N6(s){const e={};if(g(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(s,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function R6(s){const e={};if(g(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(s,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function k6(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);return e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),t}function M6(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);return e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),t}function I6(s){const e={},t=g(s,["config"]);return t!=null&&k6(t,e),e}function D6(s){const e={},t=g(s,["config"]);return t!=null&&M6(t,e),e}function P6(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const i=g(s,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["cachedContents"],a)}return e}function L6(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const i=g(s,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["cachedContents"],a)}return e}function O6(s){const e={},t=g(s,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const n=g(s,["codeExecutionResult"]);n!=null&&y(e,["codeExecutionResult"],n);const i=g(s,["executableCode"]);i!=null&&y(e,["executableCode"],i);const a=g(s,["fileData"]);a!=null&&y(e,["fileData"],w6(a));const l=g(s,["functionCall"]);l!=null&&y(e,["functionCall"],S6(l));const c=g(s,["functionResponse"]);c!=null&&y(e,["functionResponse"],c);const d=g(s,["inlineData"]);d!=null&&y(e,["inlineData"],f6(d));const h=g(s,["text"]);h!=null&&y(e,["text"],h);const p=g(s,["thought"]);p!=null&&y(e,["thought"],p);const v=g(s,["thoughtSignature"]);v!=null&&y(e,["thoughtSignature"],v);const x=g(s,["videoMetadata"]);return x!=null&&y(e,["videoMetadata"],x),e}function U6(s){const e={},t=g(s,["retrievalConfig"]);t!=null&&y(e,["retrievalConfig"],t);const n=g(s,["functionCallingConfig"]);return n!=null&&y(e,["functionCallingConfig"],A6(n)),e}function F6(s){const e={};if(g(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=g(s,["computerUse"]);t!=null&&y(e,["computerUse"],t);const n=g(s,["fileSearch"]);n!=null&&y(e,["fileSearch"],n);const i=g(s,["codeExecution"]);if(i!=null&&y(e,["codeExecution"],i),g(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(s,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(v=>v)),y(e,["functionDeclarations"],p)}const l=g(s,["googleMaps"]);l!=null&&y(e,["googleMaps"],N6(l));const c=g(s,["googleSearch"]);c!=null&&y(e,["googleSearch"],R6(c));const d=g(s,["googleSearchRetrieval"]);d!=null&&y(e,["googleSearchRetrieval"],d);const h=g(s,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}function z6(s){const e={},t=g(s,["retrieval"]);t!=null&&y(e,["retrieval"],t);const n=g(s,["computerUse"]);if(n!=null&&y(e,["computerUse"],n),g(s,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=g(s,["codeExecution"]);i!=null&&y(e,["codeExecution"],i);const a=g(s,["enterpriseWebSearch"]);a!=null&&y(e,["enterpriseWebSearch"],a);const l=g(s,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(x=>E6(x))),y(e,["functionDeclarations"],v)}const c=g(s,["googleMaps"]);c!=null&&y(e,["googleMaps"],c);const d=g(s,["googleSearch"]);d!=null&&y(e,["googleSearch"],d);const h=g(s,["googleSearchRetrieval"]);h!=null&&y(e,["googleSearchRetrieval"],h);const p=g(s,["urlContext"]);return p!=null&&y(e,["urlContext"],p),e}function j6(s,e){const t={},n=g(s,["ttl"]);e!==void 0&&n!=null&&y(e,["ttl"],n);const i=g(s,["expireTime"]);return e!==void 0&&i!=null&&y(e,["expireTime"],i),t}function H6(s,e){const t={},n=g(s,["ttl"]);e!==void 0&&n!=null&&y(e,["ttl"],n);const i=g(s,["expireTime"]);return e!==void 0&&i!=null&&y(e,["expireTime"],i),t}function B6(s,e){const t={},n=g(e,["name"]);n!=null&&y(t,["_url","name"],ga(s,n));const i=g(e,["config"]);return i!=null&&j6(i,t),t}function G6(s,e){const t={},n=g(e,["name"]);n!=null&&y(t,["_url","name"],ga(s,n));const i=g(e,["config"]);return i!=null&&H6(i,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class q6 extends ma{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new gc(da.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=y6(this.apiClient,e);return c=pe("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=g6(this.apiClient,e);return c=pe("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async get(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=C6(this.apiClient,e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=T6(this.apiClient,e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async delete(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=b6(this.apiClient,e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=x6(p),x=new $C;return Object.assign(x,v),x})}else{const h=v6(this.apiClient,e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=_6(p),x=new $C;return Object.assign(x,v),x})}}async update(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=G6(this.apiClient,e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=B6(this.apiClient,e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async listInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=D6(e);return c=pe("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=L6(p),x=new YC;return Object.assign(x,v),x})}else{const h=I6(e);return c=pe("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=P6(p),x=new YC;return Object.assign(x,v),x})}}}function R0(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(s);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(s,n[i])&&(t[n[i]]=s[n[i]]);return t}function eN(s){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&s[e],n=0;if(t)return t.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ue(s){return this instanceof Ue?(this.v=s,this):new Ue(s)}function Pi(s,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(s,e||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(S){return function(A){return Promise.resolve(A).then(S,v)}}function c(S,A){n[S]&&(i[S]=function(E){return new Promise(function(N,R){a.push([S,E,N,R])>1||d(S,E)})},A&&(i[S]=A(i[S])))}function d(S,A){try{h(n[S](A))}catch(E){x(a[0][3],E)}}function h(S){S.value instanceof Ue?Promise.resolve(S.value.v).then(p,v):x(a[0][2],S)}function p(S){d("next",S)}function v(S){d("throw",S)}function x(S,A){S(A),a.shift(),a.length&&d(a[0][0],a[0][1])}}function Li(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=s[Symbol.asyncIterator],t;return e?e.call(s):(s=typeof eN=="function"?eN(s):s[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=s[a]&&function(l){return new Promise(function(c,d){l=s[a](l),i(c,d,l.done,l.value)})}}function i(a,l,c,d){Promise.resolve(d).then(function(h){a({value:h,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function V6(s){var e;if(s.candidates==null||s.candidates.length===0)return!1;const t=(e=s.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:wk(t)}function wk(s){if(s.parts===void 0||s.parts.length===0)return!1;for(const e of s.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function $6(s){if(s.length!==0){for(const e of s)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function tN(s){if(s===void 0||s.length===0)return[];const e=[],t=s.length;let n=0;for(;n<t;)if(s[n].role==="user")e.push(s[n]),n++;else{const i=[];let a=!0;for(;n<t&&s[n].role==="model";)i.push(s[n]),a&&!wk(s[n])&&(a=!1),n++;a?e.push(...i):e.pop()}return e}class Y6{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new K6(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class K6{constructor(e,t,n,i={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=a,this.sendPromise=Promise.resolve(),$6(a)}async sendMessage(e){var t;await this.sendPromise;const n=zn(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,l,c;const d=await i,h=(l=(a=d.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,p=d.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let x=[];p!=null&&(x=(c=p.slice(v))!==null&&c!==void 0?c:[]);const S=h?[h]:[];this.recordHistory(n,S,x)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;const n=zn(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const a=await i;return this.processStreamResponse(a,n)}getHistory(e=!1){const t=e?tN(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Pi(this,arguments,function*(){var i,a,l,c,d,h;const p=[];try{for(var v=!0,x=Li(e),S;S=yield Ue(x.next()),i=S.done,!i;v=!0){c=S.value,v=!1;const A=c;if(V6(A)){const E=(h=(d=A.candidates)===null||d===void 0?void 0:d[0])===null||h===void 0?void 0:h.content;E!==void 0&&p.push(E)}yield yield Ue(A)}}catch(A){a={error:A}}finally{try{!v&&!i&&(l=x.return)&&(yield Ue(l.call(x)))}finally{if(a)throw a.error}}this.recordHistory(t,p)})}recordHistory(e,t,n){let i=[];t.length>0&&t.every(a=>a.role!==void 0)?i=t:i.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...tN(n)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dy extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,dy.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function J6(s){const e={},t=g(s,["file"]);return t!=null&&y(e,["file"],t),e}function X6(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function W6(s){const e={},t=g(s,["name"]);return t!=null&&y(e,["_url","file"],mk(t)),e}function Q6(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function Z6(s){const e={},t=g(s,["name"]);return t!=null&&y(e,["_url","file"],mk(t)),e}function ez(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);return e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),t}function tz(s){const e={},t=g(s,["config"]);return t!=null&&ez(t,e),e}function nz(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const i=g(s,["files"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sz extends ma{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new gc(da.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=tz(e);return a=pe("files",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const h=nz(d),p=new oF;return Object.assign(p,h),p})}}async createInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=J6(e);return a=pe("upload/v1beta/files",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=X6(d),p=new lF;return Object.assign(p,h),p})}}async get(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Z6(e);return a=pe("files/{file}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=W6(e);return a=pe("files/{file}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const h=Q6(d),p=new cF;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function d0(s){const e={},t=g(s,["data"]);if(t!=null&&y(e,["data"],t),g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function iz(s){const e={},t=g(s,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>_z(a))),y(e,["parts"],i)}const n=g(s,["role"]);return n!=null&&y(e,["role"],n),e}function rz(s){const e={};if(g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(s,["fileUri"]);t!=null&&y(e,["fileUri"],t);const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function az(s){const e={},t=g(s,["id"]);t!=null&&y(e,["id"],t);const n=g(s,["args"]);n!=null&&y(e,["args"],n);const i=g(s,["name"]);if(i!=null&&y(e,["name"],i),g(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function oz(s){const e={},t=g(s,["description"]);t!=null&&y(e,["description"],t);const n=g(s,["name"]);n!=null&&y(e,["name"],n);const i=g(s,["parameters"]);i!=null&&y(e,["parameters"],i);const a=g(s,["parametersJsonSchema"]);a!=null&&y(e,["parametersJsonSchema"],a);const l=g(s,["response"]);l!=null&&y(e,["response"],l);const c=g(s,["responseJsonSchema"]);if(c!=null&&y(e,["responseJsonSchema"],c),g(s,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function lz(s){const e={},t=g(s,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const n=g(s,["responseJsonSchema"]);n!=null&&y(e,["responseJsonSchema"],n);const i=g(s,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const a=g(s,["candidateCount"]);a!=null&&y(e,["candidateCount"],a);const l=g(s,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const c=g(s,["frequencyPenalty"]);c!=null&&y(e,["frequencyPenalty"],c);const d=g(s,["logprobs"]);d!=null&&y(e,["logprobs"],d);const h=g(s,["maxOutputTokens"]);h!=null&&y(e,["maxOutputTokens"],h);const p=g(s,["mediaResolution"]);p!=null&&y(e,["mediaResolution"],p);const v=g(s,["presencePenalty"]);v!=null&&y(e,["presencePenalty"],v);const x=g(s,["responseLogprobs"]);x!=null&&y(e,["responseLogprobs"],x);const S=g(s,["responseMimeType"]);S!=null&&y(e,["responseMimeType"],S);const A=g(s,["responseModalities"]);A!=null&&y(e,["responseModalities"],A);const E=g(s,["responseSchema"]);E!=null&&y(e,["responseSchema"],E);const N=g(s,["routingConfig"]);N!=null&&y(e,["routingConfig"],N);const R=g(s,["seed"]);R!=null&&y(e,["seed"],R);const D=g(s,["speechConfig"]);D!=null&&y(e,["speechConfig"],D);const P=g(s,["stopSequences"]);P!=null&&y(e,["stopSequences"],P);const L=g(s,["temperature"]);L!=null&&y(e,["temperature"],L);const H=g(s,["thinkingConfig"]);H!=null&&y(e,["thinkingConfig"],H);const z=g(s,["topK"]);z!=null&&y(e,["topK"],z);const U=g(s,["topP"]);if(U!=null&&y(e,["topP"],U),g(s,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function cz(s){const e={};if(g(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(s,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function uz(s){const e={};if(g(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(s,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function dz(s,e){const t={},n=g(s,["generationConfig"]);e!==void 0&&n!=null&&y(e,["setup","generationConfig"],n);const i=g(s,["responseModalities"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig","responseModalities"],i);const a=g(s,["temperature"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","temperature"],a);const l=g(s,["topP"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","topP"],l);const c=g(s,["topK"]);e!==void 0&&c!=null&&y(e,["setup","generationConfig","topK"],c);const d=g(s,["maxOutputTokens"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","maxOutputTokens"],d);const h=g(s,["mediaResolution"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","mediaResolution"],h);const p=g(s,["seed"]);e!==void 0&&p!=null&&y(e,["setup","generationConfig","seed"],p);const v=g(s,["speechConfig"]);e!==void 0&&v!=null&&y(e,["setup","generationConfig","speechConfig"],Aw(v));const x=g(s,["thinkingConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","thinkingConfig"],x);const S=g(s,["enableAffectiveDialog"]);e!==void 0&&S!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],S);const A=g(s,["systemInstruction"]);e!==void 0&&A!=null&&y(e,["setup","systemInstruction"],iz(zn(A)));const E=g(s,["tools"]);if(e!==void 0&&E!=null){let z=Gd(E);Array.isArray(z)&&(z=z.map(U=>wz(Bd(U)))),y(e,["setup","tools"],z)}const N=g(s,["sessionResumption"]);e!==void 0&&N!=null&&y(e,["setup","sessionResumption"],xz(N));const R=g(s,["inputAudioTranscription"]);e!==void 0&&R!=null&&y(e,["setup","inputAudioTranscription"],R);const D=g(s,["outputAudioTranscription"]);e!==void 0&&D!=null&&y(e,["setup","outputAudioTranscription"],D);const P=g(s,["realtimeInputConfig"]);e!==void 0&&P!=null&&y(e,["setup","realtimeInputConfig"],P);const L=g(s,["contextWindowCompression"]);e!==void 0&&L!=null&&y(e,["setup","contextWindowCompression"],L);const H=g(s,["proactivity"]);if(e!==void 0&&H!=null&&y(e,["setup","proactivity"],H),g(s,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function hz(s,e){const t={},n=g(s,["generationConfig"]);e!==void 0&&n!=null&&y(e,["setup","generationConfig"],lz(n));const i=g(s,["responseModalities"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig","responseModalities"],i);const a=g(s,["temperature"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","temperature"],a);const l=g(s,["topP"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","topP"],l);const c=g(s,["topK"]);e!==void 0&&c!=null&&y(e,["setup","generationConfig","topK"],c);const d=g(s,["maxOutputTokens"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","maxOutputTokens"],d);const h=g(s,["mediaResolution"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","mediaResolution"],h);const p=g(s,["seed"]);e!==void 0&&p!=null&&y(e,["setup","generationConfig","seed"],p);const v=g(s,["speechConfig"]);e!==void 0&&v!=null&&y(e,["setup","generationConfig","speechConfig"],Aw(v));const x=g(s,["thinkingConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","thinkingConfig"],x);const S=g(s,["enableAffectiveDialog"]);e!==void 0&&S!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],S);const A=g(s,["systemInstruction"]);e!==void 0&&A!=null&&y(e,["setup","systemInstruction"],zn(A));const E=g(s,["tools"]);if(e!==void 0&&E!=null){let U=Gd(E);Array.isArray(U)&&(U=U.map(J=>Sz(Bd(J)))),y(e,["setup","tools"],U)}const N=g(s,["sessionResumption"]);e!==void 0&&N!=null&&y(e,["setup","sessionResumption"],N);const R=g(s,["inputAudioTranscription"]);e!==void 0&&R!=null&&y(e,["setup","inputAudioTranscription"],R);const D=g(s,["outputAudioTranscription"]);e!==void 0&&D!=null&&y(e,["setup","outputAudioTranscription"],D);const P=g(s,["realtimeInputConfig"]);e!==void 0&&P!=null&&y(e,["setup","realtimeInputConfig"],P);const L=g(s,["contextWindowCompression"]);e!==void 0&&L!=null&&y(e,["setup","contextWindowCompression"],L);const H=g(s,["proactivity"]);e!==void 0&&H!=null&&y(e,["setup","proactivity"],H);const z=g(s,["explicitVadSignal"]);return e!==void 0&&z!=null&&y(e,["setup","explicitVadSignal"],z),t}function fz(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["setup","model"],it(s,n));const i=g(e,["config"]);return i!=null&&y(t,["config"],dz(i,t)),t}function pz(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["setup","model"],it(s,n));const i=g(e,["config"]);return i!=null&&y(t,["config"],hz(i,t)),t}function mz(s){const e={},t=g(s,["musicGenerationConfig"]);return t!=null&&y(e,["musicGenerationConfig"],t),e}function gz(s){const e={},t=g(s,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>i)),y(e,["weightedPrompts"],n)}return e}function yz(s){const e={},t=g(s,["media"]);if(t!=null){let h=uk(t);Array.isArray(h)&&(h=h.map(p=>d0(p))),y(e,["mediaChunks"],h)}const n=g(s,["audio"]);n!=null&&y(e,["audio"],d0(hk(n)));const i=g(s,["audioStreamEnd"]);i!=null&&y(e,["audioStreamEnd"],i);const a=g(s,["video"]);a!=null&&y(e,["video"],d0(dk(a)));const l=g(s,["text"]);l!=null&&y(e,["text"],l);const c=g(s,["activityStart"]);c!=null&&y(e,["activityStart"],c);const d=g(s,["activityEnd"]);return d!=null&&y(e,["activityEnd"],d),e}function vz(s){const e={},t=g(s,["media"]);if(t!=null){let h=uk(t);Array.isArray(h)&&(h=h.map(p=>p)),y(e,["mediaChunks"],h)}const n=g(s,["audio"]);n!=null&&y(e,["audio"],hk(n));const i=g(s,["audioStreamEnd"]);i!=null&&y(e,["audioStreamEnd"],i);const a=g(s,["video"]);a!=null&&y(e,["video"],dk(a));const l=g(s,["text"]);l!=null&&y(e,["text"],l);const c=g(s,["activityStart"]);c!=null&&y(e,["activityStart"],c);const d=g(s,["activityEnd"]);return d!=null&&y(e,["activityEnd"],d),e}function bz(s){const e={},t=g(s,["setupComplete"]);t!=null&&y(e,["setupComplete"],t);const n=g(s,["serverContent"]);n!=null&&y(e,["serverContent"],n);const i=g(s,["toolCall"]);i!=null&&y(e,["toolCall"],i);const a=g(s,["toolCallCancellation"]);a!=null&&y(e,["toolCallCancellation"],a);const l=g(s,["usageMetadata"]);l!=null&&y(e,["usageMetadata"],Az(l));const c=g(s,["goAway"]);c!=null&&y(e,["goAway"],c);const d=g(s,["sessionResumptionUpdate"]);d!=null&&y(e,["sessionResumptionUpdate"],d);const h=g(s,["voiceActivityDetectionSignal"]);return h!=null&&y(e,["voiceActivityDetectionSignal"],h),e}function _z(s){const e={},t=g(s,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const n=g(s,["codeExecutionResult"]);n!=null&&y(e,["codeExecutionResult"],n);const i=g(s,["executableCode"]);i!=null&&y(e,["executableCode"],i);const a=g(s,["fileData"]);a!=null&&y(e,["fileData"],rz(a));const l=g(s,["functionCall"]);l!=null&&y(e,["functionCall"],az(l));const c=g(s,["functionResponse"]);c!=null&&y(e,["functionResponse"],c);const d=g(s,["inlineData"]);d!=null&&y(e,["inlineData"],d0(d));const h=g(s,["text"]);h!=null&&y(e,["text"],h);const p=g(s,["thought"]);p!=null&&y(e,["thought"],p);const v=g(s,["thoughtSignature"]);v!=null&&y(e,["thoughtSignature"],v);const x=g(s,["videoMetadata"]);return x!=null&&y(e,["videoMetadata"],x),e}function xz(s){const e={},t=g(s,["handle"]);if(t!=null&&y(e,["handle"],t),g(s,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function wz(s){const e={};if(g(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=g(s,["computerUse"]);t!=null&&y(e,["computerUse"],t);const n=g(s,["fileSearch"]);n!=null&&y(e,["fileSearch"],n);const i=g(s,["codeExecution"]);if(i!=null&&y(e,["codeExecution"],i),g(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(s,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(v=>v)),y(e,["functionDeclarations"],p)}const l=g(s,["googleMaps"]);l!=null&&y(e,["googleMaps"],cz(l));const c=g(s,["googleSearch"]);c!=null&&y(e,["googleSearch"],uz(c));const d=g(s,["googleSearchRetrieval"]);d!=null&&y(e,["googleSearchRetrieval"],d);const h=g(s,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}function Sz(s){const e={},t=g(s,["retrieval"]);t!=null&&y(e,["retrieval"],t);const n=g(s,["computerUse"]);if(n!=null&&y(e,["computerUse"],n),g(s,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=g(s,["codeExecution"]);i!=null&&y(e,["codeExecution"],i);const a=g(s,["enterpriseWebSearch"]);a!=null&&y(e,["enterpriseWebSearch"],a);const l=g(s,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(x=>oz(x))),y(e,["functionDeclarations"],v)}const c=g(s,["googleMaps"]);c!=null&&y(e,["googleMaps"],c);const d=g(s,["googleSearch"]);d!=null&&y(e,["googleSearch"],d);const h=g(s,["googleSearchRetrieval"]);h!=null&&y(e,["googleSearchRetrieval"],h);const p=g(s,["urlContext"]);return p!=null&&y(e,["urlContext"],p),e}function Az(s){const e={},t=g(s,["promptTokenCount"]);t!=null&&y(e,["promptTokenCount"],t);const n=g(s,["cachedContentTokenCount"]);n!=null&&y(e,["cachedContentTokenCount"],n);const i=g(s,["candidatesTokenCount"]);i!=null&&y(e,["responseTokenCount"],i);const a=g(s,["toolUsePromptTokenCount"]);a!=null&&y(e,["toolUsePromptTokenCount"],a);const l=g(s,["thoughtsTokenCount"]);l!=null&&y(e,["thoughtsTokenCount"],l);const c=g(s,["totalTokenCount"]);c!=null&&y(e,["totalTokenCount"],c);const d=g(s,["promptTokensDetails"]);if(d!=null){let S=d;Array.isArray(S)&&(S=S.map(A=>A)),y(e,["promptTokensDetails"],S)}const h=g(s,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(A=>A)),y(e,["cacheTokensDetails"],S)}const p=g(s,["candidatesTokensDetails"]);if(p!=null){let S=p;Array.isArray(S)&&(S=S.map(A=>A)),y(e,["responseTokensDetails"],S)}const v=g(s,["toolUsePromptTokensDetails"]);if(v!=null){let S=v;Array.isArray(S)&&(S=S.map(A=>A)),y(e,["toolUsePromptTokensDetails"],S)}const x=g(s,["trafficType"]);return x!=null&&y(e,["trafficType"],x),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ez(s){const e={},t=g(s,["data"]);if(t!=null&&y(e,["data"],t),g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function Tz(s){const e={},t=g(s,["content"]);t!=null&&y(e,["content"],t);const n=g(s,["citationMetadata"]);n!=null&&y(e,["citationMetadata"],Cz(n));const i=g(s,["tokenCount"]);i!=null&&y(e,["tokenCount"],i);const a=g(s,["finishReason"]);a!=null&&y(e,["finishReason"],a);const l=g(s,["avgLogprobs"]);l!=null&&y(e,["avgLogprobs"],l);const c=g(s,["groundingMetadata"]);c!=null&&y(e,["groundingMetadata"],c);const d=g(s,["index"]);d!=null&&y(e,["index"],d);const h=g(s,["logprobsResult"]);h!=null&&y(e,["logprobsResult"],h);const p=g(s,["safetyRatings"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(S=>S)),y(e,["safetyRatings"],x)}const v=g(s,["urlContextMetadata"]);return v!=null&&y(e,["urlContextMetadata"],v),e}function Cz(s){const e={},t=g(s,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>i)),y(e,["citations"],n)}return e}function Nz(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let a=ui(i);Array.isArray(a)&&(a=a.map(l=>l)),y(t,["contents"],a)}return t}function Rz(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["tokensInfo"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>a)),y(e,["tokensInfo"],i)}return e}function kz(s){const e={},t=g(s,["values"]);t!=null&&y(e,["values"],t);const n=g(s,["statistics"]);return n!=null&&y(e,["statistics"],Mz(n)),e}function Mz(s){const e={},t=g(s,["truncated"]);t!=null&&y(e,["truncated"],t);const n=g(s,["token_count"]);return n!=null&&y(e,["tokenCount"],n),e}function hy(s){const e={},t=g(s,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>jj(a))),y(e,["parts"],i)}const n=g(s,["role"]);return n!=null&&y(e,["role"],n),e}function Iz(s){const e={},t=g(s,["controlType"]);t!=null&&y(e,["controlType"],t);const n=g(s,["enableControlImageComputation"]);return n!=null&&y(e,["computeControl"],n),e}function Dz(s){const e={};if(g(s,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(g(s,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(g(s,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Pz(s,e){const t={},n=g(s,["systemInstruction"]);e!==void 0&&n!=null&&y(e,["systemInstruction"],zn(n));const i=g(s,["tools"]);if(e!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>Tk(c))),y(e,["tools"],l)}const a=g(s,["generationConfig"]);return e!==void 0&&a!=null&&y(e,["generationConfig"],Ej(a)),t}function Lz(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let l=ui(i);Array.isArray(l)&&(l=l.map(c=>hy(c))),y(t,["contents"],l)}const a=g(e,["config"]);return a!=null&&Dz(a),t}function Oz(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let l=ui(i);Array.isArray(l)&&(l=l.map(c=>c)),y(t,["contents"],l)}const a=g(e,["config"]);return a!=null&&Pz(a,t),t}function Uz(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["totalTokens"]);n!=null&&y(e,["totalTokens"],n);const i=g(s,["cachedContentTokenCount"]);return i!=null&&y(e,["cachedContentTokenCount"],i),e}function Fz(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["totalTokens"]);return n!=null&&y(e,["totalTokens"],n),e}function zz(s,e){const t={},n=g(e,["model"]);return n!=null&&y(t,["_url","name"],it(s,n)),t}function jz(s,e){const t={},n=g(e,["model"]);return n!=null&&y(t,["_url","name"],it(s,n)),t}function Hz(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function Bz(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function Gz(s,e){const t={},n=g(s,["outputGcsUri"]);e!==void 0&&n!=null&&y(e,["parameters","storageUri"],n);const i=g(s,["negativePrompt"]);e!==void 0&&i!=null&&y(e,["parameters","negativePrompt"],i);const a=g(s,["numberOfImages"]);e!==void 0&&a!=null&&y(e,["parameters","sampleCount"],a);const l=g(s,["aspectRatio"]);e!==void 0&&l!=null&&y(e,["parameters","aspectRatio"],l);const c=g(s,["guidanceScale"]);e!==void 0&&c!=null&&y(e,["parameters","guidanceScale"],c);const d=g(s,["seed"]);e!==void 0&&d!=null&&y(e,["parameters","seed"],d);const h=g(s,["safetyFilterLevel"]);e!==void 0&&h!=null&&y(e,["parameters","safetySetting"],h);const p=g(s,["personGeneration"]);e!==void 0&&p!=null&&y(e,["parameters","personGeneration"],p);const v=g(s,["includeSafetyAttributes"]);e!==void 0&&v!=null&&y(e,["parameters","includeSafetyAttributes"],v);const x=g(s,["includeRaiReason"]);e!==void 0&&x!=null&&y(e,["parameters","includeRaiReason"],x);const S=g(s,["language"]);e!==void 0&&S!=null&&y(e,["parameters","language"],S);const A=g(s,["outputMimeType"]);e!==void 0&&A!=null&&y(e,["parameters","outputOptions","mimeType"],A);const E=g(s,["outputCompressionQuality"]);e!==void 0&&E!=null&&y(e,["parameters","outputOptions","compressionQuality"],E);const N=g(s,["addWatermark"]);e!==void 0&&N!=null&&y(e,["parameters","addWatermark"],N);const R=g(s,["labels"]);e!==void 0&&R!=null&&y(e,["labels"],R);const D=g(s,["editMode"]);e!==void 0&&D!=null&&y(e,["parameters","editMode"],D);const P=g(s,["baseSteps"]);return e!==void 0&&P!=null&&y(e,["parameters","editConfig","baseSteps"],P),t}function qz(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["prompt"]);i!=null&&y(t,["instances[0]","prompt"],i);const a=g(e,["referenceImages"]);if(a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>$j(d))),y(t,["instances[0]","referenceImages"],c)}const l=g(e,["config"]);return l!=null&&Gz(l,t),t}function Vz(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>fy(a))),y(e,["generatedImages"],i)}return e}function $z(s,e){const t={},n=g(s,["taskType"]);e!==void 0&&n!=null&&y(e,["requests[]","taskType"],n);const i=g(s,["title"]);e!==void 0&&i!=null&&y(e,["requests[]","title"],i);const a=g(s,["outputDimensionality"]);if(e!==void 0&&a!=null&&y(e,["requests[]","outputDimensionality"],a),g(s,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(s,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Yz(s,e){const t={},n=g(s,["taskType"]);e!==void 0&&n!=null&&y(e,["instances[]","task_type"],n);const i=g(s,["title"]);e!==void 0&&i!=null&&y(e,["instances[]","title"],i);const a=g(s,["outputDimensionality"]);e!==void 0&&a!=null&&y(e,["parameters","outputDimensionality"],a);const l=g(s,["mimeType"]);e!==void 0&&l!=null&&y(e,["instances[]","mimeType"],l);const c=g(s,["autoTruncate"]);return e!==void 0&&c!=null&&y(e,["parameters","autoTruncate"],c),t}function Kz(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let c=xw(s,i);Array.isArray(c)&&(c=c.map(d=>d)),y(t,["requests[]","content"],c)}const a=g(e,["config"]);a!=null&&$z(a,t);const l=g(e,["model"]);return l!==void 0&&y(t,["requests[]","model"],it(s,l)),t}function Jz(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let l=xw(s,i);Array.isArray(l)&&(l=l.map(c=>c)),y(t,["instances[]","content"],l)}const a=g(e,["config"]);return a!=null&&Yz(a,t),t}function Xz(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["embeddings"],a)}const i=g(s,["metadata"]);return i!=null&&y(e,["metadata"],i),e}function Wz(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>kz(l))),y(e,["embeddings"],a)}const i=g(s,["metadata"]);return i!=null&&y(e,["metadata"],i),e}function Qz(s){const e={},t=g(s,["endpoint"]);t!=null&&y(e,["name"],t);const n=g(s,["deployedModelId"]);return n!=null&&y(e,["deployedModelId"],n),e}function Zz(s){const e={};if(g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(s,["fileUri"]);t!=null&&y(e,["fileUri"],t);const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function ej(s){const e={},t=g(s,["id"]);t!=null&&y(e,["id"],t);const n=g(s,["args"]);n!=null&&y(e,["args"],n);const i=g(s,["name"]);if(i!=null&&y(e,["name"],i),g(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function tj(s){const e={},t=g(s,["allowedFunctionNames"]);t!=null&&y(e,["allowedFunctionNames"],t);const n=g(s,["mode"]);if(n!=null&&y(e,["mode"],n),g(s,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function nj(s){const e={},t=g(s,["description"]);t!=null&&y(e,["description"],t);const n=g(s,["name"]);n!=null&&y(e,["name"],n);const i=g(s,["parameters"]);i!=null&&y(e,["parameters"],i);const a=g(s,["parametersJsonSchema"]);a!=null&&y(e,["parametersJsonSchema"],a);const l=g(s,["response"]);l!=null&&y(e,["response"],l);const c=g(s,["responseJsonSchema"]);if(c!=null&&y(e,["responseJsonSchema"],c),g(s,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function sj(s,e,t){const n={},i=g(e,["systemInstruction"]);t!==void 0&&i!=null&&y(t,["systemInstruction"],hy(zn(i)));const a=g(e,["temperature"]);a!=null&&y(n,["temperature"],a);const l=g(e,["topP"]);l!=null&&y(n,["topP"],l);const c=g(e,["topK"]);c!=null&&y(n,["topK"],c);const d=g(e,["candidateCount"]);d!=null&&y(n,["candidateCount"],d);const h=g(e,["maxOutputTokens"]);h!=null&&y(n,["maxOutputTokens"],h);const p=g(e,["stopSequences"]);p!=null&&y(n,["stopSequences"],p);const v=g(e,["responseLogprobs"]);v!=null&&y(n,["responseLogprobs"],v);const x=g(e,["logprobs"]);x!=null&&y(n,["logprobs"],x);const S=g(e,["presencePenalty"]);S!=null&&y(n,["presencePenalty"],S);const A=g(e,["frequencyPenalty"]);A!=null&&y(n,["frequencyPenalty"],A);const E=g(e,["seed"]);E!=null&&y(n,["seed"],E);const N=g(e,["responseMimeType"]);N!=null&&y(n,["responseMimeType"],N);const R=g(e,["responseSchema"]);R!=null&&y(n,["responseSchema"],ww(R));const D=g(e,["responseJsonSchema"]);if(D!=null&&y(n,["responseJsonSchema"],D),g(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=g(e,["safetySettings"]);if(t!==void 0&&P!=null){let ve=P;Array.isArray(ve)&&(ve=ve.map(de=>Yj(de))),y(t,["safetySettings"],ve)}const L=g(e,["tools"]);if(t!==void 0&&L!=null){let ve=Gd(L);Array.isArray(ve)&&(ve=ve.map(de=>eH(Bd(de)))),y(t,["tools"],ve)}const H=g(e,["toolConfig"]);if(t!==void 0&&H!=null&&y(t,["toolConfig"],Zj(H)),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=g(e,["cachedContent"]);t!==void 0&&z!=null&&y(t,["cachedContent"],ga(s,z));const U=g(e,["responseModalities"]);U!=null&&y(n,["responseModalities"],U);const J=g(e,["mediaResolution"]);J!=null&&y(n,["mediaResolution"],J);const K=g(e,["speechConfig"]);if(K!=null&&y(n,["speechConfig"],Sw(K)),g(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ie=g(e,["thinkingConfig"]);ie!=null&&y(n,["thinkingConfig"],ie);const oe=g(e,["imageConfig"]);oe!=null&&y(n,["imageConfig"],kj(oe));const ne=g(e,["enableEnhancedCivicAnswers"]);return ne!=null&&y(n,["enableEnhancedCivicAnswers"],ne),n}function ij(s,e,t){const n={},i=g(e,["systemInstruction"]);t!==void 0&&i!=null&&y(t,["systemInstruction"],zn(i));const a=g(e,["temperature"]);a!=null&&y(n,["temperature"],a);const l=g(e,["topP"]);l!=null&&y(n,["topP"],l);const c=g(e,["topK"]);c!=null&&y(n,["topK"],c);const d=g(e,["candidateCount"]);d!=null&&y(n,["candidateCount"],d);const h=g(e,["maxOutputTokens"]);h!=null&&y(n,["maxOutputTokens"],h);const p=g(e,["stopSequences"]);p!=null&&y(n,["stopSequences"],p);const v=g(e,["responseLogprobs"]);v!=null&&y(n,["responseLogprobs"],v);const x=g(e,["logprobs"]);x!=null&&y(n,["logprobs"],x);const S=g(e,["presencePenalty"]);S!=null&&y(n,["presencePenalty"],S);const A=g(e,["frequencyPenalty"]);A!=null&&y(n,["frequencyPenalty"],A);const E=g(e,["seed"]);E!=null&&y(n,["seed"],E);const N=g(e,["responseMimeType"]);N!=null&&y(n,["responseMimeType"],N);const R=g(e,["responseSchema"]);R!=null&&y(n,["responseSchema"],ww(R));const D=g(e,["responseJsonSchema"]);D!=null&&y(n,["responseJsonSchema"],D);const P=g(e,["routingConfig"]);P!=null&&y(n,["routingConfig"],P);const L=g(e,["modelSelectionConfig"]);L!=null&&y(n,["modelConfig"],L);const H=g(e,["safetySettings"]);if(t!==void 0&&H!=null){let j=H;Array.isArray(j)&&(j=j.map(X=>X)),y(t,["safetySettings"],j)}const z=g(e,["tools"]);if(t!==void 0&&z!=null){let j=Gd(z);Array.isArray(j)&&(j=j.map(X=>Tk(Bd(X)))),y(t,["tools"],j)}const U=g(e,["toolConfig"]);t!==void 0&&U!=null&&y(t,["toolConfig"],U);const J=g(e,["labels"]);t!==void 0&&J!=null&&y(t,["labels"],J);const K=g(e,["cachedContent"]);t!==void 0&&K!=null&&y(t,["cachedContent"],ga(s,K));const ie=g(e,["responseModalities"]);ie!=null&&y(n,["responseModalities"],ie);const oe=g(e,["mediaResolution"]);oe!=null&&y(n,["mediaResolution"],oe);const ne=g(e,["speechConfig"]);ne!=null&&y(n,["speechConfig"],Sw(ne));const ve=g(e,["audioTimestamp"]);ve!=null&&y(n,["audioTimestamp"],ve);const de=g(e,["thinkingConfig"]);de!=null&&y(n,["thinkingConfig"],de);const Re=g(e,["imageConfig"]);if(Re!=null&&y(n,["imageConfig"],Mj(Re)),g(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}function nN(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let l=ui(i);Array.isArray(l)&&(l=l.map(c=>hy(c))),y(t,["contents"],l)}const a=g(e,["config"]);return a!=null&&y(t,["generationConfig"],sj(s,a,t)),t}function sN(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["contents"]);if(i!=null){let l=ui(i);Array.isArray(l)&&(l=l.map(c=>c)),y(t,["contents"],l)}const a=g(e,["config"]);return a!=null&&y(t,["generationConfig"],ij(s,a,t)),t}function iN(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>Tz(h))),y(e,["candidates"],d)}const i=g(s,["modelVersion"]);i!=null&&y(e,["modelVersion"],i);const a=g(s,["promptFeedback"]);a!=null&&y(e,["promptFeedback"],a);const l=g(s,["responseId"]);l!=null&&y(e,["responseId"],l);const c=g(s,["usageMetadata"]);return c!=null&&y(e,["usageMetadata"],c),e}function rN(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>p)),y(e,["candidates"],h)}const i=g(s,["createTime"]);i!=null&&y(e,["createTime"],i);const a=g(s,["modelVersion"]);a!=null&&y(e,["modelVersion"],a);const l=g(s,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const c=g(s,["responseId"]);c!=null&&y(e,["responseId"],c);const d=g(s,["usageMetadata"]);return d!=null&&y(e,["usageMetadata"],d),e}function rj(s,e){const t={};if(g(s,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(s,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=g(s,["numberOfImages"]);e!==void 0&&n!=null&&y(e,["parameters","sampleCount"],n);const i=g(s,["aspectRatio"]);e!==void 0&&i!=null&&y(e,["parameters","aspectRatio"],i);const a=g(s,["guidanceScale"]);if(e!==void 0&&a!=null&&y(e,["parameters","guidanceScale"],a),g(s,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=g(s,["safetyFilterLevel"]);e!==void 0&&l!=null&&y(e,["parameters","safetySetting"],l);const c=g(s,["personGeneration"]);e!==void 0&&c!=null&&y(e,["parameters","personGeneration"],c);const d=g(s,["includeSafetyAttributes"]);e!==void 0&&d!=null&&y(e,["parameters","includeSafetyAttributes"],d);const h=g(s,["includeRaiReason"]);e!==void 0&&h!=null&&y(e,["parameters","includeRaiReason"],h);const p=g(s,["language"]);e!==void 0&&p!=null&&y(e,["parameters","language"],p);const v=g(s,["outputMimeType"]);e!==void 0&&v!=null&&y(e,["parameters","outputOptions","mimeType"],v);const x=g(s,["outputCompressionQuality"]);if(e!==void 0&&x!=null&&y(e,["parameters","outputOptions","compressionQuality"],x),g(s,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(g(s,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const S=g(s,["imageSize"]);if(e!==void 0&&S!=null&&y(e,["parameters","sampleImageSize"],S),g(s,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function aj(s,e){const t={},n=g(s,["outputGcsUri"]);e!==void 0&&n!=null&&y(e,["parameters","storageUri"],n);const i=g(s,["negativePrompt"]);e!==void 0&&i!=null&&y(e,["parameters","negativePrompt"],i);const a=g(s,["numberOfImages"]);e!==void 0&&a!=null&&y(e,["parameters","sampleCount"],a);const l=g(s,["aspectRatio"]);e!==void 0&&l!=null&&y(e,["parameters","aspectRatio"],l);const c=g(s,["guidanceScale"]);e!==void 0&&c!=null&&y(e,["parameters","guidanceScale"],c);const d=g(s,["seed"]);e!==void 0&&d!=null&&y(e,["parameters","seed"],d);const h=g(s,["safetyFilterLevel"]);e!==void 0&&h!=null&&y(e,["parameters","safetySetting"],h);const p=g(s,["personGeneration"]);e!==void 0&&p!=null&&y(e,["parameters","personGeneration"],p);const v=g(s,["includeSafetyAttributes"]);e!==void 0&&v!=null&&y(e,["parameters","includeSafetyAttributes"],v);const x=g(s,["includeRaiReason"]);e!==void 0&&x!=null&&y(e,["parameters","includeRaiReason"],x);const S=g(s,["language"]);e!==void 0&&S!=null&&y(e,["parameters","language"],S);const A=g(s,["outputMimeType"]);e!==void 0&&A!=null&&y(e,["parameters","outputOptions","mimeType"],A);const E=g(s,["outputCompressionQuality"]);e!==void 0&&E!=null&&y(e,["parameters","outputOptions","compressionQuality"],E);const N=g(s,["addWatermark"]);e!==void 0&&N!=null&&y(e,["parameters","addWatermark"],N);const R=g(s,["labels"]);e!==void 0&&R!=null&&y(e,["labels"],R);const D=g(s,["imageSize"]);e!==void 0&&D!=null&&y(e,["parameters","sampleImageSize"],D);const P=g(s,["enhancePrompt"]);return e!==void 0&&P!=null&&y(e,["parameters","enhancePrompt"],P),t}function oj(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["prompt"]);i!=null&&y(t,["instances[0]","prompt"],i);const a=g(e,["config"]);return a!=null&&rj(a,t),t}function lj(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["prompt"]);i!=null&&y(t,["instances[0]","prompt"],i);const a=g(e,["config"]);return a!=null&&aj(a,t),t}function cj(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>xj(l))),y(e,["generatedImages"],a)}const i=g(s,["positivePromptSafetyAttributes"]);return i!=null&&y(e,["positivePromptSafetyAttributes"],Ak(i)),e}function uj(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>fy(l))),y(e,["generatedImages"],a)}const i=g(s,["positivePromptSafetyAttributes"]);return i!=null&&y(e,["positivePromptSafetyAttributes"],Ek(i)),e}function dj(s,e){const t={},n=g(s,["numberOfVideos"]);if(e!==void 0&&n!=null&&y(e,["parameters","sampleCount"],n),g(s,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(s,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=g(s,["durationSeconds"]);if(e!==void 0&&i!=null&&y(e,["parameters","durationSeconds"],i),g(s,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=g(s,["aspectRatio"]);e!==void 0&&a!=null&&y(e,["parameters","aspectRatio"],a);const l=g(s,["resolution"]);e!==void 0&&l!=null&&y(e,["parameters","resolution"],l);const c=g(s,["personGeneration"]);if(e!==void 0&&c!=null&&y(e,["parameters","personGeneration"],c),g(s,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=g(s,["negativePrompt"]);e!==void 0&&d!=null&&y(e,["parameters","negativePrompt"],d);const h=g(s,["enhancePrompt"]);if(e!==void 0&&h!=null&&y(e,["parameters","enhancePrompt"],h),g(s,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const p=g(s,["lastFrame"]);e!==void 0&&p!=null&&y(e,["instances[0]","lastFrame"],py(p));const v=g(s,["referenceImages"]);if(e!==void 0&&v!=null){let x=v;Array.isArray(x)&&(x=x.map(S=>fH(S))),y(e,["instances[0]","referenceImages"],x)}if(g(s,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(g(s,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function hj(s,e){const t={},n=g(s,["numberOfVideos"]);e!==void 0&&n!=null&&y(e,["parameters","sampleCount"],n);const i=g(s,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const a=g(s,["fps"]);e!==void 0&&a!=null&&y(e,["parameters","fps"],a);const l=g(s,["durationSeconds"]);e!==void 0&&l!=null&&y(e,["parameters","durationSeconds"],l);const c=g(s,["seed"]);e!==void 0&&c!=null&&y(e,["parameters","seed"],c);const d=g(s,["aspectRatio"]);e!==void 0&&d!=null&&y(e,["parameters","aspectRatio"],d);const h=g(s,["resolution"]);e!==void 0&&h!=null&&y(e,["parameters","resolution"],h);const p=g(s,["personGeneration"]);e!==void 0&&p!=null&&y(e,["parameters","personGeneration"],p);const v=g(s,["pubsubTopic"]);e!==void 0&&v!=null&&y(e,["parameters","pubsubTopic"],v);const x=g(s,["negativePrompt"]);e!==void 0&&x!=null&&y(e,["parameters","negativePrompt"],x);const S=g(s,["enhancePrompt"]);e!==void 0&&S!=null&&y(e,["parameters","enhancePrompt"],S);const A=g(s,["generateAudio"]);e!==void 0&&A!=null&&y(e,["parameters","generateAudio"],A);const E=g(s,["lastFrame"]);e!==void 0&&E!=null&&y(e,["instances[0]","lastFrame"],Fi(E));const N=g(s,["referenceImages"]);if(e!==void 0&&N!=null){let P=N;Array.isArray(P)&&(P=P.map(L=>pH(L))),y(e,["instances[0]","referenceImages"],P)}const R=g(s,["mask"]);e!==void 0&&R!=null&&y(e,["instances[0]","mask"],hH(R));const D=g(s,["compressionQuality"]);return e!==void 0&&D!=null&&y(e,["parameters","compressionQuality"],D),t}function fj(s){const e={},t=g(s,["name"]);t!=null&&y(e,["name"],t);const n=g(s,["metadata"]);n!=null&&y(e,["metadata"],n);const i=g(s,["done"]);i!=null&&y(e,["done"],i);const a=g(s,["error"]);a!=null&&y(e,["error"],a);const l=g(s,["response","generateVideoResponse"]);return l!=null&&y(e,["response"],yj(l)),e}function pj(s){const e={},t=g(s,["name"]);t!=null&&y(e,["name"],t);const n=g(s,["metadata"]);n!=null&&y(e,["metadata"],n);const i=g(s,["done"]);i!=null&&y(e,["done"],i);const a=g(s,["error"]);a!=null&&y(e,["error"],a);const l=g(s,["response"]);return l!=null&&y(e,["response"],vj(l)),e}function mj(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["prompt"]);i!=null&&y(t,["instances[0]","prompt"],i);const a=g(e,["image"]);a!=null&&y(t,["instances[0]","image"],py(a));const l=g(e,["video"]);l!=null&&y(t,["instances[0]","video"],Ck(l));const c=g(e,["source"]);c!=null&&bj(c,t);const d=g(e,["config"]);return d!=null&&dj(d,t),t}function gj(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["prompt"]);i!=null&&y(t,["instances[0]","prompt"],i);const a=g(e,["image"]);a!=null&&y(t,["instances[0]","image"],Fi(a));const l=g(e,["video"]);l!=null&&y(t,["instances[0]","video"],Nk(l));const c=g(e,["source"]);c!=null&&_j(c,t);const d=g(e,["config"]);return d!=null&&hj(d,t),t}function yj(s){const e={},t=g(s,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>Sj(l))),y(e,["generatedVideos"],a)}const n=g(s,["raiMediaFilteredCount"]);n!=null&&y(e,["raiMediaFilteredCount"],n);const i=g(s,["raiMediaFilteredReasons"]);return i!=null&&y(e,["raiMediaFilteredReasons"],i),e}function vj(s){const e={},t=g(s,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>Aj(l))),y(e,["generatedVideos"],a)}const n=g(s,["raiMediaFilteredCount"]);n!=null&&y(e,["raiMediaFilteredCount"],n);const i=g(s,["raiMediaFilteredReasons"]);return i!=null&&y(e,["raiMediaFilteredReasons"],i),e}function bj(s,e){const t={},n=g(s,["prompt"]);e!==void 0&&n!=null&&y(e,["instances[0]","prompt"],n);const i=g(s,["image"]);e!==void 0&&i!=null&&y(e,["instances[0]","image"],py(i));const a=g(s,["video"]);return e!==void 0&&a!=null&&y(e,["instances[0]","video"],Ck(a)),t}function _j(s,e){const t={},n=g(s,["prompt"]);e!==void 0&&n!=null&&y(e,["instances[0]","prompt"],n);const i=g(s,["image"]);e!==void 0&&i!=null&&y(e,["instances[0]","image"],Fi(i));const a=g(s,["video"]);return e!==void 0&&a!=null&&y(e,["instances[0]","video"],Nk(a)),t}function xj(s){const e={},t=g(s,["_self"]);t!=null&&y(e,["image"],Ij(t));const n=g(s,["raiFilteredReason"]);n!=null&&y(e,["raiFilteredReason"],n);const i=g(s,["_self"]);return i!=null&&y(e,["safetyAttributes"],Ak(i)),e}function fy(s){const e={},t=g(s,["_self"]);t!=null&&y(e,["image"],Sk(t));const n=g(s,["raiFilteredReason"]);n!=null&&y(e,["raiFilteredReason"],n);const i=g(s,["_self"]);i!=null&&y(e,["safetyAttributes"],Ek(i));const a=g(s,["prompt"]);return a!=null&&y(e,["enhancedPrompt"],a),e}function wj(s){const e={},t=g(s,["_self"]);t!=null&&y(e,["mask"],Sk(t));const n=g(s,["labels"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>a)),y(e,["labels"],i)}return e}function Sj(s){const e={},t=g(s,["video"]);return t!=null&&y(e,["video"],uH(t)),e}function Aj(s){const e={},t=g(s,["_self"]);return t!=null&&y(e,["video"],dH(t)),e}function Ej(s){const e={},t=g(s,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const n=g(s,["responseJsonSchema"]);n!=null&&y(e,["responseJsonSchema"],n);const i=g(s,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const a=g(s,["candidateCount"]);a!=null&&y(e,["candidateCount"],a);const l=g(s,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const c=g(s,["frequencyPenalty"]);c!=null&&y(e,["frequencyPenalty"],c);const d=g(s,["logprobs"]);d!=null&&y(e,["logprobs"],d);const h=g(s,["maxOutputTokens"]);h!=null&&y(e,["maxOutputTokens"],h);const p=g(s,["mediaResolution"]);p!=null&&y(e,["mediaResolution"],p);const v=g(s,["presencePenalty"]);v!=null&&y(e,["presencePenalty"],v);const x=g(s,["responseLogprobs"]);x!=null&&y(e,["responseLogprobs"],x);const S=g(s,["responseMimeType"]);S!=null&&y(e,["responseMimeType"],S);const A=g(s,["responseModalities"]);A!=null&&y(e,["responseModalities"],A);const E=g(s,["responseSchema"]);E!=null&&y(e,["responseSchema"],E);const N=g(s,["routingConfig"]);N!=null&&y(e,["routingConfig"],N);const R=g(s,["seed"]);R!=null&&y(e,["seed"],R);const D=g(s,["speechConfig"]);D!=null&&y(e,["speechConfig"],D);const P=g(s,["stopSequences"]);P!=null&&y(e,["stopSequences"],P);const L=g(s,["temperature"]);L!=null&&y(e,["temperature"],L);const H=g(s,["thinkingConfig"]);H!=null&&y(e,["thinkingConfig"],H);const z=g(s,["topK"]);z!=null&&y(e,["topK"],z);const U=g(s,["topP"]);if(U!=null&&y(e,["topP"],U),g(s,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Tj(s,e){const t={},n=g(e,["model"]);return n!=null&&y(t,["_url","name"],it(s,n)),t}function Cj(s,e){const t={},n=g(e,["model"]);return n!=null&&y(t,["_url","name"],it(s,n)),t}function Nj(s){const e={};if(g(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(s,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function Rj(s){const e={};if(g(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(s,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function kj(s){const e={},t=g(s,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const n=g(s,["imageSize"]);if(n!=null&&y(e,["imageSize"],n),g(s,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(g(s,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(s,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function Mj(s){const e={},t=g(s,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const n=g(s,["imageSize"]);n!=null&&y(e,["imageSize"],n);const i=g(s,["personGeneration"]);i!=null&&y(e,["personGeneration"],i);const a=g(s,["outputMimeType"]);a!=null&&y(e,["imageOutputOptions","mimeType"],a);const l=g(s,["outputCompressionQuality"]);return l!=null&&y(e,["imageOutputOptions","compressionQuality"],l),e}function Ij(s){const e={},t=g(s,["bytesBase64Encoded"]);t!=null&&y(e,["imageBytes"],Ro(t));const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function Sk(s){const e={},t=g(s,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const n=g(s,["bytesBase64Encoded"]);n!=null&&y(e,["imageBytes"],Ro(n));const i=g(s,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function py(s){const e={};if(g(s,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=g(s,["imageBytes"]);t!=null&&y(e,["bytesBase64Encoded"],Ro(t));const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function Fi(s){const e={},t=g(s,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const n=g(s,["imageBytes"]);n!=null&&y(e,["bytesBase64Encoded"],Ro(n));const i=g(s,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Dj(s,e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&y(t,["_query","pageSize"],i);const a=g(e,["pageToken"]);t!==void 0&&a!=null&&y(t,["_query","pageToken"],a);const l=g(e,["filter"]);t!==void 0&&l!=null&&y(t,["_query","filter"],l);const c=g(e,["queryBase"]);return t!==void 0&&c!=null&&y(t,["_url","models_url"],gk(s,c)),n}function Pj(s,e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&y(t,["_query","pageSize"],i);const a=g(e,["pageToken"]);t!==void 0&&a!=null&&y(t,["_query","pageToken"],a);const l=g(e,["filter"]);t!==void 0&&l!=null&&y(t,["_query","filter"],l);const c=g(e,["queryBase"]);return t!==void 0&&c!=null&&y(t,["_url","models_url"],gk(s,c)),n}function Lj(s,e){const t={},n=g(e,["config"]);return n!=null&&Dj(s,n,t),t}function Oj(s,e){const t={},n=g(e,["config"]);return n!=null&&Pj(s,n,t),t}function Uj(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const i=g(s,["_self"]);if(i!=null){let a=yk(i);Array.isArray(a)&&(a=a.map(l=>Hx(l))),y(e,["models"],a)}return e}function Fj(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const i=g(s,["_self"]);if(i!=null){let a=yk(i);Array.isArray(a)&&(a=a.map(l=>Bx(l))),y(e,["models"],a)}return e}function zj(s){const e={},t=g(s,["maskMode"]);t!=null&&y(e,["maskMode"],t);const n=g(s,["segmentationClasses"]);n!=null&&y(e,["maskClasses"],n);const i=g(s,["maskDilation"]);return i!=null&&y(e,["dilation"],i),e}function Hx(s){const e={},t=g(s,["name"]);t!=null&&y(e,["name"],t);const n=g(s,["displayName"]);n!=null&&y(e,["displayName"],n);const i=g(s,["description"]);i!=null&&y(e,["description"],i);const a=g(s,["version"]);a!=null&&y(e,["version"],a);const l=g(s,["_self"]);l!=null&&y(e,["tunedModelInfo"],tH(l));const c=g(s,["inputTokenLimit"]);c!=null&&y(e,["inputTokenLimit"],c);const d=g(s,["outputTokenLimit"]);d!=null&&y(e,["outputTokenLimit"],d);const h=g(s,["supportedGenerationMethods"]);h!=null&&y(e,["supportedActions"],h);const p=g(s,["temperature"]);p!=null&&y(e,["temperature"],p);const v=g(s,["maxTemperature"]);v!=null&&y(e,["maxTemperature"],v);const x=g(s,["topP"]);x!=null&&y(e,["topP"],x);const S=g(s,["topK"]);S!=null&&y(e,["topK"],S);const A=g(s,["thinking"]);return A!=null&&y(e,["thinking"],A),e}function Bx(s){const e={},t=g(s,["name"]);t!=null&&y(e,["name"],t);const n=g(s,["displayName"]);n!=null&&y(e,["displayName"],n);const i=g(s,["description"]);i!=null&&y(e,["description"],i);const a=g(s,["versionId"]);a!=null&&y(e,["version"],a);const l=g(s,["deployedModels"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(x=>Qz(x))),y(e,["endpoints"],v)}const c=g(s,["labels"]);c!=null&&y(e,["labels"],c);const d=g(s,["_self"]);d!=null&&y(e,["tunedModelInfo"],nH(d));const h=g(s,["defaultCheckpointId"]);h!=null&&y(e,["defaultCheckpointId"],h);const p=g(s,["checkpoints"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(x=>x)),y(e,["checkpoints"],v)}return e}function jj(s){const e={},t=g(s,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const n=g(s,["codeExecutionResult"]);n!=null&&y(e,["codeExecutionResult"],n);const i=g(s,["executableCode"]);i!=null&&y(e,["executableCode"],i);const a=g(s,["fileData"]);a!=null&&y(e,["fileData"],Zz(a));const l=g(s,["functionCall"]);l!=null&&y(e,["functionCall"],ej(l));const c=g(s,["functionResponse"]);c!=null&&y(e,["functionResponse"],c);const d=g(s,["inlineData"]);d!=null&&y(e,["inlineData"],Ez(d));const h=g(s,["text"]);h!=null&&y(e,["text"],h);const p=g(s,["thought"]);p!=null&&y(e,["thought"],p);const v=g(s,["thoughtSignature"]);v!=null&&y(e,["thoughtSignature"],v);const x=g(s,["videoMetadata"]);return x!=null&&y(e,["videoMetadata"],x),e}function Hj(s){const e={},t=g(s,["productImage"]);return t!=null&&y(e,["image"],Fi(t)),e}function Bj(s,e){const t={},n=g(s,["numberOfImages"]);e!==void 0&&n!=null&&y(e,["parameters","sampleCount"],n);const i=g(s,["baseSteps"]);e!==void 0&&i!=null&&y(e,["parameters","baseSteps"],i);const a=g(s,["outputGcsUri"]);e!==void 0&&a!=null&&y(e,["parameters","storageUri"],a);const l=g(s,["seed"]);e!==void 0&&l!=null&&y(e,["parameters","seed"],l);const c=g(s,["safetyFilterLevel"]);e!==void 0&&c!=null&&y(e,["parameters","safetySetting"],c);const d=g(s,["personGeneration"]);e!==void 0&&d!=null&&y(e,["parameters","personGeneration"],d);const h=g(s,["addWatermark"]);e!==void 0&&h!=null&&y(e,["parameters","addWatermark"],h);const p=g(s,["outputMimeType"]);e!==void 0&&p!=null&&y(e,["parameters","outputOptions","mimeType"],p);const v=g(s,["outputCompressionQuality"]);e!==void 0&&v!=null&&y(e,["parameters","outputOptions","compressionQuality"],v);const x=g(s,["enhancePrompt"]);e!==void 0&&x!=null&&y(e,["parameters","enhancePrompt"],x);const S=g(s,["labels"]);return e!==void 0&&S!=null&&y(e,["labels"],S),t}function Gj(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["source"]);i!=null&&Vj(i,t);const a=g(e,["config"]);return a!=null&&Bj(a,t),t}function qj(s){const e={},t=g(s,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>fy(i))),y(e,["generatedImages"],n)}return e}function Vj(s,e){const t={},n=g(s,["prompt"]);e!==void 0&&n!=null&&y(e,["instances[0]","prompt"],n);const i=g(s,["personImage"]);e!==void 0&&i!=null&&y(e,["instances[0]","personImage","image"],Fi(i));const a=g(s,["productImages"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>Hj(c))),y(e,["instances[0]","productImages"],l)}return t}function $j(s){const e={},t=g(s,["referenceImage"]);t!=null&&y(e,["referenceImage"],Fi(t));const n=g(s,["referenceId"]);n!=null&&y(e,["referenceId"],n);const i=g(s,["referenceType"]);i!=null&&y(e,["referenceType"],i);const a=g(s,["maskImageConfig"]);a!=null&&y(e,["maskImageConfig"],zj(a));const l=g(s,["controlImageConfig"]);l!=null&&y(e,["controlImageConfig"],Iz(l));const c=g(s,["styleImageConfig"]);c!=null&&y(e,["styleImageConfig"],c);const d=g(s,["subjectImageConfig"]);return d!=null&&y(e,["subjectImageConfig"],d),e}function Ak(s){const e={},t=g(s,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const n=g(s,["safetyAttributes","scores"]);n!=null&&y(e,["scores"],n);const i=g(s,["contentType"]);return i!=null&&y(e,["contentType"],i),e}function Ek(s){const e={},t=g(s,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const n=g(s,["safetyAttributes","scores"]);n!=null&&y(e,["scores"],n);const i=g(s,["contentType"]);return i!=null&&y(e,["contentType"],i),e}function Yj(s){const e={},t=g(s,["category"]);if(t!=null&&y(e,["category"],t),g(s,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=g(s,["threshold"]);return n!=null&&y(e,["threshold"],n),e}function Kj(s){const e={},t=g(s,["image"]);return t!=null&&y(e,["image"],Fi(t)),e}function Jj(s,e){const t={},n=g(s,["mode"]);e!==void 0&&n!=null&&y(e,["parameters","mode"],n);const i=g(s,["maxPredictions"]);e!==void 0&&i!=null&&y(e,["parameters","maxPredictions"],i);const a=g(s,["confidenceThreshold"]);e!==void 0&&a!=null&&y(e,["parameters","confidenceThreshold"],a);const l=g(s,["maskDilation"]);e!==void 0&&l!=null&&y(e,["parameters","maskDilation"],l);const c=g(s,["binaryColorThreshold"]);e!==void 0&&c!=null&&y(e,["parameters","binaryColorThreshold"],c);const d=g(s,["labels"]);return e!==void 0&&d!=null&&y(e,["labels"],d),t}function Xj(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["source"]);i!=null&&Qj(i,t);const a=g(e,["config"]);return a!=null&&Jj(a,t),t}function Wj(s){const e={},t=g(s,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>wj(i))),y(e,["generatedMasks"],n)}return e}function Qj(s,e){const t={},n=g(s,["prompt"]);e!==void 0&&n!=null&&y(e,["instances[0]","prompt"],n);const i=g(s,["image"]);e!==void 0&&i!=null&&y(e,["instances[0]","image"],Fi(i));const a=g(s,["scribbleImage"]);return e!==void 0&&a!=null&&y(e,["instances[0]","scribble"],Kj(a)),t}function Zj(s){const e={},t=g(s,["retrievalConfig"]);t!=null&&y(e,["retrievalConfig"],t);const n=g(s,["functionCallingConfig"]);return n!=null&&y(e,["functionCallingConfig"],tj(n)),e}function eH(s){const e={};if(g(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=g(s,["computerUse"]);t!=null&&y(e,["computerUse"],t);const n=g(s,["fileSearch"]);n!=null&&y(e,["fileSearch"],n);const i=g(s,["codeExecution"]);if(i!=null&&y(e,["codeExecution"],i),g(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(s,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(v=>v)),y(e,["functionDeclarations"],p)}const l=g(s,["googleMaps"]);l!=null&&y(e,["googleMaps"],Nj(l));const c=g(s,["googleSearch"]);c!=null&&y(e,["googleSearch"],Rj(c));const d=g(s,["googleSearchRetrieval"]);d!=null&&y(e,["googleSearchRetrieval"],d);const h=g(s,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}function Tk(s){const e={},t=g(s,["retrieval"]);t!=null&&y(e,["retrieval"],t);const n=g(s,["computerUse"]);if(n!=null&&y(e,["computerUse"],n),g(s,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=g(s,["codeExecution"]);i!=null&&y(e,["codeExecution"],i);const a=g(s,["enterpriseWebSearch"]);a!=null&&y(e,["enterpriseWebSearch"],a);const l=g(s,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(x=>nj(x))),y(e,["functionDeclarations"],v)}const c=g(s,["googleMaps"]);c!=null&&y(e,["googleMaps"],c);const d=g(s,["googleSearch"]);d!=null&&y(e,["googleSearch"],d);const h=g(s,["googleSearchRetrieval"]);h!=null&&y(e,["googleSearchRetrieval"],h);const p=g(s,["urlContext"]);return p!=null&&y(e,["urlContext"],p),e}function tH(s){const e={},t=g(s,["baseModel"]);t!=null&&y(e,["baseModel"],t);const n=g(s,["createTime"]);n!=null&&y(e,["createTime"],n);const i=g(s,["updateTime"]);return i!=null&&y(e,["updateTime"],i),e}function nH(s){const e={},t=g(s,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&y(e,["baseModel"],t);const n=g(s,["createTime"]);n!=null&&y(e,["createTime"],n);const i=g(s,["updateTime"]);return i!=null&&y(e,["updateTime"],i),e}function sH(s,e){const t={},n=g(s,["displayName"]);e!==void 0&&n!=null&&y(e,["displayName"],n);const i=g(s,["description"]);e!==void 0&&i!=null&&y(e,["description"],i);const a=g(s,["defaultCheckpointId"]);return e!==void 0&&a!=null&&y(e,["defaultCheckpointId"],a),t}function iH(s,e){const t={},n=g(s,["displayName"]);e!==void 0&&n!=null&&y(e,["displayName"],n);const i=g(s,["description"]);e!==void 0&&i!=null&&y(e,["description"],i);const a=g(s,["defaultCheckpointId"]);return e!==void 0&&a!=null&&y(e,["defaultCheckpointId"],a),t}function rH(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","name"],it(s,n));const i=g(e,["config"]);return i!=null&&sH(i,t),t}function aH(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["config"]);return i!=null&&iH(i,t),t}function oH(s,e){const t={},n=g(s,["outputGcsUri"]);e!==void 0&&n!=null&&y(e,["parameters","storageUri"],n);const i=g(s,["safetyFilterLevel"]);e!==void 0&&i!=null&&y(e,["parameters","safetySetting"],i);const a=g(s,["personGeneration"]);e!==void 0&&a!=null&&y(e,["parameters","personGeneration"],a);const l=g(s,["includeRaiReason"]);e!==void 0&&l!=null&&y(e,["parameters","includeRaiReason"],l);const c=g(s,["outputMimeType"]);e!==void 0&&c!=null&&y(e,["parameters","outputOptions","mimeType"],c);const d=g(s,["outputCompressionQuality"]);e!==void 0&&d!=null&&y(e,["parameters","outputOptions","compressionQuality"],d);const h=g(s,["enhanceInputImage"]);e!==void 0&&h!=null&&y(e,["parameters","upscaleConfig","enhanceInputImage"],h);const p=g(s,["imagePreservationFactor"]);e!==void 0&&p!=null&&y(e,["parameters","upscaleConfig","imagePreservationFactor"],p);const v=g(s,["labels"]);e!==void 0&&v!=null&&y(e,["labels"],v);const x=g(s,["numberOfImages"]);e!==void 0&&x!=null&&y(e,["parameters","sampleCount"],x);const S=g(s,["mode"]);return e!==void 0&&S!=null&&y(e,["parameters","mode"],S),t}function lH(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["_url","model"],it(s,n));const i=g(e,["image"]);i!=null&&y(t,["instances[0]","image"],Fi(i));const a=g(e,["upscaleFactor"]);a!=null&&y(t,["parameters","upscaleConfig","upscaleFactor"],a);const l=g(e,["config"]);return l!=null&&oH(l,t),t}function cH(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>fy(a))),y(e,["generatedImages"],i)}return e}function uH(s){const e={},t=g(s,["uri"]);t!=null&&y(e,["uri"],t);const n=g(s,["encodedVideo"]);n!=null&&y(e,["videoBytes"],Ro(n));const i=g(s,["encoding"]);return i!=null&&y(e,["mimeType"],i),e}function dH(s){const e={},t=g(s,["gcsUri"]);t!=null&&y(e,["uri"],t);const n=g(s,["bytesBase64Encoded"]);n!=null&&y(e,["videoBytes"],Ro(n));const i=g(s,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function hH(s){const e={},t=g(s,["image"]);t!=null&&y(e,["_self"],Fi(t));const n=g(s,["maskMode"]);return n!=null&&y(e,["maskMode"],n),e}function fH(s){const e={},t=g(s,["image"]);t!=null&&y(e,["image"],py(t));const n=g(s,["referenceType"]);return n!=null&&y(e,["referenceType"],n),e}function pH(s){const e={},t=g(s,["image"]);t!=null&&y(e,["image"],Fi(t));const n=g(s,["referenceType"]);return n!=null&&y(e,["referenceType"],n),e}function Ck(s){const e={},t=g(s,["uri"]);t!=null&&y(e,["uri"],t);const n=g(s,["videoBytes"]);n!=null&&y(e,["encodedVideo"],Ro(n));const i=g(s,["mimeType"]);return i!=null&&y(e,["encoding"],i),e}function Nk(s){const e={},t=g(s,["uri"]);t!=null&&y(e,["gcsUri"],t);const n=g(s,["videoBytes"]);n!=null&&y(e,["bytesBase64Encoded"],Ro(n));const i=g(s,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mH(s,e){const t={},n=g(s,["displayName"]);return e!==void 0&&n!=null&&y(e,["displayName"],n),t}function gH(s){const e={},t=g(s,["config"]);return t!=null&&mH(t,e),e}function yH(s,e){const t={},n=g(s,["force"]);return e!==void 0&&n!=null&&y(e,["_query","force"],n),t}function vH(s){const e={},t=g(s,["name"]);t!=null&&y(e,["_url","name"],t);const n=g(s,["config"]);return n!=null&&yH(n,e),e}function bH(s){const e={},t=g(s,["name"]);return t!=null&&y(e,["_url","name"],t),e}function _H(s,e){const t={},n=g(s,["customMetadata"]);if(e!==void 0&&n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["customMetadata"],a)}const i=g(s,["chunkingConfig"]);return e!==void 0&&i!=null&&y(e,["chunkingConfig"],i),t}function xH(s){const e={},t=g(s,["name"]);t!=null&&y(e,["name"],t);const n=g(s,["metadata"]);n!=null&&y(e,["metadata"],n);const i=g(s,["done"]);i!=null&&y(e,["done"],i);const a=g(s,["error"]);a!=null&&y(e,["error"],a);const l=g(s,["response"]);return l!=null&&y(e,["response"],SH(l)),e}function wH(s){const e={},t=g(s,["fileSearchStoreName"]);t!=null&&y(e,["_url","file_search_store_name"],t);const n=g(s,["fileName"]);n!=null&&y(e,["fileName"],n);const i=g(s,["config"]);return i!=null&&_H(i,e),e}function SH(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["parent"]);n!=null&&y(e,["parent"],n);const i=g(s,["documentName"]);return i!=null&&y(e,["documentName"],i),e}function AH(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);return e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),t}function EH(s){const e={},t=g(s,["config"]);return t!=null&&AH(t,e),e}function TH(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const i=g(s,["fileSearchStores"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["fileSearchStores"],a)}return e}function Rk(s,e){const t={},n=g(s,["mimeType"]);e!==void 0&&n!=null&&y(e,["mimeType"],n);const i=g(s,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const a=g(s,["customMetadata"]);if(e!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>d)),y(e,["customMetadata"],c)}const l=g(s,["chunkingConfig"]);return e!==void 0&&l!=null&&y(e,["chunkingConfig"],l),t}function CH(s){const e={},t=g(s,["fileSearchStoreName"]);t!=null&&y(e,["_url","file_search_store_name"],t);const n=g(s,["config"]);return n!=null&&Rk(n,e),e}function NH(s){const e={},t=g(s,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const RH="Content-Type",kH="X-Server-Timeout",MH="User-Agent",Gx="x-goog-api-client",IH="1.35.0",DH=`google-genai-sdk/${IH}`,PH="v1beta1",LH="v1beta";class OH{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:PH,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:LH,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const i=[this.getRequestUrlInternal(t)];return n&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))i.searchParams.append(l,String(c));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,i.toString(),e.abortSignal),this.unaryApiCall(i,a,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[i,a]of Object.entries(t))typeof a=="object"?n[i]=Object.assign(Object.assign({},n[i]),a):a!==void 0&&(n[i]=a);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,i.toString(),e.abortSignal),this.streamApiCall(i,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,i){if(t&&t.timeout||i){const a=new AbortController,l=a.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const c=setTimeout(()=>a.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}i&&i.addEventListener("abort",()=>{a.abort()}),e.signal=l}return t&&t.extraBody!==null&&UH(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await aN(i),new Fx(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await aN(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return Pi(this,arguments,function*(){var n;const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),a=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let l="";const c="data:",d=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:h,value:p}=yield Ue(i.read());if(h){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const v=a.decode(p,{stream:!0});try{const A=JSON.parse(v);if("error"in A){const E=JSON.parse(JSON.stringify(A.error)),N=E.status,R=E.code,D=`got status: ${N}. ${JSON.stringify(A)}`;if(R>=400&&R<600)throw new dy({message:D,status:R})}}catch(A){if(A.name==="ApiError")throw A}l+=v;let x=-1,S=0;for(;;){x=-1,S=0;for(const N of d){const R=l.indexOf(N);R!==-1&&(x===-1||R<x)&&(x=R,S=N.length)}if(x===-1)break;const A=l.substring(0,x);l=l.substring(x+S);const E=A.trim();if(E.startsWith(c)){const N=E.substring(c.length).trim();try{const R=new Response(N,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Ue(new Fx(R))}catch(R){throw new Error(`exception parsing stream chunk ${N}. ${R}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=DH+" "+this.clientOptions.userAgentExtra;return e[MH]=t,e[Gx]=t,e[RH]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[i,a]of Object.entries(e.headers))n.append(i,a);e.timeout&&e.timeout>0&&n.append(kH,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return typeof e=="string"&&(n=e.replace(/[/\\]+$/,""),n=(t=n.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),n}async uploadFile(e,t){var n;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const a=this.clientOptions.uploader,l=await a.stat(e);i.sizeBytes=String(l.size);const c=(n=t==null?void 0:t.mimeType)!==null&&n!==void 0?n:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=c;const d={file:i},h=this.getFileName(e),p=pe("upload/v1beta/files",d._url),v=await this.fetchUploadUrl(p,i.sizeBytes,i.mimeType,h,d,t==null?void 0:t.httpOptions);return a.upload(e,v,this)}async uploadFileToFileSearchStore(e,t,n){var i;const a=this.clientOptions.uploader,l=await a.stat(t),c=String(l.size),d=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const h=`upload/v1beta/${e}:uploadToFileSearchStore`,p=this.getFileName(t),v={};n!=null&&Rk(n,v);const x=await this.fetchUploadUrl(h,c,d,p,v,n==null?void 0:n.httpOptions);return a.uploadToFileSearchStore(t,x,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,n,i,a,l){var c;let d={};l?d=l:d={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},i?{"X-Goog-Upload-File-Name":i}:{})};const h=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:d});if(!h||!(h!=null&&h.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const p=(c=h==null?void 0:h.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(p===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return p}}async function aN(s){var e;if(s===void 0)throw new Error("response is undefined");if(!s.ok){const t=s.status;let n;!((e=s.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?n=await s.json():n={error:{message:await s.text(),code:s.status,status:s.statusText}};const i=JSON.stringify(n);throw t>=400&&t<600?new dy({message:i,status:t}):new Error(i)}}function UH(s,e){if(!e||Object.keys(e).length===0)return;if(s.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof s.body=="string"&&s.body.length>0)try{const a=JSON.parse(s.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(a,l){const c=Object.assign({},a);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const h=l[d],p=c[d];h&&typeof h=="object"&&!Array.isArray(h)&&p&&typeof p=="object"&&!Array.isArray(p)?c[d]=n(p,h):(p&&h&&typeof p!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof p}, New type: ${typeof h}. Overwriting.`),c[d]=h)}return c}const i=n(t,e);s.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const FH="mcp_used/unknown";let zH=!1;function kk(s){for(const e of s)if(jH(e)||typeof e=="object"&&"inputSchema"in e)return!0;return zH}function Mk(s){var e;const t=(e=s[Gx])!==null&&e!==void 0?e:"";s[Gx]=(t+` ${FH}`).trimStart()}function jH(s){return s!==null&&typeof s=="object"&&s instanceof Ew}function HH(s){return Pi(this,arguments,function*(t,n=100){let i,a=0;for(;a<n;){const l=yield Ue(t.listTools({cursor:i}));for(const c of l.tools)yield yield Ue(c),a++;if(!l.nextCursor)break;i=l.nextCursor}})}class Ew{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Ew(e,t)}async initialize(){var e,t,n,i;if(this.mcpTools.length>0)return;const a={},l=[];for(const p of this.mcpClients)try{for(var c=!0,d=(t=void 0,Li(HH(p))),h;h=await d.next(),e=h.done,!e;c=!0){i=h.value,c=!1;const v=i;l.push(v);const x=v.name;if(a[x])throw new Error(`Duplicate function name ${x} found in MCP tools. Please ensure function names are unique.`);a[x]=p}}catch(v){t={error:v}}finally{try{!c&&!e&&(n=d.return)&&await n.call(d)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),bF(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[n.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const l=await i.callTool({name:n.name,arguments:n.args},void 0,a);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function BH(s,e,t){const n=new dF;let i;t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),Object.assign(n,i),e(n)}class GH{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=$H(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),d=`${i}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${c}`;let h=()=>{};const p=new Promise(P=>{h=P}),v=e.callbacks,x=function(){h({})},S=this.apiClient,A={onopen:x,onmessage:P=>{BH(S,v.onmessage,P)},onerror:(t=v==null?void 0:v.onerror)!==null&&t!==void 0?t:function(P){},onclose:(n=v==null?void 0:v.onclose)!==null&&n!==void 0?n:function(P){}},E=this.webSocketFactory.create(d,VH(l),A);E.connect(),await p;const D={setup:{model:it(this.apiClient,e.model)}};return E.send(JSON.stringify(D)),new qH(E,this.apiClient)}}class qH{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=gz(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=mz(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Eu.PLAY)}pause(){this.sendPlaybackControl(Eu.PAUSE)}stop(){this.sendPlaybackControl(Eu.STOP)}resetContext(){this.sendPlaybackControl(Eu.RESET_CONTEXT)}close(){this.conn.close()}}function VH(s){const e={};return s.forEach((t,n)=>{e[n]=t}),e}function $H(s){const e=new Headers;for(const[t,n]of Object.entries(s))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const YH="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function KH(s,e,t){const n=new uF;let i;t.data instanceof Blob?i=await t.data.text():t.data instanceof ArrayBuffer?i=new TextDecoder().decode(t.data):i=t.data;const a=JSON.parse(i);if(s.isVertexAI()){const l=bz(a);Object.assign(n,l)}else Object.assign(n,a);e(n)}class JH{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new GH(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,i,a,l,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let p;const v=this.apiClient.getHeaders();e.config&&e.config.tools&&kk(e.config.tools)&&Mk(v);const x=ZH(v);if(this.apiClient.isVertexAI())p=`${d}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x,p);else{const K=this.apiClient.getApiKey();let ie="BidiGenerateContent",oe="key";K!=null&&K.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),ie="BidiGenerateContentConstrained",oe="access_token"),p=`${d}/ws/google.ai.generativelanguage.${h}.GenerativeService.${ie}?${oe}=${K}`}let S=()=>{};const A=new Promise(K=>{S=K}),E=e.callbacks,N=function(){var K;(K=E==null?void 0:E.onopen)===null||K===void 0||K.call(E),S({})},R=this.apiClient,D={onopen:N,onmessage:K=>{KH(R,E.onmessage,K)},onerror:(t=E==null?void 0:E.onerror)!==null&&t!==void 0?t:function(K){},onclose:(n=E==null?void 0:E.onclose)!==null&&n!==void 0?n:function(K){}},P=this.webSocketFactory.create(p,QH(x),D);P.connect(),await A;let L=it(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&L.startsWith("publishers/")){const K=this.apiClient.getProject(),ie=this.apiClient.getLocation();L=`projects/${K}/locations/${ie}/`+L}let H={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[T0.AUDIO]}:e.config.responseModalities=[T0.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const z=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],U=[];for(const K of z)if(this.isCallableTool(K)){const ie=K;U.push(await ie.tool())}else U.push(K);U.length>0&&(e.config.tools=U);const J={model:L,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?H=pz(this.apiClient,J):H=fz(this.apiClient,J),delete H.config,P.send(JSON.stringify(H)),new WH(P,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const XH={turnComplete:!0};class WH{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=ui(t.turns),e.isVertexAI()||(n=n.map(i=>hy(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const a of n){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(YH)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},XH),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:vz(e)}:t={realtimeInput:yz(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function QH(s){const e={};return s.forEach((t,n)=>{e[n]=t}),e}function ZH(s){const e=new Headers;for(const[t,n]of Object.entries(s))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oN=10;function lN(s){var e,t,n;if(!((e=s==null?void 0:s.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const l of(t=s==null?void 0:s.tools)!==null&&t!==void 0?t:[])if(Du(l)){i=!0;break}if(!i)return!0;const a=(n=s==null?void 0:s.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function Du(s){return"callTool"in s&&typeof s.callTool=="function"}function eB(s){var e,t,n;return(n=(t=(e=s.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>Du(i)))!==null&&n!==void 0?n:!1}function cN(s){var e;const t=[];return!((e=s==null?void 0:s.config)===null||e===void 0)&&e.tools&&s.config.tools.forEach((n,i)=>{if(Du(n))return;const a=n;a.functionDeclarations&&a.functionDeclarations.length>0&&t.push(i)}),t}function uN(s){var e;return!(!((e=s==null?void 0:s.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tB extends ma{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,i,a,l,c;const d=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!eB(t)||lN(t.config))return await this.generateContentInternal(d);const h=cN(t);if(h.length>0){const E=h.map(N=>`tools[${N}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${E}.`)}let p,v;const x=ui(d.contents),S=(a=(i=(n=d.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&a!==void 0?a:oN;let A=0;for(;A<S&&(p=await this.generateContentInternal(d),!(!p.functionCalls||p.functionCalls.length===0));){const E=p.candidates[0].content,N=[];for(const R of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(Du(R)){const P=await R.callTool(p.functionCalls);N.push(...P)}A++,v={role:"user",parts:N},d.contents=ui(d.contents),d.contents.push(E),d.contents.push(v),uN(d.config)&&(x.push(E),x.push(v))}return uN(d.config)&&(p.automaticFunctionCallingHistory=x),p},this.generateContentStream=async t=>{var n,i,a,l,c;if(this.maybeMoveToResponseJsonSchem(t),lN(t.config)){const v=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(v)}const d=cN(t);if(d.length>0){const v=d.map(x=>`tools[${x}]`).join(", ");throw new Error(`Incompatible tools found at ${v}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const h=(a=(i=(n=t==null?void 0:t.config)===null||n===void 0?void 0:n.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,p=(c=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(h&&!p)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var i;let a;const l=[];if(n!=null&&n.generatedImages)for(const d of n.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((i=d==null?void 0:d.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?a=d==null?void 0:d.safetyAttributes:l.push(d);let c;return a?c={generatedImages:l,positivePromptSafetyAttributes:a,sdkHttpResponse:n.sdkHttpResponse}:c={generatedImages:l,sdkHttpResponse:n.sdkHttpResponse},c}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new gc(da.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(i)},this.generateVideos=async t=>{var n,i,a,l,c,d;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=t.video)===null||n===void 0)&&n.uri&&(!((i=t.video)===null||i===void 0)&&i.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(a=t.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.uri&&(!((d=(c=t.source)===null||c===void 0?void 0:c.video)===null||d===void 0)&&d.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,i;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const l=await Promise.all(a.map(async d=>Du(d)?await d.tool():d)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&kk(e.config.tools)){const d=(i=(n=e.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&i!==void 0?i:{};let h=Object.assign({},d);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),Mk(h),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:h})}return c}async initAfcToolsMap(e){var t,n,i;const a=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(Du(l)){const c=l,d=await c.tool();for(const h of(i=d.functionDeclarations)!==null&&i!==void 0?i:[]){if(!h.name)throw new Error("Function declaration name is required.");if(a.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);a.set(h.name,c)}}return a}async processAfcStream(e){var t,n,i;const a=(i=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&i!==void 0?i:oN;let l=!1,c=0;const d=await this.initAfcToolsMap(e);return(function(h,p,v){return Pi(this,arguments,function*(){for(var x,S,A,E,N,R;c<a;){l&&(c++,l=!1);const H=yield Ue(h.processParamsMaybeAddMcpUsage(v)),z=yield Ue(h.generateContentStreamInternal(H)),U=[],J=[];try{for(var D=!0,P=(S=void 0,Li(z)),L;L=yield Ue(P.next()),x=L.done,!x;D=!0){E=L.value,D=!1;const K=E;if(yield yield Ue(K),K.candidates&&(!((N=K.candidates[0])===null||N===void 0)&&N.content)){J.push(K.candidates[0].content);for(const ie of(R=K.candidates[0].content.parts)!==null&&R!==void 0?R:[])if(c<a&&ie.functionCall){if(!ie.functionCall.name)throw new Error("Function call name was not returned by the model.");if(p.has(ie.functionCall.name)){const oe=yield Ue(p.get(ie.functionCall.name).callTool([ie.functionCall]));U.push(...oe)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${p.keys()}, mising tool: ${ie.functionCall.name}`)}}}}catch(K){S={error:K}}finally{try{!D&&!x&&(A=P.return)&&(yield Ue(A.call(P)))}finally{if(S)throw S.error}}if(U.length>0){l=!0;const K=new Vh;K.candidates=[{content:{role:"user",parts:U}}],yield yield Ue(K);const ie=[];ie.push(...J),ie.push({role:"user",parts:U});const oe=ui(v.contents).concat(ie);v.contents=oe}else break}})})(this,d,e)}async generateContentInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=sN(this.apiClient,e);return c=pe("{model}:generateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=rN(p),x=new Vh;return Object.assign(x,v),x})}else{const h=nN(this.apiClient,e);return c=pe("{model}:generateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=iN(p),x=new Vh;return Object.assign(x,v),x})}}async generateContentStreamInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=sN(this.apiClient,e);return c=pe("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(v){return Pi(this,arguments,function*(){var x,S,A,E;try{for(var N=!0,R=Li(v),D;D=yield Ue(R.next()),x=D.done,!x;N=!0){E=D.value,N=!1;const P=E,L=rN(yield Ue(P.json()));L.sdkHttpResponse={headers:P.headers};const H=new Vh;Object.assign(H,L),yield yield Ue(H)}}catch(P){S={error:P}}finally{try{!N&&!x&&(A=R.return)&&(yield Ue(A.call(R)))}finally{if(S)throw S.error}}})})}else{const h=nN(this.apiClient,e);return c=pe("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(v){return Pi(this,arguments,function*(){var x,S,A,E;try{for(var N=!0,R=Li(v),D;D=yield Ue(R.next()),x=D.done,!x;N=!0){E=D.value,N=!1;const P=E,L=iN(yield Ue(P.json()));L.sdkHttpResponse={headers:P.headers};const H=new Vh;Object.assign(H,L),yield yield Ue(H)}}catch(P){S={error:P}}finally{try{!N&&!x&&(A=R.return)&&(yield Ue(A.call(R)))}finally{if(S)throw S.error}}})})}}async embedContent(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=Jz(this.apiClient,e);return c=pe("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=Wz(p),x=new zC;return Object.assign(x,v),x})}else{const h=Kz(this.apiClient,e);return c=pe("{model}:batchEmbedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=Xz(p),x=new zC;return Object.assign(x,v),x})}}async generateImagesInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=lj(this.apiClient,e);return c=pe("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=uj(p),x=new jC;return Object.assign(x,v),x})}else{const h=oj(this.apiClient,e);return c=pe("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=cj(p),x=new jC;return Object.assign(x,v),x})}}async editImageInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=qz(this.apiClient,e);return a=pe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const h=Vz(d),p=new Z3;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=lH(this.apiClient,e);return a=pe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const h=cH(d),p=new eF;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=Gj(this.apiClient,e);return a=pe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=qj(d),p=new tF;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=Xj(this.apiClient,e);return a=pe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=Wj(d),p=new nF;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=Cj(this.apiClient,e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>Bx(p))}else{const h=Tj(this.apiClient,e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>Hx(p))}}async listInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=Oj(this.apiClient,e);return c=pe("{models_url}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=Fj(p),x=new HC;return Object.assign(x,v),x})}else{const h=Lj(this.apiClient,e);return c=pe("{models_url}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=Uj(p),x=new HC;return Object.assign(x,v),x})}}async update(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=aH(this.apiClient,e);return c=pe("{model}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>Bx(p))}else{const h=rH(this.apiClient,e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>Hx(p))}}async delete(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=jz(this.apiClient,e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=Bz(p),x=new BC;return Object.assign(x,v),x})}else{const h=zz(this.apiClient,e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=Hz(p),x=new BC;return Object.assign(x,v),x})}}async countTokens(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=Oz(this.apiClient,e);return c=pe("{model}:countTokens",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=Fz(p),x=new GC;return Object.assign(x,v),x})}else{const h=Lz(this.apiClient,e);return c=pe("{model}:countTokens",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=Uz(p),x=new GC;return Object.assign(x,v),x})}}async computeTokens(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=Nz(this.apiClient,e);return a=pe("{model}:computeTokens",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const h=Rz(d),p=new sF;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=gj(this.apiClient,e);return c=pe("{model}:predictLongRunning",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>{const v=pj(p),x=new C0;return Object.assign(x,v),x})}else{const h=mj(this.apiClient,e);return c=pe("{model}:predictLongRunning",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>{const v=fj(p),x=new C0;return Object.assign(x,v),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nB extends ma{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let a;n&&"httpOptions"in n&&(a=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let a;n&&"httpOptions"in n&&(a=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=Y3(e);return c=pe("{operationName}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l}else{const h=$3(e);return c=pe("{operationName}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l}}async fetchPredictVideosOperationInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=z3(e);return a=pe("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sB(s){const e={},t=g(s,["data"]);if(t!=null&&y(e,["data"],t),g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function iB(s){const e={},t=g(s,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>fB(a))),y(e,["parts"],i)}const n=g(s,["role"]);return n!=null&&y(e,["role"],n),e}function rB(s,e,t){const n={},i=g(e,["expireTime"]);t!==void 0&&i!=null&&y(t,["expireTime"],i);const a=g(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&y(t,["newSessionExpireTime"],a);const l=g(e,["uses"]);t!==void 0&&l!=null&&y(t,["uses"],l);const c=g(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&y(t,["bidiGenerateContentSetup"],hB(s,c));const d=g(e,["lockAdditionalFields"]);return t!==void 0&&d!=null&&y(t,["fieldMask"],d),n}function aB(s,e){const t={},n=g(e,["config"]);return n!=null&&y(t,["config"],rB(s,n,t)),t}function oB(s){const e={};if(g(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(s,["fileUri"]);t!=null&&y(e,["fileUri"],t);const n=g(s,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function lB(s){const e={},t=g(s,["id"]);t!=null&&y(e,["id"],t);const n=g(s,["args"]);n!=null&&y(e,["args"],n);const i=g(s,["name"]);if(i!=null&&y(e,["name"],i),g(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function cB(s){const e={};if(g(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(s,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function uB(s){const e={};if(g(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(s,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function dB(s,e){const t={},n=g(s,["generationConfig"]);e!==void 0&&n!=null&&y(e,["setup","generationConfig"],n);const i=g(s,["responseModalities"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig","responseModalities"],i);const a=g(s,["temperature"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","temperature"],a);const l=g(s,["topP"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","topP"],l);const c=g(s,["topK"]);e!==void 0&&c!=null&&y(e,["setup","generationConfig","topK"],c);const d=g(s,["maxOutputTokens"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","maxOutputTokens"],d);const h=g(s,["mediaResolution"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","mediaResolution"],h);const p=g(s,["seed"]);e!==void 0&&p!=null&&y(e,["setup","generationConfig","seed"],p);const v=g(s,["speechConfig"]);e!==void 0&&v!=null&&y(e,["setup","generationConfig","speechConfig"],Aw(v));const x=g(s,["thinkingConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","thinkingConfig"],x);const S=g(s,["enableAffectiveDialog"]);e!==void 0&&S!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],S);const A=g(s,["systemInstruction"]);e!==void 0&&A!=null&&y(e,["setup","systemInstruction"],iB(zn(A)));const E=g(s,["tools"]);if(e!==void 0&&E!=null){let z=Gd(E);Array.isArray(z)&&(z=z.map(U=>mB(Bd(U)))),y(e,["setup","tools"],z)}const N=g(s,["sessionResumption"]);e!==void 0&&N!=null&&y(e,["setup","sessionResumption"],pB(N));const R=g(s,["inputAudioTranscription"]);e!==void 0&&R!=null&&y(e,["setup","inputAudioTranscription"],R);const D=g(s,["outputAudioTranscription"]);e!==void 0&&D!=null&&y(e,["setup","outputAudioTranscription"],D);const P=g(s,["realtimeInputConfig"]);e!==void 0&&P!=null&&y(e,["setup","realtimeInputConfig"],P);const L=g(s,["contextWindowCompression"]);e!==void 0&&L!=null&&y(e,["setup","contextWindowCompression"],L);const H=g(s,["proactivity"]);if(e!==void 0&&H!=null&&y(e,["setup","proactivity"],H),g(s,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function hB(s,e){const t={},n=g(e,["model"]);n!=null&&y(t,["setup","model"],it(s,n));const i=g(e,["config"]);return i!=null&&y(t,["config"],dB(i,t)),t}function fB(s){const e={},t=g(s,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const n=g(s,["codeExecutionResult"]);n!=null&&y(e,["codeExecutionResult"],n);const i=g(s,["executableCode"]);i!=null&&y(e,["executableCode"],i);const a=g(s,["fileData"]);a!=null&&y(e,["fileData"],oB(a));const l=g(s,["functionCall"]);l!=null&&y(e,["functionCall"],lB(l));const c=g(s,["functionResponse"]);c!=null&&y(e,["functionResponse"],c);const d=g(s,["inlineData"]);d!=null&&y(e,["inlineData"],sB(d));const h=g(s,["text"]);h!=null&&y(e,["text"],h);const p=g(s,["thought"]);p!=null&&y(e,["thought"],p);const v=g(s,["thoughtSignature"]);v!=null&&y(e,["thoughtSignature"],v);const x=g(s,["videoMetadata"]);return x!=null&&y(e,["videoMetadata"],x),e}function pB(s){const e={},t=g(s,["handle"]);if(t!=null&&y(e,["handle"],t),g(s,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function mB(s){const e={};if(g(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=g(s,["computerUse"]);t!=null&&y(e,["computerUse"],t);const n=g(s,["fileSearch"]);n!=null&&y(e,["fileSearch"],n);const i=g(s,["codeExecution"]);if(i!=null&&y(e,["codeExecution"],i),g(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=g(s,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(v=>v)),y(e,["functionDeclarations"],p)}const l=g(s,["googleMaps"]);l!=null&&y(e,["googleMaps"],cB(l));const c=g(s,["googleSearch"]);c!=null&&y(e,["googleSearch"],uB(c));const d=g(s,["googleSearchRetrieval"]);d!=null&&y(e,["googleSearchRetrieval"],d);const h=g(s,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gB(s){const e=[];for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)){const n=s[t];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const i=Object.keys(n).map(a=>`${t}.${a}`);e.push(...i)}else e.push(t)}return e.join(",")}function yB(s,e){let t=null;const n=s.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const a=n.setup;typeof a=="object"&&a!==null?(s.bidiGenerateContentSetup=a,t=a):delete s.bidiGenerateContentSetup}else n!==void 0&&delete s.bidiGenerateContentSetup;const i=s.fieldMask;if(t){const a=gB(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?s.fieldMask=a:delete s.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];i.length>0&&(c=i.map(h=>l.includes(h)?`generationConfig.${h}`:h));const d=[];a&&d.push(a),c.length>0&&d.push(...c),d.length>0?s.fieldMask=d.join(","):delete s.fieldMask}else delete s.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?s.fieldMask=i.join(","):delete s.fieldMask;return s}class vB extends ma{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=aB(this.apiClient,e);a=pe("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const d=yB(c,e.config);return i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>h)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bB(s,e){const t={},n=g(s,["force"]);return e!==void 0&&n!=null&&y(e,["_query","force"],n),t}function _B(s){const e={},t=g(s,["name"]);t!=null&&y(e,["_url","name"],t);const n=g(s,["config"]);return n!=null&&bB(n,e),e}function xB(s){const e={},t=g(s,["name"]);return t!=null&&y(e,["_url","name"],t),e}function wB(s,e){const t={},n=g(s,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const i=g(s,["pageToken"]);return e!==void 0&&i!=null&&y(e,["_query","pageToken"],i),t}function SB(s){const e={},t=g(s,["parent"]);t!=null&&y(e,["_url","parent"],t);const n=g(s,["config"]);return n!=null&&wB(n,e),e}function AB(s){const e={},t=g(s,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=g(s,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const i=g(s,["documents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class EB extends ma{constructor(e){super(),this.apiClient=e,this.list=async t=>new gc(da.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:t.parent,config:n.config}),await this.listInternal(t),t)}async get(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=xB(e);return a=pe("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var t,n;let i="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=_B(e);i=pe("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=SB(e);return a=pe("{parent}/documents",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=AB(d),p=new iF;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class TB extends ma{constructor(e,t=new EB(e)){super(),this.apiClient=e,this.documents=t,this.list=async(n={})=>new gc(da.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(n),n)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=gH(e);return a=pe("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async get(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=bH(e);return a=pe("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}}async delete(e){var t,n;let i="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=vH(e);i=pe("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=EH(e);return a=pe("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=TH(d),p=new rF;return Object.assign(p,h),p})}}async uploadToFileSearchStoreInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=CH(e);return a=pe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=NH(d),p=new aF;return Object.assign(p,h),p})}}async importFile(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=wH(e);return a=pe("{file_search_store_name}:importFile",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const h=xH(d),p=new bw;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Ik=function(){const{crypto:s}=globalThis;if(s!=null&&s.randomUUID)return Ik=s.randomUUID.bind(s),s.randomUUID();const e=new Uint8Array(1),t=s?()=>s.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))};const CB=()=>Ik();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qx(s){return typeof s=="object"&&s!==null&&("name"in s&&s.name==="AbortError"||"message"in s&&String(s.message).includes("FetchRequestCanceledException"))}const Vx=s=>{if(s instanceof Error)return s;if(typeof s=="object"&&s!==null){try{if(Object.prototype.toString.call(s)==="[object Error]"){const e=new Error(s.message,s.cause?{cause:s.cause}:{});return s.stack&&(e.stack=s.stack),s.cause&&!e.cause&&(e.cause=s.cause),s.name&&(e.name=s.name),e}}catch{}try{return new Error(JSON.stringify(s))}catch{}}return new Error(s)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hi extends Error{}class Wn extends hi{constructor(e,t,n,i){super(`${Wn.makeMessage(e,t,n)}`),this.status=e,this.headers=i,this.error=t}static makeMessage(e,t,n){const i=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,n,i){if(!e||!i)return new my({message:n,cause:Vx(t)});const a=t;return e===400?new Pk(e,a,n,i):e===401?new Lk(e,a,n,i):e===403?new Ok(e,a,n,i):e===404?new Uk(e,a,n,i):e===409?new Fk(e,a,n,i):e===422?new zk(e,a,n,i):e===429?new jk(e,a,n,i):e>=500?new Hk(e,a,n,i):new Wn(e,a,n,i)}}class $x extends Wn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class my extends Wn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Dk extends my{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Pk extends Wn{}class Lk extends Wn{}class Ok extends Wn{}class Uk extends Wn{}class Fk extends Wn{}class zk extends Wn{}class jk extends Wn{}class Hk extends Wn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const NB=/^[a-z][a-z0-9+.-]*:/i,RB=s=>NB.test(s);let Yx=s=>(Yx=Array.isArray,Yx(s));const kB=Yx;let MB=kB;const dN=MB;function IB(s){if(!s)return!0;for(const e in s)return!1;return!0}function DB(s,e){return Object.prototype.hasOwnProperty.call(s,e)}const PB=(s,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new hi(`${s} must be an integer`);if(e<0)throw new hi(`${s} must be a positive integer`);return e},LB=s=>{try{return JSON.parse(s)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const OB=s=>new Promise(e=>setTimeout(e,s));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Su="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function UB(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const FB=()=>{var s,e,t,n,i;const a=UB();if(a==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Su,"X-Stainless-OS":fN(Deno.build.os),"X-Stainless-Arch":hN(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(s=Deno.version)===null||s===void 0?void 0:s.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Su,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(a==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Su,"X-Stainless-OS":fN((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":hN((n=globalThis.process.arch)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const l=zB();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Su,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Su,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function zB(){if(typeof navigator>"u"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of s){const n=t.exec(navigator.userAgent);if(n){const i=n[1]||0,a=n[2]||0,l=n[3]||0;return{browser:e,version:`${i}.${a}.${l}`}}}return null}const hN=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",fN=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let Ng;const jB=()=>Ng??(Ng=FB());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HB(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Bk(...s){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...s)}function BB(s){let e=Symbol.asyncIterator in s?s[Symbol.asyncIterator]():s[Symbol.iterator]();return Bk({start(){},async pull(t){const{done:n,value:i}=await e.next();n?t.close():t.enqueue(i)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function Gk(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function GB(s){var e,t;if(s===null||typeof s!="object")return;if(s[Symbol.asyncIterator]){await((t=(e=s[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const n=s.getReader(),i=n.cancel();n.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qB=({headers:s,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qk=()=>{var s;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((s=e==null?void 0:e.versions)===null||s===void 0?void 0:s.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function s_(s,e,t){return qk(),new File(s,e??"unknown_file",t)}function VB(s){return(typeof s=="object"&&s!==null&&("name"in s&&s.name&&String(s.name)||"url"in s&&s.url&&String(s.url)||"filename"in s&&s.filename&&String(s.filename)||"path"in s&&s.path&&String(s.path))||"").split(/[\\/]/).pop()||void 0}const $B=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vk=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",YB=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&Vk(s),KB=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function";async function JB(s,e,t){if(qk(),s=await s,YB(s))return s instanceof File?s:s_([await s.arrayBuffer()],s.name);if(KB(s)){const i=await s.blob();return e||(e=new URL(s.url).pathname.split(/[\\/]/).pop()),s_(await Kx(i),e,t)}const n=await Kx(s);if(e||(e=VB(s)),!(t!=null&&t.type)){const i=n.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof i=="string"&&(t=Object.assign(Object.assign({},t),{type:i}))}return s_(n,e,t)}async function Kx(s){var e,t,n,i,a;let l=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)l.push(s);else if(Vk(s))l.push(s instanceof Blob?s:await s.arrayBuffer());else if($B(s))try{for(var c=!0,d=Li(s),h;h=await d.next(),e=h.done,!e;c=!0){i=h.value,c=!1;const p=i;l.push(...await Kx(p))}}catch(p){t={error:p}}finally{try{!c&&!e&&(n=d.return)&&await n.call(d)}finally{if(t)throw t.error}}else{const p=(a=s==null?void 0:s.constructor)===null||a===void 0?void 0:a.name;throw new Error(`Unexpected data type: ${typeof s}${p?`; constructor: ${p}`:""}${XB(s)}`)}return l}function XB(s){return typeof s!="object"||s===null?"":`; props: [${Object.getOwnPropertyNames(s).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $k{constructor(e){this._client=e}}$k._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Yk(s){return s.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const pN=Object.freeze(Object.create(null)),WB=(s=Yk)=>(function(t,...n){if(t.length===1)return t[0];let i=!1;const a=[],l=t.reduce((p,v,x)=>{var S,A,E;/[?#]/.test(v)&&(i=!0);const N=n[x];let R=(i?encodeURIComponent:s)(""+N);return x!==n.length&&(N==null||typeof N=="object"&&N.toString===((E=Object.getPrototypeOf((A=Object.getPrototypeOf((S=N.hasOwnProperty)!==null&&S!==void 0?S:pN))!==null&&A!==void 0?A:pN))===null||E===void 0?void 0:E.toString))&&(R=N+"",a.push({start:p.length+v.length,length:R.length,error:`Value of type ${Object.prototype.toString.call(N).slice(8,-1)} is not a valid path parameter`})),p+v+(x===n.length?"":R)},""),c=l.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=d.exec(c))!==null;)a.push({start:h.index,length:h[0].length,error:`Value "${h[0]}" can't be safely passed as a path parameter`});if(a.sort((p,v)=>p.start-v.start),a.length>0){let p=0;const v=a.reduce((x,S)=>{const A=" ".repeat(S.start-p),E="^".repeat(S.length);return p=S.start+S.length,x+A+E},"");throw new hi(`Path parameters result in path with invalid segments:
${a.map(x=>x.error).join(`
`)}
${l}
${v}`)}return l}),Rg=WB(Yk);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kk extends $k{create(e,t){var n;const{api_version:i=this._client.apiVersion}=e,a=R0(e,["api_version"]);if("model"in a&&"agent_config"in a)throw new hi("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in a&&"generation_config"in a)throw new hi("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Rg`/${i}/interactions`,Object.assign(Object.assign({body:a},t),{stream:(n=e.stream)!==null&&n!==void 0?n:!1}))}delete(e,t={},n){const{api_version:i=this._client.apiVersion}=t??{};return this._client.delete(Rg`/${i}/interactions/${e}`,n)}cancel(e,t={},n){const{api_version:i=this._client.apiVersion}=t??{};return this._client.post(Rg`/${i}/interactions/${e}/cancel`,n)}get(e,t={},n){var i;const a=t??{},{api_version:l=this._client.apiVersion}=a,c=R0(a,["api_version"]);return this._client.get(Rg`/${l}/interactions/${e}`,Object.assign(Object.assign({query:c},n),{stream:(i=t==null?void 0:t.stream)!==null&&i!==void 0?i:!1}))}}Kk._key=Object.freeze(["interactions"]);class Jk extends Kk{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QB(s){let e=0;for(const i of s)e+=i.length;const t=new Uint8Array(e);let n=0;for(const i of s)t.set(i,n),n+=i.length;return t}let kg;function Tw(s){let e;return(kg??(e=new globalThis.TextEncoder,kg=e.encode.bind(e)))(s)}let Mg;function mN(s){let e;return(Mg??(e=new globalThis.TextDecoder,Mg=e.decode.bind(e)))(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gy{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Tw(e):e;this.buffer=QB([this.buffer,t]);const n=[];let i;for(;(i=ZB(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){n.push(mN(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const a=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,l=mN(this.buffer.subarray(0,a));n.push(l),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode(`
`):[]}}gy.NEWLINE_CHARS=new Set([`
`,"\r"]);gy.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function ZB(s,e){for(let i=e??0;i<s.length;i++){if(s[i]===10)return{preceding:i,index:i+1,carriage:!1};if(s[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function eG(s){for(let n=0;n<s.length-1;n++){if(s[n]===10&&s[n+1]===10||s[n]===13&&s[n+1]===13)return n+2;if(s[n]===13&&s[n+1]===10&&n+3<s.length&&s[n+2]===13&&s[n+3]===10)return n+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const k0={off:0,error:200,warn:300,info:400,debug:500},gN=(s,e,t)=>{if(s){if(DB(k0,s))return s;Yn(t).warn(`${e} was set to ${JSON.stringify(s)}, expected one of ${JSON.stringify(Object.keys(k0))}`)}};function df(){}function Ig(s,e,t){return!e||k0[s]>k0[t]?df:e[s].bind(e)}const tG={error:df,warn:df,info:df,debug:df};let yN=new WeakMap;function Yn(s){var e;const t=s.logger,n=(e=s.logLevel)!==null&&e!==void 0?e:"off";if(!t)return tG;const i=yN.get(t);if(i&&i[0]===n)return i[1];const a={error:Ig("error",t,n),warn:Ig("warn",t,n),info:Ig("info",t,n),debug:Ig("debug",t,n)};return yN.set(t,[n,a]),a}const tl=s=>(s.options&&(s.options=Object.assign({},s.options),delete s.options.headers),s.headers&&(s.headers=Object.fromEntries((s.headers instanceof Headers?[...s.headers]:Object.entries(s.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in s&&(s.retryOfRequestLogID&&(s.retryOf=s.retryOfRequestLogID),delete s.retryOfRequestLogID),s);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Tu{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let i=!1;const a=n?Yn(n):console;function l(){return Pi(this,arguments,function*(){var d,h,p,v;if(i)throw new hi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let x=!1;try{try{for(var S=!0,A=Li(nG(e,t)),E;E=yield Ue(A.next()),d=E.done,!d;S=!0){v=E.value,S=!1;const N=v;if(!x)if(N.data.startsWith("[DONE]")){x=!0;continue}else try{yield yield Ue(JSON.parse(N.data))}catch(R){throw a.error("Could not parse message into JSON:",N.data),a.error("From chunk:",N.raw),R}}}catch(N){h={error:N}}finally{try{!S&&!d&&(p=A.return)&&(yield Ue(p.call(A)))}finally{if(h)throw h.error}}x=!0}catch(N){if(qx(N))return yield Ue(void 0);throw N}finally{x||t.abort()}})}return new Tu(l,t,n)}static fromReadableStream(e,t,n){let i=!1;function a(){return Pi(this,arguments,function*(){var d,h,p,v;const x=new gy,S=Gk(e);try{for(var A=!0,E=Li(S),N;N=yield Ue(E.next()),d=N.done,!d;A=!0){v=N.value,A=!1;const R=v;for(const D of x.decode(R))yield yield Ue(D)}}catch(R){h={error:R}}finally{try{!A&&!d&&(p=E.return)&&(yield Ue(p.call(E)))}finally{if(h)throw h.error}}for(const R of x.flush())yield yield Ue(R)})}function l(){return Pi(this,arguments,function*(){var d,h,p,v;if(i)throw new hi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let x=!1;try{try{for(var S=!0,A=Li(a()),E;E=yield Ue(A.next()),d=E.done,!d;S=!0){v=E.value,S=!1;const N=v;x||N&&(yield yield Ue(JSON.parse(N)))}}catch(N){h={error:N}}finally{try{!S&&!d&&(p=A.return)&&(yield Ue(p.call(A)))}finally{if(h)throw h.error}}x=!0}catch(N){if(qx(N))return yield Ue(void 0);throw N}finally{x||t.abort()}})}return new Tu(l,t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),i=a=>({next:()=>{if(a.length===0){const l=n.next();e.push(l),t.push(l)}return a.shift()}});return[new Tu(()=>i(e),this.controller,this.client),new Tu(()=>i(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return Bk({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:i,done:a}=await t.next();if(a)return n.close();const l=Tw(JSON.stringify(i)+`
`);n.enqueue(l)}catch(i){n.error(i)}},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}}function nG(s,e){return Pi(this,arguments,function*(){var n,i,a,l;if(!s.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new hi("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new hi("Attempted to iterate over a response with no body");const c=new iG,d=new gy,h=Gk(s.body);try{for(var p=!0,v=Li(sG(h)),x;x=yield Ue(v.next()),n=x.done,!n;p=!0){l=x.value,p=!1;const S=l;for(const A of d.decode(S)){const E=c.decode(A);E&&(yield yield Ue(E))}}}catch(S){i={error:S}}finally{try{!p&&!n&&(a=v.return)&&(yield Ue(a.call(v)))}finally{if(i)throw i.error}}for(const S of d.flush()){const A=c.decode(S);A&&(yield yield Ue(A))}})}function sG(s){return Pi(this,arguments,function*(){var t,n,i,a;let l=new Uint8Array;try{for(var c=!0,d=Li(s),h;h=yield Ue(d.next()),t=h.done,!t;c=!0){a=h.value,c=!1;const p=a;if(p==null)continue;const v=p instanceof ArrayBuffer?new Uint8Array(p):typeof p=="string"?Tw(p):p;let x=new Uint8Array(l.length+v.length);x.set(l),x.set(v,l.length),l=x;let S;for(;(S=eG(l))!==-1;)yield yield Ue(l.slice(0,S)),l=l.slice(S)}}catch(p){n={error:p}}finally{try{!c&&!t&&(i=d.return)&&(yield Ue(i.call(d)))}finally{if(n)throw n.error}}l.length>0&&(yield yield Ue(l))})}class iG{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,i]=rG(e,":");return i.startsWith(" ")&&(i=i.substring(1)),t==="event"?this.event=i:t==="data"&&this.data.push(i),null}}function rG(s,e){const t=s.indexOf(e);return t!==-1?[s.substring(0,t),e,s.substring(t+e.length)]:[s,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function aG(s,e){const{response:t,requestLogID:n,retryOfRequestLogID:i,startTime:a}=e,l=await(async()=>{var c;if(e.options.stream)return Yn(s).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,s):Tu.fromSSEResponse(t,e.controller,s);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const d=t.headers.get("content-type"),h=(c=d==null?void 0:d.split(";")[0])===null||c===void 0?void 0:c.trim();return(h==null?void 0:h.includes("application/json"))||(h==null?void 0:h.endsWith("+json"))?await t.json():await t.text()})();return Yn(s).debug(`[${n}] response parsed`,tl({retryOfRequestLogID:i,url:t.url,status:t.status,body:l,durationMs:Date.now()-a})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Cw extends Promise{constructor(e,t,n=aG){super(i=>{i(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new Cw(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xk=Symbol("brand.privateNullableHeaders");function*oG(s){if(!s)return;if(Xk in s){const{values:n,nulls:i}=s;yield*n.entries();for(const a of i)yield[a,null];return}let e=!1,t;s instanceof Headers?t=s.entries():dN(s)?t=s:(e=!0,t=Object.entries(s??{}));for(let n of t){const i=n[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const a=dN(n[1])?n[1]:[n[1]];let l=!1;for(const c of a)c!==void 0&&(e&&!l&&(l=!0,yield[i,null]),yield[i,c])}}const $h=s=>{const e=new Headers,t=new Set;for(const n of s){const i=new Set;for(const[a,l]of oG(n)){const c=a.toLowerCase();i.has(c)||(e.delete(a),i.add(c)),l===null?(e.delete(a),t.add(c)):(e.append(a,l),t.delete(c))}}return{[Xk]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const i_=s=>{var e,t,n,i,a,l;if(typeof globalThis.process<"u")return(n=(t=(e=D3)===null||e===void 0?void 0:e[s])===null||t===void 0?void 0:t.trim())!==null&&n!==void 0?n:void 0;if(typeof globalThis.Deno<"u")return(l=(a=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||a===void 0?void 0:a.call(i,s))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Wk;class yy{constructor(e){var t,n,i,a,l,c,d,{baseURL:h=i_("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:p=(t=i_("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:v="v1beta"}=e,x=R0(e,["baseURL","apiKey","apiVersion"]);const S=Object.assign(Object.assign({apiKey:p,apiVersion:v},x),{baseURL:h||"https://generativelanguage.googleapis.com"});this.baseURL=S.baseURL,this.timeout=(n=S.timeout)!==null&&n!==void 0?n:yy.DEFAULT_TIMEOUT,this.logger=(i=S.logger)!==null&&i!==void 0?i:console;const A="warn";this.logLevel=A,this.logLevel=(l=(a=gN(S.logLevel,"ClientOptions.logLevel",this))!==null&&a!==void 0?a:gN(i_("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:A,this.fetchOptions=S.fetchOptions,this.maxRetries=(c=S.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(d=S.fetch)!==null&&d!==void 0?d:HB(),this.encoder=qB,this._options=S,this.apiKey=p,this.apiVersion=v,this.clientAdapter=S.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=$h([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return $h([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return $h([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new hi(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Su}`}defaultIdempotencyKey(){return`stainless-node-retry-${CB()}`}makeStatusError(e,t,n,i){return Wn.generate(e,t,n,i)}buildURL(e,t,n){const i=!this.baseURLOverridden()&&n||this.baseURL,a=RB(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return IB(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(a.search=this.stringifyQuery(t)),a.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(i=>Object.assign({method:e,path:t},i)))}request(e,t=null){return new Cw(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var i,a,l;const c=await e,d=(i=c.maxRetries)!==null&&i!==void 0?i:this.maxRetries;t==null&&(t=d),await this.prepareOptions(c);const{req:h,url:p,timeout:v}=await this.buildRequest(c,{retryCount:d-t});await this.prepareRequest(h,{url:p,options:c});const x="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),S=n===void 0?"":`, retryOf: ${n}`,A=Date.now();if(Yn(this).debug(`[${x}] sending request`,tl({retryOfRequestLogID:n,method:c.method,url:p,options:c,headers:h.headers})),!((a=c.signal)===null||a===void 0)&&a.aborted)throw new $x;const E=new AbortController,N=await this.fetchWithTimeout(p,h,v,E).catch(Vx),R=Date.now();if(N instanceof globalThis.Error){const P=`retrying, ${t} attempts remaining`;if(!((l=c.signal)===null||l===void 0)&&l.aborted)throw new $x;const L=qx(N)||/timed? ?out/i.test(String(N)+("cause"in N?String(N.cause):""));if(t)return Yn(this).info(`[${x}] connection ${L?"timed out":"failed"} - ${P}`),Yn(this).debug(`[${x}] connection ${L?"timed out":"failed"} (${P})`,tl({retryOfRequestLogID:n,url:p,durationMs:R-A,message:N.message})),this.retryRequest(c,t,n??x);throw Yn(this).info(`[${x}] connection ${L?"timed out":"failed"} - error; no more retries left`),Yn(this).debug(`[${x}] connection ${L?"timed out":"failed"} (error; no more retries left)`,tl({retryOfRequestLogID:n,url:p,durationMs:R-A,message:N.message})),L?new Dk:new my({cause:N})}const D=`[${x}${S}] ${h.method} ${p} ${N.ok?"succeeded":"failed"} with status ${N.status} in ${R-A}ms`;if(!N.ok){const P=await this.shouldRetry(N);if(t&&P){const K=`retrying, ${t} attempts remaining`;return await GB(N.body),Yn(this).info(`${D} - ${K}`),Yn(this).debug(`[${x}] response error (${K})`,tl({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,durationMs:R-A})),this.retryRequest(c,t,n??x,N.headers)}const L=P?"error; no more retries left":"error; not retryable";Yn(this).info(`${D} - ${L}`);const H=await N.text().catch(K=>Vx(K).message),z=LB(H),U=z?void 0:H;throw Yn(this).debug(`[${x}] response error (${L})`,tl({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,message:U,durationMs:Date.now()-A})),this.makeStatusError(N.status,z,U,N.headers)}return Yn(this).info(D),Yn(this).debug(`[${x}] response start`,tl({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,durationMs:R-A})),{response:N,options:c,controller:E,requestLogID:x,retryOfRequestLogID:n,startTime:A}}async fetchWithTimeout(e,t,n,i){const a=t||{},{signal:l,method:c}=a,d=R0(a,["signal","method"]);l&&l.addEventListener("abort",()=>i.abort());const h=setTimeout(()=>i.abort(),n),p=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,v=Object.assign(Object.assign(Object.assign({signal:i.signal},p?{duplex:"half"}:{}),{method:"GET"}),d);c&&(v.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,v)}finally{clearTimeout(h)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n,i){var a;let l;const c=i==null?void 0:i.get("retry-after-ms");if(c){const h=parseFloat(c);Number.isNaN(h)||(l=h)}const d=i==null?void 0:i.get("retry-after");if(d&&!l){const h=parseFloat(d);Number.isNaN(h)?l=Date.parse(d)-Date.now():l=h*1e3}if(!(l&&0<=l&&l<60*1e3)){const h=(a=e.maxRetries)!==null&&a!==void 0?a:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,h)}return await OB(l),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,l=Math.min(.5*Math.pow(2,a),8),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(e,{retryCount:t=0}={}){var n,i,a;const l=Object.assign({},e),{method:c,path:d,query:h,defaultBaseURL:p}=l,v=this.buildURL(d,h,p);"timeout"in l&&PB("timeout",l.timeout),l.timeout=(n=l.timeout)!==null&&n!==void 0?n:this.timeout;const{bodyHeaders:x,body:S}=this.buildBody({options:l}),A=await this.buildHeaders({options:e,method:c,bodyHeaders:x,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:A},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&S instanceof globalThis.ReadableStream&&{duplex:"half"}),S&&{body:S}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(a=l.fetchOptions)!==null&&a!==void 0?a:{}),url:v,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:i}){let a={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let c=$h([a,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),jB()),this._options.defaultHeaders,n,e.headers,l]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=$h([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:BB(e)}:this.encoder({body:e,headers:n})}}yy.DEFAULT_TIMEOUT=6e4;class pn extends yy{constructor(){super(...arguments),this.interactions=new Jk(this)}}Wk=pn;pn.GeminiNextGenAPIClient=Wk;pn.GeminiNextGenAPIClientError=hi;pn.APIError=Wn;pn.APIConnectionError=my;pn.APIConnectionTimeoutError=Dk;pn.APIUserAbortError=$x;pn.NotFoundError=Uk;pn.ConflictError=Fk;pn.RateLimitError=jk;pn.BadRequestError=Pk;pn.AuthenticationError=Lk;pn.InternalServerError=Hk;pn.PermissionDeniedError=Ok;pn.UnprocessableEntityError=zk;pn.toFile=JB;pn.Interactions=Jk;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lG(s,e){const t={},n=g(s,["name"]);return n!=null&&y(t,["_url","name"],n),t}function cG(s,e){const t={},n=g(s,["name"]);return n!=null&&y(t,["_url","name"],n),t}function uG(s,e){const t={},n=g(s,["sdkHttpResponse"]);return n!=null&&y(t,["sdkHttpResponse"],n),t}function dG(s,e){const t={},n=g(s,["sdkHttpResponse"]);return n!=null&&y(t,["sdkHttpResponse"],n),t}function hG(s,e,t){const n={};if(g(s,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=g(s,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&y(e,["displayName"],i),g(s,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=g(s,["epochCount"]);e!==void 0&&a!=null&&y(e,["tuningTask","hyperparameters","epochCount"],a);const l=g(s,["learningRateMultiplier"]);if(l!=null&&y(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),g(s,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(g(s,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(g(s,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=g(s,["batchSize"]);e!==void 0&&c!=null&&y(e,["tuningTask","hyperparameters","batchSize"],c);const d=g(s,["learningRate"]);if(e!==void 0&&d!=null&&y(e,["tuningTask","hyperparameters","learningRate"],d),g(s,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(g(s,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function fG(s,e,t){const n={};let i=g(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const S=g(s,["validationDataset"]);e!==void 0&&S!=null&&y(e,["supervisedTuningSpec"],vN(S))}else if(i==="PREFERENCE_TUNING"){const S=g(s,["validationDataset"]);e!==void 0&&S!=null&&y(e,["preferenceOptimizationSpec"],vN(S))}const a=g(s,["tunedModelDisplayName"]);e!==void 0&&a!=null&&y(e,["tunedModelDisplayName"],a);const l=g(s,["description"]);e!==void 0&&l!=null&&y(e,["description"],l);let c=g(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const S=g(s,["epochCount"]);e!==void 0&&S!=null&&y(e,["supervisedTuningSpec","hyperParameters","epochCount"],S)}else if(c==="PREFERENCE_TUNING"){const S=g(s,["epochCount"]);e!==void 0&&S!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],S)}let d=g(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const S=g(s,["learningRateMultiplier"]);e!==void 0&&S!=null&&y(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],S)}else if(d==="PREFERENCE_TUNING"){const S=g(s,["learningRateMultiplier"]);e!==void 0&&S!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],S)}let h=g(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const S=g(s,["exportLastCheckpointOnly"]);e!==void 0&&S!=null&&y(e,["supervisedTuningSpec","exportLastCheckpointOnly"],S)}else if(h==="PREFERENCE_TUNING"){const S=g(s,["exportLastCheckpointOnly"]);e!==void 0&&S!=null&&y(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],S)}let p=g(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const S=g(s,["adapterSize"]);e!==void 0&&S!=null&&y(e,["supervisedTuningSpec","hyperParameters","adapterSize"],S)}else if(p==="PREFERENCE_TUNING"){const S=g(s,["adapterSize"]);e!==void 0&&S!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],S)}if(g(s,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(g(s,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const v=g(s,["labels"]);e!==void 0&&v!=null&&y(e,["labels"],v);const x=g(s,["beta"]);return e!==void 0&&x!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","beta"],x),n}function pG(s,e){const t={},n=g(s,["baseModel"]);n!=null&&y(t,["baseModel"],n);const i=g(s,["preTunedModel"]);i!=null&&y(t,["preTunedModel"],i);const a=g(s,["trainingDataset"]);a!=null&&EG(a);const l=g(s,["config"]);return l!=null&&hG(l,t),t}function mG(s,e){const t={},n=g(s,["baseModel"]);n!=null&&y(t,["baseModel"],n);const i=g(s,["preTunedModel"]);i!=null&&y(t,["preTunedModel"],i);const a=g(s,["trainingDataset"]);a!=null&&TG(a,t,e);const l=g(s,["config"]);return l!=null&&fG(l,t,e),t}function gG(s,e){const t={},n=g(s,["name"]);return n!=null&&y(t,["_url","name"],n),t}function yG(s,e){const t={},n=g(s,["name"]);return n!=null&&y(t,["_url","name"],n),t}function vG(s,e,t){const n={},i=g(s,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const a=g(s,["pageToken"]);e!==void 0&&a!=null&&y(e,["_query","pageToken"],a);const l=g(s,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),n}function bG(s,e,t){const n={},i=g(s,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const a=g(s,["pageToken"]);e!==void 0&&a!=null&&y(e,["_query","pageToken"],a);const l=g(s,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),n}function _G(s,e){const t={},n=g(s,["config"]);return n!=null&&vG(n,t),t}function xG(s,e){const t={},n=g(s,["config"]);return n!=null&&bG(n,t),t}function wG(s,e){const t={},n=g(s,["sdkHttpResponse"]);n!=null&&y(t,["sdkHttpResponse"],n);const i=g(s,["nextPageToken"]);i!=null&&y(t,["nextPageToken"],i);const a=g(s,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>Qk(c))),y(t,["tuningJobs"],l)}return t}function SG(s,e){const t={},n=g(s,["sdkHttpResponse"]);n!=null&&y(t,["sdkHttpResponse"],n);const i=g(s,["nextPageToken"]);i!=null&&y(t,["nextPageToken"],i);const a=g(s,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>Jx(c))),y(t,["tuningJobs"],l)}return t}function AG(s,e){const t={},n=g(s,["name"]);n!=null&&y(t,["model"],n);const i=g(s,["name"]);return i!=null&&y(t,["endpoint"],i),t}function EG(s,e){const t={};if(g(s,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(s,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=g(s,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>a)),y(t,["examples","examples"],i)}return t}function TG(s,e,t){const n={};let i=g(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const l=g(s,["gcsUri"]);e!==void 0&&l!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(i==="PREFERENCE_TUNING"){const l=g(s,["gcsUri"]);e!==void 0&&l!=null&&y(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let a=g(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=g(s,["vertexDatasetResource"]);e!==void 0&&l!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=g(s,["vertexDatasetResource"]);e!==void 0&&l!=null&&y(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(g(s,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function Qk(s,e){const t={},n=g(s,["sdkHttpResponse"]);n!=null&&y(t,["sdkHttpResponse"],n);const i=g(s,["name"]);i!=null&&y(t,["name"],i);const a=g(s,["state"]);a!=null&&y(t,["state"],pk(a));const l=g(s,["createTime"]);l!=null&&y(t,["createTime"],l);const c=g(s,["tuningTask","startTime"]);c!=null&&y(t,["startTime"],c);const d=g(s,["tuningTask","completeTime"]);d!=null&&y(t,["endTime"],d);const h=g(s,["updateTime"]);h!=null&&y(t,["updateTime"],h);const p=g(s,["description"]);p!=null&&y(t,["description"],p);const v=g(s,["baseModel"]);v!=null&&y(t,["baseModel"],v);const x=g(s,["_self"]);return x!=null&&y(t,["tunedModel"],AG(x)),t}function Jx(s,e){const t={},n=g(s,["sdkHttpResponse"]);n!=null&&y(t,["sdkHttpResponse"],n);const i=g(s,["name"]);i!=null&&y(t,["name"],i);const a=g(s,["state"]);a!=null&&y(t,["state"],pk(a));const l=g(s,["createTime"]);l!=null&&y(t,["createTime"],l);const c=g(s,["startTime"]);c!=null&&y(t,["startTime"],c);const d=g(s,["endTime"]);d!=null&&y(t,["endTime"],d);const h=g(s,["updateTime"]);h!=null&&y(t,["updateTime"],h);const p=g(s,["error"]);p!=null&&y(t,["error"],p);const v=g(s,["description"]);v!=null&&y(t,["description"],v);const x=g(s,["baseModel"]);x!=null&&y(t,["baseModel"],x);const S=g(s,["tunedModel"]);S!=null&&y(t,["tunedModel"],S);const A=g(s,["preTunedModel"]);A!=null&&y(t,["preTunedModel"],A);const E=g(s,["supervisedTuningSpec"]);E!=null&&y(t,["supervisedTuningSpec"],E);const N=g(s,["preferenceOptimizationSpec"]);N!=null&&y(t,["preferenceOptimizationSpec"],N);const R=g(s,["tuningDataStats"]);R!=null&&y(t,["tuningDataStats"],R);const D=g(s,["encryptionSpec"]);D!=null&&y(t,["encryptionSpec"],D);const P=g(s,["partnerModelTuningSpec"]);P!=null&&y(t,["partnerModelTuningSpec"],P);const L=g(s,["customBaseModel"]);L!=null&&y(t,["customBaseModel"],L);const H=g(s,["experiment"]);H!=null&&y(t,["experiment"],H);const z=g(s,["labels"]);z!=null&&y(t,["labels"],z);const U=g(s,["outputUri"]);U!=null&&y(t,["outputUri"],U);const J=g(s,["pipelineJob"]);J!=null&&y(t,["pipelineJob"],J);const K=g(s,["serviceAccount"]);K!=null&&y(t,["serviceAccount"],K);const ie=g(s,["tunedModelDisplayName"]);ie!=null&&y(t,["tunedModelDisplayName"],ie);const oe=g(s,["veoTuningSpec"]);return oe!=null&&y(t,["veoTuningSpec"],oe),t}function CG(s,e){const t={},n=g(s,["sdkHttpResponse"]);n!=null&&y(t,["sdkHttpResponse"],n);const i=g(s,["name"]);i!=null&&y(t,["name"],i);const a=g(s,["metadata"]);a!=null&&y(t,["metadata"],a);const l=g(s,["done"]);l!=null&&y(t,["done"],l);const c=g(s,["error"]);return c!=null&&y(t,["error"],c),t}function vN(s,e){const t={},n=g(s,["gcsUri"]);n!=null&&y(t,["validationDatasetUri"],n);const i=g(s,["vertexDatasetResource"]);return i!=null&&y(t,["validationDatasetUri"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NG extends ma{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new gc(da.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var n;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const i={tunedModelName:t.baseModel};!((n=t.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(i.checkpointId=t.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},t),{preTunedModel:i});return a.baseModel=void 0,await this.tuneInternal(a)}else{const i=Object.assign({},t);return await this.tuneInternal(i)}else{const i=Object.assign({},t),a=await this.tuneMldevInternal(i);let l="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?l=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(l=a.name.split("/operations/")[0]),{name:l,state:Ux.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=yG(e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>Jx(p))}else{const h=gG(e);return c=pe("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>Qk(p))}}async listInternal(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=xG(e);return c=pe("tuningJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=SG(p),x=new qC;return Object.assign(x,v),x})}else{const h=_G(e);return c=pe("tunedModels",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=wG(p),x=new qC;return Object.assign(x,v),x})}}async cancel(e){var t,n,i,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=cG(e);return c=pe("{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=dG(p),x=new VC;return Object.assign(x,v),x})}else{const h=lG(e);return c=pe("{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:p.headers},x})),l.then(p=>{const v=uG(p),x=new VC;return Object.assign(x,v),x})}}async tuneInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI()){const c=mG(e,e);return a=pe("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>Jx(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let i,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=pG(e);return a=pe("tunedModels",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>CG(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RG{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const kG=1024*1024*8,MG=3,IG=1e3,DG=2,M0="x-goog-upload-status";async function PG(s,e,t){var n;const i=await Zk(s,e,t),a=await(i==null?void 0:i.json());if(((n=i==null?void 0:i.headers)===null||n===void 0?void 0:n[M0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function LG(s,e,t){var n;const i=await Zk(s,e,t),a=await(i==null?void 0:i.json());if(((n=i==null?void 0:i.headers)===null||n===void 0?void 0:n[M0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=lk(a),c=new _w;return Object.assign(c,l),c}async function Zk(s,e,t){var n,i;let a=0,l=0,c=new Fx(new Response),d="upload";for(a=s.size;l<a;){const h=Math.min(kG,a-l),p=s.slice(l,l+h);l+h>=a&&(d+=", finalize");let v=0,x=IG;for(;v<MG&&(c=await t.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(h)}}}),!(!((n=c==null?void 0:c.headers)===null||n===void 0)&&n[M0]));)v++,await UG(x),x=x*DG;if(l+=h,((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[M0])!=="active")break;if(a<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function OG(s){return{size:s.size,type:s.type}}function UG(s){return new Promise(e=>setTimeout(e,s))}class FG{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await PG(e,t,n)}async uploadToFileSearchStore(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await LG(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await OG(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zG{create(e,t,n){return new jG(e,t,n)}}class jG{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bN="x-goog-api-key";class HG{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(bN)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(bN,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const BG="gl-node/";class GG{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new pn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=U3(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new HG(this.apiKey);this.apiClient=new OH({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:BG+"web",uploader:new FG,downloader:new RG}),this.models=new tB(this.apiClient),this.live=new JH(this.apiClient,i,new zG),this.batches=new h6(this.apiClient),this.chats=new Y6(this.models,this.apiClient),this.caches=new q6(this.apiClient),this.files=new sz(this.apiClient),this.operations=new nB(this.apiClient),this.authTokens=new vB(this.apiClient),this.tunings=new NG(this.apiClient),this.fileSearchStores=new TB(this.apiClient)}}const qG={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var VG={};const $G=()=>{let s="";try{typeof process<"u"&&VG&&(s="PLACEHOLDER_API_KEY")}catch{}if(!s)try{typeof import.meta<"u"&&qG&&(s="")}catch{}return s},Xx=$G(),_N=Xx?new GG({apiKey:Xx}):null,YG=async(s,e,t,n=20,i,a="ar")=>{try{if(!Xx||!_N)throw new Error(" API .");if(!s||s.trim().length<50)throw new Error("       .    PDF       .");const c=s.substring(0,5e5),d=10,h=Math.ceil(n/d);let p=[];const v=a==="ar"?"Output Language: ARABIC (Strictly)":"Output Language: ENGLISH (Strictly)",x=`
      STYLE REFERENCE (MIMIC THIS ACADEMIC TONE AND STRUCTURE):
      
      Example 1 (Definition/Concept):
      Question: "..................... is the study of word formation."
      Options: ["morphology", "phonology", "semantics", "stylistics"]
      Correct Answer: "morphology"
      Explanation: "Morphology is specifically defined as the branch of linguistics that studies the structure of words and word formation processes. Phonology deals with sounds, semantics with meaning, and stylistics with style."

      Example 2 (Gap Fill/Analysis):
      Question: "The final (silent) 'e' is usually .......... from the end of a word when an '-ing' suffix is added to it."
      Options: ["kept", "dropped", "doubled", "pronounced"]
      Correct Answer: "dropped"
      Explanation: "According to spelling rules in English morphology, when adding a vowel suffix like '-ing' to a word ending in a silent 'e' (e.g., make -> making), the 'e' is dropped (deleted)."

      Example 3 (Classification):
      Question: "................. verbs can be divided into two main groups: dynamic vs. stative verbs."
      Options: ["auxiliary", "lexical", "primary", "modal"]
      Correct Answer: "lexical"
      Explanation: "Lexical verbs (main verbs) are semantically classified into dynamic verbs (expressing action) and stative verbs (expressing state of being). Auxiliary verbs follow different classifications."
    `;for(let S=0;S<h;S++){const A=Math.min(d,n-S*d);i&&i(p.length,n);const E=`
        Act as a strict academic professor creating a formal university exam. 
        Task: Create ${A} distinct exam questions based on the provided text.
        Subject: "${e}"
        Exam Context: "${t}".
        ${v}
        
        ${x}

        IMPORTANT REQUIREMENTS:
        1. **Explanation Quality**: The 'explanation' field must be COMPREHENSIVE, EDUCATIONAL, and DETAILED. Do not just say "The answer is A". Explain the concept clearly, define terms if necessary, and justify why the option is correct based on the text.
        2. **Academic Tone**: Use formal academic language (like the examples above). Use gap-fills (.........), definitions, and conceptual analysis.
        3. **Uniqueness**: Do not repeat questions provided in previous batches.
        4. **Format**: Output strictly VALID JSON array.
        
        JSON Schema per item:
        {
          "type": "multiple_choice" | "true_false",
          "question": "string",
          "options": ["string", "string", ...],
          "correct_answer_index": number,
          "explanation": "Detailed academic explanation string"
        }
        
        Source Content to analyze:
        ${c}
      `;try{const N=await _N.models.generateContent({model:"gemini-3-flash-preview",contents:E,config:{responseMimeType:"application/json",maxOutputTokens:8192,responseSchema:{type:On.ARRAY,items:{type:On.OBJECT,properties:{type:{type:On.STRING,enum:["multiple_choice","true_false"]},question:{type:On.STRING},options:{type:On.ARRAY,items:{type:On.STRING}},correct_answer_index:{type:On.INTEGER},explanation:{type:On.STRING}},required:["type","question","options","correct_answer_index","explanation"]}}}}),D=JSON.parse(N.text||"[]").map(P=>({subject:e,exam_type:t,type:P.type,question:P.question,options:P.options,correct_answer_index:P.correct_answer_index,explanation:P.explanation}));p=[...p,...D]}catch(N){console.error(`Error in batch ${S+1}:`,N)}}if(i&&i(n,n),p.length===0)throw new Error("    .      .");return p}catch(l){throw console.error("Gemini Bank Gen Error:",l),new Error("   : "+l.message)}},eM=async()=>{try{const{data:s,error:e}=await Nt.from("question_bank").select("subject");if(e){if(e.code==="42P01")return console.warn("Table 'question_bank' not found. Please create it in Supabase."),[];throw e}return Array.from(new Set((s||[]).map(n=>n.subject).filter(n=>typeof n=="string"&&n.trim().length>0)))}catch(s){return console.error("Error fetching subjects:",s.message||s),[]}},KG=async(s,e,t)=>{try{let n=Nt.from("question_bank").select("*").eq("subject",s);t!=="all"&&(n=n.eq("exam_type",t));const{data:i,error:a}=await n.limit(100);if(a)throw a;if(!i||i.length===0)throw new Error("     .");return i.sort(()=>.5-Math.random()).slice(0,e).map((d,h)=>({id:h+1,type:d.type,question:d.question,options:typeof d.options=="string"?JSON.parse(d.options):d.options,correctAnswerIndex:d.correct_answer_index,explanation:d.explanation}))}catch(n){throw console.error("Error generating quiz from bank:",n.message||n),n}},JG=async s=>{const{error:e}=await Nt.from("question_bank").insert(s);if(e)throw console.error("Error saving questions:",e.message||e),new Error("      .")},XG=async s=>{try{const{data:e,error:t}=await Nt.from("question_bank").select("*").eq("subject",s).order("created_at",{ascending:!1});if(t)throw t;return e.map(n=>({id:n.id,subject:n.subject,exam_type:n.exam_type,type:n.type,question:n.question,options:typeof n.options=="string"?JSON.parse(n.options):n.options,correct_answer_index:n.correct_answer_index,explanation:n.explanation,created_at:n.created_at}))}catch(e){return console.error("Error fetching subject questions:",e),[]}},WG=async s=>{const{error:e}=await Nt.from("question_bank").delete().eq("id",s);if(e)throw console.error("Error deleting question:",e),new Error("   ")},QG=async s=>{const{error:e}=await Nt.from("question_bank").delete().eq("subject",s);if(e)throw console.error("Error deleting subject:",e),new Error("   ")},ZG=({user:s,onLogout:e,onNavigate:t})=>{const[n,i]=ae.useState({totalQuizzes:0,totalToolUsage:0,totalStudents:0,totalQuestionsInBank:0,loading:!0}),[a,l]=ae.useState("dashboard"),[c,d]=ae.useState("stats"),[h,p]=ae.useState([]),[v,x]=ae.useState(null),[S,A]=ae.useState([]),[E,N]=ae.useState(!1),[R,D]=ae.useState(!1),[P,L]=ae.useState(null),[H,z]=ae.useState(null),[U,J]=ae.useState("new"),[K,ie]=ae.useState(""),[oe,ne]=ae.useState("midterm"),[ve,de]=ae.useState(20),[Re,j]=ae.useState("ar"),[X,me]=ae.useState(!1),[ee,ue]=ae.useState(""),[O,$]=ae.useState([]),[se,ce]=ae.useState(!1),Ce=async()=>{i(we=>({...we,loading:!0}));try{const{data:we}=await Nt.from("quiz_history").select("user_id, quiz_title"),{count:rt}=await Nt.from("question_bank").select("*",{count:"exact",head:!0});if(we){const Gs=new Set(we.map(dr=>dr.user_id)).size,Vd=we.filter(dr=>{var ko;return!((ko=dr.quiz_title)!=null&&ko.startsWith(": "))}),$d=we.filter(dr=>{var ko;return(ko=dr.quiz_title)==null?void 0:ko.startsWith(": ")});i({totalQuizzes:Vd.length,totalToolUsage:$d.length,totalStudents:Gs,totalQuestionsInBank:rt||0,loading:!1})}const Bs=await eM();p(Bs)}catch(we){console.error("Admin stats error:",we),i(rt=>({...rt,loading:!1}))}};ae.useEffect(()=>{Ce()},[]);const re=async we=>{x(we),d("subject_details"),N(!0);const rt=await XG(we);A(rt),N(!1)},le=async we=>{if(confirm("      "))try{await WG(we),A(rt=>rt.filter(Bs=>Bs.id!==we)),Ce()}catch{alert(" ")}},ze=()=>{v&&D(!0)},Le=async()=>{if(v)try{await QG(v),d("subjects"),x(null),D(!1),Ce()}catch{alert("  "),D(!1)}},Bt=()=>{v&&(J("existing"),ie(v),l("generator"),d("stats"),L(null),z(null),$([]))},ur=async we=>{L(we);try{const rt=await I3(we);z(rt)}catch{alert("  .      .")}},ya=async()=>{if(!(!H||!K)){me(!0),ue("  ...");try{const we=await YG(H,K,oe,ve,(rt,Bs)=>{ue(`  ${rt}   ${Bs} ...`)},Re);$(we)}catch(we){alert(we.message)}finally{me(!1),ue("")}}},yc=async()=>{ce(!0);try{await JG(O),alert("     !"),$([]),L(null),z(null),U==="new"&&ie(""),Ce()}catch{alert("   ")}finally{ce(!1)}},Hs=we=>{$(rt=>rt.filter((Bs,Gs)=>Gs!==we))};return b.jsxs("div",{className:"min-h-screen pt-24 pb-20 px-4 md:px-6 relative z-10 bg-[#020202] text-right",dir:"rtl",children:[b.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-20 overflow-hidden",children:b.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_center,#10b98115_0%,transparent_70%)]"})}),b.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[b.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6 mb-8 animate-lux-up",children:[b.jsxs("div",{className:"flex items-center gap-5",children:[b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"relative w-20 h-20 rounded-2xl bg-[#0a0a0a] border border-emerald-500/30 flex items-center justify-center overflow-hidden shadow-2xl",children:b.jsx("img",{src:"https://lh3.googleusercontent.com/d/1tbzVNKO3FGH46Pa6MZ58OWD4BXVKdK5P",alt:"Admin",className:"w-full h-full object-cover"})}),b.jsx("div",{className:"absolute -bottom-2 -right-2 bg-emerald-500 text-black p-1.5 rounded-lg shadow-lg border-2 border-[#020202]",children:b.jsx(ZN,{size:16})})]}),b.jsxs("div",{children:[b.jsx("h1",{className:"text-2xl font-black text-white tracking-tight",children:" "}),b.jsx("p",{className:"text-emerald-400 font-bold text-xs",children:"   "})]})]}),b.jsxs("div",{className:"flex bg-white/5 p-1 rounded-xl border border-white/10",children:[b.jsx("button",{onClick:()=>{l("dashboard"),d("stats")},className:`px-6 py-2 rounded-lg text-sm font-bold transition-all ${a==="dashboard"?"bg-emerald-600 text-white":"text-slate-400 hover:text-white"}`,children:" "}),b.jsxs("button",{onClick:()=>l("generator"),className:`px-6 py-2 rounded-lg text-sm font-bold transition-all flex items-center gap-2 ${a==="generator"?"bg-emerald-600 text-white":"text-slate-400 hover:text-white"}`,children:[b.jsx(xT,{size:16}),"  "]})]})]}),a==="dashboard"?b.jsxs("div",{className:"animate-fade-in",children:[c==="stats"&&b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[{label:" ",value:n.totalStudents,icon:b.jsx(cR,{}),color:"text-blue-400",bg:"bg-blue-500/10"},{label:"  ",value:n.totalQuestionsInBank,icon:b.jsx(xT,{}),color:"text-fuchsia-400",bg:"bg-fuchsia-500/10"},{label:" ",value:n.totalQuizzes,icon:b.jsx(rw,{}),color:"text-emerald-400",bg:"bg-emerald-500/10"},{label:" ",value:n.totalToolUsage,icon:b.jsx(YN,{}),color:"text-amber-400",bg:"bg-amber-500/10"}].map((we,rt)=>b.jsxs("div",{className:"glass-panel p-6 rounded-[2rem] bg-[#080808] border border-white/5 group",children:[b.jsx("div",{className:`w-12 h-12 rounded-2xl ${we.bg} ${we.color} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform`,children:we.icon}),b.jsx("h4",{className:"text-3xl font-black text-white mb-1",children:n.loading?"...":we.value}),b.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:we.label})]},rt))}),b.jsx("div",{className:"mb-8",children:b.jsxs("div",{className:"glass-panel p-8 rounded-[2rem] bg-[#050505] border border-white/5 flex items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsx("div",{className:"w-16 h-16 rounded-2xl bg-violet-500/10 flex items-center justify-center text-violet-400",children:b.jsx(uU,{size:32})}),b.jsxs("div",{children:[b.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"  "}),b.jsx("p",{className:"text-slate-500 text-sm",children:"       ."})]})]}),b.jsxs(xt,{onClick:()=>d("subjects"),className:"!bg-violet-600",children:["  ",b.jsx(Dg,{size:16})]})]})}),b.jsx("div",{className:"flex justify-end",children:b.jsxs(xt,{onClick:e,variant:"danger",className:"shadow-lg shadow-red-900/20",children:[b.jsx(tR,{size:18}),"  "]})})]}),c==="subjects"&&b.jsxs("div",{className:"animate-fade-in",children:[b.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[b.jsx("button",{onClick:()=>d("stats"),className:"p-2 bg-white/5 rounded-full hover:bg-white/10 text-slate-400",children:b.jsx(Dg,{size:20,className:"rotate-180"})}),b.jsx("h2",{className:"text-2xl font-black text-white",children:"  "})]}),b.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:h.length===0?b.jsx("div",{className:"col-span-full text-center py-12 border border-dashed border-white/10 rounded-3xl text-slate-500",children:"    .     ."}):h.map((we,rt)=>b.jsxs("div",{onClick:()=>re(we),className:"glass-panel p-5 rounded-3xl bg-[#080808] border border-white/5 hover:border-violet-500/30 cursor-pointer group transition-all",children:[b.jsxs("div",{className:"flex items-center justify-between mb-4",children:[b.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500/10 flex items-center justify-center text-blue-400 group-hover:scale-110 transition-transform",children:b.jsx(lU,{size:20})}),b.jsx(_T,{size:16,className:"text-slate-600 group-hover:text-white transition-colors rotate-180"})]}),b.jsx("h3",{className:"font-bold text-white truncate",children:we}),b.jsx("p",{className:"text-[10px] text-slate-500 mt-1",children:"  "})]},rt))})]}),c==="subject_details"&&v&&b.jsxs("div",{className:"animate-fade-in h-full",children:[b.jsxs("div",{className:"flex items-center justify-between mb-6",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("button",{onClick:()=>d("subjects"),className:"p-2 bg-white/5 rounded-full hover:bg-white/10 text-slate-400",children:b.jsx(Dg,{size:20,className:"rotate-180"})}),b.jsxs("div",{children:[b.jsx("h2",{className:"text-2xl font-black text-white",children:v}),b.jsxs("p",{className:"text-xs text-slate-500 font-bold",children:[" : ",S.length]})]})]}),b.jsxs("div",{className:"flex gap-2",children:[b.jsxs(xt,{onClick:Bt,className:"!py-2 !px-4 !text-xs !bg-emerald-600",children:[b.jsx(YO,{size:14}),"  "]}),b.jsxs(xt,{onClick:ze,variant:"danger",className:"!py-2 !px-4 !text-xs",children:[b.jsx(mu,{size:14}),"  "]})]})]}),E?b.jsx("div",{className:"flex justify-center py-20",children:b.jsx(ua,{className:"animate-spin text-violet-500"})}):b.jsx("div",{className:"glass-panel p-6 rounded-[2rem] bg-[#050505] border border-white/5 h-[600px] overflow-hidden flex flex-col",children:b.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-3 pr-2",children:S.length===0?b.jsx("p",{className:"text-center text-slate-500 py-10",children:"  ."}):S.map((we,rt)=>b.jsxs("div",{className:"p-4 rounded-2xl bg-white/[0.02] border border-white/5 flex gap-4 group hover:bg-white/[0.04] transition-colors",children:[b.jsxs("div",{className:"flex-1",children:[b.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[b.jsx("span",{className:"text-[10px] bg-white/10 px-2 py-0.5 rounded text-slate-300",children:we.type==="true_false"?"/":""}),b.jsx("span",{className:"text-[10px] bg-white/10 px-2 py-0.5 rounded text-slate-300",children:we.exam_type})]}),b.jsx("p",{className:"text-sm font-bold text-white mb-2",children:we.question}),b.jsx("div",{className:"grid grid-cols-2 gap-2",children:we.options.map((Bs,Gs)=>b.jsx("span",{className:`text-[10px] px-2 py-1 rounded border ${Gs===we.correct_answer_index?"border-emerald-500/30 text-emerald-400 bg-emerald-500/10":"border-white/5 text-slate-500"}`,children:Bs},Gs))})]}),b.jsx("button",{onClick:()=>le(we.id),className:"self-start p-2 text-slate-600 hover:text-red-400 transition-colors",children:b.jsx(mu,{size:16})})]},we.id||rt))})})]})]}):b.jsx("div",{className:"animate-fade-in space-y-8",children:b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[b.jsx("div",{className:"lg:col-span-1 space-y-6",children:b.jsxs("div",{className:"glass-panel p-6 rounded-[2rem] bg-[#050505] border border-white/5",children:[b.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[b.jsx(WN,{className:"text-emerald-400"}),"  "]}),b.jsxs("div",{className:"space-y-4",children:[P?b.jsxs("div",{className:"p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-xl flex items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[b.jsx(eR,{className:"text-emerald-400 shrink-0"}),b.jsx("span",{className:"text-xs font-bold text-white truncate",children:P.name})]}),b.jsx("button",{onClick:()=>{L(null),z(null)},className:"p-1 hover:bg-white/10 rounded-full",children:b.jsx(mu,{size:16,className:"text-red-400"})})]}):b.jsx("div",{className:"border-2 border-dashed border-white/10 rounded-2xl p-6 text-center hover:border-emerald-500/30 transition-colors",children:b.jsx(k5,{onFileSelect:ur,disabled:!1})}),b.jsxs("div",{children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2",children:" "}),b.jsxs("div",{className:"flex bg-white/5 p-1 rounded-xl border border-white/10 mb-3",children:[b.jsxs("button",{onClick:()=>{J("new"),ie("")},className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 ${U==="new"?"bg-violet-600 text-white":"text-slate-400 hover:text-white"}`,children:[b.jsx(lR,{size:14}),"  "]}),b.jsxs("button",{onClick:()=>{J("existing")},className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 ${U==="existing"?"bg-violet-600 text-white":"text-slate-400 hover:text-white"}`,children:[b.jsx(xU,{size:14}),"  "]})]}),U==="new"?b.jsx("input",{type:"text",value:K,onChange:we=>ie(we.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:border-emerald-500 outline-none animate-fade-in",placeholder:":   1"}):b.jsxs("div",{className:"relative animate-fade-in",children:[b.jsxs("select",{value:K,onChange:we=>ie(we.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:border-emerald-500 outline-none appearance-none",children:[b.jsx("option",{value:"",children:"--   --"}),h.map((we,rt)=>b.jsx("option",{value:we,children:we},rt))]}),b.jsx(_T,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 rotate-90 pointer-events-none"})]})]}),b.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[b.jsxs("div",{children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2",children:" "}),b.jsxs("select",{value:oe,onChange:we=>ne(we.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:border-emerald-500 outline-none appearance-none",children:[b.jsx("option",{value:"midterm",children:" (Midterm)"}),b.jsx("option",{value:"final",children:" (Final)"}),b.jsx("option",{value:"quiz",children:" (Quiz)"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2",children:" "}),b.jsx("input",{type:"number",value:ve,onChange:we=>de(Number(we.target.value)),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:border-emerald-500 outline-none",min:"1",max:"100"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2",children:" "}),b.jsxs("div",{className:"flex bg-white/5 p-1 rounded-xl border border-white/10",children:[b.jsx("button",{onClick:()=>j("ar"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${Re==="ar"?"bg-emerald-600 text-white":"text-slate-400 hover:text-white"}`,children:""}),b.jsx("button",{onClick:()=>j("en"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${Re==="en"?"bg-emerald-600 text-white":"text-slate-400 hover:text-white"}`,children:"English"})]})]}),b.jsx(xt,{onClick:ya,disabled:!H||!K||X,fullWidth:!0,className:"!bg-emerald-600 hover:!bg-emerald-500 !py-3",children:X?b.jsxs("div",{className:"flex flex-col items-center",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx(ua,{className:"animate-spin",size:16}),"  ..."]}),ee&&b.jsx("span",{className:"text-[9px] mt-1 text-emerald-100",children:ee})]}):b.jsxs(b.Fragment,{children:[b.jsx(jd,{size:18}),"  "]})})]})]})}),b.jsx("div",{className:"lg:col-span-2",children:b.jsxs("div",{className:"glass-panel p-6 rounded-[2rem] bg-[#050505] border border-white/5 h-full min-h-[500px] flex flex-col",children:[b.jsxs("div",{className:"flex items-center justify-between mb-4",children:[b.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[b.jsx(g0,{className:"text-emerald-400"}),"   (",O.length,")"]}),O.length>0&&b.jsx(xt,{onClick:yc,disabled:se,className:"!py-2 !text-xs !bg-blue-600",children:se?" ...":b.jsxs(b.Fragment,{children:[b.jsx(rR,{size:14}),"   "]})})]}),b.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-4 pr-2 max-h-[600px]",children:O.length===0?b.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500 opacity-50",children:[b.jsx(m0,{size:48,className:"mb-4"}),b.jsx("p",{children:"    "})]}):O.map((we,rt)=>b.jsxs("div",{className:"p-4 rounded-2xl bg-white/5 border border-white/5 relative group",children:[b.jsx("button",{onClick:()=>Hs(rt),className:"absolute top-3 left-3 text-slate-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:b.jsx(mu,{size:16})}),b.jsxs("p",{className:"font-bold text-white mb-2 text-sm",dir:Re==="en"?"ltr":"rtl",children:[b.jsxs("span",{className:"text-emerald-500 mx-2",children:["#",rt+1]}),we.question]}),b.jsx("div",{className:"grid grid-cols-2 gap-2 mb-3",dir:Re==="en"?"ltr":"rtl",children:we.options.map((Bs,Gs)=>b.jsx("div",{className:`text-xs p-2 rounded-lg border ${Gs===we.correct_answer_index?"bg-emerald-500/20 border-emerald-500/30 text-emerald-300":"bg-black/20 border-white/5 text-slate-400"}`,children:Bs},Gs))}),b.jsxs("p",{className:"text-[10px] text-slate-500 bg-black/30 p-2 rounded-lg",dir:Re==="en"?"ltr":"rtl",children:[b.jsx("span",{className:"text-amber-500 font-bold",children:Re==="en"?"Explanation:":":"})," ",we.explanation]})]},rt))})]})})]})}),R&&b.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[b.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>D(!1)}),b.jsxs("div",{className:"glass-panel w-full max-w-sm p-8 rounded-3xl text-center relative animate-lux-scale border border-white/10",children:[b.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20",children:b.jsx(mu,{size:32,className:"text-red-500"})}),b.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"  "}),b.jsxs("p",{className:"text-slate-400 mb-8 text-sm leading-relaxed",children:["   ",b.jsxs("span",{className:"text-white font-bold",children:['"',v,'"']}),"    .      ."]}),b.jsxs("div",{className:"flex gap-3",children:[b.jsx(xt,{onClick:Le,variant:"danger",fullWidth:!0,className:"!py-3",children:" "}),b.jsx(xt,{onClick:()=>D(!1),variant:"secondary",fullWidth:!0,className:"!py-3",children:""})]})]})]})]})]})},eq=s=>{switch(s){case"true_false":return{label:" / ",icon:b.jsx(KN,{size:12}),color:"bg-orange-500/10 text-orange-400 border-orange-500/20"};case"cloze":return{label:" ",icon:b.jsx(lR,{size:12}),color:"bg-purple-500/10 text-purple-400 border-purple-500/20"};case"wh_question":return{label:" ",icon:b.jsx(JN,{size:12}),color:"bg-blue-500/10 text-blue-400 border-blue-500/20"};default:return{label:" ",icon:b.jsx(YU,{size:12}),color:"bg-slate-800/50 text-slate-300 border-slate-700/50"}}},tq=({question:s,selectedOptionIndex:e,onSelectOption:t,showFeedback:n,language:i})=>{const a=eq(s.type),l=i==="en",c=l?"ltr":"rtl",d=l?"text-left":"text-right";return b.jsxs("div",{className:"w-full max-w-3xl mx-auto animate-fade-in-up",dir:c,children:[b.jsxs("div",{className:"glass-panel bg-[#080808]/95 rounded-2xl p-5 md:p-6 relative overflow-hidden border border-white/5 shadow-xl",children:[b.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-2/3 h-0.5 bg-gradient-to-r from-transparent via-violet-500/30 to-transparent blur-sm"}),b.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[10px] font-bold border mb-4 ${a.color}`,dir:"rtl",children:[a.icon,b.jsx("span",{children:a.label})]}),b.jsx("h2",{className:`text-sm md:text-[15px] font-bold text-white leading-relaxed mb-6 ${d} drop-shadow-sm tracking-wide`,children:s.question}),b.jsx("div",{className:"grid grid-cols-1 gap-3",children:s.options.map((h,p)=>{let v="border-white/5 bg-white/[0.02] hover:bg-white/[0.05] hover:border-violet-500/30",x=null,S="text-slate-300";return e===p&&(v="border-violet-500 bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.1)]",S="text-white font-semibold"),n&&(p===s.correctAnswerIndex?(v="border-emerald-500/50 bg-emerald-500/10",S="text-emerald-300 font-bold",x=b.jsx(g0,{className:"text-emerald-500 shrink-0 drop-shadow-[0_0_8px_rgba(16,185,129,0.5)]",size:16})):e===p&&p!==s.correctAnswerIndex?(v="border-red-500/50 bg-red-500/10",S="text-red-300 font-medium",x=b.jsx(WO,{className:"text-red-500 shrink-0",size:16})):(v="border-transparent bg-black/20 opacity-40",S="text-slate-500")),b.jsxs("button",{onClick:()=>!n&&t(p),disabled:n,className:`group w-full ${d} p-3 rounded-xl border transition-all duration-200 flex items-center justify-between gap-3 ${v}`,children:[b.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[b.jsx("div",{className:`shrink-0 w-6 h-6 rounded-md border flex items-center justify-center text-[10px] font-bold transition-all ${e===p?"border-violet-500 text-violet-300 bg-violet-500/20":"border-white/10 text-slate-500 bg-white/5 group-hover:border-violet-500/50 group-hover:text-violet-300"}`,children:String.fromCharCode(65+p)}),b.jsx("span",{className:`text-xs md:text-[13px] leading-relaxed ${S}`,children:h})]}),x]},p)})})]}),n&&b.jsx("div",{className:`mt-4 bg-[#0A0A0A] border border-white/10 p-4 rounded-2xl shadow-lg animate-fade-in ${l?"text-left":"text-right"}`,children:b.jsxs("div",{className:"flex items-start gap-3",children:[b.jsx("div",{className:"mt-0.5 text-emerald-400 shrink-0 p-1.5 bg-emerald-500/10 rounded-full",children:b.jsx(g0,{size:16})}),b.jsxs("div",{children:[b.jsx("p",{className:"font-bold text-sm mb-1 text-emerald-300",children:l?"Explanation":" "}),b.jsx("p",{className:"text-slate-400 text-xs leading-relaxed",children:s.explanation})]})]})})]})},nq=({quiz:s,config:e,onFinish:t,onExit:n})=>{const[i,a]=ae.useState(0),[l,c]=ae.useState(null),[d,h]=ae.useState(!1),[p,v]=ae.useState(0),[x,S]=ae.useState(!1),A=e.questionCount*60,[E,N]=ae.useState(A);ae.useEffect(()=>{const z=setInterval(()=>{N(U=>U<=1?(clearInterval(z),t(p),0):U-1)},1e3);return()=>clearInterval(z)},[p,t]);const R=z=>{const U=Math.floor(z/60),J=z%60;return`${U}:${J.toString().padStart(2,"0")}`},D=()=>{i<s.questions.length-1?(a(z=>z+1),c(null),h(!1)):t(p)},P=()=>{const z=s.questions[i];l===z.correctAnswerIndex&&v(U=>U+1),h(!0)},L=s.questions[i],H=E<60;return b.jsxs("div",{className:"min-h-screen pb-20 relative z-10 pt-24 animate-lux-up",children:[b.jsxs("div",{className:"fixed top-20 left-0 right-0 z-40 bg-[#020617]/80 backdrop-blur-md border-b border-white/5 shadow-lg",children:[b.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-4 flex justify-between items-center",children:[b.jsxs("div",{className:"text-xl font-black text-white font-mono",children:[b.jsx("span",{className:"text-violet-400",children:i+1})," / ",b.jsx("span",{className:"text-slate-500",children:s.questions.length})]}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsxs("div",{className:`px-4 py-2 rounded-xl font-mono font-bold text-lg border transition-colors ${H?"bg-red-500/10 text-red-400 border-red-500/20 animate-pulse":"bg-white/5 text-slate-300 border-white/5"}`,children:[b.jsx(XN,{size:18,className:"inline mr-2"})," ",R(E)]}),b.jsx("button",{onClick:()=>S(!0),className:"p-3 rounded-xl bg-red-500/10 text-red-400 border border-red-500/20 hover:bg-red-500/20 transition-all",children:b.jsx(ny,{size:18})})]})]}),b.jsx("div",{className:"w-full h-1 bg-white/5",children:b.jsx("div",{className:"h-full bg-gradient-to-r from-violet-600 to-fuchsia-600 transition-all duration-500",style:{width:`${(i+1)/s.questions.length*100}%`}})})]}),b.jsxs("div",{className:"max-w-3xl mx-auto px-4 pt-20",children:[b.jsx("div",{className:"animate-lux-scale",children:b.jsx(tq,{question:L,selectedOptionIndex:l,onSelectOption:c,showFeedback:d,language:e.language})},i),b.jsx("div",{className:"mt-8 flex justify-center gap-4",children:d?b.jsx(xt,{onClick:D,variant:"secondary",className:"w-full md:w-2/3 bg-white text-black hover:bg-slate-200 border-none shadow-xl",children:i<s.questions.length-1?" ":"  "}):b.jsx(xt,{onClick:P,disabled:l===null,className:"w-full md:w-2/3 shadow-xl",children:" "})})]}),x&&b.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[b.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>S(!1)}),b.jsxs("div",{className:"glass-panel w-full max-w-sm p-8 rounded-3xl text-center relative animate-lux-scale border border-white/10",children:[b.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20",children:b.jsx(oR,{size:32,className:"text-red-500"})}),b.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"   "}),b.jsx("p",{className:"text-slate-400 mb-8 text-sm leading-relaxed",children:"           ."}),b.jsxs("div",{className:"flex gap-3",children:[b.jsx(xt,{onClick:n,variant:"danger",fullWidth:!0,className:"!py-3",children:" "}),b.jsx(xt,{onClick:()=>S(!1),variant:"secondary",fullWidth:!0,className:"!py-3",children:""})]})]})]})]})},sq=({appState:s,onNavigate:e,onReset:t,onUploadClick:n,isVisible:i})=>i?b.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-[60] animate-lux-up",children:b.jsx("div",{className:"bg-black border-t border-white/5 shadow-[0_-10px_40px_rgba(0,0,0,0.8)] pt-3 pb-6 px-2",children:b.jsxs("div",{className:"max-w-md mx-auto flex items-center justify-around relative",children:[b.jsxs("button",{onClick:()=>t(),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${s===xe.HOME?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[b.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${s===xe.HOME?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:b.jsx(ty,{size:20,strokeWidth:s===xe.HOME?2.5:2})}),b.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${s===xe.HOME?"text-violet-300":"text-slate-600"}`,children:""})]}),b.jsxs("button",{onClick:()=>e(xe.SERVICES),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${s===xe.SERVICES?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[b.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${s===xe.SERVICES?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:b.jsx(vU,{size:20,strokeWidth:s===xe.SERVICES?2.5:2})}),b.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${s===xe.SERVICES?"text-violet-300":"text-slate-600"}`,children:""})]}),b.jsxs("button",{onClick:n,className:"flex flex-col items-center gap-1.5 flex-1 group",children:[b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"absolute inset-0 bg-violet-600 blur-xl opacity-20 group-active:opacity-40"}),b.jsx("div",{className:"relative w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-700 rounded-xl flex items-center justify-center text-white shadow-lg border border-white/10 active:scale-90 transition-all",children:b.jsx(iR,{size:22,strokeWidth:3})})]}),b.jsx("span",{className:"text-[8px] font-black text-violet-400 uppercase tracking-wider",children:" "})]}),b.jsxs("button",{onClick:()=>e(xe.DEVAI),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${s===xe.DEVAI?"text-fuchsia-400":"text-slate-500 hover:text-slate-300"}`,children:[b.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${s===xe.DEVAI?"bg-fuchsia-500/10 shadow-[0_0_15px_rgba(217,70,239,0.2)]":""}`,children:b.jsx(Wp,{size:20,strokeWidth:s===xe.DEVAI?2.5:2})}),b.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${s===xe.DEVAI?"text-fuchsia-300":"text-slate-600"}`,children:""})]}),b.jsxs("button",{onClick:()=>e(xe.PROFILE),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${s===xe.PROFILE?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[b.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${s===xe.PROFILE?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:b.jsx(aw,{size:20,strokeWidth:s===xe.PROFILE?2.5:2})}),b.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${s===xe.PROFILE?"text-violet-300":"text-slate-600"}`,children:""})]})]})})}):null,iq=Hd.memo(({appState:s,user:e,onReset:t,onNavigate:n,onAuthOpen:i,onLogout:a,onProfile:l,isMobileMenuOpen:c,setIsMobileMenuOpen:d})=>{var v,x;const h=s===xe.QUIZ||s===xe.PROCESSING,p=((v=e==null?void 0:e.user_metadata)==null?void 0:v.role)==="admin";return b.jsxs("nav",{className:"fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-black/50 backdrop-blur-md border-b border-white/5 animate-lux-up w-full",children:[b.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 h-16 sm:h-20 flex items-center justify-between",children:[b.jsxs("div",{className:`flex items-center gap-3 sm:gap-5 group ${h?"cursor-not-allowed opacity-50":"cursor-pointer"}`,onClick:()=>!h&&t(),children:[b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"absolute inset-0 bg-violet-500 blur-xl opacity-40 group-hover:opacity-70 transition-opacity"}),b.jsx("div",{className:"relative w-12 h-12 sm:w-16 sm:h-16 bg-[#0f0f0f] border border-white/10 rounded-xl sm:rounded-2xl flex items-center justify-center shadow-2xl transition-transform group-hover:scale-110",children:p?b.jsx(x_,{className:"text-emerald-400 w-7 h-7 sm:w-10 sm:h-10"}):b.jsx(ey,{className:"text-violet-400 w-7 h-7 sm:w-10 sm:h-10"})})]}),b.jsxs("div",{className:"flex flex-col",children:[b.jsx("span",{className:"text-3xl sm:text-5xl font-black text-white tracking-tighter leading-none drop-shadow-[0_0_15px_rgba(139,92,246,0.3)]",children:""}),b.jsx("span",{className:"text-[8px] sm:text-[10px] text-violet-400/70 font-bold tracking-[0.3em] hidden sm:block uppercase",children:"IDRAAK"})]})]}),!h&&b.jsxs("div",{className:"hidden lg:flex flex-1 items-center justify-center gap-10 text-sm font-medium text-slate-400",children:[b.jsx("button",{onClick:()=>t(),className:`hover:text-white transition-colors relative py-2 ${s===xe.HOME?"text-white":""}`,children:""}),b.jsx("button",{onClick:()=>n(xe.SERVICES),className:`hover:text-white transition-colors relative py-2 ${s===xe.SERVICES?"text-white":""}`,children:" "}),b.jsx("button",{onClick:()=>n(xe.DEVAI),className:`hover:text-white transition-colors relative py-2 ${s===xe.DEVAI?"text-white":""}`,children:""}),b.jsx("button",{onClick:()=>n(xe.ABOUT),className:`hover:text-white transition-colors relative py-2 ${s===xe.ABOUT?"text-white":""}`,children:" "})]}),b.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:h?b.jsx("div",{className:"w-8"}):e?b.jsx("div",{className:"hidden md:flex items-center gap-3",children:b.jsxs("button",{onClick:l,className:`flex items-center gap-2 px-4 py-2 rounded-xl border transition-all ${s===xe.PROFILE?p?"bg-emerald-500 text-black border-emerald-600 font-bold":"bg-amber-400 text-slate-900 border-amber-500 font-bold":"bg-white/5 text-slate-300 border-white/10 hover:bg-white/10 hover:text-white"}`,children:[p?b.jsx(x_,{size:16}):b.jsx(aw,{size:16}),b.jsx("span",{className:"text-sm",children:((x=e.user_metadata)==null?void 0:x.full_name)||" "})]})}):b.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[b.jsx("button",{onClick:i,className:"text-white hover:text-violet-300 transition-colors font-medium text-sm",children:" "}),b.jsx("button",{onClick:i,className:"px-5 py-2 rounded-full bg-white text-black font-bold text-xs hover:bg-slate-200 transition-colors",children:" "})]})}),!h&&b.jsx("button",{className:"lg:hidden p-2 text-slate-300 hover:bg-white/10 rounded-lg",onClick:()=>d(!c),children:c?b.jsx(ny,{size:24}):b.jsx(PU,{size:24})})]}),c&&!h&&b.jsxs("div",{className:"md:hidden absolute top-16 sm:top-20 left-0 right-0 bg-[#050505] border-b border-white/10 p-6 flex flex-col gap-4 animate-lux-up shadow-2xl",children:[b.jsx("button",{onClick:()=>{t(),d(!1)},className:"text-right font-bold text-slate-300 hover:text-white py-2",children:""}),b.jsx("button",{onClick:()=>{n(xe.SERVICES),d(!1)},className:"text-right font-bold text-slate-300 hover:text-white py-2",children:" "}),b.jsx("button",{onClick:()=>{n(xe.DEVAI),d(!1)},className:"text-right font-bold text-slate-300 hover:text-white py-2",children:""}),b.jsx("button",{onClick:()=>{n(xe.ABOUT),d(!1)},className:"text-right font-bold text-slate-300 hover:text-white py-2",children:" "}),e?b.jsxs(b.Fragment,{children:[b.jsx("button",{onClick:()=>{l(),d(!1)},className:`text-right font-bold py-2 ${p?"text-emerald-400":"text-amber-300"}`,children:p?" ":" "}),b.jsx("button",{onClick:()=>{a(),d(!1)},className:"text-right font-bold text-red-400 hover:text-red-300 py-2",children:" "})]}):b.jsx("button",{onClick:()=>{i(),d(!1)},className:"text-right font-bold text-violet-300 hover:text-violet-200 py-2",children:" "})]})]})});function rq(){var Ce;const[s,e]=ae.useState(xe.HOME),[t,n]=ae.useState(null),[i,a]=ae.useState(0),[l,c]=ae.useState(""),[d,h]=ae.useState(!1),[p,v]=ae.useState(null),[x,S]=ae.useState(!1),[A,E]=ae.useState([]),[N,R]=ae.useState(!1),[D,P]=ae.useState(null),[L,H]=ae.useState([]),[z,U]=ae.useState(!0),[J,K]=ae.useState({language:"ar",questionCount:15,selectedSubject:"",examType:"midterm"}),[ie,oe]=ae.useState(!1),ne=((Ce=p==null?void 0:p.user_metadata)==null?void 0:Ce.role)==="admin",ve=async re=>{var ze,Le,Bt;if(!p)return;const le={user_id:p.id,quiz_title:`: ${re}`,score:0,total_questions:0,player_name:((ze=p.user_metadata)==null?void 0:ze.full_name)||" ",player_avatar:((Le=p.user_metadata)==null?void 0:Le.avatar)||"Felix"};await Nt.from("quiz_history").insert([le]),((Bt=p.app_metadata)==null?void 0:Bt.provider)!=="guest"&&Re(p.id,!1)},de=ae.useCallback(re=>{if(re===s){window.scrollTo({top:0,left:0,behavior:"smooth"});return}if(re===xe.PROFILE&&!p){P(xe.PROFILE),S(!0);return}window.history.pushState({appState:re},""),e(re),window.scrollTo({top:0,left:0,behavior:"smooth"})},[s,p]);ae.useEffect(()=>{const re=le=>{le.state&&le.state.appState?e(le.state.appState):e(xe.HOME)};return window.addEventListener("popstate",re),window.history.replaceState({appState:xe.HOME},""),()=>window.history.state&&window.removeEventListener("popstate",re)},[]),ae.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[s]),ae.useEffect(()=>{(async()=>{const{data:{session:ze}}=await Nt.auth.getSession();if(ze!=null&&ze.user)v(ze.user),Re(ze.user.id,!1);else{const Le=localStorage.getItem("guest_user");if(Le){const Bt=JSON.parse(Le);v(Bt),Re(Bt.id,!0)}}})();const{data:{subscription:le}}=Nt.auth.onAuthStateChange((ze,Le)=>{Le!=null&&Le.user&&(v(Le.user),Re(Le.user.id,!1))});return()=>le.unsubscribe()},[]),ae.useEffect(()=>{(async()=>{U(!0);const le=await eM();H(le),U(!1)})()},[s]);const Re=async(re,le)=>{if(le)E(JSON.parse(localStorage.getItem("guest_history")||"[]"));else{const{data:ze,error:Le}=await Nt.from("quiz_history").select("*").eq("user_id",re).order("created_at",{ascending:!1});ze&&!Le&&E(ze)}},j=async re=>{var Bt,ur,ya;if(!p||!t)return;const le={quiz_title:t.title,score:re,total_questions:t.questions.length,created_at:new Date().toISOString()},ze=((Bt=p.app_metadata)==null?void 0:Bt.provider)==="guest",Le={user_id:p.id,quiz_title:le.quiz_title,score:le.score,total_questions:le.total_questions,player_name:((ur=p.user_metadata)==null?void 0:ur.full_name)||" ",player_avatar:((ya=p.user_metadata)==null?void 0:ya.avatar)||"Felix"};if(await Nt.from("quiz_history").insert([Le]),ze){const yc=JSON.parse(localStorage.getItem("guest_history")||"[]"),Hs=[le,...yc];localStorage.setItem("guest_history",JSON.stringify(Hs)),E(Hs)}else Re(p.id,!1)},X=async()=>{R(!0),h(!1),setTimeout(async()=>{var re;((re=p==null?void 0:p.app_metadata)==null?void 0:re.provider)==="guest"?localStorage.removeItem("guest_user"):await Nt.auth.signOut(),v(null),E([]),de(xe.HOME),R(!1)},1500)},me=async re=>{var ze;if(((ze=p.app_metadata)==null?void 0:ze.provider)==="guest"){const Le={...p,user_metadata:re};localStorage.setItem("guest_user",JSON.stringify(Le)),v(Le),await Nt.from("quiz_history").update({player_name:re.full_name,player_avatar:re.avatar}).eq("user_id",p.id)}else{const{data:Le,error:Bt}=await Nt.auth.updateUser({data:re});Le.user&&!Bt&&(v(Le.user),await Nt.from("quiz_history").update({player_name:re.full_name,player_avatar:re.avatar}).eq("user_id",Le.user.id))}},ee=re=>{K({...J,selectedSubject:re}),oe(!0)},ue=async()=>{oe(!1),e(xe.PROCESSING);try{const re=await KG(J.selectedSubject,J.questionCount,J.examType),le={title:`: ${J.selectedSubject}`,questions:re};n(le),e(xe.QUIZ)}catch(re){c(re.message||"    "),e(xe.ERROR)}},O=re=>{a(re),e(xe.RESULT),j(re)},$=()=>{s===xe.HOME?window.scrollTo({top:0,left:0,behavior:"smooth"}):de(xe.HOME),n(null),a(0),c(""),h(!1),oe(!1),K(re=>({...re,selectedSubject:""}))},se=()=>b.jsxs("div",{className:"pt-24 sm:pt-32 pb-20 relative z-10 flex flex-col items-center min-h-screen animate-lux-up overflow-hidden w-full",children:[b.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[60%] w-[350px] sm:w-[500px] md:w-[800px] h-[350px] sm:h-[500px] md:h-[800px] bg-violet-600/10 rounded-full blur-[60px] md:blur-[120px] pointer-events-none z-[-1]"}),b.jsxs("div",{className:"max-w-4xl w-full px-4 text-center mb-10 sm:mb-16",children:[b.jsx("h1",{className:"text-8xl sm:text-9xl md:text-[10rem] font-black mb-6 sm:mb-8 leading-tight tracking-tighter drop-shadow-[0_0_30px_rgba(139,92,246,0.35)] flex flex-wrap justify-center items-center gap-x-4 sm:gap-x-6",children:b.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-500 to-white animate-pulse",children:""})}),b.jsx("p",{className:"text-xl sm:text-lg md:text-xl text-slate-400 max-w-2xl mx-auto mb-8 sm:mb-10 leading-relaxed px-4 font-medium",children:"    .             ."})]}),b.jsxs("div",{id:"subjects-section",className:"w-full max-w-6xl px-4 md:px-6 mb-16",children:[b.jsxs("div",{className:"flex items-center justify-center gap-2 mb-8",children:[b.jsx(m0,{size:24,className:"text-violet-400"}),b.jsx("h2",{className:"text-2xl font-black text-white",children:"  "})]}),z?b.jsx("div",{className:"flex justify-center p-12",children:b.jsx(ua,{className:"animate-spin text-violet-500 w-10 h-10"})}):L.length===0?b.jsxs("div",{className:"text-center p-8 border border-dashed border-white/10 rounded-2xl bg-white/5",children:[b.jsx("p",{className:"text-slate-500 font-bold",children:"        ."}),b.jsx("p",{className:"text-xs text-slate-600 mt-2",children:"    ."})]}):b.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:L.map((re,le)=>b.jsxs("div",{onClick:()=>ee(re),className:"group cursor-pointer glass-panel p-6 rounded-3xl bg-[#080808] border border-white/5 hover:border-violet-500/30 transition-all flex items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsx("div",{className:"w-12 h-12 rounded-xl bg-violet-500/10 flex items-center justify-center text-violet-400 group-hover:scale-110 transition-transform",children:b.jsx(m0,{size:20})}),b.jsx("h3",{className:"text-lg font-bold text-white",children:re})]}),b.jsx("div",{className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-slate-400 group-hover:bg-violet-500 group-hover:text-white transition-all",children:b.jsx(xf,{size:16})})]},le))})]}),b.jsx(S5,{}),b.jsx(A5,{})]}),ce=()=>ne?b.jsx(ZG,{user:p,onLogout:X,onNavigate:de}):b.jsx(R5,{user:p,quizHistory:A,onLogout:X,onSaveProfile:me,onNavigate:de});return b.jsxs("div",{className:"min-h-screen text-slate-100 font-sans selection:bg-violet-500/30 selection:text-violet-200 overflow-x-hidden w-full relative",dir:"rtl",children:[b.jsx(iq,{appState:s,user:p,onReset:$,onNavigate:de,onAuthOpen:()=>S(!0),onLogout:X,onProfile:()=>de(xe.PROFILE),isMobileMenuOpen:d,setIsMobileMenuOpen:h}),b.jsxs("main",{className:"w-full overflow-x-hidden relative flex flex-col",children:[s===xe.HOME&&se(),s===xe.SERVICES&&b.jsx(E5,{onNavigate:de,onLogActivity:ve}),s===xe.DEVAI&&b.jsx(T5,{onNavigate:de}),s===xe.ABOUT&&b.jsx(N5,{onNavigate:de}),s===xe.PROFILE&&ce(),s===xe.QUIZ&&t&&b.jsx(nq,{quiz:t,config:J,onFinish:O,onExit:$}),s===xe.PROCESSING&&b.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen px-6 text-center animate-lux-scale w-full",children:[b.jsx(ua,{className:"w-16 h-16 sm:w-24 sm:h-24 text-violet-500 animate-spin mb-8"}),b.jsx("h2",{className:"text-2xl sm:text-3xl font-black text-white",children:"  ..."}),b.jsx("p",{className:"text-slate-500 mt-2",children:"     "})]}),s===xe.RESULT&&b.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 animate-lux-up w-full",children:b.jsxs("div",{className:"glass-panel p-8 sm:p-10 rounded-[2.5rem] sm:rounded-[3rem] text-center max-w-sm w-full border-white/10 bg-[#080808] relative overflow-hidden",children:[b.jsx(y0,{size:64,className:"text-yellow-400 mx-auto mb-6 sm:w-20 sm:h-20 drop-shadow-[0_0_15px_rgba(250,204,21,0.4)]"}),b.jsx("h2",{className:"text-2xl sm:text-3xl font-black mb-1 text-white",children:" "}),b.jsx("div",{className:"relative inline-block mb-10 mt-6",children:b.jsxs("p",{className:"text-5xl sm:text-7xl font-black text-white",children:[Math.round(i/t.questions.length*100),b.jsx("span",{className:"text-xl sm:text-2xl text-violet-400",children:"%"})]})}),b.jsxs("div",{className:"flex gap-3",children:[b.jsx(xt,{onClick:$,fullWidth:!0,children:""}),b.jsx(xt,{onClick:()=>de(xe.PROFILE),variant:"secondary",fullWidth:!0,children:""})]})]})}),s===xe.ERROR&&b.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-center p-6 animate-lux-up w-full",children:[b.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-2xl flex items-center justify-center mb-6 border border-red-500/20",children:b.jsx(oR,{size:32,className:"text-red-500"})}),b.jsx("h3",{className:"text-xl sm:text-2xl font-black text-white mb-2",children:"  "}),b.jsx("p",{className:"text-slate-500 mb-8 max-w-xs mx-auto text-xs sm:text-sm",children:l}),b.jsx(xt,{onClick:$,variant:"outline",className:"px-8 text-sm",children:" "})]})]}),b.jsx(sq,{appState:s,onNavigate:de,onReset:$,onUploadClick:()=>de(xe.HOME),isVisible:s!==xe.QUIZ&&s!==xe.PROCESSING}),b.jsx(x5,{isOpen:x,onClose:()=>{S(!1),P(null)},onSuccess:re=>{var le;v(re),Re(re.id,((le=re.app_metadata)==null?void 0:le.provider)==="guest"),D&&(de(D),P(null))}}),ie&&b.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[b.jsx("div",{className:"absolute inset-0 bg-black/85 backdrop-blur-lg",onClick:()=>oe(!1)}),b.jsxs("div",{className:"glass-panel w-full max-w-md bg-[#050505] rounded-[2.5rem] p-8 relative animate-lux-scale border border-white/10",children:[b.jsx("h3",{className:"text-2xl font-black text-white mb-6 text-center",children:" "}),b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"bg-white/5 p-4 rounded-xl",children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2",children:" "}),b.jsx("p",{className:"text-lg font-black text-white",children:J.selectedSubject})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2",children:" "}),b.jsxs("select",{value:J.examType,onChange:re=>K({...J,examType:re.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white outline-none",children:[b.jsx("option",{value:"midterm",children:" (Midterm)"}),b.jsx("option",{value:"final",children:" (Final)"}),b.jsx("option",{value:"quiz",children:" (Quiz)"}),b.jsx("option",{value:"all",children:" (All)"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-xs font-bold text-slate-400 block mb-2",children:" "}),b.jsx("div",{className:"grid grid-cols-3 gap-3",children:[5,15,30].map(re=>b.jsx("button",{onClick:()=>K({...J,questionCount:re}),className:`py-3 rounded-xl font-black text-base border transition-all ${J.questionCount===re?"bg-violet-600 border-violet-500 text-white shadow-lg shadow-violet-500/20":"bg-transparent border-white/10 text-slate-500 hover:bg-white/5"}`,children:re},re))})]}),b.jsx(xt,{onClick:ue,fullWidth:!0,className:"!py-4 shadow-xl !bg-emerald-600 hover:!bg-emerald-500",children:"  "})]})]})]})]})}const tM=document.getElementById("root");if(!tM)throw new Error("Could not find root element to mount to");const aq=LD.createRoot(tM);aq.render(b.jsx(Hd.StrictMode,{children:b.jsx(rq,{})}));const r_=document.getElementById("splash-screen");r_&&setTimeout(()=>{r_.classList.add("hidden"),setTimeout(()=>{r_.remove()},600)},1200);

var iD=Object.defineProperty;var xT=i=>{throw TypeError(i)};var sD=(i,e,t)=>e in i?iD(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Re=(i,e,t)=>sD(i,typeof e!="symbol"?e+"":e,t),vb=(i,e,t)=>e.has(i)||xT("Cannot "+t);var g=(i,e,t)=>(vb(i,e,"read from private field"),t?t.call(i):e.get(i)),M=(i,e,t)=>e.has(i)?xT("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),C=(i,e,t,n)=>(vb(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),k=(i,e,t)=>(vb(i,e,"access private method"),t);var Un=(i,e,t,n)=>({set _(s){C(i,e,s,t)},get _(){return g(i,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function Ow(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function rD(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var e=i.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var s=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return i[n]}})}),t}var bb={exports:{}},Eh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ST;function aD(){if(ST)return Eh;ST=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var c in s)c!=="key"&&(a[c]=s[c])}else a=s;return s=a.ref,{$$typeof:i,type:n,key:l,ref:s!==void 0?s:null,props:a}}return Eh.Fragment=e,Eh.jsx=t,Eh.jsxs=t,Eh}var AT;function oD(){return AT||(AT=1,bb.exports=aD()),bb.exports}var S=oD(),_b={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ET;function lD(){if(ET)return Le;ET=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),_=Symbol.iterator;function x(U){return U===null||typeof U!="object"?null:(U=_&&U[_]||U["@@iterator"],typeof U=="function"?U:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,R={};function N(U,K,ie){this.props=U,this.context=K,this.refs=R,this.updater=ie||A}N.prototype.isReactComponent={},N.prototype.setState=function(U,K){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,K,"setState")},N.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function D(){}D.prototype=N.prototype;function P(U,K,ie){this.props=U,this.context=K,this.refs=R,this.updater=ie||A}var L=P.prototype=new D;L.constructor=P,E(L,N.prototype),L.isPureReactComponent=!0;var B=Array.isArray;function H(){}var O={H:null,A:null,T:null,S:null},X=Object.prototype.hasOwnProperty;function Y(U,K,ie){var oe=ie.ref;return{$$typeof:i,type:U,key:K,ref:oe!==void 0?oe:null,props:ie}}function se(U,K){return Y(U.type,K,U.props)}function re(U){return typeof U=="object"&&U!==null&&U.$$typeof===i}function ne(U){var K={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(ie){return K[ie]})}var be=/\/+/g;function ye(U,K){return typeof U=="object"&&U!==null&&U.key!=null?ne(""+U.key):K.toString(36)}function ze(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(H,H):(U.status="pending",U.then(function(K){U.status==="pending"&&(U.status="fulfilled",U.value=K)},function(K){U.status==="pending"&&(U.status="rejected",U.reason=K)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function G(U,K,ie,oe,Ie){var Ee=typeof U;(Ee==="undefined"||Ee==="boolean")&&(U=null);var Se=!1;if(U===null)Se=!0;else switch(Ee){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(U.$$typeof){case i:case e:Se=!0;break;case p:return Se=U._init,G(Se(U._payload),K,ie,oe,Ie)}}if(Se)return Ie=Ie(U),Se=oe===""?"."+ye(U,0):oe,B(Ie)?(ie="",Se!=null&&(ie=Se.replace(be,"$&/")+"/"),G(Ie,K,ie,"",function(_o){return _o})):Ie!=null&&(re(Ie)&&(Ie=se(Ie,ie+(Ie.key==null||U&&U.key===Ie.key?"":(""+Ie.key).replace(be,"$&/")+"/")+Se)),K.push(Ie)),1;Se=0;var Nt=oe===""?".":oe+":";if(B(U))for(var _t=0;_t<U.length;_t++)oe=U[_t],Ee=Nt+ye(oe,_t),Se+=G(oe,K,ie,Ee,Ie);else if(_t=x(U),typeof _t=="function")for(U=_t.call(U),_t=0;!(oe=U.next()).done;)oe=oe.value,Ee=Nt+ye(oe,_t++),Se+=G(oe,K,ie,Ee,Ie);else if(Ee==="object"){if(typeof U.then=="function")return G(ze(U),K,ie,oe,Ie);throw K=String(U),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return Se}function W(U,K,ie){if(U==null)return U;var oe=[],Ie=0;return G(U,oe,"","",function(Ee){return K.call(ie,Ee,Ie++)}),oe}function he(U){if(U._status===-1){var K=U._result;K=K(),K.then(function(ie){(U._status===0||U._status===-1)&&(U._status=1,U._result=ie)},function(ie){(U._status===0||U._status===-1)&&(U._status=2,U._result=ie)}),U._status===-1&&(U._status=0,U._result=K)}if(U._status===1)return U._result.default;throw U._result}var te=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},le={map:W,forEach:function(U,K,ie){W(U,function(){K.apply(this,arguments)},ie)},count:function(U){var K=0;return W(U,function(){K++}),K},toArray:function(U){return W(U,function(K){return K})||[]},only:function(U){if(!re(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return Le.Activity=v,Le.Children=le,Le.Component=N,Le.Fragment=t,Le.Profiler=s,Le.PureComponent=P,Le.StrictMode=n,Le.Suspense=d,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Le.__COMPILER_RUNTIME={__proto__:null,c:function(U){return O.H.useMemoCache(U)}},Le.cache=function(U){return function(){return U.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(U,K,ie){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var oe=E({},U.props),Ie=U.key;if(K!=null)for(Ee in K.key!==void 0&&(Ie=""+K.key),K)!X.call(K,Ee)||Ee==="key"||Ee==="__self"||Ee==="__source"||Ee==="ref"&&K.ref===void 0||(oe[Ee]=K[Ee]);var Ee=arguments.length-2;if(Ee===1)oe.children=ie;else if(1<Ee){for(var Se=Array(Ee),Nt=0;Nt<Ee;Nt++)Se[Nt]=arguments[Nt+2];oe.children=Se}return Y(U.type,Ie,oe)},Le.createContext=function(U){return U={$$typeof:l,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:a,_context:U},U},Le.createElement=function(U,K,ie){var oe,Ie={},Ee=null;if(K!=null)for(oe in K.key!==void 0&&(Ee=""+K.key),K)X.call(K,oe)&&oe!=="key"&&oe!=="__self"&&oe!=="__source"&&(Ie[oe]=K[oe]);var Se=arguments.length-2;if(Se===1)Ie.children=ie;else if(1<Se){for(var Nt=Array(Se),_t=0;_t<Se;_t++)Nt[_t]=arguments[_t+2];Ie.children=Nt}if(U&&U.defaultProps)for(oe in Se=U.defaultProps,Se)Ie[oe]===void 0&&(Ie[oe]=Se[oe]);return Y(U,Ee,Ie)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(U){return{$$typeof:c,render:U}},Le.isValidElement=re,Le.lazy=function(U){return{$$typeof:p,_payload:{_status:-1,_result:U},_init:he}},Le.memo=function(U,K){return{$$typeof:h,type:U,compare:K===void 0?null:K}},Le.startTransition=function(U){var K=O.T,ie={};O.T=ie;try{var oe=U(),Ie=O.S;Ie!==null&&Ie(ie,oe),typeof oe=="object"&&oe!==null&&typeof oe.then=="function"&&oe.then(H,te)}catch(Ee){te(Ee)}finally{K!==null&&ie.types!==null&&(K.types=ie.types),O.T=K}},Le.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Le.use=function(U){return O.H.use(U)},Le.useActionState=function(U,K,ie){return O.H.useActionState(U,K,ie)},Le.useCallback=function(U,K){return O.H.useCallback(U,K)},Le.useContext=function(U){return O.H.useContext(U)},Le.useDebugValue=function(){},Le.useDeferredValue=function(U,K){return O.H.useDeferredValue(U,K)},Le.useEffect=function(U,K){return O.H.useEffect(U,K)},Le.useEffectEvent=function(U){return O.H.useEffectEvent(U)},Le.useId=function(){return O.H.useId()},Le.useImperativeHandle=function(U,K,ie){return O.H.useImperativeHandle(U,K,ie)},Le.useInsertionEffect=function(U,K){return O.H.useInsertionEffect(U,K)},Le.useLayoutEffect=function(U,K){return O.H.useLayoutEffect(U,K)},Le.useMemo=function(U,K){return O.H.useMemo(U,K)},Le.useOptimistic=function(U,K){return O.H.useOptimistic(U,K)},Le.useReducer=function(U,K,ie){return O.H.useReducer(U,K,ie)},Le.useRef=function(U){return O.H.useRef(U)},Le.useState=function(U){return O.H.useState(U)},Le.useSyncExternalStore=function(U,K,ie){return O.H.useSyncExternalStore(U,K,ie)},Le.useTransition=function(){return O.H.useTransition()},Le.version="19.2.3",Le}var TT;function Uw(){return TT||(TT=1,_b.exports=lD()),_b.exports}var ue=Uw();const L0=Ow(ue);var wb={exports:{}},Th={},xb={exports:{}},Sb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CT;function cD(){return CT||(CT=1,(function(i){function e(G,W){var he=G.length;G.push(W);e:for(;0<he;){var te=he-1>>>1,le=G[te];if(0<s(le,W))G[te]=W,G[he]=le,he=te;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var W=G[0],he=G.pop();if(he!==W){G[0]=he;e:for(var te=0,le=G.length,U=le>>>1;te<U;){var K=2*(te+1)-1,ie=G[K],oe=K+1,Ie=G[oe];if(0>s(ie,he))oe<le&&0>s(Ie,ie)?(G[te]=Ie,G[oe]=he,te=oe):(G[te]=ie,G[K]=he,te=K);else if(oe<le&&0>s(Ie,he))G[te]=Ie,G[oe]=he,te=oe;else break e}}return W}function s(G,W){var he=G.sortIndex-W.sortIndex;return he!==0?he:G.id-W.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;i.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();i.unstable_now=function(){return l.now()-c}}var d=[],h=[],p=1,v=null,_=3,x=!1,A=!1,E=!1,R=!1,N=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function L(G){for(var W=t(h);W!==null;){if(W.callback===null)n(h);else if(W.startTime<=G)n(h),W.sortIndex=W.expirationTime,e(d,W);else break;W=t(h)}}function B(G){if(E=!1,L(G),!A)if(t(d)!==null)A=!0,H||(H=!0,ne());else{var W=t(h);W!==null&&ze(B,W.startTime-G)}}var H=!1,O=-1,X=5,Y=-1;function se(){return R?!0:!(i.unstable_now()-Y<X)}function re(){if(R=!1,H){var G=i.unstable_now();Y=G;var W=!0;try{e:{A=!1,E&&(E=!1,D(O),O=-1),x=!0;var he=_;try{t:{for(L(G),v=t(d);v!==null&&!(v.expirationTime>G&&se());){var te=v.callback;if(typeof te=="function"){v.callback=null,_=v.priorityLevel;var le=te(v.expirationTime<=G);if(G=i.unstable_now(),typeof le=="function"){v.callback=le,L(G),W=!0;break t}v===t(d)&&n(d),L(G)}else n(d);v=t(d)}if(v!==null)W=!0;else{var U=t(h);U!==null&&ze(B,U.startTime-G),W=!1}}break e}finally{v=null,_=he,x=!1}W=void 0}}finally{W?ne():H=!1}}}var ne;if(typeof P=="function")ne=function(){P(re)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,ye=be.port2;be.port1.onmessage=re,ne=function(){ye.postMessage(null)}}else ne=function(){N(re,0)};function ze(G,W){O=N(function(){G(i.unstable_now())},W)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(G){G.callback=null},i.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<G?Math.floor(1e3/G):5},i.unstable_getCurrentPriorityLevel=function(){return _},i.unstable_next=function(G){switch(_){case 1:case 2:case 3:var W=3;break;default:W=_}var he=_;_=W;try{return G()}finally{_=he}},i.unstable_requestPaint=function(){R=!0},i.unstable_runWithPriority=function(G,W){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var he=_;_=G;try{return W()}finally{_=he}},i.unstable_scheduleCallback=function(G,W,he){var te=i.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?te+he:te):he=te,G){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=he+le,G={id:p++,callback:W,priorityLevel:G,startTime:he,expirationTime:le,sortIndex:-1},he>te?(G.sortIndex=he,e(h,G),t(d)===null&&G===t(h)&&(E?(D(O),O=-1):E=!0,ze(B,he-te))):(G.sortIndex=le,e(d,G),A||x||(A=!0,H||(H=!0,ne()))),G},i.unstable_shouldYield=se,i.unstable_wrapCallback=function(G){var W=_;return function(){var he=_;_=W;try{return G.apply(this,arguments)}finally{_=he}}}})(Sb)),Sb}var RT;function uD(){return RT||(RT=1,xb.exports=cD()),xb.exports}var Ab={exports:{}},En={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NT;function dD(){if(NT)return En;NT=1;var i=Uw();function e(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(d,h,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:d,containerInfo:h,implementation:p}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return En.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,En.createPortal=function(d,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return a(d,h,null,p)},En.flushSync=function(d){var h=l.T,p=n.p;try{if(l.T=null,n.p=2,d)return d()}finally{l.T=h,n.p=p,n.d.f()}},En.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(d,h))},En.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},En.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var p=h.as,v=c(p,h.crossOrigin),_=typeof h.integrity=="string"?h.integrity:void 0,x=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?n.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:x}):p==="script"&&n.d.X(d,{crossOrigin:v,integrity:_,fetchPriority:x,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},En.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=c(h.as,h.crossOrigin);n.d.M(d,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(d)},En.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,v=c(p,h.crossOrigin);n.d.L(d,p,{crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},En.preloadModule=function(d,h){if(typeof d=="string")if(h){var p=c(h.as,h.crossOrigin);n.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(d)},En.requestFormReset=function(d){n.d.r(d)},En.unstable_batchedUpdates=function(d,h){return d(h)},En.useFormState=function(d,h,p){return l.H.useFormState(d,h,p)},En.useFormStatus=function(){return l.H.useHostTransitionStatus()},En.version="19.2.3",En}var MT;function uR(){if(MT)return Ab.exports;MT=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Ab.exports=dD(),Ab.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kT;function hD(){if(kT)return Th;kT=1;var i=uD(),e=Uw(),t=uR();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,u=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(u=o.return),r=o.return;while(r)}return o.tag===3?u:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function c(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function d(r){if(a(r)!==r)throw Error(n(188))}function h(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(n(188));return o!==r?null:r}for(var u=r,f=o;;){var b=u.return;if(b===null)break;var w=b.alternate;if(w===null){if(f=b.return,f!==null){u=f;continue}break}if(b.child===w.child){for(w=b.child;w;){if(w===u)return d(b),r;if(w===f)return d(b),o;w=w.sibling}throw Error(n(188))}if(u.return!==f.return)u=b,f=w;else{for(var T=!1,I=b.child;I;){if(I===u){T=!0,u=b,f=w;break}if(I===f){T=!0,f=b,u=w;break}I=I.sibling}if(!T){for(I=w.child;I;){if(I===u){T=!0,u=w,f=b;break}if(I===f){T=!0,f=w,u=b;break}I=I.sibling}if(!T)throw Error(n(189))}}if(u.alternate!==f)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?r:o}function p(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=p(r),o!==null)return o;r=r.sibling}return null}var v=Object.assign,_=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),P=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),se=Symbol.for("react.memo_cache_sentinel"),re=Symbol.iterator;function ne(r){return r===null||typeof r!="object"?null:(r=re&&r[re]||r["@@iterator"],typeof r=="function"?r:null)}var be=Symbol.for("react.client.reference");function ye(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===be?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case E:return"Fragment";case N:return"Profiler";case R:return"StrictMode";case B:return"Suspense";case H:return"SuspenseList";case Y:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case A:return"Portal";case P:return r.displayName||"Context";case D:return(r._context.displayName||"Context")+".Consumer";case L:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case O:return o=r.displayName||null,o!==null?o:ye(r.type)||"Memo";case X:o=r._payload,r=r._init;try{return ye(r(o))}catch{}}return null}var ze=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he={pending:!1,data:null,method:null,action:null},te=[],le=-1;function U(r){return{current:r}}function K(r){0>le||(r.current=te[le],te[le]=null,le--)}function ie(r,o){le++,te[le]=r.current,r.current=o}var oe=U(null),Ie=U(null),Ee=U(null),Se=U(null);function Nt(r,o){switch(ie(Ee,o),ie(Ie,r),ie(oe,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?$E(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=$E(o),r=jE(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}K(oe),ie(oe,r)}function _t(){K(oe),K(Ie),K(Ee)}function _o(r){r.memoizedState!==null&&ie(Se,r);var o=oe.current,u=jE(o,r.type);o!==u&&(ie(Ie,r),ie(oe,u))}function Bp(r){Ie.current===r&&(K(oe),K(Ie)),Se.current===r&&(K(Se),wh._currentValue=he)}var ey,wx;function wo(r){if(ey===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);ey=o&&o[1]||"",wx=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ey+r+wx}var ty=!1;function ny(r,o){if(!r||ty)return"";ty=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var ee=function(){throw Error()};if(Object.defineProperty(ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ee,[])}catch(J){var j=J}Reflect.construct(r,[],ee)}else{try{ee.call()}catch(J){j=J}r.call(ee.prototype)}}else{try{throw Error()}catch(J){j=J}(ee=r())&&typeof ee.catch=="function"&&ee.catch(function(){})}}catch(J){if(J&&j&&typeof J.stack=="string")return[J.stack,j.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=f.DetermineComponentFrameRoot(),T=w[0],I=w[1];if(T&&I){var F=T.split(`
`),$=I.split(`
`);for(b=f=0;f<F.length&&!F[f].includes("DetermineComponentFrameRoot");)f++;for(;b<$.length&&!$[b].includes("DetermineComponentFrameRoot");)b++;if(f===F.length||b===$.length)for(f=F.length-1,b=$.length-1;1<=f&&0<=b&&F[f]!==$[b];)b--;for(;1<=f&&0<=b;f--,b--)if(F[f]!==$[b]){if(f!==1||b!==1)do if(f--,b--,0>b||F[f]!==$[b]){var Q=`
`+F[f].replace(" at new "," at ");return r.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",r.displayName)),Q}while(1<=f&&0<=b);break}}}finally{ty=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?wo(u):""}function Pk(r,o){switch(r.tag){case 26:case 27:case 5:return wo(r.type);case 16:return wo("Lazy");case 13:return r.child!==o&&o!==null?wo("Suspense Fallback"):wo("Suspense");case 19:return wo("SuspenseList");case 0:case 15:return ny(r.type,!1);case 11:return ny(r.type.render,!1);case 1:return ny(r.type,!0);case 31:return wo("Activity");default:return""}}function xx(r){try{var o="",u=null;do o+=Pk(r,u),u=r,r=r.return;while(r);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var iy=Object.prototype.hasOwnProperty,sy=i.unstable_scheduleCallback,ry=i.unstable_cancelCallback,Lk=i.unstable_shouldYield,Ok=i.unstable_requestPaint,li=i.unstable_now,Uk=i.unstable_getCurrentPriorityLevel,Sx=i.unstable_ImmediatePriority,Ax=i.unstable_UserBlockingPriority,Gp=i.unstable_NormalPriority,Fk=i.unstable_LowPriority,Ex=i.unstable_IdlePriority,Hk=i.log,Bk=i.unstable_setDisableYieldValue,Dd=null,ci=null;function la(r){if(typeof Hk=="function"&&Bk(r),ci&&typeof ci.setStrictMode=="function")try{ci.setStrictMode(Dd,r)}catch{}}var ui=Math.clz32?Math.clz32:qk,Gk=Math.log,zk=Math.LN2;function qk(r){return r>>>=0,r===0?32:31-(Gk(r)/zk|0)|0}var zp=256,qp=262144,Vp=4194304;function xo(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function $p(r,o,u){var f=r.pendingLanes;if(f===0)return 0;var b=0,w=r.suspendedLanes,T=r.pingedLanes;r=r.warmLanes;var I=f&134217727;return I!==0?(f=I&~w,f!==0?b=xo(f):(T&=I,T!==0?b=xo(T):u||(u=I&~r,u!==0&&(b=xo(u))))):(I=f&~w,I!==0?b=xo(I):T!==0?b=xo(T):u||(u=f&~r,u!==0&&(b=xo(u)))),b===0?0:o!==0&&o!==b&&(o&w)===0&&(w=b&-b,u=o&-o,w>=u||w===32&&(u&4194048)!==0)?o:b}function Pd(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function Vk(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tx(){var r=Vp;return Vp<<=1,(Vp&62914560)===0&&(Vp=4194304),r}function ay(r){for(var o=[],u=0;31>u;u++)o.push(r);return o}function Ld(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function $k(r,o,u,f,b,w){var T=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var I=r.entanglements,F=r.expirationTimes,$=r.hiddenUpdates;for(u=T&~u;0<u;){var Q=31-ui(u),ee=1<<Q;I[Q]=0,F[Q]=-1;var j=$[Q];if(j!==null)for($[Q]=null,Q=0;Q<j.length;Q++){var J=j[Q];J!==null&&(J.lane&=-536870913)}u&=~ee}f!==0&&Cx(r,f,0),w!==0&&b===0&&r.tag!==0&&(r.suspendedLanes|=w&~(T&~o))}function Cx(r,o,u){r.pendingLanes|=o,r.suspendedLanes&=~o;var f=31-ui(o);r.entangledLanes|=o,r.entanglements[f]=r.entanglements[f]|1073741824|u&261930}function Rx(r,o){var u=r.entangledLanes|=o;for(r=r.entanglements;u;){var f=31-ui(u),b=1<<f;b&o|r[f]&o&&(r[f]|=o),u&=~b}}function Nx(r,o){var u=o&-o;return u=(u&42)!==0?1:oy(u),(u&(r.suspendedLanes|o))!==0?0:u}function oy(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ly(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Mx(){var r=W.p;return r!==0?r:(r=window.event,r===void 0?32:gT(r.type))}function kx(r,o){var u=W.p;try{return W.p=r,o()}finally{W.p=u}}var ca=Math.random().toString(36).slice(2),hn="__reactFiber$"+ca,Kn="__reactProps$"+ca,lc="__reactContainer$"+ca,cy="__reactEvents$"+ca,jk="__reactListeners$"+ca,Yk="__reactHandles$"+ca,Ix="__reactResources$"+ca,Od="__reactMarker$"+ca;function uy(r){delete r[hn],delete r[Kn],delete r[cy],delete r[jk],delete r[Yk]}function cc(r){var o=r[hn];if(o)return o;for(var u=r.parentNode;u;){if(o=u[lc]||u[hn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(r=ZE(r);r!==null;){if(u=r[hn])return u;r=ZE(r)}return o}r=u,u=r.parentNode}return null}function uc(r){if(r=r[hn]||r[lc]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function Ud(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function dc(r){var o=r[Ix];return o||(o=r[Ix]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function tn(r){r[Od]=!0}var Dx=new Set,Px={};function So(r,o){hc(r,o),hc(r+"Capture",o)}function hc(r,o){for(Px[r]=o,r=0;r<o.length;r++)Dx.add(o[r])}var Kk=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Lx={},Ox={};function Jk(r){return iy.call(Ox,r)?!0:iy.call(Lx,r)?!1:Kk.test(r)?Ox[r]=!0:(Lx[r]=!0,!1)}function jp(r,o,u){if(Jk(o))if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+u)}}function Yp(r,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+u)}}function sr(r,o,u,f){if(f===null)r.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(o,u,""+f)}}function Ui(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Ux(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Xk(r,o,u){var f=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var b=f.get,w=f.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return b.call(this)},set:function(T){u=""+T,w.call(this,T)}}),Object.defineProperty(r,o,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function dy(r){if(!r._valueTracker){var o=Ux(r)?"checked":"value";r._valueTracker=Xk(r,o,""+r[o])}}function Fx(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var u=o.getValue(),f="";return r&&(f=Ux(r)?r.checked?"true":"false":r.value),r=f,r!==u?(o.setValue(r),!0):!1}function Kp(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Wk=/[\n"\\]/g;function Fi(r){return r.replace(Wk,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function hy(r,o,u,f,b,w,T,I){r.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?r.type=T:r.removeAttribute("type"),o!=null?T==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+Ui(o)):r.value!==""+Ui(o)&&(r.value=""+Ui(o)):T!=="submit"&&T!=="reset"||r.removeAttribute("value"),o!=null?fy(r,T,Ui(o)):u!=null?fy(r,T,Ui(u)):f!=null&&r.removeAttribute("value"),b==null&&w!=null&&(r.defaultChecked=!!w),b!=null&&(r.checked=b&&typeof b!="function"&&typeof b!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?r.name=""+Ui(I):r.removeAttribute("name")}function Hx(r,o,u,f,b,w,T,I){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(r.type=w),o!=null||u!=null){if(!(w!=="submit"&&w!=="reset"||o!=null)){dy(r);return}u=u!=null?""+Ui(u):"",o=o!=null?""+Ui(o):u,I||o===r.value||(r.value=o),r.defaultValue=o}f=f??b,f=typeof f!="function"&&typeof f!="symbol"&&!!f,r.checked=I?r.checked:!!f,r.defaultChecked=!!f,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(r.name=T),dy(r)}function fy(r,o,u){o==="number"&&Kp(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function fc(r,o,u,f){if(r=r.options,o){o={};for(var b=0;b<u.length;b++)o["$"+u[b]]=!0;for(u=0;u<r.length;u++)b=o.hasOwnProperty("$"+r[u].value),r[u].selected!==b&&(r[u].selected=b),b&&f&&(r[u].defaultSelected=!0)}else{for(u=""+Ui(u),o=null,b=0;b<r.length;b++){if(r[b].value===u){r[b].selected=!0,f&&(r[b].defaultSelected=!0);return}o!==null||r[b].disabled||(o=r[b])}o!==null&&(o.selected=!0)}}function Bx(r,o,u){if(o!=null&&(o=""+Ui(o),o!==r.value&&(r.value=o),u==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=u!=null?""+Ui(u):""}function Gx(r,o,u,f){if(o==null){if(f!=null){if(u!=null)throw Error(n(92));if(ze(f)){if(1<f.length)throw Error(n(93));f=f[0]}u=f}u==null&&(u=""),o=u}u=Ui(o),r.defaultValue=u,f=r.textContent,f===u&&f!==""&&f!==null&&(r.value=f),dy(r)}function pc(r,o){if(o){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=o;return}}r.textContent=o}var Qk=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zx(r,o,u){var f=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":f?r.setProperty(o,u):typeof u!="number"||u===0||Qk.has(o)?o==="float"?r.cssFloat=u:r[o]=(""+u).trim():r[o]=u+"px"}function qx(r,o,u){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?r.setProperty(f,""):f==="float"?r.cssFloat="":r[f]="");for(var b in o)f=o[b],o.hasOwnProperty(b)&&u[b]!==f&&zx(r,b,f)}else for(var w in o)o.hasOwnProperty(w)&&zx(r,w,o[w])}function py(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zk=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),eI=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Jp(r){return eI.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function rr(){}var gy=null;function my(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var gc=null,mc=null;function Vx(r){var o=uc(r);if(o&&(r=o.stateNode)){var u=r[Kn]||null;e:switch(r=o.stateNode,o.type){case"input":if(hy(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Fi(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var f=u[o];if(f!==r&&f.form===r.form){var b=f[Kn]||null;if(!b)throw Error(n(90));hy(f,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(o=0;o<u.length;o++)f=u[o],f.form===r.form&&Fx(f)}break e;case"textarea":Bx(r,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&fc(r,!!u.multiple,o,!1)}}}var yy=!1;function $x(r,o,u){if(yy)return r(o,u);yy=!0;try{var f=r(o);return f}finally{if(yy=!1,(gc!==null||mc!==null)&&(Og(),gc&&(o=gc,r=mc,mc=gc=null,Vx(o),r)))for(o=0;o<r.length;o++)Vx(r[o])}}function Fd(r,o){var u=r.stateNode;if(u===null)return null;var f=u[Kn]||null;if(f===null)return null;u=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(r=r.type,f=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!f;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(n(231,o,typeof u));return u}var ar=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vy=!1;if(ar)try{var Hd={};Object.defineProperty(Hd,"passive",{get:function(){vy=!0}}),window.addEventListener("test",Hd,Hd),window.removeEventListener("test",Hd,Hd)}catch{vy=!1}var ua=null,by=null,Xp=null;function jx(){if(Xp)return Xp;var r,o=by,u=o.length,f,b="value"in ua?ua.value:ua.textContent,w=b.length;for(r=0;r<u&&o[r]===b[r];r++);var T=u-r;for(f=1;f<=T&&o[u-f]===b[w-f];f++);return Xp=b.slice(r,1<f?1-f:void 0)}function Wp(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Qp(){return!0}function Yx(){return!1}function Jn(r){function o(u,f,b,w,T){this._reactName=u,this._targetInst=b,this.type=f,this.nativeEvent=w,this.target=T,this.currentTarget=null;for(var I in r)r.hasOwnProperty(I)&&(u=r[I],this[I]=u?u(w):w[I]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Qp:Yx,this.isPropagationStopped=Yx,this}return v(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Qp)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Qp)},persist:function(){},isPersistent:Qp}),o}var Ao={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zp=Jn(Ao),Bd=v({},Ao,{view:0,detail:0}),tI=Jn(Bd),_y,wy,Gd,eg=v({},Bd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sy,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Gd&&(Gd&&r.type==="mousemove"?(_y=r.screenX-Gd.screenX,wy=r.screenY-Gd.screenY):wy=_y=0,Gd=r),_y)},movementY:function(r){return"movementY"in r?r.movementY:wy}}),Kx=Jn(eg),nI=v({},eg,{dataTransfer:0}),iI=Jn(nI),sI=v({},Bd,{relatedTarget:0}),xy=Jn(sI),rI=v({},Ao,{animationName:0,elapsedTime:0,pseudoElement:0}),aI=Jn(rI),oI=v({},Ao,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),lI=Jn(oI),cI=v({},Ao,{data:0}),Jx=Jn(cI),uI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fI(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=hI[r])?!!o[r]:!1}function Sy(){return fI}var pI=v({},Bd,{key:function(r){if(r.key){var o=uI[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=Wp(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?dI[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sy,charCode:function(r){return r.type==="keypress"?Wp(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Wp(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),gI=Jn(pI),mI=v({},eg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xx=Jn(mI),yI=v({},Bd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sy}),vI=Jn(yI),bI=v({},Ao,{propertyName:0,elapsedTime:0,pseudoElement:0}),_I=Jn(bI),wI=v({},eg,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),xI=Jn(wI),SI=v({},Ao,{newState:0,oldState:0}),AI=Jn(SI),EI=[9,13,27,32],Ay=ar&&"CompositionEvent"in window,zd=null;ar&&"documentMode"in document&&(zd=document.documentMode);var TI=ar&&"TextEvent"in window&&!zd,Wx=ar&&(!Ay||zd&&8<zd&&11>=zd),Qx=" ",Zx=!1;function eS(r,o){switch(r){case"keyup":return EI.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tS(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var yc=!1;function CI(r,o){switch(r){case"compositionend":return tS(o);case"keypress":return o.which!==32?null:(Zx=!0,Qx);case"textInput":return r=o.data,r===Qx&&Zx?null:r;default:return null}}function RI(r,o){if(yc)return r==="compositionend"||!Ay&&eS(r,o)?(r=jx(),Xp=by=ua=null,yc=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Wx&&o.locale!=="ko"?null:o.data;default:return null}}var NI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nS(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!NI[r.type]:o==="textarea"}function iS(r,o,u,f){gc?mc?mc.push(f):mc=[f]:gc=f,o=qg(o,"onChange"),0<o.length&&(u=new Zp("onChange","change",null,u,f),r.push({event:u,listeners:o}))}var qd=null,Vd=null;function MI(r){HE(r,0)}function tg(r){var o=Ud(r);if(Fx(o))return r}function sS(r,o){if(r==="change")return o}var rS=!1;if(ar){var Ey;if(ar){var Ty="oninput"in document;if(!Ty){var aS=document.createElement("div");aS.setAttribute("oninput","return;"),Ty=typeof aS.oninput=="function"}Ey=Ty}else Ey=!1;rS=Ey&&(!document.documentMode||9<document.documentMode)}function oS(){qd&&(qd.detachEvent("onpropertychange",lS),Vd=qd=null)}function lS(r){if(r.propertyName==="value"&&tg(Vd)){var o=[];iS(o,Vd,r,my(r)),$x(MI,o)}}function kI(r,o,u){r==="focusin"?(oS(),qd=o,Vd=u,qd.attachEvent("onpropertychange",lS)):r==="focusout"&&oS()}function II(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return tg(Vd)}function DI(r,o){if(r==="click")return tg(o)}function PI(r,o){if(r==="input"||r==="change")return tg(o)}function LI(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var di=typeof Object.is=="function"?Object.is:LI;function $d(r,o){if(di(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var u=Object.keys(r),f=Object.keys(o);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var b=u[f];if(!iy.call(o,b)||!di(r[b],o[b]))return!1}return!0}function cS(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function uS(r,o){var u=cS(r);r=0;for(var f;u;){if(u.nodeType===3){if(f=r+u.textContent.length,r<=o&&f>=o)return{node:u,offset:o-r};r=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=cS(u)}}function dS(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?dS(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function hS(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=Kp(r.document);o instanceof r.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)r=o.contentWindow;else break;o=Kp(r.document)}return o}function Cy(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var OI=ar&&"documentMode"in document&&11>=document.documentMode,vc=null,Ry=null,jd=null,Ny=!1;function fS(r,o,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Ny||vc==null||vc!==Kp(f)||(f=vc,"selectionStart"in f&&Cy(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),jd&&$d(jd,f)||(jd=f,f=qg(Ry,"onSelect"),0<f.length&&(o=new Zp("onSelect","select",null,o,u),r.push({event:o,listeners:f}),o.target=vc)))}function Eo(r,o){var u={};return u[r.toLowerCase()]=o.toLowerCase(),u["Webkit"+r]="webkit"+o,u["Moz"+r]="moz"+o,u}var bc={animationend:Eo("Animation","AnimationEnd"),animationiteration:Eo("Animation","AnimationIteration"),animationstart:Eo("Animation","AnimationStart"),transitionrun:Eo("Transition","TransitionRun"),transitionstart:Eo("Transition","TransitionStart"),transitioncancel:Eo("Transition","TransitionCancel"),transitionend:Eo("Transition","TransitionEnd")},My={},pS={};ar&&(pS=document.createElement("div").style,"AnimationEvent"in window||(delete bc.animationend.animation,delete bc.animationiteration.animation,delete bc.animationstart.animation),"TransitionEvent"in window||delete bc.transitionend.transition);function To(r){if(My[r])return My[r];if(!bc[r])return r;var o=bc[r],u;for(u in o)if(o.hasOwnProperty(u)&&u in pS)return My[r]=o[u];return r}var gS=To("animationend"),mS=To("animationiteration"),yS=To("animationstart"),UI=To("transitionrun"),FI=To("transitionstart"),HI=To("transitioncancel"),vS=To("transitionend"),bS=new Map,ky="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ky.push("scrollEnd");function as(r,o){bS.set(r,o),So(o,[r])}var ng=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Hi=[],_c=0,Iy=0;function ig(){for(var r=_c,o=Iy=_c=0;o<r;){var u=Hi[o];Hi[o++]=null;var f=Hi[o];Hi[o++]=null;var b=Hi[o];Hi[o++]=null;var w=Hi[o];if(Hi[o++]=null,f!==null&&b!==null){var T=f.pending;T===null?b.next=b:(b.next=T.next,T.next=b),f.pending=b}w!==0&&_S(u,b,w)}}function sg(r,o,u,f){Hi[_c++]=r,Hi[_c++]=o,Hi[_c++]=u,Hi[_c++]=f,Iy|=f,r.lanes|=f,r=r.alternate,r!==null&&(r.lanes|=f)}function Dy(r,o,u,f){return sg(r,o,u,f),rg(r)}function Co(r,o){return sg(r,null,null,o),rg(r)}function _S(r,o,u){r.lanes|=u;var f=r.alternate;f!==null&&(f.lanes|=u);for(var b=!1,w=r.return;w!==null;)w.childLanes|=u,f=w.alternate,f!==null&&(f.childLanes|=u),w.tag===22&&(r=w.stateNode,r===null||r._visibility&1||(b=!0)),r=w,w=w.return;return r.tag===3?(w=r.stateNode,b&&o!==null&&(b=31-ui(u),r=w.hiddenUpdates,f=r[b],f===null?r[b]=[o]:f.push(o),o.lane=u|536870912),w):null}function rg(r){if(50<ph)throw ph=0,zv=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var wc={};function BI(r,o,u,f){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hi(r,o,u,f){return new BI(r,o,u,f)}function Py(r){return r=r.prototype,!(!r||!r.isReactComponent)}function or(r,o){var u=r.alternate;return u===null?(u=hi(r.tag,o,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=o,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,o=r.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function wS(r,o){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,o=u.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function ag(r,o,u,f,b,w){var T=0;if(f=r,typeof r=="function")Py(r)&&(T=1);else if(typeof r=="string")T=$2(r,u,oe.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case Y:return r=hi(31,u,o,b),r.elementType=Y,r.lanes=w,r;case E:return Ro(u.children,b,w,o);case R:T=8,b|=24;break;case N:return r=hi(12,u,o,b|2),r.elementType=N,r.lanes=w,r;case B:return r=hi(13,u,o,b),r.elementType=B,r.lanes=w,r;case H:return r=hi(19,u,o,b),r.elementType=H,r.lanes=w,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case P:T=10;break e;case D:T=9;break e;case L:T=11;break e;case O:T=14;break e;case X:T=16,f=null;break e}T=29,u=Error(n(130,r===null?"null":typeof r,"")),f=null}return o=hi(T,u,o,b),o.elementType=r,o.type=f,o.lanes=w,o}function Ro(r,o,u,f){return r=hi(7,r,f,o),r.lanes=u,r}function Ly(r,o,u){return r=hi(6,r,null,o),r.lanes=u,r}function xS(r){var o=hi(18,null,null,0);return o.stateNode=r,o}function Oy(r,o,u){return o=hi(4,r.children!==null?r.children:[],r.key,o),o.lanes=u,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var SS=new WeakMap;function Bi(r,o){if(typeof r=="object"&&r!==null){var u=SS.get(r);return u!==void 0?u:(o={value:r,source:o,stack:xx(o)},SS.set(r,o),o)}return{value:r,source:o,stack:xx(o)}}var xc=[],Sc=0,og=null,Yd=0,Gi=[],zi=0,da=null,Is=1,Ds="";function lr(r,o){xc[Sc++]=Yd,xc[Sc++]=og,og=r,Yd=o}function AS(r,o,u){Gi[zi++]=Is,Gi[zi++]=Ds,Gi[zi++]=da,da=r;var f=Is;r=Ds;var b=32-ui(f)-1;f&=~(1<<b),u+=1;var w=32-ui(o)+b;if(30<w){var T=b-b%5;w=(f&(1<<T)-1).toString(32),f>>=T,b-=T,Is=1<<32-ui(o)+b|u<<b|f,Ds=w+r}else Is=1<<w|u<<b|f,Ds=r}function Uy(r){r.return!==null&&(lr(r,1),AS(r,1,0))}function Fy(r){for(;r===og;)og=xc[--Sc],xc[Sc]=null,Yd=xc[--Sc],xc[Sc]=null;for(;r===da;)da=Gi[--zi],Gi[zi]=null,Ds=Gi[--zi],Gi[zi]=null,Is=Gi[--zi],Gi[zi]=null}function ES(r,o){Gi[zi++]=Is,Gi[zi++]=Ds,Gi[zi++]=da,Is=o.id,Ds=o.overflow,da=r}var fn=null,yt=null,Je=!1,ha=null,qi=!1,Hy=Error(n(519));function fa(r){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Kd(Bi(o,r)),Hy}function TS(r){var o=r.stateNode,u=r.type,f=r.memoizedProps;switch(o[hn]=r,o[Kn]=f,u){case"dialog":je("cancel",o),je("close",o);break;case"iframe":case"object":case"embed":je("load",o);break;case"video":case"audio":for(u=0;u<mh.length;u++)je(mh[u],o);break;case"source":je("error",o);break;case"img":case"image":case"link":je("error",o),je("load",o);break;case"details":je("toggle",o);break;case"input":je("invalid",o),Hx(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":je("invalid",o);break;case"textarea":je("invalid",o),Gx(o,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||f.suppressHydrationWarning===!0||qE(o.textContent,u)?(f.popover!=null&&(je("beforetoggle",o),je("toggle",o)),f.onScroll!=null&&je("scroll",o),f.onScrollEnd!=null&&je("scrollend",o),f.onClick!=null&&(o.onclick=rr),o=!0):o=!1,o||fa(r,!0)}function CS(r){for(fn=r.return;fn;)switch(fn.tag){case 5:case 31:case 13:qi=!1;return;case 27:case 3:qi=!0;return;default:fn=fn.return}}function Ac(r){if(r!==fn)return!1;if(!Je)return CS(r),Je=!0,!1;var o=r.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||ib(r.type,r.memoizedProps)),u=!u),u&&yt&&fa(r),CS(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));yt=QE(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));yt=QE(r)}else o===27?(o=yt,Ca(r.type)?(r=lb,lb=null,yt=r):yt=o):yt=fn?$i(r.stateNode.nextSibling):null;return!0}function No(){yt=fn=null,Je=!1}function By(){var r=ha;return r!==null&&(Zn===null?Zn=r:Zn.push.apply(Zn,r),ha=null),r}function Kd(r){ha===null?ha=[r]:ha.push(r)}var Gy=U(null),Mo=null,cr=null;function pa(r,o,u){ie(Gy,o._currentValue),o._currentValue=u}function ur(r){r._currentValue=Gy.current,K(Gy)}function zy(r,o,u){for(;r!==null;){var f=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),r===u)break;r=r.return}}function qy(r,o,u,f){var b=r.child;for(b!==null&&(b.return=r);b!==null;){var w=b.dependencies;if(w!==null){var T=b.child;w=w.firstContext;e:for(;w!==null;){var I=w;w=b;for(var F=0;F<o.length;F++)if(I.context===o[F]){w.lanes|=u,I=w.alternate,I!==null&&(I.lanes|=u),zy(w.return,u,r),f||(T=null);break e}w=I.next}}else if(b.tag===18){if(T=b.return,T===null)throw Error(n(341));T.lanes|=u,w=T.alternate,w!==null&&(w.lanes|=u),zy(T,u,r),T=null}else T=b.child;if(T!==null)T.return=b;else for(T=b;T!==null;){if(T===r){T=null;break}if(b=T.sibling,b!==null){b.return=T.return,T=b;break}T=T.return}b=T}}function Ec(r,o,u,f){r=null;for(var b=o,w=!1;b!==null;){if(!w){if((b.flags&524288)!==0)w=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var T=b.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var I=b.type;di(b.pendingProps.value,T.value)||(r!==null?r.push(I):r=[I])}}else if(b===Se.current){if(T=b.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(r!==null?r.push(wh):r=[wh])}b=b.return}r!==null&&qy(o,r,u,f),o.flags|=262144}function lg(r){for(r=r.firstContext;r!==null;){if(!di(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ko(r){Mo=r,cr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function pn(r){return RS(Mo,r)}function cg(r,o){return Mo===null&&ko(r),RS(r,o)}function RS(r,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},cr===null){if(r===null)throw Error(n(308));cr=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else cr=cr.next=o;return u}var GI=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(u,f){r.push(f)}};this.abort=function(){o.aborted=!0,r.forEach(function(u){return u()})}},zI=i.unstable_scheduleCallback,qI=i.unstable_NormalPriority,Ft={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vy(){return{controller:new GI,data:new Map,refCount:0}}function Jd(r){r.refCount--,r.refCount===0&&zI(qI,function(){r.controller.abort()})}var Xd=null,$y=0,Tc=0,Cc=null;function VI(r,o){if(Xd===null){var u=Xd=[];$y=0,Tc=Kv(),Cc={status:"pending",value:void 0,then:function(f){u.push(f)}}}return $y++,o.then(NS,NS),o}function NS(){if(--$y===0&&Xd!==null){Cc!==null&&(Cc.status="fulfilled");var r=Xd;Xd=null,Tc=0,Cc=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function $I(r,o){var u=[],f={status:"pending",value:null,reason:null,then:function(b){u.push(b)}};return r.then(function(){f.status="fulfilled",f.value=o;for(var b=0;b<u.length;b++)(0,u[b])(o)},function(b){for(f.status="rejected",f.reason=b,b=0;b<u.length;b++)(0,u[b])(void 0)}),f}var MS=G.S;G.S=function(r,o){fE=li(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&VI(r,o),MS!==null&&MS(r,o)};var Io=U(null);function jy(){var r=Io.current;return r!==null?r:ft.pooledCache}function ug(r,o){o===null?ie(Io,Io.current):ie(Io,o.pool)}function kS(){var r=jy();return r===null?null:{parent:Ft._currentValue,pool:r}}var Rc=Error(n(460)),Yy=Error(n(474)),dg=Error(n(542)),hg={then:function(){}};function IS(r){return r=r.status,r==="fulfilled"||r==="rejected"}function DS(r,o,u){switch(u=r[u],u===void 0?r.push(o):u!==o&&(o.then(rr,rr),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,LS(r),r;default:if(typeof o.status=="string")o.then(rr,rr);else{if(r=ft,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(f){if(o.status==="pending"){var b=o;b.status="fulfilled",b.value=f}},function(f){if(o.status==="pending"){var b=o;b.status="rejected",b.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,LS(r),r}throw Po=o,Rc}}function Do(r){try{var o=r._init;return o(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Po=u,Rc):u}}var Po=null;function PS(){if(Po===null)throw Error(n(459));var r=Po;return Po=null,r}function LS(r){if(r===Rc||r===dg)throw Error(n(483))}var Nc=null,Wd=0;function fg(r){var o=Wd;return Wd+=1,Nc===null&&(Nc=[]),DS(Nc,r,o)}function Qd(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function pg(r,o){throw o.$$typeof===_?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function OS(r){function o(q,z){if(r){var V=q.deletions;V===null?(q.deletions=[z],q.flags|=16):V.push(z)}}function u(q,z){if(!r)return null;for(;z!==null;)o(q,z),z=z.sibling;return null}function f(q){for(var z=new Map;q!==null;)q.key!==null?z.set(q.key,q):z.set(q.index,q),q=q.sibling;return z}function b(q,z){return q=or(q,z),q.index=0,q.sibling=null,q}function w(q,z,V){return q.index=V,r?(V=q.alternate,V!==null?(V=V.index,V<z?(q.flags|=67108866,z):V):(q.flags|=67108866,z)):(q.flags|=1048576,z)}function T(q){return r&&q.alternate===null&&(q.flags|=67108866),q}function I(q,z,V,Z){return z===null||z.tag!==6?(z=Ly(V,q.mode,Z),z.return=q,z):(z=b(z,V),z.return=q,z)}function F(q,z,V,Z){var Ae=V.type;return Ae===E?Q(q,z,V.props.children,Z,V.key):z!==null&&(z.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===X&&Do(Ae)===z.type)?(z=b(z,V.props),Qd(z,V),z.return=q,z):(z=ag(V.type,V.key,V.props,null,q.mode,Z),Qd(z,V),z.return=q,z)}function $(q,z,V,Z){return z===null||z.tag!==4||z.stateNode.containerInfo!==V.containerInfo||z.stateNode.implementation!==V.implementation?(z=Oy(V,q.mode,Z),z.return=q,z):(z=b(z,V.children||[]),z.return=q,z)}function Q(q,z,V,Z,Ae){return z===null||z.tag!==7?(z=Ro(V,q.mode,Z,Ae),z.return=q,z):(z=b(z,V),z.return=q,z)}function ee(q,z,V){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Ly(""+z,q.mode,V),z.return=q,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case x:return V=ag(z.type,z.key,z.props,null,q.mode,V),Qd(V,z),V.return=q,V;case A:return z=Oy(z,q.mode,V),z.return=q,z;case X:return z=Do(z),ee(q,z,V)}if(ze(z)||ne(z))return z=Ro(z,q.mode,V,null),z.return=q,z;if(typeof z.then=="function")return ee(q,fg(z),V);if(z.$$typeof===P)return ee(q,cg(q,z),V);pg(q,z)}return null}function j(q,z,V,Z){var Ae=z!==null?z.key:null;if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return Ae!==null?null:I(q,z,""+V,Z);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case x:return V.key===Ae?F(q,z,V,Z):null;case A:return V.key===Ae?$(q,z,V,Z):null;case X:return V=Do(V),j(q,z,V,Z)}if(ze(V)||ne(V))return Ae!==null?null:Q(q,z,V,Z,null);if(typeof V.then=="function")return j(q,z,fg(V),Z);if(V.$$typeof===P)return j(q,z,cg(q,V),Z);pg(q,V)}return null}function J(q,z,V,Z,Ae){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return q=q.get(V)||null,I(z,q,""+Z,Ae);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case x:return q=q.get(Z.key===null?V:Z.key)||null,F(z,q,Z,Ae);case A:return q=q.get(Z.key===null?V:Z.key)||null,$(z,q,Z,Ae);case X:return Z=Do(Z),J(q,z,V,Z,Ae)}if(ze(Z)||ne(Z))return q=q.get(V)||null,Q(z,q,Z,Ae,null);if(typeof Z.then=="function")return J(q,z,V,fg(Z),Ae);if(Z.$$typeof===P)return J(q,z,V,cg(z,Z),Ae);pg(z,Z)}return null}function pe(q,z,V,Z){for(var Ae=null,Qe=null,ve=z,Fe=z=0,Ke=null;ve!==null&&Fe<V.length;Fe++){ve.index>Fe?(Ke=ve,ve=null):Ke=ve.sibling;var Ze=j(q,ve,V[Fe],Z);if(Ze===null){ve===null&&(ve=Ke);break}r&&ve&&Ze.alternate===null&&o(q,ve),z=w(Ze,z,Fe),Qe===null?Ae=Ze:Qe.sibling=Ze,Qe=Ze,ve=Ke}if(Fe===V.length)return u(q,ve),Je&&lr(q,Fe),Ae;if(ve===null){for(;Fe<V.length;Fe++)ve=ee(q,V[Fe],Z),ve!==null&&(z=w(ve,z,Fe),Qe===null?Ae=ve:Qe.sibling=ve,Qe=ve);return Je&&lr(q,Fe),Ae}for(ve=f(ve);Fe<V.length;Fe++)Ke=J(ve,q,Fe,V[Fe],Z),Ke!==null&&(r&&Ke.alternate!==null&&ve.delete(Ke.key===null?Fe:Ke.key),z=w(Ke,z,Fe),Qe===null?Ae=Ke:Qe.sibling=Ke,Qe=Ke);return r&&ve.forEach(function(Ia){return o(q,Ia)}),Je&&lr(q,Fe),Ae}function Ce(q,z,V,Z){if(V==null)throw Error(n(151));for(var Ae=null,Qe=null,ve=z,Fe=z=0,Ke=null,Ze=V.next();ve!==null&&!Ze.done;Fe++,Ze=V.next()){ve.index>Fe?(Ke=ve,ve=null):Ke=ve.sibling;var Ia=j(q,ve,Ze.value,Z);if(Ia===null){ve===null&&(ve=Ke);break}r&&ve&&Ia.alternate===null&&o(q,ve),z=w(Ia,z,Fe),Qe===null?Ae=Ia:Qe.sibling=Ia,Qe=Ia,ve=Ke}if(Ze.done)return u(q,ve),Je&&lr(q,Fe),Ae;if(ve===null){for(;!Ze.done;Fe++,Ze=V.next())Ze=ee(q,Ze.value,Z),Ze!==null&&(z=w(Ze,z,Fe),Qe===null?Ae=Ze:Qe.sibling=Ze,Qe=Ze);return Je&&lr(q,Fe),Ae}for(ve=f(ve);!Ze.done;Fe++,Ze=V.next())Ze=J(ve,q,Fe,Ze.value,Z),Ze!==null&&(r&&Ze.alternate!==null&&ve.delete(Ze.key===null?Fe:Ze.key),z=w(Ze,z,Fe),Qe===null?Ae=Ze:Qe.sibling=Ze,Qe=Ze);return r&&ve.forEach(function(nD){return o(q,nD)}),Je&&lr(q,Fe),Ae}function ut(q,z,V,Z){if(typeof V=="object"&&V!==null&&V.type===E&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case x:e:{for(var Ae=V.key;z!==null;){if(z.key===Ae){if(Ae=V.type,Ae===E){if(z.tag===7){u(q,z.sibling),Z=b(z,V.props.children),Z.return=q,q=Z;break e}}else if(z.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===X&&Do(Ae)===z.type){u(q,z.sibling),Z=b(z,V.props),Qd(Z,V),Z.return=q,q=Z;break e}u(q,z);break}else o(q,z);z=z.sibling}V.type===E?(Z=Ro(V.props.children,q.mode,Z,V.key),Z.return=q,q=Z):(Z=ag(V.type,V.key,V.props,null,q.mode,Z),Qd(Z,V),Z.return=q,q=Z)}return T(q);case A:e:{for(Ae=V.key;z!==null;){if(z.key===Ae)if(z.tag===4&&z.stateNode.containerInfo===V.containerInfo&&z.stateNode.implementation===V.implementation){u(q,z.sibling),Z=b(z,V.children||[]),Z.return=q,q=Z;break e}else{u(q,z);break}else o(q,z);z=z.sibling}Z=Oy(V,q.mode,Z),Z.return=q,q=Z}return T(q);case X:return V=Do(V),ut(q,z,V,Z)}if(ze(V))return pe(q,z,V,Z);if(ne(V)){if(Ae=ne(V),typeof Ae!="function")throw Error(n(150));return V=Ae.call(V),Ce(q,z,V,Z)}if(typeof V.then=="function")return ut(q,z,fg(V),Z);if(V.$$typeof===P)return ut(q,z,cg(q,V),Z);pg(q,V)}return typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint"?(V=""+V,z!==null&&z.tag===6?(u(q,z.sibling),Z=b(z,V),Z.return=q,q=Z):(u(q,z),Z=Ly(V,q.mode,Z),Z.return=q,q=Z),T(q)):u(q,z)}return function(q,z,V,Z){try{Wd=0;var Ae=ut(q,z,V,Z);return Nc=null,Ae}catch(ve){if(ve===Rc||ve===dg)throw ve;var Qe=hi(29,ve,null,q.mode);return Qe.lanes=Z,Qe.return=q,Qe}finally{}}}var Lo=OS(!0),US=OS(!1),ga=!1;function Ky(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jy(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ma(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ya(r,o,u){var f=r.updateQueue;if(f===null)return null;if(f=f.shared,(nt&2)!==0){var b=f.pending;return b===null?o.next=o:(o.next=b.next,b.next=o),f.pending=o,o=rg(r),_S(r,null,u),o}return sg(r,f,o,u),rg(r)}function Zd(r,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,Rx(r,u)}}function Xy(r,o){var u=r.updateQueue,f=r.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var b=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var T={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};w===null?b=w=T:w=w.next=T,u=u.next}while(u!==null);w===null?b=w=o:w=w.next=o}else b=w=o;u={baseState:f.baseState,firstBaseUpdate:b,lastBaseUpdate:w,shared:f.shared,callbacks:f.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=o:r.next=o,u.lastBaseUpdate=o}var Wy=!1;function eh(){if(Wy){var r=Cc;if(r!==null)throw r}}function th(r,o,u,f){Wy=!1;var b=r.updateQueue;ga=!1;var w=b.firstBaseUpdate,T=b.lastBaseUpdate,I=b.shared.pending;if(I!==null){b.shared.pending=null;var F=I,$=F.next;F.next=null,T===null?w=$:T.next=$,T=F;var Q=r.alternate;Q!==null&&(Q=Q.updateQueue,I=Q.lastBaseUpdate,I!==T&&(I===null?Q.firstBaseUpdate=$:I.next=$,Q.lastBaseUpdate=F))}if(w!==null){var ee=b.baseState;T=0,Q=$=F=null,I=w;do{var j=I.lane&-536870913,J=j!==I.lane;if(J?(Ye&j)===j:(f&j)===j){j!==0&&j===Tc&&(Wy=!0),Q!==null&&(Q=Q.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var pe=r,Ce=I;j=o;var ut=u;switch(Ce.tag){case 1:if(pe=Ce.payload,typeof pe=="function"){ee=pe.call(ut,ee,j);break e}ee=pe;break e;case 3:pe.flags=pe.flags&-65537|128;case 0:if(pe=Ce.payload,j=typeof pe=="function"?pe.call(ut,ee,j):pe,j==null)break e;ee=v({},ee,j);break e;case 2:ga=!0}}j=I.callback,j!==null&&(r.flags|=64,J&&(r.flags|=8192),J=b.callbacks,J===null?b.callbacks=[j]:J.push(j))}else J={lane:j,tag:I.tag,payload:I.payload,callback:I.callback,next:null},Q===null?($=Q=J,F=ee):Q=Q.next=J,T|=j;if(I=I.next,I===null){if(I=b.shared.pending,I===null)break;J=I,I=J.next,J.next=null,b.lastBaseUpdate=J,b.shared.pending=null}}while(!0);Q===null&&(F=ee),b.baseState=F,b.firstBaseUpdate=$,b.lastBaseUpdate=Q,w===null&&(b.shared.lanes=0),xa|=T,r.lanes=T,r.memoizedState=ee}}function FS(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function HS(r,o){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)FS(u[r],o)}var Mc=U(null),gg=U(0);function BS(r,o){r=br,ie(gg,r),ie(Mc,o),br=r|o.baseLanes}function Qy(){ie(gg,br),ie(Mc,Mc.current)}function Zy(){br=gg.current,K(Mc),K(gg)}var fi=U(null),Vi=null;function va(r){var o=r.alternate;ie(Dt,Dt.current&1),ie(fi,r),Vi===null&&(o===null||Mc.current!==null||o.memoizedState!==null)&&(Vi=r)}function ev(r){ie(Dt,Dt.current),ie(fi,r),Vi===null&&(Vi=r)}function GS(r){r.tag===22?(ie(Dt,Dt.current),ie(fi,r),Vi===null&&(Vi=r)):ba()}function ba(){ie(Dt,Dt.current),ie(fi,fi.current)}function pi(r){K(fi),Vi===r&&(Vi=null),K(Dt)}var Dt=U(0);function mg(r){for(var o=r;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||ab(u)||ob(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var dr=0,Oe=null,lt=null,Ht=null,yg=!1,kc=!1,Oo=!1,vg=0,nh=0,Ic=null,jI=0;function Mt(){throw Error(n(321))}function tv(r,o){if(o===null)return!1;for(var u=0;u<o.length&&u<r.length;u++)if(!di(r[u],o[u]))return!1;return!0}function nv(r,o,u,f,b,w){return dr=w,Oe=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,G.H=r===null||r.memoizedState===null?AA:yv,Oo=!1,w=u(f,b),Oo=!1,kc&&(w=qS(o,u,f,b)),zS(r),w}function zS(r){G.H=rh;var o=lt!==null&&lt.next!==null;if(dr=0,Ht=lt=Oe=null,yg=!1,nh=0,Ic=null,o)throw Error(n(300));r===null||Bt||(r=r.dependencies,r!==null&&lg(r)&&(Bt=!0))}function qS(r,o,u,f){Oe=r;var b=0;do{if(kc&&(Ic=null),nh=0,kc=!1,25<=b)throw Error(n(301));if(b+=1,Ht=lt=null,r.updateQueue!=null){var w=r.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}G.H=EA,w=o(u,f)}while(kc);return w}function YI(){var r=G.H,o=r.useState()[0];return o=typeof o.then=="function"?ih(o):o,r=r.useState()[0],(lt!==null?lt.memoizedState:null)!==r&&(Oe.flags|=1024),o}function iv(){var r=vg!==0;return vg=0,r}function sv(r,o,u){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~u}function rv(r){if(yg){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}yg=!1}dr=0,Ht=lt=Oe=null,kc=!1,nh=vg=0,Ic=null}function On(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?Oe.memoizedState=Ht=r:Ht=Ht.next=r,Ht}function Pt(){if(lt===null){var r=Oe.alternate;r=r!==null?r.memoizedState:null}else r=lt.next;var o=Ht===null?Oe.memoizedState:Ht.next;if(o!==null)Ht=o,lt=r;else{if(r===null)throw Oe.alternate===null?Error(n(467)):Error(n(310));lt=r,r={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},Ht===null?Oe.memoizedState=Ht=r:Ht=Ht.next=r}return Ht}function bg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ih(r){var o=nh;return nh+=1,Ic===null&&(Ic=[]),r=DS(Ic,r,o),o=Oe,(Ht===null?o.memoizedState:Ht.next)===null&&(o=o.alternate,G.H=o===null||o.memoizedState===null?AA:yv),r}function _g(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return ih(r);if(r.$$typeof===P)return pn(r)}throw Error(n(438,String(r)))}function av(r){var o=null,u=Oe.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var f=Oe.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(b){return b.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=bg(),Oe.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(r),f=0;f<r;f++)u[f]=se;return o.index++,u}function hr(r,o){return typeof o=="function"?o(r):o}function wg(r){var o=Pt();return ov(o,lt,r)}function ov(r,o,u){var f=r.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=u;var b=r.baseQueue,w=f.pending;if(w!==null){if(b!==null){var T=b.next;b.next=w.next,w.next=T}o.baseQueue=b=w,f.pending=null}if(w=r.baseState,b===null)r.memoizedState=w;else{o=b.next;var I=T=null,F=null,$=o,Q=!1;do{var ee=$.lane&-536870913;if(ee!==$.lane?(Ye&ee)===ee:(dr&ee)===ee){var j=$.revertLane;if(j===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),ee===Tc&&(Q=!0);else if((dr&j)===j){$=$.next,j===Tc&&(Q=!0);continue}else ee={lane:0,revertLane:$.revertLane,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},F===null?(I=F=ee,T=w):F=F.next=ee,Oe.lanes|=j,xa|=j;ee=$.action,Oo&&u(w,ee),w=$.hasEagerState?$.eagerState:u(w,ee)}else j={lane:ee,revertLane:$.revertLane,gesture:$.gesture,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},F===null?(I=F=j,T=w):F=F.next=j,Oe.lanes|=ee,xa|=ee;$=$.next}while($!==null&&$!==o);if(F===null?T=w:F.next=I,!di(w,r.memoizedState)&&(Bt=!0,Q&&(u=Cc,u!==null)))throw u;r.memoizedState=w,r.baseState=T,r.baseQueue=F,f.lastRenderedState=w}return b===null&&(f.lanes=0),[r.memoizedState,f.dispatch]}function lv(r){var o=Pt(),u=o.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=r;var f=u.dispatch,b=u.pending,w=o.memoizedState;if(b!==null){u.pending=null;var T=b=b.next;do w=r(w,T.action),T=T.next;while(T!==b);di(w,o.memoizedState)||(Bt=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),u.lastRenderedState=w}return[w,f]}function VS(r,o,u){var f=Oe,b=Pt(),w=Je;if(w){if(u===void 0)throw Error(n(407));u=u()}else u=o();var T=!di((lt||b).memoizedState,u);if(T&&(b.memoizedState=u,Bt=!0),b=b.queue,dv(YS.bind(null,f,b,r),[r]),b.getSnapshot!==o||T||Ht!==null&&Ht.memoizedState.tag&1){if(f.flags|=2048,Dc(9,{destroy:void 0},jS.bind(null,f,b,u,o),null),ft===null)throw Error(n(349));w||(dr&127)!==0||$S(f,o,u)}return u}function $S(r,o,u){r.flags|=16384,r={getSnapshot:o,value:u},o=Oe.updateQueue,o===null?(o=bg(),Oe.updateQueue=o,o.stores=[r]):(u=o.stores,u===null?o.stores=[r]:u.push(r))}function jS(r,o,u,f){o.value=u,o.getSnapshot=f,KS(o)&&JS(r)}function YS(r,o,u){return u(function(){KS(o)&&JS(r)})}function KS(r){var o=r.getSnapshot;r=r.value;try{var u=o();return!di(r,u)}catch{return!0}}function JS(r){var o=Co(r,2);o!==null&&ei(o,r,2)}function cv(r){var o=On();if(typeof r=="function"){var u=r;if(r=u(),Oo){la(!0);try{u()}finally{la(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:r},o}function XS(r,o,u,f){return r.baseState=u,ov(r,lt,typeof f=="function"?f:hr)}function KI(r,o,u,f,b){if(Ag(r))throw Error(n(485));if(r=o.action,r!==null){var w={payload:b,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){w.listeners.push(T)}};G.T!==null?u(!0):w.isTransition=!1,f(w),u=o.pending,u===null?(w.next=o.pending=w,WS(o,w)):(w.next=u.next,o.pending=u.next=w)}}function WS(r,o){var u=o.action,f=o.payload,b=r.state;if(o.isTransition){var w=G.T,T={};G.T=T;try{var I=u(b,f),F=G.S;F!==null&&F(T,I),QS(r,o,I)}catch($){uv(r,o,$)}finally{w!==null&&T.types!==null&&(w.types=T.types),G.T=w}}else try{w=u(b,f),QS(r,o,w)}catch($){uv(r,o,$)}}function QS(r,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){ZS(r,o,f)},function(f){return uv(r,o,f)}):ZS(r,o,u)}function ZS(r,o,u){o.status="fulfilled",o.value=u,eA(o),r.state=u,o=r.pending,o!==null&&(u=o.next,u===o?r.pending=null:(u=u.next,o.next=u,WS(r,u)))}function uv(r,o,u){var f=r.pending;if(r.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=u,eA(o),o=o.next;while(o!==f)}r.action=null}function eA(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function tA(r,o){return o}function nA(r,o){if(Je){var u=ft.formState;if(u!==null){e:{var f=Oe;if(Je){if(yt){t:{for(var b=yt,w=qi;b.nodeType!==8;){if(!w){b=null;break t}if(b=$i(b.nextSibling),b===null){b=null;break t}}w=b.data,b=w==="F!"||w==="F"?b:null}if(b){yt=$i(b.nextSibling),f=b.data==="F!";break e}}fa(f)}f=!1}f&&(o=u[0])}}return u=On(),u.memoizedState=u.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tA,lastRenderedState:o},u.queue=f,u=wA.bind(null,Oe,f),f.dispatch=u,f=cv(!1),w=mv.bind(null,Oe,!1,f.queue),f=On(),b={state:o,dispatch:null,action:r,pending:null},f.queue=b,u=KI.bind(null,Oe,b,w,u),b.dispatch=u,f.memoizedState=r,[o,u,!1]}function iA(r){var o=Pt();return sA(o,lt,r)}function sA(r,o,u){if(o=ov(r,o,tA)[0],r=wg(hr)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=ih(o)}catch(T){throw T===Rc?dg:T}else f=o;o=Pt();var b=o.queue,w=b.dispatch;return u!==o.memoizedState&&(Oe.flags|=2048,Dc(9,{destroy:void 0},JI.bind(null,b,u),null)),[f,w,r]}function JI(r,o){r.action=o}function rA(r){var o=Pt(),u=lt;if(u!==null)return sA(o,u,r);Pt(),o=o.memoizedState,u=Pt();var f=u.queue.dispatch;return u.memoizedState=r,[o,f,!1]}function Dc(r,o,u,f){return r={tag:r,create:u,deps:f,inst:o,next:null},o=Oe.updateQueue,o===null&&(o=bg(),Oe.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=r.next=r:(f=u.next,u.next=r,r.next=f,o.lastEffect=r),r}function aA(){return Pt().memoizedState}function xg(r,o,u,f){var b=On();Oe.flags|=r,b.memoizedState=Dc(1|o,{destroy:void 0},u,f===void 0?null:f)}function Sg(r,o,u,f){var b=Pt();f=f===void 0?null:f;var w=b.memoizedState.inst;lt!==null&&f!==null&&tv(f,lt.memoizedState.deps)?b.memoizedState=Dc(o,w,u,f):(Oe.flags|=r,b.memoizedState=Dc(1|o,w,u,f))}function oA(r,o){xg(8390656,8,r,o)}function dv(r,o){Sg(2048,8,r,o)}function XI(r){Oe.flags|=4;var o=Oe.updateQueue;if(o===null)o=bg(),Oe.updateQueue=o,o.events=[r];else{var u=o.events;u===null?o.events=[r]:u.push(r)}}function lA(r){var o=Pt().memoizedState;return XI({ref:o,nextImpl:r}),function(){if((nt&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function cA(r,o){return Sg(4,2,r,o)}function uA(r,o){return Sg(4,4,r,o)}function dA(r,o){if(typeof o=="function"){r=r();var u=o(r);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function hA(r,o,u){u=u!=null?u.concat([r]):null,Sg(4,4,dA.bind(null,o,r),u)}function hv(){}function fA(r,o){var u=Pt();o=o===void 0?null:o;var f=u.memoizedState;return o!==null&&tv(o,f[1])?f[0]:(u.memoizedState=[r,o],r)}function pA(r,o){var u=Pt();o=o===void 0?null:o;var f=u.memoizedState;if(o!==null&&tv(o,f[1]))return f[0];if(f=r(),Oo){la(!0);try{r()}finally{la(!1)}}return u.memoizedState=[f,o],f}function fv(r,o,u){return u===void 0||(dr&1073741824)!==0&&(Ye&261930)===0?r.memoizedState=o:(r.memoizedState=u,r=gE(),Oe.lanes|=r,xa|=r,u)}function gA(r,o,u,f){return di(u,o)?u:Mc.current!==null?(r=fv(r,u,f),di(r,o)||(Bt=!0),r):(dr&42)===0||(dr&1073741824)!==0&&(Ye&261930)===0?(Bt=!0,r.memoizedState=u):(r=gE(),Oe.lanes|=r,xa|=r,o)}function mA(r,o,u,f,b){var w=W.p;W.p=w!==0&&8>w?w:8;var T=G.T,I={};G.T=I,mv(r,!1,o,u);try{var F=b(),$=G.S;if($!==null&&$(I,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var Q=$I(F,f);sh(r,o,Q,yi(r))}else sh(r,o,f,yi(r))}catch(ee){sh(r,o,{then:function(){},status:"rejected",reason:ee},yi())}finally{W.p=w,T!==null&&I.types!==null&&(T.types=I.types),G.T=T}}function WI(){}function pv(r,o,u,f){if(r.tag!==5)throw Error(n(476));var b=yA(r).queue;mA(r,b,o,he,u===null?WI:function(){return vA(r),u(f)})}function yA(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:he,baseState:he,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:he},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:u},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function vA(r){var o=yA(r);o.next===null&&(o=r.alternate.memoizedState),sh(r,o.next.queue,{},yi())}function gv(){return pn(wh)}function bA(){return Pt().memoizedState}function _A(){return Pt().memoizedState}function QI(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var u=yi();r=ma(u);var f=ya(o,r,u);f!==null&&(ei(f,o,u),Zd(f,o,u)),o={cache:Vy()},r.payload=o;return}o=o.return}}function ZI(r,o,u){var f=yi();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Ag(r)?xA(o,u):(u=Dy(r,o,u,f),u!==null&&(ei(u,r,f),SA(u,o,f)))}function wA(r,o,u){var f=yi();sh(r,o,u,f)}function sh(r,o,u,f){var b={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Ag(r))xA(o,b);else{var w=r.alternate;if(r.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var T=o.lastRenderedState,I=w(T,u);if(b.hasEagerState=!0,b.eagerState=I,di(I,T))return sg(r,o,b,0),ft===null&&ig(),!1}catch{}finally{}if(u=Dy(r,o,b,f),u!==null)return ei(u,r,f),SA(u,o,f),!0}return!1}function mv(r,o,u,f){if(f={lane:2,revertLane:Kv(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Ag(r)){if(o)throw Error(n(479))}else o=Dy(r,u,f,2),o!==null&&ei(o,r,2)}function Ag(r){var o=r.alternate;return r===Oe||o!==null&&o===Oe}function xA(r,o){kc=yg=!0;var u=r.pending;u===null?o.next=o:(o.next=u.next,u.next=o),r.pending=o}function SA(r,o,u){if((u&4194048)!==0){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,Rx(r,u)}}var rh={readContext:pn,use:_g,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useLayoutEffect:Mt,useInsertionEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useSyncExternalStore:Mt,useId:Mt,useHostTransitionStatus:Mt,useFormState:Mt,useActionState:Mt,useOptimistic:Mt,useMemoCache:Mt,useCacheRefresh:Mt};rh.useEffectEvent=Mt;var AA={readContext:pn,use:_g,useCallback:function(r,o){return On().memoizedState=[r,o===void 0?null:o],r},useContext:pn,useEffect:oA,useImperativeHandle:function(r,o,u){u=u!=null?u.concat([r]):null,xg(4194308,4,dA.bind(null,o,r),u)},useLayoutEffect:function(r,o){return xg(4194308,4,r,o)},useInsertionEffect:function(r,o){xg(4,2,r,o)},useMemo:function(r,o){var u=On();o=o===void 0?null:o;var f=r();if(Oo){la(!0);try{r()}finally{la(!1)}}return u.memoizedState=[f,o],f},useReducer:function(r,o,u){var f=On();if(u!==void 0){var b=u(o);if(Oo){la(!0);try{u(o)}finally{la(!1)}}}else b=o;return f.memoizedState=f.baseState=b,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:b},f.queue=r,r=r.dispatch=ZI.bind(null,Oe,r),[f.memoizedState,r]},useRef:function(r){var o=On();return r={current:r},o.memoizedState=r},useState:function(r){r=cv(r);var o=r.queue,u=wA.bind(null,Oe,o);return o.dispatch=u,[r.memoizedState,u]},useDebugValue:hv,useDeferredValue:function(r,o){var u=On();return fv(u,r,o)},useTransition:function(){var r=cv(!1);return r=mA.bind(null,Oe,r.queue,!0,!1),On().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,u){var f=Oe,b=On();if(Je){if(u===void 0)throw Error(n(407));u=u()}else{if(u=o(),ft===null)throw Error(n(349));(Ye&127)!==0||$S(f,o,u)}b.memoizedState=u;var w={value:u,getSnapshot:o};return b.queue=w,oA(YS.bind(null,f,w,r),[r]),f.flags|=2048,Dc(9,{destroy:void 0},jS.bind(null,f,w,u,o),null),u},useId:function(){var r=On(),o=ft.identifierPrefix;if(Je){var u=Ds,f=Is;u=(f&~(1<<32-ui(f)-1)).toString(32)+u,o="_"+o+"R_"+u,u=vg++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=jI++,o="_"+o+"r_"+u.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:gv,useFormState:nA,useActionState:nA,useOptimistic:function(r){var o=On();o.memoizedState=o.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=mv.bind(null,Oe,!0,u),u.dispatch=o,[r,o]},useMemoCache:av,useCacheRefresh:function(){return On().memoizedState=QI.bind(null,Oe)},useEffectEvent:function(r){var o=On(),u={impl:r};return o.memoizedState=u,function(){if((nt&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},yv={readContext:pn,use:_g,useCallback:fA,useContext:pn,useEffect:dv,useImperativeHandle:hA,useInsertionEffect:cA,useLayoutEffect:uA,useMemo:pA,useReducer:wg,useRef:aA,useState:function(){return wg(hr)},useDebugValue:hv,useDeferredValue:function(r,o){var u=Pt();return gA(u,lt.memoizedState,r,o)},useTransition:function(){var r=wg(hr)[0],o=Pt().memoizedState;return[typeof r=="boolean"?r:ih(r),o]},useSyncExternalStore:VS,useId:bA,useHostTransitionStatus:gv,useFormState:iA,useActionState:iA,useOptimistic:function(r,o){var u=Pt();return XS(u,lt,r,o)},useMemoCache:av,useCacheRefresh:_A};yv.useEffectEvent=lA;var EA={readContext:pn,use:_g,useCallback:fA,useContext:pn,useEffect:dv,useImperativeHandle:hA,useInsertionEffect:cA,useLayoutEffect:uA,useMemo:pA,useReducer:lv,useRef:aA,useState:function(){return lv(hr)},useDebugValue:hv,useDeferredValue:function(r,o){var u=Pt();return lt===null?fv(u,r,o):gA(u,lt.memoizedState,r,o)},useTransition:function(){var r=lv(hr)[0],o=Pt().memoizedState;return[typeof r=="boolean"?r:ih(r),o]},useSyncExternalStore:VS,useId:bA,useHostTransitionStatus:gv,useFormState:rA,useActionState:rA,useOptimistic:function(r,o){var u=Pt();return lt!==null?XS(u,lt,r,o):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:av,useCacheRefresh:_A};EA.useEffectEvent=lA;function vv(r,o,u,f){o=r.memoizedState,u=u(f,o),u=u==null?o:v({},o,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var bv={enqueueSetState:function(r,o,u){r=r._reactInternals;var f=yi(),b=ma(f);b.payload=o,u!=null&&(b.callback=u),o=ya(r,b,f),o!==null&&(ei(o,r,f),Zd(o,r,f))},enqueueReplaceState:function(r,o,u){r=r._reactInternals;var f=yi(),b=ma(f);b.tag=1,b.payload=o,u!=null&&(b.callback=u),o=ya(r,b,f),o!==null&&(ei(o,r,f),Zd(o,r,f))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var u=yi(),f=ma(u);f.tag=2,o!=null&&(f.callback=o),o=ya(r,f,u),o!==null&&(ei(o,r,u),Zd(o,r,u))}};function TA(r,o,u,f,b,w,T){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(f,w,T):o.prototype&&o.prototype.isPureReactComponent?!$d(u,f)||!$d(b,w):!0}function CA(r,o,u,f){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,f),o.state!==r&&bv.enqueueReplaceState(o,o.state,null)}function Uo(r,o){var u=o;if("ref"in o){u={};for(var f in o)f!=="ref"&&(u[f]=o[f])}if(r=r.defaultProps){u===o&&(u=v({},u));for(var b in r)u[b]===void 0&&(u[b]=r[b])}return u}function RA(r){ng(r)}function NA(r){console.error(r)}function MA(r){ng(r)}function Eg(r,o){try{var u=r.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function kA(r,o,u){try{var f=r.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function _v(r,o,u){return u=ma(u),u.tag=3,u.payload={element:null},u.callback=function(){Eg(r,o)},u}function IA(r){return r=ma(r),r.tag=3,r}function DA(r,o,u,f){var b=u.type.getDerivedStateFromError;if(typeof b=="function"){var w=f.value;r.payload=function(){return b(w)},r.callback=function(){kA(o,u,f)}}var T=u.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(r.callback=function(){kA(o,u,f),typeof b!="function"&&(Sa===null?Sa=new Set([this]):Sa.add(this));var I=f.stack;this.componentDidCatch(f.value,{componentStack:I!==null?I:""})})}function e2(r,o,u,f,b){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=u.alternate,o!==null&&Ec(o,u,b,!0),u=fi.current,u!==null){switch(u.tag){case 31:case 13:return Vi===null?Ug():u.alternate===null&&kt===0&&(kt=3),u.flags&=-257,u.flags|=65536,u.lanes=b,f===hg?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([f]):o.add(f),$v(r,f,b)),!1;case 22:return u.flags|=65536,f===hg?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([f]):u.add(f)),$v(r,f,b)),!1}throw Error(n(435,u.tag))}return $v(r,f,b),Ug(),!1}if(Je)return o=fi.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=b,f!==Hy&&(r=Error(n(422),{cause:f}),Kd(Bi(r,u)))):(f!==Hy&&(o=Error(n(423),{cause:f}),Kd(Bi(o,u))),r=r.current.alternate,r.flags|=65536,b&=-b,r.lanes|=b,f=Bi(f,u),b=_v(r.stateNode,f,b),Xy(r,b),kt!==4&&(kt=2)),!1;var w=Error(n(520),{cause:f});if(w=Bi(w,u),fh===null?fh=[w]:fh.push(w),kt!==4&&(kt=2),o===null)return!0;f=Bi(f,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,r=b&-b,u.lanes|=r,r=_v(u.stateNode,f,r),Xy(u,r),!1;case 1:if(o=u.type,w=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Sa===null||!Sa.has(w))))return u.flags|=65536,b&=-b,u.lanes|=b,b=IA(b),DA(b,r,u,f),Xy(u,b),!1}u=u.return}while(u!==null);return!1}var wv=Error(n(461)),Bt=!1;function gn(r,o,u,f){o.child=r===null?US(o,null,u,f):Lo(o,r.child,u,f)}function PA(r,o,u,f,b){u=u.render;var w=o.ref;if("ref"in f){var T={};for(var I in f)I!=="ref"&&(T[I]=f[I])}else T=f;return ko(o),f=nv(r,o,u,T,w,b),I=iv(),r!==null&&!Bt?(sv(r,o,b),fr(r,o,b)):(Je&&I&&Uy(o),o.flags|=1,gn(r,o,f,b),o.child)}function LA(r,o,u,f,b){if(r===null){var w=u.type;return typeof w=="function"&&!Py(w)&&w.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=w,OA(r,o,w,f,b)):(r=ag(u.type,null,f,o,o.mode,b),r.ref=o.ref,r.return=o,o.child=r)}if(w=r.child,!Nv(r,b)){var T=w.memoizedProps;if(u=u.compare,u=u!==null?u:$d,u(T,f)&&r.ref===o.ref)return fr(r,o,b)}return o.flags|=1,r=or(w,f),r.ref=o.ref,r.return=o,o.child=r}function OA(r,o,u,f,b){if(r!==null){var w=r.memoizedProps;if($d(w,f)&&r.ref===o.ref)if(Bt=!1,o.pendingProps=f=w,Nv(r,b))(r.flags&131072)!==0&&(Bt=!0);else return o.lanes=r.lanes,fr(r,o,b)}return xv(r,o,u,f,b)}function UA(r,o,u,f){var b=f.children,w=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((o.flags&128)!==0){if(w=w!==null?w.baseLanes|u:u,r!==null){for(f=o.child=r.child,b=0;f!==null;)b=b|f.lanes|f.childLanes,f=f.sibling;f=b&~w}else f=0,o.child=null;return FA(r,o,w,u,f)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&ug(o,w!==null?w.cachePool:null),w!==null?BS(o,w):Qy(),GS(o);else return f=o.lanes=536870912,FA(r,o,w!==null?w.baseLanes|u:u,u,f)}else w!==null?(ug(o,w.cachePool),BS(o,w),ba(),o.memoizedState=null):(r!==null&&ug(o,null),Qy(),ba());return gn(r,o,b,u),o.child}function ah(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function FA(r,o,u,f,b){var w=jy();return w=w===null?null:{parent:Ft._currentValue,pool:w},o.memoizedState={baseLanes:u,cachePool:w},r!==null&&ug(o,null),Qy(),GS(o),r!==null&&Ec(r,o,f,!0),o.childLanes=b,null}function Tg(r,o){return o=Rg({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function HA(r,o,u){return Lo(o,r.child,null,u),r=Tg(o,o.pendingProps),r.flags|=2,pi(o),o.memoizedState=null,r}function t2(r,o,u){var f=o.pendingProps,b=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Je){if(f.mode==="hidden")return r=Tg(o,f),o.lanes=536870912,ah(null,r);if(ev(o),(r=yt)?(r=WE(r,qi),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:da!==null?{id:Is,overflow:Ds}:null,retryLane:536870912,hydrationErrors:null},u=xS(r),u.return=o,o.child=u,fn=o,yt=null)):r=null,r===null)throw fa(o);return o.lanes=536870912,null}return Tg(o,f)}var w=r.memoizedState;if(w!==null){var T=w.dehydrated;if(ev(o),b)if(o.flags&256)o.flags&=-257,o=HA(r,o,u);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(n(558));else if(Bt||Ec(r,o,u,!1),b=(u&r.childLanes)!==0,Bt||b){if(f=ft,f!==null&&(T=Nx(f,u),T!==0&&T!==w.retryLane))throw w.retryLane=T,Co(r,T),ei(f,r,T),wv;Ug(),o=HA(r,o,u)}else r=w.treeContext,yt=$i(T.nextSibling),fn=o,Je=!0,ha=null,qi=!1,r!==null&&ES(o,r),o=Tg(o,f),o.flags|=4096;return o}return r=or(r.child,{mode:f.mode,children:f.children}),r.ref=o.ref,o.child=r,r.return=o,r}function Cg(r,o){var u=o.ref;if(u===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(r===null||r.ref!==u)&&(o.flags|=4194816)}}function xv(r,o,u,f,b){return ko(o),u=nv(r,o,u,f,void 0,b),f=iv(),r!==null&&!Bt?(sv(r,o,b),fr(r,o,b)):(Je&&f&&Uy(o),o.flags|=1,gn(r,o,u,b),o.child)}function BA(r,o,u,f,b,w){return ko(o),o.updateQueue=null,u=qS(o,f,u,b),zS(r),f=iv(),r!==null&&!Bt?(sv(r,o,w),fr(r,o,w)):(Je&&f&&Uy(o),o.flags|=1,gn(r,o,u,w),o.child)}function GA(r,o,u,f,b){if(ko(o),o.stateNode===null){var w=wc,T=u.contextType;typeof T=="object"&&T!==null&&(w=pn(T)),w=new u(f,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=bv,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=f,w.state=o.memoizedState,w.refs={},Ky(o),T=u.contextType,w.context=typeof T=="object"&&T!==null?pn(T):wc,w.state=o.memoizedState,T=u.getDerivedStateFromProps,typeof T=="function"&&(vv(o,u,T,f),w.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(T=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),T!==w.state&&bv.enqueueReplaceState(w,w.state,null),th(o,f,w,b),eh(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(r===null){w=o.stateNode;var I=o.memoizedProps,F=Uo(u,I);w.props=F;var $=w.context,Q=u.contextType;T=wc,typeof Q=="object"&&Q!==null&&(T=pn(Q));var ee=u.getDerivedStateFromProps;Q=typeof ee=="function"||typeof w.getSnapshotBeforeUpdate=="function",I=o.pendingProps!==I,Q||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(I||$!==T)&&CA(o,w,f,T),ga=!1;var j=o.memoizedState;w.state=j,th(o,f,w,b),eh(),$=o.memoizedState,I||j!==$||ga?(typeof ee=="function"&&(vv(o,u,ee,f),$=o.memoizedState),(F=ga||TA(o,u,F,f,j,$,T))?(Q||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=$),w.props=f,w.state=$,w.context=T,f=F):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{w=o.stateNode,Jy(r,o),T=o.memoizedProps,Q=Uo(u,T),w.props=Q,ee=o.pendingProps,j=w.context,$=u.contextType,F=wc,typeof $=="object"&&$!==null&&(F=pn($)),I=u.getDerivedStateFromProps,($=typeof I=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(T!==ee||j!==F)&&CA(o,w,f,F),ga=!1,j=o.memoizedState,w.state=j,th(o,f,w,b),eh();var J=o.memoizedState;T!==ee||j!==J||ga||r!==null&&r.dependencies!==null&&lg(r.dependencies)?(typeof I=="function"&&(vv(o,u,I,f),J=o.memoizedState),(Q=ga||TA(o,u,Q,f,j,J,F)||r!==null&&r.dependencies!==null&&lg(r.dependencies))?($||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(f,J,F),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(f,J,F)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||T===r.memoizedProps&&j===r.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&j===r.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=J),w.props=f,w.state=J,w.context=F,f=Q):(typeof w.componentDidUpdate!="function"||T===r.memoizedProps&&j===r.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&j===r.memoizedState||(o.flags|=1024),f=!1)}return w=f,Cg(r,o),f=(o.flags&128)!==0,w||f?(w=o.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,r!==null&&f?(o.child=Lo(o,r.child,null,b),o.child=Lo(o,null,u,b)):gn(r,o,u,b),o.memoizedState=w.state,r=o.child):r=fr(r,o,b),r}function zA(r,o,u,f){return No(),o.flags|=256,gn(r,o,u,f),o.child}var Sv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Av(r){return{baseLanes:r,cachePool:kS()}}function Ev(r,o,u){return r=r!==null?r.childLanes&~u:0,o&&(r|=mi),r}function qA(r,o,u){var f=o.pendingProps,b=!1,w=(o.flags&128)!==0,T;if((T=w)||(T=r!==null&&r.memoizedState===null?!1:(Dt.current&2)!==0),T&&(b=!0,o.flags&=-129),T=(o.flags&32)!==0,o.flags&=-33,r===null){if(Je){if(b?va(o):ba(),(r=yt)?(r=WE(r,qi),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:da!==null?{id:Is,overflow:Ds}:null,retryLane:536870912,hydrationErrors:null},u=xS(r),u.return=o,o.child=u,fn=o,yt=null)):r=null,r===null)throw fa(o);return ob(r)?o.lanes=32:o.lanes=536870912,null}var I=f.children;return f=f.fallback,b?(ba(),b=o.mode,I=Rg({mode:"hidden",children:I},b),f=Ro(f,b,u,null),I.return=o,f.return=o,I.sibling=f,o.child=I,f=o.child,f.memoizedState=Av(u),f.childLanes=Ev(r,T,u),o.memoizedState=Sv,ah(null,f)):(va(o),Tv(o,I))}var F=r.memoizedState;if(F!==null&&(I=F.dehydrated,I!==null)){if(w)o.flags&256?(va(o),o.flags&=-257,o=Cv(r,o,u)):o.memoizedState!==null?(ba(),o.child=r.child,o.flags|=128,o=null):(ba(),I=f.fallback,b=o.mode,f=Rg({mode:"visible",children:f.children},b),I=Ro(I,b,u,null),I.flags|=2,f.return=o,I.return=o,f.sibling=I,o.child=f,Lo(o,r.child,null,u),f=o.child,f.memoizedState=Av(u),f.childLanes=Ev(r,T,u),o.memoizedState=Sv,o=ah(null,f));else if(va(o),ob(I)){if(T=I.nextSibling&&I.nextSibling.dataset,T)var $=T.dgst;T=$,f=Error(n(419)),f.stack="",f.digest=T,Kd({value:f,source:null,stack:null}),o=Cv(r,o,u)}else if(Bt||Ec(r,o,u,!1),T=(u&r.childLanes)!==0,Bt||T){if(T=ft,T!==null&&(f=Nx(T,u),f!==0&&f!==F.retryLane))throw F.retryLane=f,Co(r,f),ei(T,r,f),wv;ab(I)||Ug(),o=Cv(r,o,u)}else ab(I)?(o.flags|=192,o.child=r.child,o=null):(r=F.treeContext,yt=$i(I.nextSibling),fn=o,Je=!0,ha=null,qi=!1,r!==null&&ES(o,r),o=Tv(o,f.children),o.flags|=4096);return o}return b?(ba(),I=f.fallback,b=o.mode,F=r.child,$=F.sibling,f=or(F,{mode:"hidden",children:f.children}),f.subtreeFlags=F.subtreeFlags&65011712,$!==null?I=or($,I):(I=Ro(I,b,u,null),I.flags|=2),I.return=o,f.return=o,f.sibling=I,o.child=f,ah(null,f),f=o.child,I=r.child.memoizedState,I===null?I=Av(u):(b=I.cachePool,b!==null?(F=Ft._currentValue,b=b.parent!==F?{parent:F,pool:F}:b):b=kS(),I={baseLanes:I.baseLanes|u,cachePool:b}),f.memoizedState=I,f.childLanes=Ev(r,T,u),o.memoizedState=Sv,ah(r.child,f)):(va(o),u=r.child,r=u.sibling,u=or(u,{mode:"visible",children:f.children}),u.return=o,u.sibling=null,r!==null&&(T=o.deletions,T===null?(o.deletions=[r],o.flags|=16):T.push(r)),o.child=u,o.memoizedState=null,u)}function Tv(r,o){return o=Rg({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function Rg(r,o){return r=hi(22,r,null,o),r.lanes=0,r}function Cv(r,o,u){return Lo(o,r.child,null,u),r=Tv(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function VA(r,o,u){r.lanes|=o;var f=r.alternate;f!==null&&(f.lanes|=o),zy(r.return,o,u)}function Rv(r,o,u,f,b,w){var T=r.memoizedState;T===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:b,treeForkCount:w}:(T.isBackwards=o,T.rendering=null,T.renderingStartTime=0,T.last=f,T.tail=u,T.tailMode=b,T.treeForkCount=w)}function $A(r,o,u){var f=o.pendingProps,b=f.revealOrder,w=f.tail;f=f.children;var T=Dt.current,I=(T&2)!==0;if(I?(T=T&1|2,o.flags|=128):T&=1,ie(Dt,T),gn(r,o,f,u),f=Je?Yd:0,!I&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&VA(r,u,o);else if(r.tag===19)VA(r,u,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(b){case"forwards":for(u=o.child,b=null;u!==null;)r=u.alternate,r!==null&&mg(r)===null&&(b=u),u=u.sibling;u=b,u===null?(b=o.child,o.child=null):(b=u.sibling,u.sibling=null),Rv(o,!1,b,u,w,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,b=o.child,o.child=null;b!==null;){if(r=b.alternate,r!==null&&mg(r)===null){o.child=b;break}r=b.sibling,b.sibling=u,u=b,b=r}Rv(o,!0,u,null,w,f);break;case"together":Rv(o,!1,null,null,void 0,f);break;default:o.memoizedState=null}return o.child}function fr(r,o,u){if(r!==null&&(o.dependencies=r.dependencies),xa|=o.lanes,(u&o.childLanes)===0)if(r!==null){if(Ec(r,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,u=or(r,r.pendingProps),o.child=u,u.return=o;r.sibling!==null;)r=r.sibling,u=u.sibling=or(r,r.pendingProps),u.return=o;u.sibling=null}return o.child}function Nv(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&lg(r)))}function n2(r,o,u){switch(o.tag){case 3:Nt(o,o.stateNode.containerInfo),pa(o,Ft,r.memoizedState.cache),No();break;case 27:case 5:_o(o);break;case 4:Nt(o,o.stateNode.containerInfo);break;case 10:pa(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,ev(o),null;break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(va(o),o.flags|=128,null):(u&o.child.childLanes)!==0?qA(r,o,u):(va(o),r=fr(r,o,u),r!==null?r.sibling:null);va(o);break;case 19:var b=(r.flags&128)!==0;if(f=(u&o.childLanes)!==0,f||(Ec(r,o,u,!1),f=(u&o.childLanes)!==0),b){if(f)return $A(r,o,u);o.flags|=128}if(b=o.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),ie(Dt,Dt.current),f)break;return null;case 22:return o.lanes=0,UA(r,o,u,o.pendingProps);case 24:pa(o,Ft,r.memoizedState.cache)}return fr(r,o,u)}function jA(r,o,u){if(r!==null)if(r.memoizedProps!==o.pendingProps)Bt=!0;else{if(!Nv(r,u)&&(o.flags&128)===0)return Bt=!1,n2(r,o,u);Bt=(r.flags&131072)!==0}else Bt=!1,Je&&(o.flags&1048576)!==0&&AS(o,Yd,o.index);switch(o.lanes=0,o.tag){case 16:e:{var f=o.pendingProps;if(r=Do(o.elementType),o.type=r,typeof r=="function")Py(r)?(f=Uo(r,f),o.tag=1,o=GA(null,o,r,f,u)):(o.tag=0,o=xv(null,o,r,f,u));else{if(r!=null){var b=r.$$typeof;if(b===L){o.tag=11,o=PA(null,o,r,f,u);break e}else if(b===O){o.tag=14,o=LA(null,o,r,f,u);break e}}throw o=ye(r)||r,Error(n(306,o,""))}}return o;case 0:return xv(r,o,o.type,o.pendingProps,u);case 1:return f=o.type,b=Uo(f,o.pendingProps),GA(r,o,f,b,u);case 3:e:{if(Nt(o,o.stateNode.containerInfo),r===null)throw Error(n(387));f=o.pendingProps;var w=o.memoizedState;b=w.element,Jy(r,o),th(o,f,null,u);var T=o.memoizedState;if(f=T.cache,pa(o,Ft,f),f!==w.cache&&qy(o,[Ft],u,!0),eh(),f=T.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:T.cache},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){o=zA(r,o,f,u);break e}else if(f!==b){b=Bi(Error(n(424)),o),Kd(b),o=zA(r,o,f,u);break e}else{switch(r=o.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(yt=$i(r.firstChild),fn=o,Je=!0,ha=null,qi=!0,u=US(o,null,f,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(No(),f===b){o=fr(r,o,u);break e}gn(r,o,f,u)}o=o.child}return o;case 26:return Cg(r,o),r===null?(u=iT(o.type,null,o.pendingProps,null))?o.memoizedState=u:Je||(u=o.type,r=o.pendingProps,f=Vg(Ee.current).createElement(u),f[hn]=o,f[Kn]=r,mn(f,u,r),tn(f),o.stateNode=f):o.memoizedState=iT(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return _o(o),r===null&&Je&&(f=o.stateNode=eT(o.type,o.pendingProps,Ee.current),fn=o,qi=!0,b=yt,Ca(o.type)?(lb=b,yt=$i(f.firstChild)):yt=b),gn(r,o,o.pendingProps.children,u),Cg(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Je&&((b=f=yt)&&(f=I2(f,o.type,o.pendingProps,qi),f!==null?(o.stateNode=f,fn=o,yt=$i(f.firstChild),qi=!1,b=!0):b=!1),b||fa(o)),_o(o),b=o.type,w=o.pendingProps,T=r!==null?r.memoizedProps:null,f=w.children,ib(b,w)?f=null:T!==null&&ib(b,T)&&(o.flags|=32),o.memoizedState!==null&&(b=nv(r,o,YI,null,null,u),wh._currentValue=b),Cg(r,o),gn(r,o,f,u),o.child;case 6:return r===null&&Je&&((r=u=yt)&&(u=D2(u,o.pendingProps,qi),u!==null?(o.stateNode=u,fn=o,yt=null,r=!0):r=!1),r||fa(o)),null;case 13:return qA(r,o,u);case 4:return Nt(o,o.stateNode.containerInfo),f=o.pendingProps,r===null?o.child=Lo(o,null,f,u):gn(r,o,f,u),o.child;case 11:return PA(r,o,o.type,o.pendingProps,u);case 7:return gn(r,o,o.pendingProps,u),o.child;case 8:return gn(r,o,o.pendingProps.children,u),o.child;case 12:return gn(r,o,o.pendingProps.children,u),o.child;case 10:return f=o.pendingProps,pa(o,o.type,f.value),gn(r,o,f.children,u),o.child;case 9:return b=o.type._context,f=o.pendingProps.children,ko(o),b=pn(b),f=f(b),o.flags|=1,gn(r,o,f,u),o.child;case 14:return LA(r,o,o.type,o.pendingProps,u);case 15:return OA(r,o,o.type,o.pendingProps,u);case 19:return $A(r,o,u);case 31:return t2(r,o,u);case 22:return UA(r,o,u,o.pendingProps);case 24:return ko(o),f=pn(Ft),r===null?(b=jy(),b===null&&(b=ft,w=Vy(),b.pooledCache=w,w.refCount++,w!==null&&(b.pooledCacheLanes|=u),b=w),o.memoizedState={parent:f,cache:b},Ky(o),pa(o,Ft,b)):((r.lanes&u)!==0&&(Jy(r,o),th(o,null,null,u),eh()),b=r.memoizedState,w=o.memoizedState,b.parent!==f?(b={parent:f,cache:f},o.memoizedState=b,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=b),pa(o,Ft,f)):(f=w.cache,pa(o,Ft,f),f!==b.cache&&qy(o,[Ft],u,!0))),gn(r,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function pr(r){r.flags|=4}function Mv(r,o,u,f,b){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(b&335544128)===b)if(r.stateNode.complete)r.flags|=8192;else if(bE())r.flags|=8192;else throw Po=hg,Yy}else r.flags&=-16777217}function YA(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!lT(o))if(bE())r.flags|=8192;else throw Po=hg,Yy}function Ng(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?Tx():536870912,r.lanes|=o,Uc|=o)}function oh(r,o){if(!Je)switch(r.tailMode){case"hidden":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:f.sibling=null}}function vt(r){var o=r.alternate!==null&&r.alternate.child===r.child,u=0,f=0;if(o)for(var b=r.child;b!==null;)u|=b.lanes|b.childLanes,f|=b.subtreeFlags&65011712,f|=b.flags&65011712,b.return=r,b=b.sibling;else for(b=r.child;b!==null;)u|=b.lanes|b.childLanes,f|=b.subtreeFlags,f|=b.flags,b.return=r,b=b.sibling;return r.subtreeFlags|=f,r.childLanes=u,o}function i2(r,o,u){var f=o.pendingProps;switch(Fy(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vt(o),null;case 1:return vt(o),null;case 3:return u=o.stateNode,f=null,r!==null&&(f=r.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),ur(Ft),_t(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(Ac(o)?pr(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,By())),vt(o),null;case 26:var b=o.type,w=o.memoizedState;return r===null?(pr(o),w!==null?(vt(o),YA(o,w)):(vt(o),Mv(o,b,null,f,u))):w?w!==r.memoizedState?(pr(o),vt(o),YA(o,w)):(vt(o),o.flags&=-16777217):(r=r.memoizedProps,r!==f&&pr(o),vt(o),Mv(o,b,r,f,u)),null;case 27:if(Bp(o),u=Ee.current,b=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&pr(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return vt(o),null}r=oe.current,Ac(o)?TS(o):(r=eT(b,f,u),o.stateNode=r,pr(o))}return vt(o),null;case 5:if(Bp(o),b=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&pr(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return vt(o),null}if(w=oe.current,Ac(o))TS(o);else{var T=Vg(Ee.current);switch(w){case 1:w=T.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:w=T.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":w=T.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":w=T.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":w=T.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof f.is=="string"?T.createElement("select",{is:f.is}):T.createElement("select"),f.multiple?w.multiple=!0:f.size&&(w.size=f.size);break;default:w=typeof f.is=="string"?T.createElement(b,{is:f.is}):T.createElement(b)}}w[hn]=o,w[Kn]=f;e:for(T=o.child;T!==null;){if(T.tag===5||T.tag===6)w.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===o)break e;for(;T.sibling===null;){if(T.return===null||T.return===o)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}o.stateNode=w;e:switch(mn(w,b,f),b){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&pr(o)}}return vt(o),Mv(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,u),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==f&&pr(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(n(166));if(r=Ee.current,Ac(o)){if(r=o.stateNode,u=o.memoizedProps,f=null,b=fn,b!==null)switch(b.tag){case 27:case 5:f=b.memoizedProps}r[hn]=o,r=!!(r.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||qE(r.nodeValue,u)),r||fa(o,!0)}else r=Vg(r).createTextNode(f),r[hn]=o,o.stateNode=r}return vt(o),null;case 31:if(u=o.memoizedState,r===null||r.memoizedState!==null){if(f=Ac(o),u!==null){if(r===null){if(!f)throw Error(n(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[hn]=o}else No(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;vt(o),r=!1}else u=By(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return o.flags&256?(pi(o),o):(pi(o),null);if((o.flags&128)!==0)throw Error(n(558))}return vt(o),null;case 13:if(f=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(b=Ac(o),f!==null&&f.dehydrated!==null){if(r===null){if(!b)throw Error(n(318));if(b=o.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(n(317));b[hn]=o}else No(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;vt(o),b=!1}else b=By(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=b),b=!0;if(!b)return o.flags&256?(pi(o),o):(pi(o),null)}return pi(o),(o.flags&128)!==0?(o.lanes=u,o):(u=f!==null,r=r!==null&&r.memoizedState!==null,u&&(f=o.child,b=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(b=f.alternate.memoizedState.cachePool.pool),w=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(w=f.memoizedState.cachePool.pool),w!==b&&(f.flags|=2048)),u!==r&&u&&(o.child.flags|=8192),Ng(o,o.updateQueue),vt(o),null);case 4:return _t(),r===null&&Qv(o.stateNode.containerInfo),vt(o),null;case 10:return ur(o.type),vt(o),null;case 19:if(K(Dt),f=o.memoizedState,f===null)return vt(o),null;if(b=(o.flags&128)!==0,w=f.rendering,w===null)if(b)oh(f,!1);else{if(kt!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(w=mg(r),w!==null){for(o.flags|=128,oh(f,!1),r=w.updateQueue,o.updateQueue=r,Ng(o,r),o.subtreeFlags=0,r=u,u=o.child;u!==null;)wS(u,r),u=u.sibling;return ie(Dt,Dt.current&1|2),Je&&lr(o,f.treeForkCount),o.child}r=r.sibling}f.tail!==null&&li()>Pg&&(o.flags|=128,b=!0,oh(f,!1),o.lanes=4194304)}else{if(!b)if(r=mg(w),r!==null){if(o.flags|=128,b=!0,r=r.updateQueue,o.updateQueue=r,Ng(o,r),oh(f,!0),f.tail===null&&f.tailMode==="hidden"&&!w.alternate&&!Je)return vt(o),null}else 2*li()-f.renderingStartTime>Pg&&u!==536870912&&(o.flags|=128,b=!0,oh(f,!1),o.lanes=4194304);f.isBackwards?(w.sibling=o.child,o.child=w):(r=f.last,r!==null?r.sibling=w:o.child=w,f.last=w)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=li(),r.sibling=null,u=Dt.current,ie(Dt,b?u&1|2:u&1),Je&&lr(o,f.treeForkCount),r):(vt(o),null);case 22:case 23:return pi(o),Zy(),f=o.memoizedState!==null,r!==null?r.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(u&536870912)!==0&&(o.flags&128)===0&&(vt(o),o.subtreeFlags&6&&(o.flags|=8192)):vt(o),u=o.updateQueue,u!==null&&Ng(o,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==u&&(o.flags|=2048),r!==null&&K(Io),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),ur(Ft),vt(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function s2(r,o){switch(Fy(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return ur(Ft),_t(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return Bp(o),null;case 31:if(o.memoizedState!==null){if(pi(o),o.alternate===null)throw Error(n(340));No()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(pi(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));No()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return K(Dt),null;case 4:return _t(),null;case 10:return ur(o.type),null;case 22:case 23:return pi(o),Zy(),r!==null&&K(Io),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return ur(Ft),null;case 25:return null;default:return null}}function KA(r,o){switch(Fy(o),o.tag){case 3:ur(Ft),_t();break;case 26:case 27:case 5:Bp(o);break;case 4:_t();break;case 31:o.memoizedState!==null&&pi(o);break;case 13:pi(o);break;case 19:K(Dt);break;case 10:ur(o.type);break;case 22:case 23:pi(o),Zy(),r!==null&&K(Io);break;case 24:ur(Ft)}}function lh(r,o){try{var u=o.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var b=f.next;u=b;do{if((u.tag&r)===r){f=void 0;var w=u.create,T=u.inst;f=w(),T.destroy=f}u=u.next}while(u!==b)}}catch(I){rt(o,o.return,I)}}function _a(r,o,u){try{var f=o.updateQueue,b=f!==null?f.lastEffect:null;if(b!==null){var w=b.next;f=w;do{if((f.tag&r)===r){var T=f.inst,I=T.destroy;if(I!==void 0){T.destroy=void 0,b=o;var F=u,$=I;try{$()}catch(Q){rt(b,F,Q)}}}f=f.next}while(f!==w)}}catch(Q){rt(o,o.return,Q)}}function JA(r){var o=r.updateQueue;if(o!==null){var u=r.stateNode;try{HS(o,u)}catch(f){rt(r,r.return,f)}}}function XA(r,o,u){u.props=Uo(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(f){rt(r,o,f)}}function ch(r,o){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var f=r.stateNode;break;case 30:f=r.stateNode;break;default:f=r.stateNode}typeof u=="function"?r.refCleanup=u(f):u.current=f}}catch(b){rt(r,o,b)}}function Ps(r,o){var u=r.ref,f=r.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(b){rt(r,o,b)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(b){rt(r,o,b)}else u.current=null}function WA(r){var o=r.type,u=r.memoizedProps,f=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(b){rt(r,r.return,b)}}function kv(r,o,u){try{var f=r.stateNode;T2(f,r.type,u,o),f[Kn]=o}catch(b){rt(r,r.return,b)}}function QA(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Ca(r.type)||r.tag===4}function Iv(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||QA(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Ca(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Dv(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(r),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=rr));else if(f!==4&&(f===27&&Ca(r.type)&&(u=r.stateNode,o=null),r=r.child,r!==null))for(Dv(r,o,u),r=r.sibling;r!==null;)Dv(r,o,u),r=r.sibling}function Mg(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?u.insertBefore(r,o):u.appendChild(r);else if(f!==4&&(f===27&&Ca(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(Mg(r,o,u),r=r.sibling;r!==null;)Mg(r,o,u),r=r.sibling}function ZA(r){var o=r.stateNode,u=r.memoizedProps;try{for(var f=r.type,b=o.attributes;b.length;)o.removeAttributeNode(b[0]);mn(o,f,u),o[hn]=r,o[Kn]=u}catch(w){rt(r,r.return,w)}}var gr=!1,Gt=!1,Pv=!1,eE=typeof WeakSet=="function"?WeakSet:Set,nn=null;function r2(r,o){if(r=r.containerInfo,tb=Wg,r=hS(r),Cy(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var b=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var T=0,I=-1,F=-1,$=0,Q=0,ee=r,j=null;t:for(;;){for(var J;ee!==u||b!==0&&ee.nodeType!==3||(I=T+b),ee!==w||f!==0&&ee.nodeType!==3||(F=T+f),ee.nodeType===3&&(T+=ee.nodeValue.length),(J=ee.firstChild)!==null;)j=ee,ee=J;for(;;){if(ee===r)break t;if(j===u&&++$===b&&(I=T),j===w&&++Q===f&&(F=T),(J=ee.nextSibling)!==null)break;ee=j,j=ee.parentNode}ee=J}u=I===-1||F===-1?null:{start:I,end:F}}else u=null}u=u||{start:0,end:0}}else u=null;for(nb={focusedElem:r,selectionRange:u},Wg=!1,nn=o;nn!==null;)if(o=nn,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,nn=r;else for(;nn!==null;){switch(o=nn,w=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)b=r[u],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&w!==null){r=void 0,u=o,b=w.memoizedProps,w=w.memoizedState,f=u.stateNode;try{var pe=Uo(u.type,b);r=f.getSnapshotBeforeUpdate(pe,w),f.__reactInternalSnapshotBeforeUpdate=r}catch(Ce){rt(u,u.return,Ce)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,u=r.nodeType,u===9)rb(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":rb(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,nn=r;break}nn=o.return}}function tE(r,o,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:yr(r,u),f&4&&lh(5,u);break;case 1:if(yr(r,u),f&4)if(r=u.stateNode,o===null)try{r.componentDidMount()}catch(T){rt(u,u.return,T)}else{var b=Uo(u.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(b,o,r.__reactInternalSnapshotBeforeUpdate)}catch(T){rt(u,u.return,T)}}f&64&&JA(u),f&512&&ch(u,u.return);break;case 3:if(yr(r,u),f&64&&(r=u.updateQueue,r!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{HS(r,o)}catch(T){rt(u,u.return,T)}}break;case 27:o===null&&f&4&&ZA(u);case 26:case 5:yr(r,u),o===null&&f&4&&WA(u),f&512&&ch(u,u.return);break;case 12:yr(r,u);break;case 31:yr(r,u),f&4&&sE(r,u);break;case 13:yr(r,u),f&4&&rE(r,u),f&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=p2.bind(null,u),P2(r,u))));break;case 22:if(f=u.memoizedState!==null||gr,!f){o=o!==null&&o.memoizedState!==null||Gt,b=gr;var w=Gt;gr=f,(Gt=o)&&!w?vr(r,u,(u.subtreeFlags&8772)!==0):yr(r,u),gr=b,Gt=w}break;case 30:break;default:yr(r,u)}}function nE(r){var o=r.alternate;o!==null&&(r.alternate=null,nE(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&uy(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var wt=null,Xn=!1;function mr(r,o,u){for(u=u.child;u!==null;)iE(r,o,u),u=u.sibling}function iE(r,o,u){if(ci&&typeof ci.onCommitFiberUnmount=="function")try{ci.onCommitFiberUnmount(Dd,u)}catch{}switch(u.tag){case 26:Gt||Ps(u,o),mr(r,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Gt||Ps(u,o);var f=wt,b=Xn;Ca(u.type)&&(wt=u.stateNode,Xn=!1),mr(r,o,u),vh(u.stateNode),wt=f,Xn=b;break;case 5:Gt||Ps(u,o);case 6:if(f=wt,b=Xn,wt=null,mr(r,o,u),wt=f,Xn=b,wt!==null)if(Xn)try{(wt.nodeType===9?wt.body:wt.nodeName==="HTML"?wt.ownerDocument.body:wt).removeChild(u.stateNode)}catch(w){rt(u,o,w)}else try{wt.removeChild(u.stateNode)}catch(w){rt(u,o,w)}break;case 18:wt!==null&&(Xn?(r=wt,JE(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),$c(r)):JE(wt,u.stateNode));break;case 4:f=wt,b=Xn,wt=u.stateNode.containerInfo,Xn=!0,mr(r,o,u),wt=f,Xn=b;break;case 0:case 11:case 14:case 15:_a(2,u,o),Gt||_a(4,u,o),mr(r,o,u);break;case 1:Gt||(Ps(u,o),f=u.stateNode,typeof f.componentWillUnmount=="function"&&XA(u,o,f)),mr(r,o,u);break;case 21:mr(r,o,u);break;case 22:Gt=(f=Gt)||u.memoizedState!==null,mr(r,o,u),Gt=f;break;default:mr(r,o,u)}}function sE(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{$c(r)}catch(u){rt(o,o.return,u)}}}function rE(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{$c(r)}catch(u){rt(o,o.return,u)}}function a2(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new eE),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new eE),o;default:throw Error(n(435,r.tag))}}function kg(r,o){var u=a2(r);o.forEach(function(f){if(!u.has(f)){u.add(f);var b=g2.bind(null,r,f);f.then(b,b)}})}function Wn(r,o){var u=o.deletions;if(u!==null)for(var f=0;f<u.length;f++){var b=u[f],w=r,T=o,I=T;e:for(;I!==null;){switch(I.tag){case 27:if(Ca(I.type)){wt=I.stateNode,Xn=!1;break e}break;case 5:wt=I.stateNode,Xn=!1;break e;case 3:case 4:wt=I.stateNode.containerInfo,Xn=!0;break e}I=I.return}if(wt===null)throw Error(n(160));iE(w,T,b),wt=null,Xn=!1,w=b.alternate,w!==null&&(w.return=null),b.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)aE(o,r),o=o.sibling}var os=null;function aE(r,o){var u=r.alternate,f=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Wn(o,r),Qn(r),f&4&&(_a(3,r,r.return),lh(3,r),_a(5,r,r.return));break;case 1:Wn(o,r),Qn(r),f&512&&(Gt||u===null||Ps(u,u.return)),f&64&&gr&&(r=r.updateQueue,r!==null&&(f=r.callbacks,f!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var b=os;if(Wn(o,r),Qn(r),f&512&&(Gt||u===null||Ps(u,u.return)),f&4){var w=u!==null?u.memoizedState:null;if(f=r.memoizedState,u===null)if(f===null)if(r.stateNode===null){e:{f=r.type,u=r.memoizedProps,b=b.ownerDocument||b;t:switch(f){case"title":w=b.getElementsByTagName("title")[0],(!w||w[Od]||w[hn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=b.createElement(f),b.head.insertBefore(w,b.querySelector("head > title"))),mn(w,f,u),w[hn]=r,tn(w),f=w;break e;case"link":var T=aT("link","href",b).get(f+(u.href||""));if(T){for(var I=0;I<T.length;I++)if(w=T[I],w.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&w.getAttribute("rel")===(u.rel==null?null:u.rel)&&w.getAttribute("title")===(u.title==null?null:u.title)&&w.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){T.splice(I,1);break t}}w=b.createElement(f),mn(w,f,u),b.head.appendChild(w);break;case"meta":if(T=aT("meta","content",b).get(f+(u.content||""))){for(I=0;I<T.length;I++)if(w=T[I],w.getAttribute("content")===(u.content==null?null:""+u.content)&&w.getAttribute("name")===(u.name==null?null:u.name)&&w.getAttribute("property")===(u.property==null?null:u.property)&&w.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&w.getAttribute("charset")===(u.charSet==null?null:u.charSet)){T.splice(I,1);break t}}w=b.createElement(f),mn(w,f,u),b.head.appendChild(w);break;default:throw Error(n(468,f))}w[hn]=r,tn(w),f=w}r.stateNode=f}else oT(b,r.type,r.stateNode);else r.stateNode=rT(b,f,r.memoizedProps);else w!==f?(w===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):w.count--,f===null?oT(b,r.type,r.stateNode):rT(b,f,r.memoizedProps)):f===null&&r.stateNode!==null&&kv(r,r.memoizedProps,u.memoizedProps)}break;case 27:Wn(o,r),Qn(r),f&512&&(Gt||u===null||Ps(u,u.return)),u!==null&&f&4&&kv(r,r.memoizedProps,u.memoizedProps);break;case 5:if(Wn(o,r),Qn(r),f&512&&(Gt||u===null||Ps(u,u.return)),r.flags&32){b=r.stateNode;try{pc(b,"")}catch(pe){rt(r,r.return,pe)}}f&4&&r.stateNode!=null&&(b=r.memoizedProps,kv(r,b,u!==null?u.memoizedProps:b)),f&1024&&(Pv=!0);break;case 6:if(Wn(o,r),Qn(r),f&4){if(r.stateNode===null)throw Error(n(162));f=r.memoizedProps,u=r.stateNode;try{u.nodeValue=f}catch(pe){rt(r,r.return,pe)}}break;case 3:if(Yg=null,b=os,os=$g(o.containerInfo),Wn(o,r),os=b,Qn(r),f&4&&u!==null&&u.memoizedState.isDehydrated)try{$c(o.containerInfo)}catch(pe){rt(r,r.return,pe)}Pv&&(Pv=!1,oE(r));break;case 4:f=os,os=$g(r.stateNode.containerInfo),Wn(o,r),Qn(r),os=f;break;case 12:Wn(o,r),Qn(r);break;case 31:Wn(o,r),Qn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,kg(r,f)));break;case 13:Wn(o,r),Qn(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Dg=li()),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,kg(r,f)));break;case 22:b=r.memoizedState!==null;var F=u!==null&&u.memoizedState!==null,$=gr,Q=Gt;if(gr=$||b,Gt=Q||F,Wn(o,r),Gt=Q,gr=$,Qn(r),f&8192)e:for(o=r.stateNode,o._visibility=b?o._visibility&-2:o._visibility|1,b&&(u===null||F||gr||Gt||Fo(r)),u=null,o=r;;){if(o.tag===5||o.tag===26){if(u===null){F=u=o;try{if(w=F.stateNode,b)T=w.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{I=F.stateNode;var ee=F.memoizedProps.style,j=ee!=null&&ee.hasOwnProperty("display")?ee.display:null;I.style.display=j==null||typeof j=="boolean"?"":(""+j).trim()}}catch(pe){rt(F,F.return,pe)}}}else if(o.tag===6){if(u===null){F=o;try{F.stateNode.nodeValue=b?"":F.memoizedProps}catch(pe){rt(F,F.return,pe)}}}else if(o.tag===18){if(u===null){F=o;try{var J=F.stateNode;b?XE(J,!0):XE(F.stateNode,!1)}catch(pe){rt(F,F.return,pe)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=r.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,kg(r,u))));break;case 19:Wn(o,r),Qn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,kg(r,f)));break;case 30:break;case 21:break;default:Wn(o,r),Qn(r)}}function Qn(r){var o=r.flags;if(o&2){try{for(var u,f=r.return;f!==null;){if(QA(f)){u=f;break}f=f.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var b=u.stateNode,w=Iv(r);Mg(r,w,b);break;case 5:var T=u.stateNode;u.flags&32&&(pc(T,""),u.flags&=-33);var I=Iv(r);Mg(r,I,T);break;case 3:case 4:var F=u.stateNode.containerInfo,$=Iv(r);Dv(r,$,F);break;default:throw Error(n(161))}}catch(Q){rt(r,r.return,Q)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function oE(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;oE(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function yr(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)tE(r,o.alternate,o),o=o.sibling}function Fo(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:_a(4,o,o.return),Fo(o);break;case 1:Ps(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&XA(o,o.return,u),Fo(o);break;case 27:vh(o.stateNode);case 26:case 5:Ps(o,o.return),Fo(o);break;case 22:o.memoizedState===null&&Fo(o);break;case 30:Fo(o);break;default:Fo(o)}r=r.sibling}}function vr(r,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,b=r,w=o,T=w.flags;switch(w.tag){case 0:case 11:case 15:vr(b,w,u),lh(4,w);break;case 1:if(vr(b,w,u),f=w,b=f.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch($){rt(f,f.return,$)}if(f=w,b=f.updateQueue,b!==null){var I=f.stateNode;try{var F=b.shared.hiddenCallbacks;if(F!==null)for(b.shared.hiddenCallbacks=null,b=0;b<F.length;b++)FS(F[b],I)}catch($){rt(f,f.return,$)}}u&&T&64&&JA(w),ch(w,w.return);break;case 27:ZA(w);case 26:case 5:vr(b,w,u),u&&f===null&&T&4&&WA(w),ch(w,w.return);break;case 12:vr(b,w,u);break;case 31:vr(b,w,u),u&&T&4&&sE(b,w);break;case 13:vr(b,w,u),u&&T&4&&rE(b,w);break;case 22:w.memoizedState===null&&vr(b,w,u),ch(w,w.return);break;case 30:break;default:vr(b,w,u)}o=o.sibling}}function Lv(r,o){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&Jd(u))}function Ov(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Jd(r))}function ls(r,o,u,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)lE(r,o,u,f),o=o.sibling}function lE(r,o,u,f){var b=o.flags;switch(o.tag){case 0:case 11:case 15:ls(r,o,u,f),b&2048&&lh(9,o);break;case 1:ls(r,o,u,f);break;case 3:ls(r,o,u,f),b&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Jd(r)));break;case 12:if(b&2048){ls(r,o,u,f),r=o.stateNode;try{var w=o.memoizedProps,T=w.id,I=w.onPostCommit;typeof I=="function"&&I(T,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(F){rt(o,o.return,F)}}else ls(r,o,u,f);break;case 31:ls(r,o,u,f);break;case 13:ls(r,o,u,f);break;case 23:break;case 22:w=o.stateNode,T=o.alternate,o.memoizedState!==null?w._visibility&2?ls(r,o,u,f):uh(r,o):w._visibility&2?ls(r,o,u,f):(w._visibility|=2,Pc(r,o,u,f,(o.subtreeFlags&10256)!==0||!1)),b&2048&&Lv(T,o);break;case 24:ls(r,o,u,f),b&2048&&Ov(o.alternate,o);break;default:ls(r,o,u,f)}}function Pc(r,o,u,f,b){for(b=b&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var w=r,T=o,I=u,F=f,$=T.flags;switch(T.tag){case 0:case 11:case 15:Pc(w,T,I,F,b),lh(8,T);break;case 23:break;case 22:var Q=T.stateNode;T.memoizedState!==null?Q._visibility&2?Pc(w,T,I,F,b):uh(w,T):(Q._visibility|=2,Pc(w,T,I,F,b)),b&&$&2048&&Lv(T.alternate,T);break;case 24:Pc(w,T,I,F,b),b&&$&2048&&Ov(T.alternate,T);break;default:Pc(w,T,I,F,b)}o=o.sibling}}function uh(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=r,f=o,b=f.flags;switch(f.tag){case 22:uh(u,f),b&2048&&Lv(f.alternate,f);break;case 24:uh(u,f),b&2048&&Ov(f.alternate,f);break;default:uh(u,f)}o=o.sibling}}var dh=8192;function Lc(r,o,u){if(r.subtreeFlags&dh)for(r=r.child;r!==null;)cE(r,o,u),r=r.sibling}function cE(r,o,u){switch(r.tag){case 26:Lc(r,o,u),r.flags&dh&&r.memoizedState!==null&&j2(u,os,r.memoizedState,r.memoizedProps);break;case 5:Lc(r,o,u);break;case 3:case 4:var f=os;os=$g(r.stateNode.containerInfo),Lc(r,o,u),os=f;break;case 22:r.memoizedState===null&&(f=r.alternate,f!==null&&f.memoizedState!==null?(f=dh,dh=16777216,Lc(r,o,u),dh=f):Lc(r,o,u));break;default:Lc(r,o,u)}}function uE(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function hh(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];nn=f,hE(f,r)}uE(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)dE(r),r=r.sibling}function dE(r){switch(r.tag){case 0:case 11:case 15:hh(r),r.flags&2048&&_a(9,r,r.return);break;case 3:hh(r);break;case 12:hh(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,Ig(r)):hh(r);break;default:hh(r)}}function Ig(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];nn=f,hE(f,r)}uE(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:_a(8,o,o.return),Ig(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,Ig(o));break;default:Ig(o)}r=r.sibling}}function hE(r,o){for(;nn!==null;){var u=nn;switch(u.tag){case 0:case 11:case 15:_a(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Jd(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,nn=f;else e:for(u=r;nn!==null;){f=nn;var b=f.sibling,w=f.return;if(nE(f),f===u){nn=null;break e}if(b!==null){b.return=w,nn=b;break e}nn=w}}}var o2={getCacheForType:function(r){var o=pn(Ft),u=o.data.get(r);return u===void 0&&(u=r(),o.data.set(r,u)),u},cacheSignal:function(){return pn(Ft).controller.signal}},l2=typeof WeakMap=="function"?WeakMap:Map,nt=0,ft=null,$e=null,Ye=0,st=0,gi=null,wa=!1,Oc=!1,Uv=!1,br=0,kt=0,xa=0,Ho=0,Fv=0,mi=0,Uc=0,fh=null,Zn=null,Hv=!1,Dg=0,fE=0,Pg=1/0,Lg=null,Sa=null,jt=0,Aa=null,Fc=null,_r=0,Bv=0,Gv=null,pE=null,ph=0,zv=null;function yi(){return(nt&2)!==0&&Ye!==0?Ye&-Ye:G.T!==null?Kv():Mx()}function gE(){if(mi===0)if((Ye&536870912)===0||Je){var r=qp;qp<<=1,(qp&3932160)===0&&(qp=262144),mi=r}else mi=536870912;return r=fi.current,r!==null&&(r.flags|=32),mi}function ei(r,o,u){(r===ft&&(st===2||st===9)||r.cancelPendingCommit!==null)&&(Hc(r,0),Ea(r,Ye,mi,!1)),Ld(r,u),((nt&2)===0||r!==ft)&&(r===ft&&((nt&2)===0&&(Ho|=u),kt===4&&Ea(r,Ye,mi,!1)),Ls(r))}function mE(r,o,u){if((nt&6)!==0)throw Error(n(327));var f=!u&&(o&127)===0&&(o&r.expiredLanes)===0||Pd(r,o),b=f?d2(r,o):Vv(r,o,!0),w=f;do{if(b===0){Oc&&!f&&Ea(r,o,0,!1);break}else{if(u=r.current.alternate,w&&!c2(u)){b=Vv(r,o,!1),w=!1;continue}if(b===2){if(w=o,r.errorRecoveryDisabledLanes&w)var T=0;else T=r.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){o=T;e:{var I=r;b=fh;var F=I.current.memoizedState.isDehydrated;if(F&&(Hc(I,T).flags|=256),T=Vv(I,T,!1),T!==2){if(Uv&&!F){I.errorRecoveryDisabledLanes|=w,Ho|=w,b=4;break e}w=Zn,Zn=b,w!==null&&(Zn===null?Zn=w:Zn.push.apply(Zn,w))}b=T}if(w=!1,b!==2)continue}}if(b===1){Hc(r,0),Ea(r,o,0,!0);break}e:{switch(f=r,w=b,w){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:Ea(f,o,mi,!wa);break e;case 2:Zn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(b=Dg+300-li(),10<b)){if(Ea(f,o,mi,!wa),$p(f,0,!0)!==0)break e;_r=o,f.timeoutHandle=YE(yE.bind(null,f,u,Zn,Lg,Hv,o,mi,Ho,Uc,wa,w,"Throttled",-0,0),b);break e}yE(f,u,Zn,Lg,Hv,o,mi,Ho,Uc,wa,w,null,-0,0)}}break}while(!0);Ls(r)}function yE(r,o,u,f,b,w,T,I,F,$,Q,ee,j,J){if(r.timeoutHandle=-1,ee=o.subtreeFlags,ee&8192||(ee&16785408)===16785408){ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:rr},cE(o,w,ee);var pe=(w&62914560)===w?Dg-li():(w&4194048)===w?fE-li():0;if(pe=Y2(ee,pe),pe!==null){_r=w,r.cancelPendingCommit=pe(EE.bind(null,r,o,w,u,f,b,T,I,F,Q,ee,null,j,J)),Ea(r,w,T,!$);return}}EE(r,o,w,u,f,b,T,I,F)}function c2(r){for(var o=r;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var b=u[f],w=b.getSnapshot;b=b.value;try{if(!di(w(),b))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ea(r,o,u,f){o&=~Fv,o&=~Ho,r.suspendedLanes|=o,r.pingedLanes&=~o,f&&(r.warmLanes|=o),f=r.expirationTimes;for(var b=o;0<b;){var w=31-ui(b),T=1<<w;f[w]=-1,b&=~T}u!==0&&Cx(r,u,o)}function Og(){return(nt&6)===0?(gh(0),!1):!0}function qv(){if($e!==null){if(st===0)var r=$e.return;else r=$e,cr=Mo=null,rv(r),Nc=null,Wd=0,r=$e;for(;r!==null;)KA(r.alternate,r),r=r.return;$e=null}}function Hc(r,o){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,N2(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),_r=0,qv(),ft=r,$e=u=or(r.current,null),Ye=o,st=0,gi=null,wa=!1,Oc=Pd(r,o),Uv=!1,Uc=mi=Fv=Ho=xa=kt=0,Zn=fh=null,Hv=!1,(o&8)!==0&&(o|=o&32);var f=r.entangledLanes;if(f!==0)for(r=r.entanglements,f&=o;0<f;){var b=31-ui(f),w=1<<b;o|=r[b],f&=~w}return br=o,ig(),u}function vE(r,o){Oe=null,G.H=rh,o===Rc||o===dg?(o=PS(),st=3):o===Yy?(o=PS(),st=4):st=o===wv?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,gi=o,$e===null&&(kt=1,Eg(r,Bi(o,r.current)))}function bE(){var r=fi.current;return r===null?!0:(Ye&4194048)===Ye?Vi===null:(Ye&62914560)===Ye||(Ye&536870912)!==0?r===Vi:!1}function _E(){var r=G.H;return G.H=rh,r===null?rh:r}function wE(){var r=G.A;return G.A=o2,r}function Ug(){kt=4,wa||(Ye&4194048)!==Ye&&fi.current!==null||(Oc=!0),(xa&134217727)===0&&(Ho&134217727)===0||ft===null||Ea(ft,Ye,mi,!1)}function Vv(r,o,u){var f=nt;nt|=2;var b=_E(),w=wE();(ft!==r||Ye!==o)&&(Lg=null,Hc(r,o)),o=!1;var T=kt;e:do try{if(st!==0&&$e!==null){var I=$e,F=gi;switch(st){case 8:qv(),T=6;break e;case 3:case 2:case 9:case 6:fi.current===null&&(o=!0);var $=st;if(st=0,gi=null,Bc(r,I,F,$),u&&Oc){T=0;break e}break;default:$=st,st=0,gi=null,Bc(r,I,F,$)}}u2(),T=kt;break}catch(Q){vE(r,Q)}while(!0);return o&&r.shellSuspendCounter++,cr=Mo=null,nt=f,G.H=b,G.A=w,$e===null&&(ft=null,Ye=0,ig()),T}function u2(){for(;$e!==null;)xE($e)}function d2(r,o){var u=nt;nt|=2;var f=_E(),b=wE();ft!==r||Ye!==o?(Lg=null,Pg=li()+500,Hc(r,o)):Oc=Pd(r,o);e:do try{if(st!==0&&$e!==null){o=$e;var w=gi;t:switch(st){case 1:st=0,gi=null,Bc(r,o,w,1);break;case 2:case 9:if(IS(w)){st=0,gi=null,SE(o);break}o=function(){st!==2&&st!==9||ft!==r||(st=7),Ls(r)},w.then(o,o);break e;case 3:st=7;break e;case 4:st=5;break e;case 7:IS(w)?(st=0,gi=null,SE(o)):(st=0,gi=null,Bc(r,o,w,7));break;case 5:var T=null;switch($e.tag){case 26:T=$e.memoizedState;case 5:case 27:var I=$e;if(T?lT(T):I.stateNode.complete){st=0,gi=null;var F=I.sibling;if(F!==null)$e=F;else{var $=I.return;$!==null?($e=$,Fg($)):$e=null}break t}}st=0,gi=null,Bc(r,o,w,5);break;case 6:st=0,gi=null,Bc(r,o,w,6);break;case 8:qv(),kt=6;break e;default:throw Error(n(462))}}h2();break}catch(Q){vE(r,Q)}while(!0);return cr=Mo=null,G.H=f,G.A=b,nt=u,$e!==null?0:(ft=null,Ye=0,ig(),kt)}function h2(){for(;$e!==null&&!Lk();)xE($e)}function xE(r){var o=jA(r.alternate,r,br);r.memoizedProps=r.pendingProps,o===null?Fg(r):$e=o}function SE(r){var o=r,u=o.alternate;switch(o.tag){case 15:case 0:o=BA(u,o,o.pendingProps,o.type,void 0,Ye);break;case 11:o=BA(u,o,o.pendingProps,o.type.render,o.ref,Ye);break;case 5:rv(o);default:KA(u,o),o=$e=wS(o,br),o=jA(u,o,br)}r.memoizedProps=r.pendingProps,o===null?Fg(r):$e=o}function Bc(r,o,u,f){cr=Mo=null,rv(o),Nc=null,Wd=0;var b=o.return;try{if(e2(r,b,o,u,Ye)){kt=1,Eg(r,Bi(u,r.current)),$e=null;return}}catch(w){if(b!==null)throw $e=b,w;kt=1,Eg(r,Bi(u,r.current)),$e=null;return}o.flags&32768?(Je||f===1?r=!0:Oc||(Ye&536870912)!==0?r=!1:(wa=r=!0,(f===2||f===9||f===3||f===6)&&(f=fi.current,f!==null&&f.tag===13&&(f.flags|=16384))),AE(o,r)):Fg(o)}function Fg(r){var o=r;do{if((o.flags&32768)!==0){AE(o,wa);return}r=o.return;var u=i2(o.alternate,o,br);if(u!==null){$e=u;return}if(o=o.sibling,o!==null){$e=o;return}$e=o=r}while(o!==null);kt===0&&(kt=5)}function AE(r,o){do{var u=s2(r.alternate,r);if(u!==null){u.flags&=32767,$e=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(r=r.sibling,r!==null)){$e=r;return}$e=r=u}while(r!==null);kt=6,$e=null}function EE(r,o,u,f,b,w,T,I,F){r.cancelPendingCommit=null;do Hg();while(jt!==0);if((nt&6)!==0)throw Error(n(327));if(o!==null){if(o===r.current)throw Error(n(177));if(w=o.lanes|o.childLanes,w|=Iy,$k(r,u,w,T,I,F),r===ft&&($e=ft=null,Ye=0),Fc=o,Aa=r,_r=u,Bv=w,Gv=b,pE=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,m2(Gp,function(){return ME(),null})):(r.callbackNode=null,r.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=G.T,G.T=null,b=W.p,W.p=2,T=nt,nt|=4;try{r2(r,o,u)}finally{nt=T,W.p=b,G.T=f}}jt=1,TE(),CE(),RE()}}function TE(){if(jt===1){jt=0;var r=Aa,o=Fc,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=G.T,G.T=null;var f=W.p;W.p=2;var b=nt;nt|=4;try{aE(o,r);var w=nb,T=hS(r.containerInfo),I=w.focusedElem,F=w.selectionRange;if(T!==I&&I&&I.ownerDocument&&dS(I.ownerDocument.documentElement,I)){if(F!==null&&Cy(I)){var $=F.start,Q=F.end;if(Q===void 0&&(Q=$),"selectionStart"in I)I.selectionStart=$,I.selectionEnd=Math.min(Q,I.value.length);else{var ee=I.ownerDocument||document,j=ee&&ee.defaultView||window;if(j.getSelection){var J=j.getSelection(),pe=I.textContent.length,Ce=Math.min(F.start,pe),ut=F.end===void 0?Ce:Math.min(F.end,pe);!J.extend&&Ce>ut&&(T=ut,ut=Ce,Ce=T);var q=uS(I,Ce),z=uS(I,ut);if(q&&z&&(J.rangeCount!==1||J.anchorNode!==q.node||J.anchorOffset!==q.offset||J.focusNode!==z.node||J.focusOffset!==z.offset)){var V=ee.createRange();V.setStart(q.node,q.offset),J.removeAllRanges(),Ce>ut?(J.addRange(V),J.extend(z.node,z.offset)):(V.setEnd(z.node,z.offset),J.addRange(V))}}}}for(ee=[],J=I;J=J.parentNode;)J.nodeType===1&&ee.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<ee.length;I++){var Z=ee[I];Z.element.scrollLeft=Z.left,Z.element.scrollTop=Z.top}}Wg=!!tb,nb=tb=null}finally{nt=b,W.p=f,G.T=u}}r.current=o,jt=2}}function CE(){if(jt===2){jt=0;var r=Aa,o=Fc,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=G.T,G.T=null;var f=W.p;W.p=2;var b=nt;nt|=4;try{tE(r,o.alternate,o)}finally{nt=b,W.p=f,G.T=u}}jt=3}}function RE(){if(jt===4||jt===3){jt=0,Ok();var r=Aa,o=Fc,u=_r,f=pE;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?jt=5:(jt=0,Fc=Aa=null,NE(r,r.pendingLanes));var b=r.pendingLanes;if(b===0&&(Sa=null),ly(u),o=o.stateNode,ci&&typeof ci.onCommitFiberRoot=="function")try{ci.onCommitFiberRoot(Dd,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=G.T,b=W.p,W.p=2,G.T=null;try{for(var w=r.onRecoverableError,T=0;T<f.length;T++){var I=f[T];w(I.value,{componentStack:I.stack})}}finally{G.T=o,W.p=b}}(_r&3)!==0&&Hg(),Ls(r),b=r.pendingLanes,(u&261930)!==0&&(b&42)!==0?r===zv?ph++:(ph=0,zv=r):ph=0,gh(0)}}function NE(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,Jd(o)))}function Hg(){return TE(),CE(),RE(),ME()}function ME(){if(jt!==5)return!1;var r=Aa,o=Bv;Bv=0;var u=ly(_r),f=G.T,b=W.p;try{W.p=32>u?32:u,G.T=null,u=Gv,Gv=null;var w=Aa,T=_r;if(jt=0,Fc=Aa=null,_r=0,(nt&6)!==0)throw Error(n(331));var I=nt;if(nt|=4,dE(w.current),lE(w,w.current,T,u),nt=I,gh(0,!1),ci&&typeof ci.onPostCommitFiberRoot=="function")try{ci.onPostCommitFiberRoot(Dd,w)}catch{}return!0}finally{W.p=b,G.T=f,NE(r,o)}}function kE(r,o,u){o=Bi(u,o),o=_v(r.stateNode,o,2),r=ya(r,o,2),r!==null&&(Ld(r,2),Ls(r))}function rt(r,o,u){if(r.tag===3)kE(r,r,u);else for(;o!==null;){if(o.tag===3){kE(o,r,u);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Sa===null||!Sa.has(f))){r=Bi(u,r),u=IA(2),f=ya(o,u,2),f!==null&&(DA(u,f,o,r),Ld(f,2),Ls(f));break}}o=o.return}}function $v(r,o,u){var f=r.pingCache;if(f===null){f=r.pingCache=new l2;var b=new Set;f.set(o,b)}else b=f.get(o),b===void 0&&(b=new Set,f.set(o,b));b.has(u)||(Uv=!0,b.add(u),r=f2.bind(null,r,o,u),o.then(r,r))}function f2(r,o,u){var f=r.pingCache;f!==null&&f.delete(o),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,ft===r&&(Ye&u)===u&&(kt===4||kt===3&&(Ye&62914560)===Ye&&300>li()-Dg?(nt&2)===0&&Hc(r,0):Fv|=u,Uc===Ye&&(Uc=0)),Ls(r)}function IE(r,o){o===0&&(o=Tx()),r=Co(r,o),r!==null&&(Ld(r,o),Ls(r))}function p2(r){var o=r.memoizedState,u=0;o!==null&&(u=o.retryLane),IE(r,u)}function g2(r,o){var u=0;switch(r.tag){case 31:case 13:var f=r.stateNode,b=r.memoizedState;b!==null&&(u=b.retryLane);break;case 19:f=r.stateNode;break;case 22:f=r.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(o),IE(r,u)}function m2(r,o){return sy(r,o)}var Bg=null,Gc=null,jv=!1,Gg=!1,Yv=!1,Ta=0;function Ls(r){r!==Gc&&r.next===null&&(Gc===null?Bg=Gc=r:Gc=Gc.next=r),Gg=!0,jv||(jv=!0,v2())}function gh(r,o){if(!Yv&&Gg){Yv=!0;do for(var u=!1,f=Bg;f!==null;){if(r!==0){var b=f.pendingLanes;if(b===0)var w=0;else{var T=f.suspendedLanes,I=f.pingedLanes;w=(1<<31-ui(42|r)+1)-1,w&=b&~(T&~I),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(u=!0,OE(f,w))}else w=Ye,w=$p(f,f===ft?w:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(w&3)===0||Pd(f,w)||(u=!0,OE(f,w));f=f.next}while(u);Yv=!1}}function y2(){DE()}function DE(){Gg=jv=!1;var r=0;Ta!==0&&R2()&&(r=Ta);for(var o=li(),u=null,f=Bg;f!==null;){var b=f.next,w=PE(f,o);w===0?(f.next=null,u===null?Bg=b:u.next=b,b===null&&(Gc=u)):(u=f,(r!==0||(w&3)!==0)&&(Gg=!0)),f=b}jt!==0&&jt!==5||gh(r),Ta!==0&&(Ta=0)}function PE(r,o){for(var u=r.suspendedLanes,f=r.pingedLanes,b=r.expirationTimes,w=r.pendingLanes&-62914561;0<w;){var T=31-ui(w),I=1<<T,F=b[T];F===-1?((I&u)===0||(I&f)!==0)&&(b[T]=Vk(I,o)):F<=o&&(r.expiredLanes|=I),w&=~I}if(o=ft,u=Ye,u=$p(r,r===o?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f=r.callbackNode,u===0||r===o&&(st===2||st===9)||r.cancelPendingCommit!==null)return f!==null&&f!==null&&ry(f),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||Pd(r,u)){if(o=u&-u,o===r.callbackPriority)return o;switch(f!==null&&ry(f),ly(u)){case 2:case 8:u=Ax;break;case 32:u=Gp;break;case 268435456:u=Ex;break;default:u=Gp}return f=LE.bind(null,r),u=sy(u,f),r.callbackPriority=o,r.callbackNode=u,o}return f!==null&&f!==null&&ry(f),r.callbackPriority=2,r.callbackNode=null,2}function LE(r,o){if(jt!==0&&jt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(Hg()&&r.callbackNode!==u)return null;var f=Ye;return f=$p(r,r===ft?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f===0?null:(mE(r,f,o),PE(r,li()),r.callbackNode!=null&&r.callbackNode===u?LE.bind(null,r):null)}function OE(r,o){if(Hg())return null;mE(r,o,!0)}function v2(){M2(function(){(nt&6)!==0?sy(Sx,y2):DE()})}function Kv(){if(Ta===0){var r=Tc;r===0&&(r=zp,zp<<=1,(zp&261888)===0&&(zp=256)),Ta=r}return Ta}function UE(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Jp(""+r)}function FE(r,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,r.id&&u.setAttribute("form",r.id),o.parentNode.insertBefore(u,o),r=new FormData(r),u.parentNode.removeChild(u),r}function b2(r,o,u,f,b){if(o==="submit"&&u&&u.stateNode===b){var w=UE((b[Kn]||null).action),T=f.submitter;T&&(o=(o=T[Kn]||null)?UE(o.formAction):T.getAttribute("formAction"),o!==null&&(w=o,T=null));var I=new Zp("action","action",null,f,b);r.push({event:I,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ta!==0){var F=T?FE(b,T):new FormData(b);pv(u,{pending:!0,data:F,method:b.method,action:w},null,F)}}else typeof w=="function"&&(I.preventDefault(),F=T?FE(b,T):new FormData(b),pv(u,{pending:!0,data:F,method:b.method,action:w},w,F))},currentTarget:b}]})}}for(var Jv=0;Jv<ky.length;Jv++){var Xv=ky[Jv],_2=Xv.toLowerCase(),w2=Xv[0].toUpperCase()+Xv.slice(1);as(_2,"on"+w2)}as(gS,"onAnimationEnd"),as(mS,"onAnimationIteration"),as(yS,"onAnimationStart"),as("dblclick","onDoubleClick"),as("focusin","onFocus"),as("focusout","onBlur"),as(UI,"onTransitionRun"),as(FI,"onTransitionStart"),as(HI,"onTransitionCancel"),as(vS,"onTransitionEnd"),hc("onMouseEnter",["mouseout","mouseover"]),hc("onMouseLeave",["mouseout","mouseover"]),hc("onPointerEnter",["pointerout","pointerover"]),hc("onPointerLeave",["pointerout","pointerover"]),So("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),So("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),So("onBeforeInput",["compositionend","keypress","textInput","paste"]),So("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),So("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),So("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),x2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(mh));function HE(r,o){o=(o&4)!==0;for(var u=0;u<r.length;u++){var f=r[u],b=f.event;f=f.listeners;e:{var w=void 0;if(o)for(var T=f.length-1;0<=T;T--){var I=f[T],F=I.instance,$=I.currentTarget;if(I=I.listener,F!==w&&b.isPropagationStopped())break e;w=I,b.currentTarget=$;try{w(b)}catch(Q){ng(Q)}b.currentTarget=null,w=F}else for(T=0;T<f.length;T++){if(I=f[T],F=I.instance,$=I.currentTarget,I=I.listener,F!==w&&b.isPropagationStopped())break e;w=I,b.currentTarget=$;try{w(b)}catch(Q){ng(Q)}b.currentTarget=null,w=F}}}}function je(r,o){var u=o[cy];u===void 0&&(u=o[cy]=new Set);var f=r+"__bubble";u.has(f)||(BE(o,r,2,!1),u.add(f))}function Wv(r,o,u){var f=0;o&&(f|=4),BE(u,r,f,o)}var zg="_reactListening"+Math.random().toString(36).slice(2);function Qv(r){if(!r[zg]){r[zg]=!0,Dx.forEach(function(u){u!=="selectionchange"&&(x2.has(u)||Wv(u,!1,r),Wv(u,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[zg]||(o[zg]=!0,Wv("selectionchange",!1,o))}}function BE(r,o,u,f){switch(gT(o)){case 2:var b=X2;break;case 8:b=W2;break;default:b=fb}u=b.bind(null,o,u,r),b=void 0,!vy||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(b=!0),f?b!==void 0?r.addEventListener(o,u,{capture:!0,passive:b}):r.addEventListener(o,u,!0):b!==void 0?r.addEventListener(o,u,{passive:b}):r.addEventListener(o,u,!1)}function Zv(r,o,u,f,b){var w=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var I=f.stateNode.containerInfo;if(I===b)break;if(T===4)for(T=f.return;T!==null;){var F=T.tag;if((F===3||F===4)&&T.stateNode.containerInfo===b)return;T=T.return}for(;I!==null;){if(T=cc(I),T===null)return;if(F=T.tag,F===5||F===6||F===26||F===27){f=w=T;continue e}I=I.parentNode}}f=f.return}$x(function(){var $=w,Q=my(u),ee=[];e:{var j=bS.get(r);if(j!==void 0){var J=Zp,pe=r;switch(r){case"keypress":if(Wp(u)===0)break e;case"keydown":case"keyup":J=gI;break;case"focusin":pe="focus",J=xy;break;case"focusout":pe="blur",J=xy;break;case"beforeblur":case"afterblur":J=xy;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=Kx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=iI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=vI;break;case gS:case mS:case yS:J=aI;break;case vS:J=_I;break;case"scroll":case"scrollend":J=tI;break;case"wheel":J=xI;break;case"copy":case"cut":case"paste":J=lI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=Xx;break;case"toggle":case"beforetoggle":J=AI}var Ce=(o&4)!==0,ut=!Ce&&(r==="scroll"||r==="scrollend"),q=Ce?j!==null?j+"Capture":null:j;Ce=[];for(var z=$,V;z!==null;){var Z=z;if(V=Z.stateNode,Z=Z.tag,Z!==5&&Z!==26&&Z!==27||V===null||q===null||(Z=Fd(z,q),Z!=null&&Ce.push(yh(z,Z,V))),ut)break;z=z.return}0<Ce.length&&(j=new J(j,pe,null,u,Q),ee.push({event:j,listeners:Ce}))}}if((o&7)===0){e:{if(j=r==="mouseover"||r==="pointerover",J=r==="mouseout"||r==="pointerout",j&&u!==gy&&(pe=u.relatedTarget||u.fromElement)&&(cc(pe)||pe[lc]))break e;if((J||j)&&(j=Q.window===Q?Q:(j=Q.ownerDocument)?j.defaultView||j.parentWindow:window,J?(pe=u.relatedTarget||u.toElement,J=$,pe=pe?cc(pe):null,pe!==null&&(ut=a(pe),Ce=pe.tag,pe!==ut||Ce!==5&&Ce!==27&&Ce!==6)&&(pe=null)):(J=null,pe=$),J!==pe)){if(Ce=Kx,Z="onMouseLeave",q="onMouseEnter",z="mouse",(r==="pointerout"||r==="pointerover")&&(Ce=Xx,Z="onPointerLeave",q="onPointerEnter",z="pointer"),ut=J==null?j:Ud(J),V=pe==null?j:Ud(pe),j=new Ce(Z,z+"leave",J,u,Q),j.target=ut,j.relatedTarget=V,Z=null,cc(Q)===$&&(Ce=new Ce(q,z+"enter",pe,u,Q),Ce.target=V,Ce.relatedTarget=ut,Z=Ce),ut=Z,J&&pe)t:{for(Ce=S2,q=J,z=pe,V=0,Z=q;Z;Z=Ce(Z))V++;Z=0;for(var Ae=z;Ae;Ae=Ce(Ae))Z++;for(;0<V-Z;)q=Ce(q),V--;for(;0<Z-V;)z=Ce(z),Z--;for(;V--;){if(q===z||z!==null&&q===z.alternate){Ce=q;break t}q=Ce(q),z=Ce(z)}Ce=null}else Ce=null;J!==null&&GE(ee,j,J,Ce,!1),pe!==null&&ut!==null&&GE(ee,ut,pe,Ce,!0)}}e:{if(j=$?Ud($):window,J=j.nodeName&&j.nodeName.toLowerCase(),J==="select"||J==="input"&&j.type==="file")var Qe=sS;else if(nS(j))if(rS)Qe=PI;else{Qe=II;var ve=kI}else J=j.nodeName,!J||J.toLowerCase()!=="input"||j.type!=="checkbox"&&j.type!=="radio"?$&&py($.elementType)&&(Qe=sS):Qe=DI;if(Qe&&(Qe=Qe(r,$))){iS(ee,Qe,u,Q);break e}ve&&ve(r,j,$),r==="focusout"&&$&&j.type==="number"&&$.memoizedProps.value!=null&&fy(j,"number",j.value)}switch(ve=$?Ud($):window,r){case"focusin":(nS(ve)||ve.contentEditable==="true")&&(vc=ve,Ry=$,jd=null);break;case"focusout":jd=Ry=vc=null;break;case"mousedown":Ny=!0;break;case"contextmenu":case"mouseup":case"dragend":Ny=!1,fS(ee,u,Q);break;case"selectionchange":if(OI)break;case"keydown":case"keyup":fS(ee,u,Q)}var Fe;if(Ay)e:{switch(r){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else yc?eS(r,u)&&(Ke="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(Ke="onCompositionStart");Ke&&(Wx&&u.locale!=="ko"&&(yc||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&yc&&(Fe=jx()):(ua=Q,by="value"in ua?ua.value:ua.textContent,yc=!0)),ve=qg($,Ke),0<ve.length&&(Ke=new Jx(Ke,r,null,u,Q),ee.push({event:Ke,listeners:ve}),Fe?Ke.data=Fe:(Fe=tS(u),Fe!==null&&(Ke.data=Fe)))),(Fe=TI?CI(r,u):RI(r,u))&&(Ke=qg($,"onBeforeInput"),0<Ke.length&&(ve=new Jx("onBeforeInput","beforeinput",null,u,Q),ee.push({event:ve,listeners:Ke}),ve.data=Fe)),b2(ee,r,$,u,Q)}HE(ee,o)})}function yh(r,o,u){return{instance:r,listener:o,currentTarget:u}}function qg(r,o){for(var u=o+"Capture",f=[];r!==null;){var b=r,w=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||w===null||(b=Fd(r,u),b!=null&&f.unshift(yh(r,b,w)),b=Fd(r,o),b!=null&&f.push(yh(r,b,w))),r.tag===3)return f;r=r.return}return[]}function S2(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function GE(r,o,u,f,b){for(var w=o._reactName,T=[];u!==null&&u!==f;){var I=u,F=I.alternate,$=I.stateNode;if(I=I.tag,F!==null&&F===f)break;I!==5&&I!==26&&I!==27||$===null||(F=$,b?($=Fd(u,w),$!=null&&T.unshift(yh(u,$,F))):b||($=Fd(u,w),$!=null&&T.push(yh(u,$,F)))),u=u.return}T.length!==0&&r.push({event:o,listeners:T})}var A2=/\r\n?/g,E2=/\u0000|\uFFFD/g;function zE(r){return(typeof r=="string"?r:""+r).replace(A2,`
`).replace(E2,"")}function qE(r,o){return o=zE(o),zE(r)===o}function ct(r,o,u,f,b,w){switch(u){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||pc(r,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&pc(r,""+f);break;case"className":Yp(r,"class",f);break;case"tabIndex":Yp(r,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Yp(r,u,f);break;case"style":qx(r,f,w);break;case"data":if(o!=="object"){Yp(r,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||u!=="href")){r.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=Jp(""+f),r.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(u==="formAction"?(o!=="input"&&ct(r,o,"name",b.name,b,null),ct(r,o,"formEncType",b.formEncType,b,null),ct(r,o,"formMethod",b.formMethod,b,null),ct(r,o,"formTarget",b.formTarget,b,null)):(ct(r,o,"encType",b.encType,b,null),ct(r,o,"method",b.method,b,null),ct(r,o,"target",b.target,b,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=Jp(""+f),r.setAttribute(u,f);break;case"onClick":f!=null&&(r.onclick=rr);break;case"onScroll":f!=null&&je("scroll",r);break;case"onScrollEnd":f!=null&&je("scrollend",r);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(b.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"multiple":r.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":r.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){r.removeAttribute("xlink:href");break}u=Jp(""+f),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""+f):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":f===!0?r.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,f):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?r.setAttribute(u,f):r.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?r.removeAttribute(u):r.setAttribute(u,f);break;case"popover":je("beforetoggle",r),je("toggle",r),jp(r,"popover",f);break;case"xlinkActuate":sr(r,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":sr(r,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":sr(r,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":sr(r,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":sr(r,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":sr(r,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":sr(r,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":sr(r,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":sr(r,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":jp(r,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Zk.get(u)||u,jp(r,u,f))}}function eb(r,o,u,f,b,w){switch(u){case"style":qx(r,f,w);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(b.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"children":typeof f=="string"?pc(r,f):(typeof f=="number"||typeof f=="bigint")&&pc(r,""+f);break;case"onScroll":f!=null&&je("scroll",r);break;case"onScrollEnd":f!=null&&je("scrollend",r);break;case"onClick":f!=null&&(r.onclick=rr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Px.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(b=u.endsWith("Capture"),o=u.slice(2,b?u.length-7:void 0),w=r[Kn]||null,w=w!=null?w[u]:null,typeof w=="function"&&r.removeEventListener(o,w,b),typeof f=="function")){typeof w!="function"&&w!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(o,f,b);break e}u in r?r[u]=f:f===!0?r.setAttribute(u,""):jp(r,u,f)}}}function mn(r,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":je("error",r),je("load",r);var f=!1,b=!1,w;for(w in u)if(u.hasOwnProperty(w)){var T=u[w];if(T!=null)switch(w){case"src":f=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:ct(r,o,w,T,u,null)}}b&&ct(r,o,"srcSet",u.srcSet,u,null),f&&ct(r,o,"src",u.src,u,null);return;case"input":je("invalid",r);var I=w=T=b=null,F=null,$=null;for(f in u)if(u.hasOwnProperty(f)){var Q=u[f];if(Q!=null)switch(f){case"name":b=Q;break;case"type":T=Q;break;case"checked":F=Q;break;case"defaultChecked":$=Q;break;case"value":w=Q;break;case"defaultValue":I=Q;break;case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(n(137,o));break;default:ct(r,o,f,Q,u,null)}}Hx(r,w,I,F,$,T,b,!1);return;case"select":je("invalid",r),f=T=w=null;for(b in u)if(u.hasOwnProperty(b)&&(I=u[b],I!=null))switch(b){case"value":w=I;break;case"defaultValue":T=I;break;case"multiple":f=I;default:ct(r,o,b,I,u,null)}o=w,u=T,r.multiple=!!f,o!=null?fc(r,!!f,o,!1):u!=null&&fc(r,!!f,u,!0);return;case"textarea":je("invalid",r),w=b=f=null;for(T in u)if(u.hasOwnProperty(T)&&(I=u[T],I!=null))switch(T){case"value":f=I;break;case"defaultValue":b=I;break;case"children":w=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(n(91));break;default:ct(r,o,T,I,u,null)}Gx(r,f,b,w);return;case"option":for(F in u)if(u.hasOwnProperty(F)&&(f=u[F],f!=null))switch(F){case"selected":r.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:ct(r,o,F,f,u,null)}return;case"dialog":je("beforetoggle",r),je("toggle",r),je("cancel",r),je("close",r);break;case"iframe":case"object":je("load",r);break;case"video":case"audio":for(f=0;f<mh.length;f++)je(mh[f],r);break;case"image":je("error",r),je("load",r);break;case"details":je("toggle",r);break;case"embed":case"source":case"link":je("error",r),je("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($ in u)if(u.hasOwnProperty($)&&(f=u[$],f!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:ct(r,o,$,f,u,null)}return;default:if(py(o)){for(Q in u)u.hasOwnProperty(Q)&&(f=u[Q],f!==void 0&&eb(r,o,Q,f,u,void 0));return}}for(I in u)u.hasOwnProperty(I)&&(f=u[I],f!=null&&ct(r,o,I,f,u,null))}function T2(r,o,u,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,w=null,T=null,I=null,F=null,$=null,Q=null;for(J in u){var ee=u[J];if(u.hasOwnProperty(J)&&ee!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":F=ee;default:f.hasOwnProperty(J)||ct(r,o,J,null,f,ee)}}for(var j in f){var J=f[j];if(ee=u[j],f.hasOwnProperty(j)&&(J!=null||ee!=null))switch(j){case"type":w=J;break;case"name":b=J;break;case"checked":$=J;break;case"defaultChecked":Q=J;break;case"value":T=J;break;case"defaultValue":I=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(n(137,o));break;default:J!==ee&&ct(r,o,j,J,f,ee)}}hy(r,T,I,F,$,Q,w,b);return;case"select":J=T=I=j=null;for(w in u)if(F=u[w],u.hasOwnProperty(w)&&F!=null)switch(w){case"value":break;case"multiple":J=F;default:f.hasOwnProperty(w)||ct(r,o,w,null,f,F)}for(b in f)if(w=f[b],F=u[b],f.hasOwnProperty(b)&&(w!=null||F!=null))switch(b){case"value":j=w;break;case"defaultValue":I=w;break;case"multiple":T=w;default:w!==F&&ct(r,o,b,w,f,F)}o=I,u=T,f=J,j!=null?fc(r,!!u,j,!1):!!f!=!!u&&(o!=null?fc(r,!!u,o,!0):fc(r,!!u,u?[]:"",!1));return;case"textarea":J=j=null;for(I in u)if(b=u[I],u.hasOwnProperty(I)&&b!=null&&!f.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:ct(r,o,I,null,f,b)}for(T in f)if(b=f[T],w=u[T],f.hasOwnProperty(T)&&(b!=null||w!=null))switch(T){case"value":j=b;break;case"defaultValue":J=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(n(91));break;default:b!==w&&ct(r,o,T,b,f,w)}Bx(r,j,J);return;case"option":for(var pe in u)if(j=u[pe],u.hasOwnProperty(pe)&&j!=null&&!f.hasOwnProperty(pe))switch(pe){case"selected":r.selected=!1;break;default:ct(r,o,pe,null,f,j)}for(F in f)if(j=f[F],J=u[F],f.hasOwnProperty(F)&&j!==J&&(j!=null||J!=null))switch(F){case"selected":r.selected=j&&typeof j!="function"&&typeof j!="symbol";break;default:ct(r,o,F,j,f,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in u)j=u[Ce],u.hasOwnProperty(Ce)&&j!=null&&!f.hasOwnProperty(Ce)&&ct(r,o,Ce,null,f,j);for($ in f)if(j=f[$],J=u[$],f.hasOwnProperty($)&&j!==J&&(j!=null||J!=null))switch($){case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(n(137,o));break;default:ct(r,o,$,j,f,J)}return;default:if(py(o)){for(var ut in u)j=u[ut],u.hasOwnProperty(ut)&&j!==void 0&&!f.hasOwnProperty(ut)&&eb(r,o,ut,void 0,f,j);for(Q in f)j=f[Q],J=u[Q],!f.hasOwnProperty(Q)||j===J||j===void 0&&J===void 0||eb(r,o,Q,j,f,J);return}}for(var q in u)j=u[q],u.hasOwnProperty(q)&&j!=null&&!f.hasOwnProperty(q)&&ct(r,o,q,null,f,j);for(ee in f)j=f[ee],J=u[ee],!f.hasOwnProperty(ee)||j===J||j==null&&J==null||ct(r,o,ee,j,f,J)}function VE(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function C2(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var b=u[f],w=b.transferSize,T=b.initiatorType,I=b.duration;if(w&&I&&VE(T)){for(T=0,I=b.responseEnd,f+=1;f<u.length;f++){var F=u[f],$=F.startTime;if($>I)break;var Q=F.transferSize,ee=F.initiatorType;Q&&VE(ee)&&(F=F.responseEnd,T+=Q*(F<I?1:(I-$)/(F-$)))}if(--f,o+=8*(w+T)/(b.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var tb=null,nb=null;function Vg(r){return r.nodeType===9?r:r.ownerDocument}function $E(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function jE(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function ib(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var sb=null;function R2(){var r=window.event;return r&&r.type==="popstate"?r===sb?!1:(sb=r,!0):(sb=null,!1)}var YE=typeof setTimeout=="function"?setTimeout:void 0,N2=typeof clearTimeout=="function"?clearTimeout:void 0,KE=typeof Promise=="function"?Promise:void 0,M2=typeof queueMicrotask=="function"?queueMicrotask:typeof KE<"u"?function(r){return KE.resolve(null).then(r).catch(k2)}:YE;function k2(r){setTimeout(function(){throw r})}function Ca(r){return r==="head"}function JE(r,o){var u=o,f=0;do{var b=u.nextSibling;if(r.removeChild(u),b&&b.nodeType===8)if(u=b.data,u==="/$"||u==="/&"){if(f===0){r.removeChild(b),$c(o);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")vh(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,vh(u);for(var w=u.firstChild;w;){var T=w.nextSibling,I=w.nodeName;w[Od]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&w.rel.toLowerCase()==="stylesheet"||u.removeChild(w),w=T}}else u==="body"&&vh(r.ownerDocument.body);u=b}while(u);$c(o)}function XE(r,o){var u=r;r=0;do{var f=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=f}while(u)}function rb(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":rb(u),uy(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function I2(r,o,u,f){for(;r.nodeType===1;){var b=u;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(f){if(!r[Od])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(w=r.getAttribute("rel"),w==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(w!==b.rel||r.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||r.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||r.getAttribute("title")!==(b.title==null?null:b.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(w=r.getAttribute("src"),(w!==(b.src==null?null:b.src)||r.getAttribute("type")!==(b.type==null?null:b.type)||r.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&w&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var w=b.name==null?null:""+b.name;if(b.type==="hidden"&&r.getAttribute("name")===w)return r}else return r;if(r=$i(r.nextSibling),r===null)break}return null}function D2(r,o,u){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=$i(r.nextSibling),r===null))return null;return r}function WE(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=$i(r.nextSibling),r===null))return null;return r}function ab(r){return r.data==="$?"||r.data==="$~"}function ob(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function P2(r,o){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||u.readyState!=="loading")o();else{var f=function(){o(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),r._reactRetry=f}}function $i(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var lb=null;function QE(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(o===0)return $i(r.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}r=r.nextSibling}return null}function ZE(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return r;o--}else u!=="/$"&&u!=="/&"||o++}r=r.previousSibling}return null}function eT(r,o,u){switch(o=Vg(u),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function vh(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);uy(r)}var ji=new Map,tT=new Set;function $g(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var wr=W.d;W.d={f:L2,r:O2,D:U2,C:F2,L:H2,m:B2,X:z2,S:G2,M:q2};function L2(){var r=wr.f(),o=Og();return r||o}function O2(r){var o=uc(r);o!==null&&o.tag===5&&o.type==="form"?vA(o):wr.r(r)}var zc=typeof document>"u"?null:document;function nT(r,o,u){var f=zc;if(f&&typeof o=="string"&&o){var b=Fi(o);b='link[rel="'+r+'"][href="'+b+'"]',typeof u=="string"&&(b+='[crossorigin="'+u+'"]'),tT.has(b)||(tT.add(b),r={rel:r,crossOrigin:u,href:o},f.querySelector(b)===null&&(o=f.createElement("link"),mn(o,"link",r),tn(o),f.head.appendChild(o)))}}function U2(r){wr.D(r),nT("dns-prefetch",r,null)}function F2(r,o){wr.C(r,o),nT("preconnect",r,o)}function H2(r,o,u){wr.L(r,o,u);var f=zc;if(f&&r&&o){var b='link[rel="preload"][as="'+Fi(o)+'"]';o==="image"&&u&&u.imageSrcSet?(b+='[imagesrcset="'+Fi(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(b+='[imagesizes="'+Fi(u.imageSizes)+'"]')):b+='[href="'+Fi(r)+'"]';var w=b;switch(o){case"style":w=qc(r);break;case"script":w=Vc(r)}ji.has(w)||(r=v({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:r,as:o},u),ji.set(w,r),f.querySelector(b)!==null||o==="style"&&f.querySelector(bh(w))||o==="script"&&f.querySelector(_h(w))||(o=f.createElement("link"),mn(o,"link",r),tn(o),f.head.appendChild(o)))}}function B2(r,o){wr.m(r,o);var u=zc;if(u&&r){var f=o&&typeof o.as=="string"?o.as:"script",b='link[rel="modulepreload"][as="'+Fi(f)+'"][href="'+Fi(r)+'"]',w=b;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Vc(r)}if(!ji.has(w)&&(r=v({rel:"modulepreload",href:r},o),ji.set(w,r),u.querySelector(b)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(_h(w)))return}f=u.createElement("link"),mn(f,"link",r),tn(f),u.head.appendChild(f)}}}function G2(r,o,u){wr.S(r,o,u);var f=zc;if(f&&r){var b=dc(f).hoistableStyles,w=qc(r);o=o||"default";var T=b.get(w);if(!T){var I={loading:0,preload:null};if(T=f.querySelector(bh(w)))I.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":o},u),(u=ji.get(w))&&cb(r,u);var F=T=f.createElement("link");tn(F),mn(F,"link",r),F._p=new Promise(function($,Q){F.onload=$,F.onerror=Q}),F.addEventListener("load",function(){I.loading|=1}),F.addEventListener("error",function(){I.loading|=2}),I.loading|=4,jg(T,o,f)}T={type:"stylesheet",instance:T,count:1,state:I},b.set(w,T)}}}function z2(r,o){wr.X(r,o);var u=zc;if(u&&r){var f=dc(u).hoistableScripts,b=Vc(r),w=f.get(b);w||(w=u.querySelector(_h(b)),w||(r=v({src:r,async:!0},o),(o=ji.get(b))&&ub(r,o),w=u.createElement("script"),tn(w),mn(w,"link",r),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},f.set(b,w))}}function q2(r,o){wr.M(r,o);var u=zc;if(u&&r){var f=dc(u).hoistableScripts,b=Vc(r),w=f.get(b);w||(w=u.querySelector(_h(b)),w||(r=v({src:r,async:!0,type:"module"},o),(o=ji.get(b))&&ub(r,o),w=u.createElement("script"),tn(w),mn(w,"link",r),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},f.set(b,w))}}function iT(r,o,u,f){var b=(b=Ee.current)?$g(b):null;if(!b)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=qc(u.href),u=dc(b).hoistableStyles,f=u.get(o),f||(f={type:"style",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=qc(u.href);var w=dc(b).hoistableStyles,T=w.get(r);if(T||(b=b.ownerDocument||b,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(r,T),(w=b.querySelector(bh(r)))&&!w._p&&(T.instance=w,T.state.loading=5),ji.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},ji.set(r,u),w||V2(b,r,u,T.state))),o&&f===null)throw Error(n(528,""));return T}if(o&&f!==null)throw Error(n(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Vc(u),u=dc(b).hoistableScripts,f=u.get(o),f||(f={type:"script",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function qc(r){return'href="'+Fi(r)+'"'}function bh(r){return'link[rel="stylesheet"]['+r+"]"}function sT(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function V2(r,o,u,f){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=r.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),mn(o,"link",u),tn(o),r.head.appendChild(o))}function Vc(r){return'[src="'+Fi(r)+'"]'}function _h(r){return"script[async]"+r}function rT(r,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var f=r.querySelector('style[data-href~="'+Fi(u.href)+'"]');if(f)return o.instance=f,tn(f),f;var b=v({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(r.ownerDocument||r).createElement("style"),tn(f),mn(f,"style",b),jg(f,u.precedence,r),o.instance=f;case"stylesheet":b=qc(u.href);var w=r.querySelector(bh(b));if(w)return o.state.loading|=4,o.instance=w,tn(w),w;f=sT(u),(b=ji.get(b))&&cb(f,b),w=(r.ownerDocument||r).createElement("link"),tn(w);var T=w;return T._p=new Promise(function(I,F){T.onload=I,T.onerror=F}),mn(w,"link",f),o.state.loading|=4,jg(w,u.precedence,r),o.instance=w;case"script":return w=Vc(u.src),(b=r.querySelector(_h(w)))?(o.instance=b,tn(b),b):(f=u,(b=ji.get(w))&&(f=v({},u),ub(f,b)),r=r.ownerDocument||r,b=r.createElement("script"),tn(b),mn(b,"link",f),r.head.appendChild(b),o.instance=b);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,jg(f,u.precedence,r));return o.instance}function jg(r,o,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=f.length?f[f.length-1]:null,w=b,T=0;T<f.length;T++){var I=f[T];if(I.dataset.precedence===o)w=I;else if(w!==b)break}w?w.parentNode.insertBefore(r,w.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(r,o.firstChild))}function cb(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function ub(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var Yg=null;function aT(r,o,u){if(Yg===null){var f=new Map,b=Yg=new Map;b.set(u,f)}else b=Yg,f=b.get(u),f||(f=new Map,b.set(u,f));if(f.has(r))return f;for(f.set(r,null),u=u.getElementsByTagName(r),b=0;b<u.length;b++){var w=u[b];if(!(w[Od]||w[hn]||r==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var T=w.getAttribute(o)||"";T=r+T;var I=f.get(T);I?I.push(w):f.set(T,[w])}}return f}function oT(r,o,u){r=r.ownerDocument||r,r.head.insertBefore(u,o==="title"?r.querySelector("head > title"):null)}function $2(r,o,u){if(u===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function lT(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function j2(r,o,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var b=qc(f.href),w=o.querySelector(bh(b));if(w){o=w._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=Kg.bind(r),o.then(r,r)),u.state.loading|=4,u.instance=w,tn(w);return}w=o.ownerDocument||o,f=sT(f),(b=ji.get(b))&&cb(f,b),w=w.createElement("link"),tn(w);var T=w;T._p=new Promise(function(I,F){T.onload=I,T.onerror=F}),mn(w,"link",f),u.instance=w}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=Kg.bind(r),o.addEventListener("load",u),o.addEventListener("error",u))}}var db=0;function Y2(r,o){return r.stylesheets&&r.count===0&&Xg(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var f=setTimeout(function(){if(r.stylesheets&&Xg(r,r.stylesheets),r.unsuspend){var w=r.unsuspend;r.unsuspend=null,w()}},6e4+o);0<r.imgBytes&&db===0&&(db=62500*C2());var b=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Xg(r,r.stylesheets),r.unsuspend)){var w=r.unsuspend;r.unsuspend=null,w()}},(r.imgBytes>db?50:800)+o);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(f),clearTimeout(b)}}:null}function Kg(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Xg(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Jg=null;function Xg(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Jg=new Map,o.forEach(K2,r),Jg=null,Kg.call(r))}function K2(r,o){if(!(o.state.loading&4)){var u=Jg.get(r);if(u)var f=u.get(null);else{u=new Map,Jg.set(r,u);for(var b=r.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<b.length;w++){var T=b[w];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(u.set(T.dataset.precedence,T),f=T)}f&&u.set(null,f)}b=o.instance,T=b.getAttribute("data-precedence"),w=u.get(T)||f,w===f&&u.set(null,b),u.set(T,b),this.count++,f=Kg.bind(this),b.addEventListener("load",f),b.addEventListener("error",f),w?w.parentNode.insertBefore(b,w.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(b,r.firstChild)),o.state.loading|=4}}var wh={$$typeof:P,Provider:null,Consumer:null,_currentValue:he,_currentValue2:he,_threadCount:0};function J2(r,o,u,f,b,w,T,I,F){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ay(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ay(0),this.hiddenUpdates=ay(null),this.identifierPrefix=f,this.onUncaughtError=b,this.onCaughtError=w,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function cT(r,o,u,f,b,w,T,I,F,$,Q,ee){return r=new J2(r,o,u,T,F,$,Q,ee,I),o=1,w===!0&&(o|=24),w=hi(3,null,null,o),r.current=w,w.stateNode=r,o=Vy(),o.refCount++,r.pooledCache=o,o.refCount++,w.memoizedState={element:f,isDehydrated:u,cache:o},Ky(w),r}function uT(r){return r?(r=wc,r):wc}function dT(r,o,u,f,b,w){b=uT(b),f.context===null?f.context=b:f.pendingContext=b,f=ma(o),f.payload={element:u},w=w===void 0?null:w,w!==null&&(f.callback=w),u=ya(r,f,o),u!==null&&(ei(u,r,o),Zd(u,r,o))}function hT(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<o?u:o}}function hb(r,o){hT(r,o),(r=r.alternate)&&hT(r,o)}function fT(r){if(r.tag===13||r.tag===31){var o=Co(r,67108864);o!==null&&ei(o,r,67108864),hb(r,67108864)}}function pT(r){if(r.tag===13||r.tag===31){var o=yi();o=oy(o);var u=Co(r,o);u!==null&&ei(u,r,o),hb(r,o)}}var Wg=!0;function X2(r,o,u,f){var b=G.T;G.T=null;var w=W.p;try{W.p=2,fb(r,o,u,f)}finally{W.p=w,G.T=b}}function W2(r,o,u,f){var b=G.T;G.T=null;var w=W.p;try{W.p=8,fb(r,o,u,f)}finally{W.p=w,G.T=b}}function fb(r,o,u,f){if(Wg){var b=pb(f);if(b===null)Zv(r,o,f,Qg,u),mT(r,f);else if(Z2(b,r,o,u,f))f.stopPropagation();else if(mT(r,f),o&4&&-1<Q2.indexOf(r)){for(;b!==null;){var w=uc(b);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var T=xo(w.pendingLanes);if(T!==0){var I=w;for(I.pendingLanes|=2,I.entangledLanes|=2;T;){var F=1<<31-ui(T);I.entanglements[1]|=F,T&=~F}Ls(w),(nt&6)===0&&(Pg=li()+500,gh(0))}}break;case 31:case 13:I=Co(w,2),I!==null&&ei(I,w,2),Og(),hb(w,2)}if(w=pb(f),w===null&&Zv(r,o,f,Qg,u),w===b)break;b=w}b!==null&&f.stopPropagation()}else Zv(r,o,f,null,u)}}function pb(r){return r=my(r),gb(r)}var Qg=null;function gb(r){if(Qg=null,r=cc(r),r!==null){var o=a(r);if(o===null)r=null;else{var u=o.tag;if(u===13){if(r=l(o),r!==null)return r;r=null}else if(u===31){if(r=c(o),r!==null)return r;r=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Qg=r,null}function gT(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Uk()){case Sx:return 2;case Ax:return 8;case Gp:case Fk:return 32;case Ex:return 268435456;default:return 32}default:return 32}}var mb=!1,Ra=null,Na=null,Ma=null,xh=new Map,Sh=new Map,ka=[],Q2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mT(r,o){switch(r){case"focusin":case"focusout":Ra=null;break;case"dragenter":case"dragleave":Na=null;break;case"mouseover":case"mouseout":Ma=null;break;case"pointerover":case"pointerout":xh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sh.delete(o.pointerId)}}function Ah(r,o,u,f,b,w){return r===null||r.nativeEvent!==w?(r={blockedOn:o,domEventName:u,eventSystemFlags:f,nativeEvent:w,targetContainers:[b]},o!==null&&(o=uc(o),o!==null&&fT(o)),r):(r.eventSystemFlags|=f,o=r.targetContainers,b!==null&&o.indexOf(b)===-1&&o.push(b),r)}function Z2(r,o,u,f,b){switch(o){case"focusin":return Ra=Ah(Ra,r,o,u,f,b),!0;case"dragenter":return Na=Ah(Na,r,o,u,f,b),!0;case"mouseover":return Ma=Ah(Ma,r,o,u,f,b),!0;case"pointerover":var w=b.pointerId;return xh.set(w,Ah(xh.get(w)||null,r,o,u,f,b)),!0;case"gotpointercapture":return w=b.pointerId,Sh.set(w,Ah(Sh.get(w)||null,r,o,u,f,b)),!0}return!1}function yT(r){var o=cc(r.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){r.blockedOn=o,kx(r.priority,function(){pT(u)});return}}else if(o===31){if(o=c(u),o!==null){r.blockedOn=o,kx(r.priority,function(){pT(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Zg(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var u=pb(r.nativeEvent);if(u===null){u=r.nativeEvent;var f=new u.constructor(u.type,u);gy=f,u.target.dispatchEvent(f),gy=null}else return o=uc(u),o!==null&&fT(o),r.blockedOn=u,!1;o.shift()}return!0}function vT(r,o,u){Zg(r)&&u.delete(o)}function eD(){mb=!1,Ra!==null&&Zg(Ra)&&(Ra=null),Na!==null&&Zg(Na)&&(Na=null),Ma!==null&&Zg(Ma)&&(Ma=null),xh.forEach(vT),Sh.forEach(vT)}function em(r,o){r.blockedOn===o&&(r.blockedOn=null,mb||(mb=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,eD)))}var tm=null;function bT(r){tm!==r&&(tm=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){tm===r&&(tm=null);for(var o=0;o<r.length;o+=3){var u=r[o],f=r[o+1],b=r[o+2];if(typeof f!="function"){if(gb(f||u)===null)continue;break}var w=uc(u);w!==null&&(r.splice(o,3),o-=3,pv(w,{pending:!0,data:b,method:u.method,action:f},f,b))}}))}function $c(r){function o(F){return em(F,r)}Ra!==null&&em(Ra,r),Na!==null&&em(Na,r),Ma!==null&&em(Ma,r),xh.forEach(o),Sh.forEach(o);for(var u=0;u<ka.length;u++){var f=ka[u];f.blockedOn===r&&(f.blockedOn=null)}for(;0<ka.length&&(u=ka[0],u.blockedOn===null);)yT(u),u.blockedOn===null&&ka.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var b=u[f],w=u[f+1],T=b[Kn]||null;if(typeof w=="function")T||bT(u);else if(T){var I=null;if(w&&w.hasAttribute("formAction")){if(b=w,T=w[Kn]||null)I=T.formAction;else if(gb(b)!==null)continue}else I=T.action;typeof I=="function"?u[f+1]=I:(u.splice(f,3),f-=3),bT(u)}}}function _T(){function r(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(T){return b=T})},focusReset:"manual",scroll:"manual"})}function o(){b!==null&&(b(),b=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,b=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),b!==null&&(b(),b=null)}}}function yb(r){this._internalRoot=r}nm.prototype.render=yb.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var u=o.current,f=yi();dT(u,f,r,o,null,null)},nm.prototype.unmount=yb.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;dT(r.current,2,null,r,null,null),Og(),o[lc]=null}};function nm(r){this._internalRoot=r}nm.prototype.unstable_scheduleHydration=function(r){if(r){var o=Mx();r={blockedOn:null,target:r,priority:o};for(var u=0;u<ka.length&&o!==0&&o<ka[u].priority;u++);ka.splice(u,0,r),u===0&&yT(r)}};var wT=e.version;if(wT!=="19.2.3")throw Error(n(527,wT,"19.2.3"));W.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=h(o),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var tD={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var im=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!im.isDisabled&&im.supportsFiber)try{Dd=im.inject(tD),ci=im}catch{}}return Th.createRoot=function(r,o){if(!s(r))throw Error(n(299));var u=!1,f="",b=RA,w=NA,T=MA;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(b=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError)),o=cT(r,1,!1,null,null,u,f,null,b,w,T,_T),r[lc]=o.current,Qv(r),new yb(o)},Th.hydrateRoot=function(r,o,u){if(!s(r))throw Error(n(299));var f=!1,b="",w=RA,T=NA,I=MA,F=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onUncaughtError!==void 0&&(w=u.onUncaughtError),u.onCaughtError!==void 0&&(T=u.onCaughtError),u.onRecoverableError!==void 0&&(I=u.onRecoverableError),u.formState!==void 0&&(F=u.formState)),o=cT(r,1,!0,o,u??null,f,b,F,w,T,I,_T),o.context=uT(null),u=o.current,f=yi(),f=oy(f),b=ma(f),b.callback=null,ya(u,b,f),u=f,o.current.lanes=u,Ld(o,u),Ls(o),r[lc]=o.current,Qv(r),new nm(o)},Th.version="19.2.3",Th}var IT;function fD(){if(IT)return wb.exports;IT=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),wb.exports=hD(),wb.exports}var pD=fD();const gD=Ow(pD);var Wh={};Wh.d=(i,e)=>{for(var t in e)Wh.o(e,t)&&!Wh.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})};Wh.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var De=globalThis.pdfjsLib={};Wh.d(De,{AbortException:()=>go,AnnotationEditorLayer:()=>tw,AnnotationEditorParamsType:()=>Xe,AnnotationEditorType:()=>He,AnnotationEditorUIManager:()=>ic,AnnotationLayer:()=>uL,AnnotationMode:()=>La,ColorPicker:()=>n0,DOMSVGFactory:()=>jw,DrawLayer:()=>sw,FeatureTest:()=>Vn,GlobalWorkerOptions:()=>Zr,ImageKind:()=>bm,InvalidPDFException:()=>Kb,MissingPDFException:()=>tf,OPS:()=>ds,OutputScale:()=>Xb,PDFDataRangeTransport:()=>hN,PDFDateString:()=>zw,PDFWorker:()=>bu,PasswordResponses:()=>bD,PermissionFlag:()=>vD,PixelsPerInch:()=>mo,RenderingCancelledException:()=>Bw,TextLayer:()=>nf,TouchManager:()=>e0,UnexpectedResponseException:()=>Wm,Util:()=>xe,VerbosityLevel:()=>O0,XfaLayer:()=>pN,build:()=>VP,createValidAbsoluteUrl:()=>SD,fetchData:()=>B0,getDocument:()=>LP,getFilenameFromUrl:()=>ID,getPdfFilenameFromUrl:()=>DD,getXfaPageViewport:()=>PD,isDataScheme:()=>G0,isPdfFile:()=>Gw,noContextMenu:()=>Ns,normalizeUnicode:()=>ND,setLayerDimensions:()=>nc,shadow:()=>Ve,stopEvent:()=>Di,version:()=>qP});const Pn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),dR=[1,0,0,1,0,0],Yb=[.001,0,0,.001,0,0],mD=1e7,Eb=1.35,ki={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},La={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},yD="pdfjs_internal_editor_",He={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Xe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},vD={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Tn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},bm={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Yt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Ch={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},O0={ERRORS:0,WARNINGS:1,INFOS:5},ds={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},bD={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let U0=O0.WARNINGS;function _D(i){Number.isInteger(i)&&(U0=i)}function wD(){return U0}function F0(i){U0>=O0.INFOS&&console.log(`Info: ${i}`)}function Be(i){U0>=O0.WARNINGS&&console.log(`Warning: ${i}`)}function pt(i){throw new Error(i)}function Vt(i,e){i||pt(e)}function xD(i){switch(i==null?void 0:i.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function SD(i,e=null,t=null){if(!i)return null;try{if(t&&typeof i=="string"){if(t.addDefaultProtocol&&i.startsWith("www.")){const s=i.match(/\./g);(s==null?void 0:s.length)>=2&&(i=`http://${i}`)}if(t.tryConvertEncoding)try{i=RD(i)}catch{}}const n=e?new URL(i,e):new URL(i);if(xD(n))return n}catch{}return null}function Ve(i,e,t,n=!1){return Object.defineProperty(i,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const vo=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class DT extends vo{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Tb extends vo{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Kb extends vo{constructor(e){super(e,"InvalidPDFException")}}class tf extends vo{constructor(e){super(e,"MissingPDFException")}}class Wm extends vo{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class AD extends vo{constructor(e){super(e,"FormatError")}}class go extends vo{constructor(e){super(e,"AbortException")}}function hR(i){(typeof i!="object"||(i==null?void 0:i.length)===void 0)&&pt("Invalid argument for bytesToString");const e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);const n=[];for(let s=0;s<e;s+=t){const a=Math.min(s+t,e),l=i.subarray(s,a);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function H0(i){typeof i!="string"&&pt("Invalid argument for stringToBytes");const e=i.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=i.charCodeAt(n)&255;return t}function ED(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function Fw(i){const e=Object.create(null);for(const[t,n]of i)e[t]=n;return e}function TD(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function CD(){try{return new Function(""),!0}catch{return!1}}class Vn{static get isLittleEndian(){return Ve(this,"isLittleEndian",TD())}static get isEvalSupported(){return Ve(this,"isEvalSupported",CD())}static get isOffscreenCanvasSupported(){return Ve(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ve(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Ve(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):Ve(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return Ve(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Cb=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));var ea,_m,Jb;class xe{static makeHexColor(e,t,n){return`#${Cb[e]}${Cb[t]}${Cb[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const n=e[0]*t[0]+e[1]*t[2]+t[4],s=e[0]*t[1]+e[1]*t[3]+t[5];return[n,s]}static applyInverseTransform(e,t){const n=t[0]*t[3]-t[1]*t[2],s=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,a=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n;return[s,a]}static getAxialAlignedBoundingBox(e,t){const n=this.applyTransform(e,t),s=this.applyTransform(e.slice(2,4),t),a=this.applyTransform([e[0],e[3]],t),l=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],s[0],a[0],l[0]),Math.min(n[1],s[1],a[1],l[1]),Math.max(n[0],s[0],a[0],l[0]),Math.max(n[1],s[1],a[1],l[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],s=e[0]*t[1]+e[1]*t[3],a=e[2]*t[0]+e[3]*t[2],l=e[2]*t[1]+e[3]*t[3],c=(n+l)/2,d=Math.sqrt((n+l)**2-4*(n*l-a*s))/2,h=c+d||1,p=c-d||1;return[Math.sqrt(h),Math.sqrt(p)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>l?null:[n,a,s,l]}static bezierBoundingBox(e,t,n,s,a,l,c,d,h){return h?(h[0]=Math.min(h[0],e,c),h[1]=Math.min(h[1],t,d),h[2]=Math.max(h[2],e,c),h[3]=Math.max(h[3],t,d)):h=[Math.min(e,c),Math.min(t,d),Math.max(e,c),Math.max(t,d)],k(this,ea,Jb).call(this,e,n,a,c,t,s,l,d,3*(-e+3*(n-a)+c),6*(e-2*n+a),3*(n-e),h),k(this,ea,Jb).call(this,e,n,a,c,t,s,l,d,3*(-t+3*(s-l)+d),6*(t-2*s+l),3*(s-t),h),h}}ea=new WeakSet,_m=function(e,t,n,s,a,l,c,d,h,p){if(h<=0||h>=1)return;const v=1-h,_=h*h,x=_*h,A=v*(v*(v*e+3*h*t)+3*_*n)+x*s,E=v*(v*(v*a+3*h*l)+3*_*c)+x*d;p[0]=Math.min(p[0],A),p[1]=Math.min(p[1],E),p[2]=Math.max(p[2],A),p[3]=Math.max(p[3],E)},Jb=function(e,t,n,s,a,l,c,d,h,p,v,_){if(Math.abs(h)<1e-12){Math.abs(p)>=1e-12&&k(this,ea,_m).call(this,e,t,n,s,a,l,c,d,-v/p,_);return}const x=p**2-4*v*h;if(x<0)return;const A=Math.sqrt(x),E=2*h;k(this,ea,_m).call(this,e,t,n,s,a,l,c,d,(-p+A)/E,_),k(this,ea,_m).call(this,e,t,n,s,a,l,c,d,(-p-A)/E,_)},M(xe,ea);function RD(i){return decodeURIComponent(escape(i))}let Rb=null,PT=null;function ND(i){return Rb||(Rb=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,PT=new Map([["","t"]])),i.replaceAll(Rb,(e,t,n)=>t?t.normalize("NFKC"):PT.get(n))}function MD(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),hR(i)}const Hw="pdfjs_internal_id_";function kD(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(hR(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...e){return new Promise(t=>{t(i(...e))})});const xr="http://www.w3.org/2000/svg",Jo=class Jo{};Re(Jo,"CSS",96),Re(Jo,"PDF",72),Re(Jo,"PDF_TO_CSS_UNITS",Jo.CSS/Jo.PDF);let mo=Jo;async function B0(i,e="text"){if(Dh(i,document.baseURI)){const t=await fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",i,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class Lp{constructor({viewBox:e,userUnit:t,scale:n,rotation:s,offsetX:a=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=s,this.offsetX=a,this.offsetY=l,n*=t;const d=(e[2]+e[0])/2,h=(e[3]+e[1])/2;let p,v,_,x;switch(s%=360,s<0&&(s+=360),s){case 180:p=-1,v=0,_=0,x=1;break;case 90:p=0,v=1,_=1,x=0;break;case 270:p=0,v=-1,_=-1,x=0;break;case 0:p=1,v=0,_=0,x=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(_=-_,x=-x);let A,E,R,N;p===0?(A=Math.abs(h-e[1])*n+a,E=Math.abs(d-e[0])*n+l,R=(e[3]-e[1])*n,N=(e[2]-e[0])*n):(A=Math.abs(d-e[0])*n+a,E=Math.abs(h-e[1])*n+l,R=(e[2]-e[0])*n,N=(e[3]-e[1])*n),this.transform=[p*n,v*n,_*n,x*n,A-p*n*d-_*n*h,E-v*n*d-x*n*h],this.width=R,this.height=N}get rawDims(){const{userUnit:e,viewBox:t}=this,n=t.map(s=>s*e);return Ve(this,"rawDims",{pageWidth:n[2]-n[0],pageHeight:n[3]-n[1],pageX:n[0],pageY:n[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:a=!1}={}){return new Lp({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:a})}convertToViewportPoint(e,t){return xe.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=xe.applyTransform([e[0],e[1]],this.transform),n=xe.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return xe.applyInverseTransform([e,t],this.transform)}}class Bw extends vo{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function G0(i){const e=i.length;let t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function Gw(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function ID(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function DD(i,e="document.pdf"){if(typeof i!="string")return e;if(G0(i))return Be('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=t.exec(i);let a=n.exec(s[1])||n.exec(s[2])||n.exec(s[3]);if(a&&(a=a[0],a.includes("%")))try{a=n.exec(decodeURIComponent(a))[0]}catch{}return a||e}class LT{constructor(){Re(this,"started",Object.create(null));Re(this,"times",[])}time(e){e in this.started&&Be(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Be(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:a}of this.times)e.push(`${n.padEnd(t)} ${a-s}ms
`);return e.join("")}}function Dh(i,e){try{const{protocol:t}=e?new URL(i,e):new URL(i);return t==="http:"||t==="https:"}catch{return!1}}function Ns(i){i.preventDefault()}function Di(i){i.preventDefault(),i.stopPropagation()}var uf;class zw{static toDateObject(e){if(!e||typeof e!="string")return null;g(this,uf)||C(this,uf,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=g(this,uf).exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let d=parseInt(t[6],10);d=d>=0&&d<=59?d:0;const h=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let v=parseInt(t[9],10)||0;return v=v>=0&&v<=59?v:0,h==="-"?(l+=p,c+=v):h==="+"&&(l-=p,c-=v),new Date(Date.UTC(n,s,a,l,c,d))}}uf=new WeakMap,M(zw,uf);function PD(i,{scale:e=1,rotation:t=0}){const{width:n,height:s}=i.attributes.style,a=[0,0,parseInt(n),parseInt(s)];return new Lp({viewBox:a,userUnit:1,scale:e,rotation:t})}function qw(i){if(i.startsWith("#")){const e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Be(`Not a valid color format: "${i}"`),[0,0,0])}function LD(i){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of i.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;i.set(t,qw(n))}e.remove()}function St(i){const{a:e,b:t,c:n,d:s,e:a,f:l}=i.getTransform();return[e,t,n,s,a,l]}function Os(i){const{a:e,b:t,c:n,d:s,e:a,f:l}=i.getTransform().invertSelf();return[e,t,n,s,a,l]}function nc(i,e,t=!1,n=!0){if(e instanceof Lp){const{pageWidth:s,pageHeight:a}=e.rawDims,{style:l}=i,c=Vn.isCSSRoundSupported,d=`var(--scale-factor) * ${s}px`,h=`var(--scale-factor) * ${a}px`,p=c?`round(down, ${d}, var(--scale-round-x, 1px))`:`calc(${d})`,v=c?`round(down, ${h}, var(--scale-round-y, 1px))`:`calc(${h})`;!t||e.rotation%180===0?(l.width=p,l.height=v):(l.width=v,l.height=p)}n&&i.setAttribute("data-main-rotation",e.rotation)}class Xb{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Ua,Qo,fs,Zo,df,hf,m0,fR,$n,pR,gR,wm,mR,Qb;const Tr=class Tr{constructor(e){M(this,$n);M(this,Ua,null);M(this,Qo,null);M(this,fs);M(this,Zo,null);M(this,df,null);C(this,fs,e),g(Tr,hf)||C(Tr,hf,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=C(this,Ua,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=g(this,fs)._uiManager._signal;e.addEventListener("contextmenu",Ns,{signal:t}),e.addEventListener("pointerdown",k(Tr,m0,fR),{signal:t});const n=C(this,Zo,document.createElement("div"));n.className="buttons",e.append(n);const s=g(this,fs).toolbarPosition;if(s){const{style:a}=e,l=g(this,fs)._uiManager.direction==="ltr"?1-s[0]:s[0];a.insetInlineEnd=`${100*l}%`,a.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return k(this,$n,mR).call(this),e}get div(){return g(this,Ua)}hide(){var e;g(this,Ua).classList.add("hidden"),(e=g(this,Qo))==null||e.hideDropdown()}show(){var e;g(this,Ua).classList.remove("hidden"),(e=g(this,df))==null||e.shown()}async addAltText(e){const t=await e.render();k(this,$n,wm).call(this,t),g(this,Zo).prepend(t,g(this,$n,Qb)),C(this,df,e)}addColorPicker(e){C(this,Qo,e);const t=e.renderButton();k(this,$n,wm).call(this,t),g(this,Zo).prepend(t,g(this,$n,Qb))}remove(){var e;g(this,Ua).remove(),(e=g(this,Qo))==null||e.destroy(),C(this,Qo,null)}};Ua=new WeakMap,Qo=new WeakMap,fs=new WeakMap,Zo=new WeakMap,df=new WeakMap,hf=new WeakMap,m0=new WeakSet,fR=function(e){e.stopPropagation()},$n=new WeakSet,pR=function(e){g(this,fs)._focusEventsAllowed=!1,Di(e)},gR=function(e){g(this,fs)._focusEventsAllowed=!0,Di(e)},wm=function(e){const t=g(this,fs)._uiManager._signal;e.addEventListener("focusin",k(this,$n,pR).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",k(this,$n,gR).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Ns,{signal:t})},mR=function(){const{editorType:e,_uiManager:t}=g(this,fs),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",g(Tr,hf)[e]),k(this,$n,wm).call(this,n),n.addEventListener("click",s=>{t.delete()},{signal:t._signal}),g(this,Zo).append(n)},Qb=function(){const e=document.createElement("div");return e.className="divider",e},M(Tr,m0),M(Tr,hf,null);let Wb=Tr;var ff,el,tl,yo,yR,vR,bR;class OD{constructor(e){M(this,yo);M(this,ff,null);M(this,el,null);M(this,tl);C(this,tl,e)}show(e,t,n){const[s,a]=k(this,yo,vR).call(this,t,n),{style:l}=g(this,el)||C(this,el,k(this,yo,yR).call(this));e.append(g(this,el)),l.insetInlineEnd=`${100*s}%`,l.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){g(this,el).remove()}}ff=new WeakMap,el=new WeakMap,tl=new WeakMap,yo=new WeakSet,yR=function(){const e=C(this,el,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Ns,{signal:g(this,tl)._signal});const t=C(this,ff,document.createElement("div"));return t.className="buttons",e.append(t),k(this,yo,bR).call(this),e},vR=function(e,t){let n=0,s=0;for(const a of e){const l=a.y+a.height;if(l<n)continue;const c=a.x+(t?a.width:0);if(l>n){s=c,n=l;continue}t?c>s&&(s=c):c<s&&(s=c)}return[t?1-s:s,n]},bR=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=g(this,tl)._signal;e.addEventListener("contextmenu",Ns,{signal:n}),e.addEventListener("click",()=>{g(this,tl).highlightSelection("floating_button")},{signal:n}),g(this,ff).append(e)};function Qm(i,e,t){for(const n of t)e.addEventListener(n,i[n].bind(i))}var y0;class UD{constructor(){M(this,y0,0)}get id(){return`${yD}${Un(this,y0)._++}`}}y0=new WeakMap;var Su,pf,Nn,Au,xm;const gx=class gx{constructor(){M(this,Au);M(this,Su,MD());M(this,pf,0);M(this,Nn,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const a=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ve(this,"_isSVGFittingCanvas",a)}async getFromFile(e){const{lastModified:t,name:n,size:s,type:a}=e;return k(this,Au,xm).call(this,`${t}_${n}_${s}_${a}`,e)}async getFromUrl(e){return k(this,Au,xm).call(this,e,e)}async getFromBlob(e,t){const n=await t;return k(this,Au,xm).call(this,e,n)}async getFromId(e){g(this,Nn)||C(this,Nn,new Map);const t=g(this,Nn).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){g(this,Nn)||C(this,Nn,new Map);let n=g(this,Nn).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${g(this,Su)}_${Un(this,pf)._++}`,refCounter:1,isSvg:!1},g(this,Nn).set(e,n),g(this,Nn).set(n.id,n),n}getSvgUrl(e){const t=g(this,Nn).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;g(this,Nn)||C(this,Nn,new Map);const t=g(this,Nn).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const a=new OffscreenCanvas(n.width,n.height);a.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=a.convertToBlob()}(s=n.close)==null||s.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${g(this,Su)}_`)}};Su=new WeakMap,pf=new WeakMap,Nn=new WeakMap,Au=new WeakSet,xm=async function(e,t){g(this,Nn)||C(this,Nn,new Map);let n=g(this,Nn).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${g(this,Su)}_${Un(this,pf)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(n.url=t,s=await B0(t,"blob")):t instanceof File?s=n.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const a=gx._isSVGFittingCanvas,l=new FileReader,c=new Image,d=new Promise((h,p)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,h()},l.onload=async()=>{const v=n.svgUrl=l.result;c.src=await a?`${v}#svgView(preserveAspectRatio(none))`:v},c.onerror=l.onerror=p});l.readAsDataURL(s),await d}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Be(s),n=null}return g(this,Nn).set(e,n),n&&g(this,Nn).set(n.id,n),n};let Zb=gx;var Lt,Fa,gf,Et;class FD{constructor(e=128){M(this,Lt,[]);M(this,Fa,!1);M(this,gf);M(this,Et,-1);C(this,gf,e)}add({cmd:e,undo:t,post:n,mustExec:s,type:a=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(s&&e(),g(this,Fa))return;const d={cmd:e,undo:t,post:n,type:a};if(g(this,Et)===-1){g(this,Lt).length>0&&(g(this,Lt).length=0),C(this,Et,0),g(this,Lt).push(d);return}if(l&&g(this,Lt)[g(this,Et)].type===a){c&&(d.undo=g(this,Lt)[g(this,Et)].undo),g(this,Lt)[g(this,Et)]=d;return}const h=g(this,Et)+1;h===g(this,gf)?g(this,Lt).splice(0,1):(C(this,Et,h),h<g(this,Lt).length&&g(this,Lt).splice(h)),g(this,Lt).push(d)}undo(){if(g(this,Et)===-1)return;C(this,Fa,!0);const{undo:e,post:t}=g(this,Lt)[g(this,Et)];e(),t==null||t(),C(this,Fa,!1),C(this,Et,g(this,Et)-1)}redo(){if(g(this,Et)<g(this,Lt).length-1){C(this,Et,g(this,Et)+1),C(this,Fa,!0);const{cmd:e,post:t}=g(this,Lt)[g(this,Et)];e(),t==null||t(),C(this,Fa,!1)}}hasSomethingToUndo(){return g(this,Et)!==-1}hasSomethingToRedo(){return g(this,Et)<g(this,Lt).length-1}cleanType(e){if(g(this,Et)!==-1){for(let t=g(this,Et);t>=0;t--)if(g(this,Lt)[t].type!==e){g(this,Lt).splice(t+1,g(this,Et)-t),C(this,Et,t);return}g(this,Lt).length=0,C(this,Et,-1)}}destroy(){C(this,Lt,null)}}Lt=new WeakMap,Fa=new WeakMap,gf=new WeakMap,Et=new WeakMap;var v0,_R;class Op{constructor(e){M(this,v0);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Vn.platform;for(const[n,s,a={}]of e)for(const l of n){const c=l.startsWith("mac+");t&&c?(this.callbacks.set(l.slice(4),{callback:s,options:a}),this.allKeys.add(l.split("+").at(-1))):!t&&!c&&(this.callbacks.set(l,{callback:s,options:a}),this.allKeys.add(l.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(k(this,v0,_R).call(this,t));if(!n)return;const{callback:s,options:{bubbles:a=!1,args:l=[],checker:c=null}}=n;c&&!c(e,t)||(s.bind(e,...l,t)(),a||Di(t))}}v0=new WeakSet,_R=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const b0=class b0{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return LD(e),Ve(this,"_colors",e)}convert(e){const t=qw(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((a,l)=>a===t[l]))return b0._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?xe.makeHexColor(...t):e}};Re(b0,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let e_=b0;var Eu,bi,Xt,bn,Tu,Rr,Cu,Ki,Ha,nl,Ru,il,Hs,ps,sl,mf,yf,Nu,vf,Bs,Ba,Mu,Ga,Gs,_0,za,bf,qa,rl,_f,wf,rn,at,Nr,al,xf,Sf,Va,zs,Mr,Af,Ji,ae,Sm,t_,wR,xR,Am,SR,AR,ER,n_,TR,i_,s_,CR,Fn,Sr,RR,NR,r_,MR,Ph,a_;const mu=class mu{constructor(e,t,n,s,a,l,c,d,h,p,v,_,x){M(this,ae);M(this,Eu,new AbortController);M(this,bi,null);M(this,Xt,new Map);M(this,bn,new Map);M(this,Tu,null);M(this,Rr,null);M(this,Cu,null);M(this,Ki,new FD);M(this,Ha,null);M(this,nl,null);M(this,Ru,0);M(this,il,new Set);M(this,Hs,null);M(this,ps,null);M(this,sl,new Set);Re(this,"_editorUndoBar",null);M(this,mf,!1);M(this,yf,!1);M(this,Nu,!1);M(this,vf,null);M(this,Bs,null);M(this,Ba,null);M(this,Mu,null);M(this,Ga,!1);M(this,Gs,null);M(this,_0,new UD);M(this,za,!1);M(this,bf,!1);M(this,qa,null);M(this,rl,null);M(this,_f,null);M(this,wf,null);M(this,rn,He.NONE);M(this,at,new Set);M(this,Nr,null);M(this,al,null);M(this,xf,null);M(this,Sf,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});M(this,Va,[0,0]);M(this,zs,null);M(this,Mr,null);M(this,Af,null);M(this,Ji,null);const A=this._signal=g(this,Eu).signal;C(this,Mr,e),C(this,Af,t),C(this,Tu,n),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:A}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:A}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:A}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:A}),s._on("setpreference",this.onSetPreference.bind(this),{signal:A}),s._on("switchannotationeditorparams",E=>this.updateParams(E.type,E.value),{signal:A}),k(this,ae,SR).call(this),k(this,ae,CR).call(this),k(this,ae,n_).call(this),C(this,Rr,a.annotationStorage),C(this,vf,a.filterFactory),C(this,al,l),C(this,Mu,c||null),C(this,mf,d),C(this,yf,h),C(this,Nu,p),C(this,wf,v||null),this.viewParameters={realScale:mo.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=_||null,this._supportsPinchToZoom=x!==!1}static get _keyboardManager(){const e=mu.prototype,t=l=>g(l,Mr).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:d}=c;return d!=="text"&&d!=="number"}return!0},s=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new Op([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&g(l,Mr).contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&g(l,Mr).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}]]))}destroy(){var e,t,n,s,a;(e=g(this,Ji))==null||e.resolve(),C(this,Ji,null),(t=g(this,Eu))==null||t.abort(),C(this,Eu,null),this._signal=null;for(const l of g(this,bn).values())l.destroy();g(this,bn).clear(),g(this,Xt).clear(),g(this,sl).clear(),C(this,bi,null),g(this,at).clear(),g(this,Ki).destroy(),(n=g(this,Tu))==null||n.destroy(),(s=g(this,Gs))==null||s.hide(),C(this,Gs,null),g(this,Bs)&&(clearTimeout(g(this,Bs)),C(this,Bs,null)),g(this,zs)&&(clearTimeout(g(this,zs)),C(this,zs,null)),(a=this._editorUndoBar)==null||a.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return g(this,wf)}get useNewAltTextFlow(){return g(this,yf)}get useNewAltTextWhenAddingImage(){return g(this,Nu)}get hcmFilter(){return Ve(this,"hcmFilter",g(this,al)?g(this,vf).addHCMFilter(g(this,al).foreground,g(this,al).background):"none")}get direction(){return Ve(this,"direction",getComputedStyle(g(this,Mr)).direction)}get highlightColors(){return Ve(this,"highlightColors",g(this,Mu)?new Map(g(this,Mu).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return Ve(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),C(this,nl,e)}setMainHighlightColorPicker(e){C(this,_f,e)}editAltText(e,t=!1){var n;(n=g(this,Tu))==null||n.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":C(this,Nu,t);break}}onPageChanging({pageNumber:e}){C(this,Ru,e-1)}focusMainContainer(){g(this,Mr).focus()}findParent(e,t){for(const n of g(this,bn).values()){const{x:s,y:a,width:l,height:c}=n.div.getBoundingClientRect();if(e>=s&&e<=s+l&&t>=a&&t<=a+c)return n}return null}disableUserSelect(e=!1){g(this,Af).classList.toggle("noUserSelect",e)}addShouldRescale(e){g(this,sl).add(e)}removeShouldRescale(e){g(this,sl).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*mo.PDF_TO_CSS_UNITS;for(const n of g(this,sl))n.onScaleChanging();(t=g(this,nl))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:l}=t,c=t.toString(),h=k(this,ae,Sm).call(this,t).closest(".textLayer"),p=this.getSelectionBoxes(h);if(!p)return;t.empty();const v=k(this,ae,t_).call(this,h),_=g(this,rn)===He.NONE,x=()=>{v==null||v.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:p,anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:l,text:c}),_&&this.showAllEditors("highlight",!0,!0)};if(_){this.switchToMode(He.HIGHLIGHT,x);return}x()}addToAnnotationStorage(e){!e.isEmpty()&&g(this,Rr)&&!g(this,Rr).has(e.id)&&g(this,Rr).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,g(this,Ga)&&(C(this,Ga,!1),k(this,ae,Am).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of g(this,at))if(t.div.contains(e)){C(this,rl,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!g(this,rl))return;const[e,t]=g(this,rl);C(this,rl,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){k(this,ae,n_).call(this),k(this,ae,i_).call(this)}removeEditListeners(){k(this,ae,TR).call(this),k(this,ae,s_).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of g(this,ps))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of g(this,ps))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=g(this,bi))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of g(this,at)){const a=s.serialize(!0);a&&t.push(a)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const l of g(this,ps))if(l.isHandlingMimeForPasting(a.type)){l.paste(a,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(a){Be(`paste: "${a.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const a=[];for(const d of n){const h=await s.deserialize(d);if(!h)return;a.push(h)}const l=()=>{for(const d of a)k(this,ae,r_).call(this,d);k(this,ae,a_).call(this,a)},c=()=>{for(const d of a)d.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(a){Be(`paste: "${a.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),g(this,rn)!==He.NONE&&!this.isEditorHandlingKeyboard&&mu._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,g(this,Ga)&&(C(this,Ga,!1),k(this,ae,Am).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(k(this,ae,AR).call(this),k(this,ae,i_).call(this),k(this,ae,Fn).call(this,{isEditing:g(this,rn)!==He.NONE,isEmpty:k(this,ae,Ph).call(this),hasSomethingToUndo:g(this,Ki).hasSomethingToUndo(),hasSomethingToRedo:g(this,Ki).hasSomethingToRedo(),hasSelectedEditor:!1})):(k(this,ae,ER).call(this),k(this,ae,s_).call(this),k(this,ae,Fn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!g(this,ps)){C(this,ps,e);for(const t of g(this,ps))k(this,ae,Sr).call(this,t.defaultPropertiesToUpdate)}}getId(){return g(this,_0).id}get currentLayer(){return g(this,bn).get(g(this,Ru))}getLayer(e){return g(this,bn).get(e)}get currentPageIndex(){return g(this,Ru)}addLayer(e){g(this,bn).set(e.pageIndex,e),g(this,za)?e.enable():e.disable()}removeLayer(e){g(this,bn).delete(e.pageIndex)}async updateMode(e,t=null,n=!1){var s;if(g(this,rn)!==e&&!(g(this,Ji)&&(await g(this,Ji).promise,!g(this,Ji)))){if(C(this,Ji,Promise.withResolvers()),C(this,rn,e),e===He.NONE){this.setEditingState(!1),k(this,ae,NR).call(this),(s=this._editorUndoBar)==null||s.hide(),g(this,Ji).resolve();return}this.setEditingState(!0),await k(this,ae,RR).call(this),this.unselectAll();for(const a of g(this,bn).values())a.updateMode(e);if(!t){n&&this.addNewEditorFromKeyboard(),g(this,Ji).resolve();return}for(const a of g(this,Xt).values())a.annotationElementId===t?(this.setSelected(a),a.enterInEditMode()):a.unselect();g(this,Ji).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==g(this,rn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var n;if(g(this,ps)){switch(e){case Xe.CREATE:this.currentLayer.addNewEditor();return;case Xe.HIGHLIGHT_DEFAULT_COLOR:(n=g(this,_f))==null||n.updateColor(t);break;case Xe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(g(this,xf)||C(this,xf,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const s of g(this,at))s.updateParams(e,t);for(const s of g(this,ps))s.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var a;for(const l of g(this,Xt).values())l.editorType===e&&l.show(t);(((a=g(this,xf))==null?void 0:a.get(Xe.HIGHLIGHT_SHOW_ALL))??!0)!==t&&k(this,ae,Sr).call(this,[[Xe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(g(this,bf)!==e){C(this,bf,e);for(const t of g(this,bn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const n of g(this,Xt).values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return g(this,Xt).get(e)}addEditor(e){g(this,Xt).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(g(this,Bs)&&clearTimeout(g(this,Bs)),C(this,Bs,setTimeout(()=>{this.focusMainContainer(),C(this,Bs,null)},0))),g(this,Xt).delete(e.id),this.unselect(e),(!e.annotationElementId||!g(this,il).has(e.annotationElementId))&&((t=g(this,Rr))==null||t.remove(e.id))}addDeletedAnnotationElement(e){g(this,il).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return g(this,il).has(e)}removeDeletedAnnotationElement(e){g(this,il).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){g(this,bi)!==e&&(C(this,bi,e),e&&k(this,ae,Sr).call(this,e.propertiesToUpdate))}updateUI(e){g(this,ae,MR)===e&&k(this,ae,Sr).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){k(this,ae,Sr).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(g(this,at).has(e)){g(this,at).delete(e),e.unselect(),k(this,ae,Fn).call(this,{hasSelectedEditor:this.hasSelection});return}g(this,at).add(e),e.select(),k(this,ae,Sr).call(this,e.propertiesToUpdate),k(this,ae,Fn).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=g(this,nl))==null||t.commitOrRemove();for(const n of g(this,at))n!==e&&n.unselect();g(this,at).clear(),g(this,at).add(e),e.select(),k(this,ae,Sr).call(this,e.propertiesToUpdate),k(this,ae,Fn).call(this,{hasSelectedEditor:!0})}isSelected(e){return g(this,at).has(e)}get firstSelectedEditor(){return g(this,at).values().next().value}unselect(e){e.unselect(),g(this,at).delete(e),k(this,ae,Fn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return g(this,at).size!==0}get isEnterHandled(){return g(this,at).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;g(this,Ki).undo(),k(this,ae,Fn).call(this,{hasSomethingToUndo:g(this,Ki).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:k(this,ae,Ph).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){g(this,Ki).redo(),k(this,ae,Fn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:g(this,Ki).hasSomethingToRedo(),isEmpty:k(this,ae,Ph).call(this)})}addCommands(e){g(this,Ki).add(e),k(this,ae,Fn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:k(this,ae,Ph).call(this)})}cleanUndoStack(e){g(this,Ki).cleanType(e)}delete(){var a;this.commitOrRemove();const e=(a=this.currentLayer)==null?void 0:a.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...g(this,at)],n=()=>{var l;(l=this._editorUndoBar)==null||l.show(s,t.length===1?t[0].editorType:t.length);for(const c of t)c.remove()},s=()=>{for(const l of t)k(this,ae,r_).call(this,l)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=g(this,bi))==null||e.commitOrRemove()}hasSomethingToControl(){return g(this,bi)||this.hasSelection}selectAll(){for(const e of g(this,at))e.commit();k(this,ae,a_).call(this,g(this,Xt).values())}unselectAll(){var e;if(!(g(this,bi)&&(g(this,bi).commitOrRemove(),g(this,rn)!==He.NONE))&&!((e=g(this,nl))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of g(this,at))t.unselect();g(this,at).clear(),k(this,ae,Fn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;g(this,Va)[0]+=e,g(this,Va)[1]+=t;const[s,a]=g(this,Va),l=[...g(this,at)],c=1e3;g(this,zs)&&clearTimeout(g(this,zs)),C(this,zs,setTimeout(()=>{C(this,zs,null),g(this,Va)[0]=g(this,Va)[1]=0,this.addCommands({cmd:()=>{for(const d of l)g(this,Xt).has(d.id)&&d.translateInPage(s,a)},undo:()=>{for(const d of l)g(this,Xt).has(d.id)&&d.translateInPage(-s,-a)},mustExec:!1})},c));for(const d of l)d.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),C(this,Hs,new Map);for(const e of g(this,at))g(this,Hs).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!g(this,Hs))return!1;this.disableUserSelect(!1);const e=g(this,Hs);C(this,Hs,null);let t=!1;for(const[{x:s,y:a,pageIndex:l},c]of e)c.newX=s,c.newY=a,c.newPageIndex=l,t||(t=s!==c.savedX||a!==c.savedY||l!==c.savedPageIndex);if(!t)return!1;const n=(s,a,l,c)=>{if(g(this,Xt).has(s.id)){const d=g(this,bn).get(c);d?s._setParentAndPosition(d,a,l):(s.pageIndex=c,s.x=a,s.y=l)}};return this.addCommands({cmd:()=>{for(const[s,{newX:a,newY:l,newPageIndex:c}]of e)n(s,a,l,c)},undo:()=>{for(const[s,{savedX:a,savedY:l,savedPageIndex:c}]of e)n(s,a,l,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(g(this,Hs))for(const n of g(this,Hs).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||g(this,at).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return g(this,bi)===e}getActive(){return g(this,bi)}getMode(){return g(this,rn)}get imageManager(){return Ve(this,"imageManager",new Zb)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,p=t.rangeCount;h<p;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:n,y:s,width:a,height:l}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(h,p,v,_)=>({x:(p-s)/l,y:1-(h+v-n)/a,width:_/l,height:v/a});break;case"180":c=(h,p,v,_)=>({x:1-(h+v-n)/a,y:1-(p+_-s)/l,width:v/a,height:_/l});break;case"270":c=(h,p,v,_)=>({x:1-(p+_-s)/l,y:(h-n)/a,width:_/l,height:v/a});break;default:c=(h,p,v,_)=>({x:(h-n)/a,y:(p-s)/l,width:v/a,height:_/l});break}const d=[];for(let h=0,p=t.rangeCount;h<p;h++){const v=t.getRangeAt(h);if(!v.collapsed)for(const{x:_,y:x,width:A,height:E}of v.getClientRects())A===0||E===0||d.push(c(_,x,A,E))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:e,id:t}){(g(this,Cu)||C(this,Cu,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=g(this,Cu))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=g(this,Cu))==null?void 0:s.get(e.data.id);if(!t)return;const n=g(this,Rr).getRawValue(t);n&&(g(this,rn)===He.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}};Eu=new WeakMap,bi=new WeakMap,Xt=new WeakMap,bn=new WeakMap,Tu=new WeakMap,Rr=new WeakMap,Cu=new WeakMap,Ki=new WeakMap,Ha=new WeakMap,nl=new WeakMap,Ru=new WeakMap,il=new WeakMap,Hs=new WeakMap,ps=new WeakMap,sl=new WeakMap,mf=new WeakMap,yf=new WeakMap,Nu=new WeakMap,vf=new WeakMap,Bs=new WeakMap,Ba=new WeakMap,Mu=new WeakMap,Ga=new WeakMap,Gs=new WeakMap,_0=new WeakMap,za=new WeakMap,bf=new WeakMap,qa=new WeakMap,rl=new WeakMap,_f=new WeakMap,wf=new WeakMap,rn=new WeakMap,at=new WeakMap,Nr=new WeakMap,al=new WeakMap,xf=new WeakMap,Sf=new WeakMap,Va=new WeakMap,zs=new WeakMap,Mr=new WeakMap,Af=new WeakMap,Ji=new WeakMap,ae=new WeakSet,Sm=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},t_=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of g(this,bn).values())if(n.hasTextLayer(e))return n;return null},wR=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=k(this,ae,Sm).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(g(this,Gs)||C(this,Gs,new OD(this)),g(this,Gs).show(n,s,this.direction==="ltr"))},xR=function(){var a,l,c;const e=document.getSelection();if(!e||e.isCollapsed){g(this,Nr)&&((a=g(this,Gs))==null||a.hide(),C(this,Nr,null),k(this,ae,Fn).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===g(this,Nr))return;const s=k(this,ae,Sm).call(this,e).closest(".textLayer");if(!s){g(this,Nr)&&((l=g(this,Gs))==null||l.hide(),C(this,Nr,null),k(this,ae,Fn).call(this,{hasSelectedText:!1}));return}if((c=g(this,Gs))==null||c.hide(),C(this,Nr,t),k(this,ae,Fn).call(this,{hasSelectedText:!0}),!(g(this,rn)!==He.HIGHLIGHT&&g(this,rn)!==He.NONE)&&(g(this,rn)===He.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),C(this,Ga,this.isShiftKeyDown),!this.isShiftKeyDown)){const d=g(this,rn)===He.HIGHLIGHT?k(this,ae,t_).call(this,s):null;d==null||d.toggleDrawing();const h=new AbortController,p=this.combinedSignal(h),v=_=>{_.type==="pointerup"&&_.button!==0||(h.abort(),d==null||d.toggleDrawing(!0),_.type==="pointerup"&&k(this,ae,Am).call(this,"main_toolbar"))};window.addEventListener("pointerup",v,{signal:p}),window.addEventListener("blur",v,{signal:p})}},Am=function(e=""){g(this,rn)===He.HIGHLIGHT?this.highlightSelection(e):g(this,mf)&&k(this,ae,wR).call(this)},SR=function(){document.addEventListener("selectionchange",k(this,ae,xR).bind(this),{signal:this._signal})},AR=function(){if(g(this,Ba))return;C(this,Ba,new AbortController);const e=this.combinedSignal(g(this,Ba));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},ER=function(){var e;(e=g(this,Ba))==null||e.abort(),C(this,Ba,null)},n_=function(){if(g(this,qa))return;C(this,qa,new AbortController);const e=this.combinedSignal(g(this,qa));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},TR=function(){var e;(e=g(this,qa))==null||e.abort(),C(this,qa,null)},i_=function(){if(g(this,Ha))return;C(this,Ha,new AbortController);const e=this.combinedSignal(g(this,Ha));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},s_=function(){var e;(e=g(this,Ha))==null||e.abort(),C(this,Ha,null)},CR=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Fn=function(e){Object.entries(e).some(([n,s])=>g(this,Sf)[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(g(this,Sf),e)}),g(this,rn)===He.HIGHLIGHT&&e.hasSelectedEditor===!1&&k(this,ae,Sr).call(this,[[Xe.HIGHLIGHT_FREE,!0]]))},Sr=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},RR=async function(){if(!g(this,za)){C(this,za,!0);const e=[];for(const t of g(this,bn).values())e.push(t.enable());await Promise.all(e);for(const t of g(this,Xt).values())t.enable()}},NR=function(){if(this.unselectAll(),g(this,za)){C(this,za,!1);for(const e of g(this,bn).values())e.disable();for(const e of g(this,Xt).values())e.disable()}},r_=function(e){const t=g(this,bn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},MR=function(){let e=null;for(e of g(this,at));return e},Ph=function(){if(g(this,Xt).size===0)return!0;if(g(this,Xt).size===1)for(const e of g(this,Xt).values())return e.isEmpty();return!1},a_=function(e){for(const t of g(this,at))t.unselect();g(this,at).clear();for(const t of e)t.isEmpty()||(g(this,at).add(t),t.select());k(this,ae,Fn).call(this,{hasSelectedEditor:this.hasSelection})},Re(mu,"TRANSLATE_SMALL",1),Re(mu,"TRANSLATE_BIG",10);let ic=mu;var an,qs,gs,ku,Vs,_i,Iu,$s,si,kr,ol,js,$a,Ts,Lh,Em;const Hn=class Hn{constructor(e){M(this,Ts);M(this,an,null);M(this,qs,!1);M(this,gs,null);M(this,ku,null);M(this,Vs,null);M(this,_i,null);M(this,Iu,!1);M(this,$s,null);M(this,si,null);M(this,kr,null);M(this,ol,null);M(this,js,!1);C(this,si,e),C(this,js,e._uiManager.useNewAltTextFlow),g(Hn,$a)||C(Hn,$a,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Hn._l10n??(Hn._l10n=e)}async render(){const e=C(this,gs,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=C(this,ku,document.createElement("span"));e.append(t),g(this,js)?(e.classList.add("new"),e.setAttribute("data-l10n-id",g(Hn,$a).missing),t.setAttribute("data-l10n-id",g(Hn,$a)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=g(this,si)._uiManager._signal;e.addEventListener("contextmenu",Ns,{signal:n}),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const s=a=>{a.preventDefault(),g(this,si)._uiManager.editAltText(g(this,si)),g(this,js)&&g(this,si)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:g(this,Ts,Lh)}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(C(this,Iu,!0),s(a))},{signal:n}),await k(this,Ts,Em).call(this),e}finish(){g(this,gs)&&(g(this,gs).focus({focusVisible:g(this,Iu)}),C(this,Iu,!1))}isEmpty(){return g(this,js)?g(this,an)===null:!g(this,an)&&!g(this,qs)}hasData(){return g(this,js)?g(this,an)!==null||!!g(this,kr):this.isEmpty()}get guessedText(){return g(this,kr)}async setGuessedText(e){g(this,an)===null&&(C(this,kr,e),C(this,ol,await Hn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),k(this,Ts,Em).call(this))}toggleAltTextBadge(e=!1){var t;if(!g(this,js)||g(this,an)){(t=g(this,$s))==null||t.remove(),C(this,$s,null);return}if(!g(this,$s)){const n=C(this,$s,document.createElement("div"));n.className="noAltTextBadge",g(this,si).div.append(n)}g(this,$s).classList.toggle("hidden",!e)}serialize(e){let t=g(this,an);return!e&&g(this,kr)===t&&(t=g(this,ol)),{altText:t,decorative:g(this,qs),guessedText:g(this,kr),textWithDisclaimer:g(this,ol)}}get data(){return{altText:g(this,an),decorative:g(this,qs)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:s,cancel:a=!1}){n&&(C(this,kr,n),C(this,ol,s)),!(g(this,an)===e&&g(this,qs)===t)&&(a||(C(this,an,e),C(this,qs,t)),k(this,Ts,Em).call(this))}toggle(e=!1){g(this,gs)&&(!e&&g(this,_i)&&(clearTimeout(g(this,_i)),C(this,_i,null)),g(this,gs).disabled=!e)}shown(){g(this,si)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:g(this,Ts,Lh)}})}destroy(){var e,t;(e=g(this,gs))==null||e.remove(),C(this,gs,null),C(this,ku,null),C(this,Vs,null),(t=g(this,$s))==null||t.remove(),C(this,$s,null)}};an=new WeakMap,qs=new WeakMap,gs=new WeakMap,ku=new WeakMap,Vs=new WeakMap,_i=new WeakMap,Iu=new WeakMap,$s=new WeakMap,si=new WeakMap,kr=new WeakMap,ol=new WeakMap,js=new WeakMap,$a=new WeakMap,Ts=new WeakSet,Lh=function(){return g(this,an)&&"added"||g(this,an)===null&&this.guessedText&&"review"||"missing"},Em=async function(){var s,a,l;const e=g(this,gs);if(!e)return;if(g(this,js)){if(e.classList.toggle("done",!!g(this,an)),e.setAttribute("data-l10n-id",g(Hn,$a)[g(this,Ts,Lh)]),(s=g(this,ku))==null||s.setAttribute("data-l10n-id",g(Hn,$a)[`${g(this,Ts,Lh)}-label`]),!g(this,an)){(a=g(this,Vs))==null||a.remove();return}}else{if(!g(this,an)&&!g(this,qs)){e.classList.remove("done"),(l=g(this,Vs))==null||l.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=g(this,Vs);if(!t){C(this,Vs,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${g(this,si).id}`;const c=100,d=g(this,si)._uiManager._signal;d.addEventListener("abort",()=>{clearTimeout(g(this,_i)),C(this,_i,null)},{once:!0}),e.addEventListener("mouseenter",()=>{C(this,_i,setTimeout(()=>{C(this,_i,null),g(this,Vs).classList.add("show"),g(this,si)._reportTelemetry({action:"alt_text_tooltip"})},c))},{signal:d}),e.addEventListener("mouseleave",()=>{var h;g(this,_i)&&(clearTimeout(g(this,_i)),C(this,_i,null)),(h=g(this,Vs))==null||h.classList.remove("show")},{signal:d})}g(this,qs)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=g(this,an)),t.parentNode||e.append(t);const n=g(this,si).getImageForAltText();n==null||n.setAttribute("aria-describedby",t.id)},M(Hn,$a,null),Re(Hn,"_l10n",null);let Zm=Hn;var Ef,ll,Tf,Cf,Rf,Nf,Mf,Du,Ir,cl,ja,ia,kR,IR,o_;const mx=class mx{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:a=null,onPinchEnd:l=null,signal:c}){M(this,ia);M(this,Ef);M(this,ll,!1);M(this,Tf,null);M(this,Cf);M(this,Rf);M(this,Nf);M(this,Mf);M(this,Du);M(this,Ir,null);M(this,cl);M(this,ja,null);C(this,Ef,e),C(this,Tf,n),C(this,Cf,t),C(this,Rf,s),C(this,Nf,a),C(this,Mf,l),C(this,cl,new AbortController),C(this,Du,AbortSignal.any([c,g(this,cl).signal])),e.addEventListener("touchstart",k(this,ia,kR).bind(this),{passive:!1,signal:g(this,Du)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Ve(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=g(this,cl))==null||e.abort(),C(this,cl,null)}};Ef=new WeakMap,ll=new WeakMap,Tf=new WeakMap,Cf=new WeakMap,Rf=new WeakMap,Nf=new WeakMap,Mf=new WeakMap,Du=new WeakMap,Ir=new WeakMap,cl=new WeakMap,ja=new WeakMap,ia=new WeakSet,kR=function(e){var s,a,l;if((s=g(this,Cf))!=null&&s.call(this)||e.touches.length<2)return;if(!g(this,ja)){C(this,ja,new AbortController);const c=AbortSignal.any([g(this,Du),g(this,ja).signal]),d=g(this,Ef),h={signal:c,passive:!1};d.addEventListener("touchmove",k(this,ia,IR).bind(this),h),d.addEventListener("touchend",k(this,ia,o_).bind(this),h),d.addEventListener("touchcancel",k(this,ia,o_).bind(this),h),(a=g(this,Rf))==null||a.call(this)}if(Di(e),e.touches.length!==2||(l=g(this,Tf))!=null&&l.call(this)){C(this,Ir,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),C(this,Ir,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},IR=function(e){var L;if(!g(this,Ir)||e.touches.length!==2)return;let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:s,screenY:a}=t,{screenX:l,screenY:c}=n,d=g(this,Ir),{touch0X:h,touch0Y:p,touch1X:v,touch1Y:_}=d,x=v-h,A=_-p,E=l-s,R=c-a,N=Math.hypot(E,R)||1,D=Math.hypot(x,A)||1;if(!g(this,ll)&&Math.abs(D-N)<=mx.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=s,d.touch0Y=a,d.touch1X=l,d.touch1Y=c,e.preventDefault(),!g(this,ll)){C(this,ll,!0);return}const P=[(s+l)/2,(a+c)/2];(L=g(this,Nf))==null||L.call(this,P,D,N)},o_=function(e){var t;g(this,ja).abort(),C(this,ja,null),(t=g(this,Mf))==null||t.call(this),g(this,Ir)&&(e.preventDefault(),C(this,Ir,null),C(this,ll,!1))};let e0=mx;var ul,ms,bt,Pu,Ya,kf,dl,_n,hl,Dr,Ka,If,fl,wi,Df,pl,Pr,Ys,Lu,Ou,Xi,gl,Pf,w0,Ne,l_,Lf,c_,Tm,DR,PR,u_,Cm,d_,LR,OR,UR,h_,FR,f_,HR,BR,GR,p_,Oh;const Ge=class Ge{constructor(e){M(this,Ne);M(this,ul,null);M(this,ms,null);M(this,bt,null);M(this,Pu,!1);M(this,Ya,null);M(this,kf,"");M(this,dl,!1);M(this,_n,null);M(this,hl,null);M(this,Dr,null);M(this,Ka,null);M(this,If,"");M(this,fl,!1);M(this,wi,null);M(this,Df,!1);M(this,pl,!1);M(this,Pr,!1);M(this,Ys,null);M(this,Lu,0);M(this,Ou,0);M(this,Xi,null);M(this,gl,null);Re(this,"_editToolbar",null);Re(this,"_initialOptions",Object.create(null));Re(this,"_initialData",null);Re(this,"_isVisible",!0);Re(this,"_uiManager",null);Re(this,"_focusEventsAllowed",!0);M(this,Pf,!1);M(this,w0,Ge._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:a,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[a,l];const[c,d]=this.parentDimensions;this.x=e.x/c,this.y=e.y/d,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Ge.prototype._resizeWithKeyboard,t=ic.TRANSLATE_SMALL,n=ic.TRANSLATE_BIG;return Ve(this,"_resizerKeyboardManager",new Op([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Ge.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Ve(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new HD({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Ge._l10n??(Ge._l10n=e),Ge._l10nResizer||(Ge._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Ge._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Ge._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){pt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return g(this,Pf)}set _isDraggable(e){var t;C(this,Pf,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=g(this,w0)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):k(this,Ne,Oh).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(g(this,fl)?C(this,fl,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[a,l]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/a,this.y=(t+s)/l,this.fixAndSetPosition()}translate(e,t){k(this,Ne,l_).call(this,this.parentDimensions,e,t)}translateInPage(e,t){g(this,wi)||C(this,wi,[this.x,this.y,this.width,this.height]),k(this,Ne,l_).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){g(this,wi)||C(this,wi,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[s,a]}=this;if(this.x+=e/s,this.y+=t/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:v,y:_}=this.div.getBoundingClientRect();this.parent.findNewParent(this,v,_)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[d,h]=this.getBaseTranslation();l+=d,c+=h;const{style:p}=n;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!g(this,wi)&&(g(this,wi)[0]!==this.x||g(this,wi)[1]!==this.y)}get _hasBeenResized(){return!!g(this,wi)&&(g(this,wi)[2]!==this.width||g(this,wi)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Ge,s=n/e,a=n/t;switch(this.rotation){case 90:return[-s,a];case 180:return[s,a];case 270:return[s,-a];default:return[-s,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,s]}=this;let{x:a,y:l,width:c,height:d}=this;if(c*=n,d*=s,a*=n,l*=s,this._mustFixPosition)switch(e){case 0:a=Math.max(0,Math.min(n-c,a)),l=Math.max(0,Math.min(s-d,l));break;case 90:a=Math.max(0,Math.min(n-d,a)),l=Math.min(s,Math.max(c,l));break;case 180:a=Math.min(n,Math.max(c,a)),l=Math.min(s,Math.max(d,l));break;case 270:a=Math.min(n,Math.max(d,a)),l=Math.max(0,Math.min(s-c,l));break}this.x=a/=n,this.y=l/=s;const[h,p]=this.getBaseTranslation();a+=h,l+=p,t.left=`${(100*a).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return k(n=Ge,Lf,c_).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return k(n=Ge,Lf,c_).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,s]=this.parentDimensions,{style:a}=this.div;a.width=`${(100*e/n).toFixed(2)}%`,g(this,dl)||(a.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,s=n.endsWith("%"),a=!g(this,dl)&&t.endsWith("%");if(s&&a)return;const[l,c]=this.parentDimensions;s||(e.width=`${(100*parseFloat(n)/l).toFixed(2)}%`),!g(this,dl)&&!a&&(e.height=`${(100*parseFloat(t)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=g(this,bt))==null||e.finish()}async addEditToolbar(){return this._editToolbar||g(this,pl)?this._editToolbar:(this._editToolbar=new Wb(this),this.div.append(this._editToolbar.render()),g(this,bt)&&await this._editToolbar.addAltText(g(this,bt)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=g(this,bt))==null||e.destroy())}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){g(this,bt)||(Zm.initialize(Ge._l10n),C(this,bt,new Zm(this)),g(this,ul)&&(g(this,bt).data=g(this,ul),C(this,ul,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=g(this,bt))==null?void 0:e.data}set altTextData(e){g(this,bt)&&(g(this,bt).data=e)}get guessedAltText(){var e;return(e=g(this,bt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=g(this,bt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=g(this,bt))==null?void 0:t.serialize(e)}hasAltText(){return!!g(this,bt)&&!g(this,bt).isEmpty()}hasAltTextData(){var e;return((e=g(this,bt))==null?void 0:e.hasData())??!1}render(){var a;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=g(this,Pu)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),k(this,Ne,f_).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[n,s]=this.getInitialTranslation();return this.translate(n,s),Qm(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(g(this,gl)||C(this,gl,new e0({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:k(this,Ne,LR).bind(this),onPinching:k(this,Ne,OR).bind(this),onPinchEnd:k(this,Ne,UR).bind(this),signal:this._uiManager._signal}))),(a=this._uiManager._editorUndoBar)==null||a.hide(),this.div}pointerdown(e){const{isMac:t}=Vn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(C(this,fl,!0),this._isDraggable){k(this,Ne,FR).call(this,e);return}k(this,Ne,h_).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){g(this,Ys)&&clearTimeout(g(this,Ys)),C(this,Ys,setTimeout(()=>{var e;C(this,Ys,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const s=this.parentScale,[a,l]=this.pageDimensions,[c,d]=this.pageTranslation,h=e/s,p=t/s,v=this.x*a,_=this.y*l,x=this.width*a,A=this.height*l;switch(n){case 0:return[v+h+c,l-_-p-A+d,v+h+x+c,l-_-p+d];case 90:return[v+p+c,l-_+h+d,v+p+A+c,l-_+h+x+d];case 180:return[v-h-x+c,l-_+p+d,v-h+c,l-_+p+A+d];case 270:return[v-p-A+c,l-_-h-x+d,v-p+c,l-_-h+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,a,l]=e,c=a-n,d=l-s;switch(this.rotation){case 0:return[n,t-l,c,d];case 90:return[n,t-s,d,c];case 180:return[a,t-s,c,d];case 270:return[a,t-l,d,c];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){C(this,pl,!0)}disableEditMode(){C(this,pl,!1)}isInEditMode(){return g(this,pl)}shouldGetKeyboardEvents(){return g(this,Pr)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:a,innerWidth:l}=window;return t<l&&s>0&&e<a&&n>0}rebuild(){k(this,Ne,f_).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){pt("An editor must be serializable")}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});s.rotation=e.rotation,C(s,ul,e.accessibilityData);const[a,l]=s.pageDimensions,[c,d,h,p]=s.getRectInCurrentCoords(e.rect,l);return s.x=c/a,s.y=d/l,s.width=h/a,s.height=p/l,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=g(this,Ka))==null||e.abort(),C(this,Ka,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),g(this,Ys)&&(clearTimeout(g(this,Ys)),C(this,Ys,null)),k(this,Ne,Oh).call(this),this.removeEditToolbar(),g(this,Xi)){for(const n of g(this,Xi).values())clearTimeout(n);C(this,Xi,null)}this.parent=null,(t=g(this,gl))==null||t.destroy(),C(this,gl,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(k(this,Ne,DR).call(this),g(this,_n).classList.remove("hidden"),Qm(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),C(this,Dr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=g(this,_n).children;if(!g(this,ms)){C(this,ms,Array.from(t));const l=k(this,Ne,HR).bind(this),c=k(this,Ne,BR).bind(this),d=this._uiManager._signal;for(const h of g(this,ms)){const p=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",l,{signal:d}),h.addEventListener("blur",c,{signal:d}),h.addEventListener("focus",k(this,Ne,GR).bind(this,p),{signal:d}),h.setAttribute("data-l10n-id",Ge._l10nResizer[p])}}const n=g(this,ms)[0];let s=0;for(const l of t){if(l===n)break;s++}const a=(360-this.rotation+this.parentRotation)%360/90*(g(this,ms).length/4);if(a!==s){if(a<s)for(let c=0;c<s-a;c++)g(this,_n).append(g(this,_n).firstChild);else if(a>s)for(let c=0;c<a-s;c++)g(this,_n).firstChild.before(g(this,_n).lastChild);let l=0;for(const c of t){const h=g(this,ms)[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Ge._l10nResizer[h])}}k(this,Ne,p_).call(this,0),C(this,Pr,!0),g(this,_n).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){g(this,Pr)&&k(this,Ne,d_).call(this,g(this,If),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){k(this,Ne,Oh).call(this),this.div.focus()}select(){var e,t,n;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,a;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((a=this._editToolbar)==null||a.show())});return}(t=this._editToolbar)==null||t.show(),(n=g(this,bt))==null||n.toggleAltTextBadge(!1)}unselect(){var e,t,n,s,a;(e=g(this,_n))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(a=g(this,bt))==null||a.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return g(this,Df)}set isEditing(e){C(this,Df,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){C(this,dl,!0);const n=e/t,{style:s}=this.div;s.aspectRatio=n,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){g(this,Xi)||C(this,Xi,new Map);const{action:n}=e;let s=g(this,Xi).get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),g(this,Xi).delete(n),g(this,Xi).size===0&&C(this,Xi,null)},Ge._telemetryTimeout),g(this,Xi).set(n,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),C(this,Pu,!1)}disable(){this.div&&(this.div.tabIndex=-1),C(this,Pu,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};ul=new WeakMap,ms=new WeakMap,bt=new WeakMap,Pu=new WeakMap,Ya=new WeakMap,kf=new WeakMap,dl=new WeakMap,_n=new WeakMap,hl=new WeakMap,Dr=new WeakMap,Ka=new WeakMap,If=new WeakMap,fl=new WeakMap,wi=new WeakMap,Df=new WeakMap,pl=new WeakMap,Pr=new WeakMap,Ys=new WeakMap,Lu=new WeakMap,Ou=new WeakMap,Xi=new WeakMap,gl=new WeakMap,Pf=new WeakMap,w0=new WeakMap,Ne=new WeakSet,l_=function([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Lf=new WeakSet,c_=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Tm=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},DR=function(){if(g(this,_n))return;C(this,_n,document.createElement("div")),g(this,_n).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");g(this,_n).append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",k(this,Ne,PR).bind(this,n),{signal:t}),s.addEventListener("contextmenu",Ns,{signal:t}),s.tabIndex=-1}this.div.prepend(g(this,_n))},PR=function(e,t){var p;t.preventDefault();const{isMac:n}=Vn.platform;if(t.button!==0||t.ctrlKey&&n)return;(p=g(this,bt))==null||p.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,C(this,hl,[t.screenX,t.screenY]);const a=new AbortController,l=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",k(this,Ne,d_).bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Di,{passive:!1,signal:l}),window.addEventListener("contextmenu",Ns,{signal:l}),C(this,Dr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const c=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const h=()=>{var v;a.abort(),this.parent.togglePointerEvents(!0),(v=g(this,bt))==null||v.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=d,k(this,Ne,Cm).call(this)};window.addEventListener("pointerup",h,{signal:l}),window.addEventListener("blur",h,{signal:l})},u_=function(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t;const[a,l]=this.parentDimensions;this.setDims(a*n,l*s),this.fixAndSetPosition(),this._onResized()},Cm=function(){if(!g(this,Dr))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=g(this,Dr);C(this,Dr,null);const a=this.x,l=this.y,c=this.width,d=this.height;a===e&&l===t&&c===n&&d===s||this.addCommands({cmd:k(this,Ne,u_).bind(this,a,l,c,d),undo:k(this,Ne,u_).bind(this,e,t,n,s),mustExec:!0})},d_=function(e,t){const[n,s]=this.parentDimensions,a=this.x,l=this.y,c=this.width,d=this.height,h=Ge.MIN_SIZE/n,p=Ge.MIN_SIZE/s,v=k(this,Ne,Tm).call(this,this.rotation),_=(G,W)=>[v[0]*G+v[2]*W,v[1]*G+v[3]*W],x=k(this,Ne,Tm).call(this,360-this.rotation),A=(G,W)=>[x[0]*G+x[2]*W,x[1]*G+x[3]*W];let E,R,N=!1,D=!1;switch(e){case"topLeft":N=!0,E=(G,W)=>[0,0],R=(G,W)=>[G,W];break;case"topMiddle":E=(G,W)=>[G/2,0],R=(G,W)=>[G/2,W];break;case"topRight":N=!0,E=(G,W)=>[G,0],R=(G,W)=>[0,W];break;case"middleRight":D=!0,E=(G,W)=>[G,W/2],R=(G,W)=>[0,W/2];break;case"bottomRight":N=!0,E=(G,W)=>[G,W],R=(G,W)=>[0,0];break;case"bottomMiddle":E=(G,W)=>[G/2,W],R=(G,W)=>[G/2,0];break;case"bottomLeft":N=!0,E=(G,W)=>[0,W],R=(G,W)=>[G,0];break;case"middleLeft":D=!0,E=(G,W)=>[0,W/2],R=(G,W)=>[G,W/2];break}const P=E(c,d),L=R(c,d);let B=_(...L);const H=Ge._round(a+B[0]),O=Ge._round(l+B[1]);let X=1,Y=1,se,re;if(t.fromKeyboard)({deltaX:se,deltaY:re}=t);else{const{screenX:G,screenY:W}=t,[he,te]=g(this,hl);[se,re]=this.screenToPageTranslation(G-he,W-te),g(this,hl)[0]=G,g(this,hl)[1]=W}if([se,re]=A(se/n,re/s),N){const G=Math.hypot(c,d);X=Y=Math.max(Math.min(Math.hypot(L[0]-P[0]-se,L[1]-P[1]-re)/G,1/c,1/d),h/c,p/d)}else D?X=Math.max(h,Math.min(1,Math.abs(L[0]-P[0]-se)))/c:Y=Math.max(p,Math.min(1,Math.abs(L[1]-P[1]-re)))/d;const ne=Ge._round(c*X),be=Ge._round(d*Y);B=_(...R(ne,be));const ye=H-B[0],ze=O-B[1];g(this,wi)||C(this,wi,[this.x,this.y,this.width,this.height]),this.width=ne,this.height=be,this.x=ye,this.y=ze,this.setDims(n*ne,s*be),this.fixAndSetPosition(),this._onResizing()},LR=function(){var e;C(this,Dr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=g(this,bt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},OR=function(e,t,n){let a=.7*(n/t)+1-.7;if(a===1)return;const l=k(this,Ne,Tm).call(this,this.rotation),c=(H,O)=>[l[0]*H+l[2]*O,l[1]*H+l[3]*O],[d,h]=this.parentDimensions,p=this.x,v=this.y,_=this.width,x=this.height,A=Ge.MIN_SIZE/d,E=Ge.MIN_SIZE/h;a=Math.max(Math.min(a,1/_,1/x),A/_,E/x);const R=Ge._round(_*a),N=Ge._round(x*a);if(R===_&&N===x)return;g(this,wi)||C(this,wi,[p,v,_,x]);const D=c(_/2,x/2),P=Ge._round(p+D[0]),L=Ge._round(v+D[1]),B=c(R/2,N/2);this.x=P-B[0],this.y=L-B[1],this.width=R,this.height=N,this.setDims(d*R,h*N),this.fixAndSetPosition(),this._onResizing()},UR=function(){var e;(e=g(this,bt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),k(this,Ne,Cm).call(this)},h_=function(e){const{isMac:t}=Vn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},FR=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,a=this._uiManager.combinedSignal(s),l={capture:!0,passive:!1,signal:a},c=h=>{s.abort(),C(this,Ya,null),C(this,fl,!1),this._uiManager.endDragSession()||k(this,Ne,h_).call(this,h),n&&this._onStopDragging()};t&&(C(this,Lu,e.clientX),C(this,Ou,e.clientY),C(this,Ya,e.pointerId),C(this,kf,e.pointerType),window.addEventListener("pointermove",h=>{n||(n=!0,this._onStartDragging());const{clientX:p,clientY:v,pointerId:_}=h;if(_!==g(this,Ya)){Di(h);return}const[x,A]=this.screenToPageTranslation(p-g(this,Lu),v-g(this,Ou));C(this,Lu,p),C(this,Ou,v),this._uiManager.dragSelectedEditors(x,A)},l),window.addEventListener("touchmove",Di,l),window.addEventListener("pointerdown",h=>{h.pointerType===g(this,kf)&&(g(this,gl)||h.isPrimary)&&c(h),Di(h)},l));const d=h=>{if(!g(this,Ya)||g(this,Ya)===h.pointerId){c(h);return}Di(h)};window.addEventListener("pointerup",d,{signal:a}),window.addEventListener("blur",d,{signal:a})},f_=function(){if(g(this,Ka)||!this.div)return;C(this,Ka,new AbortController);const e=this._uiManager.combinedSignal(g(this,Ka));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},HR=function(e){Ge._resizerKeyboardManager.exec(this,e)},BR=function(e){var t;g(this,Pr)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==g(this,_n)&&k(this,Ne,Oh).call(this)},GR=function(e){C(this,If,g(this,Pr)?e:"")},p_=function(e){if(g(this,ms))for(const t of g(this,ms))t.tabIndex=e},Oh=function(){C(this,Pr,!1),k(this,Ne,p_).call(this,-1),k(this,Ne,Cm).call(this)},M(Ge,Lf),Re(Ge,"_l10n",null),Re(Ge,"_l10nResizer",null),Re(Ge,"_borderLineWidth",-1),Re(Ge,"_colorManager",new e_),Re(Ge,"_zIndex",1),Re(Ge,"_telemetryTimeout",1e3);let Rt=Ge;class HD extends Rt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const OT=3285377520,Yi=4294901760,Us=65535;class zR{constructor(e){this.h1=e?e&4294967295:OT,this.h2=e?e&4294967295:OT}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let E=0,R=e.length;E<R;E++){const N=e.charCodeAt(E);N<=255?t[n++]=N:(t[n++]=N>>>8,t[n++]=N&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,a=n-s*4,l=new Uint32Array(t.buffer,0,s);let c=0,d=0,h=this.h1,p=this.h2;const v=3432918353,_=461845907,x=v&Us,A=_&Us;for(let E=0;E<s;E++)E&1?(c=l[E],c=c*v&Yi|c*x&Us,c=c<<15|c>>>17,c=c*_&Yi|c*A&Us,h^=c,h=h<<13|h>>>19,h=h*5+3864292196):(d=l[E],d=d*v&Yi|d*x&Us,d=d<<15|d>>>17,d=d*_&Yi|d*A&Us,p^=d,p=p<<13|p>>>19,p=p*5+3864292196);switch(c=0,a){case 3:c^=t[s*4+2]<<16;case 2:c^=t[s*4+1]<<8;case 1:c^=t[s*4],c=c*v&Yi|c*x&Us,c=c<<15|c>>>17,c=c*_&Yi|c*A&Us,s&1?h^=c:p^=c}this.h1=h,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Yi|e*36045&Us,t=t*4283543511&Yi|((t<<16|e>>>16)*2950163797&Yi)>>>16,e^=t>>>1,e=e*444984403&Yi|e*60499&Us,t=t*3301882366&Yi|((t<<16|e>>>16)*3120437893&Yi)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const g_=Object.freeze({map:null,hash:"",transfer:void 0});var ml,yl,on,x0,qR;class Vw{constructor(){M(this,x0);M(this,ml,!1);M(this,yl,null);M(this,on,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=g(this,on).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return g(this,on).get(e)}remove(e){if(g(this,on).delete(e),g(this,on).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of g(this,on).values())if(t instanceof Rt)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=g(this,on).get(e);let s=!1;if(n!==void 0)for(const[a,l]of Object.entries(t))n[a]!==l&&(s=!0,n[a]=l);else s=!0,g(this,on).set(e,t);s&&k(this,x0,qR).call(this),t instanceof Rt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return g(this,on).has(e)}getAll(){return g(this,on).size>0?Fw(g(this,on)):null}setAll(e){for(const[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return g(this,on).size}resetModified(){g(this,ml)&&(C(this,ml,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new VR(this)}get serializable(){if(g(this,on).size===0)return g_;const e=new Map,t=new zR,n=[],s=Object.create(null);let a=!1;for(const[l,c]of g(this,on)){const d=c instanceof Rt?c.serialize(!1,s):c;d&&(e.set(l,d),t.update(`${l}:${JSON.stringify(d)}`),a||(a=!!d.bitmap))}if(a)for(const l of e.values())l.bitmap&&n.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:g_}get editorStats(){let e=null;const t=new Map;for(const n of g(this,on).values()){if(!(n instanceof Rt))continue;const s=n.telemetryFinalData;if(!s)continue;const{type:a}=s;t.has(a)||t.set(a,Object.getPrototypeOf(n).constructor),e||(e=Object.create(null));const l=e[a]||(e[a]=new Map);for(const[c,d]of Object.entries(s)){if(c==="type")continue;let h=l.get(c);h||(h=new Map,l.set(c,h));const p=h.get(d)??0;h.set(d,p+1)}}for(const[n,s]of t)e[n]=s.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){C(this,yl,null)}get modifiedIds(){if(g(this,yl))return g(this,yl);const e=[];for(const t of g(this,on).values())!(t instanceof Rt)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return C(this,yl,{ids:new Set(e),hash:e.join(",")})}}ml=new WeakMap,yl=new WeakMap,on=new WeakMap,x0=new WeakSet,qR=function(){g(this,ml)||(C(this,ml,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Of;class VR extends Vw{constructor(t){super();M(this,Of);const{map:n,hash:s,transfer:a}=t.serializable,l=structuredClone(n,a?{transfer:a}:null);C(this,Of,{map:l,hash:s,transfer:a})}get print(){pt("Should not call PrintAnnotationStorage.print")}get serializable(){return g(this,Of)}get modifiedIds(){return Ve(this,"modifiedIds",{ids:new Set,hash:""})}}Of=new WeakMap;var Uu;class BD{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){M(this,Uu,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),g(this,Uu).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||g(this,Uu).has(e.loadedName))){if(Vt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:s,style:a}=e,l=new FontFace(n,s,a);this.addNativeFontFace(l);try{await l.load(),g(this,Uu).add(n),t==null||t(e)}catch{Be(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}pt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Be(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Ve(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Pn||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Ve(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Vt(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const a=n.shift();setTimeout(a.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ve(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(L,B){return L.charCodeAt(B)<<24|L.charCodeAt(B+1)<<16|L.charCodeAt(B+2)<<8|L.charCodeAt(B+3)&255}function s(L,B,H,O){const X=L.substring(0,B),Y=L.substring(B+H);return X+O+Y}let a,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const d=c.getContext("2d");let h=0;function p(L,B){if(++h>30){Be("Load test font never loaded."),B();return}if(d.font="30px "+L,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){B();return}setTimeout(p.bind(null,L,B))}const v=`lt${Date.now()}${this.loadTestFontId++}`;let _=this._loadTestFont;_=s(_,976,v.length,v);const A=16,E=1482184792;let R=n(_,A);for(a=0,l=v.length-3;a<l;a+=4)R=R-E+n(v,a)|0;a<v.length&&(R=R-E+n(v+"XXX",a)|0),_=s(_,A,4,ED(R));const N=`url(data:font/opentype;base64,${btoa(_)});`,D=`@font-face {font-family:"${v}";src:${N}}`;this.insertRule(D);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const L of[e.loadedName,v]){const B=this._document.createElement("span");B.textContent="Hi",B.style.fontFamily=L,P.append(B)}this._document.body.append(P),p(v,()=>{P.remove(),t.complete()})}}Uu=new WeakMap;class GD{constructor(e,{disableFontFace:t=!1,fontExtraProperties:n=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const a in e)this[a]=e[a];this.disableFontFace=t===!0,this.fontExtraProperties=n===!0,this._inspectFont=s}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${kD(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let s;try{s=e.get(n)}catch(l){Be(`getPathGenerator - ignoring character: "${l}".`)}const a=new Path2D(s||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=a}}const sm={DATA:1,ERROR:2},zt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function UT(){}function ni(i){if(i instanceof go||i instanceof Kb||i instanceof tf||i instanceof DT||i instanceof Wm||i instanceof Tb)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||pt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new go(i.message);case"InvalidPDFException":return new Kb(i.message);case"MissingPDFException":return new tf(i.message);case"PasswordException":return new DT(i.message,i.code);case"UnexpectedResponseException":return new Wm(i.message,i.status);case"UnknownErrorException":return new Tb(i.message,i.details)}return new Tb(i.message,i.toString())}var Fu,ss,$R,jR,YR,Rm;class Uh{constructor(e,t,n){M(this,ss);M(this,Fu,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",k(this,ss,$R).bind(this),{signal:g(this,Fu).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[s]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(l){a.reject(l)}return a.promise}sendWithStream(e,t,n,s){const a=this.streamId++,l=this.sourceName,c=this.targetName,d=this.comObj;return new ReadableStream({start:h=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:h,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:l,targetName:c,action:e,streamId:a,data:t,desiredSize:h.desiredSize},s),p.promise},pull:h=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,d.postMessage({sourceName:l,targetName:c,stream:zt.PULL,streamId:a,desiredSize:h.desiredSize}),p.promise},cancel:h=>{Vt(h instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,d.postMessage({sourceName:l,targetName:c,stream:zt.CANCEL,streamId:a,reason:ni(h)}),p.promise}},n)}destroy(){var e;(e=g(this,Fu))==null||e.abort(),C(this,Fu,null)}}Fu=new WeakMap,ss=new WeakSet,$R=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){k(this,ss,YR).call(this,e);return}if(e.callback){const n=e.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===sm.DATA)s.resolve(e.data);else if(e.callback===sm.ERROR)s.reject(ni(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,s=e.sourceName,a=this.comObj;Promise.try(t,e.data).then(function(l){a.postMessage({sourceName:n,targetName:s,callback:sm.DATA,callbackId:e.callbackId,data:l})},function(l){a.postMessage({sourceName:n,targetName:s,callback:sm.ERROR,callbackId:e.callbackId,reason:ni(l)})});return}if(e.streamId){k(this,ss,jR).call(this,e);return}t(e.data)},jR=function(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,a=this.comObj,l=this,c=this.actionHandler[e.action],d={enqueue(h,p=1,v){if(this.isCancelled)return;const _=this.desiredSize;this.desiredSize-=p,_>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:s,stream:zt.ENQUEUE,streamId:t,chunk:h},v)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:s,stream:zt.CLOSE,streamId:t}),delete l.streamSinks[t])},error(h){Vt(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:s,stream:zt.ERROR,streamId:t,reason:ni(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[t]=d,Promise.try(c,e.data,d).then(function(){a.postMessage({sourceName:n,targetName:s,stream:zt.START_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:s,stream:zt.START_COMPLETE,streamId:t,reason:ni(h)})})},YR=function(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,a=this.comObj,l=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case zt.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(ni(e.reason));break;case zt.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(ni(e.reason));break;case zt.PULL:if(!c){a.postMessage({sourceName:n,targetName:s,stream:zt.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||UT).then(function(){a.postMessage({sourceName:n,targetName:s,stream:zt.PULL_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:s,stream:zt.PULL_COMPLETE,streamId:t,reason:ni(h)})});break;case zt.ENQUEUE:if(Vt(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case zt.CLOSE:if(Vt(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),k(this,ss,Rm).call(this,l,t);break;case zt.ERROR:Vt(l,"error should have stream controller"),l.controller.error(ni(e.reason)),k(this,ss,Rm).call(this,l,t);break;case zt.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(ni(e.reason)),k(this,ss,Rm).call(this,l,t);break;case zt.CANCEL:if(!c)break;const d=ni(e.reason);Promise.try(c.onCancel||UT,d).then(function(){a.postMessage({sourceName:n,targetName:s,stream:zt.CANCEL_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:s,stream:zt.CANCEL_COMPLETE,streamId:t,reason:ni(h)})}),c.sinkCapability.reject(d),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Rm=async function(e,t){var n,s,a;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(s=e.pullCall)==null?void 0:s.promise,(a=e.cancelCall)==null?void 0:a.promise]),delete this.streamControllers[t]};var Uf;class KR{constructor({enableHWA:e=!1}){M(this,Uf,!1);C(this,Uf,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!g(this,Uf)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){pt("Abstract method `_createCanvas` called.")}}Uf=new WeakMap;class zD extends KR{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class JR{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){pt("Abstract method `_fetch` called.")}}class XR extends JR{async _fetch(e){const t=await B0(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):H0(t)}}class WR{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,a){return"none"}destroy(e=!1){}}var vl,Hu,Lr,Or,Mn,bl,_l,de,Cn,Fh,iu,Nm,su,QR,m_,ru,Hh,Bh,y_,Gh;class qD extends WR{constructor({docId:t,ownerDocument:n=globalThis.document}){super();M(this,de);M(this,vl);M(this,Hu);M(this,Lr);M(this,Or);M(this,Mn);M(this,bl);M(this,_l,0);C(this,Or,t),C(this,Mn,n)}addFilter(t){if(!t)return"none";let n=g(this,de,Cn).get(t);if(n)return n;const[s,a,l]=k(this,de,Nm).call(this,t),c=t.length===1?s:`${s}${a}${l}`;if(n=g(this,de,Cn).get(c),n)return g(this,de,Cn).set(t,n),n;const d=`g_${g(this,Or)}_transfer_map_${Un(this,_l)._++}`,h=k(this,de,su).call(this,d);g(this,de,Cn).set(t,h),g(this,de,Cn).set(c,h);const p=k(this,de,ru).call(this,d);return k(this,de,Bh).call(this,s,a,l,p),h}addHCMFilter(t,n){var A;const s=`${t}-${n}`,a="base";let l=g(this,de,Fh).get(a);if((l==null?void 0:l.key)===s||(l?((A=l.filter)==null||A.remove(),l.key=s,l.url="none",l.filter=null):(l={key:s,url:"none",filter:null},g(this,de,Fh).set(a,l)),!t||!n))return l.url;const c=k(this,de,Gh).call(this,t);t=xe.makeHexColor(...c);const d=k(this,de,Gh).call(this,n);if(n=xe.makeHexColor(...d),g(this,de,iu).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return l.url;const h=new Array(256);for(let E=0;E<=255;E++){const R=E/255;h[E]=R<=.03928?R/12.92:((R+.055)/1.055)**2.4}const p=h.join(","),v=`g_${g(this,Or)}_hcm_filter`,_=l.filter=k(this,de,ru).call(this,v);k(this,de,Bh).call(this,p,p,p,_),k(this,de,m_).call(this,_);const x=(E,R)=>{const N=c[E]/255,D=d[E]/255,P=new Array(R+1);for(let L=0;L<=R;L++)P[L]=N+L/R*(D-N);return P.join(",")};return k(this,de,Bh).call(this,x(0,5),x(1,5),x(2,5),_),l.url=k(this,de,su).call(this,v),l.url}addAlphaFilter(t){let n=g(this,de,Cn).get(t);if(n)return n;const[s]=k(this,de,Nm).call(this,[t]),a=`alpha_${s}`;if(n=g(this,de,Cn).get(a),n)return g(this,de,Cn).set(t,n),n;const l=`g_${g(this,Or)}_alpha_map_${Un(this,_l)._++}`,c=k(this,de,su).call(this,l);g(this,de,Cn).set(t,c),g(this,de,Cn).set(a,c);const d=k(this,de,ru).call(this,l);return k(this,de,y_).call(this,s,d),c}addLuminosityFilter(t){let n=g(this,de,Cn).get(t||"luminosity");if(n)return n;let s,a;if(t?([s]=k(this,de,Nm).call(this,[t]),a=`luminosity_${s}`):a="luminosity",n=g(this,de,Cn).get(a),n)return g(this,de,Cn).set(t,n),n;const l=`g_${g(this,Or)}_luminosity_map_${Un(this,_l)._++}`,c=k(this,de,su).call(this,l);g(this,de,Cn).set(t,c),g(this,de,Cn).set(a,c);const d=k(this,de,ru).call(this,l);return k(this,de,QR).call(this,d),t&&k(this,de,y_).call(this,s,d),c}addHighlightHCMFilter(t,n,s,a,l){var D;const c=`${n}-${s}-${a}-${l}`;let d=g(this,de,Fh).get(t);if((d==null?void 0:d.key)===c||(d?((D=d.filter)==null||D.remove(),d.key=c,d.url="none",d.filter=null):(d={key:c,url:"none",filter:null},g(this,de,Fh).set(t,d)),!n||!s))return d.url;const[h,p]=[n,s].map(k(this,de,Gh).bind(this));let v=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),_=Math.round(.2126*p[0]+.7152*p[1]+.0722*p[2]),[x,A]=[a,l].map(k(this,de,Gh).bind(this));_<v&&([v,_,x,A]=[_,v,A,x]),g(this,de,iu).style.color="";const E=(P,L,B)=>{const H=new Array(256),O=(_-v)/B,X=P/255,Y=(L-P)/(255*B);let se=0;for(let re=0;re<=B;re++){const ne=Math.round(v+re*O),be=X+re*Y;for(let ye=se;ye<=ne;ye++)H[ye]=be;se=ne+1}for(let re=se;re<256;re++)H[re]=H[se-1];return H.join(",")},R=`g_${g(this,Or)}_hcm_${t}_filter`,N=d.filter=k(this,de,ru).call(this,R);return k(this,de,m_).call(this,N),k(this,de,Bh).call(this,E(x[0],A[0],5),E(x[1],A[1],5),E(x[2],A[2],5),N),d.url=k(this,de,su).call(this,R),d.url}destroy(t=!1){var n,s,a,l;t&&((n=g(this,bl))!=null&&n.size)||((s=g(this,Lr))==null||s.parentNode.parentNode.remove(),C(this,Lr,null),(a=g(this,Hu))==null||a.clear(),C(this,Hu,null),(l=g(this,bl))==null||l.clear(),C(this,bl,null),C(this,_l,0))}}vl=new WeakMap,Hu=new WeakMap,Lr=new WeakMap,Or=new WeakMap,Mn=new WeakMap,bl=new WeakMap,_l=new WeakMap,de=new WeakSet,Cn=function(){return g(this,Hu)||C(this,Hu,new Map)},Fh=function(){return g(this,bl)||C(this,bl,new Map)},iu=function(){if(!g(this,Lr)){const t=g(this,Mn).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const s=g(this,Mn).createElementNS(xr,"svg");s.setAttribute("width",0),s.setAttribute("height",0),C(this,Lr,g(this,Mn).createElementNS(xr,"defs")),t.append(s),s.append(g(this,Lr)),g(this,Mn).body.append(t)}return g(this,Lr)},Nm=function(t){if(t.length===1){const h=t[0],p=new Array(256);for(let _=0;_<256;_++)p[_]=h[_]/255;const v=p.join(",");return[v,v,v]}const[n,s,a]=t,l=new Array(256),c=new Array(256),d=new Array(256);for(let h=0;h<256;h++)l[h]=n[h]/255,c[h]=s[h]/255,d[h]=a[h]/255;return[l.join(","),c.join(","),d.join(",")]},su=function(t){if(g(this,vl)===void 0){C(this,vl,"");const n=g(this,Mn).URL;n!==g(this,Mn).baseURI&&(G0(n)?Be('#createUrl: ignore "data:"-URL for performance reasons.'):C(this,vl,n.split("#",1)[0]))}return`url(${g(this,vl)}#${t})`},QR=function(t){const n=g(this,Mn).createElementNS(xr,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},m_=function(t){const n=g(this,Mn).createElementNS(xr,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},ru=function(t){const n=g(this,Mn).createElementNS(xr,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),g(this,de,iu).append(n),n},Hh=function(t,n,s){const a=g(this,Mn).createElementNS(xr,n);a.setAttribute("type","discrete"),a.setAttribute("tableValues",s),t.append(a)},Bh=function(t,n,s,a){const l=g(this,Mn).createElementNS(xr,"feComponentTransfer");a.append(l),k(this,de,Hh).call(this,l,"feFuncR",t),k(this,de,Hh).call(this,l,"feFuncG",n),k(this,de,Hh).call(this,l,"feFuncB",s)},y_=function(t,n){const s=g(this,Mn).createElementNS(xr,"feComponentTransfer");n.append(s),k(this,de,Hh).call(this,s,"feFuncA",t)},Gh=function(t){return g(this,de,iu).style.color=t,qw(getComputedStyle(g(this,de,iu)).getPropertyValue("color"))};class ZR{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){pt("Abstract method `_fetch` called.")}}class eN extends ZR{async _fetch(e){const t=await B0(e,"arraybuffer");return new Uint8Array(t)}}Pn&&Be("Please use the `legacy` build in Node.js environments.");async function tN(i){const t=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(t)}class VD extends WR{}class $D extends KR{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class jD extends JR{async _fetch(e){return tN(e)}}class YD extends ZR{async _fetch(e){return tN(e)}}const Dn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function v_(i,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),i.clip(s)}class $w{getPattern(){pt("Abstract method `getPattern` called.")}}class KD extends $w{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,s){let a;if(s===Dn.STROKE||s===Dn.FILL){const l=t.current.getClippedPathBoundingBox(s,St(e))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,d=Math.ceil(l[3]-l[1])||1,h=t.cachedCanvases.getCanvas("pattern",c,d),p=h.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),n=xe.transform(n,[1,0,0,1,l[0],l[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),v_(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=e.createPattern(h.canvas,"no-repeat");const v=new DOMMatrix(n);a.setTransform(v)}else v_(e,this._bbox),a=this._createGradient(e);return a}}function Nb(i,e,t,n,s,a,l,c){const d=e.coords,h=e.colors,p=i.data,v=i.width*4;let _;d[t+1]>d[n+1]&&(_=t,t=n,n=_,_=a,a=l,l=_),d[n+1]>d[s+1]&&(_=n,n=s,s=_,_=l,l=c,c=_),d[t+1]>d[n+1]&&(_=t,t=n,n=_,_=a,a=l,l=_);const x=(d[t]+e.offsetX)*e.scaleX,A=(d[t+1]+e.offsetY)*e.scaleY,E=(d[n]+e.offsetX)*e.scaleX,R=(d[n+1]+e.offsetY)*e.scaleY,N=(d[s]+e.offsetX)*e.scaleX,D=(d[s+1]+e.offsetY)*e.scaleY;if(A>=D)return;const P=h[a],L=h[a+1],B=h[a+2],H=h[l],O=h[l+1],X=h[l+2],Y=h[c],se=h[c+1],re=h[c+2],ne=Math.round(A),be=Math.round(D);let ye,ze,G,W,he,te,le,U;for(let K=ne;K<=be;K++){if(K<R){const Se=K<A?0:(A-K)/(A-R);ye=x-(x-E)*Se,ze=P-(P-H)*Se,G=L-(L-O)*Se,W=B-(B-X)*Se}else{let Se;K>D?Se=1:R===D?Se=0:Se=(R-K)/(R-D),ye=E-(E-N)*Se,ze=H-(H-Y)*Se,G=O-(O-se)*Se,W=X-(X-re)*Se}let ie;K<A?ie=0:K>D?ie=1:ie=(A-K)/(A-D),he=x-(x-N)*ie,te=P-(P-Y)*ie,le=L-(L-se)*ie,U=B-(B-re)*ie;const oe=Math.round(Math.min(ye,he)),Ie=Math.round(Math.max(ye,he));let Ee=v*K+oe*4;for(let Se=oe;Se<=Ie;Se++)ie=(ye-Se)/(ye-he),ie<0?ie=0:ie>1&&(ie=1),p[Ee++]=ze-(ze-te)*ie|0,p[Ee++]=G-(G-le)*ie|0,p[Ee++]=W-(W-U)*ie|0,p[Ee++]=255}}function JD(i,e,t){const n=e.coords,s=e.colors;let a,l;switch(e.type){case"lattice":const c=e.verticesPerRow,d=Math.floor(n.length/c)-1,h=c-1;for(a=0;a<d;a++){let p=a*c;for(let v=0;v<h;v++,p++)Nb(i,t,n[p],n[p+1],n[p+c],s[p],s[p+1],s[p+c]),Nb(i,t,n[p+c+1],n[p+1],n[p+c],s[p+c+1],s[p+1],s[p+c])}break;case"triangles":for(a=0,l=n.length;a<l;a+=3)Nb(i,t,n[a],n[a+1],n[a+2],s[a],s[a+1],s[a+2]);break;default:throw new Error("illegal figure")}}class XD extends $w{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-c,p=Math.ceil(this._bounds[3])-d,v=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),_=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),x=h/v,A=p/_,E={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-d,scaleX:1/x,scaleY:1/A},R=v+4,N=_+4,D=n.getCanvas("mesh",R,N),P=D.context,L=P.createImageData(v,_);if(t){const H=L.data;for(let O=0,X=H.length;O<X;O+=4)H[O]=t[0],H[O+1]=t[1],H[O+2]=t[2],H[O+3]=255}for(const H of this._figures)JD(L,H,E);return P.putImageData(L,2,2),{canvas:D.canvas,offsetX:c-2*x,offsetY:d-2*A,scaleX:x,scaleY:A}}getPattern(e,t,n,s){v_(e,this._bbox);let a;if(s===Dn.SHADING)a=xe.singularValueDecompose2dScale(St(e));else if(a=xe.singularValueDecompose2dScale(t.baseTransform),this.matrix){const c=xe.singularValueDecompose2dScale(this.matrix);a=[a[0]*c[0],a[1]*c[1]]}const l=this._createMeshCanvas(a,s===Dn.SHADING?null:this._background,t.cachedCanvases);return s!==Dn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class WD extends $w{getPattern(){return"hotpink"}}function QD(i){switch(i[0]){case"RadialAxial":return new KD(i);case"Mesh":return new XD(i);case"Dummy":return new WD}throw new Error(`Unknown IR type: ${i[0]}`)}const FT={COLORED:1,UNCOLORED:2},S0=class S0{constructor(e,t,n,s,a){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=n,this.canvasGraphicsFactory=s,this.baseTransform=a}createPatternCanvas(e){const{bbox:t,operatorList:n,paintType:s,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:d,ystep:h}=this;d=Math.abs(d),h=Math.abs(h),F0("TilingType: "+a);const p=t[0],v=t[1],_=t[2],x=t[3],A=_-p,E=x-v,R=xe.singularValueDecompose2dScale(this.matrix),N=xe.singularValueDecompose2dScale(this.baseTransform),D=R[0]*N[0],P=R[1]*N[1];let L=A,B=E,H=!1,O=!1;const X=Math.ceil(d*D),Y=Math.ceil(h*P),se=Math.ceil(A*D),re=Math.ceil(E*P);X>=se?L=d:H=!0,Y>=re?B=h:O=!0;const ne=this.getSizeAndScale(L,this.ctx.canvas.width,D),be=this.getSizeAndScale(B,this.ctx.canvas.height,P),ye=e.cachedCanvases.getCanvas("pattern",ne.size,be.size),ze=ye.context,G=c.createCanvasGraphics(ze);if(G.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(G,s,l),ze.translate(-ne.scale*p,-be.scale*v),G.transform(ne.scale,0,0,be.scale,0,0),ze.save(),this.clipBbox(G,p,v,_,x),G.baseTransform=St(G.ctx),G.executeOperatorList(n),G.endDrawing(),ze.restore(),H||O){const W=ye.canvas;H&&(L=d),O&&(B=h);const he=this.getSizeAndScale(L,this.ctx.canvas.width,D),te=this.getSizeAndScale(B,this.ctx.canvas.height,P),le=he.size,U=te.size,K=e.cachedCanvases.getCanvas("pattern-workaround",le,U),ie=K.context,oe=H?Math.floor(A/d):0,Ie=O?Math.floor(E/h):0;for(let Ee=0;Ee<=oe;Ee++)for(let Se=0;Se<=Ie;Se++)ie.drawImage(W,le*Ee,U*Se,le,U,0,0,le,U);return{canvas:K.canvas,scaleX:he.scale,scaleY:te.scale,offsetX:p,offsetY:v}}return{canvas:ye.canvas,scaleX:ne.scale,scaleY:be.scale,offsetX:p,offsetY:v}}getSizeAndScale(e,t,n){const s=Math.max(S0.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*n);return a>=s?a=s:n=a/e,{scale:n,size:a}}clipBbox(e,t,n,s,a){const l=s-t,c=a-n;e.ctx.rect(t,n,l,c),e.current.updateRectMinMax(St(e.ctx),[t,n,s,a]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,a=e.current;switch(t){case FT.COLORED:const l=this.ctx;s.fillStyle=l.fillStyle,s.strokeStyle=l.strokeStyle,a.fillColor=l.fillStyle,a.strokeColor=l.strokeStyle;break;case FT.UNCOLORED:const c=xe.makeHexColor(n[0],n[1],n[2]);s.fillStyle=c,s.strokeStyle=c,a.fillColor=c,a.strokeColor=c;break;default:throw new AD(`Unsupported paint type: ${t}`)}}getPattern(e,t,n,s){let a=n;s!==Dn.SHADING&&(a=xe.transform(a,t.baseTransform),this.matrix&&(a=xe.transform(a,this.matrix)));const l=this.createPatternCanvas(t);let c=new DOMMatrix(a);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const d=e.createPattern(l.canvas,"repeat");return d.setTransform(c),d}};Re(S0,"MAX_PATTERN_SIZE",3e3);let b_=S0;function ZD({src:i,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:a=4294967295,inverseDecode:l=!1}){const c=Vn.isLittleEndian?4278190080:255,[d,h]=l?[a,c]:[c,a],p=n>>3,v=n&7,_=i.length;t=new Uint32Array(t.buffer);let x=0;for(let A=0;A<s;A++){for(const R=e+p;e<R;e++){const N=e<_?i[e]:255;t[x++]=N&128?h:d,t[x++]=N&64?h:d,t[x++]=N&32?h:d,t[x++]=N&16?h:d,t[x++]=N&8?h:d,t[x++]=N&4?h:d,t[x++]=N&2?h:d,t[x++]=N&1?h:d}if(v===0)continue;const E=e<_?i[e++]:255;for(let R=0;R<v;R++)t[x++]=E&1<<7-R?h:d}return{srcPos:e,destPos:x}}const HT=16,BT=100,eP=15,GT=10,zT=1e3,oi=16;function tP(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(n,s){e.translate(n,s),this.__originalTranslate(n,s)},i.scale=function(n,s){e.scale(n,s),this.__originalScale(n,s)},i.transform=function(n,s,a,l,c,d){e.transform(n,s,a,l,c,d),this.__originalTransform(n,s,a,l,c,d)},i.setTransform=function(n,s,a,l,c,d){e.setTransform(n,s,a,l,c,d),this.__originalSetTransform(n,s,a,l,c,d)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(n){e.rotate(n),this.__originalRotate(n)},i.clip=function(n){e.clip(n),this.__originalClip(n)},i.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},i.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},i.bezierCurveTo=function(t,n,s,a,l,c){e.bezierCurveTo(t,n,s,a,l,c),this.__originalBezierCurveTo(t,n,s,a,l,c)},i.rect=function(t,n,s,a){e.rect(t,n,s,a),this.__originalRect(t,n,s,a)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class nP{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function rm(i,e,t,n,s,a,l,c,d,h){const[p,v,_,x,A,E]=St(i);if(v===0&&_===0){const D=l*p+A,P=Math.round(D),L=c*x+E,B=Math.round(L),H=(l+d)*p+A,O=Math.abs(Math.round(H)-P)||1,X=(c+h)*x+E,Y=Math.abs(Math.round(X)-B)||1;return i.setTransform(Math.sign(p),0,0,Math.sign(x),P,B),i.drawImage(e,t,n,s,a,0,0,O,Y),i.setTransform(p,v,_,x,A,E),[O,Y]}if(p===0&&x===0){const D=c*_+A,P=Math.round(D),L=l*v+E,B=Math.round(L),H=(c+h)*_+A,O=Math.abs(Math.round(H)-P)||1,X=(l+d)*v+E,Y=Math.abs(Math.round(X)-B)||1;return i.setTransform(0,Math.sign(v),Math.sign(_),0,P,B),i.drawImage(e,t,n,s,a,0,0,Y,O),i.setTransform(p,v,_,x,A,E),[Y,O]}i.drawImage(e,t,n,s,a,l,c,d,h);const R=Math.hypot(p,v),N=Math.hypot(_,x);return[R*d,N*h]}function iP(i){const{width:e,height:t}=i;if(e>zT||t>zT)return null;const n=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),a=e+1;let l=new Uint8Array(a*(t+1)),c,d,h;const p=e+7&-8;let v=new Uint8Array(p*t),_=0;for(const N of i.data){let D=128;for(;D>0;)v[_++]=N&D?0:255,D>>=1}let x=0;for(_=0,v[_]!==0&&(l[0]=1,++x),d=1;d<e;d++)v[_]!==v[_+1]&&(l[d]=v[_]?2:1,++x),_++;for(v[_]!==0&&(l[d]=2,++x),c=1;c<t;c++){_=c*p,h=c*a,v[_-p]!==v[_]&&(l[h]=v[_]?1:8,++x);let N=(v[_]?4:0)+(v[_-p]?8:0);for(d=1;d<e;d++)N=(N>>2)+(v[_+1]?4:0)+(v[_-p+1]?8:0),s[N]&&(l[h+d]=s[N],++x),_++;if(v[_-p]!==v[_]&&(l[h+d]=v[_]?2:4,++x),x>n)return null}for(_=p*(t-1),h=c*a,v[_]!==0&&(l[h]=8,++x),d=1;d<e;d++)v[_]!==v[_+1]&&(l[h+d]=v[_]?4:8,++x),_++;if(v[_]!==0&&(l[h+d]=4,++x),x>n)return null;const A=new Int32Array([0,a,-1,0,-a,0,0,0,1]),E=new Path2D;for(c=0;x&&c<=t;c++){let N=c*a;const D=N+e;for(;N<D&&!l[N];)N++;if(N===D)continue;E.moveTo(N%a,c);const P=N;let L=l[N];do{const B=A[L];do N+=B;while(!l[N]);const H=l[N];H!==5&&H!==10?(L=H,l[N]=0):(L=H&51*L>>4,l[N]&=L>>2|L<<2),E.lineTo(N%a,N/a|0),l[N]||--x}while(P!==N);--c}return v=null,l=null,function(N){N.save(),N.scale(1/e,-1/t),N.translate(0,-t),N.fill(E),N.beginPath(),N.restore()}}class qT{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=dR,this.textMatrixScale=1,this.fontMatrix=Yb,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Tn.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=xe.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){const n=xe.applyTransform(t,e),s=xe.applyTransform(t.slice(2),e),a=xe.applyTransform([t[0],t[3]],e),l=xe.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,n[0],s[0],a[0],l[0]),this.minY=Math.min(this.minY,n[1],s[1],a[1],l[1]),this.maxX=Math.max(this.maxX,n[0],s[0],a[0],l[0]),this.maxY=Math.max(this.maxY,n[1],s[1],a[1],l[1])}updateScalingPathMinMax(e,t){xe.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,s,a,l,c,d,h,p){const v=xe.bezierBoundingBox(t,n,s,a,l,c,d,h,p);p||this.updateRectMinMax(e,v)}getPathBoundingBox(e=Dn.FILL,t=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(e===Dn.STROKE){t||pt("Stroke bounding box must include transform.");const s=xe.singularValueDecompose2dScale(t),a=s[0]*this.lineWidth/2,l=s[1]*this.lineWidth/2;n[0]-=a,n[1]-=l,n[2]+=a,n[3]+=l}return n}updateClipFromPath(){const e=xe.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Dn.FILL,t=null){return xe.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function VT(i,e){if(e instanceof ImageData){i.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%oi,a=(t-s)/oi,l=s===0?a:a+1,c=i.createImageData(n,oi);let d=0,h;const p=e.data,v=c.data;let _,x,A,E;if(e.kind===bm.GRAYSCALE_1BPP){const R=p.byteLength,N=new Uint32Array(v.buffer,0,v.byteLength>>2),D=N.length,P=n+7>>3,L=4294967295,B=Vn.isLittleEndian?4278190080:255;for(_=0;_<l;_++){for(A=_<a?oi:s,h=0,x=0;x<A;x++){const H=R-d;let O=0;const X=H>P?n:H*8-7,Y=X&-8;let se=0,re=0;for(;O<Y;O+=8)re=p[d++],N[h++]=re&128?L:B,N[h++]=re&64?L:B,N[h++]=re&32?L:B,N[h++]=re&16?L:B,N[h++]=re&8?L:B,N[h++]=re&4?L:B,N[h++]=re&2?L:B,N[h++]=re&1?L:B;for(;O<X;O++)se===0&&(re=p[d++],se=128),N[h++]=re&se?L:B,se>>=1}for(;h<D;)N[h++]=0;i.putImageData(c,0,_*oi)}}else if(e.kind===bm.RGBA_32BPP){for(x=0,E=n*oi*4,_=0;_<a;_++)v.set(p.subarray(d,d+E)),d+=E,i.putImageData(c,0,x),x+=oi;_<l&&(E=n*s*4,v.set(p.subarray(d,d+E)),i.putImageData(c,0,x))}else if(e.kind===bm.RGB_24BPP)for(A=oi,E=n*A,_=0;_<l;_++){for(_>=a&&(A=s,E=n*A),h=0,x=E;x--;)v[h++]=p[d++],v[h++]=p[d++],v[h++]=p[d++],v[h++]=255;i.putImageData(c,0,_*oi)}else throw new Error(`bad image kind: ${e.kind}`)}function $T(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%oi,a=(t-s)/oi,l=s===0?a:a+1,c=i.createImageData(n,oi);let d=0;const h=e.data,p=c.data;for(let v=0;v<l;v++){const _=v<a?oi:s;({srcPos:d}=ZD({src:h,srcPos:d,dest:p,width:n,height:_,nonBlackColor:0})),i.putImageData(c,0,v*oi)}}function Rh(i,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)i[n]!==void 0&&(e[n]=i[n]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function am(i){if(i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0),!Pn){const{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}}function jT(i,e){if(e)return!0;const t=xe.singularValueDecompose2dScale(i);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*mo.PDF_TO_CSS_UNITS);return t[0]<=n&&t[1]<=n}const sP=["butt","round","square"],rP=["miter","round","bevel"],aP={},YT={};var Ms,__,w_,x_;const yx=class yx{constructor(e,t,n,s,a,{optionalContentConfig:l,markedContentStack:c=null},d,h){M(this,Ms);this.ctx=e,this.current=new qT(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new nP(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const a=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,a,l),this.ctx.fillStyle=c,n){const d=this.cachedCanvases.getCanvas("transparent",a,l);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...St(this.compositeCtx))}this.ctx.save(),am(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=St(this.ctx)}executeOperatorList(e,t,n,s){const a=e.argsArray,l=e.fnArray;let c=t||0;const d=a.length;if(d===c)return c;const h=d-c>GT&&typeof n=="function",p=h?Date.now()+eP:0;let v=0;const _=this.commonObjs,x=this.objs;let A;for(;;){if(s!==void 0&&c===s.nextBreakPoint)return s.breakIt(c,n),c;if(A=l[c],A!==ds.dependency)this[A].apply(this,a[c]);else for(const E of a[c]){const R=E.startsWith("g_")?_:x;if(!R.has(E))return R.get(E,n),c}if(c++,c===d)return c;if(h&&++v>GT){if(Date.now()>p)return n(),c;v=0}}}endDrawing(){k(this,Ms,__).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),k(this,Ms,w_).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,s=e.height??e.displayHeight;let a=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),c=n,d=s,h="prescale1",p,v;for(;a>2&&c>1||l>2&&d>1;){let _=c,x=d;a>2&&c>1&&(_=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),a/=c/_),l>2&&d>1&&(x=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,l/=d/x),p=this.cachedCanvases.getCanvas(h,_,x),v=p.context,v.clearRect(0,0,_,x),v.drawImage(e,0,0,c,d,0,0,_,x),e=p.canvas,c=_,d=x,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:d}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:s}=e,a=this.current.fillColor,l=this.current.patternFill,c=St(t);let d,h,p,v;if((e.bitmap||e.data)&&e.count>1){const X=e.bitmap||e.data.buffer;h=JSON.stringify(l?c:[c.slice(0,4),a]),d=this._cachedBitmapsMap.get(X),d||(d=new Map,this._cachedBitmapsMap.set(X,d));const Y=d.get(h);if(Y&&!l){const se=Math.round(Math.min(c[0],c[2])+c[4]),re=Math.round(Math.min(c[1],c[3])+c[5]);return{canvas:Y,offsetX:se,offsetY:re}}p=Y}p||(v=this.cachedCanvases.getCanvas("maskCanvas",n,s),$T(v.context,e));let _=xe.transform(c,[1/n,0,0,-1/s,0,0]);_=xe.transform(_,[1,0,0,1,0,-s]);const[x,A,E,R]=xe.getAxialAlignedBoundingBox([0,0,n,s],_),N=Math.round(E-x)||1,D=Math.round(R-A)||1,P=this.cachedCanvases.getCanvas("fillCanvas",N,D),L=P.context,B=x,H=A;L.translate(-B,-H),L.transform(..._),p||(p=this._scaleImage(v.canvas,Os(L)),p=p.img,d&&l&&d.set(h,p)),L.imageSmoothingEnabled=jT(St(L),e.interpolate),rm(L,p,0,0,p.width,p.height,0,0,n,s),L.globalCompositeOperation="source-in";const O=xe.transform(Os(L),[1,0,0,1,-B,-H]);return L.fillStyle=l?a.getPattern(t,this,O,Dn.FILL):a,L.fillRect(0,0,n,s),d&&!l&&(this.cachedCanvases.delete("fillCanvas"),d.set(h,P.canvas)),{canvas:P.canvas,offsetX:Math.round(B),offsetY:Math.round(H)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=sP[e]}setLineJoin(e){this.ctx.lineJoin=rP[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=s.context;const a=this.ctx;a.setTransform(...St(this.suspendedCtx)),Rh(this.suspendedCtx,a),tP(a,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Rh(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const a=s[0],l=s[1],c=s[2]-a,d=s[3]-l;c===0||d===0||(this.genericComposeSMask(t.context,n,c,d,t.subtype,t.backdrop,t.transferMap,a,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,a,l,c,d,h,p,v){let _=e.canvas,x=d-p,A=h-v;if(l){const R=xe.makeHexColor(...l);if(x<0||A<0||x+n>_.width||A+s>_.height){const N=this.cachedCanvases.getCanvas("maskExtension",n,s),D=N.context;D.drawImage(_,-x,-A),D.globalCompositeOperation="destination-atop",D.fillStyle=R,D.fillRect(0,0,n,s),D.globalCompositeOperation="source-over",_=N.canvas,x=A=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const N=new Path2D;N.rect(x,A,n,s),e.clip(N),e.globalCompositeOperation="destination-atop",e.fillStyle=R,e.fillRect(x,A,n,s),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),a==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):a==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const E=new Path2D;E.rect(d,h,n,s),t.clip(E),t.globalCompositeOperation="destination-in",t.drawImage(_,x,A,n,s,d,h,n,s),t.restore()}save(){this.inSMaskMode?(Rh(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Rh(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,s,a,l){this.ctx.transform(e,t,n,s,a,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){const s=this.ctx,a=this.current;let l=a.x,c=a.y,d,h;const p=St(s),v=p[0]===0&&p[3]===0||p[1]===0&&p[2]===0,_=v?n.slice(0):null;for(let x=0,A=0,E=e.length;x<E;x++)switch(e[x]|0){case ds.rectangle:l=t[A++],c=t[A++];const R=t[A++],N=t[A++],D=l+R,P=c+N;s.moveTo(l,c),R===0||N===0?s.lineTo(D,P):(s.lineTo(D,c),s.lineTo(D,P),s.lineTo(l,P)),v||a.updateRectMinMax(p,[l,c,D,P]),s.closePath();break;case ds.moveTo:l=t[A++],c=t[A++],s.moveTo(l,c),v||a.updatePathMinMax(p,l,c);break;case ds.lineTo:l=t[A++],c=t[A++],s.lineTo(l,c),v||a.updatePathMinMax(p,l,c);break;case ds.curveTo:d=l,h=c,l=t[A+4],c=t[A+5],s.bezierCurveTo(t[A],t[A+1],t[A+2],t[A+3],l,c),a.updateCurvePathMinMax(p,d,h,t[A],t[A+1],t[A+2],t[A+3],l,c,_),A+=6;break;case ds.curveTo2:d=l,h=c,s.bezierCurveTo(l,c,t[A],t[A+1],t[A+2],t[A+3]),a.updateCurvePathMinMax(p,d,h,l,c,t[A],t[A+1],t[A+2],t[A+3],_),l=t[A+2],c=t[A+3],A+=4;break;case ds.curveTo3:d=l,h=c,l=t[A+2],c=t[A+3],s.bezierCurveTo(t[A],t[A+1],l,c,l,c),a.updateCurvePathMinMax(p,d,h,t[A],t[A+1],l,c,l,c,_),A+=4;break;case ds.closePath:s.closePath();break}v&&a.updateScalingPathMinMax(p,_),a.setCurrentPoint(l,c)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&(n!=null&&n.getPattern)?(t.save(),t.strokeStyle=n.getPattern(t,this,Os(t),Dn.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,n=this.current.fillColor,s=this.current.patternFill;let a=!1;s&&(t.save(),t.fillStyle=n.getPattern(t,this,Os(t),Dn.FILL),a=!0);const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),a&&t.restore(),e&&this.consumePath(l)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=aP}eoClip(){this.pendingClip=YT}beginText(){this.current.textMatrix=dR,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const n=new Path2D,s=t.getTransform().invertSelf();for(const{transform:a,x:l,y:c,fontSize:d,path:h}of e)n.addPath(h,new DOMMatrix(a).preMultiplySelf(s).translate(l,c).scale(d,-d));t.clip(n),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var p;const n=this.commonObjs.get(e),s=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=n.fontMatrix||Yb,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Be("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const a=n.loadedName||"sans-serif",l=((p=n.systemFontInfo)==null?void 0:p.css)||`"${a}", ${n.fallbackName}`;let c="normal";n.black?c="900":n.bold&&(c="bold");const d=n.italic?"italic":"normal";let h=t;t<HT?h=HT:t>BT&&(h=BT),this.current.fontSizeScale=t/h,this.ctx.font=`${d} ${c} ${h}px ${l}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,s,a,l){this.current.textMatrix=[e,t,n,s,a,l],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,s,a){const l=this.ctx,c=this.current,d=c.font,h=c.textRenderingMode,p=c.fontSize/c.fontSizeScale,v=h&Tn.FILL_STROKE_MASK,_=!!(h&Tn.ADD_TO_PATH_FLAG),x=c.patternFill&&!d.missingFile,A=c.patternStroke&&!d.missingFile;let E;if((d.disableFontFace||_||x||A)&&(E=d.getPathGenerator(this.commonObjs,e)),d.disableFontFace||x||A){if(l.save(),l.translate(t,n),l.scale(p,-p),v===Tn.FILL||v===Tn.FILL_STROKE)if(s){const R=l.getTransform();l.setTransform(...s),l.fill(k(this,Ms,x_).call(this,E,R,s))}else l.fill(E);if(v===Tn.STROKE||v===Tn.FILL_STROKE)if(a){const R=l.getTransform();l.setTransform(...a),l.stroke(k(this,Ms,x_).call(this,E,R,a))}else l.lineWidth/=p,l.stroke(E);l.restore()}else(v===Tn.FILL||v===Tn.FILL_STROKE)&&l.fillText(e,t,n),(v===Tn.STROKE||v===Tn.FILL_STROKE)&&l.strokeText(e,t,n);_&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:St(l),x:t,y:n,fontSize:p,path:E})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return Ve(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const a=this.ctx,l=t.fontSizeScale,c=t.charSpacing,d=t.wordSpacing,h=t.fontDirection,p=t.textHScale*h,v=e.length,_=n.vertical,x=_?1:-1,A=n.defaultVMetrics,E=s*t.fontMatrix[0],R=t.textRenderingMode===Tn.FILL&&!n.disableFontFace&&!t.patternFill;a.save(),a.transform(...t.textMatrix),a.translate(t.x,t.y+t.textRise),h>0?a.scale(p,-1):a.scale(p,1);let N,D;if(t.patternFill){a.save();const O=t.fillColor.getPattern(a,this,Os(a),Dn.FILL);N=St(a),a.restore(),a.fillStyle=O}if(t.patternStroke){a.save();const O=t.strokeColor.getPattern(a,this,Os(a),Dn.STROKE);D=St(a),a.restore(),a.strokeStyle=O}let P=t.lineWidth;const L=t.textMatrixScale;if(L===0||P===0){const O=t.textRenderingMode&Tn.FILL_STROKE_MASK;(O===Tn.STROKE||O===Tn.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=L;if(l!==1&&(a.scale(l,l),P/=l),a.lineWidth=P,n.isInvalidPDFjsFont){const O=[];let X=0;for(const Y of e)O.push(Y.unicode),X+=Y.width;a.fillText(O.join(""),0,0),t.x+=X*E*p,a.restore(),this.compose();return}let B=0,H;for(H=0;H<v;++H){const O=e[H];if(typeof O=="number"){B+=x*O*s/1e3;continue}let X=!1;const Y=(O.isSpace?d:0)+c,se=O.fontChar,re=O.accent;let ne,be,ye=O.width;if(_){const G=O.vmetric||A,W=-(O.vmetric?G[1]:ye*.5)*E,he=G[2]*E;ye=G?-G[0]:ye,ne=W/l,be=(B+he)/l}else ne=B/l,be=0;if(n.remeasure&&ye>0){const G=a.measureText(se).width*1e3/s*l;if(ye<G&&this.isFontSubpixelAAEnabled){const W=ye/G;X=!0,a.save(),a.scale(W,1),ne/=W}else ye!==G&&(ne+=(ye-G)/2e3*s/l)}if(this.contentVisible&&(O.isInFont||n.missingFile)){if(R&&!re)a.fillText(se,ne,be);else if(this.paintChar(se,ne,be,N,D),re){const G=ne+s*re.offset.x/l,W=be-s*re.offset.y/l;this.paintChar(re.fontChar,G,W,N,D)}}const ze=_?ye*E-Y*h:ye*E+Y*h;B+=ze,X&&a.restore()}_?t.y-=B:t.x+=B*p,a.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,s=n.font,a=n.fontSize,l=n.fontDirection,c=s.vertical?1:-1,d=n.charSpacing,h=n.wordSpacing,p=n.textHScale*l,v=n.fontMatrix||Yb,_=e.length,x=n.textRenderingMode===Tn.INVISIBLE;let A,E,R,N;if(!(x||a===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(p,l),A=0;A<_;++A){if(E=e[A],typeof E=="number"){N=c*E*a/1e3,this.ctx.translate(N,0),n.x+=N*p;continue}const D=(E.isSpace?h:0)+d,P=s.charProcOperatorList[E.operatorListId];if(!P){Be(`Type3 character "${E.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=E,this.save(),t.scale(a,a),t.transform(...v),this.executeOperatorList(P),this.restore()),R=xe.applyTransform([E.width,0],v)[0]*a+D,t.translate(R,0),n.x+=R*p}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,s,a,l){this.ctx.rect(n,s,a-n,l-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const n=e[1],s=this.baseTransform||St(this.ctx),a={createCanvasGraphics:l=>new yx(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new b_(e,n,this.ctx,a,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){this.ctx.strokeStyle=this.current.strokeColor=xe.makeHexColor(e,t,n),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,n){this.ctx.fillStyle=this.current.fillColor=xe.makeHexColor(e,t,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=QD(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,Os(t),Dn.SHADING);const s=Os(t);if(s){const{width:a,height:l}=t.canvas,[c,d,h,p]=xe.getAxialAlignedBoundingBox([0,0,a,l],s);this.ctx.fillRect(c,d,h-c,p-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){pt("Should not call beginInlineImage")}beginImageData(){pt("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=St(this.ctx),t)){const n=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],n,s),this.current.updateRectMinMax(St(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||F0("TODO: Support non-isolated groups."),e.knockout&&Be("Knockout groups not supported.");const n=St(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=xe.getAxialAlignedBoundingBox(e.bbox,St(t));const a=[0,0,t.canvas.width,t.canvas.height];s=xe.intersect(s,a)||[0,0,0,0];const l=Math.floor(s[0]),c=Math.floor(s[1]),d=Math.max(Math.ceil(s[2])-l,1),h=Math.max(Math.ceil(s[3])-c,1);this.current.startNewPathAndClipBox([0,0,d,h]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(p,d,h),_=v.context;_.translate(-l,-c),_.transform(...n),e.smask?this.smaskStack.push({canvas:v.canvas,context:_,offsetX:l,offsetY:c,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(l,c),t.save()),Rh(t,_),this.ctx=_,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=St(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const a=xe.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,n,s,a){if(k(this,Ms,__).call(this),am(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const l=t[2]-t[0],c=t[3]-t[1];if(a&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=l,t[3]=c;const[d,h]=xe.singularValueDecompose2dScale(St(this.ctx)),{viewportScale:p}=this,v=Math.ceil(l*this.outputScaleX*p),_=Math.ceil(c*this.outputScaleY*p);this.annotationCanvas=this.canvasFactory.create(v,_);const{canvas:x,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(e,x),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(d,0,0,-h,0,c*h),am(this.ctx)}else am(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],l,c),this.ctx.clip(),this.ctx.beginPath()}this.current=new qT(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),k(this,Ms,w_).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const n=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=iP(e)),s.compiled)){s.compiled(n);return}const a=this._createMaskCanvas(e),l=a.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(l,a.offsetX,a.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,s=0,a,l){if(!this.contentVisible)return;e=this.getObject(e.data,e);const c=this.ctx;c.save();const d=St(c);c.transform(t,n,s,a,0,0);const h=this._createMaskCanvas(e);c.setTransform(1,0,0,1,h.offsetX-d[4],h.offsetY-d[5]);for(let p=0,v=l.length;p<v;p+=2){const _=xe.transform(d,[t,n,s,a,l[p],l[p+1]]),[x,A]=xe.applyTransform([0,0],_);c.drawImage(h.canvas,x,A)}c.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,s=this.current.patternFill;for(const a of e){const{data:l,width:c,height:d,transform:h}=a,p=this.cachedCanvases.getCanvas("maskCanvas",c,d),v=p.context;v.save();const _=this.getObject(l,a);$T(v,_),v.globalCompositeOperation="source-in",v.fillStyle=s?n.getPattern(v,this,Os(t),Dn.FILL):n,v.fillRect(0,0,c,d),v.restore(),t.save(),t.transform(...h),t.scale(1,-1),rm(t,p.canvas,0,0,c,d,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Be("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,s){if(!this.contentVisible)return;const a=this.getObject(e);if(!a){Be("Dependent image isn't ready yet");return}const l=a.width,c=a.height,d=[];for(let h=0,p=s.length;h<p;h+=2)d.push({transform:[t,0,0,n,s[h],s[h+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(a,d)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,a=this.cachedCanvases.getCanvas("inlineImage",n,s),l=a.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",a.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,s=this.ctx;if(this.save(),!Pn){const{filter:c}=s;c!=="none"&&c!==""&&(s.filter="none")}s.scale(1/t,-1/n);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const d=this.cachedCanvases.getCanvas("inlineImage",t,n).context;VT(d,e),a=this.applyTransferMapsToCanvas(d)}const l=this._scaleImage(a,Os(s));s.imageSmoothingEnabled=jT(St(s),e.interpolate),rm(s,l.img,0,0,l.paintWidth,l.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const a=e.width,l=e.height,d=this.cachedCanvases.getCanvas("inlineImage",a,l).context;VT(d,e),s=this.applyTransferMapsToCanvas(d)}for(const a of t)n.save(),n.transform(...a.transform),n.scale(1,-1),rm(n,s,a.x,a.y,a.w,a.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const n=this.ctx;this.pendingClip&&(t||(this.pendingClip===YT?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=St(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:a}=this.ctx.getTransform();let l,c;if(n===0&&s===0){const d=Math.abs(t),h=Math.abs(a);if(d===h)if(e===0)l=c=1/d;else{const p=d*e;l=c=p<1?1/p:1}else if(e===0)l=1/d,c=1/h;else{const p=d*e,v=h*e;l=p<1?1/p:1,c=v<1?1/v:1}}else{const d=Math.abs(t*a-n*s),h=Math.hypot(t,n),p=Math.hypot(s,a);if(e===0)l=p/d,c=h/d;else{const v=e*d;l=p>v?p/v:1,c=h>v?h/v:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:n}=this.current,[s,a]=this.getScaleForStroking();if(t.lineWidth=n||1,s===1&&a===1){t.stroke();return}const l=t.getLineDash();if(e&&t.save(),t.scale(s,a),l.length>0){const c=Math.max(s,a);t.setLineDash(l.map(d=>d/c)),t.lineDashOffset/=c}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Ms=new WeakSet,__=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},w_=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},x_=function(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s};let vu=yx;for(const i in ds)vu.prototype[i]!==void 0&&(vu.prototype[ds[i]]=vu.prototype[i]);var Ff,Hf;class Zr{static get workerPort(){return g(this,Ff)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");C(this,Ff,e)}static get workerSrc(){return g(this,Hf)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");C(this,Hf,e)}}Ff=new WeakMap,Hf=new WeakMap,M(Zr,Ff,null),M(Zr,Hf,"");var wl,Bf;class oP{constructor({parsedData:e,rawData:t}){M(this,wl);M(this,Bf);C(this,wl,e),C(this,Bf,t)}getRaw(){return g(this,Bf)}get(e){return g(this,wl).get(e)??null}getAll(){return Fw(g(this,wl))}has(e){return g(this,wl).has(e)}}wl=new WeakMap,Bf=new WeakMap;const au=Symbol("INTERNAL");var Gf,zf,qf,Bu;class lP{constructor(e,{name:t,intent:n,usage:s,rbGroups:a}){M(this,Gf,!1);M(this,zf,!1);M(this,qf,!1);M(this,Bu,!0);C(this,Gf,!!(e&ki.DISPLAY)),C(this,zf,!!(e&ki.PRINT)),this.name=t,this.intent=n,this.usage=s,this.rbGroups=a}get visible(){if(g(this,qf))return g(this,Bu);if(!g(this,Bu))return!1;const{print:e,view:t}=this.usage;return g(this,Gf)?(t==null?void 0:t.viewState)!=="OFF":g(this,zf)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==au&&pt("Internal method `_setVisible` called."),C(this,qf,n),C(this,Bu,t)}}Gf=new WeakMap,zf=new WeakMap,qf=new WeakMap,Bu=new WeakMap;var Ja,ot,Gu,zu,Vf,S_;class cP{constructor(e,t=ki.DISPLAY){M(this,Vf);M(this,Ja,null);M(this,ot,new Map);M(this,Gu,null);M(this,zu,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,C(this,zu,e.order);for(const n of e.groups)g(this,ot).set(n.id,new lP(t,n));if(e.baseState==="OFF")for(const n of g(this,ot).values())n._setVisible(au,!1);for(const n of e.on)g(this,ot).get(n)._setVisible(au,!0);for(const n of e.off)g(this,ot).get(n)._setVisible(au,!1);C(this,Gu,this.getHash())}}isVisible(e){if(g(this,ot).size===0)return!0;if(!e)return F0("Optional content group not defined."),!0;if(e.type==="OCG")return g(this,ot).has(e.id)?g(this,ot).get(e.id).visible:(Be(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return k(this,Vf,S_).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!g(this,ot).has(t))return Be(`Optional content group not found: ${t}`),!0;if(g(this,ot).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!g(this,ot).has(t))return Be(`Optional content group not found: ${t}`),!0;if(!g(this,ot).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!g(this,ot).has(t))return Be(`Optional content group not found: ${t}`),!0;if(!g(this,ot).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!g(this,ot).has(t))return Be(`Optional content group not found: ${t}`),!0;if(g(this,ot).get(t).visible)return!1}return!0}return Be(`Unknown optional content policy ${e.policy}.`),!0}return Be(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var a;const s=g(this,ot).get(e);if(!s){Be(`Optional content group not found: ${e}`);return}if(n&&t&&s.rbGroups.length)for(const l of s.rbGroups)for(const c of l)c!==e&&((a=g(this,ot).get(c))==null||a._setVisible(au,!1,!0));s._setVisible(au,!!t,!0),C(this,Ja,null)}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const a=g(this,ot).get(s);if(a)switch(n){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!a.visible,t);break}}C(this,Ja,null)}get hasInitialVisibility(){return g(this,Gu)===null||this.getHash()===g(this,Gu)}getOrder(){return g(this,ot).size?g(this,zu)?g(this,zu).slice():[...g(this,ot).keys()]:null}getGroups(){return g(this,ot).size>0?Fw(g(this,ot)):null}getGroup(e){return g(this,ot).get(e)||null}getHash(){if(g(this,Ja)!==null)return g(this,Ja);const e=new zR;for(const[t,n]of g(this,ot))e.update(`${t}:${n.visible}`);return C(this,Ja,e.hexdigest())}}Ja=new WeakMap,ot=new WeakMap,Gu=new WeakMap,zu=new WeakMap,Vf=new WeakSet,S_=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const a=e[s];let l;if(Array.isArray(a))l=k(this,Vf,S_).call(this,a);else if(g(this,ot).has(a))l=g(this,ot).get(a).visible;else return Be(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"};class uP{constructor(e,{disableRange:t=!1,disableStream:n=!1}){Vt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:a,progressiveDone:l,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,(a==null?void 0:a.length)>0){const d=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((d,h)=>{this._onReceiveData({begin:d,chunk:h})}),e.addProgressListener((d,h)=>{this._onProgress({loaded:d,total:h})}),e.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(a){return a._begin!==e?!1:(a._enqueue(n),!0)});Vt(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,n,s,a;e.total===void 0?(n=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||n.call(t,{loaded:e.loaded}):(a=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||a.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Vt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new dP(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new hP(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class dP{constructor(e,t,n=!1,s=null){this._stream=e,this._done=n||!1,this._filename=Gw(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class hP{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function fP(i){let e=!0,t=n("filename\\*","i").exec(i);if(t){t=t[1];let p=c(t);return p=unescape(p),p=d(p),p=h(p),a(p)}if(t=l(i),t){const p=h(t);return a(p)}if(t=n("filename","i").exec(i),t){t=t[1];let p=c(t);return p=h(p),a(p)}function n(p,v){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',v)}function s(p,v){if(p){if(!/^[\x00-\xFF]+$/.test(v))return v;try{const _=new TextDecoder(p,{fatal:!0}),x=H0(v);v=_.decode(x),e=!1}catch{}}return v}function a(p){return e&&/[\x80-\xff]/.test(p)&&(p=s("utf-8",p),e&&(p=s("iso-8859-1",p))),p}function l(p){const v=[];let _;const x=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(_=x.exec(p))!==null;){let[,E,R,N]=_;if(E=parseInt(E,10),E in v){if(E===0)break;continue}v[E]=[R,N]}const A=[];for(let E=0;E<v.length&&E in v;++E){let[R,N]=v[E];N=c(N),R&&(N=unescape(N),E===0&&(N=d(N))),A.push(N)}return A.join("")}function c(p){if(p.startsWith('"')){const v=p.slice(1).split('\\"');for(let _=0;_<v.length;++_){const x=v[_].indexOf('"');x!==-1&&(v[_]=v[_].slice(0,x),v.length=_+1),v[_]=v[_].replaceAll(/\\(.)/g,"$1")}p=v.join('"')}return p}function d(p){const v=p.indexOf("'");if(v===-1)return p;const _=p.slice(0,v),A=p.slice(v+1).replace(/^[^']*'/,"");return s(_,A)}function h(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(v,_,x,A){if(x==="q"||x==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(E,R){return String.fromCharCode(parseInt(R,16))}),s(_,A);try{A=atob(A)}catch{}return s(_,A)})}return""}function nN(i,e){const t=new Headers;if(!i||!e||typeof e!="object")return t;for(const n in e){const s=e[n];s!==void 0&&t.append(n,s)}return t}function z0(i){try{return new URL(i).origin}catch{}return null}function iN({responseHeaders:i,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(i.get("Content-Length"),10);return!Number.isInteger(a)||(s.suggestedLength=a,a<=2*t)||n||!e||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function sN(i){const e=i.get("Content-Disposition");if(e){let t=fP(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Gw(t))return t}return null}function q0(i,e){return i===404||i===0&&e.startsWith("file:")?new tf('Missing PDF "'+e+'".'):new Wm(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i)}function rN(i){return i===200||i===206}function aN(i,e,t){return{method:"GET",headers:i,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function oN(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Be(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class KT{constructor(e){Re(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=nN(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Vt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new pP(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new gP(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class pP{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),s=t.url;fetch(s,aN(n,this._withCredentials,this._abortController)).then(a=>{if(e._responseOrigin=z0(a.url),!rN(a.status))throw q0(a.status,s);this._reader=a.body.getReader(),this._headersCapability.resolve();const l=a.headers,{allowRangeRequests:c,suggestedLength:d}=iN({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=d||this._contentLength,this._filename=sN(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new go("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:oN(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class gP{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const a=new Headers(e.headers);a.append("Range",`bytes=${t}-${n-1}`);const l=s.url;fetch(l,aN(a,this._withCredentials,this._abortController)).then(c=>{const d=z0(c.url);if(d!==e._responseOrigin)throw new Error(`Expected range response-origin "${d}" to match "${e._responseOrigin}".`);if(!rN(c.status))throw q0(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:oN(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Mb=200,kb=206;function mP(i){const e=i.response;return typeof e!="string"?e:H0(e).buffer}class yP{constructor({url:e,httpHeaders:t,withCredentials:n}){Re(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=nN(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[a,l]of this.headers)t.setRequestHeader(a,l);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=kb):s.expectedStatus=Mb,t.responseType="arraybuffer",Vt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var s;const n=this.pendingRequests[e];n&&((s=n.onProgress)==null||s.call(n,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){n.onError(s.status);return}const a=s.status||Mb;if(!(a===Mb&&n.expectedStatus===kb)&&a!==n.expectedStatus){n.onError(s.status);return}const c=mP(s);if(a===kb){const d=s.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);h?n.onDone({begin:parseInt(h[1],10),chunk:c}):(Be('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class vP{constructor(e){this._source=e,this._manager=new yP(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Vt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new bP(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new _P(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class bP{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=z0(t.responseURL);const n=t.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[d,...h]=c.split(": ");return[d,h.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:l}=iN({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=sN(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=q0(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class _P{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=z0((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=q0(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const wP=/^[a-z][a-z0-9\-+.]+:/i;function xP(i){if(wP.test(i))return new URL(i);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(i))}class SP{constructor(e){this.source=e,this.url=xP(e.url),Vt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Vt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new AP(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new EP(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class AP{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new tf(`Missing PDF "${this._url}".`)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new go("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class EP{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const TP=1e5,ti=30,CP=.8;var cR,Xa,ri,$f,jf,xl,Ur,Yf,Kf,Sl,qu,Vu,Wa,$u,Jf,ju,Al,Xf,Wf,El,Tl,Qf,Qa,Yu,sa,lN,cN,A_,Oi,Mm,E_,uN,dN;const Jt=class Jt{constructor({textContentSource:e,container:t,viewport:n}){M(this,sa);M(this,Xa,Promise.withResolvers());M(this,ri,null);M(this,$f,!1);M(this,jf,!!((cR=globalThis.FontInspector)!=null&&cR.enabled));M(this,xl,null);M(this,Ur,null);M(this,Yf,0);M(this,Kf,0);M(this,Sl,null);M(this,qu,null);M(this,Vu,0);M(this,Wa,0);M(this,$u,Object.create(null));M(this,Jf,[]);M(this,ju,null);M(this,Al,[]);M(this,Xf,new WeakMap);M(this,Wf,null);var d;if(e instanceof ReadableStream)C(this,ju,e);else if(typeof e=="object")C(this,ju,new ReadableStream({start(h){h.enqueue(e),h.close()}}));else throw new Error('No "textContentSource" parameter specified.');C(this,ri,C(this,qu,t)),C(this,Wa,n.scale*(globalThis.devicePixelRatio||1)),C(this,Vu,n.rotation),C(this,Ur,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:a,pageX:l,pageY:c}=n.rawDims;C(this,Wf,[1,0,0,-1,-l,c+a]),C(this,Kf,s),C(this,Yf,a),k(d=Jt,Oi,uN).call(d),nc(t,n),g(this,Xa).promise.finally(()=>{g(Jt,Yu).delete(this),C(this,Ur,null),C(this,$u,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Vn.platform;return Ve(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{g(this,Sl).read().then(({value:t,done:n})=>{if(n){g(this,Xa).resolve();return}g(this,xl)??C(this,xl,t.lang),Object.assign(g(this,$u),t.styles),k(this,sa,lN).call(this,t.items),e()},g(this,Xa).reject)};return C(this,Sl,g(this,ju).getReader()),g(Jt,Yu).add(this),e(),g(this,Xa).promise}update({viewport:e,onBefore:t=null}){var a;const n=e.scale*(globalThis.devicePixelRatio||1),s=e.rotation;if(s!==g(this,Vu)&&(t==null||t(),C(this,Vu,s),nc(g(this,qu),{rotation:s})),n!==g(this,Wa)){t==null||t(),C(this,Wa,n);const l={div:null,properties:null,ctx:k(a=Jt,Oi,Mm).call(a,g(this,xl))};for(const c of g(this,Al))l.properties=g(this,Xf).get(c),l.div=c,k(this,sa,A_).call(this,l)}}cancel(){var t;const e=new go("TextLayer task cancelled.");(t=g(this,Sl))==null||t.cancel(e).catch(()=>{}),C(this,Sl,null),g(this,Xa).reject(e)}get textDivs(){return g(this,Al)}get textContentItemsStr(){return g(this,Jf)}static cleanup(){if(!(g(this,Yu).size>0)){g(this,El).clear();for(const{canvas:e}of g(this,Tl).values())e.remove();g(this,Tl).clear()}}};Xa=new WeakMap,ri=new WeakMap,$f=new WeakMap,jf=new WeakMap,xl=new WeakMap,Ur=new WeakMap,Yf=new WeakMap,Kf=new WeakMap,Sl=new WeakMap,qu=new WeakMap,Vu=new WeakMap,Wa=new WeakMap,$u=new WeakMap,Jf=new WeakMap,ju=new WeakMap,Al=new WeakMap,Xf=new WeakMap,Wf=new WeakMap,El=new WeakMap,Tl=new WeakMap,Qf=new WeakMap,Qa=new WeakMap,Yu=new WeakMap,sa=new WeakSet,lN=function(e){var s,a;if(g(this,$f))return;(a=g(this,Ur)).ctx??(a.ctx=k(s=Jt,Oi,Mm).call(s,g(this,xl)));const t=g(this,Al),n=g(this,Jf);for(const l of e){if(t.length>TP){Be("Ignoring additional textDivs for performance reasons."),C(this,$f,!0);return}if(l.str===void 0){if(l.type==="beginMarkedContentProps"||l.type==="beginMarkedContent"){const c=g(this,ri);C(this,ri,document.createElement("span")),g(this,ri).classList.add("markedContent"),l.id!==null&&g(this,ri).setAttribute("id",`${l.id}`),c.append(g(this,ri))}else l.type==="endMarkedContent"&&C(this,ri,g(this,ri).parentNode);continue}n.push(l.str),k(this,sa,cN).call(this,l)}},cN=function(e){var E;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};g(this,Al).push(t);const s=xe.transform(g(this,Wf),e.transform);let a=Math.atan2(s[1],s[0]);const l=g(this,$u)[e.fontName];l.vertical&&(a+=Math.PI/2);let c=g(this,jf)&&l.fontSubstitution||l.fontFamily;c=Jt.fontFamilyMap.get(c)||c;const d=Math.hypot(s[2],s[3]),h=d*k(E=Jt,Oi,dN).call(E,c,g(this,xl));let p,v;a===0?(p=s[4],v=s[5]-h):(p=s[4]+h*Math.sin(a),v=s[5]-h*Math.cos(a));const _="calc(var(--scale-factor)*",x=t.style;g(this,ri)===g(this,qu)?(x.left=`${(100*p/g(this,Kf)).toFixed(2)}%`,x.top=`${(100*v/g(this,Yf)).toFixed(2)}%`):(x.left=`${_}${p.toFixed(2)}px)`,x.top=`${_}${v.toFixed(2)}px)`),x.fontSize=`${_}${(g(Jt,Qa)*d).toFixed(2)}px)`,x.fontFamily=c,n.fontSize=d,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,g(this,jf)&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),a!==0&&(n.angle=a*(180/Math.PI));let A=!1;if(e.str.length>1)A=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const R=Math.abs(e.transform[0]),N=Math.abs(e.transform[3]);R!==N&&Math.max(R,N)/Math.min(R,N)>1.5&&(A=!0)}if(A&&(n.canvasWidth=l.vertical?e.height:e.width),g(this,Xf).set(t,n),g(this,Ur).div=t,g(this,Ur).properties=n,k(this,sa,A_).call(this,g(this,Ur)),n.hasText&&g(this,ri).append(t),n.hasEOL){const R=document.createElement("br");R.setAttribute("role","presentation"),g(this,ri).append(R)}},A_=function(e){var c;const{div:t,properties:n,ctx:s}=e,{style:a}=t;let l="";if(g(Jt,Qa)>1&&(l=`scale(${1/g(Jt,Qa)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:d}=a,{canvasWidth:h,fontSize:p}=n;k(c=Jt,Oi,E_).call(c,s,p*g(this,Wa),d);const{width:v}=s.measureText(t.textContent);v>0&&(l=`scaleX(${h*g(this,Wa)/v}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(a.transform=l)},Oi=new WeakSet,Mm=function(e=null){let t=g(this,Tl).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),g(this,Tl).set(e,t),g(this,Qf).set(t,{size:0,family:""})}return t},E_=function(e,t,n){const s=g(this,Qf).get(e);t===s.size&&n===s.family||(e.font=`${t}px ${n}`,s.size=t,s.family=n)},uN=function(){if(g(this,Qa)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),C(this,Qa,e.getBoundingClientRect().height),e.remove()},dN=function(e,t){const n=g(this,El).get(e);if(n)return n;const s=k(this,Oi,Mm).call(this,t);s.canvas.width=s.canvas.height=ti,k(this,Oi,E_).call(this,s,ti,e);const a=s.measureText("");let l=a.fontBoundingBoxAscent,c=Math.abs(a.fontBoundingBoxDescent);if(l){const p=l/(l+c);return g(this,El).set(e,p),s.canvas.width=s.canvas.height=0,p}s.strokeStyle="red",s.clearRect(0,0,ti,ti),s.strokeText("g",0,0);let d=s.getImageData(0,0,ti,ti).data;c=0;for(let p=d.length-1-3;p>=0;p-=4)if(d[p]>0){c=Math.ceil(p/4/ti);break}s.clearRect(0,0,ti,ti),s.strokeText("A",0,ti),d=s.getImageData(0,0,ti,ti).data,l=0;for(let p=0,v=d.length;p<v;p+=4)if(d[p]>0){l=ti-Math.floor(p/4/ti);break}s.canvas.width=s.canvas.height=0;const h=l?l/(l+c):CP;return g(this,El).set(e,h),h},M(Jt,Oi),M(Jt,El,new Map),M(Jt,Tl,new Map),M(Jt,Qf,new WeakMap),M(Jt,Qa,null),M(Jt,Yu,new Set);let nf=Jt;class sf{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(a){var d;if(!a)return;let l=null;const c=a.name;if(c==="#text")l=a.value;else if(sf.shouldBuildText(c))(d=a==null?void 0:a.attributes)!=null&&d.textContent?l=a.attributes.textContent:a.value&&(l=a.value);else return;if(l!==null&&t.push({str:l}),!!a.children)for(const h of a.children)s(h)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const RP=65536,NP=100,MP=5e3,kP=Pn?$D:zD,IP=Pn?jD:XR,DP=Pn?VD:qD,PP=Pn?YD:eN;function LP(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const e=new T_,{docId:t}=e,n=i.url?OP(i.url):null,s=i.data?UP(i.data):null,a=i.httpHeaders||null,l=i.withCredentials===!0,c=i.password??null,d=i.range instanceof hN?i.range:null,h=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:RP;let p=i.worker instanceof bu?i.worker:null;const v=i.verbosity,_=typeof i.docBaseUrl=="string"&&!G0(i.docBaseUrl)?i.docBaseUrl:null,x=typeof i.cMapUrl=="string"?i.cMapUrl:null,A=i.cMapPacked!==!1,E=i.CMapReaderFactory||IP,R=typeof i.standardFontDataUrl=="string"?i.standardFontDataUrl:null,N=i.StandardFontDataFactory||PP,D=i.stopAtErrors!==!0,P=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,L=i.isEvalSupported!==!1,B=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!Pn,H=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!Pn&&(Vn.platform.isFirefox||!globalThis.chrome),O=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,X=typeof i.disableFontFace=="boolean"?i.disableFontFace:Pn,Y=i.fontExtraProperties===!0,se=i.enableXfa===!0,re=i.ownerDocument||globalThis.document,ne=i.disableRange===!0,be=i.disableStream===!0,ye=i.disableAutoFetch===!0,ze=i.pdfBug===!0,G=i.CanvasFactory||kP,W=i.FilterFactory||DP,he=i.enableHWA===!0,te=d?d.length:i.length??NaN,le=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!Pn&&!X,U=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:E===XR&&N===eN&&x&&R&&Dh(x,document.baseURI)&&Dh(R,document.baseURI),K=null;_D(v);const ie={canvasFactory:new G({ownerDocument:re,enableHWA:he}),filterFactory:new W({docId:t,ownerDocument:re}),cMapReaderFactory:U?null:new E({baseUrl:x,isCompressed:A}),standardFontDataFactory:U?null:new N({baseUrl:R})};if(!p){const Ee={verbosity:v,port:Zr.workerPort};p=Ee.port?bu.fromPort(Ee):new bu(Ee),e._worker=p}const oe={docId:t,apiVersion:"4.10.38",data:s,password:c,disableAutoFetch:ye,rangeChunkSize:h,length:te,docBaseUrl:_,enableXfa:se,evaluatorOptions:{maxImageSize:P,disableFontFace:X,ignoreErrors:D,isEvalSupported:L,isOffscreenCanvasSupported:B,isImageDecoderSupported:H,canvasMaxAreaInBytes:O,fontExtraProperties:Y,useSystemFonts:le,cMapUrl:U?x:null,standardFontDataUrl:U?R:null}},Ie={disableFontFace:X,fontExtraProperties:Y,ownerDocument:re,pdfBug:ze,styleElement:K,loadingParams:{disableAutoFetch:ye,enableXfa:se}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Ee=p.messageHandler.sendWithPromise("GetDocRequest",oe,s?[s.buffer]:null);let Se;if(d)Se=new uP(d,{disableRange:ne,disableStream:be});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");let Nt;if(Pn)if(Dh(n)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Nt=KT}else Nt=SP;else Nt=Dh(n)?KT:vP;Se=new Nt({url:n,length:te,httpHeaders:a,withCredentials:l,rangeChunkSize:h,disableRange:ne,disableStream:be})}return Ee.then(Nt=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const _t=new Uh(t,Nt,p.port),_o=new GP(_t,e,Se,Ie,ie);e._transport=_o,_t.send("Ready",null)})}).catch(e._capability.reject),e}function OP(i){if(i instanceof URL)return i.href;try{return new URL(i,window.location).href}catch{if(Pn&&typeof i=="string")return i}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function UP(i){if(Pn&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return H0(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i==null?void 0:i.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function JT(i){return typeof i=="object"&&Number.isInteger(i==null?void 0:i.num)&&i.num>=0&&Number.isInteger(i==null?void 0:i.gen)&&i.gen>=0}var A0;const E0=class E0{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Un(E0,A0)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,n,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(a){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,a}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}};A0=new WeakMap,M(E0,A0,0);let T_=E0;class hN{constructor(e,t,n=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){pt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class FP{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Za,Fr,ts,ou,km;class HP{constructor(e,t,n,s=!1){M(this,ts);M(this,Za,null);M(this,Fr,!1);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new LT:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new fN,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:a=!1}={}){return new Lp({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:a})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:s=La.ENABLE,transform:a=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:d=null,pageColors:h=null,printAnnotationStorage:p=null,isEditing:v=!1}){var L,B;(L=this._stats)==null||L.time("Overall");const _=this._transport.getRenderingIntent(n,s,p,v),{renderingIntent:x,cacheKey:A}=_;C(this,Fr,!1),k(this,ts,km).call(this),c||(c=this._transport.getOptionalContentConfig(x));let E=this._intentStates.get(A);E||(E=Object.create(null),this._intentStates.set(A,E)),E.streamReaderCancelTimeout&&(clearTimeout(E.streamReaderCancelTimeout),E.streamReaderCancelTimeout=null);const R=!!(x&ki.PRINT);E.displayReadyCapability||(E.displayReadyCapability=Promise.withResolvers(),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(B=this._stats)==null||B.time("Page Request"),this._pumpOperatorList(_));const N=H=>{var O;E.renderTasks.delete(D),(this._maybeCleanupAfterRender||R)&&C(this,Fr,!0),k(this,ts,ou).call(this,!R),H?(D.capability.reject(H),this._abortOperatorList({intentState:E,reason:H instanceof Error?H:new Error(H)})):D.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(O=globalThis.Stats)!=null&&O.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},D=new R_({callback:N,params:{canvasContext:e,viewport:t,transform:a,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:E.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!R,pdfBug:this._pdfBug,pageColors:h});(E.renderTasks||(E.renderTasks=new Set)).add(D);const P=D.task;return Promise.all([E.displayReadyCapability.promise,c]).then(([H,O])=>{var X;if(this.destroyed){N();return}if((X=this._stats)==null||X.time("Rendering"),!(O.renderingIntent&x))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");D.initializeGraphics({transparency:H,optionalContentConfig:O}),D.operatorListChanged()}).catch(N),P}getOperatorList({intent:e="display",annotationMode:t=La.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){var h;function a(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(d))}const l=this._transport.getRenderingIntent(e,t,n,s,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let d;return c.opListReadCapability||(d=Object.create(null),d.operatorListChanged=a,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(d),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>sf.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function a(){l.read().then(function({value:d,done:h}){if(h){n(c);return}c.lang??(c.lang=d.lang),Object.assign(c.styles,d.styles),c.items.push(...d.items),a()},s)}const l=t.getReader(),c={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),C(this,Fr,!1),k(this,ts,km).call(this),Promise.all(e)}cleanup(e=!1){C(this,Fr,!0);const t=k(this,ts,ou).call(this,!1);return e&&t&&this._stats&&(this._stats=new LT),t}_startRenderPage(e,t){var s,a;const n=this._intentStates.get(t);n&&((s=this._stats)==null||s.timeEnd("Page Request"),(a=n.displayReadyCapability)==null||a.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&k(this,ts,ou).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:a,transfer:l}=n,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:a,modifiedIds:s},l).getReader(),h=this._intentStates.get(t);h.streamReader=d;const p=()=>{d.read().then(({value:v,done:_})=>{if(_){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(v,h),p())},v=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const _ of h.renderTasks)_.operatorListChanged();k(this,ts,ou).call(this,!0)}if(h.displayReadyCapability)h.displayReadyCapability.reject(v);else if(h.opListReadCapability)h.opListReadCapability.reject(v);else throw v}})};p()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof Bw){let s=NP;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new go(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,a]of this._intentStates)if(a===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}Za=new WeakMap,Fr=new WeakMap,ts=new WeakSet,ou=function(e=!1){if(k(this,ts,km).call(this),!g(this,Fr)||this.destroyed)return!1;if(e)return C(this,Za,setTimeout(()=>{C(this,Za,null),k(this,ts,ou).call(this,!1)},MP)),!1;for(const{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),C(this,Fr,!1),!0},km=function(){g(this,Za)&&(clearTimeout(g(this,Za)),C(this,Za,null))};var Hr,T0;class BP{constructor(){M(this,Hr,new Map);M(this,T0,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};g(this,T0).then(()=>{for(const[s]of g(this,Hr))s.call(this,n)})}addEventListener(e,t,n=null){let s=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:a}=n;if(a.aborted){Be("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);s=()=>a.removeEventListener("abort",l),a.addEventListener("abort",l)}g(this,Hr).set(t,s)}removeEventListener(e,t){const n=g(this,Hr).get(t);n==null||n(),g(this,Hr).delete(t)}terminate(){for(const[,e]of g(this,Hr))e==null||e();g(this,Hr).clear()}}Hr=new WeakMap,T0=new WeakMap;var C0,Cl,Rl,Ku,Im,Ju,Dm;const xt=class xt{constructor({name:e=null,port:t=null,verbosity:n=wD()}={}){M(this,Ku);var s;if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((s=g(xt,Rl))!=null&&s.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(g(xt,Rl)||C(xt,Rl,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Uh("main","worker",e),this._messageHandler.on("ready",function(){}),k(this,Ku,Im).call(this)}_initialize(){if(g(xt,Cl)||g(xt,Ju,Dm)){this._setupFakeWorker();return}let{workerSrc:e}=xt;try{xt._isSameOrigin(window.location.href,e)||(e=xt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Uh("main","worker",t),s=()=>{a.abort(),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=new AbortController;t.addEventListener("error",()=>{this._webWorker||s()},{signal:a.signal}),n.on("test",c=>{if(a.abort(),this.destroyed||!c){s();return}this._messageHandler=n,this._port=t,this._webWorker=t,k(this,Ku,Im).call(this)}),n.on("ready",c=>{if(a.abort(),this.destroyed){s();return}try{l()}catch{this._setupFakeWorker()}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{F0("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){g(xt,Cl)||(Be("Setting up fake worker."),C(xt,Cl,!0)),xt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new BP;this._port=t;const n=`fake${Un(xt,C0)._++}`,s=new Uh(n+"_worker",n,t);e.setup(s,t),this._messageHandler=new Uh(n,n+"_worker",t),k(this,Ku,Im).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,n;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=g(xt,Rl))==null||t.delete(this._port),this._port=null,(n=this._messageHandler)==null||n.destroy(),this._messageHandler=null}static fromPort(e){var n;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(n=g(this,Rl))==null?void 0:n.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new xt(e)}static get workerSrc(){if(Zr.workerSrc)return Zr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ve(this,"_setupFakeWorkerGlobal",(async()=>g(this,Ju,Dm)?g(this,Ju,Dm):(await import(this.workerSrc)).WorkerMessageHandler)())}};C0=new WeakMap,Cl=new WeakMap,Rl=new WeakMap,Ku=new WeakSet,Im=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Ju=new WeakSet,Dm=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},M(xt,Ju),M(xt,C0,0),M(xt,Cl,!1),M(xt,Rl),Pn&&(C(xt,Cl,!0),Zr.workerSrc||(Zr.workerSrc="./pdf.worker.mjs")),xt._isSameOrigin=(e,t)=>{let n;try{if(n=new URL(e),!n.origin||n.origin==="null")return!1}catch{return!1}const s=new URL(t,n);return n.origin===s.origin},xt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let bu=xt;var Br,Ks,Xu,Wu,Gr,Nl,zh;class GP{constructor(e,t,n,s,a){M(this,Nl);M(this,Br,new Map);M(this,Ks,new Map);M(this,Xu,new Map);M(this,Wu,new Map);M(this,Gr,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new fN,this.fontLoader=new BD({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Ve(this,"annotationStorage",new Vw)}getRenderingIntent(e,t=La.ENABLE,n=null,s=!1,a=!1){let l=ki.DISPLAY,c=g_;switch(e){case"any":l=ki.ANY;break;case"display":break;case"print":l=ki.PRINT;break;default:Be(`getRenderingIntent - invalid intent: ${e}`)}const d=l&ki.PRINT&&n instanceof VR?n:this.annotationStorage;switch(t){case La.DISABLE:l+=ki.ANNOTATIONS_DISABLE;break;case La.ENABLE:break;case La.ENABLE_FORMS:l+=ki.ANNOTATIONS_FORMS;break;case La.ENABLE_STORAGE:l+=ki.ANNOTATIONS_STORAGE,c=d.serializable;break;default:Be(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(l+=ki.IS_EDITING),a&&(l+=ki.OPLIST);const{ids:h,hash:p}=d.modifiedIds,v=[l,c.hash,p];return{renderingIntent:l,cacheKey:v.join("_"),annotationStorageSerializable:c,modifiedIds:h}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=g(this,Gr))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of g(this,Ks).values())e.push(s._destroy());g(this,Ks).clear(),g(this,Xu).clear(),g(this,Wu).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,a;this.commonObjs.clear(),this.fontLoader.clear(),g(this,Br).clear(),this.filterFactory.destroy(),nf.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new go("Worker was terminated.")),(a=this.messageHandler)==null||a.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{Vt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},s.onPull=()=>{this._fullReader.read().then(function({value:a,done:l}){if(l){s.close();return}Vt(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{this._fullReader.cancel(a),s.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async n=>{var c;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:a,contentLength:l}=this._fullReader;return(!s||!a)&&(this._lastProgress&&((c=t.onProgress)==null||c.call(t,this._lastProgress)),this._fullReader.onProgress=d=>{var h;(h=t.onProgress)==null||h.call(t,{loaded:d.loaded,total:d.total})}),{isStreamingSupported:s,isRangeSupported:a,contentLength:l}}),e.on("GetRangeReader",(n,s)=>{Vt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(n.begin,n.end);if(!a){s.close();return}s.onPull=()=>{a.read().then(function({value:l,done:c}){if(c){s.close();return}Vt(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{s.error(l)})},s.onCancel=l=>{a.cancel(l),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new FP(n,this))}),e.on("DocException",n=>{t._capability.reject(ni(n))}),e.on("PasswordRequest",n=>{C(this,Gr,Promise.withResolvers());try{if(!t.onPassword)throw ni(n);const s=a=>{a instanceof Error?g(this,Gr).reject(a):g(this,Gr).resolve({password:a})};t.onPassword(s,n.code)}catch(s){g(this,Gr).reject(s)}return g(this,Gr).promise}),e.on("DataLoaded",n=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;g(this,Ks).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,a])=>{var l;if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":const{disableFontFace:c,fontExtraProperties:d,pdfBug:h}=this._params;if("error"in a){const x=a.error;Be(`Error during font loading: ${x}`),this.commonObjs.resolve(n,x);break}const p=h&&((l=globalThis.FontInspector)!=null&&l.enabled)?(x,A)=>globalThis.FontInspector.fontAdded(x,A):null,v=new GD(a,{disableFontFace:c,fontExtraProperties:d,inspectFont:p});this.fontLoader.bind(v).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!d&&v.data&&(v.data=null),this.commonObjs.resolve(n,v)});break;case"CopyLocalImage":const{imageRef:_}=a;Vt(_,"The imageRef must be defined.");for(const x of g(this,Ks).values())for(const[,A]of x.objs)if((A==null?void 0:A.ref)===_)return A.dataLen?(this.commonObjs.resolve(n,structuredClone(A)),A.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,a);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,a,l])=>{var d;if(this.destroyed)return;const c=g(this,Ks).get(s);if(!c.objs.has(n)){if(c._intentStates.size===0){(d=l==null?void 0:l.bitmap)==null||d.close();return}switch(a){case"Image":c.objs.resolve(n,l),(l==null?void 0:l.dataLen)>mD&&(c._maybeCleanupAfterRender=!0);break;case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${a}`)}}}),e.on("DocProgress",n=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:n.loaded,total:n.total})}),e.on("FetchBuiltInCMap",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)}),e.on("FetchStandardFontData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Be("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=this._fullReader)==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=g(this,Xu).get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&g(this,Wu).set(a.refStr,e);const l=new HP(t,a,this,this._params.pdfBug);return g(this,Ks).set(t,l),l});return g(this,Xu).set(t,s),s}getPageIndex(e){return JT(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return k(this,Nl,zh).call(this,"GetFieldObjects")}hasJSActions(){return k(this,Nl,zh).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return k(this,Nl,zh).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return k(this,Nl,zh).call(this,"GetOptionalContentConfig").then(t=>new cP(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=g(this,Br).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>{var a,l;return{info:s[0],metadata:s[1]?new oP(s[1]):null,contentDispositionFilename:((a=this._fullReader)==null?void 0:a.filename)??null,contentLength:((l=this._fullReader)==null?void 0:l.contentLength)??null}});return g(this,Br).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of g(this,Ks).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),g(this,Br).clear(),this.filterFactory.destroy(!0),nf.cleanup()}}cachedPageNumber(e){if(!JT(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return g(this,Wu).get(t)??null}}Br=new WeakMap,Ks=new WeakMap,Xu=new WeakMap,Wu=new WeakMap,Gr=new WeakMap,Nl=new WeakSet,zh=function(e,t=null){const n=g(this,Br).get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return g(this,Br).set(e,s),s};const Nh=Symbol("INITIAL_DATA");var xi,Zf,C_;class fN{constructor(){M(this,Zf);M(this,xi,Object.create(null))}get(e,t=null){if(t){const s=k(this,Zf,C_).call(this,e);return s.promise.then(()=>t(s.data)),null}const n=g(this,xi)[e];if(!n||n.data===Nh)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=g(this,xi)[e];return!!t&&t.data!==Nh}delete(e){const t=g(this,xi)[e];return!t||t.data===Nh?!1:(delete g(this,xi)[e],!0)}resolve(e,t=null){const n=k(this,Zf,C_).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in g(this,xi)){const{data:n}=g(this,xi)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}C(this,xi,Object.create(null))}*[Symbol.iterator](){for(const e in g(this,xi)){const{data:t}=g(this,xi)[e];t!==Nh&&(yield[e,t])}}}xi=new WeakMap,Zf=new WeakSet,C_=function(e){var t;return(t=g(this,xi))[e]||(t[e]={...Promise.withResolvers(),data:Nh})};var eo;class zP{constructor(e){M(this,eo,null);C(this,eo,e),this.onContinue=null}get promise(){return g(this,eo).capability.promise}cancel(e=0){g(this,eo).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=g(this,eo).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=g(this,eo);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}eo=new WeakMap;var to,Ml;const Xo=class Xo{constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:a,operatorList:l,pageIndex:c,canvasFactory:d,filterFactory:h,useRequestAnimationFrame:p=!1,pdfBug:v=!1,pageColors:_=null}){M(this,to,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=d,this.filterFactory=h,this._pdfBug=v,this.pageColors=_,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new zP(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var c,d;if(this.cancelled)return;if(this._canvas){if(g(Xo,Ml).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");g(Xo,Ml).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:s,transform:a,background:l}=this.params;this.gfx=new vu(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:s,transparency:e,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,(d=this.graphicsReadyCallback)==null||d.call(this)}cancel(e=null,t=0){var n;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),g(this,to)&&(window.cancelAnimationFrame(g(this,to)),C(this,to,null)),g(Xo,Ml).delete(this._canvas),this.callback(e||new Bw(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?C(this,to,window.requestAnimationFrame(()=>{C(this,to,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),g(Xo,Ml).delete(this._canvas),this.callback())))}};to=new WeakMap,Ml=new WeakMap,M(Xo,Ml,new WeakSet);let R_=Xo;const qP="4.10.38",VP="f9bea397f";function XT(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function Mh(i){return Math.max(0,Math.min(255,255*i))}class WT{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Mh(e),[e,e,e]}static G_HTML([e]){const t=XT(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(Mh)}static RGB_HTML(e){return`#${e.map(XT).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[Mh(1-Math.min(1,e+s)),Mh(1-Math.min(1,n+s)),Mh(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,a=1-t,l=1-n,c=Math.min(s,a,l);return["CMYK",s,a,l,c]}}class $P{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){pt("Abstract method `_createSVG` called.")}}class jw extends $P{_createSVG(e){return document.createElementNS(xr,e)}}class pN{static setupStorage(e,t,n,s,a){const l=s.getValue(t,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),a==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?e.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&e.removeAttribute("checked"),a==="print")break;e.addEventListener("change",c=>{s.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),a==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const d=c.target.options,h=d.selectedIndex===-1?"":d[d.selectedIndex].value;s.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:a}){const{attributes:l}=t,c=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${s}`);for(const[d,h]of Object.entries(l))if(h!=null)switch(d){case"class":h.length&&e.setAttribute(d,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!c||d!=="href"&&d!=="newWindow")&&e.setAttribute(d,h)}c&&a.addLinkAttributes(e,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(e,l.dataId,t,n)}static render(e){var v,_;const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,a=e.intent||"display",l=document.createElement(s.name);s.attributes&&this.setAttributes({html:l,element:s,intent:a,linkService:n});const c=a!=="richText",d=e.div;if(d.append(l),e.viewport){const x=`matrix(${e.viewport.transform.join(",")})`;d.style.transform=x}c&&d.setAttribute("class","xfaLayer xfaFont");const h=[];if(s.children.length===0){if(s.value){const x=document.createTextNode(s.value);l.append(x),c&&sf.shouldBuildText(s.name)&&h.push(x)}return{textDivs:h}}const p=[[s,-1,l]];for(;p.length>0;){const[x,A,E]=p.at(-1);if(A+1===x.children.length){p.pop();continue}const R=x.children[++p.at(-1)[1]];if(R===null)continue;const{name:N}=R;if(N==="#text"){const P=document.createTextNode(R.value);h.push(P),E.append(P);continue}const D=(v=R==null?void 0:R.attributes)!=null&&v.xmlns?document.createElementNS(R.attributes.xmlns,N):document.createElement(N);if(E.append(D),R.attributes&&this.setAttributes({html:D,element:R,storage:t,intent:a,linkService:n}),((_=R.children)==null?void 0:_.length)>0)p.push([R,-1,D]);else if(R.value){const P=document.createTextNode(R.value);c&&sf.shouldBuildText(N)&&h.push(P),D.append(P)}}for(const x of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))x.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Up=1e3,jP=9,sc=new WeakSet;function po(i){return{width:i[2]-i[0],height:i[3]-i[1]}}class YP{static create(e){switch(e.data.annotationType){case Yt.LINK:return new gN(e);case Yt.TEXT:return new KP(e);case Yt.WIDGET:switch(e.data.fieldType){case"Tx":return new JP(e);case"Btn":return e.data.radioButton?new vN(e):e.data.checkBox?new WP(e):new QP(e);case"Ch":return new ZP(e);case"Sig":return new XP(e)}return new ac(e);case Yt.POPUP:return new M_(e);case Yt.FREETEXT:return new SN(e);case Yt.LINE:return new tL(e);case Yt.SQUARE:return new nL(e);case Yt.CIRCLE:return new iL(e);case Yt.POLYLINE:return new AN(e);case Yt.CARET:return new rL(e);case Yt.INK:return new Yw(e);case Yt.POLYGON:return new sL(e);case Yt.HIGHLIGHT:return new EN(e);case Yt.UNDERLINE:return new aL(e);case Yt.SQUIGGLY:return new oL(e);case Yt.STRIKEOUT:return new lL(e);case Yt.STAMP:return new TN(e);case Yt.FILEATTACHMENT:return new cL(e);default:return new Ut(e)}}}var kl,Qu,Zu,ep,N_;const vx=class vx{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){M(this,ep);M(this,kl,null);M(this,Qu,!1);M(this,Zu,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e!=null&&e.str||t!=null&&t.str||n!=null&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return vx._hasPopupData(this.data)}updateEdited(e){var n;if(!this.container)return;g(this,kl)||C(this,kl,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&k(this,ep,N_).call(this,t),(n=g(this,Zu))==null||n.popup.updateEdited(e)}resetEdited(){var e;g(this,kl)&&(k(this,ep,N_).call(this,g(this,kl).rect),(e=g(this,Zu))==null||e.popup.resetEdited(),C(this,kl,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",t.id),this instanceof ac||(a.tabIndex=Up);const{style:l}=a;if(l.zIndex=this.parent.zIndex++,t.alternativeText&&(a.title=t.alternativeText),t.noRotate&&a.classList.add("norotate"),!t.rect||this instanceof M_){const{rotation:E}=t;return!t.hasOwnCanvas&&E!==0&&this.setRotation(E,a),a}const{width:c,height:d}=po(t.rect);if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const E=t.borderStyle.horizontalCornerRadius,R=t.borderStyle.verticalCornerRadius;if(E>0||R>0){const D=`calc(${E}px * var(--scale-factor)) / calc(${R}px * var(--scale-factor))`;l.borderRadius=D}else if(this instanceof vN){const D=`calc(${c}px * var(--scale-factor)) / calc(${d}px * var(--scale-factor))`;l.borderRadius=D}switch(t.borderStyle.style){case Ch.SOLID:l.borderStyle="solid";break;case Ch.DASHED:l.borderStyle="dashed";break;case Ch.BEVELED:Be("Unimplemented border style: beveled");break;case Ch.INSET:Be("Unimplemented border style: inset");break;case Ch.UNDERLINE:l.borderBottomStyle="solid";break}const N=t.borderColor||null;N?(C(this,Qu,!0),l.borderColor=xe.makeHexColor(N[0]|0,N[1]|0,N[2]|0)):l.borderWidth=0}const h=xe.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:v,pageX:_,pageY:x}=s.rawDims;l.left=`${100*(h[0]-_)/p}%`,l.top=`${100*(h[1]-x)/v}%`;const{rotation:A}=t;return t.hasOwnCanvas||A===0?(l.width=`${100*c/p}%`,l.height=`${100*d/v}%`):this.setRotation(A,a),a}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims,{width:a,height:l}=po(this.data.rect);let c,d;e%180===0?(c=100*a/n,d=100*l/s):(c=100*l/n,d=100*a/s),t.style.width=`${c}%`,t.style.height=`${d}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const a=s.detail[t],l=a[0],c=a.slice(1);s.target.style[n]=WT[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:WT[`${l}_rgb`](c)})};return Ve(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail)){const a=e[s]||n[s];a==null||a(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,a]of Object.entries(t)){const l=n[s];if(l){const c={detail:{[s]:a},target:e};l(c),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,a]=this.data.rect.map(E=>Math.fround(E));if(e.length===8){const[E,R,N,D]=e.subarray(2,6);if(s===E&&a===R&&t===N&&n===D)return}const{style:l}=this.container;let c;if(g(this,Qu)){const{borderColor:E,borderWidth:R}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${E}" stroke-width="${R}">`],this.container.classList.add("hasBorder")}const d=s-t,h=a-n,{svgFactory:p}=this,v=p.createElement("svg");v.classList.add("quadrilateralsContainer"),v.setAttribute("width",0),v.setAttribute("height",0);const _=p.createElement("defs");v.append(_);const x=p.createElement("clipPath"),A=`clippath_${this.data.id}`;x.setAttribute("id",A),x.setAttribute("clipPathUnits","objectBoundingBox"),_.append(x);for(let E=2,R=e.length;E<R;E+=8){const N=e[E],D=e[E+1],P=e[E+2],L=e[E+3],B=p.createElement("rect"),H=(P-t)/d,O=(a-D)/h,X=(N-P)/d,Y=(D-L)/h;B.setAttribute("x",H),B.setAttribute("y",O),B.setAttribute("width",X),B.setAttribute("height",Y),x.append(B),c==null||c.push(`<rect vector-effect="non-scaling-stroke" x="${H}" y="${O}" width="${X}" height="${Y}"/>`)}g(this,Qu)&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(v),this.container.style.clipPath=`url(#${A})`}_createPopup(){const{data:e}=this,t=C(this,Zu,new M_({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){pt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:a,id:l,exportValues:c}of s){if(a===-1||l===t)continue;const d=typeof c=="string"?c:null,h=document.querySelector(`[data-element-id="${l}"]`);if(h&&!sc.has(h)){Be(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:d,domElement:h})}return n}for(const s of document.getElementsByName(e)){const{exportValue:a}=s,l=s.getAttribute("data-element-id");l!==t&&sc.has(s)&&n.push({id:l,exportValue:a,domElement:s})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};kl=new WeakMap,Qu=new WeakMap,Zu=new WeakMap,ep=new WeakSet,N_=function(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:d}}}}=this;n==null||n.splice(0,4,...e);const{width:h,height:p}=po(e);t.left=`${100*(e[0]-c)/a}%`,t.top=`${100*(l-e[3]+d)/l}%`,s===0?(t.width=`${100*h/a}%`,t.height=`${100*p/l}%`):this.setRotation(s)};let Ut=vx;var Ii,zo,mN,yN;class gN extends Ut{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});M(this,Ii);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let a=!1;return t.url?(n.addLinkAttributes(s,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(s,t.action),a=!0):t.attachment?(k(this,Ii,mN).call(this,s,t.attachment,t.attachmentDest),a=!0):t.setOCGState?(k(this,Ii,yN).call(this,s,t.setOCGState),a=!0):t.dest?(this._bindLink(s,t.dest),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),a=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(s,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&this.container.append(s),this.container}_bindLink(t,n){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&k(this,Ii,zo).call(this)}_bindNamedAction(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),k(this,Ii,zo).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(n.actions)){const l=s.get(a);l&&(t[l]=()=>{var c;return(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:a}}),!1})}t.onclick||(t.onclick=()=>!1),k(this,Ii,zo).call(this)}_bindResetFormAction(t,n){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),k(this,Ii,zo).call(this),!this._fieldObjects){Be('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var v;s==null||s();const{fields:a,refs:l,include:c}=n,d=[];if(a.length!==0||l.length!==0){const _=new Set(l);for(const x of a){const A=this._fieldObjects[x]||[];for(const{id:E}of A)_.add(E)}for(const x of Object.values(this._fieldObjects))for(const A of x)_.has(A.id)===c&&d.push(A)}else for(const _ of Object.values(this._fieldObjects))d.push(..._);const h=this.annotationStorage,p=[];for(const _ of d){const{id:x}=_;switch(p.push(x),_.type){case"text":{const E=_.defaultValue||"";h.setValue(x,{value:E});break}case"checkbox":case"radiobutton":{const E=_.defaultValue===_.exportValues;h.setValue(x,{value:E});break}case"combobox":case"listbox":{const E=_.defaultValue||"";h.setValue(x,{value:E});break}default:continue}const A=document.querySelector(`[data-element-id="${x}"]`);if(A){if(!sc.has(A)){Be(`_bindResetFormAction - element not allowed: ${x}`);continue}}else continue;A.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:p,name:"ResetForm"}})),!1}}}Ii=new WeakSet,zo=function(){this.container.setAttribute("data-internal-link","")},mN=function(t,n,s=null){t.href=this.linkService.getAnchorUrl(""),n.description&&(t.title=n.description),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(n.content,n.filename,s),!1},k(this,Ii,zo).call(this)},yN=function(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),k(this,Ii,zo).call(this)};class KP extends Ut{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class ac extends Ut{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Vn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,a){n.includes("mouse")?e.addEventListener(n,l=>{var c;(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(n,l=>{var c;if(n==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}a&&((c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(l)}}))})}_setEventListeners(e,t,n,s){var a,l,c;for(const[d,h]of n)(h==="Action"||(a=this.data.actions)!=null&&a[h])&&((h==="Focus"||h==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,d,h,s),h==="Focus"&&!((l=this.data.actions)!=null&&l.Blur)?this._setEventListener(e,t,"blur","Blur",null):h==="Blur"&&!((c=this.data.actions)!=null&&c.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":xe.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||jP,a=e.style;let l;const c=2,d=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c),p=Math.round(h/(Eb*s))||1,v=h/p;l=Math.min(s,d(v/Eb))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(s,d(h/Eb))}a.fontSize=`calc(${l}px * var(--scale-factor))`,a.color=xe.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(a.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class JP extends ac{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const a=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=n),a.setValue(l.id,{[s]:n})}render(){var s,a;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const l=e.getValue(t,{value:this.data.fieldValue});let c=l.value||"";const d=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;d&&c.length>d&&(c=c.slice(0,d));let h=l.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const p={userValue:c,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=h??c,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",h??c),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),sc.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=Up,this._setRequired(n,this.data.required),d&&(n.maxLength=d),n.addEventListener("input",_=>{e.setValue(t,{value:_.target.value}),this.setPropertyOnSiblings(n,"value",_.target.value,"value"),p.formattedValue=null}),n.addEventListener("resetform",_=>{const x=this.data.defaultFieldValue??"";n.value=p.userValue=x,p.formattedValue=null});let v=_=>{const{formattedValue:x}=p;x!=null&&(_.target.value=x),_.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",x=>{var E;if(p.focused)return;const{target:A}=x;p.userValue&&(A.value=p.userValue),p.lastCommittedValue=A.value,p.commitKey=1,(E=this.data.actions)!=null&&E.Focus||(p.focused=!0)}),n.addEventListener("updatefromsandbox",x=>{this.showElementAndHideCanvas(x.target);const A={value(E){p.userValue=E.detail.value??"",e.setValue(t,{value:p.userValue.toString()}),E.target.value=p.userValue},formattedValue(E){const{formattedValue:R}=E.detail;p.formattedValue=R,R!=null&&E.target!==document.activeElement&&(E.target.value=R),e.setValue(t,{formattedValue:R})},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{var P;const{charLimit:R}=E.detail,{target:N}=E;if(R===0){N.removeAttribute("maxLength");return}N.setAttribute("maxLength",R);let D=p.userValue;!D||D.length<=R||(D=D.slice(0,R),N.value=p.userValue=D,e.setValue(t,{value:D}),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:D,willCommit:!0,commitKey:1,selStart:N.selectionStart,selEnd:N.selectionEnd}}))}};this._dispatchEventFromSandbox(A,x)}),n.addEventListener("keydown",x=>{var R;p.commitKey=1;let A=-1;if(x.key==="Escape"?A=0:x.key==="Enter"&&!this.data.multiLine?A=2:x.key==="Tab"&&(p.commitKey=3),A===-1)return;const{value:E}=x.target;p.lastCommittedValue!==E&&(p.lastCommittedValue=E,p.userValue=E,(R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:A,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}))});const _=v;v=null,n.addEventListener("blur",x=>{var E,R;if(!p.focused||!x.relatedTarget)return;(E=this.data.actions)!=null&&E.Blur||(p.focused=!1);const{value:A}=x.target;p.userValue=A,p.lastCommittedValue!==A&&((R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:p.commitKey,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}})),_(x)}),(a=this.data.actions)!=null&&a.Keystroke&&n.addEventListener("beforeinput",x=>{var B;p.lastCommittedValue=null;const{data:A,target:E}=x,{value:R,selectionStart:N,selectionEnd:D}=E;let P=N,L=D;switch(x.inputType){case"deleteWordBackward":{const H=R.substring(0,N).match(/\w*[^\w]*$/);H&&(P-=H[0].length);break}case"deleteWordForward":{const H=R.substring(N).match(/^[^\w]*\w*/);H&&(L+=H[0].length);break}case"deleteContentBackward":N===D&&(P-=1);break;case"deleteContentForward":N===D&&(L+=1);break}x.preventDefault(),(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:R,change:A||"",willCommit:!1,selStart:P,selEnd:L}})}),this._setEventListeners(n,p,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],x=>x.target.value)}if(v&&n.addEventListener("blur",v),this.data.comb){const x=(this.data.rect[2]-this.data.rect[0])/d;n.classList.add("comb"),n.style.letterSpacing=`calc(${x}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class XP extends ac{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class WP extends ac{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return sc.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,s&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=Up,a.addEventListener("change",l=>{const{name:c,checked:d}=l.target;for(const h of this._getElementsByName(c,n)){const p=d&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=p),e.setValue(h.id,{value:p})}e.setValue(n,{value:d})}),a.addEventListener("resetform",l=>{const c=t.defaultFieldValue||"Off";l.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",l=>{const c={value(d){d.target.checked=d.detail.value!=="Off",e.setValue(n,{value:d.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class vN extends ac{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const l of this._getElementsByName(t.fieldName,n))e.setValue(l.id,{value:!1});const a=document.createElement("input");if(sc.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,s&&a.setAttribute("checked",!0),a.tabIndex=Up,a.addEventListener("change",l=>{const{name:c,checked:d}=l.target;for(const h of this._getElementsByName(c,n))e.setValue(h.id,{value:!1});e.setValue(n,{value:d})}),a.addEventListener("resetform",l=>{const c=t.defaultFieldValue;l.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;a.addEventListener("updatefromsandbox",c=>{const d={value:h=>{const p=l===h.detail.value;for(const v of this._getElementsByName(h.target.name)){const _=p&&v.id===n;v.domElement&&(v.domElement.checked=_),e.setValue(v.id,{value:_})}}};this._dispatchEventFromSandbox(d,c)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class QP extends gN{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class ZP extends ac{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");sc.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=Up;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",p=>{const v=this.data.defaultFieldValue;for(const _ of s.options)_.selected=_.value===v});for(const p of this.data.options){const v=document.createElement("option");v.textContent=p.displayValue,v.value=p.exportValue,n.value.includes(p.exportValue)&&(v.setAttribute("selected",!0),a=!1),s.append(v)}let l=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),s.prepend(p),l=()=>{p.remove(),s.removeEventListener("input",l),l=null},s.addEventListener("input",l)}const c=p=>{const v=p?"value":"textContent",{options:_,multiple:x}=s;return x?Array.prototype.filter.call(_,A=>A.selected).map(A=>A[v]):_.selectedIndex===-1?null:_[_.selectedIndex][v]};let d=c(!1);const h=p=>{const v=p.target.options;return Array.prototype.map.call(v,_=>({displayValue:_.textContent,exportValue:_.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",p=>{const v={value(_){l==null||l();const x=_.detail.value,A=new Set(Array.isArray(x)?x:[x]);for(const E of s.options)E.selected=A.has(E.value);e.setValue(t,{value:c(!0)}),d=c(!1)},multipleSelection(_){s.multiple=!0},remove(_){const x=s.options,A=_.detail.remove;x[A].selected=!1,s.remove(A),x.length>0&&Array.prototype.findIndex.call(x,R=>R.selected)===-1&&(x[0].selected=!0),e.setValue(t,{value:c(!0),items:h(_)}),d=c(!1)},clear(_){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),d=c(!1)},insert(_){const{index:x,displayValue:A,exportValue:E}=_.detail.insert,R=s.children[x],N=document.createElement("option");N.textContent=A,N.value=E,R?R.before(N):s.append(N),e.setValue(t,{value:c(!0),items:h(_)}),d=c(!1)},items(_){const{items:x}=_.detail;for(;s.length!==0;)s.remove(0);for(const A of x){const{displayValue:E,exportValue:R}=A,N=document.createElement("option");N.textContent=E,N.value=R,s.append(N)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:c(!0),items:h(_)}),d=c(!1)},indices(_){const x=new Set(_.detail.indices);for(const A of _.target.options)A.selected=x.has(A.index);e.setValue(t,{value:c(!0)}),d=c(!1)},editable(_){_.target.disabled=!_.detail.editable}};this._dispatchEventFromSandbox(v,p)}),s.addEventListener("input",p=>{var x;const v=c(!0),_=c(!1);e.setValue(t,{value:v}),p.preventDefault(),(x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:d,change:_,changeEx:v,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):s.addEventListener("input",function(p){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class M_ extends Ut{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:Ut._hasPopupData(t)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new eL({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(n=>`${Hw}${n}`).join(",")),this.container}}var ed,R0,N0,td,Il,It,zr,nd,tp,np,id,qr,ys,Vr,ip,$r,sp,Dl,Pl,ht,Pm,k_,bN,_N,wN,xN,Lm,Om,I_;class eL{constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:a,contentsObj:l,richText:c,parent:d,rect:h,parentRect:p,open:v}){M(this,ht);M(this,ed,k(this,ht,wN).bind(this));M(this,R0,k(this,ht,I_).bind(this));M(this,N0,k(this,ht,Om).bind(this));M(this,td,k(this,ht,Lm).bind(this));M(this,Il,null);M(this,It,null);M(this,zr,null);M(this,nd,null);M(this,tp,null);M(this,np,null);M(this,id,null);M(this,qr,!1);M(this,ys,null);M(this,Vr,null);M(this,ip,null);M(this,$r,null);M(this,sp,null);M(this,Dl,null);M(this,Pl,!1);var _;C(this,It,e),C(this,sp,s),C(this,zr,l),C(this,$r,c),C(this,np,d),C(this,Il,t),C(this,ip,h),C(this,id,p),C(this,tp,n),C(this,nd,zw.toDateObject(a)),this.trigger=n.flatMap(x=>x.getElementsToTriggerPopup());for(const x of this.trigger)x.addEventListener("click",g(this,td)),x.addEventListener("mouseenter",g(this,N0)),x.addEventListener("mouseleave",g(this,R0)),x.classList.add("popupTriggerArea");for(const x of n)(_=x.container)==null||_.addEventListener("keydown",g(this,ed));g(this,It).hidden=!0,v&&k(this,ht,Lm).call(this)}render(){if(g(this,ys))return;const e=C(this,ys,document.createElement("div"));if(e.className="popup",g(this,Il)){const a=e.style.outlineColor=xe.makeHexColor(...g(this,Il));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${a} 30%, white)`:e.style.backgroundColor=xe.makeHexColor(...g(this,Il).map(c=>Math.floor(.7*(255-c)+c)))}const t=document.createElement("span");t.className="header";const n=document.createElement("h1");if(t.append(n),{dir:n.dir,str:n.textContent}=g(this,sp),e.append(t),g(this,nd)){const a=document.createElement("span");a.classList.add("popupDate"),a.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),a.setAttribute("data-l10n-args",JSON.stringify({dateObj:g(this,nd).valueOf()})),t.append(a)}const s=g(this,ht,Pm);if(s)pN.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const a=this._formatContents(g(this,zr));e.append(a)}g(this,It).append(e)}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let a=0,l=s.length;a<l;++a){const c=s[a];n.append(document.createTextNode(c)),a<l-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:e,popupContent:t}){var n;g(this,Dl)||C(this,Dl,{contentsObj:g(this,zr),richText:g(this,$r)}),e&&C(this,Vr,null),t&&(C(this,$r,k(this,ht,_N).call(this,t)),C(this,zr,null)),(n=g(this,ys))==null||n.remove(),C(this,ys,null)}resetEdited(){var e;g(this,Dl)&&({contentsObj:Un(this,zr)._,richText:Un(this,$r)._}=g(this,Dl),C(this,Dl,null),(e=g(this,ys))==null||e.remove(),C(this,ys,null),C(this,Vr,null))}forceHide(){C(this,Pl,this.isVisible),g(this,Pl)&&(g(this,It).hidden=!0)}maybeShow(){g(this,Pl)&&(g(this,ys)||k(this,ht,Om).call(this),C(this,Pl,!1),g(this,It).hidden=!1)}get isVisible(){return g(this,It).hidden===!1}}ed=new WeakMap,R0=new WeakMap,N0=new WeakMap,td=new WeakMap,Il=new WeakMap,It=new WeakMap,zr=new WeakMap,nd=new WeakMap,tp=new WeakMap,np=new WeakMap,id=new WeakMap,qr=new WeakMap,ys=new WeakMap,Vr=new WeakMap,ip=new WeakMap,$r=new WeakMap,sp=new WeakMap,Dl=new WeakMap,Pl=new WeakMap,ht=new WeakSet,Pm=function(){const e=g(this,$r),t=g(this,zr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&g(this,$r).html||null},k_=function(){var e,t,n;return((n=(t=(e=g(this,ht,Pm))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},bN=function(){var e,t,n;return((n=(t=(e=g(this,ht,Pm))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},_N=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:g(this,ht,bN),fontSize:g(this,ht,k_)?`calc(${g(this,ht,k_)}px * var(--scale-factor))`:""}};for(const a of e.split(`
`))t.push({name:"span",value:a,attributes:s});return n},wN=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&g(this,qr))&&k(this,ht,Lm).call(this)},xN=function(){if(g(this,Vr)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:a}}}=g(this,np);let l=!!g(this,id),c=l?g(this,id):g(this,ip);for(const A of g(this,tp))if(!c||xe.intersect(A.data.rect,c)!==null){c=A.data.rect,l=!0;break}const d=xe.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),p=l?c[2]-c[0]+5:0,v=d[0]+p,_=d[1];C(this,Vr,[100*(v-s)/t,100*(_-a)/n]);const{style:x}=g(this,It);x.left=`${g(this,Vr)[0]}%`,x.top=`${g(this,Vr)[1]}%`},Lm=function(){C(this,qr,!g(this,qr)),g(this,qr)?(k(this,ht,Om).call(this),g(this,It).addEventListener("click",g(this,td)),g(this,It).addEventListener("keydown",g(this,ed))):(k(this,ht,I_).call(this),g(this,It).removeEventListener("click",g(this,td)),g(this,It).removeEventListener("keydown",g(this,ed)))},Om=function(){g(this,ys)||this.render(),this.isVisible?g(this,qr)&&g(this,It).classList.add("focused"):(k(this,ht,xN).call(this),g(this,It).hidden=!1,g(this,It).style.zIndex=parseInt(g(this,It).style.zIndex)+1e3)},I_=function(){g(this,It).classList.remove("focused"),!(g(this,qr)||!this.isVisible)&&(g(this,It).hidden=!0,g(this,It).style.zIndex=parseInt(g(this,It).style.zIndex)-1e3)};class SN extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=He.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var rp;class tL extends Ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});M(this,rp,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:n,height:s}=po(t.rect),a=this.svgFactory.create(n,s,!0),l=C(this,rp,this.svgFactory.createElement("svg:line"));return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,rp)}addHighlightArea(){this.container.classList.add("highlightArea")}}rp=new WeakMap;var ap;class nL extends Ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});M(this,ap,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:n,height:s}=po(t.rect),a=this.svgFactory.create(n,s,!0),l=t.borderStyle.width,c=C(this,ap,this.svgFactory.createElement("svg:rect"));return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",n-l),c.setAttribute("height",s-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,ap)}addHighlightArea(){this.container.classList.add("highlightArea")}}ap=new WeakMap;var op;class iL extends Ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});M(this,op,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:n,height:s}=po(t.rect),a=this.svgFactory.create(n,s,!0),l=t.borderStyle.width,c=C(this,op,this.svgFactory.createElement("svg:ellipse"));return c.setAttribute("cx",n/2),c.setAttribute("cy",s/2),c.setAttribute("rx",n/2-l/2),c.setAttribute("ry",s/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,op)}addHighlightArea(){this.container.classList.add("highlightArea")}}op=new WeakMap;var lp;class AN extends Ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});M(this,lp,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:s,popupRef:a}}=this;if(!n)return this.container;const{width:l,height:c}=po(t),d=this.svgFactory.create(l,c,!0);let h=[];for(let v=0,_=n.length;v<_;v+=2){const x=n[v]-t[0],A=t[3]-n[v+1];h.push(`${x},${A}`)}h=h.join(" ");const p=C(this,lp,this.svgFactory.createElement(this.svgElementName));return p.setAttribute("points",h),p.setAttribute("stroke-width",s.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),d.append(p),this.container.append(d),!a&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,lp)}addHighlightArea(){this.container.classList.add("highlightArea")}}lp=new WeakMap;class sL extends AN{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class rL extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var cp,Ll,up,D_;class Yw extends Ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});M(this,up);M(this,cp,null);M(this,Ll,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?He.HIGHLIGHT:He.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:s,borderStyle:a,popupRef:l}}=this,{transform:c,width:d,height:h}=k(this,up,D_).call(this,n,t),p=this.svgFactory.create(d,h,!0),v=C(this,cp,this.svgFactory.createElement("svg:g"));p.append(v),v.setAttribute("stroke-width",a.width||1),v.setAttribute("stroke-linecap","round"),v.setAttribute("stroke-linejoin","round"),v.setAttribute("stroke-miterlimit",10),v.setAttribute("stroke","transparent"),v.setAttribute("fill","transparent"),v.setAttribute("transform",c);for(let _=0,x=s.length;_<x;_++){const A=this.svgFactory.createElement(this.svgElementName);g(this,Ll).push(A),A.setAttribute("points",s[_].join(",")),v.append(A)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(p),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:s,rect:a}=t,l=g(this,cp);if(n>=0&&l.setAttribute("stroke-width",n||1),s)for(let c=0,d=g(this,Ll).length;c<d;c++)g(this,Ll)[c].setAttribute("points",s[c].join(","));if(a){const{transform:c,width:d,height:h}=k(this,up,D_).call(this,this.data.rotation,a);l.parentElement.setAttribute("viewBox",`0 0 ${d} ${h}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return g(this,Ll)}addHighlightArea(){this.container.classList.add("highlightArea")}}cp=new WeakMap,Ll=new WeakMap,up=new WeakSet,D_=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class EN extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=He.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class aL extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class oL extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class lL extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class TN extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=He.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var dp,hp,P_;class cL extends Ut{constructor(t){var s;super(t,{isRenderable:!0});M(this,hp);M(this,dp,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let s;n.hasAppearance||n.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),s.addEventListener("dblclick",k(this,hp,P_).bind(this)),C(this,dp,s);const{isMac:a}=Vn.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(a?l.metaKey:l.ctrlKey)&&k(this,hp,P_).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return g(this,dp)}addHighlightArea(){this.container.classList.add("highlightArea")}}dp=new WeakMap,hp=new WeakSet,P_=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var fp,Ol,Ul,pp,rc,CN,L_;class uL{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:a,viewport:l,structTreeLayer:c}){M(this,rc);M(this,fp,null);M(this,Ol,null);M(this,Ul,new Map);M(this,pp,null);this.div=e,C(this,fp,t),C(this,Ol,n),C(this,pp,c||null),this.page=a,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return g(this,Ul).size>0}async render(e){var l;const{annotations:t}=e,n=this.div;nc(n,this.viewport);const s=new Map,a={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new jw,annotationStorage:e.annotationStorage||new Vw,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const d=c.annotationType===Yt.POPUP;if(d){const v=s.get(c.id);if(!v)continue;a.elements=v}else{const{width:v,height:_}=po(c.rect);if(v<=0||_<=0)continue}a.data=c;const h=YP.create(a);if(!h.isRenderable)continue;if(!d&&c.popupRef){const v=s.get(c.popupRef);v?v.push(h):s.set(c.popupRef,[h])}const p=h.render();c.hidden&&(p.style.visibility="hidden"),await k(this,rc,CN).call(this,p,c.id),h._isEditable&&(g(this,Ul).set(h.data.id,h),(l=this._annotationEditorUIManager)==null||l.renderAnnotationElement(h))}k(this,rc,L_).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,nc(t,{rotation:e.rotation}),k(this,rc,L_).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(g(this,Ul).values())}getEditableAnnotation(e){return g(this,Ul).get(e)}}fp=new WeakMap,Ol=new WeakMap,Ul=new WeakMap,pp=new WeakMap,rc=new WeakSet,CN=async function(e,t){var l,c;const n=e.firstChild||e,s=n.id=`${Hw}${t}`,a=await((l=g(this,pp))==null?void 0:l.getAriaAttributes(s));if(a)for(const[d,h]of a)n.setAttribute(d,h);this.div.append(e),(c=g(this,fp))==null||c.moveElementInDOM(this.div,e,n,!1)},L_=function(){if(!g(this,Ol))return;const e=this.div;for(const[t,n]of g(this,Ol)){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):s.append(n)}g(this,Ol).clear()};const om=/\r\n?|\n/g;var vs,Si,gp,Fl,Ai,$t,RN,NN,MN,Um,ta,Fm,Hm,kN,U_,IN;const mt=class mt extends Rt{constructor(t){super({...t,name:"freeTextEditor"});M(this,$t);M(this,vs);M(this,Si,"");M(this,gp,`${this.id}-editor`);M(this,Fl,null);M(this,Ai);C(this,vs,t.color||mt._defaultColor||Rt._defaultLineColor),C(this,Ai,t.fontSize||mt._defaultFontSize)}static get _keyboardManager(){const t=mt.prototype,n=l=>l.isEmpty(),s=ic.TRANSLATE_SMALL,a=ic.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new Op([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:n}]]))}static initialize(t,n){Rt.initialize(t,n);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case Xe.FREETEXT_SIZE:mt._defaultFontSize=n;break;case Xe.FREETEXT_COLOR:mt._defaultColor=n;break}}updateParams(t,n){switch(t){case Xe.FREETEXT_SIZE:k(this,$t,RN).call(this,n);break;case Xe.FREETEXT_COLOR:k(this,$t,NN).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Xe.FREETEXT_SIZE,mt._defaultFontSize],[Xe.FREETEXT_COLOR,mt._defaultColor||Rt._defaultLineColor]]}get propertiesToUpdate(){return[[Xe.FREETEXT_SIZE,g(this,Ai)],[Xe.FREETEXT_COLOR,g(this,vs)]]}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-mt._internalPadding*t,-(mt._internalPadding+g(this,Ai))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(He.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),C(this,Fl,new AbortController);const t=this._uiManager.combinedSignal(g(this,Fl));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",g(this,gp)),this._isDraggable=!0,(t=g(this,Fl))==null||t.abort(),C(this,Fl,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=g(this,Si),n=C(this,Si,k(this,$t,MN).call(this).trimEnd());if(t===n)return;const s=a=>{if(C(this,Si,a),!a){this.remove();return}k(this,$t,Hm).call(this),this._uiManager.rebuild(this),k(this,$t,Um).call(this)};this.addCommands({cmd:()=>{s(n)},undo:()=>{s(t)},mustExec:!1}),k(this,$t,Um).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){mt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,n;this.width&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",g(this,gp)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${g(this,Ai)}px * var(--scale-factor))`,s.color=g(this,vs),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Qm(this,this.div,["dblclick","keydown"]),this.width){const[a,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[d,h]=this.getInitialTranslation();[d,h]=this.pageTranslationToScreen(d,h);const[p,v]=this.pageDimensions,[_,x]=this.pageTranslation;let A,E;switch(this.rotation){case 0:A=t+(c[0]-_)/p,E=n+this.height-(c[1]-x)/v;break;case 90:A=t+(c[0]-_)/p,E=n-(c[1]-x)/v,[d,h]=[h,-d];break;case 180:A=t-this.width+(c[0]-_)/p,E=n-(c[1]-x)/v,[d,h]=[-d,-h];break;case 270:A=t+(c[0]-_-this.height*v)/p,E=n+(c[1]-x-this.width*p)/v,[d,h]=[-h,d];break}this.setAt(A*a,E*l,d,h)}else this.setAt(t*a,n*l,this.width*a,this.height*l);k(this,$t,Hm).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var A,E,R;const n=t.clipboardData||window.clipboardData,{types:s}=n;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const a=k(A=mt,ta,U_).call(A,n.getData("text")||"").replaceAll(om,`
`);if(!a)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!a.includes(`
`)){c.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:d,startOffset:h}=c,p=[],v=[];if(d.nodeType===Node.TEXT_NODE){const N=d.parentElement;if(v.push(d.nodeValue.slice(h).replaceAll(om,"")),N!==this.editorDiv){let D=p;for(const P of this.editorDiv.childNodes){if(P===N){D=v;continue}D.push(k(E=mt,ta,Fm).call(E,P))}}p.push(d.nodeValue.slice(0,h).replaceAll(om,""))}else if(d===this.editorDiv){let N=p,D=0;for(const P of this.editorDiv.childNodes)D++===h&&(N=v),N.push(k(R=mt,ta,Fm).call(R,P))}C(this,Si,`${p.join(`
`)}${a}${v.join(`
`)}`),k(this,$t,Hm).call(this);const _=new Range;let x=p.reduce((N,D)=>N+D.length,0);for(const{firstChild:N}of this.editorDiv.childNodes)if(N.nodeType===Node.TEXT_NODE){const D=N.nodeValue.length;if(x<=D){_.setStart(N,x),_.setEnd(N,x);break}x-=D}l.removeAllRanges(),l.addRange(_)}get contentDiv(){return this.editorDiv}static async deserialize(t,n,s){var c;let a=null;if(t instanceof SN){const{data:{defaultAppearanceData:{fontSize:d,fontColor:h},rect:p,rotation:v,id:_,popupRef:x},textContent:A,textPosition:E,parent:{page:{pageNumber:R}}}=t;if(!A||A.length===0)return null;a=t={annotationType:He.FREETEXT,color:Array.from(h),fontSize:d,value:A.join(`
`),position:E,pageIndex:R-1,rect:p.slice(0),rotation:v,id:_,deleted:!1,popupRef:x}}const l=await super.deserialize(t,n,s);return C(l,Ai,t.fontSize),C(l,vs,xe.makeHexColor(...t.color)),C(l,Si,k(c=mt,ta,U_).call(c,t.value)),l.annotationElementId=t.id||null,l._initialData=a,l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=mt._internalPadding*this.parentScale,s=this.getRect(n,n),a=Rt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:g(this,vs)),l={annotationType:He.FREETEXT,color:a,fontSize:g(this,Ai),value:k(this,$t,kN).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?l:this.annotationElementId&&!k(this,$t,IN).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(this.deleted)return n;const{style:s}=n;s.fontSize=`calc(${g(this,Ai)}px * var(--scale-factor))`,s.color=g(this,vs),n.replaceChildren();for(const l of g(this,Si).split(`
`)){const c=document.createElement("div");c.append(l?document.createTextNode(l):document.createElement("br")),n.append(c)}const a=mt._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(a,a),popupContent:g(this,Si)}),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};vs=new WeakMap,Si=new WeakMap,gp=new WeakMap,Fl=new WeakMap,Ai=new WeakMap,$t=new WeakSet,RN=function(t){const n=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--scale-factor))`,this.translate(0,-(a-g(this,Ai))*this.parentScale),C(this,Ai,a),k(this,$t,Um).call(this)},s=g(this,Ai);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},NN=function(t){const n=a=>{C(this,vs,this.editorDiv.style.color=a)},s=g(this,vs);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},MN=function(){var s;const t=[];this.editorDiv.normalize();let n=null;for(const a of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&a.nodeName==="BR"||(t.push(k(s=mt,ta,Fm).call(s,a)),n=a);return t.join(`
`)},Um=function(){const[t,n]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:a,div:l}=this,c=l.style.display,d=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",a.div.append(this.div),s=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",d)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/n):(this.width=s.height/t,this.height=s.width/n),this.fixAndSetPosition()},ta=new WeakSet,Fm=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(om,"")},Hm=function(){if(this.editorDiv.replaceChildren(),!!g(this,Si))for(const t of g(this,Si).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},kN=function(){return g(this,Si).replaceAll(""," ")},U_=function(t){return t.replaceAll(" ","")},IN=function(t){const{value:n,fontSize:s,color:a,pageIndex:l}=this._initialData;return this._hasBeenMoved||t.value!==n||t.fontSize!==s||t.color.some((c,d)=>c!==a[d])||t.pageIndex!==l},M(mt,ta),Re(mt,"_freeTextDefaultContent",""),Re(mt,"_internalPadding",0),Re(mt,"_defaultColor",null),Re(mt,"_defaultFontSize",10),Re(mt,"_type","freetext"),Re(mt,"_editorType",He.FREETEXT);let O_=mt;class fe{toSVGPath(){pt("Abstract method `toSVGPath` must be implemented.")}get box(){pt("Abstract getter `box` must be implemented.")}serialize(e,t){pt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,a,l){l||(l=new Float32Array(e.length));for(let c=0,d=e.length;c<d;c+=2)l[c]=t+e[c]*s,l[c+1]=n+e[c+1]*a;return l}static _rescaleAndSwap(e,t,n,s,a,l){l||(l=new Float32Array(e.length));for(let c=0,d=e.length;c<d;c+=2)l[c]=t+e[c+1]*s,l[c+1]=n+e[c]*a;return l}static _translate(e,t,n,s){s||(s=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)s[a]=t+e[a],s[a+1]=n+e[a+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,s,a){switch(a){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,a,l){return[(e+5*n)/6,(t+5*s)/6,(5*n+a)/6,(5*s+l)/6,(n+a)/2,(s+l)/2]}}Re(fe,"PRECISION",1e-4);var Ei,bs,sd,rd,Js,qe,Hl,Bl,mp,yp,ad,od,no,vp,M0,k0,en,qh,DN,PN,LN,ON,UN,FN;const Cr=class Cr{constructor({x:e,y:t},n,s,a,l,c=0){M(this,en);M(this,Ei);M(this,bs,[]);M(this,sd);M(this,rd);M(this,Js,[]);M(this,qe,new Float32Array(18));M(this,Hl);M(this,Bl);M(this,mp);M(this,yp);M(this,ad);M(this,od);M(this,no,[]);C(this,Ei,n),C(this,od,a*s),C(this,rd,l),g(this,qe).set([NaN,NaN,NaN,NaN,e,t],6),C(this,sd,c),C(this,yp,g(Cr,vp)*s),C(this,mp,g(Cr,k0)*s),C(this,ad,s),g(this,no).push(e,t)}isEmpty(){return isNaN(g(this,qe)[8])}add({x:e,y:t}){var Y;C(this,Hl,e),C(this,Bl,t);const[n,s,a,l]=g(this,Ei);let[c,d,h,p]=g(this,qe).subarray(8,12);const v=e-h,_=t-p,x=Math.hypot(v,_);if(x<g(this,mp))return!1;const A=x-g(this,yp),E=A/x,R=E*v,N=E*_;let D=c,P=d;c=h,d=p,h+=R,p+=N,(Y=g(this,no))==null||Y.push(e,t);const L=-N/A,B=R/A,H=L*g(this,od),O=B*g(this,od);return g(this,qe).set(g(this,qe).subarray(2,8),0),g(this,qe).set([h+H,p+O],4),g(this,qe).set(g(this,qe).subarray(14,18),12),g(this,qe).set([h-H,p-O],16),isNaN(g(this,qe)[6])?(g(this,Js).length===0&&(g(this,qe).set([c+H,d+O],2),g(this,Js).push(NaN,NaN,NaN,NaN,(c+H-n)/a,(d+O-s)/l),g(this,qe).set([c-H,d-O],14),g(this,bs).push(NaN,NaN,NaN,NaN,(c-H-n)/a,(d-O-s)/l)),g(this,qe).set([D,P,c,d,h,p],6),!this.isEmpty()):(g(this,qe).set([D,P,c,d,h,p],6),Math.abs(Math.atan2(P-d,D-c)-Math.atan2(N,R))<Math.PI/2?([c,d,h,p]=g(this,qe).subarray(2,6),g(this,Js).push(NaN,NaN,NaN,NaN,((c+h)/2-n)/a,((d+p)/2-s)/l),[c,d,D,P]=g(this,qe).subarray(14,18),g(this,bs).push(NaN,NaN,NaN,NaN,((D+c)/2-n)/a,((P+d)/2-s)/l),!0):([D,P,c,d,h,p]=g(this,qe).subarray(0,6),g(this,Js).push(((D+5*c)/6-n)/a,((P+5*d)/6-s)/l,((5*c+h)/6-n)/a,((5*d+p)/6-s)/l,((c+h)/2-n)/a,((d+p)/2-s)/l),[h,p,c,d,D,P]=g(this,qe).subarray(12,18),g(this,bs).push(((D+5*c)/6-n)/a,((P+5*d)/6-s)/l,((5*c+h)/6-n)/a,((5*d+p)/6-s)/l,((c+h)/2-n)/a,((d+p)/2-s)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=g(this,Js),t=g(this,bs);if(isNaN(g(this,qe)[6])&&!this.isEmpty())return k(this,en,DN).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);k(this,en,LN).call(this,n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return k(this,en,PN).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,s,a,l){return new HN(e,t,n,s,a,l)}getOutlines(){var v;const e=g(this,Js),t=g(this,bs),n=g(this,qe),[s,a,l,c]=g(this,Ei),d=new Float32Array((((v=g(this,no))==null?void 0:v.length)??0)+2);for(let _=0,x=d.length-2;_<x;_+=2)d[_]=(g(this,no)[_]-s)/l,d[_+1]=(g(this,no)[_+1]-a)/c;if(d[d.length-2]=(g(this,Hl)-s)/l,d[d.length-1]=(g(this,Bl)-a)/c,isNaN(n[6])&&!this.isEmpty())return k(this,en,ON).call(this,d);const h=new Float32Array(g(this,Js).length+24+g(this,bs).length);let p=e.length;for(let _=0;_<p;_+=2){if(isNaN(e[_])){h[_]=h[_+1]=NaN;continue}h[_]=e[_],h[_+1]=e[_+1]}p=k(this,en,FN).call(this,h,p);for(let _=t.length-6;_>=6;_-=6)for(let x=0;x<6;x+=2){if(isNaN(t[_+x])){h[p]=h[p+1]=NaN,p+=2;continue}h[p]=t[_+x],h[p+1]=t[_+x+1],p+=2}return k(this,en,UN).call(this,h,p),this.newFreeDrawOutline(h,d,g(this,Ei),g(this,ad),g(this,sd),g(this,rd))}};Ei=new WeakMap,bs=new WeakMap,sd=new WeakMap,rd=new WeakMap,Js=new WeakMap,qe=new WeakMap,Hl=new WeakMap,Bl=new WeakMap,mp=new WeakMap,yp=new WeakMap,ad=new WeakMap,od=new WeakMap,no=new WeakMap,vp=new WeakMap,M0=new WeakMap,k0=new WeakMap,en=new WeakSet,qh=function(){const e=g(this,qe).subarray(4,6),t=g(this,qe).subarray(16,18),[n,s,a,l]=g(this,Ei);return[(g(this,Hl)+(e[0]-t[0])/2-n)/a,(g(this,Bl)+(e[1]-t[1])/2-s)/l,(g(this,Hl)+(t[0]-e[0])/2-n)/a,(g(this,Bl)+(t[1]-e[1])/2-s)/l]},DN=function(){const[e,t,n,s]=g(this,Ei),[a,l,c,d]=k(this,en,qh).call(this);return`M${(g(this,qe)[2]-e)/n} ${(g(this,qe)[3]-t)/s} L${(g(this,qe)[4]-e)/n} ${(g(this,qe)[5]-t)/s} L${a} ${l} L${c} ${d} L${(g(this,qe)[16]-e)/n} ${(g(this,qe)[17]-t)/s} L${(g(this,qe)[14]-e)/n} ${(g(this,qe)[15]-t)/s} Z`},PN=function(e){const t=g(this,bs);e.push(`L${t[4]} ${t[5]} Z`)},LN=function(e){const[t,n,s,a]=g(this,Ei),l=g(this,qe).subarray(4,6),c=g(this,qe).subarray(16,18),[d,h,p,v]=k(this,en,qh).call(this);e.push(`L${(l[0]-t)/s} ${(l[1]-n)/a} L${d} ${h} L${p} ${v} L${(c[0]-t)/s} ${(c[1]-n)/a}`)},ON=function(e){const t=g(this,qe),[n,s,a,l]=g(this,Ei),[c,d,h,p]=k(this,en,qh).call(this),v=new Float32Array(36);return v.set([NaN,NaN,NaN,NaN,(t[2]-n)/a,(t[3]-s)/l,NaN,NaN,NaN,NaN,(t[4]-n)/a,(t[5]-s)/l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,h,p,NaN,NaN,NaN,NaN,(t[16]-n)/a,(t[17]-s)/l,NaN,NaN,NaN,NaN,(t[14]-n)/a,(t[15]-s)/l],0),this.newFreeDrawOutline(v,e,g(this,Ei),g(this,ad),g(this,sd),g(this,rd))},UN=function(e,t){const n=g(this,bs);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},FN=function(e,t){const n=g(this,qe).subarray(4,6),s=g(this,qe).subarray(16,18),[a,l,c,d]=g(this,Ei),[h,p,v,_]=k(this,en,qh).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-a)/c,(n[1]-l)/d,NaN,NaN,NaN,NaN,h,p,NaN,NaN,NaN,NaN,v,_,NaN,NaN,NaN,NaN,(s[0]-a)/c,(s[1]-l)/d],t),t+=24},M(Cr,vp,8),M(Cr,M0,2),M(Cr,k0,g(Cr,vp)+g(Cr,M0));let t0=Cr;var ld,Gl,jr,bp,Ti,_p,Ot,I0,BN;class HN extends fe{constructor(t,n,s,a,l,c){super();M(this,I0);M(this,ld);M(this,Gl,new Float32Array(4));M(this,jr);M(this,bp);M(this,Ti);M(this,_p);M(this,Ot);C(this,Ot,t),C(this,Ti,n),C(this,ld,s),C(this,_p,a),C(this,jr,l),C(this,bp,c),this.lastPoint=[NaN,NaN],k(this,I0,BN).call(this,c);const[d,h,p,v]=g(this,Gl);for(let _=0,x=t.length;_<x;_+=2)t[_]=(t[_]-d)/p,t[_+1]=(t[_+1]-h)/v;for(let _=0,x=n.length;_<x;_+=2)n[_]=(n[_]-d)/p,n[_+1]=(n[_+1]-h)/v}toSVGPath(){const t=[`M${g(this,Ot)[4]} ${g(this,Ot)[5]}`];for(let n=6,s=g(this,Ot).length;n<s;n+=6){if(isNaN(g(this,Ot)[n])){t.push(`L${g(this,Ot)[n+4]} ${g(this,Ot)[n+5]}`);continue}t.push(`C${g(this,Ot)[n]} ${g(this,Ot)[n+1]} ${g(this,Ot)[n+2]} ${g(this,Ot)[n+3]} ${g(this,Ot)[n+4]} ${g(this,Ot)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,s,a],l){const c=s-t,d=a-n;let h,p;switch(l){case 0:h=fe._rescale(g(this,Ot),t,a,c,-d),p=fe._rescale(g(this,Ti),t,a,c,-d);break;case 90:h=fe._rescaleAndSwap(g(this,Ot),t,n,c,d),p=fe._rescaleAndSwap(g(this,Ti),t,n,c,d);break;case 180:h=fe._rescale(g(this,Ot),s,n,-c,d),p=fe._rescale(g(this,Ti),s,n,-c,d);break;case 270:h=fe._rescaleAndSwap(g(this,Ot),s,a,-c,-d),p=fe._rescaleAndSwap(g(this,Ti),s,a,-c,-d);break}return{outline:Array.from(h),points:[Array.from(p)]}}get box(){return g(this,Gl)}newOutliner(t,n,s,a,l,c=0){return new t0(t,n,s,a,l,c)}getNewOutline(t,n){const[s,a,l,c]=g(this,Gl),[d,h,p,v]=g(this,ld),_=l*p,x=c*v,A=s*p+d,E=a*v+h,R=this.newOutliner({x:g(this,Ti)[0]*_+A,y:g(this,Ti)[1]*x+E},g(this,ld),g(this,_p),t,g(this,bp),n??g(this,jr));for(let N=2;N<g(this,Ti).length;N+=2)R.add({x:g(this,Ti)[N]*_+A,y:g(this,Ti)[N+1]*x+E});return R.getOutlines()}}ld=new WeakMap,Gl=new WeakMap,jr=new WeakMap,bp=new WeakMap,Ti=new WeakMap,_p=new WeakMap,Ot=new WeakMap,I0=new WeakSet,BN=function(t){const n=g(this,Ot);let s=n[4],a=n[5],l=s,c=a,d=s,h=a,p=s,v=a;const _=t?Math.max:Math.min;for(let A=6,E=n.length;A<E;A+=6){if(isNaN(n[A]))l=Math.min(l,n[A+4]),c=Math.min(c,n[A+5]),d=Math.max(d,n[A+4]),h=Math.max(h,n[A+5]),v<n[A+5]?(p=n[A+4],v=n[A+5]):v===n[A+5]&&(p=_(p,n[A+4]));else{const R=xe.bezierBoundingBox(s,a,...n.slice(A,A+6));l=Math.min(l,R[0]),c=Math.min(c,R[1]),d=Math.max(d,R[2]),h=Math.max(h,R[3]),v<R[3]?(p=R[2],v=R[3]):v===R[3]&&(p=_(p,R[2]))}s=n[A+4],a=n[A+5]}const x=g(this,Gl);x[0]=l-g(this,jr),x[1]=c-g(this,jr),x[2]=d-l+2*g(this,jr),x[3]=h-c+2*g(this,jr),this.lastPoint=[p,v]};var wp,xp,io,_s,jn,GN,Bm,zN,qN,H_;class F_{constructor(e,t=0,n=0,s=!0){M(this,jn);M(this,wp);M(this,xp);M(this,io,[]);M(this,_s,[]);let a=1/0,l=-1/0,c=1/0,d=-1/0;const h=10**-4;for(const{x:R,y:N,width:D,height:P}of e){const L=Math.floor((R-t)/h)*h,B=Math.ceil((R+D+t)/h)*h,H=Math.floor((N-t)/h)*h,O=Math.ceil((N+P+t)/h)*h,X=[L,H,O,!0],Y=[B,H,O,!1];g(this,io).push(X,Y),a=Math.min(a,L),l=Math.max(l,B),c=Math.min(c,H),d=Math.max(d,O)}const p=l-a+2*n,v=d-c+2*n,_=a-n,x=c-n,A=g(this,io).at(s?-1:-2),E=[A[0],A[2]];for(const R of g(this,io)){const[N,D,P]=R;R[0]=(N-_)/p,R[1]=(D-x)/v,R[2]=(P-x)/v}C(this,wp,new Float32Array([_,x,p,v])),C(this,xp,E)}getOutlines(){g(this,io).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of g(this,io))t[3]?(e.push(...k(this,jn,H_).call(this,t)),k(this,jn,zN).call(this,t)):(k(this,jn,qN).call(this,t),e.push(...k(this,jn,H_).call(this,t)));return k(this,jn,GN).call(this,e)}}wp=new WeakMap,xp=new WeakMap,io=new WeakMap,_s=new WeakMap,jn=new WeakSet,GN=function(e){const t=[],n=new Set;for(const l of e){const[c,d,h]=l;t.push([c,d,l],[c,h,l])}t.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=t.length;l<c;l+=2){const d=t[l][2],h=t[l+1][2];d.push(h),h.push(d),n.add(d),n.add(h)}const s=[];let a;for(;n.size>0;){const l=n.values().next().value;let[c,d,h,p,v]=l;n.delete(l);let _=c,x=d;for(a=[c,h],s.push(a);;){let A;if(n.has(p))A=p;else if(n.has(v))A=v;else break;n.delete(A),[c,d,h,p,v]=A,_!==c&&(a.push(_,x,c,x===d?d:h),_=c),x=x===d?h:d}a.push(_,x)}return new dL(s,g(this,wp),g(this,xp))},Bm=function(e){const t=g(this,_s);let n=0,s=t.length-1;for(;n<=s;){const a=n+s>>1,l=t[a][0];if(l===e)return a;l<e?n=a+1:s=a-1}return s+1},zN=function([,e,t]){const n=k(this,jn,Bm).call(this,e);g(this,_s).splice(n,0,[e,t])},qN=function([,e,t]){const n=k(this,jn,Bm).call(this,e);for(let s=n;s<g(this,_s).length;s++){const[a,l]=g(this,_s)[s];if(a!==e)break;if(a===e&&l===t){g(this,_s).splice(s,1);return}}for(let s=n-1;s>=0;s--){const[a,l]=g(this,_s)[s];if(a!==e)break;if(a===e&&l===t){g(this,_s).splice(s,1);return}}},H_=function(e){const[t,n,s]=e,a=[[t,n,s]],l=k(this,jn,Bm).call(this,s);for(let c=0;c<l;c++){const[d,h]=g(this,_s)[c];for(let p=0,v=a.length;p<v;p++){const[,_,x]=a[p];if(!(h<=_||x<=d)){if(_>=d){if(x>h)a[p][1]=h;else{if(v===1)return[];a.splice(p,1),p--,v--}continue}a[p][2]=d,x>h&&a.push([t,h,x])}}}return a};var Sp,cd;class dL extends fe{constructor(t,n,s){super();M(this,Sp);M(this,cd);C(this,cd,t),C(this,Sp,n),this.lastPoint=s}toSVGPath(){const t=[];for(const n of g(this,cd)){let[s,a]=n;t.push(`M${s} ${a}`);for(let l=2;l<n.length;l+=2){const c=n[l],d=n[l+1];c===s?(t.push(`V${d}`),a=d):d===a&&(t.push(`H${c}`),s=c)}t.push("Z")}return t.join(" ")}serialize([t,n,s,a],l){const c=[],d=s-t,h=a-n;for(const p of g(this,cd)){const v=new Array(p.length);for(let _=0;_<p.length;_+=2)v[_]=t+p[_]*d,v[_+1]=a-p[_+1]*h;c.push(v)}return c}get box(){return g(this,Sp)}get classNamesForOutlining(){return["highlightOutline"]}}Sp=new WeakMap,cd=new WeakMap;class B_ extends t0{newFreeDrawOutline(e,t,n,s,a,l){return new hL(e,t,n,s,a,l)}}class hL extends HN{newOutliner(e,t,n,s,a,l=0){return new B_(e,t,n,s,a,l)}}var ws,zl,ud,Wt,Ap,dd,Ep,Tp,so,xs,hd,Cp,dt,G_,z_,q_,qo,VN,Da;const ii=class ii{constructor({editor:e=null,uiManager:t=null}){M(this,dt);M(this,ws,null);M(this,zl,null);M(this,ud);M(this,Wt,null);M(this,Ap,!1);M(this,dd,!1);M(this,Ep,null);M(this,Tp);M(this,so,null);M(this,xs,null);M(this,hd);var n;e?(C(this,dd,!1),C(this,hd,Xe.HIGHLIGHT_COLOR),C(this,Ep,e)):(C(this,dd,!0),C(this,hd,Xe.HIGHLIGHT_DEFAULT_COLOR)),C(this,xs,(e==null?void 0:e._uiManager)||t),C(this,Tp,g(this,xs)._eventBus),C(this,ud,(e==null?void 0:e.color)||((n=g(this,xs))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),g(ii,Cp)||C(ii,Cp,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Ve(this,"_keyboardManager",new Op([[["Escape","mac+Escape"],ii.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ii.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ii.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ii.prototype._moveToPrevious],[["Home","mac+Home"],ii.prototype._moveToBeginning],[["End","mac+End"],ii.prototype._moveToEnd]]))}renderButton(){const e=C(this,ws,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=g(this,xs)._signal;e.addEventListener("click",k(this,dt,qo).bind(this),{signal:t}),e.addEventListener("keydown",k(this,dt,q_).bind(this),{signal:t});const n=C(this,zl,document.createElement("span"));return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=g(this,ud),e.append(n),e}renderMainDropdown(){const e=C(this,Wt,k(this,dt,G_).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===g(this,ws)){k(this,dt,qo).call(this,e);return}const t=e.target.getAttribute("data-color");t&&k(this,dt,z_).call(this,t,e)}_moveToNext(e){var t,n;if(!g(this,dt,Da)){k(this,dt,qo).call(this,e);return}if(e.target===g(this,ws)){(t=g(this,Wt).firstChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=g(this,Wt))==null?void 0:t.firstChild)||e.target===g(this,ws)){g(this,dt,Da)&&this._hideDropdownFromKeyboard();return}g(this,dt,Da)||k(this,dt,qo).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!g(this,dt,Da)){k(this,dt,qo).call(this,e);return}(t=g(this,Wt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!g(this,dt,Da)){k(this,dt,qo).call(this,e);return}(t=g(this,Wt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=g(this,Wt))==null||e.classList.add("hidden"),(t=g(this,so))==null||t.abort(),C(this,so,null)}_hideDropdownFromKeyboard(){var e;if(!g(this,dd)){if(!g(this,dt,Da)){(e=g(this,Ep))==null||e.unselect();return}this.hideDropdown(),g(this,ws).focus({preventScroll:!0,focusVisible:g(this,Ap)})}}updateColor(e){if(g(this,zl)&&(g(this,zl).style.backgroundColor=e),!g(this,Wt))return;const t=g(this,xs).highlightColors.values();for(const n of g(this,Wt).children)n.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=g(this,ws))==null||e.remove(),C(this,ws,null),C(this,zl,null),(t=g(this,Wt))==null||t.remove(),C(this,Wt,null)}};ws=new WeakMap,zl=new WeakMap,ud=new WeakMap,Wt=new WeakMap,Ap=new WeakMap,dd=new WeakMap,Ep=new WeakMap,Tp=new WeakMap,so=new WeakMap,xs=new WeakMap,hd=new WeakMap,Cp=new WeakMap,dt=new WeakSet,G_=function(){const e=document.createElement("div"),t=g(this,xs)._signal;e.addEventListener("contextmenu",Ns,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,s]of g(this,xs).highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",s),a.title=n,a.setAttribute("data-l10n-id",g(ii,Cp)[n]);const l=document.createElement("span");a.append(l),l.className="swatch",l.style.backgroundColor=s,a.setAttribute("aria-selected",s===g(this,ud)),a.addEventListener("click",k(this,dt,z_).bind(this,s),{signal:t}),e.append(a)}return e.addEventListener("keydown",k(this,dt,q_).bind(this),{signal:t}),e},z_=function(e,t){t.stopPropagation(),g(this,Tp).dispatch("switchannotationeditorparams",{source:this,type:g(this,hd),value:e})},q_=function(e){ii._keyboardManager.exec(this,e)},qo=function(e){if(g(this,dt,Da)){this.hideDropdown();return}if(C(this,Ap,e.detail===0),g(this,so)||(C(this,so,new AbortController),window.addEventListener("pointerdown",k(this,dt,VN).bind(this),{signal:g(this,xs).combinedSignal(g(this,so))})),g(this,Wt)){g(this,Wt).classList.remove("hidden");return}const t=C(this,Wt,k(this,dt,G_).call(this));g(this,ws).append(t)},VN=function(e){var t;(t=g(this,Wt))!=null&&t.contains(e.target)||this.hideDropdown()},Da=function(){return g(this,Wt)&&!g(this,Wt).classList.contains("hidden")},M(ii,Cp,null);let n0=ii;var fd,Rp,Yr,ql,pd,ai,Np,Mp,Vl,Wi,Ci,wn,gd,Kr,kn,md,Qi,kp,Ue,V_,Gm,$N,jN,YN,$_,Vo,ns,lu,KN,zm,Vh,JN,XN,WN,QN,ZN;const it=class it extends Rt{constructor(t){super({...t,name:"highlightEditor"});M(this,Ue);M(this,fd,null);M(this,Rp,0);M(this,Yr);M(this,ql,null);M(this,pd,null);M(this,ai,null);M(this,Np,null);M(this,Mp,0);M(this,Vl,null);M(this,Wi,null);M(this,Ci,null);M(this,wn,!1);M(this,gd,null);M(this,Kr);M(this,kn,null);M(this,md,"");M(this,Qi);M(this,kp,"");this.color=t.color||it._defaultColor,C(this,Qi,t.thickness||it._defaultThickness),C(this,Kr,t.opacity||it._defaultOpacity),C(this,Yr,t.boxes||null),C(this,kp,t.methodOfCreation||""),C(this,md,t.text||""),this._isDraggable=!1,t.highlightId>-1?(C(this,wn,!0),k(this,Ue,Gm).call(this,t),k(this,Ue,Vo).call(this)):g(this,Yr)&&(C(this,fd,t.anchorNode),C(this,Rp,t.anchorOffset),C(this,Np,t.focusNode),C(this,Mp,t.focusOffset),k(this,Ue,V_).call(this),k(this,Ue,Vo).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=it.prototype;return Ve(this,"_keyboardManager",new Op([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:g(this,wn)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:g(this,Qi),methodOfCreation:g(this,kp)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var s;Rt.initialize(t,n),it._defaultColor||(it._defaultColor=((s=n.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case Xe.HIGHLIGHT_DEFAULT_COLOR:it._defaultColor=n;break;case Xe.HIGHLIGHT_THICKNESS:it._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return g(this,gd)}updateParams(t,n){switch(t){case Xe.HIGHLIGHT_COLOR:k(this,Ue,$N).call(this,n);break;case Xe.HIGHLIGHT_THICKNESS:k(this,Ue,jN).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Xe.HIGHLIGHT_DEFAULT_COLOR,it._defaultColor],[Xe.HIGHLIGHT_THICKNESS,it._defaultThickness]]}get propertiesToUpdate(){return[[Xe.HIGHLIGHT_COLOR,this.color||it._defaultColor],[Xe.HIGHLIGHT_THICKNESS,g(this,Qi)||it._defaultThickness],[Xe.HIGHLIGHT_FREE,g(this,wn)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(C(this,pd,new n0({editor:this})),t.addColorPicker(g(this,pd))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(k(this,Ue,Vh).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,k(this,Ue,Vh).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){k(this,Ue,$_).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(k(this,Ue,Vo).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let n=!1;this.parent&&!t?k(this,Ue,$_).call(this):t&&(k(this,Ue,Vo).call(this,t),n=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var a,l,c;const{drawLayer:n}=this.parent;let s;g(this,wn)?(t=(t-this.rotation+360)%360,s=k(a=it,ns,lu).call(a,g(this,Wi).box,t)):s=k(l=it,ns,lu).call(l,[this.x,this.y,this.width,this.height],t),n.updateProperties(g(this,Ci),{bbox:s,root:{"data-main-rotation":t}}),n.updateProperties(g(this,kn),{bbox:k(c=it,ns,lu).call(c,g(this,ai).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();g(this,md)&&(t.setAttribute("aria-label",g(this,md)),t.setAttribute("role","mark")),g(this,wn)?t.classList.add("free"):this.div.addEventListener("keydown",k(this,Ue,KN).bind(this),{signal:this._uiManager._signal});const n=C(this,Vl,document.createElement("div"));t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=g(this,ql);const[s,a]=this.parentDimensions;return this.setDims(this.width*s,this.height*a),Qm(this,g(this,Vl),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(g(this,kn),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(g(this,kn),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:k(this,Ue,zm).call(this,!0);break;case 1:case 3:k(this,Ue,zm).call(this,!1);break}}select(){var t;super.select(),g(this,kn)&&((t=this.parent)==null||t.drawLayer.updateProperties(g(this,kn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),g(this,kn)&&((t=this.parent)==null||t.drawLayer.updateProperties(g(this,kn),{rootClass:{selected:!1}}),g(this,wn)||k(this,Ue,zm).call(this,!1))}get _mustFixPosition(){return!g(this,wn)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(g(this,Ci),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(g(this,kn),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:s,x:a,y:l}){const{x:c,y:d,width:h,height:p}=s.getBoundingClientRect(),v=new AbortController,_=t.combinedSignal(v),x=A=>{v.abort(),k(this,ns,QN).call(this,t,A)};window.addEventListener("blur",x,{signal:_}),window.addEventListener("pointerup",x,{signal:_}),window.addEventListener("pointerdown",Di,{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",Ns,{signal:_}),s.addEventListener("pointermove",k(this,ns,WN).bind(this,t),{signal:_}),this._freeHighlight=new B_({x:a,y:l},[c,d,h,p],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,s){var E,R,N,D;let a=null;if(t instanceof EN){const{data:{quadPoints:P,rect:L,rotation:B,id:H,color:O,opacity:X,popupRef:Y},parent:{page:{pageNumber:se}}}=t;a=t={annotationType:He.HIGHLIGHT,color:Array.from(O),opacity:X,quadPoints:P,boxes:null,pageIndex:se-1,rect:L.slice(0),rotation:B,id:H,deleted:!1,popupRef:Y}}else if(t instanceof Yw){const{data:{inkLists:P,rect:L,rotation:B,id:H,color:O,borderStyle:{rawWidth:X},popupRef:Y},parent:{page:{pageNumber:se}}}=t;a=t={annotationType:He.HIGHLIGHT,color:Array.from(O),thickness:X,inkLists:P,boxes:null,pageIndex:se-1,rect:L.slice(0),rotation:B,id:H,deleted:!1,popupRef:Y}}const{color:l,quadPoints:c,inkLists:d,opacity:h}=t,p=await super.deserialize(t,n,s);p.color=xe.makeHexColor(...l),C(p,Kr,h||1),d&&C(p,Qi,t.thickness),p.annotationElementId=t.id||null,p._initialData=a;const[v,_]=p.pageDimensions,[x,A]=p.pageTranslation;if(c){const P=C(p,Yr,[]);for(let L=0;L<c.length;L+=8)P.push({x:(c[L]-x)/v,y:1-(c[L+1]-A)/_,width:(c[L+2]-c[L])/v,height:(c[L+1]-c[L+5])/_});k(E=p,Ue,V_).call(E),k(R=p,Ue,Vo).call(R),p.rotate(p.rotation)}else if(d){C(p,wn,!0);const P=d[0],L={x:P[0]-x,y:_-(P[1]-A)},B=new B_(L,[0,0,v,_],1,g(p,Qi)/2,!0,.001);for(let X=0,Y=P.length;X<Y;X+=2)L.x=P[X]-x,L.y=_-(P[X+1]-A),B.add(L);const{id:H,clipPathId:O}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:p.color,"fill-opacity":p._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:B.toSVGPath()}},!0,!0);k(N=p,Ue,Gm).call(N,{highlightOutlines:B.getOutlines(),highlightId:H,clipPathId:O}),k(D=p,Ue,Vo).call(D)}return p}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),s=Rt._colorManager.convert(this.color),a={annotationType:He.HIGHLIGHT,color:s,opacity:g(this,Kr),thickness:g(this,Qi),quadPoints:k(this,Ue,JN).call(this),outlines:k(this,Ue,XN).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:k(this,Ue,Vh).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!k(this,Ue,ZN).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};fd=new WeakMap,Rp=new WeakMap,Yr=new WeakMap,ql=new WeakMap,pd=new WeakMap,ai=new WeakMap,Np=new WeakMap,Mp=new WeakMap,Vl=new WeakMap,Wi=new WeakMap,Ci=new WeakMap,wn=new WeakMap,gd=new WeakMap,Kr=new WeakMap,kn=new WeakMap,md=new WeakMap,Qi=new WeakMap,kp=new WeakMap,Ue=new WeakSet,V_=function(){const t=new F_(g(this,Yr),.001);C(this,Wi,t.getOutlines()),[this.x,this.y,this.width,this.height]=g(this,Wi).box;const n=new F_(g(this,Yr),.0025,.001,this._uiManager.direction==="ltr");C(this,ai,n.getOutlines());const{lastPoint:s}=g(this,ai);C(this,gd,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},Gm=function({highlightOutlines:t,highlightId:n,clipPathId:s}){var v,_;if(C(this,Wi,t),C(this,ai,t.getNewOutline(g(this,Qi)/2+1.5,.0025)),n>=0)C(this,Ci,n),C(this,ql,s),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),C(this,kn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:g(this,ai).box,path:{d:g(this,ai).toSVGPath()}},!0));else if(this.parent){const x=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(g(this,Ci),{bbox:k(v=it,ns,lu).call(v,g(this,Wi).box,(x-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(g(this,kn),{bbox:k(_=it,ns,lu).call(_,g(this,ai).box,x),path:{d:g(this,ai).toSVGPath()}})}const[l,c,d,h]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=d,this.height=h;break;case 90:{const[x,A]=this.parentDimensions;this.x=c,this.y=1-l,this.width=d*A/x,this.height=h*x/A;break}case 180:this.x=1-l,this.y=1-c,this.width=d,this.height=h;break;case 270:{const[x,A]=this.parentDimensions;this.x=1-c,this.y=l,this.width=d*A/x,this.height=h*x/A;break}}const{lastPoint:p}=g(this,ai);C(this,gd,[(p[0]-l)/d,(p[1]-c)/h])},$N=function(t){const n=(l,c)=>{var d,h;this.color=l,C(this,Kr,c),(d=this.parent)==null||d.drawLayer.updateProperties(g(this,Ci),{root:{fill:l,"fill-opacity":c}}),(h=g(this,pd))==null||h.updateColor(l)},s=this.color,a=g(this,Kr);this.addCommands({cmd:n.bind(this,t,it._defaultOpacity),undo:n.bind(this,s,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},jN=function(t){const n=g(this,Qi),s=a=>{C(this,Qi,a),k(this,Ue,YN).call(this,a)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},YN=function(t){if(!g(this,wn))return;k(this,Ue,Gm).call(this,{highlightOutlines:g(this,Wi).getNewOutline(t/2)}),this.fixAndSetPosition();const[n,s]=this.parentDimensions;this.setDims(this.width*n,this.height*s)},$_=function(){g(this,Ci)===null||!this.parent||(this.parent.drawLayer.remove(g(this,Ci)),C(this,Ci,null),this.parent.drawLayer.remove(g(this,kn)),C(this,kn,null))},Vo=function(t=this.parent){g(this,Ci)===null&&({id:Un(this,Ci)._,clipPathId:Un(this,ql)._}=t.drawLayer.draw({bbox:g(this,Wi).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":g(this,Kr)},rootClass:{highlight:!0,free:g(this,wn)},path:{d:g(this,Wi).toSVGPath()}},!1,!0),C(this,kn,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:g(this,wn)},bbox:g(this,ai).box,path:{d:g(this,ai).toSVGPath()}},g(this,wn))),g(this,Vl)&&(g(this,Vl).style.clipPath=g(this,ql)))},ns=new WeakSet,lu=function([t,n,s,a],l){switch(l){case 90:return[1-n-a,t,a,s];case 180:return[1-t-s,1-n-a,s,a];case 270:return[n,1-t-s,a,s]}return[t,n,s,a]},KN=function(t){it._keyboardManager.exec(this,t)},zm=function(t){if(!g(this,fd))return;const n=window.getSelection();t?n.setPosition(g(this,fd),g(this,Rp)):n.setPosition(g(this,Np),g(this,Mp))},Vh=function(){return g(this,wn)?this.rotation:0},JN=function(){if(g(this,wn))return null;const[t,n]=this.pageDimensions,[s,a]=this.pageTranslation,l=g(this,Yr),c=new Float32Array(l.length*8);let d=0;for(const{x:h,y:p,width:v,height:_}of l){const x=h*t+s,A=(1-p)*n+a;c[d]=c[d+4]=x,c[d+1]=c[d+3]=A,c[d+2]=c[d+6]=x+v*t,c[d+5]=c[d+7]=A-_*n,d+=8}return c},XN=function(t){return g(this,Wi).serialize(t,k(this,Ue,Vh).call(this))},WN=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},QN=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},ZN=function(t){const{color:n}=this._initialData;return t.color.some((s,a)=>s!==n[a])},M(it,ns),Re(it,"_defaultColor",null),Re(it,"_defaultOpacity",1),Re(it,"_defaultThickness",12),Re(it,"_type","highlight"),Re(it,"_editorType",He.HIGHLIGHT),Re(it,"_freeHighlightId",-1),Re(it,"_freeHighlight",null),Re(it,"_freeHighlightClipId","");let i0=it;var $l;class fL{constructor(){M(this,$l,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))this.updateProperty(t,n)}updateSVGProperty(e,t){g(this,$l)[e]=t}toSVGProperties(){const e=g(this,$l);return C(this,$l,Object.create(null)),{root:e}}reset(){C(this,$l,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){pt("Not implemented")}}$l=new WeakMap;var Ri,yd,ln,jl,Yl,ro,ao,oo,Kl,We,Y_,K_,J_,$h,eM,qm,jh,cu;const ge=class ge extends Rt{constructor(t){super(t);M(this,We);M(this,Ri,null);M(this,yd);Re(this,"_drawId",null);C(this,yd,t.mustBeCommitted||!1),t.drawOutlines&&(k(this,We,Y_).call(this,t),k(this,We,$h).call(this))}static _mergeSVGProperties(t,n){const s=new Set(Object.keys(t));for(const[a,l]of Object.entries(n))s.has(a)?Object.assign(t[a],l):t[a]=l;return t}static getDefaultDrawingOptions(t){pt("Not implemented")}static get typesMap(){pt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,n),this._currentParent&&(g(ge,ln).updateProperty(s,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[s,a]of this.typesMap)t.push([s,n[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[s,a]of this.constructor.typesMap)t.push([s,n[a]]);return t}_updateProperty(t,n,s){const a=this._drawingOptions,l=a[n],c=d=>{var p;a.updateProperty(n,d);const h=g(this,Ri).updateProperty(n,d);h&&k(this,We,jh).call(this,h),(p=this.parent)==null||p.drawLayer.updateProperties(this._drawId,a.toSVGProperties())};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ge._mergeSVGProperties(g(this,Ri).getPathResizingSVGProperties(k(this,We,qm).call(this)),{bbox:k(this,We,cu).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ge._mergeSVGProperties(g(this,Ri).getPathResizedSVGProperties(k(this,We,qm).call(this)),{bbox:k(this,We,cu).call(this)}))}_onTranslating(t,n){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:k(this,We,cu).call(this,t,n)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ge._mergeSVGProperties(g(this,Ri).getPathTranslatedSVGProperties(k(this,We,qm).call(this),this.parentDimensions),{bbox:k(this,We,cu).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,g(this,yd)&&(C(this,yd,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){k(this,We,J_).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(k(this,We,$h).call(this),k(this,We,jh).call(this,g(this,Ri).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),k(this,We,J_).call(this)):t&&(this._uiManager.addShouldRescale(this),k(this,We,$h).call(this,t),n=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ge._mergeSVGProperties({bbox:k(this,We,cu).call(this)},g(this,Ri).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&k(this,We,jh).call(this,g(this,Ri).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const n=document.createElement("div");t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal";const[s,a]=this.parentDimensions;return this.setDims(this.width*s,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,n,s,a,l){pt("Not implemented")}static startDrawing(t,n,s,a){var R;const{target:l,offsetX:c,offsetY:d,pointerId:h,pointerType:p}=a;if(g(ge,ao)&&g(ge,ao)!==p)return;const{viewport:{rotation:v}}=t,{width:_,height:x}=l.getBoundingClientRect(),A=C(ge,jl,new AbortController),E=t.combinedSignal(A);if(g(ge,ro)||C(ge,ro,h),g(ge,ao)??C(ge,ao,p),window.addEventListener("pointerup",N=>{var D;g(ge,ro)===N.pointerId?this._endDraw(N):(D=g(ge,oo))==null||D.delete(N.pointerId)},{signal:E}),window.addEventListener("pointercancel",N=>{var D;g(ge,ro)===N.pointerId?this._currentParent.endDrawingSession():(D=g(ge,oo))==null||D.delete(N.pointerId)},{signal:E}),window.addEventListener("pointerdown",N=>{g(ge,ao)===N.pointerType&&((g(ge,oo)||C(ge,oo,new Set)).add(N.pointerId),g(ge,ln).isCancellable()&&(g(ge,ln).removeLastElement(),g(ge,ln).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:E}),window.addEventListener("contextmenu",Ns,{signal:E}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:E}),l.addEventListener("touchmove",N=>{N.timeStamp===g(ge,Kl)&&Di(N)},{signal:E}),t.toggleDrawing(),(R=n._editorUndoBar)==null||R.hide(),g(ge,ln)){t.drawLayer.updateProperties(this._currentDrawId,g(ge,ln).startNew(c,d,_,x,v));return}n.updateUIForDefaultProperties(this),C(ge,ln,this.createDrawerInstance(c,d,_,x,v)),C(ge,Yl,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(g(ge,Yl).toSVGProperties(),g(ge,ln).defaultSVGProperties),!0,!1)}static _drawMove(t){var l;if(C(ge,Kl,-1),!g(ge,ln))return;const{offsetX:n,offsetY:s,pointerId:a}=t;if(g(ge,ro)===a){if(((l=g(ge,oo))==null?void 0:l.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,g(ge,ln).add(n,s)),C(ge,Kl,t.timeStamp),Di(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,C(ge,ln,null),C(ge,Yl,null),C(ge,ao,null),C(ge,Kl,NaN)),g(ge,jl)&&(g(ge,jl).abort(),C(ge,jl,null),C(ge,ro,NaN),C(ge,oo,null))}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),t&&n.drawLayer.updateProperties(this._currentDrawId,g(ge,ln).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=g(ge,ln),a=this._currentDrawId,l=s.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(a,s.setLastElement(l))},undo:()=>{n.drawLayer.updateProperties(a,s.removeLastElement())},mustExec:!1,type:Xe.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(Xe.DRAW_STEP),!g(ge,ln).isEmpty()){const{pageDimensions:[s,a],scale:l}=n,c=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:g(ge,ln).getOutlines(s*l,a*l,l,this._INNER_MARGIN),drawingOptions:g(ge,Yl),mustBeCommitted:!t});return this._cleanup(!0),c}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,s,a,l,c){pt("Not implemented")}static async deserialize(t,n,s){var v,_;const{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:d}}=n.viewport,h=this.deserializeDraw(c,d,a,l,this._INNER_MARGIN,t),p=await super.deserialize(t,n,s);return p.createDrawingOptions(t),k(v=p,We,Y_).call(v,{drawOutlines:h}),k(_=p,We,$h).call(_),p.onScaleChanging(),p.rotate(),p}serializeDraw(t){const[n,s]=this.pageTranslation,[a,l]=this.pageDimensions;return g(this,Ri).serialize([n,s,a,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ri=new WeakMap,yd=new WeakMap,ln=new WeakMap,jl=new WeakMap,Yl=new WeakMap,ro=new WeakMap,ao=new WeakMap,oo=new WeakMap,Kl=new WeakMap,We=new WeakSet,Y_=function({drawOutlines:t,drawId:n,drawingOptions:s}){C(this,Ri,t),this._drawingOptions||(this._drawingOptions=s),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=k(this,We,K_).call(this,t,this.parent),k(this,We,jh).call(this,t.box)},K_=function(t,n){const{id:s}=n.drawLayer.draw(ge._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},J_=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},$h=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=k(this,We,K_).call(this,g(this,Ri),t)}},eM=function([t,n,s,a]){const{parentDimensions:[l,c],rotation:d}=this;switch(d){case 90:return[n,1-t,s*(c/l),a*(l/c)];case 180:return[1-t,1-n,s,a];case 270:return[1-n,t,s*(c/l),a*(l/c)];default:return[t,n,s,a]}},qm=function(){const{x:t,y:n,width:s,height:a,parentDimensions:[l,c],rotation:d}=this;switch(d){case 90:return[1-n,t,s*(l/c),a*(c/l)];case 180:return[1-t,1-n,s,a];case 270:return[n,1-t,s*(l/c),a*(c/l)];default:return[t,n,s,a]}},jh=function(t){if([this.x,this.y,this.width,this.height]=k(this,We,eM).call(this,t),this.div){this.fixAndSetPosition();const[n,s]=this.parentDimensions;this.setDims(this.width*n,this.height*s)}this._onResized()},cu=function(){const{x:t,y:n,width:s,height:a,rotation:l,parentRotation:c,parentDimensions:[d,h]}=this;switch((l*4+c)/90){case 1:return[1-n-a,t,a,s];case 2:return[1-t-s,1-n-a,s,a];case 3:return[n,1-t-s,a,s];case 4:return[t,n-s*(d/h),a*(h/d),s*(d/h)];case 5:return[1-n,t,s*(d/h),a*(h/d)];case 6:return[1-t-a*(h/d),1-n,a*(h/d),s*(d/h)];case 7:return[n-s*(d/h),1-t-a*(h/d),s*(d/h),a*(h/d)];case 8:return[t-s,n-a,s,a];case 9:return[1-n,t-s,a,s];case 10:return[1-t,1-n,s,a];case 11:return[n-a,1-t,a,s];case 12:return[t-a*(h/d),n,a*(h/d),s*(d/h)];case 13:return[1-n-s*(d/h),t-a*(h/d),s*(d/h),a*(h/d)];case 14:return[1-t,1-n-s*(d/h),a*(h/d),s*(d/h)];case 15:return[n,1-t,s*(d/h),a*(h/d)];default:return[t,n,s,a]}},Re(ge,"_currentDrawId",-1),Re(ge,"_currentParent",null),M(ge,ln,null),M(ge,jl,null),M(ge,Yl,null),M(ge,ro,NaN),M(ge,ao,null),M(ge,oo,null),M(ge,Kl,NaN),Re(ge,"_INNER_MARGIN",3);let j_=ge;var Xs,cn,un,Jl,vd,Bn,xn,Zi,Xl,Wl,Ql,bd,Vm;class pL{constructor(e,t,n,s,a,l){M(this,bd);M(this,Xs,new Float64Array(6));M(this,cn);M(this,un);M(this,Jl);M(this,vd);M(this,Bn);M(this,xn,"");M(this,Zi,0);M(this,Xl,new s0);M(this,Wl);M(this,Ql);C(this,Wl,n),C(this,Ql,s),C(this,Jl,a),C(this,vd,l),[e,t]=k(this,bd,Vm).call(this,e,t);const c=C(this,cn,[NaN,NaN,NaN,NaN,e,t]);C(this,Bn,[e,t]),C(this,un,[{line:c,points:g(this,Bn)}]),g(this,Xs).set(c,0)}updateProperty(e,t){e==="stroke-width"&&C(this,vd,t)}isEmpty(){return!g(this,un)||g(this,un).length===0}isCancellable(){return g(this,Bn).length<=10}add(e,t){[e,t]=k(this,bd,Vm).call(this,e,t);const[n,s,a,l]=g(this,Xs).subarray(2,6),c=e-a,d=t-l;return Math.hypot(g(this,Wl)*c,g(this,Ql)*d)<=2?null:(g(this,Bn).push(e,t),isNaN(n)?(g(this,Xs).set([a,l,e,t],2),g(this,cn).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(g(this,Xs)[0])&&g(this,cn).splice(6,6),g(this,Xs).set([n,s,a,l,e,t],0),g(this,cn).push(...fe.createBezierPoints(n,s,a,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(g(this,Bn).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,a){C(this,Wl,n),C(this,Ql,s),C(this,Jl,a),[e,t]=k(this,bd,Vm).call(this,e,t);const l=C(this,cn,[NaN,NaN,NaN,NaN,e,t]);C(this,Bn,[e,t]);const c=g(this,un).at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),g(this,un).push({line:l,points:g(this,Bn)}),g(this,Xs).set(l,0),C(this,Zi,0),this.toSVGPath(),null}getLastElement(){return g(this,un).at(-1)}setLastElement(e){return g(this,un)?(g(this,un).push(e),C(this,cn,e.line),C(this,Bn,e.points),C(this,Zi,0),{path:{d:this.toSVGPath()}}):g(this,Xl).setLastElement(e)}removeLastElement(){if(!g(this,un))return g(this,Xl).removeLastElement();g(this,un).pop(),C(this,xn,"");for(let e=0,t=g(this,un).length;e<t;e++){const{line:n,points:s}=g(this,un)[e];C(this,cn,n),C(this,Bn,s),C(this,Zi,0),this.toSVGPath()}return{path:{d:g(this,xn)}}}toSVGPath(){const e=fe.svgRound(g(this,cn)[4]),t=fe.svgRound(g(this,cn)[5]);if(g(this,Bn).length===2)return C(this,xn,`${g(this,xn)} M ${e} ${t} Z`),g(this,xn);if(g(this,Bn).length<=6){const s=g(this,xn).lastIndexOf("M");C(this,xn,`${g(this,xn).slice(0,s)} M ${e} ${t}`),C(this,Zi,6)}if(g(this,Bn).length===4){const s=fe.svgRound(g(this,cn)[10]),a=fe.svgRound(g(this,cn)[11]);return C(this,xn,`${g(this,xn)} L ${s} ${a}`),C(this,Zi,12),g(this,xn)}const n=[];g(this,Zi)===0&&(n.push(`M ${e} ${t}`),C(this,Zi,6));for(let s=g(this,Zi),a=g(this,cn).length;s<a;s+=6){const[l,c,d,h,p,v]=g(this,cn).slice(s,s+6).map(fe.svgRound);n.push(`C${l} ${c} ${d} ${h} ${p} ${v}`)}return C(this,xn,g(this,xn)+n.join(" ")),C(this,Zi,g(this,cn).length),g(this,xn)}getOutlines(e,t,n,s){const a=g(this,un).at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),g(this,Xl).build(g(this,un),e,t,n,g(this,Jl),g(this,vd),s),C(this,Xs,null),C(this,cn,null),C(this,un,null),C(this,xn,null),g(this,Xl)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Xs=new WeakMap,cn=new WeakMap,un=new WeakMap,Jl=new WeakMap,vd=new WeakMap,Bn=new WeakMap,xn=new WeakMap,Zi=new WeakMap,Xl=new WeakMap,Wl=new WeakMap,Ql=new WeakMap,bd=new WeakSet,Vm=function(e,t){return fe._normalizePoint(e,t,g(this,Wl),g(this,Ql),g(this,Jl))};var Gn,Ip,Dp,Ni,Ws,Qs,_d,wd,xd,An,Ar,tM,nM,iM;const bx=class bx extends fe{constructor(){super(...arguments);M(this,An);M(this,Gn);M(this,Ip,0);M(this,Dp);M(this,Ni);M(this,Ws);M(this,Qs);M(this,_d);M(this,wd);M(this,xd)}build(t,n,s,a,l,c,d){C(this,Ws,n),C(this,Qs,s),C(this,_d,a),C(this,wd,l),C(this,xd,c),C(this,Dp,d??0),C(this,Ni,t),k(this,An,nM).call(this)}setLastElement(t){return g(this,Ni).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return g(this,Ni).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of g(this,Ni)){if(t.push(`M${fe.svgRound(n[4])} ${fe.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12){t.push(`L${fe.svgRound(n[10])} ${fe.svgRound(n[11])}`);continue}for(let s=6,a=n.length;s<a;s+=6){const[l,c,d,h,p,v]=n.subarray(s,s+6).map(fe.svgRound);t.push(`C${l} ${c} ${d} ${h} ${p} ${v}`)}}return t.join("")}serialize([t,n,s,a],l){const c=[],d=[],[h,p,v,_]=k(this,An,tM).call(this);let x,A,E,R,N,D,P,L,B;switch(g(this,wd)){case 0:B=fe._rescale,x=t,A=n+a,E=s,R=-a,N=t+h*s,D=n+(1-p-_)*a,P=t+(h+v)*s,L=n+(1-p)*a;break;case 90:B=fe._rescaleAndSwap,x=t,A=n,E=s,R=a,N=t+p*s,D=n+h*a,P=t+(p+_)*s,L=n+(h+v)*a;break;case 180:B=fe._rescale,x=t+s,A=n,E=-s,R=a,N=t+(1-h-v)*s,D=n+p*a,P=t+(1-h)*s,L=n+(p+_)*a;break;case 270:B=fe._rescaleAndSwap,x=t+s,A=n+a,E=-s,R=-a,N=t+(1-p-_)*s,D=n+(1-h-v)*a,P=t+(1-p)*s,L=n+(1-h)*a;break}for(const{line:H,points:O}of g(this,Ni))c.push(B(H,x,A,E,R,l?new Array(H.length):null)),d.push(B(O,x,A,E,R,l?new Array(O.length):null));return{lines:c,points:d,rect:[N,D,P,L]}}static deserialize(t,n,s,a,l,{paths:{lines:c,points:d},rotation:h,thickness:p}){const v=[];let _,x,A,E,R;switch(h){case 0:R=fe._rescale,_=-t/s,x=n/a+1,A=1/s,E=-1/a;break;case 90:R=fe._rescaleAndSwap,_=-n/a,x=-t/s,A=1/a,E=1/s;break;case 180:R=fe._rescale,_=t/s+1,x=-n/a,A=-1/s,E=1/a;break;case 270:R=fe._rescaleAndSwap,_=n/a+1,x=t/s+1,A=-1/a,E=-1/s;break}if(!c){c=[];for(const D of d){const P=D.length;if(P===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,D[0],D[1]]));continue}if(P===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,D[0],D[1],NaN,NaN,NaN,NaN,D[2],D[3]]));continue}const L=new Float32Array(3*(P-2));c.push(L);let[B,H,O,X]=D.subarray(0,4);L.set([NaN,NaN,NaN,NaN,B,H],0);for(let Y=4;Y<P;Y+=2){const se=D[Y],re=D[Y+1];L.set(fe.createBezierPoints(B,H,O,X,se,re),(Y-2)*3),[B,H,O,X]=[O,X,se,re]}}}for(let D=0,P=c.length;D<P;D++)v.push({line:R(c[D].map(L=>L??NaN),_,x,A,E),points:R(d[D].map(L=>L??NaN),_,x,A,E)});const N=new bx;return N.build(v,s,a,1,h,p,l),N}get box(){return g(this,Gn)}updateProperty(t,n){return t==="stroke-width"?k(this,An,iM).call(this,n):null}updateParentDimensions([t,n],s){const[a,l]=k(this,An,Ar).call(this);C(this,Ws,t),C(this,Qs,n),C(this,_d,s);const[c,d]=k(this,An,Ar).call(this),h=c-a,p=d-l,v=g(this,Gn);return v[0]-=h,v[1]-=p,v[2]+=2*h,v[3]+=2*p,v}updateRotation(t){return C(this,Ip,t),{path:{transform:this.rotationTransform}}}get viewBox(){return g(this,Gn).map(fe.svgRound).join(" ")}get defaultProperties(){const[t,n]=g(this,Gn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${fe.svgRound(t)} ${fe.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=g(this,Gn);let s=0,a=0,l=0,c=0,d=0,h=0;switch(g(this,Ip)){case 90:a=n/t,l=-t/n,d=t;break;case 180:s=-1,c=-1,d=t,h=n;break;case 270:a=-n/t,l=t/n,h=n;break;default:return""}return`matrix(${s} ${a} ${l} ${c} ${fe.svgRound(d)} ${fe.svgRound(h)})`}getPathResizingSVGProperties([t,n,s,a]){const[l,c]=k(this,An,Ar).call(this),[d,h,p,v]=g(this,Gn);if(Math.abs(p-l)<=fe.PRECISION||Math.abs(v-c)<=fe.PRECISION){const R=t+s/2-(d+p/2),N=n+a/2-(h+v/2);return{path:{"transform-origin":`${fe.svgRound(t)} ${fe.svgRound(n)}`,transform:`${this.rotationTransform} translate(${R} ${N})`}}}const _=(s-2*l)/(p-2*l),x=(a-2*c)/(v-2*c),A=p/s,E=v/a;return{path:{"transform-origin":`${fe.svgRound(d)} ${fe.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${E}) translate(${fe.svgRound(l)} ${fe.svgRound(c)}) scale(${_} ${x}) translate(${fe.svgRound(-l)} ${fe.svgRound(-c)})`}}}getPathResizedSVGProperties([t,n,s,a]){const[l,c]=k(this,An,Ar).call(this),d=g(this,Gn),[h,p,v,_]=d;if(d[0]=t,d[1]=n,d[2]=s,d[3]=a,Math.abs(v-l)<=fe.PRECISION||Math.abs(_-c)<=fe.PRECISION){const N=t+s/2-(h+v/2),D=n+a/2-(p+_/2);for(const{line:P,points:L}of g(this,Ni))fe._translate(P,N,D,P),fe._translate(L,N,D,L);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${fe.svgRound(t)} ${fe.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const x=(s-2*l)/(v-2*l),A=(a-2*c)/(_-2*c),E=-x*(h+l)+t+l,R=-A*(p+c)+n+c;if(x!==1||A!==1||E!==0||R!==0)for(const{line:N,points:D}of g(this,Ni))fe._rescale(N,E,R,x,A,N),fe._rescale(D,E,R,x,A,D);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${fe.svgRound(t)} ${fe.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],s){const[a,l]=s,c=g(this,Gn),d=t-c[0],h=n-c[1];if(g(this,Ws)===a&&g(this,Qs)===l)for(const{line:p,points:v}of g(this,Ni))fe._translate(p,d,h,p),fe._translate(v,d,h,v);else{const p=g(this,Ws)/a,v=g(this,Qs)/l;C(this,Ws,a),C(this,Qs,l);for(const{line:_,points:x}of g(this,Ni))fe._rescale(_,d,h,p,v,_),fe._rescale(x,d,h,p,v,x);c[2]*=p,c[3]*=v}return c[0]=t,c[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${fe.svgRound(t)} ${fe.svgRound(n)}`}}}get defaultSVGProperties(){const t=g(this,Gn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${fe.svgRound(t[0])} ${fe.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Gn=new WeakMap,Ip=new WeakMap,Dp=new WeakMap,Ni=new WeakMap,Ws=new WeakMap,Qs=new WeakMap,_d=new WeakMap,wd=new WeakMap,xd=new WeakMap,An=new WeakSet,Ar=function(t=g(this,xd)){const n=g(this,Dp)+t/2*g(this,_d);return g(this,wd)%180===0?[n/g(this,Ws),n/g(this,Qs)]:[n/g(this,Qs),n/g(this,Ws)]},tM=function(){const[t,n,s,a]=g(this,Gn),[l,c]=k(this,An,Ar).call(this,0);return[t+l,n+c,s-2*l,a-2*c]},nM=function(){const t=C(this,Gn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:a}of g(this,Ni)){if(a.length<=12){for(let d=4,h=a.length;d<h;d+=6){const[p,v]=a.subarray(d,d+2);t[0]=Math.min(t[0],p),t[1]=Math.min(t[1],v),t[2]=Math.max(t[2],p),t[3]=Math.max(t[3],v)}continue}let l=a[4],c=a[5];for(let d=6,h=a.length;d<h;d+=6){const[p,v,_,x,A,E]=a.subarray(d,d+6);xe.bezierBoundingBox(l,c,p,v,_,x,A,E,t),l=A,c=E}}const[n,s]=k(this,An,Ar).call(this);t[0]=Math.min(1,Math.max(0,t[0]-n)),t[1]=Math.min(1,Math.max(0,t[1]-s)),t[2]=Math.min(1,Math.max(0,t[2]+n)),t[3]=Math.min(1,Math.max(0,t[3]+s)),t[2]-=t[0],t[3]-=t[1]},iM=function(t){const[n,s]=k(this,An,Ar).call(this);C(this,xd,t);const[a,l]=k(this,An,Ar).call(this),[c,d]=[a-n,l-s],h=g(this,Gn);return h[0]-=c,h[1]-=d,h[2]+=2*c,h[3]+=2*d,h};let s0=bx;var Sd;const _x=class _x extends fL{constructor(t){super();M(this,Sd);C(this,Sd,t),super.updateProperties({fill:"none",stroke:Rt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,n){t==="stroke-width"&&(n??(n=this["stroke-width"]),n*=g(this,Sd).realScale),super.updateSVGProperty(t,n)}clone(){const t=new _x(g(this,Sd));return t.updateAll(this),t}};Sd=new WeakMap;let X_=_x;var D0,sM;const yu=class yu extends j_{constructor(t){super({...t,name:"inkEditor"});M(this,D0);this._willKeepAspectRatio=!0}static initialize(t,n){Rt.initialize(t,n),this._defaultDrawingOptions=new X_(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ve(this,"typesMap",new Map([[Xe.INK_THICKNESS,"stroke-width"],[Xe.INK_COLOR,"stroke"],[Xe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,s,a,l){return new pL(t,n,s,a,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,s,a,l,c){return s0.deserialize(t,n,s,a,l,c)}static async deserialize(t,n,s){let a=null;if(t instanceof Yw){const{data:{inkLists:c,rect:d,rotation:h,id:p,color:v,opacity:_,borderStyle:{rawWidth:x},popupRef:A},parent:{page:{pageNumber:E}}}=t;a=t={annotationType:He.INK,color:Array.from(v),thickness:x,opacity:_,paths:{points:c},boxes:null,pageIndex:E-1,rect:d.slice(0),rotation:h,id:p,deleted:!1,popupRef:A}}const l=await super.deserialize(t,n,s);return l.annotationElementId=t.id||null,l._initialData=a,l}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:s}=this;n.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:s}){this._drawingOptions=yu.getDefaultDrawingOptions({stroke:xe.makeHexColor(...t),"stroke-width":n,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:s,rect:a}=this.serializeDraw(t),{_drawingOptions:{stroke:l,"stroke-opacity":c,"stroke-width":d}}=this,h={annotationType:He.INK,color:Rt._colorManager.convert(l),opacity:c,thickness:d,paths:{lines:n,points:s},pageIndex:this.pageIndex,rect:a,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?h:this.annotationElementId&&!k(this,D0,sM).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(t){const{points:n,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:n}),null}};D0=new WeakSet,sM=function(t){const{color:n,thickness:s,opacity:a,pageIndex:l}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((c,d)=>c!==n[d])||t.thickness!==s||t.opacity!==a||t.pageIndex!==l},Re(yu,"_type","ink"),Re(yu,"_editorType",He.INK),Re(yu,"_defaultDrawingOptions",null);let W_=yu;var Tt,Sn,lo,Jr,co,Ad,Zs,er,Mi,Ed,et,Yh,Kh,$m,Z_,jm,ew,Ym,rM;const ef=class ef extends Rt{constructor(t){super({...t,name:"stampEditor"});M(this,et);M(this,Tt,null);M(this,Sn,null);M(this,lo,null);M(this,Jr,null);M(this,co,null);M(this,Ad,"");M(this,Zs,null);M(this,er,null);M(this,Mi,!1);M(this,Ed,!1);C(this,Jr,t.bitmapUrl),C(this,co,t.bitmapFile)}static initialize(t,n){Rt.initialize(t,n)}static get supportedTypes(){return Ve(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(n=>`image/${n}`))}static get supportedTypesStr(){return Ve(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,n){n.pasteEditor(He.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,d=await s.guess({name:"altText",request:{data:a,width:l,height:c,channels:a.length/(l*c)}});if(!d)throw new Error("No response from the AI service.");if(d.error)throw new Error("Error from the AI service.");if(d.cancel)return null;if(!d.output)throw new Error("No valid response from the AI service.");const h=d.output;return await this.setGuessedAltText(h),n&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}remove(){var t;g(this,Sn)&&(C(this,Tt,null),this._uiManager.imageManager.deleteId(g(this,Sn)),(t=g(this,Zs))==null||t.remove(),C(this,Zs,null),g(this,er)&&(clearTimeout(g(this,er)),C(this,er,null))),super.remove()}rebuild(){if(!this.parent){g(this,Sn)&&k(this,et,$m).call(this);return}super.rebuild(),this.div!==null&&(g(this,Sn)&&g(this,Zs)===null&&k(this,et,$m).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(g(this,lo)||g(this,Tt)||g(this,Jr)||g(this,co)||g(this,Sn))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;if(this.width&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),g(this,Tt)?k(this,et,Z_).call(this):k(this,et,$m).call(this),this.width&&!this.annotationElementId){const[s,a]=this.parentDimensions;this.setAt(t*s,n*a,this.width*s,this.height*a)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;g(this,er)!==null&&clearTimeout(g(this,er)),C(this,er,setTimeout(()=>{C(this,er,null),k(this,et,ew).call(this)},200))}copyCanvas(t,n,s=!1){var x;t||(t=224);const{width:a,height:l}=g(this,Tt),c=new Xb;let d=g(this,Tt),h=a,p=l,v=null;if(n){if(a>n||l>n){const X=Math.min(n/a,n/l);h=Math.floor(a*X),p=Math.floor(l*X)}v=document.createElement("canvas");const A=v.width=Math.ceil(h*c.sx),E=v.height=Math.ceil(p*c.sy);g(this,Mi)||(d=k(this,et,jm).call(this,A,E));const R=v.getContext("2d");R.filter=this._uiManager.hcmFilter;let N="white",D="#cfcfd8";this._uiManager.hcmFilter!=="none"?D="black":(x=window.matchMedia)!=null&&x.call(window,"(prefers-color-scheme: dark)").matches&&(N="#8f8f9d",D="#42414d");const P=15,L=P*c.sx,B=P*c.sy,H=new OffscreenCanvas(L*2,B*2),O=H.getContext("2d");O.fillStyle=N,O.fillRect(0,0,L*2,B*2),O.fillStyle=D,O.fillRect(0,0,L,B),O.fillRect(L,B,L,B),R.fillStyle=R.createPattern(H,"repeat"),R.fillRect(0,0,A,E),R.drawImage(d,0,0,d.width,d.height,0,0,A,E)}let _=null;if(s){let A,E;if(c.symmetric&&d.width<t&&d.height<t)A=d.width,E=d.height;else if(d=g(this,Tt),a>t||l>t){const D=Math.min(t/a,t/l);A=Math.floor(a*D),E=Math.floor(l*D),g(this,Mi)||(d=k(this,et,jm).call(this,A,E))}const N=new OffscreenCanvas(A,E).getContext("2d",{willReadFrequently:!0});N.drawImage(d,0,0,d.width,d.height,0,0,A,E),_={width:A,height:E,data:N.getImageData(0,0,A,E).data}}return{canvas:v,width:h,height:p,imageData:_}}getImageForAltText(){return g(this,Zs)}static async deserialize(t,n,s){var E;let a=null;if(t instanceof TN){const{data:{rect:R,rotation:N,id:D,structParent:P,popupRef:L},container:B,parent:{page:{pageNumber:H}}}=t,O=B.querySelector("canvas"),X=s.imageManager.getFromCanvas(B.id,O);O.remove();const Y=((E=await n._structTree.getAriaAttributes(`${Hw}${D}`))==null?void 0:E.get("aria-label"))||"";a=t={annotationType:He.STAMP,bitmapId:X.id,bitmap:X.bitmap,pageIndex:H-1,rect:R.slice(0),rotation:N,id:D,deleted:!1,accessibilityData:{decorative:!1,altText:Y},isSvg:!1,structParent:P,popupRef:L}}const l=await super.deserialize(t,n,s),{rect:c,bitmap:d,bitmapUrl:h,bitmapId:p,isSvg:v,accessibilityData:_}=t;p&&s.imageManager.isValidId(p)?(C(l,Sn,p),d&&C(l,Tt,d)):C(l,Jr,h),C(l,Mi,v);const[x,A]=l.pageDimensions;return l.width=(c[2]-c[0])/x,l.height=(c[3]-c[1])/A,l.annotationElementId=t.id||null,_&&(l.altTextData=_),l._initialData=a,C(l,Ed,!!a),l}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:He.STAMP,bitmapId:g(this,Sn),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:g(this,Mi),structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=k(this,et,Ym).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:a,altText:l}=this.serializeAltText(!1);if(!a&&l&&(s.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const d=k(this,et,rM).call(this,s);if(d.isSame)return null;d.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,n===null)return s;n.stamps||(n.stamps=new Map);const c=g(this,Mi)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!n.stamps.has(g(this,Sn)))n.stamps.set(g(this,Sn),{area:c,serialized:s}),s.bitmap=k(this,et,Ym).call(this,!1);else if(g(this,Mi)){const d=n.stamps.get(g(this,Sn));c>d.area&&(d.area=c,d.serialized.bitmap.close(),d.serialized.bitmap=k(this,et,Ym).call(this,!1))}return s}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};Tt=new WeakMap,Sn=new WeakMap,lo=new WeakMap,Jr=new WeakMap,co=new WeakMap,Ad=new WeakMap,Zs=new WeakMap,er=new WeakMap,Mi=new WeakMap,Ed=new WeakMap,et=new WeakSet,Yh=function(t,n=!1){if(!t){this.remove();return}C(this,Tt,t.bitmap),n||(C(this,Sn,t.id),C(this,Mi,t.isSvg)),t.file&&C(this,Ad,t.file.name),k(this,et,Z_).call(this)},Kh=function(){if(C(this,lo,null),this._uiManager.enableWaiting(!1),!!g(this,Zs)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,Tt)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,Tt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},$m=function(){if(g(this,Sn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(g(this,Sn)).then(s=>k(this,et,Yh).call(this,s,!0)).finally(()=>k(this,et,Kh).call(this));return}if(g(this,Jr)){const s=g(this,Jr);C(this,Jr,null),this._uiManager.enableWaiting(!0),C(this,lo,this._uiManager.imageManager.getFromUrl(s).then(a=>k(this,et,Yh).call(this,a)).finally(()=>k(this,et,Kh).call(this)));return}if(g(this,co)){const s=g(this,co);C(this,co,null),this._uiManager.enableWaiting(!0),C(this,lo,this._uiManager.imageManager.getFromFile(s).then(a=>k(this,et,Yh).call(this,a)).finally(()=>k(this,et,Kh).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=ef.supportedTypesStr;const n=this._uiManager._signal;C(this,lo,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),k(this,et,Yh).call(this,a)}s()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:n})}).finally(()=>k(this,et,Kh).call(this))),t.click()},Z_=function(){var v;const{div:t}=this;let{width:n,height:s}=g(this,Tt);const[a,l]=this.pageDimensions,c=.75;if(this.width)n=this.width*a,s=this.height*l;else if(n>c*a||s>c*l){const _=Math.min(c*a/n,c*l/s);n*=_,s*=_}const[d,h]=this.parentDimensions;this.setDims(n*d/a,s*h/l),this._uiManager.enableWaiting(!1);const p=C(this,Zs,document.createElement("canvas"));p.setAttribute("role","img"),this.addContainer(p),this.width=n/a,this.height=s/l,(v=this._initialOptions)!=null&&v.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),k(this,et,ew).call(this),g(this,Ed)||(this.parent.addUndoableEditor(this),C(this,Ed,!0)),this._reportTelemetry({action:"inserted_image"}),g(this,Ad)&&p.setAttribute("aria-label",g(this,Ad))},jm=function(t,n){const{width:s,height:a}=g(this,Tt);let l=s,c=a,d=g(this,Tt);for(;l>2*t||c>2*n;){const h=l,p=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*n&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const v=new OffscreenCanvas(l,c);v.getContext("2d").drawImage(d,0,0,h,p,0,0,l,c),d=v.transferToImageBitmap()}return d},ew=function(){const[t,n]=this.parentDimensions,{width:s,height:a}=this,l=new Xb,c=Math.ceil(s*t*l.sx),d=Math.ceil(a*n*l.sy),h=g(this,Zs);if(!h||h.width===c&&h.height===d)return;h.width=c,h.height=d;const p=g(this,Mi)?g(this,Tt):k(this,et,jm).call(this,c,d),v=h.getContext("2d");v.filter=this._uiManager.hcmFilter,v.drawImage(p,0,0,p.width,p.height,0,0,c,d)},Ym=function(t){if(t){if(g(this,Mi)){const a=this._uiManager.imageManager.getSvgUrl(g(this,Sn));if(a)return a}const n=document.createElement("canvas");return{width:n.width,height:n.height}=g(this,Tt),n.getContext("2d").drawImage(g(this,Tt),0,0),n.toDataURL()}if(g(this,Mi)){const[n,s]=this.pageDimensions,a=Math.round(this.width*n*mo.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*mo.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(a,l);return c.getContext("2d").drawImage(g(this,Tt),0,0,g(this,Tt).width,g(this,Tt).height,0,0,a,l),c.transferToImageBitmap()}return structuredClone(g(this,Tt))},rM=function(t){var c;const{pageIndex:n,accessibilityData:{altText:s}}=this._initialData,a=t.pageIndex===n,l=(((c=t.accessibilityData)==null?void 0:c.alt)||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&a&&l,isSameAltText:l}},Re(ef,"_type","stamp"),Re(ef,"_editorType",He.STAMP);let Q_=ef;var Zl,Td,tr,uo,Xr,es,ho,Cd,ec,Ss,Wr,In,Qr,_e,fo,At,aM,Fs,nw,iw,Km;const us=class us{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:s,accessibilityManager:a,annotationLayer:l,drawLayer:c,textLayer:d,viewport:h,l10n:p}){M(this,At);M(this,Zl);M(this,Td,!1);M(this,tr,null);M(this,uo,null);M(this,Xr,null);M(this,es,new Map);M(this,ho,!1);M(this,Cd,!1);M(this,ec,!1);M(this,Ss,null);M(this,Wr,null);M(this,In,null);M(this,Qr,null);M(this,_e);const v=[...g(us,fo).values()];if(!us._initialized){us._initialized=!0;for(const _ of v)_.initialize(p,e)}e.registerEditorTypes(v),C(this,_e,e),this.pageIndex=t,this.div=n,C(this,Zl,a),C(this,tr,l),this.viewport=h,C(this,In,d),this.drawLayer=c,this._structTree=s,g(this,_e).addLayer(this)}get isEmpty(){return g(this,es).size===0}get isInvisible(){return this.isEmpty&&g(this,_e).getMode()===He.NONE}updateToolbar(e){g(this,_e).updateToolbar(e)}updateMode(e=g(this,_e).getMode()){switch(k(this,At,Km).call(this),e){case He.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case He.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case He.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of g(us,fo).values())t.toggle(`${n._type}Editing`,e===n._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=g(this,In))==null?void 0:t.div)}setEditingState(e){g(this,_e).setEditingState(e)}addCommands(e){g(this,_e).addCommands(e)}cleanUndoStack(e){g(this,_e).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=g(this,tr))==null||t.div.classList.toggle("disabled",!e)}async enable(){C(this,ec,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const n of g(this,es).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(g(this,_e).removeChangedExistingAnnotation(n),e.add(n.annotationElementId));if(!g(this,tr)){C(this,ec,!1);return}const t=g(this,tr).getEditableAnnotations();for(const n of t){if(n.hide(),g(this,_e).isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}C(this,ec,!1)}disable(){var s;C(this,Cd,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const a of g(this,es).values())if(a.disableEditing(),!!a.annotationElementId){if(a.serialize()!==null){e.set(a.annotationElementId,a);continue}else t.set(a.annotationElementId,a);(s=this.getEditableAnnotation(a.annotationElementId))==null||s.show(),a.remove()}if(g(this,tr)){const a=g(this,tr).getEditableAnnotations();for(const l of a){const{id:c}=l.data;if(g(this,_e).isDeletedAnnotationElement(c))continue;let d=t.get(c);if(d){d.resetAnnotationElement(l),d.show(!1),l.show();continue}d=e.get(c),d&&(g(this,_e).addChangedExistingAnnotation(d),d.renderAnnotationElement(l)&&d.show(!1)),l.show()}}k(this,At,Km).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const a of g(us,fo).values())n.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),C(this,Cd,!1)}getEditableAnnotation(e){var t;return((t=g(this,tr))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){g(this,_e).getActive()!==e&&g(this,_e).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=g(this,In))!=null&&e.div&&!g(this,Qr)){C(this,Qr,new AbortController);const t=g(this,_e).combinedSignal(g(this,Qr));g(this,In).div.addEventListener("pointerdown",k(this,At,aM).bind(this),{signal:t}),g(this,In).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=g(this,In))!=null&&e.div&&g(this,Qr)&&(g(this,Qr).abort(),C(this,Qr,null),g(this,In).div.classList.remove("highlighting"))}enableClick(){if(g(this,uo))return;C(this,uo,new AbortController);const e=g(this,_e).combinedSignal(g(this,uo));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=g(this,uo))==null||e.abort(),C(this,uo,null)}attach(e){g(this,es).set(e.id,e);const{annotationElementId:t}=e;t&&g(this,_e).isDeletedAnnotationElement(t)&&g(this,_e).removeDeletedAnnotationElement(e)}detach(e){var t;g(this,es).delete(e.id),(t=g(this,Zl))==null||t.removePointerInTextLayer(e.contentDiv),!g(this,Cd)&&e.annotationElementId&&g(this,_e).addDeletedAnnotationElement(e)}remove(e){this.detach(e),g(this,_e).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(g(this,_e).addDeletedAnnotationElement(e.annotationElementId),Rt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),g(this,_e).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!g(this,ec)),g(this,_e).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!g(this,Xr)&&(e._focusEventsAllowed=!1,C(this,Xr,setTimeout(()=>{C(this,Xr,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:g(this,_e)._signal}),t.focus())},0))),e._structTreeParentId=(n=g(this,Zl))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getNextId(){return g(this,_e).getId()}combinedSignal(e){return g(this,_e).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=g(this,At,Fs))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){g(this,_e).updateToolbar(e),g(this,_e).updateMode(e);const{offsetX:n,offsetY:s}=k(this,At,iw).call(this),a=this.getNextId(),l=k(this,At,nw).call(this,{parent:this,id:a,x:n,y:s,uiManager:g(this,_e),isCentered:!0,...t});l&&this.add(l)}async deserialize(e){var t;return await((t=g(us,fo).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,g(this,_e)))||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),a=k(this,At,nw).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:g(this,_e),isCentered:t,...n});return a&&this.add(a),a}addNewEditor(){this.createAndAddNewEditor(k(this,At,iw).call(this),!0)}setSelected(e){g(this,_e).setSelected(e)}toggleSelected(e){g(this,_e).toggleSelected(e)}unselect(e){g(this,_e).unselect(e)}pointerup(e){var n;const{isMac:t}=Vn.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&g(this,ho)&&(C(this,ho,!1),!((n=g(this,At,Fs))!=null&&n.isDrawer&&g(this,At,Fs).supportMultipleDrawings))){if(!g(this,Td)){C(this,Td,!0);return}if(g(this,_e).getMode()===He.STAMP){g(this,_e).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var s;if(g(this,_e).getMode()===He.HIGHLIGHT&&this.enableTextSelection(),g(this,ho)){C(this,ho,!1);return}const{isMac:t}=Vn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(C(this,ho,!0),(s=g(this,At,Fs))!=null&&s.isDrawer){this.startDrawingSession(e);return}const n=g(this,_e).getActive();C(this,Td,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus(),g(this,Ss)){g(this,At,Fs).startDrawing(this,g(this,_e),!1,e);return}g(this,_e).setCurrentDrawingSession(this),C(this,Ss,new AbortController);const t=g(this,_e).combinedSignal(g(this,Ss));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(C(this,Wr,null),this.commitOrRemove())},{signal:t}),g(this,At,Fs).startDrawing(this,g(this,_e),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&C(this,Wr,t);return}g(this,Wr)&&setTimeout(()=>{var t;(t=g(this,Wr))==null||t.focus(),C(this,Wr,null)},0)}endDrawingSession(e=!1){return g(this,Ss)?(g(this,_e).setCurrentDrawingSession(null),g(this,Ss).abort(),C(this,Ss,null),C(this,Wr,null),g(this,At,Fs).endDrawing(e)):null}findNewParent(e,t,n){const s=g(this,_e).findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return g(this,Ss)?(this.endDrawingSession(),!0):!1}onScaleChanging(){g(this,Ss)&&g(this,At,Fs).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=g(this,_e).getActive())==null?void 0:e.parent)===this&&(g(this,_e).commitOrRemove(),g(this,_e).setActiveEditor(null)),g(this,Xr)&&(clearTimeout(g(this,Xr)),C(this,Xr,null));for(const n of g(this,es).values())(t=g(this,Zl))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,g(this,es).clear(),g(this,_e).removeLayer(this)}render({viewport:e}){this.viewport=e,nc(this.div,e);for(const t of g(this,_e).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){g(this,_e).commitOrRemove(),k(this,At,Km).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,nc(this.div,{rotation:n}),t!==n)for(const s of g(this,es).values())s.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return g(this,_e).viewParameters.realScale}};Zl=new WeakMap,Td=new WeakMap,tr=new WeakMap,uo=new WeakMap,Xr=new WeakMap,es=new WeakMap,ho=new WeakMap,Cd=new WeakMap,ec=new WeakMap,Ss=new WeakMap,Wr=new WeakMap,In=new WeakMap,Qr=new WeakMap,_e=new WeakMap,fo=new WeakMap,At=new WeakSet,aM=function(e){g(this,_e).unselectAll();const{target:t}=e;if(t===g(this,In).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&g(this,In).div.contains(t)){const{isMac:n}=Vn.platform;if(e.button!==0||e.ctrlKey&&n)return;g(this,_e).showAllEditors("highlight",!0,!0),g(this,In).div.classList.add("free"),this.toggleDrawing(),i0.startHighlighting(this,g(this,_e).direction==="ltr",{target:g(this,In).div,x:e.x,y:e.y}),g(this,In).div.addEventListener("pointerup",()=>{g(this,In).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:g(this,_e)._signal}),e.preventDefault()}},Fs=function(){return g(us,fo).get(g(this,_e).getMode())},nw=function(e){const t=g(this,At,Fs);return t?new t.prototype.constructor(e):null},iw=function(){const{x:e,y:t,width:n,height:s}=this.div.getBoundingClientRect(),a=Math.max(0,e),l=Math.max(0,t),c=Math.min(window.innerWidth,e+n),d=Math.min(window.innerHeight,t+s),h=(a+c)/2-e,p=(l+d)/2-t,[v,_]=this.viewport.rotation%180===0?[h,p]:[p,h];return{offsetX:v,offsetY:_}},Km=function(){for(const e of g(this,es).values())e.isEmpty()&&e.remove()},Re(us,"_initialized",!1),M(us,fo,new Map([O_,W_,Q_,i0].map(e=>[e._editorType,e])));let tw=us;var As,Pp,zn,tc,P0,oM,ir,rw,lM,aw;const Rn=class Rn{constructor({pageIndex:e}){M(this,ir);M(this,As,null);M(this,Pp,0);M(this,zn,new Map);M(this,tc,new Map);this.pageIndex=e}setParent(e){if(!g(this,As)){C(this,As,e);return}if(g(this,As)!==e){if(g(this,zn).size>0)for(const t of g(this,zn).values())t.remove(),e.append(t);C(this,As,e)}}static get _svgFactory(){return Ve(this,"_svgFactory",new jw)}draw(e,t=!1,n=!1){const s=Un(this,Pp)._++,a=k(this,ir,rw).call(this),l=Rn._svgFactory.createElement("defs");a.append(l);const c=Rn._svgFactory.createElement("path");l.append(c);const d=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",d),c.setAttribute("vector-effect","non-scaling-stroke"),t&&g(this,tc).set(s,c);const h=n?k(this,ir,lM).call(this,l,d):null,p=Rn._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${d}`),this.updateProperties(a,e),g(this,zn).set(s,a),{id:s,clipPathId:`url(#${h})`}}drawOutline(e,t){const n=Un(this,Pp)._++,s=k(this,ir,rw).call(this),a=Rn._svgFactory.createElement("defs");s.append(a);const l=Rn._svgFactory.createElement("path");a.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let d;if(t){const v=Rn._svgFactory.createElement("mask");a.append(v),d=`mask_p${this.pageIndex}_${n}`,v.setAttribute("id",d),v.setAttribute("maskUnits","objectBoundingBox");const _=Rn._svgFactory.createElement("rect");v.append(_),_.setAttribute("width","1"),_.setAttribute("height","1"),_.setAttribute("fill","white");const x=Rn._svgFactory.createElement("use");v.append(x),x.setAttribute("href",`#${c}`),x.setAttribute("stroke","none"),x.setAttribute("fill","black"),x.setAttribute("fill-rule","nonzero"),x.classList.add("mask")}const h=Rn._svgFactory.createElement("use");s.append(h),h.setAttribute("href",`#${c}`),d&&h.setAttribute("mask",`url(#${d})`);const p=h.cloneNode();return s.append(p),h.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(s,e),g(this,zn).set(n,s),n}finalizeDraw(e,t){g(this,tc).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var d;if(!t)return;const{root:n,bbox:s,rootClass:a,path:l}=t,c=typeof e=="number"?g(this,zn).get(e):e;if(c){if(n&&k(this,ir,aw).call(this,c,n),s&&k(d=Rn,P0,oM).call(d,c,s),a){const{classList:h}=c;for(const[p,v]of Object.entries(a))h.toggle(p,v)}if(l){const p=c.firstChild.firstChild;k(this,ir,aw).call(this,p,l)}}}updateParent(e,t){if(t===this)return;const n=g(this,zn).get(e);n&&(g(t,As).append(n),g(this,zn).delete(e),g(t,zn).set(e,n))}remove(e){g(this,tc).delete(e),g(this,As)!==null&&(g(this,zn).get(e).remove(),g(this,zn).delete(e))}destroy(){C(this,As,null);for(const e of g(this,zn).values())e.remove();g(this,zn).clear(),g(this,tc).clear()}};As=new WeakMap,Pp=new WeakMap,zn=new WeakMap,tc=new WeakMap,P0=new WeakSet,oM=function(e,[t,n,s,a]){const{style:l}=e;l.top=`${100*n}%`,l.left=`${100*t}%`,l.width=`${100*s}%`,l.height=`${100*a}%`},ir=new WeakSet,rw=function(){const e=Rn._svgFactory.create(1,1,!0);return g(this,As).append(e),e.setAttribute("aria-hidden",!0),e},lM=function(e,t){const n=Rn._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const a=Rn._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${t}`),a.classList.add("clip"),s},aw=function(e,t){for(const[n,s]of Object.entries(t))s===null?e.removeAttribute(n):e.setAttribute(n,s)},M(Rn,P0);let sw=Rn;globalThis.pdfjsTestingUtils={HighlightOutliner:F_};De.AbortException;De.AnnotationEditorLayer;De.AnnotationEditorParamsType;De.AnnotationEditorType;De.AnnotationEditorUIManager;De.AnnotationLayer;De.AnnotationMode;De.ColorPicker;De.DOMSVGFactory;De.DrawLayer;De.FeatureTest;var gL=De.GlobalWorkerOptions;De.ImageKind;De.InvalidPDFException;De.MissingPDFException;De.OPS;De.OutputScale;De.PDFDataRangeTransport;De.PDFDateString;De.PDFWorker;De.PasswordResponses;De.PermissionFlag;De.PixelsPerInch;De.RenderingCancelledException;De.TextLayer;De.TouchManager;De.UnexpectedResponseException;De.Util;De.VerbosityLevel;De.XfaLayer;De.build;De.createValidAbsoluteUrl;De.fetchData;var mL=De.getDocument;De.getFilenameFromUrl;De.getPdfFilenameFromUrl;De.getXfaPageViewport;De.isDataScheme;De.isPdfFile;De.noContextMenu;De.normalizeUnicode;De.setLayerDimensions;De.shadow;De.stopEvent;De.version;gL.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.10.38/build/pdf.worker.min.mjs";const yL=async i=>{try{const e=await i.arrayBuffer(),n=await mL({data:e,cMapUrl:"https://cdn.jsdelivr.net/npm/pdfjs-dist@4.10.38/cmaps/",cMapPacked:!0}).promise;let s="";const a=n.numPages;for(let l=1;l<=a;l++){const p=(await(await n.getPage(l)).getTextContent()).items.map(v=>v.str).join(" ").replace(/\s+/g," ").trim();s+=`Page ${l}:
${p}

`}return s}catch(e){throw console.error("PDF Extraction Error:",e),new Error("    PDF.         .")}};var vL={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let bL,_L;function wL(){return{geminiUrl:bL,vertexUrl:_L}}function xL(i,e,t,n){var s,a;if(!(i!=null&&i.baseUrl)){const l=wL();return e?(s=l.vertexUrl)!==null&&s!==void 0?s:t:(a=l.geminiUrl)!==null&&a!==void 0?a:n}return i.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ra{}function ce(i,e){const t=/\{([^}]+)\}/g;return i.replace(t,(n,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const a=e[s];return a!=null?String(a):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function y(i,e,t){for(let a=0;a<e.length-1;a++){const l=e[a];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in i))if(Array.isArray(t))i[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(i[c])){const d=i[c];if(Array.isArray(t))for(let h=0;h<d.length;h++){const p=d[h];y(p,e.slice(a+1),t[h])}else for(const h of d)y(h,e.slice(a+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in i||(i[c]=[{}]);const d=i[c];y(d[0],e.slice(a+1),t);return}(!i[l]||typeof i[l]!="object")&&(i[l]={}),i=i[l]}const n=e[e.length-1],s=i[n];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(i,t):i[n]=t}function m(i,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return i;for(let n=0;n<e.length;n++){if(typeof i!="object"||i===null)return t;const s=e[n];if(s.endsWith("[]")){const a=s.slice(0,-2);if(a in i){const l=i[a];return Array.isArray(l)?l.map(c=>m(c,e.slice(n+1),t)):t}else return t}else i=i[s]}return i}catch(n){if(n instanceof TypeError)return t;throw n}}function SL(i,e){for(const[t,n]of Object.entries(e)){const s=t.split("."),a=n.split("."),l=new Set;let c=-1;for(let d=0;d<s.length;d++)if(s[d]==="*"){c=d;break}if(c!==-1&&a.length>c)for(let d=c;d<a.length;d++){const h=a[d];h!=="*"&&!h.endsWith("[]")&&!h.endsWith("[0]")&&l.add(h)}ow(i,s,a,0,l)}}function ow(i,e,t,n,s){if(n>=e.length||typeof i!="object"||i===null)return;const a=e[n];if(a.endsWith("[]")){const l=a.slice(0,-2),c=i;if(l in c&&Array.isArray(c[l]))for(const d of c[l])ow(d,e,t,n+1,s)}else if(a==="*"){if(typeof i=="object"&&i!==null&&!Array.isArray(i)){const l=i,c=Object.keys(l).filter(h=>!h.startsWith("_")&&!s.has(h)),d={};for(const h of c)d[h]=l[h];for(const[h,p]of Object.entries(d)){const v=[];for(const _ of t.slice(n))_==="*"?v.push(h):v.push(_);y(l,v,p)}for(const h of c)delete l[h]}}else{const l=i;a in l&&ow(l[a],e,t,n+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Kw(i){if(typeof i!="string")throw new Error("fromImageBytes must be a string");return i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AL(i){const e={},t=m(i,["operationName"]);t!=null&&y(e,["operationName"],t);const n=m(i,["resourceName"]);return n!=null&&y(e,["_url","resourceName"],n),e}function EL(i){const e={},t=m(i,["name"]);t!=null&&y(e,["name"],t);const n=m(i,["metadata"]);n!=null&&y(e,["metadata"],n);const s=m(i,["done"]);s!=null&&y(e,["done"],s);const a=m(i,["error"]);a!=null&&y(e,["error"],a);const l=m(i,["response","generateVideoResponse"]);return l!=null&&y(e,["response"],CL(l)),e}function TL(i){const e={},t=m(i,["name"]);t!=null&&y(e,["name"],t);const n=m(i,["metadata"]);n!=null&&y(e,["metadata"],n);const s=m(i,["done"]);s!=null&&y(e,["done"],s);const a=m(i,["error"]);a!=null&&y(e,["error"],a);const l=m(i,["response"]);return l!=null&&y(e,["response"],RL(l)),e}function CL(i){const e={},t=m(i,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>NL(l))),y(e,["generatedVideos"],a)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&y(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&y(e,["raiMediaFilteredReasons"],s),e}function RL(i){const e={},t=m(i,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>ML(l))),y(e,["generatedVideos"],a)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&y(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&y(e,["raiMediaFilteredReasons"],s),e}function NL(i){const e={},t=m(i,["video"]);return t!=null&&y(e,["video"],OL(t)),e}function ML(i){const e={},t=m(i,["_self"]);return t!=null&&y(e,["video"],UL(t)),e}function kL(i){const e={},t=m(i,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function IL(i){const e={},t=m(i,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function DL(i){const e={},t=m(i,["name"]);t!=null&&y(e,["name"],t);const n=m(i,["metadata"]);n!=null&&y(e,["metadata"],n);const s=m(i,["done"]);s!=null&&y(e,["done"],s);const a=m(i,["error"]);a!=null&&y(e,["error"],a);const l=m(i,["response"]);return l!=null&&y(e,["response"],PL(l)),e}function PL(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&y(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&y(e,["documentName"],s),e}function cM(i){const e={},t=m(i,["name"]);t!=null&&y(e,["name"],t);const n=m(i,["metadata"]);n!=null&&y(e,["metadata"],n);const s=m(i,["done"]);s!=null&&y(e,["done"],s);const a=m(i,["error"]);a!=null&&y(e,["error"],a);const l=m(i,["response"]);return l!=null&&y(e,["response"],LL(l)),e}function LL(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&y(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&y(e,["documentName"],s),e}function OL(i){const e={},t=m(i,["uri"]);t!=null&&y(e,["uri"],t);const n=m(i,["encodedVideo"]);n!=null&&y(e,["videoBytes"],Kw(n));const s=m(i,["encoding"]);return s!=null&&y(e,["mimeType"],s),e}function UL(i){const e={},t=m(i,["gcsUri"]);t!=null&&y(e,["uri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&y(e,["videoBytes"],Kw(n));const s=m(i,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var QT;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(QT||(QT={}));var ZT;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})(ZT||(ZT={}));var e1;(function(i){i.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",i.SILENT="SILENT",i.WHEN_IDLE="WHEN_IDLE",i.INTERRUPT="INTERRUPT"})(e1||(e1={}));var Qt;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT",i.NULL="NULL"})(Qt||(Qt={}));var t1;(function(i){i.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",i.SIMPLE_SEARCH="SIMPLE_SEARCH",i.ELASTIC_SEARCH="ELASTIC_SEARCH"})(t1||(t1={}));var n1;(function(i){i.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",i.NO_AUTH="NO_AUTH",i.API_KEY_AUTH="API_KEY_AUTH",i.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",i.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",i.OAUTH="OAUTH",i.OIDC_AUTH="OIDC_AUTH"})(n1||(n1={}));var i1;(function(i){i.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",i.HTTP_IN_QUERY="HTTP_IN_QUERY",i.HTTP_IN_HEADER="HTTP_IN_HEADER",i.HTTP_IN_PATH="HTTP_IN_PATH",i.HTTP_IN_BODY="HTTP_IN_BODY",i.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(i1||(i1={}));var s1;(function(i){i.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",i.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",i.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",i.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(s1||(s1={}));var r1;(function(i){i.UNSPECIFIED="UNSPECIFIED",i.BLOCKING="BLOCKING",i.NON_BLOCKING="NON_BLOCKING"})(r1||(r1={}));var a1;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(a1||(a1={}));var o1;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE",i.VALIDATED="VALIDATED"})(o1||(o1={}));var l1;(function(i){i.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH",i.MINIMAL="MINIMAL"})(l1||(l1={}));var c1;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",i.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",i.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",i.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",i.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(c1||(c1={}));var u1;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(u1||(u1={}));var d1;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(d1||(d1={}));var h1;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY",i.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",i.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",i.NO_IMAGE="NO_IMAGE",i.IMAGE_RECITATION="IMAGE_RECITATION",i.IMAGE_OTHER="IMAGE_OTHER"})(h1||(h1={}));var f1;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(f1||(f1={}));var p1;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(p1||(p1={}));var g1;(function(i){i.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",i.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",i.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",i.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",i.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(g1||(g1={}));var m1;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.IMAGE_SAFETY="IMAGE_SAFETY",i.MODEL_ARMOR="MODEL_ARMOR",i.JAILBREAK="JAILBREAK"})(m1||(m1={}));var y1;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(y1||(y1={}));var r0;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})(r0||(r0={}));var v1;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(v1||(v1={}));var b1;(function(i){i.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",i.TUNING_MODE_FULL="TUNING_MODE_FULL",i.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(b1||(b1={}));var _1;(function(i){i.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",i.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",i.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",i.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",i.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",i.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",i.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(_1||(_1={}));var lw;(function(i){i.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",i.JOB_STATE_QUEUED="JOB_STATE_QUEUED",i.JOB_STATE_PENDING="JOB_STATE_PENDING",i.JOB_STATE_RUNNING="JOB_STATE_RUNNING",i.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",i.JOB_STATE_FAILED="JOB_STATE_FAILED",i.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",i.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",i.JOB_STATE_PAUSED="JOB_STATE_PAUSED",i.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",i.JOB_STATE_UPDATING="JOB_STATE_UPDATING",i.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(lw||(lw={}));var w1;(function(i){i.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",i.TUNING_TASK_I2V="TUNING_TASK_I2V",i.TUNING_TASK_T2V="TUNING_TASK_T2V",i.TUNING_TASK_R2V="TUNING_TASK_R2V"})(w1||(w1={}));var x1;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",i.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(x1||(x1={}));var S1;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(S1||(S1={}));var A1;(function(i){i.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",i.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(A1||(A1={}));var E1;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(E1||(E1={}));var T1;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})(T1||(T1={}));var C1;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi",i.zh="zh",i.pt="pt",i.es="es"})(C1||(C1={}));var R1;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(R1||(R1={}));var N1;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(N1||(N1={}));var M1;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(M1||(M1={}));var k1;(function(i){i.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",i.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",i.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",i.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",i.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",i.EDIT_MODE_STYLE="EDIT_MODE_STYLE",i.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",i.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(k1||(k1={}));var I1;(function(i){i.FOREGROUND="FOREGROUND",i.BACKGROUND="BACKGROUND",i.PROMPT="PROMPT",i.SEMANTIC="SEMANTIC",i.INTERACTIVE="INTERACTIVE"})(I1||(I1={}));var D1;(function(i){i.ASSET="ASSET",i.STYLE="STYLE"})(D1||(D1={}));var P1;(function(i){i.INSERT="INSERT",i.REMOVE="REMOVE",i.REMOVE_STATIC="REMOVE_STATIC",i.OUTPAINT="OUTPAINT"})(P1||(P1={}));var L1;(function(i){i.OPTIMIZED="OPTIMIZED",i.LOSSLESS="LOSSLESS"})(L1||(L1={}));var O1;(function(i){i.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",i.PREFERENCE_TUNING="PREFERENCE_TUNING"})(O1||(O1={}));var U1;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.STATE_PENDING="STATE_PENDING",i.STATE_ACTIVE="STATE_ACTIVE",i.STATE_FAILED="STATE_FAILED"})(U1||(U1={}));var F1;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(F1||(F1={}));var H1;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED",i.REGISTERED="REGISTERED"})(H1||(H1={}));var B1;(function(i){i.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.RESPONSE_REJECTED="RESPONSE_REJECTED",i.NEED_MORE_INPUT="NEED_MORE_INPUT"})(B1||(B1={}));var G1;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(G1||(G1={}));var z1;(function(i){i.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",i.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",i.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(z1||(z1={}));var q1;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(q1||(q1={}));var V1;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(V1||(V1={}));var $1;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})($1||($1={}));var j1;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(j1||(j1={}));var Y1;(function(i){i.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",i.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",i.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",i.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",i.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",i.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",i.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",i.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",i.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",i.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",i.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",i.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",i.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Y1||(Y1={}));var K1;(function(i){i.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",i.QUALITY="QUALITY",i.DIVERSITY="DIVERSITY",i.VOCALIZATION="VOCALIZATION"})(K1||(K1={}));var fu;(function(i){i.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",i.PLAY="PLAY",i.PAUSE="PAUSE",i.STOP="STOP",i.RESET_CONTEXT="RESET_CONTEXT"})(fu||(fu={}));class cw{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class kh{get text(){var e,t,n,s,a,l,c,d;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",p=!1;const v=[];for(const _ of(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[x,A]of Object.entries(_))x!=="text"&&x!=="thought"&&x!=="thoughtSignature"&&(A!==null||A!==void 0)&&v.push(x);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;p=!0,h+=_.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?h:void 0}get data(){var e,t,n,s,a,l,c,d;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const p=[];for(const v of(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[_,x]of Object.entries(v))_!=="inlineData"&&(x!==null||x!==void 0)&&p.push(_);v.inlineData&&typeof v.inlineData.data=="string"&&(h+=atob(v.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var e,t,n,s,a,l,c,d;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var e,t,n,s,a,l,c,d,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((p==null?void 0:p.length)!==0)return(h=p==null?void 0:p[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var e,t,n,s,a,l,c,d,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(d=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((p==null?void 0:p.length)!==0)return(h=p==null?void 0:p[0])===null||h===void 0?void 0:h.output}}class J1{}class X1{}class FL{}class HL{}class BL{}class GL{}class W1{}class Q1{}class Z1{}class zL{}class a0{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new a0;let s;const a=e;return t?s=TL(a):s=EL(a),Object.assign(n,s),n}}class eC{}class tC{}class nC{}class iC{}class qL{}class VL{}class $L{}class Jw{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new Jw,a=DL(e);return Object.assign(n,a),n}}class jL{}class YL{}class KL{}class sC{}class JL{get text(){var e,t,n;let s="",a=!1;const l=[];for(const c of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[d,h]of Object.entries(c))d!=="text"&&d!=="thought"&&h!==null&&l.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;a=!0,s+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?s:void 0}get data(){var e,t,n;let s="";const a=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[c,d]of Object.entries(l))c!=="inlineData"&&d!==null&&a.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(s+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class XL{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Xw{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new Xw,a=cM(e);return Object.assign(n,a),n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tt(i,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(i.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function uM(i,e){const t=tt(i,e);return t?t.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:t.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${t}`:t:""}function dM(i){return Array.isArray(i)?i.map(e=>o0(e)):[o0(i)]}function o0(i){if(typeof i=="object"&&i!==null)return i;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof i}`)}function hM(i){const e=o0(i);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function fM(i){const e=o0(i);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function rC(i){if(i==null)throw new Error("PartUnion is required");if(typeof i=="object")return i;if(typeof i=="string")return{text:i};throw new Error(`Unsupported part type: ${typeof i}`)}function pM(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("PartListUnion is required");return Array.isArray(i)?i.map(e=>rC(e)):[rC(i)]}function uw(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function aC(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function oC(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function Ln(i){if(i==null)throw new Error("ContentUnion is required");return uw(i)?i:{role:"user",parts:pM(i)}}function Ww(i,e){if(!e)return[];if(i.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=Ln(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const t=Ln(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Ln(t)):[Ln(e)]}function is(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("contents are required");if(!Array.isArray(i)){if(aC(i)||oC(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ln(i)]}const e=[],t=[],n=uw(i[0]);for(const s of i){const a=uw(s);if(a!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(s);else{if(aC(s)||oC(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return n||e.push({role:"user",parts:pM(t)}),e}function WL(i,e){i.includes("null")&&(e.nullable=!0);const t=i.filter(n=>n!=="null");if(t.length===1)e.type=Object.values(Qt).includes(t[0].toUpperCase())?t[0].toUpperCase():Qt.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.values(Qt).includes(n.toUpperCase())?n.toUpperCase():Qt.TYPE_UNSPECIFIED})}}function _u(i){const e={},t=["items"],n=["anyOf"],s=["properties"];if(i.type&&i.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=i.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,i=a[1]):a[1].type==="null"&&(e.nullable=!0,i=a[0])),i.type instanceof Array&&WL(i.type,e);for(const[l,c]of Object.entries(i))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(Qt).includes(c.toUpperCase())?c.toUpperCase():Qt.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=_u(c);else if(n.includes(l)){const d=[];for(const h of c){if(h.type=="null"){e.nullable=!0;continue}d.push(_u(h))}e[l]=d}else if(s.includes(l)){const d={};for(const[h,p]of Object.entries(c))d[h]=_u(p);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=c}return e}function Qw(i){return _u(i)}function Zw(i){if(typeof i=="object")return i;if(typeof i=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:i}}};throw new Error(`Unsupported speechConfig type: ${typeof i}`)}function ex(i){if("multiSpeakerVoiceConfig"in i)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return i}function Md(i){if(i.functionDeclarations)for(const e of i.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=_u(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=_u(e.response));return i}function kd(i){if(i==null)throw new Error("tools is required");if(!Array.isArray(i))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of i)e.push(t);return e}function QL(i,e,t,n=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===n;return i.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${i.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:s?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function aa(i,e){if(typeof e!="string")throw new Error("name must be a string");return QL(i,e,"cachedContents")}function gM(i){switch(i){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return i}}function bo(i){return Kw(i)}function ZL(i){return i!=null&&typeof i=="object"&&"name"in i}function eO(i){return i!=null&&typeof i=="object"&&"video"in i}function tO(i){return i!=null&&typeof i=="object"&&"uri"in i}function mM(i){var e;let t;if(ZL(i)&&(t=i.name),!(tO(i)&&(t=i.uri,t===void 0))&&!(eO(i)&&(t=(e=i.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof i=="string"&&(t=i),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function yM(i,e){let t;return i.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function vM(i){for(const e of["models","tunedModels","publisherModels"])if(nO(i,e))return i[e];return[]}function nO(i,e){return i!==null&&typeof i=="object"&&e in i}function iO(i,e={}){const t=i,n={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(n.responseJsonSchema=t.outputSchema),e.behavior&&(n.behavior=e.behavior),{functionDeclarations:[n]}}function sO(i,e={}){const t=[],n=new Set;for(const s of i){const a=s.name;if(n.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);n.add(a);const l=iO(s,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function bM(i,e){let t;if(typeof e=="string")if(i.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(i.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const n=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(i.isVertexAI()){if(s>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function rO(i){if(typeof i!="string")return i;const e=i;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function _M(i){if(typeof i!="object"||i===null)return{};const e=i,t=e.inlinedResponses;if(typeof t!="object"||t===null)return i;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return i;let a=!1;for(const l of s){if(typeof l!="object"||l===null)continue;const d=l.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),i}function Id(i,e){const t=e;if(!i.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function wM(i){const e=i;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aO(i){const e={},t=m(i,["responsesFile"]);t!=null&&y(e,["fileName"],t);const n=m(i,["inlinedResponses","inlinedResponses"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>BO(l))),y(e,["inlinedResponses"],a)}const s=m(i,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["inlinedEmbedContentResponses"],a)}return e}function oO(i){const e={},t=m(i,["predictionsFormat"]);t!=null&&y(e,["format"],t);const n=m(i,["gcsDestination","outputUriPrefix"]);n!=null&&y(e,["gcsUri"],n);const s=m(i,["bigqueryDestination","outputUri"]);return s!=null&&y(e,["bigqueryUri"],s),e}function lO(i){const e={},t=m(i,["format"]);t!=null&&y(e,["predictionsFormat"],t);const n=m(i,["gcsUri"]);n!=null&&y(e,["gcsDestination","outputUriPrefix"],n);const s=m(i,["bigqueryUri"]);if(s!=null&&y(e,["bigqueryDestination","outputUri"],s),m(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(i,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(m(i,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Jm(i){const e={},t=m(i,["name"]);t!=null&&y(e,["name"],t);const n=m(i,["metadata","displayName"]);n!=null&&y(e,["displayName"],n);const s=m(i,["metadata","state"]);s!=null&&y(e,["state"],wM(s));const a=m(i,["metadata","createTime"]);a!=null&&y(e,["createTime"],a);const l=m(i,["metadata","endTime"]);l!=null&&y(e,["endTime"],l);const c=m(i,["metadata","updateTime"]);c!=null&&y(e,["updateTime"],c);const d=m(i,["metadata","model"]);d!=null&&y(e,["model"],d);const h=m(i,["metadata","output"]);return h!=null&&y(e,["dest"],aO(_M(h))),e}function dw(i){const e={},t=m(i,["name"]);t!=null&&y(e,["name"],t);const n=m(i,["displayName"]);n!=null&&y(e,["displayName"],n);const s=m(i,["state"]);s!=null&&y(e,["state"],wM(s));const a=m(i,["error"]);a!=null&&y(e,["error"],a);const l=m(i,["createTime"]);l!=null&&y(e,["createTime"],l);const c=m(i,["startTime"]);c!=null&&y(e,["startTime"],c);const d=m(i,["endTime"]);d!=null&&y(e,["endTime"],d);const h=m(i,["updateTime"]);h!=null&&y(e,["updateTime"],h);const p=m(i,["model"]);p!=null&&y(e,["model"],p);const v=m(i,["inputConfig"]);v!=null&&y(e,["src"],cO(v));const _=m(i,["outputConfig"]);_!=null&&y(e,["dest"],oO(_M(_)));const x=m(i,["completionStats"]);return x!=null&&y(e,["completionStats"],x),e}function cO(i){const e={},t=m(i,["instancesFormat"]);t!=null&&y(e,["format"],t);const n=m(i,["gcsSource","uris"]);n!=null&&y(e,["gcsUri"],n);const s=m(i,["bigquerySource","inputUri"]);return s!=null&&y(e,["bigqueryUri"],s),e}function uO(i,e){const t={};if(m(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(m(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=m(e,["fileName"]);n!=null&&y(t,["fileName"],n);const s=m(e,["inlinedRequests"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>HO(i,l))),y(t,["requests","requests"],a)}return t}function dO(i){const e={},t=m(i,["format"]);t!=null&&y(e,["instancesFormat"],t);const n=m(i,["gcsUri"]);n!=null&&y(e,["gcsSource","uris"],n);const s=m(i,["bigqueryUri"]);if(s!=null&&y(e,["bigquerySource","inputUri"],s),m(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(i,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function hO(i){const e={},t=m(i,["data"]);if(t!=null&&y(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function fO(i,e){const t={},n=m(e,["name"]);return n!=null&&y(t,["_url","name"],Id(i,n)),t}function pO(i,e){const t={},n=m(e,["name"]);return n!=null&&y(t,["_url","name"],Id(i,n)),t}function gO(i){const e={},t=m(i,["content"]);t!=null&&y(e,["content"],t);const n=m(i,["citationMetadata"]);n!=null&&y(e,["citationMetadata"],mO(n));const s=m(i,["tokenCount"]);s!=null&&y(e,["tokenCount"],s);const a=m(i,["finishReason"]);a!=null&&y(e,["finishReason"],a);const l=m(i,["avgLogprobs"]);l!=null&&y(e,["avgLogprobs"],l);const c=m(i,["groundingMetadata"]);c!=null&&y(e,["groundingMetadata"],c);const d=m(i,["index"]);d!=null&&y(e,["index"],d);const h=m(i,["logprobsResult"]);h!=null&&y(e,["logprobsResult"],h);const p=m(i,["safetyRatings"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(x=>x)),y(e,["safetyRatings"],_)}const v=m(i,["urlContextMetadata"]);return v!=null&&y(e,["urlContextMetadata"],v),e}function mO(i){const e={},t=m(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),y(e,["citations"],n)}return e}function xM(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>YO(a))),y(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&y(e,["role"],n),e}function yO(i,e){const t={},n=m(i,["displayName"]);if(e!==void 0&&n!=null&&y(e,["batch","displayName"],n),m(i,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function vO(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&y(e,["displayName"],n);const s=m(i,["dest"]);return e!==void 0&&s!=null&&y(e,["outputConfig"],lO(rO(s))),t}function lC(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["src"]);s!=null&&y(t,["batch","inputConfig"],uO(i,bM(i,s)));const a=m(e,["config"]);return a!=null&&yO(a,t),t}function bO(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["model"],tt(i,n));const s=m(e,["src"]);s!=null&&y(t,["inputConfig"],dO(bM(i,s)));const a=m(e,["config"]);return a!=null&&vO(a,t),t}function _O(i,e){const t={},n=m(i,["displayName"]);return e!==void 0&&n!=null&&y(e,["batch","displayName"],n),t}function wO(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["src"]);s!=null&&y(t,["batch","inputConfig"],RO(i,s));const a=m(e,["config"]);return a!=null&&_O(a,t),t}function xO(i,e){const t={},n=m(e,["name"]);return n!=null&&y(t,["_url","name"],Id(i,n)),t}function SO(i,e){const t={},n=m(e,["name"]);return n!=null&&y(t,["_url","name"],Id(i,n)),t}function AO(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["name"]);n!=null&&y(e,["name"],n);const s=m(i,["done"]);s!=null&&y(e,["done"],s);const a=m(i,["error"]);return a!=null&&y(e,["error"],a),e}function EO(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["name"]);n!=null&&y(e,["name"],n);const s=m(i,["done"]);s!=null&&y(e,["done"],s);const a=m(i,["error"]);return a!=null&&y(e,["error"],a),e}function TO(i,e){const t={},n=m(e,["contents"]);if(n!=null){let a=Ww(i,n);Array.isArray(a)&&(a=a.map(l=>l)),y(t,["requests[]","request","content"],a)}const s=m(e,["config"]);return s!=null&&(y(t,["_self"],CO(s,t)),SL(t,{"requests[].*":"requests[].request.*"})),t}function CO(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&y(e,["requests[]","taskType"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&y(e,["requests[]","title"],s);const a=m(i,["outputDimensionality"]);if(e!==void 0&&a!=null&&y(e,["requests[]","outputDimensionality"],a),m(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function RO(i,e){const t={},n=m(e,["fileName"]);n!=null&&y(t,["file_name"],n);const s=m(e,["inlinedRequests"]);return s!=null&&y(t,["requests"],TO(i,s)),t}function NO(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&y(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function MO(i){const e={},t=m(i,["id"]);t!=null&&y(e,["id"],t);const n=m(i,["args"]);n!=null&&y(e,["args"],n);const s=m(i,["name"]);if(s!=null&&y(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function kO(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&y(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&y(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function IO(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&y(t,["systemInstruction"],xM(Ln(s)));const a=m(e,["temperature"]);a!=null&&y(n,["temperature"],a);const l=m(e,["topP"]);l!=null&&y(n,["topP"],l);const c=m(e,["topK"]);c!=null&&y(n,["topK"],c);const d=m(e,["candidateCount"]);d!=null&&y(n,["candidateCount"],d);const h=m(e,["maxOutputTokens"]);h!=null&&y(n,["maxOutputTokens"],h);const p=m(e,["stopSequences"]);p!=null&&y(n,["stopSequences"],p);const v=m(e,["responseLogprobs"]);v!=null&&y(n,["responseLogprobs"],v);const _=m(e,["logprobs"]);_!=null&&y(n,["logprobs"],_);const x=m(e,["presencePenalty"]);x!=null&&y(n,["presencePenalty"],x);const A=m(e,["frequencyPenalty"]);A!=null&&y(n,["frequencyPenalty"],A);const E=m(e,["seed"]);E!=null&&y(n,["seed"],E);const R=m(e,["responseMimeType"]);R!=null&&y(n,["responseMimeType"],R);const N=m(e,["responseSchema"]);N!=null&&y(n,["responseSchema"],Qw(N));const D=m(e,["responseJsonSchema"]);if(D!=null&&y(n,["responseJsonSchema"],D),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=m(e,["safetySettings"]);if(t!==void 0&&P!=null){let be=P;Array.isArray(be)&&(be=be.map(ye=>KO(ye))),y(t,["safetySettings"],be)}const L=m(e,["tools"]);if(t!==void 0&&L!=null){let be=kd(L);Array.isArray(be)&&(be=be.map(ye=>XO(Md(ye)))),y(t,["tools"],be)}const B=m(e,["toolConfig"]);if(t!==void 0&&B!=null&&y(t,["toolConfig"],JO(B)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=m(e,["cachedContent"]);t!==void 0&&H!=null&&y(t,["cachedContent"],aa(i,H));const O=m(e,["responseModalities"]);O!=null&&y(n,["responseModalities"],O);const X=m(e,["mediaResolution"]);X!=null&&y(n,["mediaResolution"],X);const Y=m(e,["speechConfig"]);if(Y!=null&&y(n,["speechConfig"],Zw(Y)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const se=m(e,["thinkingConfig"]);se!=null&&y(n,["thinkingConfig"],se);const re=m(e,["imageConfig"]);re!=null&&y(n,["imageConfig"],FO(re));const ne=m(e,["enableEnhancedCivicAnswers"]);return ne!=null&&y(n,["enableEnhancedCivicAnswers"],ne),n}function DO(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>gO(h))),y(e,["candidates"],d)}const s=m(i,["modelVersion"]);s!=null&&y(e,["modelVersion"],s);const a=m(i,["promptFeedback"]);a!=null&&y(e,["promptFeedback"],a);const l=m(i,["responseId"]);l!=null&&y(e,["responseId"],l);const c=m(i,["usageMetadata"]);return c!=null&&y(e,["usageMetadata"],c),e}function PO(i,e){const t={},n=m(e,["name"]);return n!=null&&y(t,["_url","name"],Id(i,n)),t}function LO(i,e){const t={},n=m(e,["name"]);return n!=null&&y(t,["_url","name"],Id(i,n)),t}function OO(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function UO(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function FO(i){const e={},t=m(i,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const n=m(i,["imageSize"]);if(n!=null&&y(e,["imageSize"],n),m(i,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(i,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(i,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function HO(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["request","model"],tt(i,n));const s=m(e,["contents"]);if(s!=null){let c=is(s);Array.isArray(c)&&(c=c.map(d=>xM(d))),y(t,["request","contents"],c)}const a=m(e,["metadata"]);a!=null&&y(t,["metadata"],a);const l=m(e,["config"]);return l!=null&&y(t,["request","generationConfig"],IO(i,l,m(t,["request"],{}))),t}function BO(i){const e={},t=m(i,["response"]);t!=null&&y(e,["response"],DO(t));const n=m(i,["error"]);return n!=null&&y(e,["error"],n),e}function GO(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);if(e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),m(i,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function zO(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);e!==void 0&&s!=null&&y(e,["_query","pageToken"],s);const a=m(i,["filter"]);return e!==void 0&&a!=null&&y(e,["_query","filter"],a),t}function qO(i){const e={},t=m(i,["config"]);return t!=null&&GO(t,e),e}function VO(i){const e={},t=m(i,["config"]);return t!=null&&zO(t,e),e}function $O(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const s=m(i,["operations"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>Jm(l))),y(e,["batchJobs"],a)}return e}function jO(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const s=m(i,["batchPredictionJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>dw(l))),y(e,["batchJobs"],a)}return e}function YO(i){const e={},t=m(i,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&y(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&y(e,["executableCode"],s);const a=m(i,["fileData"]);a!=null&&y(e,["fileData"],NO(a));const l=m(i,["functionCall"]);l!=null&&y(e,["functionCall"],MO(l));const c=m(i,["functionResponse"]);c!=null&&y(e,["functionResponse"],c);const d=m(i,["inlineData"]);d!=null&&y(e,["inlineData"],hO(d));const h=m(i,["text"]);h!=null&&y(e,["text"],h);const p=m(i,["thought"]);p!=null&&y(e,["thought"],p);const v=m(i,["thoughtSignature"]);v!=null&&y(e,["thoughtSignature"],v);const _=m(i,["videoMetadata"]);return _!=null&&y(e,["videoMetadata"],_),e}function KO(i){const e={},t=m(i,["category"]);if(t!=null&&y(e,["category"],t),m(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(i,["threshold"]);return n!=null&&y(e,["threshold"],n),e}function JO(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&y(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&y(e,["functionCallingConfig"],kO(n)),e}function XO(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&y(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&y(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&y(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=m(i,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(v=>v)),y(e,["functionDeclarations"],p)}const l=m(i,["googleMaps"]);l!=null&&y(e,["googleMaps"],OO(l));const c=m(i,["googleSearch"]);c!=null&&y(e,["googleSearch"],UO(c));const d=m(i,["googleSearchRetrieval"]);d!=null&&y(e,["googleSearchRetrieval"],d);const h=m(i,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var na;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents",i.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",i.PAGED_ITEM_DOCUMENTS="documents"})(na||(na={}));class oc{constructor(e,t,n,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,s)}init(e,t,n){var s,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!n||Object.keys(n).length===0?l={config:{}}:typeof n=="object"?l=Object.assign({},n):l=n,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(s=l.config)===null||s===void 0?void 0:s.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WO extends ra{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new oc(na.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=lC(this.apiClient,e),n=t._url,s=ce("{model}:batchGenerateContent",n),c=t.batch.inputConfig.requests,d=c.requests,h=[];for(const p of d){const v=Object.assign({},p);if(v.systemInstruction){const _=v.systemInstruction;delete v.systemInstruction;const x=v.request;x.systemInstruction=_,v.request=x}h.push(v)}return c.requests=h,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},s=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${s}`),n.dest===void 0){const a=this.getGcsUri(e),l=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?n.dest=`${a.slice(0,-6)}/dest`:n.dest=`${a}_dest_${s}`;else if(l)n.dest=`${l}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=bO(this.apiClient,e);return c=ce("batchPredictionJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>dw(p))}else{const h=lC(this.apiClient,e);return c=ce("{model}:batchGenerateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>Jm(p))}}async createEmbeddingsInternal(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=wO(this.apiClient,e);return a=ce("{model}:asyncBatchEmbedContent",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>Jm(d))}}async get(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=LO(this.apiClient,e);return c=ce("batchPredictionJobs/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>dw(p))}else{const h=PO(this.apiClient,e);return c=ce("batches/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>Jm(p))}}async cancel(e){var t,n,s,a;let l="",c={};if(this.apiClient.isVertexAI()){const d=pO(this.apiClient,e);l=ce("batchPredictionJobs/{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}else{const d=fO(this.apiClient,e);l=ce("batches/{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=VO(e);return c=ce("batchPredictionJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=jO(p),_=new sC;return Object.assign(_,v),_})}else{const h=qO(e);return c=ce("batches",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=$O(p),_=new sC;return Object.assign(_,v),_})}}async delete(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=SO(this.apiClient,e);return c=ce("batchPredictionJobs/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>EO(p))}else{const h=xO(this.apiClient,e);return c=ce("batches/{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>AO(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QO(i){const e={},t=m(i,["data"]);if(t!=null&&y(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function cC(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>wU(a))),y(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&y(e,["role"],n),e}function ZO(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&y(e,["ttl"],n);const s=m(i,["expireTime"]);e!==void 0&&s!=null&&y(e,["expireTime"],s);const a=m(i,["displayName"]);e!==void 0&&a!=null&&y(e,["displayName"],a);const l=m(i,["contents"]);if(e!==void 0&&l!=null){let p=is(l);Array.isArray(p)&&(p=p.map(v=>cC(v))),y(e,["contents"],p)}const c=m(i,["systemInstruction"]);e!==void 0&&c!=null&&y(e,["systemInstruction"],cC(Ln(c)));const d=m(i,["tools"]);if(e!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(v=>SU(v))),y(e,["tools"],p)}const h=m(i,["toolConfig"]);if(e!==void 0&&h!=null&&y(e,["toolConfig"],xU(h)),m(i,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function eU(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&y(e,["ttl"],n);const s=m(i,["expireTime"]);e!==void 0&&s!=null&&y(e,["expireTime"],s);const a=m(i,["displayName"]);e!==void 0&&a!=null&&y(e,["displayName"],a);const l=m(i,["contents"]);if(e!==void 0&&l!=null){let v=is(l);Array.isArray(v)&&(v=v.map(_=>_)),y(e,["contents"],v)}const c=m(i,["systemInstruction"]);e!==void 0&&c!=null&&y(e,["systemInstruction"],Ln(c));const d=m(i,["tools"]);if(e!==void 0&&d!=null){let v=d;Array.isArray(v)&&(v=v.map(_=>AU(_))),y(e,["tools"],v)}const h=m(i,["toolConfig"]);e!==void 0&&h!=null&&y(e,["toolConfig"],h);const p=m(i,["kmsKeyName"]);return e!==void 0&&p!=null&&y(e,["encryption_spec","kmsKeyName"],p),t}function tU(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["model"],uM(i,n));const s=m(e,["config"]);return s!=null&&ZO(s,t),t}function nU(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["model"],uM(i,n));const s=m(e,["config"]);return s!=null&&eU(s,t),t}function iU(i,e){const t={},n=m(e,["name"]);return n!=null&&y(t,["_url","name"],aa(i,n)),t}function sU(i,e){const t={},n=m(e,["name"]);return n!=null&&y(t,["_url","name"],aa(i,n)),t}function rU(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function aU(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function oU(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&y(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function lU(i){const e={},t=m(i,["id"]);t!=null&&y(e,["id"],t);const n=m(i,["args"]);n!=null&&y(e,["args"],n);const s=m(i,["name"]);if(s!=null&&y(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function cU(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&y(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&y(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function uU(i){const e={},t=m(i,["description"]);t!=null&&y(e,["description"],t);const n=m(i,["name"]);n!=null&&y(e,["name"],n);const s=m(i,["parameters"]);s!=null&&y(e,["parameters"],s);const a=m(i,["parametersJsonSchema"]);a!=null&&y(e,["parametersJsonSchema"],a);const l=m(i,["response"]);l!=null&&y(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&y(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function dU(i,e){const t={},n=m(e,["name"]);return n!=null&&y(t,["_url","name"],aa(i,n)),t}function hU(i,e){const t={},n=m(e,["name"]);return n!=null&&y(t,["_url","name"],aa(i,n)),t}function fU(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function pU(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function gU(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),t}function mU(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),t}function yU(i){const e={},t=m(i,["config"]);return t!=null&&gU(t,e),e}function vU(i){const e={},t=m(i,["config"]);return t!=null&&mU(t,e),e}function bU(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const s=m(i,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["cachedContents"],a)}return e}function _U(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const s=m(i,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["cachedContents"],a)}return e}function wU(i){const e={},t=m(i,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&y(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&y(e,["executableCode"],s);const a=m(i,["fileData"]);a!=null&&y(e,["fileData"],oU(a));const l=m(i,["functionCall"]);l!=null&&y(e,["functionCall"],lU(l));const c=m(i,["functionResponse"]);c!=null&&y(e,["functionResponse"],c);const d=m(i,["inlineData"]);d!=null&&y(e,["inlineData"],QO(d));const h=m(i,["text"]);h!=null&&y(e,["text"],h);const p=m(i,["thought"]);p!=null&&y(e,["thought"],p);const v=m(i,["thoughtSignature"]);v!=null&&y(e,["thoughtSignature"],v);const _=m(i,["videoMetadata"]);return _!=null&&y(e,["videoMetadata"],_),e}function xU(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&y(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&y(e,["functionCallingConfig"],cU(n)),e}function SU(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&y(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&y(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&y(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=m(i,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(v=>v)),y(e,["functionDeclarations"],p)}const l=m(i,["googleMaps"]);l!=null&&y(e,["googleMaps"],fU(l));const c=m(i,["googleSearch"]);c!=null&&y(e,["googleSearch"],pU(c));const d=m(i,["googleSearchRetrieval"]);d!=null&&y(e,["googleSearchRetrieval"],d);const h=m(i,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}function AU(i){const e={},t=m(i,["retrieval"]);t!=null&&y(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&y(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&y(e,["codeExecution"],s);const a=m(i,["enterpriseWebSearch"]);a!=null&&y(e,["enterpriseWebSearch"],a);const l=m(i,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(_=>uU(_))),y(e,["functionDeclarations"],v)}const c=m(i,["googleMaps"]);c!=null&&y(e,["googleMaps"],c);const d=m(i,["googleSearch"]);d!=null&&y(e,["googleSearch"],d);const h=m(i,["googleSearchRetrieval"]);h!=null&&y(e,["googleSearchRetrieval"],h);const p=m(i,["urlContext"]);return p!=null&&y(e,["urlContext"],p),e}function EU(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&y(e,["ttl"],n);const s=m(i,["expireTime"]);return e!==void 0&&s!=null&&y(e,["expireTime"],s),t}function TU(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&y(e,["ttl"],n);const s=m(i,["expireTime"]);return e!==void 0&&s!=null&&y(e,["expireTime"],s),t}function CU(i,e){const t={},n=m(e,["name"]);n!=null&&y(t,["_url","name"],aa(i,n));const s=m(e,["config"]);return s!=null&&EU(s,t),t}function RU(i,e){const t={},n=m(e,["name"]);n!=null&&y(t,["_url","name"],aa(i,n));const s=m(e,["config"]);return s!=null&&TU(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NU extends ra{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new oc(na.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=nU(this.apiClient,e);return c=ce("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=tU(this.apiClient,e);return c=ce("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async get(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=hU(this.apiClient,e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=dU(this.apiClient,e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async delete(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=sU(this.apiClient,e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=aU(p),_=new nC;return Object.assign(_,v),_})}else{const h=iU(this.apiClient,e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=rU(p),_=new nC;return Object.assign(_,v),_})}}async update(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=RU(this.apiClient,e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>p)}else{const h=CU(this.apiClient,e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>p)}}async listInternal(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=vU(e);return c=ce("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=_U(p),_=new iC;return Object.assign(_,v),_})}else{const h=yU(e);return c=ce("cachedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=bU(p),_=new iC;return Object.assign(_,v),_})}}}function l0(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(t[n[s]]=i[n[s]]);return t}function uC(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pe(i){return this instanceof Pe?(this.v=i,this):new Pe(i)}function Cs(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),s[Symbol.asyncIterator]=function(){return this},s;function l(x){return function(A){return Promise.resolve(A).then(x,v)}}function c(x,A){n[x]&&(s[x]=function(E){return new Promise(function(R,N){a.push([x,E,R,N])>1||d(x,E)})},A&&(s[x]=A(s[x])))}function d(x,A){try{h(n[x](A))}catch(E){_(a[0][3],E)}}function h(x){x.value instanceof Pe?Promise.resolve(x.value.v).then(p,v):_(a[0][2],x)}function p(x){d("next",x)}function v(x){d("throw",x)}function _(x,A){x(A),a.shift(),a.length&&d(a[0][0],a[0][1])}}function Rs(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof uC=="function"?uC(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=i[a]&&function(l){return new Promise(function(c,d){l=i[a](l),s(c,d,l.done,l.value)})}}function s(a,l,c,d){Promise.resolve(d).then(function(h){a({value:h,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function MU(i){var e;if(i.candidates==null||i.candidates.length===0)return!1;const t=(e=i.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:SM(t)}function SM(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const e of i.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function kU(i){if(i.length!==0){for(const e of i)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function dC(i){if(i===void 0||i.length===0)return[];const e=[],t=i.length;let n=0;for(;n<t;)if(i[n].role==="user")e.push(i[n]),n++;else{const s=[];let a=!0;for(;n<t&&i[n].role==="model";)s.push(i[n]),a&&!SM(i[n])&&(a=!1),n++;a?e.push(...s):e.pop()}return e}class IU{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new DU(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class DU{constructor(e,t,n,s={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=s,this.history=a,this.sendPromise=Promise.resolve(),kU(a)}async sendMessage(e){var t;await this.sendPromise;const n=Ln(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,l,c;const d=await s,h=(l=(a=d.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,p=d.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let _=[];p!=null&&(_=(c=p.slice(v))!==null&&c!==void 0?c:[]);const x=h?[h]:[];this.recordHistory(n,x,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const n=Ln(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const a=await s;return this.processStreamResponse(a,n)}getHistory(e=!1){const t=e?dC(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Cs(this,arguments,function*(){var s,a,l,c,d,h;const p=[];try{for(var v=!0,_=Rs(e),x;x=yield Pe(_.next()),s=x.done,!s;v=!0){c=x.value,v=!1;const A=c;if(MU(A)){const E=(h=(d=A.candidates)===null||d===void 0?void 0:d[0])===null||h===void 0?void 0:h.content;E!==void 0&&p.push(E)}yield yield Pe(A)}}catch(A){a={error:A}}finally{try{!v&&!s&&(l=_.return)&&(yield Pe(l.call(_)))}finally{if(a)throw a.error}}this.recordHistory(t,p)})}recordHistory(e,t,n){let s=[];t.length>0&&t.every(a=>a.role!==void 0)?s=t:s.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...dC(n)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class V0 extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,V0.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PU(i){const e={},t=m(i,["file"]);return t!=null&&y(e,["file"],t),e}function LU(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function OU(i){const e={},t=m(i,["name"]);return t!=null&&y(e,["_url","file"],mM(t)),e}function UU(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function FU(i){const e={},t=m(i,["name"]);return t!=null&&y(e,["_url","file"],mM(t)),e}function HU(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),t}function BU(i){const e={},t=m(i,["config"]);return t!=null&&HU(t,e),e}function GU(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const s=m(i,["files"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zU extends ra{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new oc(na.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=BU(e);return a=ce("files",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=GU(d),p=new jL;return Object.assign(p,h),p})}}async createInternal(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=PU(e);return a=ce("upload/v1beta/files",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>{const h=LU(d),p=new YL;return Object.assign(p,h),p})}}async get(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=FU(e);return a=ce("files/{file}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>d)}}async delete(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=OU(e);return a=ce("files/{file}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=UU(d),p=new KL;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Xm(i){const e={},t=m(i,["data"]);if(t!=null&&y(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function qU(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>r4(a))),y(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&y(e,["role"],n),e}function VU(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&y(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function $U(i){const e={},t=m(i,["id"]);t!=null&&y(e,["id"],t);const n=m(i,["args"]);n!=null&&y(e,["args"],n);const s=m(i,["name"]);if(s!=null&&y(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function jU(i){const e={},t=m(i,["description"]);t!=null&&y(e,["description"],t);const n=m(i,["name"]);n!=null&&y(e,["name"],n);const s=m(i,["parameters"]);s!=null&&y(e,["parameters"],s);const a=m(i,["parametersJsonSchema"]);a!=null&&y(e,["parametersJsonSchema"],a);const l=m(i,["response"]);l!=null&&y(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&y(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function YU(i){const e={},t=m(i,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const n=m(i,["responseJsonSchema"]);n!=null&&y(e,["responseJsonSchema"],n);const s=m(i,["audioTimestamp"]);s!=null&&y(e,["audioTimestamp"],s);const a=m(i,["candidateCount"]);a!=null&&y(e,["candidateCount"],a);const l=m(i,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const c=m(i,["frequencyPenalty"]);c!=null&&y(e,["frequencyPenalty"],c);const d=m(i,["logprobs"]);d!=null&&y(e,["logprobs"],d);const h=m(i,["maxOutputTokens"]);h!=null&&y(e,["maxOutputTokens"],h);const p=m(i,["mediaResolution"]);p!=null&&y(e,["mediaResolution"],p);const v=m(i,["presencePenalty"]);v!=null&&y(e,["presencePenalty"],v);const _=m(i,["responseLogprobs"]);_!=null&&y(e,["responseLogprobs"],_);const x=m(i,["responseMimeType"]);x!=null&&y(e,["responseMimeType"],x);const A=m(i,["responseModalities"]);A!=null&&y(e,["responseModalities"],A);const E=m(i,["responseSchema"]);E!=null&&y(e,["responseSchema"],E);const R=m(i,["routingConfig"]);R!=null&&y(e,["routingConfig"],R);const N=m(i,["seed"]);N!=null&&y(e,["seed"],N);const D=m(i,["speechConfig"]);D!=null&&y(e,["speechConfig"],D);const P=m(i,["stopSequences"]);P!=null&&y(e,["stopSequences"],P);const L=m(i,["temperature"]);L!=null&&y(e,["temperature"],L);const B=m(i,["thinkingConfig"]);B!=null&&y(e,["thinkingConfig"],B);const H=m(i,["topK"]);H!=null&&y(e,["topK"],H);const O=m(i,["topP"]);if(O!=null&&y(e,["topP"],O),m(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function KU(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function JU(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function XU(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&y(e,["setup","generationConfig"],n);const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig","responseModalities"],s);const a=m(i,["temperature"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","temperature"],a);const l=m(i,["topP"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&y(e,["setup","generationConfig","topK"],c);const d=m(i,["maxOutputTokens"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","maxOutputTokens"],d);const h=m(i,["mediaResolution"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","mediaResolution"],h);const p=m(i,["seed"]);e!==void 0&&p!=null&&y(e,["setup","generationConfig","seed"],p);const v=m(i,["speechConfig"]);e!==void 0&&v!=null&&y(e,["setup","generationConfig","speechConfig"],ex(v));const _=m(i,["thinkingConfig"]);e!==void 0&&_!=null&&y(e,["setup","generationConfig","thinkingConfig"],_);const x=m(i,["enableAffectiveDialog"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],x);const A=m(i,["systemInstruction"]);e!==void 0&&A!=null&&y(e,["setup","systemInstruction"],qU(Ln(A)));const E=m(i,["tools"]);if(e!==void 0&&E!=null){let H=kd(E);Array.isArray(H)&&(H=H.map(O=>o4(Md(O)))),y(e,["setup","tools"],H)}const R=m(i,["sessionResumption"]);e!==void 0&&R!=null&&y(e,["setup","sessionResumption"],a4(R));const N=m(i,["inputAudioTranscription"]);e!==void 0&&N!=null&&y(e,["setup","inputAudioTranscription"],N);const D=m(i,["outputAudioTranscription"]);e!==void 0&&D!=null&&y(e,["setup","outputAudioTranscription"],D);const P=m(i,["realtimeInputConfig"]);e!==void 0&&P!=null&&y(e,["setup","realtimeInputConfig"],P);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&y(e,["setup","contextWindowCompression"],L);const B=m(i,["proactivity"]);if(e!==void 0&&B!=null&&y(e,["setup","proactivity"],B),m(i,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function WU(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&y(e,["setup","generationConfig"],YU(n));const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig","responseModalities"],s);const a=m(i,["temperature"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","temperature"],a);const l=m(i,["topP"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&y(e,["setup","generationConfig","topK"],c);const d=m(i,["maxOutputTokens"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","maxOutputTokens"],d);const h=m(i,["mediaResolution"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","mediaResolution"],h);const p=m(i,["seed"]);e!==void 0&&p!=null&&y(e,["setup","generationConfig","seed"],p);const v=m(i,["speechConfig"]);e!==void 0&&v!=null&&y(e,["setup","generationConfig","speechConfig"],ex(v));const _=m(i,["thinkingConfig"]);e!==void 0&&_!=null&&y(e,["setup","generationConfig","thinkingConfig"],_);const x=m(i,["enableAffectiveDialog"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],x);const A=m(i,["systemInstruction"]);e!==void 0&&A!=null&&y(e,["setup","systemInstruction"],Ln(A));const E=m(i,["tools"]);if(e!==void 0&&E!=null){let O=kd(E);Array.isArray(O)&&(O=O.map(X=>l4(Md(X)))),y(e,["setup","tools"],O)}const R=m(i,["sessionResumption"]);e!==void 0&&R!=null&&y(e,["setup","sessionResumption"],R);const N=m(i,["inputAudioTranscription"]);e!==void 0&&N!=null&&y(e,["setup","inputAudioTranscription"],N);const D=m(i,["outputAudioTranscription"]);e!==void 0&&D!=null&&y(e,["setup","outputAudioTranscription"],D);const P=m(i,["realtimeInputConfig"]);e!==void 0&&P!=null&&y(e,["setup","realtimeInputConfig"],P);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&y(e,["setup","contextWindowCompression"],L);const B=m(i,["proactivity"]);e!==void 0&&B!=null&&y(e,["setup","proactivity"],B);const H=m(i,["explicitVadSignal"]);return e!==void 0&&H!=null&&y(e,["setup","explicitVadSignal"],H),t}function QU(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["setup","model"],tt(i,n));const s=m(e,["config"]);return s!=null&&y(t,["config"],XU(s,t)),t}function ZU(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["setup","model"],tt(i,n));const s=m(e,["config"]);return s!=null&&y(t,["config"],WU(s,t)),t}function e4(i){const e={},t=m(i,["musicGenerationConfig"]);return t!=null&&y(e,["musicGenerationConfig"],t),e}function t4(i){const e={},t=m(i,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),y(e,["weightedPrompts"],n)}return e}function n4(i){const e={},t=m(i,["media"]);if(t!=null){let h=dM(t);Array.isArray(h)&&(h=h.map(p=>Xm(p))),y(e,["mediaChunks"],h)}const n=m(i,["audio"]);n!=null&&y(e,["audio"],Xm(fM(n)));const s=m(i,["audioStreamEnd"]);s!=null&&y(e,["audioStreamEnd"],s);const a=m(i,["video"]);a!=null&&y(e,["video"],Xm(hM(a)));const l=m(i,["text"]);l!=null&&y(e,["text"],l);const c=m(i,["activityStart"]);c!=null&&y(e,["activityStart"],c);const d=m(i,["activityEnd"]);return d!=null&&y(e,["activityEnd"],d),e}function i4(i){const e={},t=m(i,["media"]);if(t!=null){let h=dM(t);Array.isArray(h)&&(h=h.map(p=>p)),y(e,["mediaChunks"],h)}const n=m(i,["audio"]);n!=null&&y(e,["audio"],fM(n));const s=m(i,["audioStreamEnd"]);s!=null&&y(e,["audioStreamEnd"],s);const a=m(i,["video"]);a!=null&&y(e,["video"],hM(a));const l=m(i,["text"]);l!=null&&y(e,["text"],l);const c=m(i,["activityStart"]);c!=null&&y(e,["activityStart"],c);const d=m(i,["activityEnd"]);return d!=null&&y(e,["activityEnd"],d),e}function s4(i){const e={},t=m(i,["setupComplete"]);t!=null&&y(e,["setupComplete"],t);const n=m(i,["serverContent"]);n!=null&&y(e,["serverContent"],n);const s=m(i,["toolCall"]);s!=null&&y(e,["toolCall"],s);const a=m(i,["toolCallCancellation"]);a!=null&&y(e,["toolCallCancellation"],a);const l=m(i,["usageMetadata"]);l!=null&&y(e,["usageMetadata"],c4(l));const c=m(i,["goAway"]);c!=null&&y(e,["goAway"],c);const d=m(i,["sessionResumptionUpdate"]);d!=null&&y(e,["sessionResumptionUpdate"],d);const h=m(i,["voiceActivityDetectionSignal"]);return h!=null&&y(e,["voiceActivityDetectionSignal"],h),e}function r4(i){const e={},t=m(i,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&y(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&y(e,["executableCode"],s);const a=m(i,["fileData"]);a!=null&&y(e,["fileData"],VU(a));const l=m(i,["functionCall"]);l!=null&&y(e,["functionCall"],$U(l));const c=m(i,["functionResponse"]);c!=null&&y(e,["functionResponse"],c);const d=m(i,["inlineData"]);d!=null&&y(e,["inlineData"],Xm(d));const h=m(i,["text"]);h!=null&&y(e,["text"],h);const p=m(i,["thought"]);p!=null&&y(e,["thought"],p);const v=m(i,["thoughtSignature"]);v!=null&&y(e,["thoughtSignature"],v);const _=m(i,["videoMetadata"]);return _!=null&&y(e,["videoMetadata"],_),e}function a4(i){const e={},t=m(i,["handle"]);if(t!=null&&y(e,["handle"],t),m(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function o4(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&y(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&y(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&y(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=m(i,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(v=>v)),y(e,["functionDeclarations"],p)}const l=m(i,["googleMaps"]);l!=null&&y(e,["googleMaps"],KU(l));const c=m(i,["googleSearch"]);c!=null&&y(e,["googleSearch"],JU(c));const d=m(i,["googleSearchRetrieval"]);d!=null&&y(e,["googleSearchRetrieval"],d);const h=m(i,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}function l4(i){const e={},t=m(i,["retrieval"]);t!=null&&y(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&y(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&y(e,["codeExecution"],s);const a=m(i,["enterpriseWebSearch"]);a!=null&&y(e,["enterpriseWebSearch"],a);const l=m(i,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(_=>jU(_))),y(e,["functionDeclarations"],v)}const c=m(i,["googleMaps"]);c!=null&&y(e,["googleMaps"],c);const d=m(i,["googleSearch"]);d!=null&&y(e,["googleSearch"],d);const h=m(i,["googleSearchRetrieval"]);h!=null&&y(e,["googleSearchRetrieval"],h);const p=m(i,["urlContext"]);return p!=null&&y(e,["urlContext"],p),e}function c4(i){const e={},t=m(i,["promptTokenCount"]);t!=null&&y(e,["promptTokenCount"],t);const n=m(i,["cachedContentTokenCount"]);n!=null&&y(e,["cachedContentTokenCount"],n);const s=m(i,["candidatesTokenCount"]);s!=null&&y(e,["responseTokenCount"],s);const a=m(i,["toolUsePromptTokenCount"]);a!=null&&y(e,["toolUsePromptTokenCount"],a);const l=m(i,["thoughtsTokenCount"]);l!=null&&y(e,["thoughtsTokenCount"],l);const c=m(i,["totalTokenCount"]);c!=null&&y(e,["totalTokenCount"],c);const d=m(i,["promptTokensDetails"]);if(d!=null){let x=d;Array.isArray(x)&&(x=x.map(A=>A)),y(e,["promptTokensDetails"],x)}const h=m(i,["cacheTokensDetails"]);if(h!=null){let x=h;Array.isArray(x)&&(x=x.map(A=>A)),y(e,["cacheTokensDetails"],x)}const p=m(i,["candidatesTokensDetails"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(A=>A)),y(e,["responseTokensDetails"],x)}const v=m(i,["toolUsePromptTokensDetails"]);if(v!=null){let x=v;Array.isArray(x)&&(x=x.map(A=>A)),y(e,["toolUsePromptTokensDetails"],x)}const _=m(i,["trafficType"]);return _!=null&&y(e,["trafficType"],_),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function u4(i){const e={},t=m(i,["data"]);if(t!=null&&y(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function d4(i){const e={},t=m(i,["content"]);t!=null&&y(e,["content"],t);const n=m(i,["citationMetadata"]);n!=null&&y(e,["citationMetadata"],h4(n));const s=m(i,["tokenCount"]);s!=null&&y(e,["tokenCount"],s);const a=m(i,["finishReason"]);a!=null&&y(e,["finishReason"],a);const l=m(i,["avgLogprobs"]);l!=null&&y(e,["avgLogprobs"],l);const c=m(i,["groundingMetadata"]);c!=null&&y(e,["groundingMetadata"],c);const d=m(i,["index"]);d!=null&&y(e,["index"],d);const h=m(i,["logprobsResult"]);h!=null&&y(e,["logprobsResult"],h);const p=m(i,["safetyRatings"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(x=>x)),y(e,["safetyRatings"],_)}const v=m(i,["urlContextMetadata"]);return v!=null&&y(e,["urlContextMetadata"],v),e}function h4(i){const e={},t=m(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),y(e,["citations"],n)}return e}function f4(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["contents"]);if(s!=null){let a=is(s);Array.isArray(a)&&(a=a.map(l=>l)),y(t,["contents"],a)}return t}function p4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["tokensInfo"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>a)),y(e,["tokensInfo"],s)}return e}function g4(i){const e={},t=m(i,["values"]);t!=null&&y(e,["values"],t);const n=m(i,["statistics"]);return n!=null&&y(e,["statistics"],m4(n)),e}function m4(i){const e={},t=m(i,["truncated"]);t!=null&&y(e,["truncated"],t);const n=m(i,["token_count"]);return n!=null&&y(e,["tokenCount"],n),e}function $0(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>E5(a))),y(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&y(e,["role"],n),e}function y4(i){const e={},t=m(i,["controlType"]);t!=null&&y(e,["controlType"],t);const n=m(i,["enableControlImageComputation"]);return n!=null&&y(e,["computeControl"],n),e}function v4(i){const e={};if(m(i,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(m(i,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(m(i,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function b4(i,e){const t={},n=m(i,["systemInstruction"]);e!==void 0&&n!=null&&y(e,["systemInstruction"],Ln(n));const s=m(i,["tools"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>CM(c))),y(e,["tools"],l)}const a=m(i,["generationConfig"]);return e!==void 0&&a!=null&&y(e,["generationConfig"],u5(a)),t}function _4(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["contents"]);if(s!=null){let l=is(s);Array.isArray(l)&&(l=l.map(c=>$0(c))),y(t,["contents"],l)}const a=m(e,["config"]);return a!=null&&v4(a),t}function w4(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["contents"]);if(s!=null){let l=is(s);Array.isArray(l)&&(l=l.map(c=>c)),y(t,["contents"],l)}const a=m(e,["config"]);return a!=null&&b4(a,t),t}function x4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["totalTokens"]);n!=null&&y(e,["totalTokens"],n);const s=m(i,["cachedContentTokenCount"]);return s!=null&&y(e,["cachedContentTokenCount"],s),e}function S4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["totalTokens"]);return n!=null&&y(e,["totalTokens"],n),e}function A4(i,e){const t={},n=m(e,["model"]);return n!=null&&y(t,["_url","name"],tt(i,n)),t}function E4(i,e){const t={},n=m(e,["model"]);return n!=null&&y(t,["_url","name"],tt(i,n)),t}function T4(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function C4(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function R4(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&y(e,["parameters","storageUri"],n);const s=m(i,["negativePrompt"]);e!==void 0&&s!=null&&y(e,["parameters","negativePrompt"],s);const a=m(i,["numberOfImages"]);e!==void 0&&a!=null&&y(e,["parameters","sampleCount"],a);const l=m(i,["aspectRatio"]);e!==void 0&&l!=null&&y(e,["parameters","aspectRatio"],l);const c=m(i,["guidanceScale"]);e!==void 0&&c!=null&&y(e,["parameters","guidanceScale"],c);const d=m(i,["seed"]);e!==void 0&&d!=null&&y(e,["parameters","seed"],d);const h=m(i,["safetyFilterLevel"]);e!==void 0&&h!=null&&y(e,["parameters","safetySetting"],h);const p=m(i,["personGeneration"]);e!==void 0&&p!=null&&y(e,["parameters","personGeneration"],p);const v=m(i,["includeSafetyAttributes"]);e!==void 0&&v!=null&&y(e,["parameters","includeSafetyAttributes"],v);const _=m(i,["includeRaiReason"]);e!==void 0&&_!=null&&y(e,["parameters","includeRaiReason"],_);const x=m(i,["language"]);e!==void 0&&x!=null&&y(e,["parameters","language"],x);const A=m(i,["outputMimeType"]);e!==void 0&&A!=null&&y(e,["parameters","outputOptions","mimeType"],A);const E=m(i,["outputCompressionQuality"]);e!==void 0&&E!=null&&y(e,["parameters","outputOptions","compressionQuality"],E);const R=m(i,["addWatermark"]);e!==void 0&&R!=null&&y(e,["parameters","addWatermark"],R);const N=m(i,["labels"]);e!==void 0&&N!=null&&y(e,["labels"],N);const D=m(i,["editMode"]);e!==void 0&&D!=null&&y(e,["parameters","editMode"],D);const P=m(i,["baseSteps"]);return e!==void 0&&P!=null&&y(e,["parameters","editConfig","baseSteps"],P),t}function N4(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["prompt"]);s!=null&&y(t,["instances[0]","prompt"],s);const a=m(e,["referenceImages"]);if(a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>k5(d))),y(t,["instances[0]","referenceImages"],c)}const l=m(e,["config"]);return l!=null&&R4(l,t),t}function M4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>j0(a))),y(e,["generatedImages"],s)}return e}function k4(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&y(e,["requests[]","taskType"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&y(e,["requests[]","title"],s);const a=m(i,["outputDimensionality"]);if(e!==void 0&&a!=null&&y(e,["requests[]","outputDimensionality"],a),m(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function I4(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&y(e,["instances[]","task_type"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&y(e,["instances[]","title"],s);const a=m(i,["outputDimensionality"]);e!==void 0&&a!=null&&y(e,["parameters","outputDimensionality"],a);const l=m(i,["mimeType"]);e!==void 0&&l!=null&&y(e,["instances[]","mimeType"],l);const c=m(i,["autoTruncate"]);return e!==void 0&&c!=null&&y(e,["parameters","autoTruncate"],c),t}function D4(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["contents"]);if(s!=null){let c=Ww(i,s);Array.isArray(c)&&(c=c.map(d=>d)),y(t,["requests[]","content"],c)}const a=m(e,["config"]);a!=null&&k4(a,t);const l=m(e,["model"]);return l!==void 0&&y(t,["requests[]","model"],tt(i,l)),t}function P4(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["contents"]);if(s!=null){let l=Ww(i,s);Array.isArray(l)&&(l=l.map(c=>c)),y(t,["instances[]","content"],l)}const a=m(e,["config"]);return a!=null&&I4(a,t),t}function L4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["embeddings"],a)}const s=m(i,["metadata"]);return s!=null&&y(e,["metadata"],s),e}function O4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>g4(l))),y(e,["embeddings"],a)}const s=m(i,["metadata"]);return s!=null&&y(e,["metadata"],s),e}function U4(i){const e={},t=m(i,["endpoint"]);t!=null&&y(e,["name"],t);const n=m(i,["deployedModelId"]);return n!=null&&y(e,["deployedModelId"],n),e}function F4(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&y(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function H4(i){const e={},t=m(i,["id"]);t!=null&&y(e,["id"],t);const n=m(i,["args"]);n!=null&&y(e,["args"],n);const s=m(i,["name"]);if(s!=null&&y(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function B4(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&y(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&y(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function G4(i){const e={},t=m(i,["description"]);t!=null&&y(e,["description"],t);const n=m(i,["name"]);n!=null&&y(e,["name"],n);const s=m(i,["parameters"]);s!=null&&y(e,["parameters"],s);const a=m(i,["parametersJsonSchema"]);a!=null&&y(e,["parametersJsonSchema"],a);const l=m(i,["response"]);l!=null&&y(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&y(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function z4(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&y(t,["systemInstruction"],$0(Ln(s)));const a=m(e,["temperature"]);a!=null&&y(n,["temperature"],a);const l=m(e,["topP"]);l!=null&&y(n,["topP"],l);const c=m(e,["topK"]);c!=null&&y(n,["topK"],c);const d=m(e,["candidateCount"]);d!=null&&y(n,["candidateCount"],d);const h=m(e,["maxOutputTokens"]);h!=null&&y(n,["maxOutputTokens"],h);const p=m(e,["stopSequences"]);p!=null&&y(n,["stopSequences"],p);const v=m(e,["responseLogprobs"]);v!=null&&y(n,["responseLogprobs"],v);const _=m(e,["logprobs"]);_!=null&&y(n,["logprobs"],_);const x=m(e,["presencePenalty"]);x!=null&&y(n,["presencePenalty"],x);const A=m(e,["frequencyPenalty"]);A!=null&&y(n,["frequencyPenalty"],A);const E=m(e,["seed"]);E!=null&&y(n,["seed"],E);const R=m(e,["responseMimeType"]);R!=null&&y(n,["responseMimeType"],R);const N=m(e,["responseSchema"]);N!=null&&y(n,["responseSchema"],Qw(N));const D=m(e,["responseJsonSchema"]);if(D!=null&&y(n,["responseJsonSchema"],D),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=m(e,["safetySettings"]);if(t!==void 0&&P!=null){let be=P;Array.isArray(be)&&(be=be.map(ye=>I5(ye))),y(t,["safetySettings"],be)}const L=m(e,["tools"]);if(t!==void 0&&L!=null){let be=kd(L);Array.isArray(be)&&(be=be.map(ye=>H5(Md(ye)))),y(t,["tools"],be)}const B=m(e,["toolConfig"]);if(t!==void 0&&B!=null&&y(t,["toolConfig"],F5(B)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=m(e,["cachedContent"]);t!==void 0&&H!=null&&y(t,["cachedContent"],aa(i,H));const O=m(e,["responseModalities"]);O!=null&&y(n,["responseModalities"],O);const X=m(e,["mediaResolution"]);X!=null&&y(n,["mediaResolution"],X);const Y=m(e,["speechConfig"]);if(Y!=null&&y(n,["speechConfig"],Zw(Y)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const se=m(e,["thinkingConfig"]);se!=null&&y(n,["thinkingConfig"],se);const re=m(e,["imageConfig"]);re!=null&&y(n,["imageConfig"],g5(re));const ne=m(e,["enableEnhancedCivicAnswers"]);return ne!=null&&y(n,["enableEnhancedCivicAnswers"],ne),n}function q4(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&y(t,["systemInstruction"],Ln(s));const a=m(e,["temperature"]);a!=null&&y(n,["temperature"],a);const l=m(e,["topP"]);l!=null&&y(n,["topP"],l);const c=m(e,["topK"]);c!=null&&y(n,["topK"],c);const d=m(e,["candidateCount"]);d!=null&&y(n,["candidateCount"],d);const h=m(e,["maxOutputTokens"]);h!=null&&y(n,["maxOutputTokens"],h);const p=m(e,["stopSequences"]);p!=null&&y(n,["stopSequences"],p);const v=m(e,["responseLogprobs"]);v!=null&&y(n,["responseLogprobs"],v);const _=m(e,["logprobs"]);_!=null&&y(n,["logprobs"],_);const x=m(e,["presencePenalty"]);x!=null&&y(n,["presencePenalty"],x);const A=m(e,["frequencyPenalty"]);A!=null&&y(n,["frequencyPenalty"],A);const E=m(e,["seed"]);E!=null&&y(n,["seed"],E);const R=m(e,["responseMimeType"]);R!=null&&y(n,["responseMimeType"],R);const N=m(e,["responseSchema"]);N!=null&&y(n,["responseSchema"],Qw(N));const D=m(e,["responseJsonSchema"]);D!=null&&y(n,["responseJsonSchema"],D);const P=m(e,["routingConfig"]);P!=null&&y(n,["routingConfig"],P);const L=m(e,["modelSelectionConfig"]);L!=null&&y(n,["modelConfig"],L);const B=m(e,["safetySettings"]);if(t!==void 0&&B!=null){let G=B;Array.isArray(G)&&(G=G.map(W=>W)),y(t,["safetySettings"],G)}const H=m(e,["tools"]);if(t!==void 0&&H!=null){let G=kd(H);Array.isArray(G)&&(G=G.map(W=>CM(Md(W)))),y(t,["tools"],G)}const O=m(e,["toolConfig"]);t!==void 0&&O!=null&&y(t,["toolConfig"],O);const X=m(e,["labels"]);t!==void 0&&X!=null&&y(t,["labels"],X);const Y=m(e,["cachedContent"]);t!==void 0&&Y!=null&&y(t,["cachedContent"],aa(i,Y));const se=m(e,["responseModalities"]);se!=null&&y(n,["responseModalities"],se);const re=m(e,["mediaResolution"]);re!=null&&y(n,["mediaResolution"],re);const ne=m(e,["speechConfig"]);ne!=null&&y(n,["speechConfig"],Zw(ne));const be=m(e,["audioTimestamp"]);be!=null&&y(n,["audioTimestamp"],be);const ye=m(e,["thinkingConfig"]);ye!=null&&y(n,["thinkingConfig"],ye);const ze=m(e,["imageConfig"]);if(ze!=null&&y(n,["imageConfig"],m5(ze)),m(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}function hC(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["contents"]);if(s!=null){let l=is(s);Array.isArray(l)&&(l=l.map(c=>$0(c))),y(t,["contents"],l)}const a=m(e,["config"]);return a!=null&&y(t,["generationConfig"],z4(i,a,t)),t}function fC(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["contents"]);if(s!=null){let l=is(s);Array.isArray(l)&&(l=l.map(c=>c)),y(t,["contents"],l)}const a=m(e,["config"]);return a!=null&&y(t,["generationConfig"],q4(i,a,t)),t}function pC(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>d4(h))),y(e,["candidates"],d)}const s=m(i,["modelVersion"]);s!=null&&y(e,["modelVersion"],s);const a=m(i,["promptFeedback"]);a!=null&&y(e,["promptFeedback"],a);const l=m(i,["responseId"]);l!=null&&y(e,["responseId"],l);const c=m(i,["usageMetadata"]);return c!=null&&y(e,["usageMetadata"],c),e}function gC(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>p)),y(e,["candidates"],h)}const s=m(i,["createTime"]);s!=null&&y(e,["createTime"],s);const a=m(i,["modelVersion"]);a!=null&&y(e,["modelVersion"],a);const l=m(i,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const c=m(i,["responseId"]);c!=null&&y(e,["responseId"],c);const d=m(i,["usageMetadata"]);return d!=null&&y(e,["usageMetadata"],d),e}function V4(i,e){const t={};if(m(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(i,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=m(i,["numberOfImages"]);e!==void 0&&n!=null&&y(e,["parameters","sampleCount"],n);const s=m(i,["aspectRatio"]);e!==void 0&&s!=null&&y(e,["parameters","aspectRatio"],s);const a=m(i,["guidanceScale"]);if(e!==void 0&&a!=null&&y(e,["parameters","guidanceScale"],a),m(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=m(i,["safetyFilterLevel"]);e!==void 0&&l!=null&&y(e,["parameters","safetySetting"],l);const c=m(i,["personGeneration"]);e!==void 0&&c!=null&&y(e,["parameters","personGeneration"],c);const d=m(i,["includeSafetyAttributes"]);e!==void 0&&d!=null&&y(e,["parameters","includeSafetyAttributes"],d);const h=m(i,["includeRaiReason"]);e!==void 0&&h!=null&&y(e,["parameters","includeRaiReason"],h);const p=m(i,["language"]);e!==void 0&&p!=null&&y(e,["parameters","language"],p);const v=m(i,["outputMimeType"]);e!==void 0&&v!=null&&y(e,["parameters","outputOptions","mimeType"],v);const _=m(i,["outputCompressionQuality"]);if(e!==void 0&&_!=null&&y(e,["parameters","outputOptions","compressionQuality"],_),m(i,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(m(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const x=m(i,["imageSize"]);if(e!==void 0&&x!=null&&y(e,["parameters","sampleImageSize"],x),m(i,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function $4(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&y(e,["parameters","storageUri"],n);const s=m(i,["negativePrompt"]);e!==void 0&&s!=null&&y(e,["parameters","negativePrompt"],s);const a=m(i,["numberOfImages"]);e!==void 0&&a!=null&&y(e,["parameters","sampleCount"],a);const l=m(i,["aspectRatio"]);e!==void 0&&l!=null&&y(e,["parameters","aspectRatio"],l);const c=m(i,["guidanceScale"]);e!==void 0&&c!=null&&y(e,["parameters","guidanceScale"],c);const d=m(i,["seed"]);e!==void 0&&d!=null&&y(e,["parameters","seed"],d);const h=m(i,["safetyFilterLevel"]);e!==void 0&&h!=null&&y(e,["parameters","safetySetting"],h);const p=m(i,["personGeneration"]);e!==void 0&&p!=null&&y(e,["parameters","personGeneration"],p);const v=m(i,["includeSafetyAttributes"]);e!==void 0&&v!=null&&y(e,["parameters","includeSafetyAttributes"],v);const _=m(i,["includeRaiReason"]);e!==void 0&&_!=null&&y(e,["parameters","includeRaiReason"],_);const x=m(i,["language"]);e!==void 0&&x!=null&&y(e,["parameters","language"],x);const A=m(i,["outputMimeType"]);e!==void 0&&A!=null&&y(e,["parameters","outputOptions","mimeType"],A);const E=m(i,["outputCompressionQuality"]);e!==void 0&&E!=null&&y(e,["parameters","outputOptions","compressionQuality"],E);const R=m(i,["addWatermark"]);e!==void 0&&R!=null&&y(e,["parameters","addWatermark"],R);const N=m(i,["labels"]);e!==void 0&&N!=null&&y(e,["labels"],N);const D=m(i,["imageSize"]);e!==void 0&&D!=null&&y(e,["parameters","sampleImageSize"],D);const P=m(i,["enhancePrompt"]);return e!==void 0&&P!=null&&y(e,["parameters","enhancePrompt"],P),t}function j4(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["prompt"]);s!=null&&y(t,["instances[0]","prompt"],s);const a=m(e,["config"]);return a!=null&&V4(a,t),t}function Y4(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["prompt"]);s!=null&&y(t,["instances[0]","prompt"],s);const a=m(e,["config"]);return a!=null&&$4(a,t),t}function K4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>a5(l))),y(e,["generatedImages"],a)}const s=m(i,["positivePromptSafetyAttributes"]);return s!=null&&y(e,["positivePromptSafetyAttributes"],EM(s)),e}function J4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>j0(l))),y(e,["generatedImages"],a)}const s=m(i,["positivePromptSafetyAttributes"]);return s!=null&&y(e,["positivePromptSafetyAttributes"],TM(s)),e}function X4(i,e){const t={},n=m(i,["numberOfVideos"]);if(e!==void 0&&n!=null&&y(e,["parameters","sampleCount"],n),m(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(i,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=m(i,["durationSeconds"]);if(e!==void 0&&s!=null&&y(e,["parameters","durationSeconds"],s),m(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=m(i,["aspectRatio"]);e!==void 0&&a!=null&&y(e,["parameters","aspectRatio"],a);const l=m(i,["resolution"]);e!==void 0&&l!=null&&y(e,["parameters","resolution"],l);const c=m(i,["personGeneration"]);if(e!==void 0&&c!=null&&y(e,["parameters","personGeneration"],c),m(i,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=m(i,["negativePrompt"]);e!==void 0&&d!=null&&y(e,["parameters","negativePrompt"],d);const h=m(i,["enhancePrompt"]);if(e!==void 0&&h!=null&&y(e,["parameters","enhancePrompt"],h),m(i,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const p=m(i,["lastFrame"]);e!==void 0&&p!=null&&y(e,["instances[0]","lastFrame"],Y0(p));const v=m(i,["referenceImages"]);if(e!==void 0&&v!=null){let _=v;Array.isArray(_)&&(_=_.map(x=>Q5(x))),y(e,["instances[0]","referenceImages"],_)}if(m(i,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(m(i,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function W4(i,e){const t={},n=m(i,["numberOfVideos"]);e!==void 0&&n!=null&&y(e,["parameters","sampleCount"],n);const s=m(i,["outputGcsUri"]);e!==void 0&&s!=null&&y(e,["parameters","storageUri"],s);const a=m(i,["fps"]);e!==void 0&&a!=null&&y(e,["parameters","fps"],a);const l=m(i,["durationSeconds"]);e!==void 0&&l!=null&&y(e,["parameters","durationSeconds"],l);const c=m(i,["seed"]);e!==void 0&&c!=null&&y(e,["parameters","seed"],c);const d=m(i,["aspectRatio"]);e!==void 0&&d!=null&&y(e,["parameters","aspectRatio"],d);const h=m(i,["resolution"]);e!==void 0&&h!=null&&y(e,["parameters","resolution"],h);const p=m(i,["personGeneration"]);e!==void 0&&p!=null&&y(e,["parameters","personGeneration"],p);const v=m(i,["pubsubTopic"]);e!==void 0&&v!=null&&y(e,["parameters","pubsubTopic"],v);const _=m(i,["negativePrompt"]);e!==void 0&&_!=null&&y(e,["parameters","negativePrompt"],_);const x=m(i,["enhancePrompt"]);e!==void 0&&x!=null&&y(e,["parameters","enhancePrompt"],x);const A=m(i,["generateAudio"]);e!==void 0&&A!=null&&y(e,["parameters","generateAudio"],A);const E=m(i,["lastFrame"]);e!==void 0&&E!=null&&y(e,["instances[0]","lastFrame"],ks(E));const R=m(i,["referenceImages"]);if(e!==void 0&&R!=null){let P=R;Array.isArray(P)&&(P=P.map(L=>Z5(L))),y(e,["instances[0]","referenceImages"],P)}const N=m(i,["mask"]);e!==void 0&&N!=null&&y(e,["instances[0]","mask"],W5(N));const D=m(i,["compressionQuality"]);return e!==void 0&&D!=null&&y(e,["parameters","compressionQuality"],D),t}function Q4(i){const e={},t=m(i,["name"]);t!=null&&y(e,["name"],t);const n=m(i,["metadata"]);n!=null&&y(e,["metadata"],n);const s=m(i,["done"]);s!=null&&y(e,["done"],s);const a=m(i,["error"]);a!=null&&y(e,["error"],a);const l=m(i,["response","generateVideoResponse"]);return l!=null&&y(e,["response"],n5(l)),e}function Z4(i){const e={},t=m(i,["name"]);t!=null&&y(e,["name"],t);const n=m(i,["metadata"]);n!=null&&y(e,["metadata"],n);const s=m(i,["done"]);s!=null&&y(e,["done"],s);const a=m(i,["error"]);a!=null&&y(e,["error"],a);const l=m(i,["response"]);return l!=null&&y(e,["response"],i5(l)),e}function e5(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["prompt"]);s!=null&&y(t,["instances[0]","prompt"],s);const a=m(e,["image"]);a!=null&&y(t,["instances[0]","image"],Y0(a));const l=m(e,["video"]);l!=null&&y(t,["instances[0]","video"],RM(l));const c=m(e,["source"]);c!=null&&s5(c,t);const d=m(e,["config"]);return d!=null&&X4(d,t),t}function t5(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["prompt"]);s!=null&&y(t,["instances[0]","prompt"],s);const a=m(e,["image"]);a!=null&&y(t,["instances[0]","image"],ks(a));const l=m(e,["video"]);l!=null&&y(t,["instances[0]","video"],NM(l));const c=m(e,["source"]);c!=null&&r5(c,t);const d=m(e,["config"]);return d!=null&&W4(d,t),t}function n5(i){const e={},t=m(i,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>l5(l))),y(e,["generatedVideos"],a)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&y(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&y(e,["raiMediaFilteredReasons"],s),e}function i5(i){const e={},t=m(i,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>c5(l))),y(e,["generatedVideos"],a)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&y(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&y(e,["raiMediaFilteredReasons"],s),e}function s5(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&y(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&y(e,["instances[0]","image"],Y0(s));const a=m(i,["video"]);return e!==void 0&&a!=null&&y(e,["instances[0]","video"],RM(a)),t}function r5(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&y(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&y(e,["instances[0]","image"],ks(s));const a=m(i,["video"]);return e!==void 0&&a!=null&&y(e,["instances[0]","video"],NM(a)),t}function a5(i){const e={},t=m(i,["_self"]);t!=null&&y(e,["image"],y5(t));const n=m(i,["raiFilteredReason"]);n!=null&&y(e,["raiFilteredReason"],n);const s=m(i,["_self"]);return s!=null&&y(e,["safetyAttributes"],EM(s)),e}function j0(i){const e={},t=m(i,["_self"]);t!=null&&y(e,["image"],AM(t));const n=m(i,["raiFilteredReason"]);n!=null&&y(e,["raiFilteredReason"],n);const s=m(i,["_self"]);s!=null&&y(e,["safetyAttributes"],TM(s));const a=m(i,["prompt"]);return a!=null&&y(e,["enhancedPrompt"],a),e}function o5(i){const e={},t=m(i,["_self"]);t!=null&&y(e,["mask"],AM(t));const n=m(i,["labels"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>a)),y(e,["labels"],s)}return e}function l5(i){const e={},t=m(i,["video"]);return t!=null&&y(e,["video"],J5(t)),e}function c5(i){const e={},t=m(i,["_self"]);return t!=null&&y(e,["video"],X5(t)),e}function u5(i){const e={},t=m(i,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const n=m(i,["responseJsonSchema"]);n!=null&&y(e,["responseJsonSchema"],n);const s=m(i,["audioTimestamp"]);s!=null&&y(e,["audioTimestamp"],s);const a=m(i,["candidateCount"]);a!=null&&y(e,["candidateCount"],a);const l=m(i,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const c=m(i,["frequencyPenalty"]);c!=null&&y(e,["frequencyPenalty"],c);const d=m(i,["logprobs"]);d!=null&&y(e,["logprobs"],d);const h=m(i,["maxOutputTokens"]);h!=null&&y(e,["maxOutputTokens"],h);const p=m(i,["mediaResolution"]);p!=null&&y(e,["mediaResolution"],p);const v=m(i,["presencePenalty"]);v!=null&&y(e,["presencePenalty"],v);const _=m(i,["responseLogprobs"]);_!=null&&y(e,["responseLogprobs"],_);const x=m(i,["responseMimeType"]);x!=null&&y(e,["responseMimeType"],x);const A=m(i,["responseModalities"]);A!=null&&y(e,["responseModalities"],A);const E=m(i,["responseSchema"]);E!=null&&y(e,["responseSchema"],E);const R=m(i,["routingConfig"]);R!=null&&y(e,["routingConfig"],R);const N=m(i,["seed"]);N!=null&&y(e,["seed"],N);const D=m(i,["speechConfig"]);D!=null&&y(e,["speechConfig"],D);const P=m(i,["stopSequences"]);P!=null&&y(e,["stopSequences"],P);const L=m(i,["temperature"]);L!=null&&y(e,["temperature"],L);const B=m(i,["thinkingConfig"]);B!=null&&y(e,["thinkingConfig"],B);const H=m(i,["topK"]);H!=null&&y(e,["topK"],H);const O=m(i,["topP"]);if(O!=null&&y(e,["topP"],O),m(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function d5(i,e){const t={},n=m(e,["model"]);return n!=null&&y(t,["_url","name"],tt(i,n)),t}function h5(i,e){const t={},n=m(e,["model"]);return n!=null&&y(t,["_url","name"],tt(i,n)),t}function f5(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function p5(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function g5(i){const e={},t=m(i,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const n=m(i,["imageSize"]);if(n!=null&&y(e,["imageSize"],n),m(i,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(i,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(i,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function m5(i){const e={},t=m(i,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const n=m(i,["imageSize"]);n!=null&&y(e,["imageSize"],n);const s=m(i,["personGeneration"]);s!=null&&y(e,["personGeneration"],s);const a=m(i,["outputMimeType"]);a!=null&&y(e,["imageOutputOptions","mimeType"],a);const l=m(i,["outputCompressionQuality"]);return l!=null&&y(e,["imageOutputOptions","compressionQuality"],l),e}function y5(i){const e={},t=m(i,["bytesBase64Encoded"]);t!=null&&y(e,["imageBytes"],bo(t));const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function AM(i){const e={},t=m(i,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&y(e,["imageBytes"],bo(n));const s=m(i,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function Y0(i){const e={};if(m(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=m(i,["imageBytes"]);t!=null&&y(e,["bytesBase64Encoded"],bo(t));const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function ks(i){const e={},t=m(i,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const n=m(i,["imageBytes"]);n!=null&&y(e,["bytesBase64Encoded"],bo(n));const s=m(i,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function v5(i,e,t){const n={},s=m(e,["pageSize"]);t!==void 0&&s!=null&&y(t,["_query","pageSize"],s);const a=m(e,["pageToken"]);t!==void 0&&a!=null&&y(t,["_query","pageToken"],a);const l=m(e,["filter"]);t!==void 0&&l!=null&&y(t,["_query","filter"],l);const c=m(e,["queryBase"]);return t!==void 0&&c!=null&&y(t,["_url","models_url"],yM(i,c)),n}function b5(i,e,t){const n={},s=m(e,["pageSize"]);t!==void 0&&s!=null&&y(t,["_query","pageSize"],s);const a=m(e,["pageToken"]);t!==void 0&&a!=null&&y(t,["_query","pageToken"],a);const l=m(e,["filter"]);t!==void 0&&l!=null&&y(t,["_query","filter"],l);const c=m(e,["queryBase"]);return t!==void 0&&c!=null&&y(t,["_url","models_url"],yM(i,c)),n}function _5(i,e){const t={},n=m(e,["config"]);return n!=null&&v5(i,n,t),t}function w5(i,e){const t={},n=m(e,["config"]);return n!=null&&b5(i,n,t),t}function x5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const s=m(i,["_self"]);if(s!=null){let a=vM(s);Array.isArray(a)&&(a=a.map(l=>hw(l))),y(e,["models"],a)}return e}function S5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const s=m(i,["_self"]);if(s!=null){let a=vM(s);Array.isArray(a)&&(a=a.map(l=>fw(l))),y(e,["models"],a)}return e}function A5(i){const e={},t=m(i,["maskMode"]);t!=null&&y(e,["maskMode"],t);const n=m(i,["segmentationClasses"]);n!=null&&y(e,["maskClasses"],n);const s=m(i,["maskDilation"]);return s!=null&&y(e,["dilation"],s),e}function hw(i){const e={},t=m(i,["name"]);t!=null&&y(e,["name"],t);const n=m(i,["displayName"]);n!=null&&y(e,["displayName"],n);const s=m(i,["description"]);s!=null&&y(e,["description"],s);const a=m(i,["version"]);a!=null&&y(e,["version"],a);const l=m(i,["_self"]);l!=null&&y(e,["tunedModelInfo"],B5(l));const c=m(i,["inputTokenLimit"]);c!=null&&y(e,["inputTokenLimit"],c);const d=m(i,["outputTokenLimit"]);d!=null&&y(e,["outputTokenLimit"],d);const h=m(i,["supportedGenerationMethods"]);h!=null&&y(e,["supportedActions"],h);const p=m(i,["temperature"]);p!=null&&y(e,["temperature"],p);const v=m(i,["maxTemperature"]);v!=null&&y(e,["maxTemperature"],v);const _=m(i,["topP"]);_!=null&&y(e,["topP"],_);const x=m(i,["topK"]);x!=null&&y(e,["topK"],x);const A=m(i,["thinking"]);return A!=null&&y(e,["thinking"],A),e}function fw(i){const e={},t=m(i,["name"]);t!=null&&y(e,["name"],t);const n=m(i,["displayName"]);n!=null&&y(e,["displayName"],n);const s=m(i,["description"]);s!=null&&y(e,["description"],s);const a=m(i,["versionId"]);a!=null&&y(e,["version"],a);const l=m(i,["deployedModels"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(_=>U4(_))),y(e,["endpoints"],v)}const c=m(i,["labels"]);c!=null&&y(e,["labels"],c);const d=m(i,["_self"]);d!=null&&y(e,["tunedModelInfo"],G5(d));const h=m(i,["defaultCheckpointId"]);h!=null&&y(e,["defaultCheckpointId"],h);const p=m(i,["checkpoints"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(_=>_)),y(e,["checkpoints"],v)}return e}function E5(i){const e={},t=m(i,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&y(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&y(e,["executableCode"],s);const a=m(i,["fileData"]);a!=null&&y(e,["fileData"],F4(a));const l=m(i,["functionCall"]);l!=null&&y(e,["functionCall"],H4(l));const c=m(i,["functionResponse"]);c!=null&&y(e,["functionResponse"],c);const d=m(i,["inlineData"]);d!=null&&y(e,["inlineData"],u4(d));const h=m(i,["text"]);h!=null&&y(e,["text"],h);const p=m(i,["thought"]);p!=null&&y(e,["thought"],p);const v=m(i,["thoughtSignature"]);v!=null&&y(e,["thoughtSignature"],v);const _=m(i,["videoMetadata"]);return _!=null&&y(e,["videoMetadata"],_),e}function T5(i){const e={},t=m(i,["productImage"]);return t!=null&&y(e,["image"],ks(t)),e}function C5(i,e){const t={},n=m(i,["numberOfImages"]);e!==void 0&&n!=null&&y(e,["parameters","sampleCount"],n);const s=m(i,["baseSteps"]);e!==void 0&&s!=null&&y(e,["parameters","baseSteps"],s);const a=m(i,["outputGcsUri"]);e!==void 0&&a!=null&&y(e,["parameters","storageUri"],a);const l=m(i,["seed"]);e!==void 0&&l!=null&&y(e,["parameters","seed"],l);const c=m(i,["safetyFilterLevel"]);e!==void 0&&c!=null&&y(e,["parameters","safetySetting"],c);const d=m(i,["personGeneration"]);e!==void 0&&d!=null&&y(e,["parameters","personGeneration"],d);const h=m(i,["addWatermark"]);e!==void 0&&h!=null&&y(e,["parameters","addWatermark"],h);const p=m(i,["outputMimeType"]);e!==void 0&&p!=null&&y(e,["parameters","outputOptions","mimeType"],p);const v=m(i,["outputCompressionQuality"]);e!==void 0&&v!=null&&y(e,["parameters","outputOptions","compressionQuality"],v);const _=m(i,["enhancePrompt"]);e!==void 0&&_!=null&&y(e,["parameters","enhancePrompt"],_);const x=m(i,["labels"]);return e!==void 0&&x!=null&&y(e,["labels"],x),t}function R5(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["source"]);s!=null&&M5(s,t);const a=m(e,["config"]);return a!=null&&C5(a,t),t}function N5(i){const e={},t=m(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>j0(s))),y(e,["generatedImages"],n)}return e}function M5(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&y(e,["instances[0]","prompt"],n);const s=m(i,["personImage"]);e!==void 0&&s!=null&&y(e,["instances[0]","personImage","image"],ks(s));const a=m(i,["productImages"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>T5(c))),y(e,["instances[0]","productImages"],l)}return t}function k5(i){const e={},t=m(i,["referenceImage"]);t!=null&&y(e,["referenceImage"],ks(t));const n=m(i,["referenceId"]);n!=null&&y(e,["referenceId"],n);const s=m(i,["referenceType"]);s!=null&&y(e,["referenceType"],s);const a=m(i,["maskImageConfig"]);a!=null&&y(e,["maskImageConfig"],A5(a));const l=m(i,["controlImageConfig"]);l!=null&&y(e,["controlImageConfig"],y4(l));const c=m(i,["styleImageConfig"]);c!=null&&y(e,["styleImageConfig"],c);const d=m(i,["subjectImageConfig"]);return d!=null&&y(e,["subjectImageConfig"],d),e}function EM(i){const e={},t=m(i,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const n=m(i,["safetyAttributes","scores"]);n!=null&&y(e,["scores"],n);const s=m(i,["contentType"]);return s!=null&&y(e,["contentType"],s),e}function TM(i){const e={},t=m(i,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const n=m(i,["safetyAttributes","scores"]);n!=null&&y(e,["scores"],n);const s=m(i,["contentType"]);return s!=null&&y(e,["contentType"],s),e}function I5(i){const e={},t=m(i,["category"]);if(t!=null&&y(e,["category"],t),m(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(i,["threshold"]);return n!=null&&y(e,["threshold"],n),e}function D5(i){const e={},t=m(i,["image"]);return t!=null&&y(e,["image"],ks(t)),e}function P5(i,e){const t={},n=m(i,["mode"]);e!==void 0&&n!=null&&y(e,["parameters","mode"],n);const s=m(i,["maxPredictions"]);e!==void 0&&s!=null&&y(e,["parameters","maxPredictions"],s);const a=m(i,["confidenceThreshold"]);e!==void 0&&a!=null&&y(e,["parameters","confidenceThreshold"],a);const l=m(i,["maskDilation"]);e!==void 0&&l!=null&&y(e,["parameters","maskDilation"],l);const c=m(i,["binaryColorThreshold"]);e!==void 0&&c!=null&&y(e,["parameters","binaryColorThreshold"],c);const d=m(i,["labels"]);return e!==void 0&&d!=null&&y(e,["labels"],d),t}function L5(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["source"]);s!=null&&U5(s,t);const a=m(e,["config"]);return a!=null&&P5(a,t),t}function O5(i){const e={},t=m(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>o5(s))),y(e,["generatedMasks"],n)}return e}function U5(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&y(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&y(e,["instances[0]","image"],ks(s));const a=m(i,["scribbleImage"]);return e!==void 0&&a!=null&&y(e,["instances[0]","scribble"],D5(a)),t}function F5(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&y(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&y(e,["functionCallingConfig"],B4(n)),e}function H5(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&y(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&y(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&y(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=m(i,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(v=>v)),y(e,["functionDeclarations"],p)}const l=m(i,["googleMaps"]);l!=null&&y(e,["googleMaps"],f5(l));const c=m(i,["googleSearch"]);c!=null&&y(e,["googleSearch"],p5(c));const d=m(i,["googleSearchRetrieval"]);d!=null&&y(e,["googleSearchRetrieval"],d);const h=m(i,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}function CM(i){const e={},t=m(i,["retrieval"]);t!=null&&y(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&y(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&y(e,["codeExecution"],s);const a=m(i,["enterpriseWebSearch"]);a!=null&&y(e,["enterpriseWebSearch"],a);const l=m(i,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(_=>G4(_))),y(e,["functionDeclarations"],v)}const c=m(i,["googleMaps"]);c!=null&&y(e,["googleMaps"],c);const d=m(i,["googleSearch"]);d!=null&&y(e,["googleSearch"],d);const h=m(i,["googleSearchRetrieval"]);h!=null&&y(e,["googleSearchRetrieval"],h);const p=m(i,["urlContext"]);return p!=null&&y(e,["urlContext"],p),e}function B5(i){const e={},t=m(i,["baseModel"]);t!=null&&y(e,["baseModel"],t);const n=m(i,["createTime"]);n!=null&&y(e,["createTime"],n);const s=m(i,["updateTime"]);return s!=null&&y(e,["updateTime"],s),e}function G5(i){const e={},t=m(i,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&y(e,["baseModel"],t);const n=m(i,["createTime"]);n!=null&&y(e,["createTime"],n);const s=m(i,["updateTime"]);return s!=null&&y(e,["updateTime"],s),e}function z5(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&y(e,["displayName"],n);const s=m(i,["description"]);e!==void 0&&s!=null&&y(e,["description"],s);const a=m(i,["defaultCheckpointId"]);return e!==void 0&&a!=null&&y(e,["defaultCheckpointId"],a),t}function q5(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&y(e,["displayName"],n);const s=m(i,["description"]);e!==void 0&&s!=null&&y(e,["description"],s);const a=m(i,["defaultCheckpointId"]);return e!==void 0&&a!=null&&y(e,["defaultCheckpointId"],a),t}function V5(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","name"],tt(i,n));const s=m(e,["config"]);return s!=null&&z5(s,t),t}function $5(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["config"]);return s!=null&&q5(s,t),t}function j5(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&y(e,["parameters","storageUri"],n);const s=m(i,["safetyFilterLevel"]);e!==void 0&&s!=null&&y(e,["parameters","safetySetting"],s);const a=m(i,["personGeneration"]);e!==void 0&&a!=null&&y(e,["parameters","personGeneration"],a);const l=m(i,["includeRaiReason"]);e!==void 0&&l!=null&&y(e,["parameters","includeRaiReason"],l);const c=m(i,["outputMimeType"]);e!==void 0&&c!=null&&y(e,["parameters","outputOptions","mimeType"],c);const d=m(i,["outputCompressionQuality"]);e!==void 0&&d!=null&&y(e,["parameters","outputOptions","compressionQuality"],d);const h=m(i,["enhanceInputImage"]);e!==void 0&&h!=null&&y(e,["parameters","upscaleConfig","enhanceInputImage"],h);const p=m(i,["imagePreservationFactor"]);e!==void 0&&p!=null&&y(e,["parameters","upscaleConfig","imagePreservationFactor"],p);const v=m(i,["labels"]);e!==void 0&&v!=null&&y(e,["labels"],v);const _=m(i,["numberOfImages"]);e!==void 0&&_!=null&&y(e,["parameters","sampleCount"],_);const x=m(i,["mode"]);return e!==void 0&&x!=null&&y(e,["parameters","mode"],x),t}function Y5(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["_url","model"],tt(i,n));const s=m(e,["image"]);s!=null&&y(t,["instances[0]","image"],ks(s));const a=m(e,["upscaleFactor"]);a!=null&&y(t,["parameters","upscaleConfig","upscaleFactor"],a);const l=m(e,["config"]);return l!=null&&j5(l,t),t}function K5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>j0(a))),y(e,["generatedImages"],s)}return e}function J5(i){const e={},t=m(i,["uri"]);t!=null&&y(e,["uri"],t);const n=m(i,["encodedVideo"]);n!=null&&y(e,["videoBytes"],bo(n));const s=m(i,["encoding"]);return s!=null&&y(e,["mimeType"],s),e}function X5(i){const e={},t=m(i,["gcsUri"]);t!=null&&y(e,["uri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&y(e,["videoBytes"],bo(n));const s=m(i,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function W5(i){const e={},t=m(i,["image"]);t!=null&&y(e,["_self"],ks(t));const n=m(i,["maskMode"]);return n!=null&&y(e,["maskMode"],n),e}function Q5(i){const e={},t=m(i,["image"]);t!=null&&y(e,["image"],Y0(t));const n=m(i,["referenceType"]);return n!=null&&y(e,["referenceType"],n),e}function Z5(i){const e={},t=m(i,["image"]);t!=null&&y(e,["image"],ks(t));const n=m(i,["referenceType"]);return n!=null&&y(e,["referenceType"],n),e}function RM(i){const e={},t=m(i,["uri"]);t!=null&&y(e,["uri"],t);const n=m(i,["videoBytes"]);n!=null&&y(e,["encodedVideo"],bo(n));const s=m(i,["mimeType"]);return s!=null&&y(e,["encoding"],s),e}function NM(i){const e={},t=m(i,["uri"]);t!=null&&y(e,["gcsUri"],t);const n=m(i,["videoBytes"]);n!=null&&y(e,["bytesBase64Encoded"],bo(n));const s=m(i,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function e3(i,e){const t={},n=m(i,["displayName"]);return e!==void 0&&n!=null&&y(e,["displayName"],n),t}function t3(i){const e={},t=m(i,["config"]);return t!=null&&e3(t,e),e}function n3(i,e){const t={},n=m(i,["force"]);return e!==void 0&&n!=null&&y(e,["_query","force"],n),t}function i3(i){const e={},t=m(i,["name"]);t!=null&&y(e,["_url","name"],t);const n=m(i,["config"]);return n!=null&&n3(n,e),e}function s3(i){const e={},t=m(i,["name"]);return t!=null&&y(e,["_url","name"],t),e}function r3(i,e){const t={},n=m(i,["customMetadata"]);if(e!==void 0&&n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["customMetadata"],a)}const s=m(i,["chunkingConfig"]);return e!==void 0&&s!=null&&y(e,["chunkingConfig"],s),t}function a3(i){const e={},t=m(i,["name"]);t!=null&&y(e,["name"],t);const n=m(i,["metadata"]);n!=null&&y(e,["metadata"],n);const s=m(i,["done"]);s!=null&&y(e,["done"],s);const a=m(i,["error"]);a!=null&&y(e,["error"],a);const l=m(i,["response"]);return l!=null&&y(e,["response"],l3(l)),e}function o3(i){const e={},t=m(i,["fileSearchStoreName"]);t!=null&&y(e,["_url","file_search_store_name"],t);const n=m(i,["fileName"]);n!=null&&y(e,["fileName"],n);const s=m(i,["config"]);return s!=null&&r3(s,e),e}function l3(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&y(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&y(e,["documentName"],s),e}function c3(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),t}function u3(i){const e={},t=m(i,["config"]);return t!=null&&c3(t,e),e}function d3(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const s=m(i,["fileSearchStores"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["fileSearchStores"],a)}return e}function MM(i,e){const t={},n=m(i,["mimeType"]);e!==void 0&&n!=null&&y(e,["mimeType"],n);const s=m(i,["displayName"]);e!==void 0&&s!=null&&y(e,["displayName"],s);const a=m(i,["customMetadata"]);if(e!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>d)),y(e,["customMetadata"],c)}const l=m(i,["chunkingConfig"]);return e!==void 0&&l!=null&&y(e,["chunkingConfig"],l),t}function h3(i){const e={},t=m(i,["fileSearchStoreName"]);t!=null&&y(e,["_url","file_search_store_name"],t);const n=m(i,["config"]);return n!=null&&MM(n,e),e}function f3(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p3="Content-Type",g3="X-Server-Timeout",m3="User-Agent",pw="x-goog-api-client",y3="1.35.0",v3=`google-genai-sdk/${y3}`,b3="v1beta1",_3="v1beta";class w3{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:b3,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:_3,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const s=[this.getRequestUrlInternal(t)];return n&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))s.searchParams.append(l,String(c));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,s.toString(),e.abortSignal),this.unaryApiCall(s,a,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[s,a]of Object.entries(t))typeof a=="object"?n[s]=Object.assign(Object.assign({},n[s]),a):a!==void 0&&(n[s]=a);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,n);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,s.toString(),e.abortSignal),this.streamApiCall(s,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,s){if(t&&t.timeout||s){const a=new AbortController,l=a.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const c=setTimeout(()=>a.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}s&&s.addEventListener("abort",()=>{a.abort()}),e.signal=l}return t&&t.extraBody!==null&&x3(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await mC(s),new cw(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await mC(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return Cs(this,arguments,function*(){var n;const s=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),a=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let l="";const c="data:",d=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:h,value:p}=yield Pe(s.read());if(h){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const v=a.decode(p,{stream:!0});try{const A=JSON.parse(v);if("error"in A){const E=JSON.parse(JSON.stringify(A.error)),R=E.status,N=E.code,D=`got status: ${R}. ${JSON.stringify(A)}`;if(N>=400&&N<600)throw new V0({message:D,status:N})}}catch(A){if(A.name==="ApiError")throw A}l+=v;let _=-1,x=0;for(;;){_=-1,x=0;for(const R of d){const N=l.indexOf(R);N!==-1&&(_===-1||N<_)&&(_=N,x=R.length)}if(_===-1)break;const A=l.substring(0,_);l=l.substring(_+x);const E=A.trim();if(E.startsWith(c)){const R=E.substring(c.length).trim();try{const N=new Response(R,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Pe(new cw(N))}catch(N){throw new Error(`exception parsing stream chunk ${R}. ${N}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=v3+" "+this.clientOptions.userAgentExtra;return e[m3]=t,e[pw]=t,e[p3]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[s,a]of Object.entries(e.headers))n.append(s,a);e.timeout&&e.timeout>0&&n.append(g3,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return typeof e=="string"&&(n=e.replace(/[/\\]+$/,""),n=(t=n.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),n}async uploadFile(e,t){var n;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const a=this.clientOptions.uploader,l=await a.stat(e);s.sizeBytes=String(l.size);const c=(n=t==null?void 0:t.mimeType)!==null&&n!==void 0?n:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=c;const d={file:s},h=this.getFileName(e),p=ce("upload/v1beta/files",d._url),v=await this.fetchUploadUrl(p,s.sizeBytes,s.mimeType,h,d,t==null?void 0:t.httpOptions);return a.upload(e,v,this)}async uploadFileToFileSearchStore(e,t,n){var s;const a=this.clientOptions.uploader,l=await a.stat(t),c=String(l.size),d=(s=n==null?void 0:n.mimeType)!==null&&s!==void 0?s:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const h=`upload/v1beta/${e}:uploadToFileSearchStore`,p=this.getFileName(t),v={};n!=null&&MM(n,v);const _=await this.fetchUploadUrl(h,c,d,p,v,n==null?void 0:n.httpOptions);return a.uploadToFileSearchStore(t,_,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,n,s,a,l){var c;let d={};l?d=l:d={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},s?{"X-Goog-Upload-File-Name":s}:{})};const h=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:d});if(!h||!(h!=null&&h.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const p=(c=h==null?void 0:h.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(p===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return p}}async function mC(i){var e;if(i===void 0)throw new Error("response is undefined");if(!i.ok){const t=i.status;let n;!((e=i.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?n=await i.json():n={error:{message:await i.text(),code:i.status,status:i.statusText}};const s=JSON.stringify(n);throw t>=400&&t<600?new V0({message:s,status:t}):new Error(s)}}function x3(i,e){if(!e||Object.keys(e).length===0)return;if(i.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof i.body=="string"&&i.body.length>0)try{const a=JSON.parse(i.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(a,l){const c=Object.assign({},a);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const h=l[d],p=c[d];h&&typeof h=="object"&&!Array.isArray(h)&&p&&typeof p=="object"&&!Array.isArray(p)?c[d]=n(p,h):(p&&h&&typeof p!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof p}, New type: ${typeof h}. Overwriting.`),c[d]=h)}return c}const s=n(t,e);i.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const S3="mcp_used/unknown";let A3=!1;function kM(i){for(const e of i)if(E3(e)||typeof e=="object"&&"inputSchema"in e)return!0;return A3}function IM(i){var e;const t=(e=i[pw])!==null&&e!==void 0?e:"";i[pw]=(t+` ${S3}`).trimStart()}function E3(i){return i!==null&&typeof i=="object"&&i instanceof tx}function T3(i){return Cs(this,arguments,function*(t,n=100){let s,a=0;for(;a<n;){const l=yield Pe(t.listTools({cursor:s}));for(const c of l.tools)yield yield Pe(c),a++;if(!l.nextCursor)break;s=l.nextCursor}})}class tx{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new tx(e,t)}async initialize(){var e,t,n,s;if(this.mcpTools.length>0)return;const a={},l=[];for(const p of this.mcpClients)try{for(var c=!0,d=(t=void 0,Rs(T3(p))),h;h=await d.next(),e=h.done,!e;c=!0){s=h.value,c=!1;const v=s;l.push(v);const _=v.name;if(a[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);a[_]=p}}catch(v){t={error:v}}finally{try{!c&&!e&&(n=d.return)&&await n.call(d)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),sO(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[n.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const l=await s.callTool({name:n.name,arguments:n.args},void 0,a);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function C3(i,e,t){const n=new XL;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(n,s),e(n)}class R3{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=k3(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),d=`${s}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${c}`;let h=()=>{};const p=new Promise(P=>{h=P}),v=e.callbacks,_=function(){h({})},x=this.apiClient,A={onopen:_,onmessage:P=>{C3(x,v.onmessage,P)},onerror:(t=v==null?void 0:v.onerror)!==null&&t!==void 0?t:function(P){},onclose:(n=v==null?void 0:v.onclose)!==null&&n!==void 0?n:function(P){}},E=this.webSocketFactory.create(d,M3(l),A);E.connect(),await p;const D={setup:{model:tt(this.apiClient,e.model)}};return E.send(JSON.stringify(D)),new N3(E,this.apiClient)}}class N3{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=t4(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=e4(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(fu.PLAY)}pause(){this.sendPlaybackControl(fu.PAUSE)}stop(){this.sendPlaybackControl(fu.STOP)}resetContext(){this.sendPlaybackControl(fu.RESET_CONTEXT)}close(){this.conn.close()}}function M3(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function k3(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const I3="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function D3(i,e,t){const n=new JL;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const a=JSON.parse(s);if(i.isVertexAI()){const l=s4(a);Object.assign(n,l)}else Object.assign(n,a);e(n)}class P3{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new R3(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,s,a,l,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let p;const v=this.apiClient.getHeaders();e.config&&e.config.tools&&kM(e.config.tools)&&IM(v);const _=F3(v);if(this.apiClient.isVertexAI())p=`${d}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_,p);else{const Y=this.apiClient.getApiKey();let se="BidiGenerateContent",re="key";Y!=null&&Y.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),se="BidiGenerateContentConstrained",re="access_token"),p=`${d}/ws/google.ai.generativelanguage.${h}.GenerativeService.${se}?${re}=${Y}`}let x=()=>{};const A=new Promise(Y=>{x=Y}),E=e.callbacks,R=function(){var Y;(Y=E==null?void 0:E.onopen)===null||Y===void 0||Y.call(E),x({})},N=this.apiClient,D={onopen:R,onmessage:Y=>{D3(N,E.onmessage,Y)},onerror:(t=E==null?void 0:E.onerror)!==null&&t!==void 0?t:function(Y){},onclose:(n=E==null?void 0:E.onclose)!==null&&n!==void 0?n:function(Y){}},P=this.webSocketFactory.create(p,U3(_),D);P.connect(),await A;let L=tt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&L.startsWith("publishers/")){const Y=this.apiClient.getProject(),se=this.apiClient.getLocation();L=`projects/${Y}/locations/${se}/`+L}let B={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[r0.AUDIO]}:e.config.responseModalities=[r0.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const H=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],O=[];for(const Y of H)if(this.isCallableTool(Y)){const se=Y;O.push(await se.tool())}else O.push(Y);O.length>0&&(e.config.tools=O);const X={model:L,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?B=ZU(this.apiClient,X):B=QU(this.apiClient,X),delete B.config,P.send(JSON.stringify(B)),new O3(P,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const L3={turnComplete:!0};class O3{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=is(t.turns),e.isVertexAI()||(n=n.map(s=>$0(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const a of n){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(I3)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},L3),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:i4(e)}:t={realtimeInput:n4(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function U3(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function F3(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yC=10;function vC(i){var e,t,n;if(!((e=i==null?void 0:i.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const l of(t=i==null?void 0:i.tools)!==null&&t!==void 0?t:[])if(wu(l)){s=!0;break}if(!s)return!0;const a=(n=i==null?void 0:i.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function wu(i){return"callTool"in i&&typeof i.callTool=="function"}function H3(i){var e,t,n;return(n=(t=(e=i.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>wu(s)))!==null&&n!==void 0?n:!1}function bC(i){var e;const t=[];return!((e=i==null?void 0:i.config)===null||e===void 0)&&e.tools&&i.config.tools.forEach((n,s)=>{if(wu(n))return;const a=n;a.functionDeclarations&&a.functionDeclarations.length>0&&t.push(s)}),t}function _C(i){var e;return!(!((e=i==null?void 0:i.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class B3 extends ra{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,s,a,l,c;const d=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!H3(t)||vC(t.config))return await this.generateContentInternal(d);const h=bC(t);if(h.length>0){const E=h.map(R=>`tools[${R}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${E}.`)}let p,v;const _=is(d.contents),x=(a=(s=(n=d.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&a!==void 0?a:yC;let A=0;for(;A<x&&(p=await this.generateContentInternal(d),!(!p.functionCalls||p.functionCalls.length===0));){const E=p.candidates[0].content,R=[];for(const N of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(wu(N)){const P=await N.callTool(p.functionCalls);R.push(...P)}A++,v={role:"user",parts:R},d.contents=is(d.contents),d.contents.push(E),d.contents.push(v),_C(d.config)&&(_.push(E),_.push(v))}return _C(d.config)&&(p.automaticFunctionCallingHistory=_),p},this.generateContentStream=async t=>{var n,s,a,l,c;if(this.maybeMoveToResponseJsonSchem(t),vC(t.config)){const v=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(v)}const d=bC(t);if(d.length>0){const v=d.map(_=>`tools[${_}]`).join(", ");throw new Error(`Incompatible tools found at ${v}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const h=(a=(s=(n=t==null?void 0:t.config)===null||n===void 0?void 0:n.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,p=(c=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(h&&!p)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var s;let a;const l=[];if(n!=null&&n.generatedImages)for(const d of n.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((s=d==null?void 0:d.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?a=d==null?void 0:d.safetyAttributes:l.push(d);let c;return a?c={generatedImages:l,positivePromptSafetyAttributes:a,sdkHttpResponse:n.sdkHttpResponse}:c={generatedImages:l,sdkHttpResponse:n.sdkHttpResponse},c}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new oc(na.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var n,s,a,l,c,d;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=t.video)===null||n===void 0)&&n.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(a=t.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.uri&&(!((d=(c=t.source)===null||c===void 0?void 0:c.video)===null||d===void 0)&&d.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,s;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const l=await Promise.all(a.map(async d=>wu(d)?await d.tool():d)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&kM(e.config.tools)){const d=(s=(n=e.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&s!==void 0?s:{};let h=Object.assign({},d);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),IM(h),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:h})}return c}async initAfcToolsMap(e){var t,n,s;const a=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(wu(l)){const c=l,d=await c.tool();for(const h of(s=d.functionDeclarations)!==null&&s!==void 0?s:[]){if(!h.name)throw new Error("Function declaration name is required.");if(a.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);a.set(h.name,c)}}return a}async processAfcStream(e){var t,n,s;const a=(s=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&s!==void 0?s:yC;let l=!1,c=0;const d=await this.initAfcToolsMap(e);return(function(h,p,v){return Cs(this,arguments,function*(){for(var _,x,A,E,R,N;c<a;){l&&(c++,l=!1);const B=yield Pe(h.processParamsMaybeAddMcpUsage(v)),H=yield Pe(h.generateContentStreamInternal(B)),O=[],X=[];try{for(var D=!0,P=(x=void 0,Rs(H)),L;L=yield Pe(P.next()),_=L.done,!_;D=!0){E=L.value,D=!1;const Y=E;if(yield yield Pe(Y),Y.candidates&&(!((R=Y.candidates[0])===null||R===void 0)&&R.content)){X.push(Y.candidates[0].content);for(const se of(N=Y.candidates[0].content.parts)!==null&&N!==void 0?N:[])if(c<a&&se.functionCall){if(!se.functionCall.name)throw new Error("Function call name was not returned by the model.");if(p.has(se.functionCall.name)){const re=yield Pe(p.get(se.functionCall.name).callTool([se.functionCall]));O.push(...re)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${p.keys()}, mising tool: ${se.functionCall.name}`)}}}}catch(Y){x={error:Y}}finally{try{!D&&!_&&(A=P.return)&&(yield Pe(A.call(P)))}finally{if(x)throw x.error}}if(O.length>0){l=!0;const Y=new kh;Y.candidates=[{content:{role:"user",parts:O}}],yield yield Pe(Y);const se=[];se.push(...X),se.push({role:"user",parts:O});const re=is(v.contents).concat(se);v.contents=re}else break}})})(this,d,e)}async generateContentInternal(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=fC(this.apiClient,e);return c=ce("{model}:generateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=gC(p),_=new kh;return Object.assign(_,v),_})}else{const h=hC(this.apiClient,e);return c=ce("{model}:generateContent",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=pC(p),_=new kh;return Object.assign(_,v),_})}}async generateContentStreamInternal(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=fC(this.apiClient,e);return c=ce("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(v){return Cs(this,arguments,function*(){var _,x,A,E;try{for(var R=!0,N=Rs(v),D;D=yield Pe(N.next()),_=D.done,!_;R=!0){E=D.value,R=!1;const P=E,L=gC(yield Pe(P.json()));L.sdkHttpResponse={headers:P.headers};const B=new kh;Object.assign(B,L),yield yield Pe(B)}}catch(P){x={error:P}}finally{try{!R&&!_&&(A=N.return)&&(yield Pe(A.call(N)))}finally{if(x)throw x.error}}})})}else{const h=hC(this.apiClient,e);return c=ce("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(v){return Cs(this,arguments,function*(){var _,x,A,E;try{for(var R=!0,N=Rs(v),D;D=yield Pe(N.next()),_=D.done,!_;R=!0){E=D.value,R=!1;const P=E,L=pC(yield Pe(P.json()));L.sdkHttpResponse={headers:P.headers};const B=new kh;Object.assign(B,L),yield yield Pe(B)}}catch(P){x={error:P}}finally{try{!R&&!_&&(A=N.return)&&(yield Pe(A.call(N)))}finally{if(x)throw x.error}}})})}}async embedContent(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=P4(this.apiClient,e);return c=ce("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=O4(p),_=new J1;return Object.assign(_,v),_})}else{const h=D4(this.apiClient,e);return c=ce("{model}:batchEmbedContents",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=L4(p),_=new J1;return Object.assign(_,v),_})}}async generateImagesInternal(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=Y4(this.apiClient,e);return c=ce("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=J4(p),_=new X1;return Object.assign(_,v),_})}else{const h=j4(this.apiClient,e);return c=ce("{model}:predict",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=K4(p),_=new X1;return Object.assign(_,v),_})}}async editImageInternal(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=N4(this.apiClient,e);return a=ce("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=M4(d),p=new FL;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=Y5(this.apiClient,e);return a=ce("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=K5(d),p=new HL;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=R5(this.apiClient,e);return a=ce("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>{const h=N5(d),p=new BL;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=L5(this.apiClient,e);return a=ce("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>{const h=O5(d),p=new GL;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=h5(this.apiClient,e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>fw(p))}else{const h=d5(this.apiClient,e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>hw(p))}}async listInternal(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=w5(this.apiClient,e);return c=ce("{models_url}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=S5(p),_=new W1;return Object.assign(_,v),_})}else{const h=_5(this.apiClient,e);return c=ce("{models_url}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=x5(p),_=new W1;return Object.assign(_,v),_})}}async update(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=$5(this.apiClient,e);return c=ce("{model}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>fw(p))}else{const h=V5(this.apiClient,e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>hw(p))}}async delete(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=E4(this.apiClient,e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=C4(p),_=new Q1;return Object.assign(_,v),_})}else{const h=A4(this.apiClient,e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=T4(p),_=new Q1;return Object.assign(_,v),_})}}async countTokens(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=w4(this.apiClient,e);return c=ce("{model}:countTokens",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=S4(p),_=new Z1;return Object.assign(_,v),_})}else{const h=_4(this.apiClient,e);return c=ce("{model}:countTokens",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=x4(p),_=new Z1;return Object.assign(_,v),_})}}async computeTokens(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=f4(this.apiClient,e);return a=ce("{model}:computeTokens",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=p4(d),p=new zL;return Object.assign(p,h),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=t5(this.apiClient,e);return c=ce("{model}:predictLongRunning",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>{const v=Z4(p),_=new a0;return Object.assign(_,v),_})}else{const h=e5(this.apiClient,e);return c=ce("{model}:predictLongRunning",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l.then(p=>{const v=Q4(p),_=new a0;return Object.assign(_,v),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class G3 extends ra{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;n&&"httpOptions"in n&&(a=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;n&&"httpOptions"in n&&(a=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=IL(e);return c=ce("{operationName}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l}else{const h=kL(e);return c=ce("{operationName}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json()),l}}async fetchPredictVideosOperationInternal(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=AL(e);return a=ce("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function z3(i){const e={},t=m(i,["data"]);if(t!=null&&y(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function q3(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>Q3(a))),y(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&y(e,["role"],n),e}function V3(i,e,t){const n={},s=m(e,["expireTime"]);t!==void 0&&s!=null&&y(t,["expireTime"],s);const a=m(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&y(t,["newSessionExpireTime"],a);const l=m(e,["uses"]);t!==void 0&&l!=null&&y(t,["uses"],l);const c=m(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&y(t,["bidiGenerateContentSetup"],W3(i,c));const d=m(e,["lockAdditionalFields"]);return t!==void 0&&d!=null&&y(t,["fieldMask"],d),n}function $3(i,e){const t={},n=m(e,["config"]);return n!=null&&y(t,["config"],V3(i,n,t)),t}function j3(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&y(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&y(e,["mimeType"],n),e}function Y3(i){const e={},t=m(i,["id"]);t!=null&&y(e,["id"],t);const n=m(i,["args"]);n!=null&&y(e,["args"],n);const s=m(i,["name"]);if(s!=null&&y(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function K3(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function J3(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function X3(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&y(e,["setup","generationConfig"],n);const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig","responseModalities"],s);const a=m(i,["temperature"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","temperature"],a);const l=m(i,["topP"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&y(e,["setup","generationConfig","topK"],c);const d=m(i,["maxOutputTokens"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","maxOutputTokens"],d);const h=m(i,["mediaResolution"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","mediaResolution"],h);const p=m(i,["seed"]);e!==void 0&&p!=null&&y(e,["setup","generationConfig","seed"],p);const v=m(i,["speechConfig"]);e!==void 0&&v!=null&&y(e,["setup","generationConfig","speechConfig"],ex(v));const _=m(i,["thinkingConfig"]);e!==void 0&&_!=null&&y(e,["setup","generationConfig","thinkingConfig"],_);const x=m(i,["enableAffectiveDialog"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],x);const A=m(i,["systemInstruction"]);e!==void 0&&A!=null&&y(e,["setup","systemInstruction"],q3(Ln(A)));const E=m(i,["tools"]);if(e!==void 0&&E!=null){let H=kd(E);Array.isArray(H)&&(H=H.map(O=>eF(Md(O)))),y(e,["setup","tools"],H)}const R=m(i,["sessionResumption"]);e!==void 0&&R!=null&&y(e,["setup","sessionResumption"],Z3(R));const N=m(i,["inputAudioTranscription"]);e!==void 0&&N!=null&&y(e,["setup","inputAudioTranscription"],N);const D=m(i,["outputAudioTranscription"]);e!==void 0&&D!=null&&y(e,["setup","outputAudioTranscription"],D);const P=m(i,["realtimeInputConfig"]);e!==void 0&&P!=null&&y(e,["setup","realtimeInputConfig"],P);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&y(e,["setup","contextWindowCompression"],L);const B=m(i,["proactivity"]);if(e!==void 0&&B!=null&&y(e,["setup","proactivity"],B),m(i,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function W3(i,e){const t={},n=m(e,["model"]);n!=null&&y(t,["setup","model"],tt(i,n));const s=m(e,["config"]);return s!=null&&y(t,["config"],X3(s,t)),t}function Q3(i){const e={},t=m(i,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&y(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&y(e,["executableCode"],s);const a=m(i,["fileData"]);a!=null&&y(e,["fileData"],j3(a));const l=m(i,["functionCall"]);l!=null&&y(e,["functionCall"],Y3(l));const c=m(i,["functionResponse"]);c!=null&&y(e,["functionResponse"],c);const d=m(i,["inlineData"]);d!=null&&y(e,["inlineData"],z3(d));const h=m(i,["text"]);h!=null&&y(e,["text"],h);const p=m(i,["thought"]);p!=null&&y(e,["thought"],p);const v=m(i,["thoughtSignature"]);v!=null&&y(e,["thoughtSignature"],v);const _=m(i,["videoMetadata"]);return _!=null&&y(e,["videoMetadata"],_),e}function Z3(i){const e={},t=m(i,["handle"]);if(t!=null&&y(e,["handle"],t),m(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function eF(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&y(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&y(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&y(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=m(i,["functionDeclarations"]);if(a!=null){let p=a;Array.isArray(p)&&(p=p.map(v=>v)),y(e,["functionDeclarations"],p)}const l=m(i,["googleMaps"]);l!=null&&y(e,["googleMaps"],K3(l));const c=m(i,["googleSearch"]);c!=null&&y(e,["googleSearch"],J3(c));const d=m(i,["googleSearchRetrieval"]);d!=null&&y(e,["googleSearchRetrieval"],d);const h=m(i,["urlContext"]);return h!=null&&y(e,["urlContext"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tF(i){const e=[];for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)){const n=i[t];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const s=Object.keys(n).map(a=>`${t}.${a}`);e.push(...s)}else e.push(t)}return e.join(",")}function nF(i,e){let t=null;const n=i.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const a=n.setup;typeof a=="object"&&a!==null?(i.bidiGenerateContentSetup=a,t=a):delete i.bidiGenerateContentSetup}else n!==void 0&&delete i.bidiGenerateContentSetup;const s=i.fieldMask;if(t){const a=tF(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?i.fieldMask=a:delete i.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];s.length>0&&(c=s.map(h=>l.includes(h)?`generationConfig.${h}`:h));const d=[];a&&d.push(a),c.length>0&&d.push(...c),d.length>0?i.fieldMask=d.join(","):delete i.fieldMask}else delete i.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?i.fieldMask=s.join(","):delete i.fieldMask;return i}class iF extends ra{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=$3(this.apiClient,e);a=ce("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const d=nF(c,e.config);return s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sF(i,e){const t={},n=m(i,["force"]);return e!==void 0&&n!=null&&y(e,["_query","force"],n),t}function rF(i){const e={},t=m(i,["name"]);t!=null&&y(e,["_url","name"],t);const n=m(i,["config"]);return n!=null&&sF(n,e),e}function aF(i){const e={},t=m(i,["name"]);return t!=null&&y(e,["_url","name"],t),e}function oF(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&y(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),t}function lF(i){const e={},t=m(i,["parent"]);t!=null&&y(e,["_url","parent"],t);const n=m(i,["config"]);return n!=null&&oF(n,e),e}function cF(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&y(e,["nextPageToken"],n);const s=m(i,["documents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uF extends ra{constructor(e){super(),this.apiClient=e,this.list=async t=>new oc(na.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:t.parent,config:n.config}),await this.listInternal(t),t)}async get(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=aF(e);return a=ce("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>d)}}async delete(e){var t,n;let s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=rF(e);s=ce("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=lF(e);return a=ce("{parent}/documents",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>{const h=cF(d),p=new qL;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dF extends ra{constructor(e,t=new uF(e)){super(),this.apiClient=e,this.documents=t,this.list=async(n={})=>new oc(na.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(n),n)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=t3(e);return a=ce("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>d)}}async get(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=s3(e);return a=ce("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>d)}}async delete(e){var t,n;let s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=i3(e);s=ce("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=u3(e);return a=ce("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>{const h=d3(d),p=new VL;return Object.assign(p,h),p})}}async uploadToFileSearchStoreInternal(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=h3(e);return a=ce("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>{const h=f3(d),p=new $L;return Object.assign(p,h),p})}}async importFile(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=o3(e);return a=ce("{file_search_store_name}:importFile",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>{const h=a3(d),p=new Jw;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let DM=function(){const{crypto:i}=globalThis;if(i!=null&&i.randomUUID)return DM=i.randomUUID.bind(i),i.randomUUID();const e=new Uint8Array(1),t=i?()=>i.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))};const hF=()=>DM();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gw(i){return typeof i=="object"&&i!==null&&("name"in i&&i.name==="AbortError"||"message"in i&&String(i.message).includes("FetchRequestCanceledException"))}const mw=i=>{if(i instanceof Error)return i;if(typeof i=="object"&&i!==null){try{if(Object.prototype.toString.call(i)==="[object Error]"){const e=new Error(i.message,i.cause?{cause:i.cause}:{});return i.stack&&(e.stack=i.stack),i.cause&&!e.cause&&(e.cause=i.cause),i.name&&(e.name=i.name),e}}catch{}try{return new Error(JSON.stringify(i))}catch{}}return new Error(i)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rs extends Error{}class Yn extends rs{constructor(e,t,n,s){super(`${Yn.makeMessage(e,t,n)}`),this.status=e,this.headers=s,this.error=t}static makeMessage(e,t,n){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,n,s){if(!e||!s)return new K0({message:n,cause:mw(t)});const a=t;return e===400?new LM(e,a,n,s):e===401?new OM(e,a,n,s):e===403?new UM(e,a,n,s):e===404?new FM(e,a,n,s):e===409?new HM(e,a,n,s):e===422?new BM(e,a,n,s):e===429?new GM(e,a,n,s):e>=500?new zM(e,a,n,s):new Yn(e,a,n,s)}}class yw extends Yn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class K0 extends Yn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class PM extends K0{constructor({message:e}={}){super({message:e??"Request timed out."})}}class LM extends Yn{}class OM extends Yn{}class UM extends Yn{}class FM extends Yn{}class HM extends Yn{}class BM extends Yn{}class GM extends Yn{}class zM extends Yn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fF=/^[a-z][a-z0-9+.-]*:/i,pF=i=>fF.test(i);let vw=i=>(vw=Array.isArray,vw(i));const gF=vw;let mF=gF;const wC=mF;function yF(i){if(!i)return!0;for(const e in i)return!1;return!0}function vF(i,e){return Object.prototype.hasOwnProperty.call(i,e)}const bF=(i,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new rs(`${i} must be an integer`);if(e<0)throw new rs(`${i} must be a positive integer`);return e},_F=i=>{try{return JSON.parse(i)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wF=i=>new Promise(e=>setTimeout(e,i));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const uu="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xF(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const SF=()=>{var i,e,t,n,s;const a=xF();if(a==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":uu,"X-Stainless-OS":SC(Deno.build.os),"X-Stainless-Arch":xC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(i=Deno.version)===null||i===void 0?void 0:i.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":uu,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(a==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":uu,"X-Stainless-OS":SC((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":xC((n=globalThis.process.arch)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(s=globalThis.process.version)!==null&&s!==void 0?s:"unknown"};const l=AF();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":uu,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":uu,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function AF(){if(typeof navigator>"u"||!navigator)return null;const i=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of i){const n=t.exec(navigator.userAgent);if(n){const s=n[1]||0,a=n[2]||0,l=n[3]||0;return{browser:e,version:`${s}.${a}.${l}`}}}return null}const xC=i=>i==="x32"?"x32":i==="x86_64"||i==="x64"?"x64":i==="arm"?"arm":i==="aarch64"||i==="arm64"?"arm64":i?`other:${i}`:"unknown",SC=i=>(i=i.toLowerCase(),i.includes("ios")?"iOS":i==="android"?"Android":i==="darwin"?"MacOS":i==="win32"?"Windows":i==="freebsd"?"FreeBSD":i==="openbsd"?"OpenBSD":i==="linux"?"Linux":i?`Other:${i}`:"Unknown");let lm;const EF=()=>lm??(lm=SF());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TF(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function qM(...i){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...i)}function CF(i){let e=Symbol.asyncIterator in i?i[Symbol.asyncIterator]():i[Symbol.iterator]();return qM({start(){},async pull(t){const{done:n,value:s}=await e.next();n?t.close():t.enqueue(s)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function VM(i){if(i[Symbol.asyncIterator])return i;const e=i.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function RF(i){var e,t;if(i===null||typeof i!="object")return;if(i[Symbol.asyncIterator]){await((t=(e=i[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const n=i.getReader(),s=n.cancel();n.releaseLock(),await s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const NF=({headers:i,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $M=()=>{var i;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((i=e==null?void 0:e.versions)===null||i===void 0?void 0:i.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Ib(i,e,t){return $M(),new File(i,e??"unknown_file",t)}function MF(i){return(typeof i=="object"&&i!==null&&("name"in i&&i.name&&String(i.name)||"url"in i&&i.url&&String(i.url)||"filename"in i&&i.filename&&String(i.filename)||"path"in i&&i.path&&String(i.path))||"").split(/[\\/]/).pop()||void 0}const kF=i=>i!=null&&typeof i=="object"&&typeof i[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jM=i=>i!=null&&typeof i=="object"&&typeof i.size=="number"&&typeof i.type=="string"&&typeof i.text=="function"&&typeof i.slice=="function"&&typeof i.arrayBuffer=="function",IF=i=>i!=null&&typeof i=="object"&&typeof i.name=="string"&&typeof i.lastModified=="number"&&jM(i),DF=i=>i!=null&&typeof i=="object"&&typeof i.url=="string"&&typeof i.blob=="function";async function PF(i,e,t){if($M(),i=await i,IF(i))return i instanceof File?i:Ib([await i.arrayBuffer()],i.name);if(DF(i)){const s=await i.blob();return e||(e=new URL(i.url).pathname.split(/[\\/]/).pop()),Ib(await bw(s),e,t)}const n=await bw(i);if(e||(e=MF(i)),!(t!=null&&t.type)){const s=n.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof s=="string"&&(t=Object.assign(Object.assign({},t),{type:s}))}return Ib(n,e,t)}async function bw(i){var e,t,n,s,a;let l=[];if(typeof i=="string"||ArrayBuffer.isView(i)||i instanceof ArrayBuffer)l.push(i);else if(jM(i))l.push(i instanceof Blob?i:await i.arrayBuffer());else if(kF(i))try{for(var c=!0,d=Rs(i),h;h=await d.next(),e=h.done,!e;c=!0){s=h.value,c=!1;const p=s;l.push(...await bw(p))}}catch(p){t={error:p}}finally{try{!c&&!e&&(n=d.return)&&await n.call(d)}finally{if(t)throw t.error}}else{const p=(a=i==null?void 0:i.constructor)===null||a===void 0?void 0:a.name;throw new Error(`Unexpected data type: ${typeof i}${p?`; constructor: ${p}`:""}${LF(i)}`)}return l}function LF(i){return typeof i!="object"||i===null?"":`; props: [${Object.getOwnPropertyNames(i).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YM{constructor(e){this._client=e}}YM._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KM(i){return i.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const AC=Object.freeze(Object.create(null)),OF=(i=KM)=>(function(t,...n){if(t.length===1)return t[0];let s=!1;const a=[],l=t.reduce((p,v,_)=>{var x,A,E;/[?#]/.test(v)&&(s=!0);const R=n[_];let N=(s?encodeURIComponent:i)(""+R);return _!==n.length&&(R==null||typeof R=="object"&&R.toString===((E=Object.getPrototypeOf((A=Object.getPrototypeOf((x=R.hasOwnProperty)!==null&&x!==void 0?x:AC))!==null&&A!==void 0?A:AC))===null||E===void 0?void 0:E.toString))&&(N=R+"",a.push({start:p.length+v.length,length:N.length,error:`Value of type ${Object.prototype.toString.call(R).slice(8,-1)} is not a valid path parameter`})),p+v+(_===n.length?"":N)},""),c=l.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=d.exec(c))!==null;)a.push({start:h.index,length:h[0].length,error:`Value "${h[0]}" can't be safely passed as a path parameter`});if(a.sort((p,v)=>p.start-v.start),a.length>0){let p=0;const v=a.reduce((_,x)=>{const A=" ".repeat(x.start-p),E="^".repeat(x.length);return p=x.start+x.length,_+A+E},"");throw new rs(`Path parameters result in path with invalid segments:
${a.map(_=>_.error).join(`
`)}
${l}
${v}`)}return l}),cm=OF(KM);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JM extends YM{create(e,t){var n;const{api_version:s=this._client.apiVersion}=e,a=l0(e,["api_version"]);if("model"in a&&"agent_config"in a)throw new rs("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in a&&"generation_config"in a)throw new rs("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(cm`/${s}/interactions`,Object.assign(Object.assign({body:a},t),{stream:(n=e.stream)!==null&&n!==void 0?n:!1}))}delete(e,t={},n){const{api_version:s=this._client.apiVersion}=t??{};return this._client.delete(cm`/${s}/interactions/${e}`,n)}cancel(e,t={},n){const{api_version:s=this._client.apiVersion}=t??{};return this._client.post(cm`/${s}/interactions/${e}/cancel`,n)}get(e,t={},n){var s;const a=t??{},{api_version:l=this._client.apiVersion}=a,c=l0(a,["api_version"]);return this._client.get(cm`/${l}/interactions/${e}`,Object.assign(Object.assign({query:c},n),{stream:(s=t==null?void 0:t.stream)!==null&&s!==void 0?s:!1}))}}JM._key=Object.freeze(["interactions"]);class XM extends JM{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function UF(i){let e=0;for(const s of i)e+=s.length;const t=new Uint8Array(e);let n=0;for(const s of i)t.set(s,n),n+=s.length;return t}let um;function nx(i){let e;return(um??(e=new globalThis.TextEncoder,um=e.encode.bind(e)))(i)}let dm;function EC(i){let e;return(dm??(e=new globalThis.TextDecoder,dm=e.decode.bind(e)))(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class J0{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?nx(e):e;this.buffer=UF([this.buffer,t]);const n=[];let s;for(;(s=FF(this.buffer,this.carriageReturnIndex))!=null;){if(s.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=s.index;continue}if(this.carriageReturnIndex!=null&&(s.index!==this.carriageReturnIndex+1||s.carriage)){n.push(EC(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const a=this.carriageReturnIndex!==null?s.preceding-1:s.preceding,l=EC(this.buffer.subarray(0,a));n.push(l),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode(`
`):[]}}J0.NEWLINE_CHARS=new Set([`
`,"\r"]);J0.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function FF(i,e){for(let s=e??0;s<i.length;s++){if(i[s]===10)return{preceding:s,index:s+1,carriage:!1};if(i[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function HF(i){for(let n=0;n<i.length-1;n++){if(i[n]===10&&i[n+1]===10||i[n]===13&&i[n+1]===13)return n+2;if(i[n]===13&&i[n+1]===10&&n+3<i.length&&i[n+2]===13&&i[n+3]===10)return n+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const c0={off:0,error:200,warn:300,info:400,debug:500},TC=(i,e,t)=>{if(i){if(vF(c0,i))return i;qn(t).warn(`${e} was set to ${JSON.stringify(i)}, expected one of ${JSON.stringify(Object.keys(c0))}`)}};function Jh(){}function hm(i,e,t){return!e||c0[i]>c0[t]?Jh:e[i].bind(e)}const BF={error:Jh,warn:Jh,info:Jh,debug:Jh};let CC=new WeakMap;function qn(i){var e;const t=i.logger,n=(e=i.logLevel)!==null&&e!==void 0?e:"off";if(!t)return BF;const s=CC.get(t);if(s&&s[0]===n)return s[1];const a={error:hm("error",t,n),warn:hm("warn",t,n),info:hm("info",t,n),debug:hm("debug",t,n)};return CC.set(t,[n,a]),a}const $o=i=>(i.options&&(i.options=Object.assign({},i.options),delete i.options.headers),i.headers&&(i.headers=Object.fromEntries((i.headers instanceof Headers?[...i.headers]:Object.entries(i.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in i&&(i.retryOfRequestLogID&&(i.retryOf=i.retryOfRequestLogID),delete i.retryOfRequestLogID),i);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pu{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let s=!1;const a=n?qn(n):console;function l(){return Cs(this,arguments,function*(){var d,h,p,v;if(s)throw new rs("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let _=!1;try{try{for(var x=!0,A=Rs(GF(e,t)),E;E=yield Pe(A.next()),d=E.done,!d;x=!0){v=E.value,x=!1;const R=v;if(!_)if(R.data.startsWith("[DONE]")){_=!0;continue}else try{yield yield Pe(JSON.parse(R.data))}catch(N){throw a.error("Could not parse message into JSON:",R.data),a.error("From chunk:",R.raw),N}}}catch(R){h={error:R}}finally{try{!x&&!d&&(p=A.return)&&(yield Pe(p.call(A)))}finally{if(h)throw h.error}}_=!0}catch(R){if(gw(R))return yield Pe(void 0);throw R}finally{_||t.abort()}})}return new pu(l,t,n)}static fromReadableStream(e,t,n){let s=!1;function a(){return Cs(this,arguments,function*(){var d,h,p,v;const _=new J0,x=VM(e);try{for(var A=!0,E=Rs(x),R;R=yield Pe(E.next()),d=R.done,!d;A=!0){v=R.value,A=!1;const N=v;for(const D of _.decode(N))yield yield Pe(D)}}catch(N){h={error:N}}finally{try{!A&&!d&&(p=E.return)&&(yield Pe(p.call(E)))}finally{if(h)throw h.error}}for(const N of _.flush())yield yield Pe(N)})}function l(){return Cs(this,arguments,function*(){var d,h,p,v;if(s)throw new rs("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let _=!1;try{try{for(var x=!0,A=Rs(a()),E;E=yield Pe(A.next()),d=E.done,!d;x=!0){v=E.value,x=!1;const R=v;_||R&&(yield yield Pe(JSON.parse(R)))}}catch(R){h={error:R}}finally{try{!x&&!d&&(p=A.return)&&(yield Pe(p.call(A)))}finally{if(h)throw h.error}}_=!0}catch(R){if(gw(R))return yield Pe(void 0);throw R}finally{_||t.abort()}})}return new pu(l,t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),s=a=>({next:()=>{if(a.length===0){const l=n.next();e.push(l),t.push(l)}return a.shift()}});return[new pu(()=>s(e),this.controller,this.client),new pu(()=>s(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return qM({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:s,done:a}=await t.next();if(a)return n.close();const l=nx(JSON.stringify(s)+`
`);n.enqueue(l)}catch(s){n.error(s)}},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}}function GF(i,e){return Cs(this,arguments,function*(){var n,s,a,l;if(!i.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new rs("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new rs("Attempted to iterate over a response with no body");const c=new qF,d=new J0,h=VM(i.body);try{for(var p=!0,v=Rs(zF(h)),_;_=yield Pe(v.next()),n=_.done,!n;p=!0){l=_.value,p=!1;const x=l;for(const A of d.decode(x)){const E=c.decode(A);E&&(yield yield Pe(E))}}}catch(x){s={error:x}}finally{try{!p&&!n&&(a=v.return)&&(yield Pe(a.call(v)))}finally{if(s)throw s.error}}for(const x of d.flush()){const A=c.decode(x);A&&(yield yield Pe(A))}})}function zF(i){return Cs(this,arguments,function*(){var t,n,s,a;let l=new Uint8Array;try{for(var c=!0,d=Rs(i),h;h=yield Pe(d.next()),t=h.done,!t;c=!0){a=h.value,c=!1;const p=a;if(p==null)continue;const v=p instanceof ArrayBuffer?new Uint8Array(p):typeof p=="string"?nx(p):p;let _=new Uint8Array(l.length+v.length);_.set(l),_.set(v,l.length),l=_;let x;for(;(x=HF(l))!==-1;)yield yield Pe(l.slice(0,x)),l=l.slice(x)}}catch(p){n={error:p}}finally{try{!c&&!t&&(s=d.return)&&(yield Pe(s.call(d)))}finally{if(n)throw n.error}}l.length>0&&(yield yield Pe(l))})}class qF{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,s]=VF(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function VF(i,e){const t=i.indexOf(e);return t!==-1?[i.substring(0,t),e,i.substring(t+e.length)]:[i,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function $F(i,e){const{response:t,requestLogID:n,retryOfRequestLogID:s,startTime:a}=e,l=await(async()=>{var c;if(e.options.stream)return qn(i).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,i):pu.fromSSEResponse(t,e.controller,i);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const d=t.headers.get("content-type"),h=(c=d==null?void 0:d.split(";")[0])===null||c===void 0?void 0:c.trim();return(h==null?void 0:h.includes("application/json"))||(h==null?void 0:h.endsWith("+json"))?await t.json():await t.text()})();return qn(i).debug(`[${n}] response parsed`,$o({retryOfRequestLogID:s,url:t.url,status:t.status,body:l,durationMs:Date.now()-a})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ix extends Promise{constructor(e,t,n=$F){super(s=>{s(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new ix(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WM=Symbol("brand.privateNullableHeaders");function*jF(i){if(!i)return;if(WM in i){const{values:n,nulls:s}=i;yield*n.entries();for(const a of s)yield[a,null];return}let e=!1,t;i instanceof Headers?t=i.entries():wC(i)?t=i:(e=!0,t=Object.entries(i??{}));for(let n of t){const s=n[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const a=wC(n[1])?n[1]:[n[1]];let l=!1;for(const c of a)c!==void 0&&(e&&!l&&(l=!0,yield[s,null]),yield[s,c])}}const Ih=i=>{const e=new Headers,t=new Set;for(const n of i){const s=new Set;for(const[a,l]of jF(n)){const c=a.toLowerCase();s.has(c)||(e.delete(a),s.add(c)),l===null?(e.delete(a),t.add(c)):(e.append(a,l),t.delete(c))}}return{[WM]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Db=i=>{var e,t,n,s,a,l;if(typeof globalThis.process<"u")return(n=(t=(e=vL)===null||e===void 0?void 0:e[i])===null||t===void 0?void 0:t.trim())!==null&&n!==void 0?n:void 0;if(typeof globalThis.Deno<"u")return(l=(a=(s=globalThis.Deno.env)===null||s===void 0?void 0:s.get)===null||a===void 0?void 0:a.call(s,i))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var QM;class X0{constructor(e){var t,n,s,a,l,c,d,{baseURL:h=Db("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:p=(t=Db("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:v="v1beta"}=e,_=l0(e,["baseURL","apiKey","apiVersion"]);const x=Object.assign(Object.assign({apiKey:p,apiVersion:v},_),{baseURL:h||"https://generativelanguage.googleapis.com"});this.baseURL=x.baseURL,this.timeout=(n=x.timeout)!==null&&n!==void 0?n:X0.DEFAULT_TIMEOUT,this.logger=(s=x.logger)!==null&&s!==void 0?s:console;const A="warn";this.logLevel=A,this.logLevel=(l=(a=TC(x.logLevel,"ClientOptions.logLevel",this))!==null&&a!==void 0?a:TC(Db("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:A,this.fetchOptions=x.fetchOptions,this.maxRetries=(c=x.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(d=x.fetch)!==null&&d!==void 0?d:TF(),this.encoder=NF,this._options=x,this.apiKey=p,this.apiVersion=v,this.clientAdapter=x.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=Ih([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return Ih([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Ih([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new rs(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${uu}`}defaultIdempotencyKey(){return`stainless-node-retry-${hF()}`}makeStatusError(e,t,n,s){return Yn.generate(e,t,n,s)}buildURL(e,t,n){const s=!this.baseURLOverridden()&&n||this.baseURL,a=pF(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return yF(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(a.search=this.stringifyQuery(t)),a.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(s=>Object.assign({method:e,path:t},s)))}request(e,t=null){return new ix(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var s,a,l;const c=await e,d=(s=c.maxRetries)!==null&&s!==void 0?s:this.maxRetries;t==null&&(t=d),await this.prepareOptions(c);const{req:h,url:p,timeout:v}=await this.buildRequest(c,{retryCount:d-t});await this.prepareRequest(h,{url:p,options:c});const _="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),x=n===void 0?"":`, retryOf: ${n}`,A=Date.now();if(qn(this).debug(`[${_}] sending request`,$o({retryOfRequestLogID:n,method:c.method,url:p,options:c,headers:h.headers})),!((a=c.signal)===null||a===void 0)&&a.aborted)throw new yw;const E=new AbortController,R=await this.fetchWithTimeout(p,h,v,E).catch(mw),N=Date.now();if(R instanceof globalThis.Error){const P=`retrying, ${t} attempts remaining`;if(!((l=c.signal)===null||l===void 0)&&l.aborted)throw new yw;const L=gw(R)||/timed? ?out/i.test(String(R)+("cause"in R?String(R.cause):""));if(t)return qn(this).info(`[${_}] connection ${L?"timed out":"failed"} - ${P}`),qn(this).debug(`[${_}] connection ${L?"timed out":"failed"} (${P})`,$o({retryOfRequestLogID:n,url:p,durationMs:N-A,message:R.message})),this.retryRequest(c,t,n??_);throw qn(this).info(`[${_}] connection ${L?"timed out":"failed"} - error; no more retries left`),qn(this).debug(`[${_}] connection ${L?"timed out":"failed"} (error; no more retries left)`,$o({retryOfRequestLogID:n,url:p,durationMs:N-A,message:R.message})),L?new PM:new K0({cause:R})}const D=`[${_}${x}] ${h.method} ${p} ${R.ok?"succeeded":"failed"} with status ${R.status} in ${N-A}ms`;if(!R.ok){const P=await this.shouldRetry(R);if(t&&P){const Y=`retrying, ${t} attempts remaining`;return await RF(R.body),qn(this).info(`${D} - ${Y}`),qn(this).debug(`[${_}] response error (${Y})`,$o({retryOfRequestLogID:n,url:R.url,status:R.status,headers:R.headers,durationMs:N-A})),this.retryRequest(c,t,n??_,R.headers)}const L=P?"error; no more retries left":"error; not retryable";qn(this).info(`${D} - ${L}`);const B=await R.text().catch(Y=>mw(Y).message),H=_F(B),O=H?void 0:B;throw qn(this).debug(`[${_}] response error (${L})`,$o({retryOfRequestLogID:n,url:R.url,status:R.status,headers:R.headers,message:O,durationMs:Date.now()-A})),this.makeStatusError(R.status,H,O,R.headers)}return qn(this).info(D),qn(this).debug(`[${_}] response start`,$o({retryOfRequestLogID:n,url:R.url,status:R.status,headers:R.headers,durationMs:N-A})),{response:R,options:c,controller:E,requestLogID:_,retryOfRequestLogID:n,startTime:A}}async fetchWithTimeout(e,t,n,s){const a=t||{},{signal:l,method:c}=a,d=l0(a,["signal","method"]);l&&l.addEventListener("abort",()=>s.abort());const h=setTimeout(()=>s.abort(),n),p=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,v=Object.assign(Object.assign(Object.assign({signal:s.signal},p?{duplex:"half"}:{}),{method:"GET"}),d);c&&(v.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,v)}finally{clearTimeout(h)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n,s){var a;let l;const c=s==null?void 0:s.get("retry-after-ms");if(c){const h=parseFloat(c);Number.isNaN(h)||(l=h)}const d=s==null?void 0:s.get("retry-after");if(d&&!l){const h=parseFloat(d);Number.isNaN(h)?l=Date.parse(d)-Date.now():l=h*1e3}if(!(l&&0<=l&&l<60*1e3)){const h=(a=e.maxRetries)!==null&&a!==void 0?a:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,h)}return await wF(l),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,l=Math.min(.5*Math.pow(2,a),8),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(e,{retryCount:t=0}={}){var n,s,a;const l=Object.assign({},e),{method:c,path:d,query:h,defaultBaseURL:p}=l,v=this.buildURL(d,h,p);"timeout"in l&&bF("timeout",l.timeout),l.timeout=(n=l.timeout)!==null&&n!==void 0?n:this.timeout;const{bodyHeaders:_,body:x}=this.buildBody({options:l}),A=await this.buildHeaders({options:e,method:c,bodyHeaders:_,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:A},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&x instanceof globalThis.ReadableStream&&{duplex:"half"}),x&&{body:x}),(s=this.fetchOptions)!==null&&s!==void 0?s:{}),(a=l.fetchOptions)!==null&&a!==void 0?a:{}),url:v,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:s}){let a={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let c=Ih([a,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),EF()),this._options.defaultHeaders,n,e.headers,l]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=Ih([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:CF(e)}:this.encoder({body:e,headers:n})}}X0.DEFAULT_TIMEOUT=6e4;class dn extends X0{constructor(){super(...arguments),this.interactions=new XM(this)}}QM=dn;dn.GeminiNextGenAPIClient=QM;dn.GeminiNextGenAPIClientError=rs;dn.APIError=Yn;dn.APIConnectionError=K0;dn.APIConnectionTimeoutError=PM;dn.APIUserAbortError=yw;dn.NotFoundError=FM;dn.ConflictError=HM;dn.RateLimitError=GM;dn.BadRequestError=LM;dn.AuthenticationError=OM;dn.InternalServerError=zM;dn.PermissionDeniedError=UM;dn.UnprocessableEntityError=BM;dn.toFile=PF;dn.Interactions=XM;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YF(i,e){const t={},n=m(i,["name"]);return n!=null&&y(t,["_url","name"],n),t}function KF(i,e){const t={},n=m(i,["name"]);return n!=null&&y(t,["_url","name"],n),t}function JF(i,e){const t={},n=m(i,["sdkHttpResponse"]);return n!=null&&y(t,["sdkHttpResponse"],n),t}function XF(i,e){const t={},n=m(i,["sdkHttpResponse"]);return n!=null&&y(t,["sdkHttpResponse"],n),t}function WF(i,e,t){const n={};if(m(i,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=m(i,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&y(e,["displayName"],s),m(i,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=m(i,["epochCount"]);e!==void 0&&a!=null&&y(e,["tuningTask","hyperparameters","epochCount"],a);const l=m(i,["learningRateMultiplier"]);if(l!=null&&y(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),m(i,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(m(i,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(m(i,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=m(i,["batchSize"]);e!==void 0&&c!=null&&y(e,["tuningTask","hyperparameters","batchSize"],c);const d=m(i,["learningRate"]);if(e!==void 0&&d!=null&&y(e,["tuningTask","hyperparameters","learningRate"],d),m(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(m(i,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function QF(i,e,t){const n={};let s=m(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const x=m(i,["validationDataset"]);e!==void 0&&x!=null&&y(e,["supervisedTuningSpec"],RC(x))}else if(s==="PREFERENCE_TUNING"){const x=m(i,["validationDataset"]);e!==void 0&&x!=null&&y(e,["preferenceOptimizationSpec"],RC(x))}const a=m(i,["tunedModelDisplayName"]);e!==void 0&&a!=null&&y(e,["tunedModelDisplayName"],a);const l=m(i,["description"]);e!==void 0&&l!=null&&y(e,["description"],l);let c=m(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const x=m(i,["epochCount"]);e!==void 0&&x!=null&&y(e,["supervisedTuningSpec","hyperParameters","epochCount"],x)}else if(c==="PREFERENCE_TUNING"){const x=m(i,["epochCount"]);e!==void 0&&x!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],x)}let d=m(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const x=m(i,["learningRateMultiplier"]);e!==void 0&&x!=null&&y(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],x)}else if(d==="PREFERENCE_TUNING"){const x=m(i,["learningRateMultiplier"]);e!==void 0&&x!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],x)}let h=m(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const x=m(i,["exportLastCheckpointOnly"]);e!==void 0&&x!=null&&y(e,["supervisedTuningSpec","exportLastCheckpointOnly"],x)}else if(h==="PREFERENCE_TUNING"){const x=m(i,["exportLastCheckpointOnly"]);e!==void 0&&x!=null&&y(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],x)}let p=m(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const x=m(i,["adapterSize"]);e!==void 0&&x!=null&&y(e,["supervisedTuningSpec","hyperParameters","adapterSize"],x)}else if(p==="PREFERENCE_TUNING"){const x=m(i,["adapterSize"]);e!==void 0&&x!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],x)}if(m(i,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(m(i,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const v=m(i,["labels"]);e!==void 0&&v!=null&&y(e,["labels"],v);const _=m(i,["beta"]);return e!==void 0&&_!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","beta"],_),n}function ZF(i,e){const t={},n=m(i,["baseModel"]);n!=null&&y(t,["baseModel"],n);const s=m(i,["preTunedModel"]);s!=null&&y(t,["preTunedModel"],s);const a=m(i,["trainingDataset"]);a!=null&&uH(a);const l=m(i,["config"]);return l!=null&&WF(l,t),t}function eH(i,e){const t={},n=m(i,["baseModel"]);n!=null&&y(t,["baseModel"],n);const s=m(i,["preTunedModel"]);s!=null&&y(t,["preTunedModel"],s);const a=m(i,["trainingDataset"]);a!=null&&dH(a,t,e);const l=m(i,["config"]);return l!=null&&QF(l,t,e),t}function tH(i,e){const t={},n=m(i,["name"]);return n!=null&&y(t,["_url","name"],n),t}function nH(i,e){const t={},n=m(i,["name"]);return n!=null&&y(t,["_url","name"],n),t}function iH(i,e,t){const n={},s=m(i,["pageSize"]);e!==void 0&&s!=null&&y(e,["_query","pageSize"],s);const a=m(i,["pageToken"]);e!==void 0&&a!=null&&y(e,["_query","pageToken"],a);const l=m(i,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),n}function sH(i,e,t){const n={},s=m(i,["pageSize"]);e!==void 0&&s!=null&&y(e,["_query","pageSize"],s);const a=m(i,["pageToken"]);e!==void 0&&a!=null&&y(e,["_query","pageToken"],a);const l=m(i,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),n}function rH(i,e){const t={},n=m(i,["config"]);return n!=null&&iH(n,t),t}function aH(i,e){const t={},n=m(i,["config"]);return n!=null&&sH(n,t),t}function oH(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&y(t,["sdkHttpResponse"],n);const s=m(i,["nextPageToken"]);s!=null&&y(t,["nextPageToken"],s);const a=m(i,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>ZM(c))),y(t,["tuningJobs"],l)}return t}function lH(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&y(t,["sdkHttpResponse"],n);const s=m(i,["nextPageToken"]);s!=null&&y(t,["nextPageToken"],s);const a=m(i,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>_w(c))),y(t,["tuningJobs"],l)}return t}function cH(i,e){const t={},n=m(i,["name"]);n!=null&&y(t,["model"],n);const s=m(i,["name"]);return s!=null&&y(t,["endpoint"],s),t}function uH(i,e){const t={};if(m(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(i,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=m(i,["examples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>a)),y(t,["examples","examples"],s)}return t}function dH(i,e,t){const n={};let s=m(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=m(i,["gcsUri"]);e!==void 0&&l!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=m(i,["gcsUri"]);e!==void 0&&l!=null&&y(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let a=m(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=m(i,["vertexDatasetResource"]);e!==void 0&&l!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=m(i,["vertexDatasetResource"]);e!==void 0&&l!=null&&y(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(m(i,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function ZM(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&y(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&y(t,["name"],s);const a=m(i,["state"]);a!=null&&y(t,["state"],gM(a));const l=m(i,["createTime"]);l!=null&&y(t,["createTime"],l);const c=m(i,["tuningTask","startTime"]);c!=null&&y(t,["startTime"],c);const d=m(i,["tuningTask","completeTime"]);d!=null&&y(t,["endTime"],d);const h=m(i,["updateTime"]);h!=null&&y(t,["updateTime"],h);const p=m(i,["description"]);p!=null&&y(t,["description"],p);const v=m(i,["baseModel"]);v!=null&&y(t,["baseModel"],v);const _=m(i,["_self"]);return _!=null&&y(t,["tunedModel"],cH(_)),t}function _w(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&y(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&y(t,["name"],s);const a=m(i,["state"]);a!=null&&y(t,["state"],gM(a));const l=m(i,["createTime"]);l!=null&&y(t,["createTime"],l);const c=m(i,["startTime"]);c!=null&&y(t,["startTime"],c);const d=m(i,["endTime"]);d!=null&&y(t,["endTime"],d);const h=m(i,["updateTime"]);h!=null&&y(t,["updateTime"],h);const p=m(i,["error"]);p!=null&&y(t,["error"],p);const v=m(i,["description"]);v!=null&&y(t,["description"],v);const _=m(i,["baseModel"]);_!=null&&y(t,["baseModel"],_);const x=m(i,["tunedModel"]);x!=null&&y(t,["tunedModel"],x);const A=m(i,["preTunedModel"]);A!=null&&y(t,["preTunedModel"],A);const E=m(i,["supervisedTuningSpec"]);E!=null&&y(t,["supervisedTuningSpec"],E);const R=m(i,["preferenceOptimizationSpec"]);R!=null&&y(t,["preferenceOptimizationSpec"],R);const N=m(i,["tuningDataStats"]);N!=null&&y(t,["tuningDataStats"],N);const D=m(i,["encryptionSpec"]);D!=null&&y(t,["encryptionSpec"],D);const P=m(i,["partnerModelTuningSpec"]);P!=null&&y(t,["partnerModelTuningSpec"],P);const L=m(i,["customBaseModel"]);L!=null&&y(t,["customBaseModel"],L);const B=m(i,["experiment"]);B!=null&&y(t,["experiment"],B);const H=m(i,["labels"]);H!=null&&y(t,["labels"],H);const O=m(i,["outputUri"]);O!=null&&y(t,["outputUri"],O);const X=m(i,["pipelineJob"]);X!=null&&y(t,["pipelineJob"],X);const Y=m(i,["serviceAccount"]);Y!=null&&y(t,["serviceAccount"],Y);const se=m(i,["tunedModelDisplayName"]);se!=null&&y(t,["tunedModelDisplayName"],se);const re=m(i,["veoTuningSpec"]);return re!=null&&y(t,["veoTuningSpec"],re),t}function hH(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&y(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&y(t,["name"],s);const a=m(i,["metadata"]);a!=null&&y(t,["metadata"],a);const l=m(i,["done"]);l!=null&&y(t,["done"],l);const c=m(i,["error"]);return c!=null&&y(t,["error"],c),t}function RC(i,e){const t={},n=m(i,["gcsUri"]);n!=null&&y(t,["validationDatasetUri"],n);const s=m(i,["vertexDatasetResource"]);return s!=null&&y(t,["validationDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fH extends ra{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new oc(na.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var n;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((n=t.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},t),{preTunedModel:s});return a.baseModel=void 0,await this.tuneInternal(a)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),a=await this.tuneMldevInternal(s);let l="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?l=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(l=a.name.split("/operations/")[0]),{name:l,state:lw.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=nH(e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>_w(p))}else{const h=tH(e);return c=ce("{name}",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>ZM(p))}}async listInternal(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=aH(e);return c=ce("tuningJobs",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=lH(p),_=new eC;return Object.assign(_,v),_})}else{const h=rH(e);return c=ce("tunedModels",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=oH(p),_=new eC;return Object.assign(_,v),_})}}async cancel(e){var t,n,s,a;let l,c="",d={};if(this.apiClient.isVertexAI()){const h=KF(e);return c=ce("{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=XF(p),_=new tC;return Object.assign(_,v),_})}else{const h=YF(e);return c=ce("{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(p=>p.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:p.headers},_})),l.then(p=>{const v=JF(p),_=new tC;return Object.assign(_,v),_})}}async tuneInternal(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=eH(e,e);return a=ce("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>_w(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=ZF(e);return a=ce("tunedModels",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>hH(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pH{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const gH=1024*1024*8,mH=3,yH=1e3,vH=2,u0="x-goog-upload-status";async function bH(i,e,t){var n;const s=await ek(i,e,t),a=await(s==null?void 0:s.json());if(((n=s==null?void 0:s.headers)===null||n===void 0?void 0:n[u0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function _H(i,e,t){var n;const s=await ek(i,e,t),a=await(s==null?void 0:s.json());if(((n=s==null?void 0:s.headers)===null||n===void 0?void 0:n[u0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=cM(a),c=new Xw;return Object.assign(c,l),c}async function ek(i,e,t){var n,s;let a=0,l=0,c=new cw(new Response),d="upload";for(a=i.size;l<a;){const h=Math.min(gH,a-l),p=i.slice(l,l+h);l+h>=a&&(d+=", finalize");let v=0,_=yH;for(;v<mH&&(c=await t.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(h)}}}),!(!((n=c==null?void 0:c.headers)===null||n===void 0)&&n[u0]));)v++,await xH(_),_=_*vH;if(l+=h,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[u0])!=="active")break;if(a<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function wH(i){return{size:i.size,type:i.type}}function xH(i){return new Promise(e=>setTimeout(e,i))}class SH{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await bH(e,t,n)}async uploadToFileSearchStore(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await _H(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await wH(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AH{create(e,t,n){return new EH(e,t,n)}}class EH{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const NC="x-goog-api-key";class TH{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(NC)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(NC,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const CH="gl-node/";class RH{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new dn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=xL(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new TH(this.apiKey);this.apiClient=new w3({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:CH+"web",uploader:new SH,downloader:new pH}),this.models=new B3(this.apiClient),this.live=new P3(this.apiClient,s,new AH),this.batches=new WO(this.apiClient),this.chats=new IU(this.models,this.apiClient),this.caches=new NU(this.apiClient),this.files=new zU(this.apiClient),this.operations=new G3(this.apiClient),this.authTokens=new iF(this.apiClient),this.tunings=new fH(this.apiClient),this.fileSearchStores=new dF(this.apiClient)}}const NH=async(i,e)=>{const t="PLACEHOLDER_API_KEY",n=new RH({apiKey:t});try{const s=e.language==="ar"?"   (   )":"English language (All texts and options in English)",a=e.focusTopic?`  : ${e.focusTopic}`:"      .",l=await n.models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:`
          Role: Academic Examination Expert.
          Task: Create a high-quality quiz from the following text.
          
          Rules:
          1. Number of questions: ${e.questionCount}.
          2. Quality: Professional, balanced, and educationally sound.
          3. Format: Valid JSON only.
          4. Language: ${s}.
          5. ${a}

          Source Text (Excerpts):
          ${i.substring(0,25e3)}
          `}]}],config:{responseMimeType:"application/json",responseSchema:{type:Qt.OBJECT,properties:{title:{type:Qt.STRING},questions:{type:Qt.ARRAY,items:{type:Qt.OBJECT,properties:{id:{type:Qt.INTEGER},type:{type:Qt.STRING,enum:["multiple_choice","true_false"]},question:{type:Qt.STRING},options:{type:Qt.ARRAY,items:{type:Qt.STRING}},correctAnswerIndex:{type:Qt.INTEGER},explanation:{type:Qt.STRING}},required:["id","type","question","options","correctAnswerIndex","explanation"]}}},required:["title","questions"]}}}),c=JSON.parse(l.text||"{}");if(!c.questions||c.questions.length===0)throw new Error("EMPTY_RESPONSE");return c}catch(s){throw console.error("Gemini Service Error:",s),s.message==="API_KEY_MISSING"?s:new Error("     .        .")}};function W0(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(t[n[s]]=i[n[s]]);return t}function MH(i,e,t,n){function s(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(p){try{h(n.next(p))}catch(v){l(v)}}function d(p){try{h(n.throw(p))}catch(v){l(v)}}function h(p){p.done?a(p.value):s(p.value).then(c,d)}h((n=n.apply(i,e||[])).next())})}const kH=i=>i?(...e)=>i(...e):(...e)=>fetch(...e);class sx extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class IH extends sx{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class MC extends sx{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class kC extends sx{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ww;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(ww||(ww={}));class DH{constructor(e,{headers:t={},customFetch:n,region:s=ww.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=kH(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return MH(this,arguments,void 0,function*(t,n={}){var s;let a,l;try{const{headers:c,method:d,body:h,signal:p,timeout:v}=n;let _={},{region:x}=n;x||(x=this.region);const A=new URL(`${this.url}/${t}`);x&&x!=="any"&&(_["x-region"]=x,A.searchParams.set("forceFunctionRegion",x));let E;h&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(_["Content-Type"]="application/octet-stream",E=h):typeof h=="string"?(_["Content-Type"]="text/plain",E=h):typeof FormData<"u"&&h instanceof FormData?E=h:(_["Content-Type"]="application/json",E=JSON.stringify(h)):h&&typeof h!="string"&&!(typeof Blob<"u"&&h instanceof Blob)&&!(h instanceof ArrayBuffer)&&!(typeof FormData<"u"&&h instanceof FormData)?E=JSON.stringify(h):E=h;let R=p;v&&(l=new AbortController,a=setTimeout(()=>l.abort(),v),p?(R=l.signal,p.addEventListener("abort",()=>l.abort())):R=l.signal);const N=yield this.fetch(A.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},_),this.headers),c),body:E,signal:R}).catch(B=>{throw new IH(B)}),D=N.headers.get("x-relay-error");if(D&&D==="true")throw new MC(N);if(!N.ok)throw new kC(N);let P=((s=N.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),L;return P==="application/json"?L=yield N.json():P==="application/octet-stream"||P==="application/pdf"?L=yield N.blob():P==="text/event-stream"?L=N:P==="multipart/form-data"?L=yield N.formData():L=yield N.text(),{data:L,error:null,response:N}}catch(c){return{data:null,error:c,response:c instanceof kC||c instanceof MC?c.context:void 0}}finally{a&&clearTimeout(a)}})}}var sn={},jc={},Yc={},Kc={},Jc={},Xc={},PH=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Rd=PH();const LH=Rd.fetch,tk=Rd.fetch.bind(Rd),nk=Rd.Headers,OH=Rd.Request,UH=Rd.Response,FH=Object.freeze(Object.defineProperty({__proto__:null,Headers:nk,Request:OH,Response:UH,default:tk,fetch:LH},Symbol.toStringTag,{value:"Module"})),HH=rD(FH);var fm={},IC;function ik(){if(IC)return fm;IC=1,Object.defineProperty(fm,"__esModule",{value:!0});class i extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return fm.default=i,fm}var DC;function sk(){if(DC)return Xc;DC=1;var i=Xc&&Xc.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Xc,"__esModule",{value:!0});const e=i(HH),t=i(ik());class n{constructor(a){var l,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(l=a.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=a.signal,this.isMaybeSingle=(c=a.isMaybeSingle)!==null&&c!==void 0?c:!1,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=new Headers(this.headers),this.headers.set(a,l),this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var p,v,_,x;let A=null,E=null,R=null,N=h.status,D=h.statusText;if(h.ok){if(this.method!=="HEAD"){const H=await h.text();H===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?E=H:E=JSON.parse(H))}const L=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),B=(_=h.headers.get("content-range"))===null||_===void 0?void 0:_.split("/");L&&B&&B.length>1&&(R=parseInt(B[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(A={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,R=null,N=406,D="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const L=await h.text();try{A=JSON.parse(L),Array.isArray(A)&&h.status===404&&(E=[],A=null,N=200,D="OK")}catch{h.status===404&&L===""?(N=204,D="No Content"):A={message:L}}if(A&&this.isMaybeSingle&&(!((x=A==null?void 0:A.details)===null||x===void 0)&&x.includes("0 rows"))&&(A=null,N=200,D="OK"),A&&this.shouldThrowOnError)throw new t.default(A)}return{error:A,data:E,count:R,status:N,statusText:D}});return this.shouldThrowOnError||(d=d.catch(h=>{var p,v,_;return{error:{message:`${(p=h==null?void 0:h.name)!==null&&p!==void 0?p:"FetchError"}: ${h==null?void 0:h.message}`,details:`${(v=h==null?void 0:h.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(_=h==null?void 0:h.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),d.then(a,l)}returns(){return this}overrideTypes(){return this}}return Xc.default=n,Xc}var PC;function rk(){if(PC)return Jc;PC=1;var i=Jc&&Jc.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Jc,"__esModule",{value:!0});const e=i(sk());class t extends e.default{select(s){let a=!1;const l=(s??"*").split("").map(c=>/\s/.test(c)&&!a?"":(c==='"'&&(a=!a),c)).join("");return this.url.searchParams.set("select",l),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:a=!0,nullsFirst:l,foreignTable:c,referencedTable:d=c}={}){const h=d?`${d}.order`:"order",p=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${p?`${p},`:""}${s}.${a?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:a,referencedTable:l=a}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${s}`),this}range(s,a,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"offset":`${c}.offset`,h=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${s}`),this.url.searchParams.set(h,`${a-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:a=!1,settings:l=!1,buffers:c=!1,wal:d=!1,format:h="text"}={}){var p;const v=[s?"analyze":null,a?"verbose":null,l?"settings":null,c?"buffers":null,d?"wal":null].filter(Boolean).join("|"),_=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${_}"; options=${v};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Jc.default=t,Jc}var LC;function rx(){if(LC)return Kc;LC=1;var i=Kc&&Kc.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Kc,"__esModule",{value:!0});const e=i(rk());class t extends e.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}in(s,a){const l=Array.from(new Set(a)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(s,`in.(${l})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const h=l===void 0?"":`(${l})`;return this.url.searchParams.append(s,`${d}fts${h}.${a}`),this}match(s){return Object.entries(s).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(s,a,l){return this.url.searchParams.append(s,`not.${a}.${l}`),this}or(s,{foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${s})`),this}filter(s,a,l){return this.url.searchParams.append(s,`${a}.${l}`),this}}return Kc.default=t,Kc}var OC;function ak(){if(OC)return Yc;OC=1;var i=Yc&&Yc.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Yc,"__esModule",{value:!0});const e=i(rx());class t{constructor(s,{headers:a={},schema:l,fetch:c}){this.url=s,this.headers=new Headers(a),this.schema=l,this.fetch=c}select(s,{head:a=!1,count:l}={}){const c=a?"HEAD":"GET";let d=!1;const h=(s??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",h),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:a,defaultToNull:l=!0}={}){var c;const d="POST";if(a&&this.headers.append("Prefer",`count=${a}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const h=s.reduce((p,v)=>p.concat(Object.keys(v)),[]);if(h.length>0){const p=[...new Set(h)].map(v=>`"${v}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}upsert(s,{onConflict:a,ignoreDuplicates:l=!1,count:c,defaultToNull:d=!0}={}){var h;const p="POST";if(this.headers.append("Prefer",`resolution=${l?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),c&&this.headers.append("Prefer",`count=${c}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const v=s.reduce((_,x)=>_.concat(Object.keys(x)),[]);if(v.length>0){const _=[...new Set(v)].map(x=>`"${x}"`);this.url.searchParams.set("columns",_.join(","))}}return new e.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}update(s,{count:a}={}){var l;const c="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}delete({count:s}={}){var a;const l="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return Yc.default=t,Yc}var UC;function BH(){if(UC)return jc;UC=1;var i=jc&&jc.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(jc,"__esModule",{value:!0});const e=i(ak()),t=i(rx());class n{constructor(a,{headers:l={},schema:c,fetch:d}={}){this.url=a,this.headers=new Headers(l),this.schemaName=c,this.fetch=d}from(a){const l=new URL(`${this.url}/${a}`);return new e.default(l,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new n(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,l={},{head:c=!1,get:d=!1,count:h}={}){var p;let v;const _=new URL(`${this.url}/rpc/${a}`);let x;c||d?(v=c?"HEAD":"GET",Object.entries(l).filter(([E,R])=>R!==void 0).map(([E,R])=>[E,Array.isArray(R)?`{${R.join(",")}}`:`${R}`]).forEach(([E,R])=>{_.searchParams.append(E,R)})):(v="POST",x=l);const A=new Headers(this.headers);return h&&A.set("Prefer",`count=${h}`),new t.default({method:v,url:_,headers:A,schema:this.schemaName,body:x,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return jc.default=n,jc}var FC;function GH(){if(FC)return sn;FC=1;var i=sn&&sn.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(sn,"__esModule",{value:!0}),sn.PostgrestError=sn.PostgrestBuilder=sn.PostgrestTransformBuilder=sn.PostgrestFilterBuilder=sn.PostgrestQueryBuilder=sn.PostgrestClient=void 0;const e=i(BH());sn.PostgrestClient=e.default;const t=i(ak());sn.PostgrestQueryBuilder=t.default;const n=i(rx());sn.PostgrestFilterBuilder=n.default;const s=i(rk());sn.PostgrestTransformBuilder=s.default;const a=i(sk());sn.PostgrestBuilder=a.default;const l=i(ik());return sn.PostgrestError=l.default,sn.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:a.default,PostgrestError:l.default},sn}var zH=GH();const qH=Ow(zH),{PostgrestClient:VH,PostgrestQueryBuilder:Mq,PostgrestFilterBuilder:kq,PostgrestTransformBuilder:Iq,PostgrestBuilder:Dq,PostgrestError:Pq}=qH;class $H{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const n=t.versions;if(n&&n.node){const s=n.node,a=parseInt(s.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const jH="2.90.1",YH=`realtime-js/${jH}`,ok="1.0.0",KH="2.0.0",HC=ok,xw=1e4,JH=1e3,XH=100;var Pa;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(Pa||(Pa={}));var Kt;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(Kt||(Kt={}));var Es;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(Es||(Es={}));var Sw;(function(i){i.websocket="websocket"})(Sw||(Sw={}));var Yo;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Yo||(Yo={}));class WH{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,n;const s=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,n;const s=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(e,t,n){var s,a;const l=e.topic,c=(s=e.ref)!==null&&s!==void 0?s:"",d=(a=e.join_ref)!==null&&a!==void 0?a:"",h=e.payload.event,p=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},v=Object.keys(p).length===0?"":JSON.stringify(p);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`metadata length ${v.length} exceeds maximum of 255`);const _=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+c.length+l.length+h.length+v.length,x=new ArrayBuffer(this.HEADER_LENGTH+_);let A=new DataView(x),E=0;A.setUint8(E++,this.KINDS.userBroadcastPush),A.setUint8(E++,d.length),A.setUint8(E++,c.length),A.setUint8(E++,l.length),A.setUint8(E++,h.length),A.setUint8(E++,v.length),A.setUint8(E++,t),Array.from(d,N=>A.setUint8(E++,N.charCodeAt(0))),Array.from(c,N=>A.setUint8(E++,N.charCodeAt(0))),Array.from(l,N=>A.setUint8(E++,N.charCodeAt(0))),Array.from(h,N=>A.setUint8(E++,N.charCodeAt(0))),Array.from(v,N=>A.setUint8(E++,N.charCodeAt(0)));var R=new Uint8Array(x.byteLength+n.byteLength);return R.set(new Uint8Array(x),0),R.set(new Uint8Array(n),x.byteLength),R.buffer}decode(e,t){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return t(n)}if(typeof e=="string"){const n=JSON.parse(e),[s,a,l,c,d]=n;return t({join_ref:s,ref:a,topic:l,event:c,payload:d})}return t({})}_binaryDecode(e){const t=new DataView(e),n=t.getUint8(0),s=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,s)}}_decodeUserBroadcast(e,t,n){const s=t.getUint8(1),a=t.getUint8(2),l=t.getUint8(3),c=t.getUint8(4);let d=this.HEADER_LENGTH+4;const h=n.decode(e.slice(d,d+s));d=d+s;const p=n.decode(e.slice(d,d+a));d=d+a;const v=n.decode(e.slice(d,d+l));d=d+l;const _=e.slice(d,e.byteLength),x=c===this.JSON_ENCODING?JSON.parse(n.decode(_)):_,A={type:this.BROADCAST_EVENT,event:p,payload:x};return l>0&&(A.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:A}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([n])=>t.includes(n)))}}class lk{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var gt;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(gt||(gt={}));const BC=(i,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((a,l)=>(a[l]=QH(l,i,e,s),a),{}):{}},QH=(i,e,t,n)=>{const s=e.find(c=>c.name===i),a=s==null?void 0:s.type,l=t[i];return a&&!n.includes(a)?ck(a,l):Aw(l)},ck=(i,e)=>{if(i.charAt(0)==="_"){const t=i.slice(1,i.length);return nB(e,t)}switch(i){case gt.bool:return ZH(e);case gt.float4:case gt.float8:case gt.int2:case gt.int4:case gt.int8:case gt.numeric:case gt.oid:return eB(e);case gt.json:case gt.jsonb:return tB(e);case gt.timestamp:return iB(e);case gt.abstime:case gt.date:case gt.daterange:case gt.int4range:case gt.int8range:case gt.money:case gt.reltime:case gt.text:case gt.time:case gt.timestamptz:case gt.timetz:case gt.tsrange:case gt.tstzrange:return Aw(e);default:return Aw(e)}},Aw=i=>i,ZH=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},eB=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},tB=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch{return i}return i},nB=(i,e)=>{if(typeof i!="string")return i;const t=i.length-1,n=i[t];if(i[0]==="{"&&n==="}"){let a;const l=i.slice(1,t);try{a=JSON.parse("["+l+"]")}catch{a=l?l.split(","):[]}return a.map(c=>ck(e,c))}return i},iB=i=>typeof i=="string"?i.replace(" ","T"):i,uk=i=>{const e=new URL(i);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Pb{constructor(e,t,n={},s=xw){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var GC;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(GC||(GC={}));class Qh{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Qh.syncState(this.state,s,a,l),this.pendingDiffs.forEach(d=>{this.state=Qh.syncDiff(this.state,d,a,l)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Qh.syncDiff(this.state,s,a,l),c())}),this.onJoin((s,a,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:l})}),this.onLeave((s,a,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const a=this.cloneDeep(e),l=this.transformState(t),c={},d={};return this.map(a,(h,p)=>{l[h]||(d[h]=p)}),this.map(l,(h,p)=>{const v=a[h];if(v){const _=p.map(R=>R.presence_ref),x=v.map(R=>R.presence_ref),A=p.filter(R=>x.indexOf(R.presence_ref)<0),E=v.filter(R=>_.indexOf(R.presence_ref)<0);A.length>0&&(c[h]=A),E.length>0&&(d[h]=E)}else c[h]=p}),this.syncDiff(a,{joins:c,leaves:d},n,s)}static syncDiff(e,t,n,s){const{joins:a,leaves:l}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(c,d)=>{var h;const p=(h=e[c])!==null&&h!==void 0?h:[];if(e[c]=this.cloneDeep(d),p.length>0){const v=e[c].map(x=>x.presence_ref),_=p.filter(x=>v.indexOf(x.presence_ref)<0);e[c].unshift(..._)}n(c,p,d)}),this.map(l,(c,d)=>{let h=e[c];if(!h)return;const p=d.map(v=>v.presence_ref);h=h.filter(v=>p.indexOf(v.presence_ref)<0),e[c]=h,s(c,h,d),h.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var zC;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(zC||(zC={}));var Zh;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(Zh||(Zh={}));var Er;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Er||(Er={}));class gu{constructor(e,t={config:{}},n){var s,a;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Kt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Pb(this,Es.join,this.params,this.timeout),this.rejoinTimer=new lk(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Kt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Kt.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Kt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Es.reply,{},(l,c)=>{this._trigger(this._replyEventName(c),l)}),this.presence=new Qh(this),this.broadcastEndpointURL=uk(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Kt.closed){const{config:{broadcast:l,presence:c,private:d}}=this.params,h=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(x=>x.filter))!==null&&s!==void 0?s:[],p=!!this.bindings[Zh.PRESENCE]&&this.bindings[Zh.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,v={},_={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:p}),postgres_changes:h,private:d};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(x=>e==null?void 0:e(Er.CHANNEL_ERROR,x)),this._onClose(()=>e==null?void 0:e(Er.CLOSED)),this.updateJoinPayload(Object.assign({config:_},v)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:x})=>{var A;if(this.socket._isManualToken()||this.socket.setAuth(),x===void 0){e==null||e(Er.SUBSCRIBED);return}else{const E=this.bindings.postgres_changes,R=(A=E==null?void 0:E.length)!==null&&A!==void 0?A:0,N=[];for(let D=0;D<R;D++){const P=E[D],{filter:{event:L,schema:B,table:H,filter:O}}=P,X=x&&x[D];if(X&&X.event===L&&gu.isFilterValueEqual(X.schema,B)&&gu.isFilterValueEqual(X.table,H)&&gu.isFilterValueEqual(X.filter,O))N.push(Object.assign(Object.assign({},P),{id:X.id}));else{this.unsubscribe(),this.state=Kt.errored,e==null||e(Er.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=N,e&&e(Er.SUBSCRIBED);return}}).receive("error",x=>{this.state=Kt.errored,e==null||e(Er.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Er.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===Kt.joined&&e===Zh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,n)}async httpSend(e,t,n={}){var s;if(t==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(c.status===202)return{success:!0};let d=c.statusText;try{const h=await c.json();d=h.error||h.message||d}catch{}return Promise.reject(new Error(d))}async send(e,t={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:l}=e,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:l,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=h.body)===null||s===void 0?void 0:s.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var l,c,d;const h=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),h.receive("ok",()=>a("ok")),h.receive("error",()=>a("error")),h.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Kt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Es.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Pb(this,Es.leave,{},e),n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Kt.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),l=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),l}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Pb(this,e,t,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>XH){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,a;const l=e.toLocaleLowerCase(),{close:c,error:d,leave:h,join:p}=Es;if(n&&[c,d,h,p].indexOf(l)>=0&&n!==this._joinRef())return;let _=this._onMessage(l,t,n);if(t&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(x=>{var A,E,R;return((A=x.filter)===null||A===void 0?void 0:A.event)==="*"||((R=(E=x.filter)===null||E===void 0?void 0:E.event)===null||R===void 0?void 0:R.toLocaleLowerCase())===l}).map(x=>x.callback(_,n)):(a=this.bindings[l])===null||a===void 0||a.filter(x=>{var A,E,R,N,D,P,L,B;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in x){const H=x.id,O=(A=x.filter)===null||A===void 0?void 0:A.event;return H&&((E=t.ids)===null||E===void 0?void 0:E.includes(H))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((R=t.data)===null||R===void 0?void 0:R.type.toLocaleLowerCase()))&&(!(!((N=x.filter)===null||N===void 0)&&N.table)||x.filter.table===((D=t.data)===null||D===void 0?void 0:D.table))}else{const H=(L=(P=x==null?void 0:x.filter)===null||P===void 0?void 0:P.event)===null||L===void 0?void 0:L.toLocaleLowerCase();return H==="*"||H===((B=t==null?void 0:t.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===l}).map(x=>{if(typeof _=="object"&&"ids"in _){const A=_.data,{schema:E,table:R,commit_timestamp:N,type:D,errors:P}=A;_=Object.assign(Object.assign({},{schema:E,table:R,commit_timestamp:N,eventType:D,new:{},old:{},errors:P}),this._getPayloadRecords(A))}x.callback(_,n)})}_isClosed(){return this.state===Kt.closed}_isJoined(){return this.state===Kt.joined}_isJoining(){return this.state===Kt.joining}_isLeaving(){return this.state===Kt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&gu.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Es.close,{},e)}_onError(e){this._on(Es.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Kt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=BC(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=BC(e.columns,e.old_record)),t}}const Lb=()=>{},pm={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},sB=[1e3,2e3,5e3,1e4],rB=1e4,aB=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class oB{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xw,this.transport=null,this.heartbeatIntervalMs=pm.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Lb,this.ref=0,this.reconnectTimer=null,this.vsn=HC,this.logger=Lb,this.conn=null,this.sendBuffer=[],this.serializer=new WH,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((n=t==null?void 0:t.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Sw.websocket}`,this.httpEndpoint=uk(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=$H.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Pa.connecting:return Yo.Connecting;case Pa.open:return Yo.Open;case Pa.closing:return Yo.Closing;default:return Yo.Closed}}isConnected(){return this.connectionState()===Yo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new gu(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:n,payload:s,ref:a}=e,l=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${t} ${n} (${a})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(JH,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},pm.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const h=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",h)}catch(p){this.log("error","error in heartbeat callback",p)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:s,payload:a,ref:l}=t,c=l?`(${l})`:"",d=a.status||"";this.log("receive",`${d} ${n} ${s} ${c}`.trim(),a),this.channels.filter(h=>h._isMember(n)).forEach(h=>h._trigger(s,a,l)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Pa.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Pa.open||this.conn.readyState===Pa.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Es.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([aB],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,n=!1;if(e)t=e,n=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),t=this.accessTokenValue}else t=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const a={access_token:t,version:YH};t&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(Es.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new lk(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},pm.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,s,a,l,c,d,h,p,v,_,x;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:xw,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:pm.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(l=e==null?void 0:e.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(c=e==null?void 0:e.heartbeatCallback)!==null&&c!==void 0?c:Lb,this.vsn=(d=e==null?void 0:e.vsn)!==null&&d!==void 0?d:HC,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e==null?void 0:e.reconnectAfterMs)!==null&&h!==void 0?h:(A=>sB[A-1]||rB),this.vsn){case ok:this.encode=(p=e==null?void 0:e.encode)!==null&&p!==void 0?p:((A,E)=>E(JSON.stringify(A))),this.decode=(v=e==null?void 0:e.decode)!==null&&v!==void 0?v:((A,E)=>E(JSON.parse(A)));break;case KH:this.encode=(_=e==null?void 0:e.encode)!==null&&_!==void 0?_:this.serializer.encode.bind(this.serializer),this.decode=(x=e==null?void 0:e.decode)!==null&&x!==void 0?x:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var rf=class extends Error{constructor(i,e){var t;super(i),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function lB(i,e,t){const n=new URL(e,i);if(t)for(const[s,a]of Object.entries(t))a!==void 0&&n.searchParams.set(s,a);return n.toString()}async function cB(i){return!i||i.type==="none"?{}:i.type==="bearer"?{Authorization:`Bearer ${i.token}`}:i.type==="header"?{[i.name]:i.value}:i.type==="custom"?await i.getHeaders():{}}function uB(i){const e=i.fetchImpl??globalThis.fetch;return{async request({method:t,path:n,query:s,body:a,headers:l}){const c=lB(i.baseUrl,n,s),d=await cB(i.auth),h=await e(c,{method:t,headers:{...a?{"Content-Type":"application/json"}:{},...d,...l},body:a?JSON.stringify(a):void 0}),p=await h.text(),v=(h.headers.get("content-type")||"").includes("application/json"),_=v&&p?JSON.parse(p):p;if(!h.ok){const x=v?_:void 0,A=x==null?void 0:x.error;throw new rf((A==null?void 0:A.message)??`Request failed with status ${h.status}`,{status:h.status,icebergType:A==null?void 0:A.type,icebergCode:A==null?void 0:A.code,details:x})}return{status:h.status,headers:h.headers,data:_}}}}function gm(i){return i.join("")}var dB=class{constructor(i,e=""){this.client=i,this.prefix=e}async listNamespaces(i){const e=i?{parent:gm(i.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(i,e){const t={namespace:i.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(i){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${gm(i.namespace)}`})}async loadNamespaceMetadata(i){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${gm(i.namespace)}`})).data.properties}}async namespaceExists(i){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${gm(i.namespace)}`}),!0}catch(e){if(e instanceof rf&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(i,e){try{return await this.createNamespace(i,e)}catch(t){if(t instanceof rf&&t.status===409)return;throw t}}};function Wc(i){return i.join("")}var hB=class{constructor(i,e="",t){this.client=i,this.prefix=e,this.accessDelegation=t}async listTables(i){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Wc(i.namespace)}/tables`})).data.identifiers}async createTable(i,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Wc(i.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(i,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Wc(i.namespace)}/tables/${i.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(i,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Wc(i.namespace)}/tables/${i.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(i){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Wc(i.namespace)}/tables/${i.name}`,headers:e})).data.metadata}async tableExists(i){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Wc(i.namespace)}/tables/${i.name}`,headers:e}),!0}catch(t){if(t instanceof rf&&t.status===404)return!1;throw t}}async createTableIfNotExists(i,e){try{return await this.createTable(i,e)}catch(t){if(t instanceof rf&&t.status===409)return await this.loadTable({namespace:i.namespace,name:e.name});throw t}}},fB=class{constructor(i){var n;let e="v1";i.catalogName&&(e+=`/${i.catalogName}`);const t=i.baseUrl.endsWith("/")?i.baseUrl:`${i.baseUrl}/`;this.client=uB({baseUrl:t,auth:i.auth,fetchImpl:i.fetch}),this.accessDelegation=(n=i.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new dB(this.client,e),this.tableOps=new hB(this.client,e,this.accessDelegation)}async listNamespaces(i){return this.namespaceOps.listNamespaces(i)}async createNamespace(i,e){return this.namespaceOps.createNamespace(i,e)}async dropNamespace(i){await this.namespaceOps.dropNamespace(i)}async loadNamespaceMetadata(i){return this.namespaceOps.loadNamespaceMetadata(i)}async listTables(i){return this.tableOps.listTables(i)}async createTable(i,e){return this.tableOps.createTable(i,e)}async updateTable(i,e){return this.tableOps.updateTable(i,e)}async dropTable(i,e){await this.tableOps.dropTable(i,e)}async loadTable(i){return this.tableOps.loadTable(i)}async namespaceExists(i){return this.namespaceOps.namespaceExists(i)}async tableExists(i){return this.tableOps.tableExists(i)}async createNamespaceIfNotExists(i,e){return this.namespaceOps.createNamespaceIfNotExists(i,e)}async createTableIfNotExists(i,e){return this.tableOps.createTableIfNotExists(i,e)}},Q0=class extends Error{constructor(i){super(i),this.__isStorageError=!0,this.name="StorageError"}};function Ct(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}var pB=class extends Q0{constructor(i,e,t){super(i),this.name="StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Ew=class extends Q0{constructor(i,e){super(i),this.name="StorageUnknownError",this.originalError=e}};const ax=i=>i?(...e)=>i(...e):(...e)=>fetch(...e),gB=()=>Response,Tw=i=>{if(Array.isArray(i))return i.map(t=>Tw(t));if(typeof i=="function"||i!==Object(i))return i;const e={};return Object.entries(i).forEach(([t,n])=>{const s=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[s]=Tw(n)}),e},mB=i=>{if(typeof i!="object"||i===null)return!1;const e=Object.getPrototypeOf(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},yB=i=>!i||typeof i!="string"||i.length===0||i.length>100||i.trim()!==i||i.includes("/")||i.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(i);function af(i){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},af(i)}function vB(i,e){if(af(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(af(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function bB(i){var e=vB(i,"string");return af(e)=="symbol"?e:e+""}function _B(i,e,t){return(e=bB(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function qC(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,n)}return t}function ke(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qC(Object(t),!0).forEach(function(n){_B(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):qC(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}const Ob=i=>{var e;return i.msg||i.message||i.error_description||(typeof i.error=="string"?i.error:(e=i.error)===null||e===void 0?void 0:e.message)||JSON.stringify(i)},wB=async(i,e,t)=>{i instanceof await gB()&&!(t!=null&&t.noResolveJson)?i.json().then(n=>{const s=i.status||500,a=(n==null?void 0:n.statusCode)||s+"";e(new pB(Ob(n),s,a))}).catch(n=>{e(new Ew(Ob(n),n))}):e(new Ew(Ob(i),i))},xB=(i,e,t,n)=>{const s={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"||!n?s:(mB(n)?(s.headers=ke({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,e!=null&&e.duplex&&(s.duplex=e.duplex),ke(ke({},s),t))};async function Fp(i,e,t,n,s,a){return new Promise((l,c)=>{i(t,xB(e,n,s,a)).then(d=>{if(!d.ok)throw d;return n!=null&&n.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>wB(d,c,n))})}async function of(i,e,t,n){return Fp(i,"GET",e,t,n)}async function hs(i,e,t,n,s){return Fp(i,"POST",e,n,s,t)}async function Cw(i,e,t,n,s){return Fp(i,"PUT",e,n,s,t)}async function SB(i,e,t,n){return Fp(i,"HEAD",e,ke(ke({},t),{},{noResolveJson:!0}),n)}async function ox(i,e,t,n,s){return Fp(i,"DELETE",e,n,s,t)}var AB=class{constructor(i,e){this.downloadFn=i,this.shouldThrowOnError=e}then(i,e){return this.execute().then(i,e)}async execute(){var i=this;try{return{data:(await i.downloadFn()).body,error:null}}catch(e){if(i.shouldThrowOnError)throw e;if(Ct(e))return{data:null,error:e};throw e}}};let dk;dk=Symbol.toStringTag;var EB=class{constructor(i,e){this.downloadFn=i,this.shouldThrowOnError=e,this[dk]="BlobDownloadBuilder",this.promise=null}asStream(){return new AB(this.downloadFn,this.shouldThrowOnError)}then(i,e){return this.getPromise().then(i,e)}catch(i){return this.getPromise().catch(i)}finally(i){return this.getPromise().finally(i)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var i=this;try{return{data:await(await i.downloadFn()).blob(),error:null}}catch(e){if(i.shouldThrowOnError)throw e;if(Ct(e))return{data:null,error:e};throw e}}};const TB={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},VC={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var CB=class{constructor(i,e={},t,n){this.shouldThrowOnError=!1,this.url=i,this.headers=e,this.bucketId=t,this.fetch=ax(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(i,e,t,n){var s=this;try{let a;const l=ke(ke({},VC),n);let c=ke(ke({},s.headers),i==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&t instanceof Blob?(a=new FormData,a.append("cacheControl",l.cacheControl),d&&a.append("metadata",s.encodeMetadata(d)),a.append("",t)):typeof FormData<"u"&&t instanceof FormData?(a=t,a.has("cacheControl")||a.append("cacheControl",l.cacheControl),d&&!a.has("metadata")&&a.append("metadata",s.encodeMetadata(d))):(a=t,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=s.toBase64(s.encodeMetadata(d))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(c=ke(ke({},c),n.headers));const h=s._removeEmptyFolders(e),p=s._getFinalPath(h),v=await(i=="PUT"?Cw:hs)(s.fetch,`${s.url}/object/${p}`,a,ke({headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{data:{path:h,id:v.Id,fullPath:v.Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Ct(a))return{data:null,error:a};throw a}}async upload(i,e,t){return this.uploadOrUpdate("POST",i,e,t)}async uploadToSignedUrl(i,e,t,n){var s=this;const a=s._removeEmptyFolders(i),l=s._getFinalPath(a),c=new URL(s.url+`/object/upload/sign/${l}`);c.searchParams.set("token",e);try{let d;const h=ke({upsert:VC.upsert},n),p=ke(ke({},s.headers),{"x-upsert":String(h.upsert)});return typeof Blob<"u"&&t instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",t)):typeof FormData<"u"&&t instanceof FormData?(d=t,d.append("cacheControl",h.cacheControl)):(d=t,p["cache-control"]=`max-age=${h.cacheControl}`,p["content-type"]=h.contentType),{data:{path:a,fullPath:(await Cw(s.fetch,c.toString(),d,{headers:p})).Key},error:null}}catch(d){if(s.shouldThrowOnError)throw d;if(Ct(d))return{data:null,error:d};throw d}}async createSignedUploadUrl(i,e){var t=this;try{let n=t._getFinalPath(i);const s=ke({},t.headers);e!=null&&e.upsert&&(s["x-upsert"]="true");const a=await hs(t.fetch,`${t.url}/object/upload/sign/${n}`,{},{headers:s}),l=new URL(t.url+a.url),c=l.searchParams.get("token");if(!c)throw new Q0("No token returned by API");return{data:{signedUrl:l.toString(),path:i,token:c},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async update(i,e,t){return this.uploadOrUpdate("PUT",i,e,t)}async move(i,e,t){var n=this;try{return{data:await hs(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:i,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}async copy(i,e,t){var n=this;try{return{data:{path:(await hs(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:i,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:n.headers})).Key},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}async createSignedUrl(i,e,t){var n=this;try{let s=n._getFinalPath(i),a=await hs(n.fetch,`${n.url}/object/sign/${s}`,ke({expiresIn:e},t!=null&&t.transform?{transform:t.transform}:{}),{headers:n.headers});const l=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return a={signedUrl:encodeURI(`${n.url}${a.signedURL}${l}`)},{data:a,error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}async createSignedUrls(i,e,t){var n=this;try{const s=await hs(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:e,paths:i},{headers:n.headers}),a=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:s.map(l=>ke(ke({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${a}`):null})),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}download(i,e){const t=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),s=n?`?${n}`:"",a=this._getFinalPath(i),l=()=>of(this.fetch,`${this.url}/${t}/${a}${s}`,{headers:this.headers,noResolveJson:!0});return new EB(l,this.shouldThrowOnError)}async info(i){var e=this;const t=e._getFinalPath(i);try{return{data:Tw(await of(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async exists(i){var e=this;const t=e._getFinalPath(i);try{return await SB(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ct(n)&&n instanceof Ew){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}}getPublicUrl(i,e){const t=this._getFinalPath(i),n=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&n.push(s);const a=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${t}${c}`)}}}async remove(i){var e=this;try{return{data:await ox(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:i},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}}async list(i,e,t){var n=this;try{const s=ke(ke(ke({},TB),e),{},{prefix:i||""});return{data:await hs(n.fetch,`${n.url}/object/list/${n.bucketId}`,s,{headers:n.headers},t),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}async listV2(i,e){var t=this;try{const n=ke({},i);return{data:await hs(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,n,{headers:t.headers},e),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}encodeMetadata(i){return JSON.stringify(i)}toBase64(i){return typeof Buffer<"u"?Buffer.from(i).toString("base64"):btoa(i)}_getFinalPath(i){return`${this.bucketId}/${i.replace(/^\/+/,"")}`}_removeEmptyFolders(i){return i.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(i){const e=[];return i.width&&e.push(`width=${i.width}`),i.height&&e.push(`height=${i.height}`),i.resize&&e.push(`resize=${i.resize}`),i.format&&e.push(`format=${i.format}`),i.quality&&e.push(`quality=${i.quality}`),e.join("&")}};const hk="2.90.1",fk={"X-Client-Info":`storage-js/${hk}`};var RB=class{constructor(i,e={},t,n){this.shouldThrowOnError=!1;const s=new URL(i);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=ke(ke({},fk),e),this.fetch=ax(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(i){var e=this;try{const t=e.listBucketOptionsToQueryString(i);return{data:await of(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}}async getBucket(i){var e=this;try{return{data:await of(e.fetch,`${e.url}/bucket/${i}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}}async createBucket(i,e={public:!1}){var t=this;try{return{data:await hs(t.fetch,`${t.url}/bucket`,{id:i,name:i,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async updateBucket(i,e){var t=this;try{return{data:await Cw(t.fetch,`${t.url}/bucket/${i}`,{id:i,name:i,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async emptyBucket(i){var e=this;try{return{data:await hs(e.fetch,`${e.url}/bucket/${i}/empty`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}}async deleteBucket(i){var e=this;try{return{data:await ox(e.fetch,`${e.url}/bucket/${i}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(i){const e={};return i&&("limit"in i&&(e.limit=String(i.limit)),"offset"in i&&(e.offset=String(i.offset)),i.search&&(e.search=i.search),i.sortColumn&&(e.sortColumn=i.sortColumn),i.sortOrder&&(e.sortOrder=i.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},NB=class{constructor(i,e={},t){this.shouldThrowOnError=!1,this.url=i.replace(/\/$/,""),this.headers=ke(ke({},fk),e),this.fetch=ax(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(i){var e=this;try{return{data:await hs(e.fetch,`${e.url}/bucket`,{name:i},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}}async listBuckets(i){var e=this;try{const t=new URLSearchParams;(i==null?void 0:i.limit)!==void 0&&t.set("limit",i.limit.toString()),(i==null?void 0:i.offset)!==void 0&&t.set("offset",i.offset.toString()),i!=null&&i.sortColumn&&t.set("sortColumn",i.sortColumn),i!=null&&i.sortOrder&&t.set("sortOrder",i.sortOrder),i!=null&&i.search&&t.set("search",i.search);const n=t.toString(),s=n?`${e.url}/bucket?${n}`:`${e.url}/bucket`;return{data:await of(e.fetch,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}}async deleteBucket(i){var e=this;try{return{data:await ox(e.fetch,`${e.url}/bucket/${i}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}}from(i){var e=this;if(!yB(i))throw new Q0("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new fB({baseUrl:this.url,catalogName:i,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(t,{get(s,a){const l=s[a];return typeof l!="function"?l:async(...c)=>{try{return{data:await l.apply(s,c),error:null}}catch(d){if(n)throw d;return{data:null,error:d}}}}})}};const lx={"X-Client-Info":`storage-js/${hk}`,"Content-Type":"application/json"};var pk=class extends Error{constructor(i){super(i),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Pi(i){return typeof i=="object"&&i!==null&&"__isStorageVectorsError"in i}var Ub=class extends pk{constructor(i,e,t){super(i),this.name="StorageVectorsApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},MB=class extends pk{constructor(i,e){super(i),this.name="StorageVectorsUnknownError",this.originalError=e}};const cx=i=>i?(...e)=>i(...e):(...e)=>fetch(...e),kB=i=>{if(typeof i!="object"||i===null)return!1;const e=Object.getPrototypeOf(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},$C=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),IB=async(i,e,t)=>{if(i&&typeof i=="object"&&"status"in i&&"ok"in i&&typeof i.status=="number"&&!(t!=null&&t.noResolveJson)){const n=i.status||500,s=i;if(typeof s.json=="function")s.json().then(a=>{const l=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||n+"";e(new Ub($C(a),n,l))}).catch(()=>{const a=n+"";e(new Ub(s.statusText||`HTTP ${n} error`,n,a))});else{const a=n+"";e(new Ub(s.statusText||`HTTP ${n} error`,n,a))}}else e(new MB($C(i),i))},DB=(i,e,t,n)=>{const s={method:i,headers:(e==null?void 0:e.headers)||{}};return n?(kB(n)?(s.headers=ke({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,ke(ke({},s),t)):s};async function PB(i,e,t,n,s,a){return new Promise((l,c)=>{i(t,DB(e,n,s,a)).then(d=>{if(!d.ok)throw d;if(n!=null&&n.noResolveJson)return d;const h=d.headers.get("content-type");return!h||!h.includes("application/json")?{}:d.json()}).then(d=>l(d)).catch(d=>IB(d,c,n))})}async function Li(i,e,t,n,s){return PB(i,"POST",e,n,s,t)}var LB=class{constructor(i,e={},t){this.shouldThrowOnError=!1,this.url=i.replace(/\/$/,""),this.headers=ke(ke({},lx),e),this.fetch=cx(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(i){var e=this;try{return{data:await Li(e.fetch,`${e.url}/CreateIndex`,i,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pi(t))return{data:null,error:t};throw t}}async getIndex(i,e){var t=this;try{return{data:await Li(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:i,indexName:e},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}}async listIndexes(i){var e=this;try{return{data:await Li(e.fetch,`${e.url}/ListIndexes`,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pi(t))return{data:null,error:t};throw t}}async deleteIndex(i,e){var t=this;try{return{data:await Li(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:i,indexName:e},{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Pi(n))return{data:null,error:n};throw n}}},OB=class{constructor(i,e={},t){this.shouldThrowOnError=!1,this.url=i.replace(/\/$/,""),this.headers=ke(ke({},lx),e),this.fetch=cx(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(i){var e=this;try{if(i.vectors.length<1||i.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Li(e.fetch,`${e.url}/PutVectors`,i,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pi(t))return{data:null,error:t};throw t}}async getVectors(i){var e=this;try{return{data:await Li(e.fetch,`${e.url}/GetVectors`,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pi(t))return{data:null,error:t};throw t}}async listVectors(i){var e=this;try{if(i.segmentCount!==void 0){if(i.segmentCount<1||i.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(i.segmentIndex!==void 0&&(i.segmentIndex<0||i.segmentIndex>=i.segmentCount))throw new Error(`segmentIndex must be between 0 and ${i.segmentCount-1}`)}return{data:await Li(e.fetch,`${e.url}/ListVectors`,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pi(t))return{data:null,error:t};throw t}}async queryVectors(i){var e=this;try{return{data:await Li(e.fetch,`${e.url}/QueryVectors`,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pi(t))return{data:null,error:t};throw t}}async deleteVectors(i){var e=this;try{if(i.keys.length<1||i.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Li(e.fetch,`${e.url}/DeleteVectors`,i,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pi(t))return{data:null,error:t};throw t}}},UB=class{constructor(i,e={},t){this.shouldThrowOnError=!1,this.url=i.replace(/\/$/,""),this.headers=ke(ke({},lx),e),this.fetch=cx(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(i){var e=this;try{return{data:await Li(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:i},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pi(t))return{data:null,error:t};throw t}}async getBucket(i){var e=this;try{return{data:await Li(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:i},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pi(t))return{data:null,error:t};throw t}}async listBuckets(i={}){var e=this;try{return{data:await Li(e.fetch,`${e.url}/ListVectorBuckets`,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pi(t))return{data:null,error:t};throw t}}async deleteBucket(i){var e=this;try{return{data:await Li(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:i},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Pi(t))return{data:null,error:t};throw t}}},FB=class extends UB{constructor(i,e={}){super(i,e.headers||{},e.fetch)}from(i){return new HB(this.url,this.headers,i,this.fetch)}async createBucket(i){var e=()=>super.createBucket,t=this;return e().call(t,i)}async getBucket(i){var e=()=>super.getBucket,t=this;return e().call(t,i)}async listBuckets(i={}){var e=()=>super.listBuckets,t=this;return e().call(t,i)}async deleteBucket(i){var e=()=>super.deleteBucket,t=this;return e().call(t,i)}},HB=class extends LB{constructor(i,e,t,n){super(i,e,n),this.vectorBucketName=t}async createIndex(i){var e=()=>super.createIndex,t=this;return e().call(t,ke(ke({},i),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(i={}){var e=()=>super.listIndexes,t=this;return e().call(t,ke(ke({},i),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(i){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,i)}async deleteIndex(i){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,i)}index(i){return new BB(this.url,this.headers,this.vectorBucketName,i,this.fetch)}},BB=class extends OB{constructor(i,e,t,n,s){super(i,e,s),this.vectorBucketName=t,this.indexName=n}async putVectors(i){var e=()=>super.putVectors,t=this;return e().call(t,ke(ke({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(i){var e=()=>super.getVectors,t=this;return e().call(t,ke(ke({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(i={}){var e=()=>super.listVectors,t=this;return e().call(t,ke(ke({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(i){var e=()=>super.queryVectors,t=this;return e().call(t,ke(ke({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(i){var e=()=>super.deleteVectors,t=this;return e().call(t,ke(ke({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},GB=class extends RB{constructor(i,e={},t,n){super(i,e,t,n)}from(i){return new CB(this.url,this.headers,i,this.fetch)}get vectors(){return new FB(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new NB(this.url+"/iceberg",this.headers,this.fetch)}};const zB="2.39.3";let Xh="";typeof Deno<"u"?Xh="deno":typeof document<"u"?Xh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Xh="react-native":Xh="node";const qB={"X-Client-Info":`supabase-js-${Xh}/${zB}`};var VB=function(i,e,t,n){function s(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(p){try{h(n.next(p))}catch(v){l(v)}}function d(p){try{h(n.throw(p))}catch(v){l(v)}}function h(p){p.done?a(p.value):s(p.value).then(c,d)}h((n=n.apply(i,e||[])).next())})};const $B=i=>{let e;return i?e=i:typeof fetch>"u"?e=tk:e=fetch,(...t)=>e(...t)},jB=()=>typeof Headers>"u"?nk:Headers,YB=(i,e,t)=>{const n=$B(t),s=jB();return(a,l)=>VB(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:i;let h=new s(l==null?void 0:l.headers);return h.has("apikey")||h.set("apikey",i),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),n(a,Object.assign(Object.assign({},l),{headers:h}))})};function KB(i){return i.replace(/\/$/,"")}function JB(i,e){const{db:t,auth:n,realtime:s,global:a}=i,{db:l,auth:c,realtime:d,global:h}=e;return{db:Object.assign(Object.assign({},l),t),auth:Object.assign(Object.assign({},c),n),realtime:Object.assign(Object.assign({},d),s),global:Object.assign(Object.assign({},h),a)}}const gk="2.90.1",du=30*1e3,Rw=3,Fb=Rw*du,XB="http://localhost:9999",WB="supabase.auth.token",QB={"X-Client-Info":`gotrue-js/${gk}`},Nw="X-Supabase-Api-Version",mk={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ZB=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,eG=600*1e3;class lf extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function we(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class tG extends lf{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function nG(i){return we(i)&&i.name==="AuthApiError"}class Ko extends lf{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class oa extends lf{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class vi extends oa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function iG(i){return we(i)&&i.name==="AuthSessionMissingError"}class Qc extends oa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class mm extends oa{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ym extends oa{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function sG(i){return we(i)&&i.name==="AuthImplicitGrantRedirectError"}class jC extends oa{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rG extends oa{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Mw extends oa{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Hb(i){return we(i)&&i.name==="AuthRetryableFetchError"}class YC extends oa{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class kw extends oa{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const d0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),KC=` 	
\r=`.split(""),aG=(()=>{const i=new Array(128);for(let e=0;e<i.length;e+=1)i[e]=-1;for(let e=0;e<KC.length;e+=1)i[KC[e].charCodeAt(0)]=-2;for(let e=0;e<d0.length;e+=1)i[d0[e].charCodeAt(0)]=e;return i})();function JC(i,e,t){if(i!==null)for(e.queue=e.queue<<8|i,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(d0[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(d0[n]),e.queuedBits-=6}}function yk(i,e,t){const n=aG[i];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function XC(i){const e=[],t=l=>{e.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=l=>{cG(l,n,t)};for(let l=0;l<i.length;l+=1)yk(i.charCodeAt(l),s,a);return e.join("")}function oG(i,e){if(i<=127){e(i);return}else if(i<=2047){e(192|i>>6),e(128|i&63);return}else if(i<=65535){e(224|i>>12),e(128|i>>6&63),e(128|i&63);return}else if(i<=1114111){e(240|i>>18),e(128|i>>12&63),e(128|i>>6&63),e(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function lG(i,e){for(let t=0;t<i.length;t+=1){let n=i.charCodeAt(t);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(i.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}oG(n,e)}}function cG(i,e,t){if(e.utf8seq===0){if(i<=127){t(i);return}for(let n=1;n<6;n+=1)if((i>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=i&31;else if(e.utf8seq===3)e.codepoint=i&15;else if(e.utf8seq===4)e.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|i&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function xu(i){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<i.length;s+=1)yk(i.charCodeAt(s),t,n);return new Uint8Array(e)}function uG(i){const e=[];return lG(i,t=>e.push(t)),new Uint8Array(e)}function Wo(i){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};return i.forEach(s=>JC(s,t,n)),JC(null,t,n),e.join("")}function dG(i){return Math.round(Date.now()/1e3)+i}function hG(){return Symbol("auth-callback")}const vn=()=>typeof window<"u"&&typeof document<"u",Bo={tested:!1,writable:!1},vk=()=>{if(!vn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Bo.tested)return Bo.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Bo.tested=!0,Bo.writable=!0}catch{Bo.tested=!0,Bo.writable=!1}return Bo.writable};function fG(i){const e={},t=new URL(i);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,a)=>{e[a]=s})}catch{}return t.searchParams.forEach((n,s)=>{e[s]=n}),e}const bk=i=>i?(...e)=>i(...e):(...e)=>fetch(...e),pG=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",hu=async(i,e,t)=>{await i.setItem(e,JSON.stringify(t))},Go=async(i,e)=>{const t=await i.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},yn=async(i,e)=>{await i.removeItem(e)};class Z0{constructor(){this.promise=new Z0.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Z0.promiseConstructor=Promise;function Bb(i){const e=i.split(".");if(e.length!==3)throw new kw("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!ZB.test(e[n]))throw new kw("JWT not in base64url format");return{header:JSON.parse(XC(e[0])),payload:JSON.parse(XC(e[1])),signature:xu(e[2]),raw:{header:e[0],payload:e[1]}}}async function gG(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function mG(i,e){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const l=await i(a);if(!e(a,null,l)){n(l);return}}catch(l){if(!e(a,l)){s(l);return}}})()})}function yG(i){return("0"+i.toString(16)).substr(-2)}function vG(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let s="";for(let a=0;a<56;a++)s+=t.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,yG).join("")}async function bG(i){const t=new TextEncoder().encode(i),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function _G(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const t=await bG(i);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Zc(i,e,t=!1){const n=vG();let s=n;t&&(s+="/PASSWORD_RECOVERY"),await hu(i,`${e}-code-verifier`,s);const a=await _G(n);return[a,n===a?"plain":"s256"]}const wG=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function xG(i){const e=i.headers.get(Nw);if(!e||!e.match(wG))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function SG(i){if(!i)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(i<=e)throw new Error("JWT has expired")}function AG(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const EG=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function eu(i){if(!EG.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Gb(){const i={};return new Proxy(i,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function TG(i,e){return new Proxy(i,{get:(t,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,n,s)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,n,s)}})}function WC(i){return JSON.parse(JSON.stringify(i))}const jo=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),CG=[502,503,504];async function QC(i){var e;if(!pG(i))throw new Mw(jo(i),0);if(CG.includes(i.status))throw new Mw(jo(i),i.status);let t;try{t=await i.json()}catch(a){throw new Ko(jo(a),a)}let n;const s=xG(i);if(s&&s.getTime()>=mk["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new YC(jo(t),i.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new vi}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0))throw new YC(jo(t),i.status,t.weak_password.reasons);throw new tG(jo(t),i.status||500,n)}const RG=(i,e,t,n)=>{const s={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};async function Me(i,e,t,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[Nw]||(a[Nw]=mk["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const l=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await NG(i,e,t+c,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(d):{data:Object.assign({},d),error:null}}async function NG(i,e,t,n,s,a){const l=RG(e,n,s,a);let c;try{c=await i(t,Object.assign({},l))}catch(d){throw console.error(d),new Mw(jo(d),0)}if(c.ok||await QC(c),n!=null&&n.noResolveJson)return c;try{return await c.json()}catch(d){await QC(d)}}function cs(i){var e;let t=null;IG(i)&&(t=Object.assign({},i),i.expires_at||(t.expires_at=dG(i.expires_in)));const n=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:t,user:n},error:null}}function ZC(i){const e=cs(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=i.weak_password),e}function Oa(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function MG(i){return{data:i,error:null}}function kG(i){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:a}=i,l=W0(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:a},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function eR(i){return i}function IG(i){return i.access_token&&i.refresh_token&&i.expires_in}const zb=["global","local","others"];class DG{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=bk(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=zb[0]){if(zb.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${zb.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(we(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Oa})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=W0(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:kG,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(we(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Oa})}catch(t){if(we(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,a,l,c,d;try{const h={nextPage:null,lastPage:0,total:0},p=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:eR});if(p.error)throw p.error;const v=await p.json(),_=(l=p.headers.get("x-total-count"))!==null&&l!==void 0?l:0,x=(d=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return x.length>0&&(x.forEach(A=>{const E=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(A.split(";")[1].split("=")[1]);h[`${R}Page`]=E}),h.total=parseInt(_)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(we(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){eu(e);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Oa})}catch(t){if(we(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){eu(e);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Oa})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){eu(e);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Oa})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){eu(e.userId);try{const{data:t,error:n}=await Me(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:n}}catch(t){if(we(t))return{data:null,error:t};throw t}}async _deleteFactor(e){eu(e.userId),eu(e.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,s,a,l,c,d;try{const h={nextPage:null,lastPage:0,total:0},p=await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:eR});if(p.error)throw p.error;const v=await p.json(),_=(l=p.headers.get("x-total-count"))!==null&&l!==void 0?l:0,x=(d=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return x.length>0&&(x.forEach(A=>{const E=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(A.split(";")[1].split("=")[1]);h[`${R}Page`]=E}),h.total=parseInt(_)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(we(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(e){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(we(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(we(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Me(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(we(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await Me(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(we(t))return{data:null,error:t};throw t}}}function tR(i={}){return{getItem:e=>i[e]||null,setItem:(e,t)=>{i[e]=t},removeItem:e=>{delete i[e]}}}const tu={debug:!!(globalThis&&vk()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class _k extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class PG extends _k{}async function LG(i,e,t){tu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),tu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){tu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,s.name);try{return await t()}finally{tu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,s.name)}}else{if(e===0)throw tu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new PG(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(tu.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function OG(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function wk(i){if(!/^0x[a-fA-F0-9]{40}$/.test(i))throw new Error(`@supabase/auth-js: Address "${i}" is invalid.`);return i.toLowerCase()}function UG(i){return parseInt(i,16)}function FG(i){const e=new TextEncoder().encode(i);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function HG(i){var e;const{chainId:t,domain:n,expirationTime:s,issuedAt:a=new Date,nonce:l,notBefore:c,requestId:d,resources:h,scheme:p,uri:v,version:_}=i;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(_!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${_}`);if(!((e=i.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${i.statement}`)}const x=wk(i.address),A=p?`${p}://${n}`:n,E=i.statement?`${i.statement}
`:"",R=`${A} wants you to sign in with your Ethereum account:
${x}

${E}`;let N=`URI: ${v}
Version: ${_}
Chain ID: ${t}${l?`
Nonce: ${l}`:""}
Issued At: ${a.toISOString()}`;if(s&&(N+=`
Expiration Time: ${s.toISOString()}`),c&&(N+=`
Not Before: ${c.toISOString()}`),d&&(N+=`
Request ID: ${d}`),h){let D=`
Resources:`;for(const P of h){if(!P||typeof P!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${P}`);D+=`
- ${P}`}N+=D}return`${R}
${N}`}class qt extends Error{constructor({message:e,code:t,cause:n,name:s}){var a;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=s??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=t}}class h0 extends qt{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function BG({error:i,options:e}){var t,n,s;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(e.signal instanceof AbortSignal)return new qt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else if(i.name==="ConstraintError"){if(((t=a.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new qt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:i});if(e.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new qt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:i});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new qt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:i})}else{if(i.name==="InvalidStateError")return new qt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:i});if(i.name==="NotAllowedError")return new qt({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="NotSupportedError")return a.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new qt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:i}):new qt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:i});if(i.name==="SecurityError"){const l=window.location.hostname;if(xk(l)){if(a.rp.id!==l)return new qt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new qt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new qt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:i})}else if(i.name==="UnknownError")return new qt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new qt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}function GG({error:i,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(e.signal instanceof AbortSignal)return new qt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else{if(i.name==="NotAllowedError")return new qt({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="SecurityError"){const n=window.location.hostname;if(xk(n)){if(t.rpId!==n)return new qt({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new qt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="UnknownError")return new qt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new qt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}class zG{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const qG=new zG;function VG(i){if(!i)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(i);const{challenge:e,user:t,excludeCredentials:n}=i,s=W0(i,["challenge","user","excludeCredentials"]),a=xu(e).buffer,l=Object.assign(Object.assign({},t),{id:xu(t.id).buffer}),c=Object.assign(Object.assign({},s),{challenge:a,user:l});if(n&&n.length>0){c.excludeCredentials=new Array(n.length);for(let d=0;d<n.length;d++){const h=n[d];c.excludeCredentials[d]=Object.assign(Object.assign({},h),{id:xu(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return c}function $G(i){if(!i)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(i);const{challenge:e,allowCredentials:t}=i,n=W0(i,["challenge","allowCredentials"]),s=xu(e).buffer,a=Object.assign(Object.assign({},n),{challenge:s});if(t&&t.length>0){a.allowCredentials=new Array(t.length);for(let l=0;l<t.length;l++){const c=t[l];a.allowCredentials[l]=Object.assign(Object.assign({},c),{id:xu(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function jG(i){var e;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const t=i;return{id:i.id,rawId:i.id,response:{attestationObject:Wo(new Uint8Array(i.response.attestationObject)),clientDataJSON:Wo(new Uint8Array(i.response.clientDataJSON))},type:"public-key",clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function YG(i){var e;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const t=i,n=i.getClientExtensionResults(),s=i.response;return{id:i.id,rawId:i.id,response:{authenticatorData:Wo(new Uint8Array(s.authenticatorData)),clientDataJSON:Wo(new Uint8Array(s.clientDataJSON)),signature:Wo(new Uint8Array(s.signature)),userHandle:s.userHandle?Wo(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function xk(i){return i==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(i)}function nR(){var i,e;return!!(vn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((i=navigator==null?void 0:navigator.credentials)===null||i===void 0?void 0:i.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function KG(i){try{const e=await navigator.credentials.create(i);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new h0("Browser returned unexpected credential type",e)}:{data:null,error:new h0("Empty credential response",e)}}catch(e){return{data:null,error:BG({error:e,options:i})}}}async function JG(i){try{const e=await navigator.credentials.get(i);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new h0("Browser returned unexpected credential type",e)}:{data:null,error:new h0("Empty credential response",e)}}catch(e){return{data:null,error:GG({error:e,options:i})}}}const XG={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},WG={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function f0(...i){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of i)if(s)for(const a in s){const l=s[a];if(l!==void 0)if(Array.isArray(l))n[a]=l;else if(t(l))n[a]=l;else if(e(l)){const c=n[a];e(c)?n[a]=f0(c,l):n[a]=f0(l)}else n[a]=l}return n}function QG(i,e){return f0(XG,i,e||{})}function ZG(i,e){return f0(WG,i,e||{})}class e6{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:n,signal:s},a){try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!l)return{data:null,error:c};const d=s??qG.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:h}=l.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${n}`),h.displayName||(h.displayName=h.name)}switch(l.webauthn.type){case"create":{const h=QG(l.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:p,error:v}=await KG({publicKey:h,signal:d});return p?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:p}},error:null}:{data:null,error:v}}case"request":{const h=ZG(l.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:p,error:v}=await JG(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:h,signal:d}));return p?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:p}},error:null}:{data:null,error:v}}}}catch(l){return we(l)?{data:null,error:l}:{data:null,error:new Ko("Unexpected error in challenge",l)}}}async _verify({challengeId:e,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new lf("rpId is required for WebAuthn authentication")};try{if(!nR())return{data:null,error:new Ko("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:n},signal:s},{request:a});if(!l)return{data:null,error:c};const{webauthn:d}=l;return this._verify({factorId:e,challengeId:l.challengeId,webauthn:{type:d.type,rpId:t,rpOrigins:n,credential_response:d.credential_response}})}catch(l){return we(l)?{data:null,error:l}:{data:null,error:new Ko("Unexpected error in authenticate",l)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new lf("rpId is required for WebAuthn registration")};try{if(!nR())return{data:null,error:new Ko("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this._enroll({friendlyName:e});if(!l)return await this.client.mfa.listFactors().then(p=>{var v;return(v=p.data)===null||v===void 0?void 0:v.all.find(_=>_.factor_type==="webauthn"&&_.friendly_name===e&&_.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p==null?void 0:p.id}):void 0),{data:null,error:c};const{data:d,error:h}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:s},{create:a});return d?this._verify({factorId:l.id,challengeId:d.challengeId,webauthn:{rpId:t,rpOrigins:n,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:h}}catch(l){return we(l)?{data:null,error:l}:{data:null,error:new Ko("Unexpected error in register",l)}}}}OG();const t6={url:XB,storageKey:WB,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:QB,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function iR(i,e,t){return await t()}const nu={};class cf{get jwks(){var e,t;return(t=(e=nu[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){nu[this.storageKey]=Object.assign(Object.assign({},nu[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=nu[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){nu[this.storageKey]=Object.assign(Object.assign({},nu[this.storageKey]),{cachedAt:e})}constructor(e){var t,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},t6),e);if(this.storageKey=a.storageKey,this.instanceID=(t=cf.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,cf.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&vn()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new DG({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=bk(a.fetch),this.lock=a.lock||iR,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&vn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=LG:this.lock=iR,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new e6(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:vk()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=tR(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=tR(this.memoryStorage)),vn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${gk}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},n="none";if(vn()&&(t=fG(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),vn()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(t,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),sG(a)){const d=(e=a.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return{error:a}}const{session:l,redirectType:c}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return we(t)?this._returnResult({error:t}):this._returnResult({error:new Ko("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:cs}),{data:l,error:c}=a;if(c||!l)return this._returnResult({data:{user:null,session:null},error:c});const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(a){if(we(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,n,s;try{let a;if("email"in e){const{email:p,password:v,options:_}=e;let x=null,A=null;this.flowType==="pkce"&&([x,A]=await Zc(this.storage,this.storageKey)),a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:p,password:v,data:(t=_==null?void 0:_.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:x,code_challenge_method:A},xform:cs})}else if("phone"in e){const{phone:p,password:v,options:_}=e;a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:v,data:(n=_==null?void 0:_.data)!==null&&n!==void 0?n:{},channel:(s=_==null?void 0:_.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:cs})}else throw new mm("You must provide either an email or phone number and a password");const{data:l,error:c}=a;if(c||!l)return await yn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(a){if(await yn(this.storage,`${this.storageKey}-code-verifier`),we(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:l,options:c}=e;t=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:ZC})}else if("phone"in e){const{phone:a,password:l,options:c}=e;t=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:ZC})}else throw new mm("You must provide either an email or phone number and a password");const{data:n,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const a=new Qc;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(t){if(we(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,n,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,n,s,a,l,c,d,h,p,v,_;let x,A;if("message"in e)x=e.message,A=e.signature;else{const{chain:E,wallet:R,statement:N,options:D}=e;let P;if(vn())if(typeof R=="object")P=R;else{const Y=window;if("ethereum"in Y&&typeof Y.ethereum=="object"&&"request"in Y.ethereum&&typeof Y.ethereum.request=="function")P=Y.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!(D!=null&&D.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=R}const L=new URL((t=D==null?void 0:D.url)!==null&&t!==void 0?t:window.location.href),B=await P.request({method:"eth_requestAccounts"}).then(Y=>Y).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!B||B.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const H=wk(B[0]);let O=(n=D==null?void 0:D.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!O){const Y=await P.request({method:"eth_chainId"});O=UG(Y)}const X={domain:L.host,address:H,statement:N,uri:L.href,version:"1",chainId:O,nonce:(s=D==null?void 0:D.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(l=(a=D==null?void 0:D.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(c=D==null?void 0:D.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(d=D==null?void 0:D.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(h=D==null?void 0:D.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(p=D==null?void 0:D.signInWithEthereum)===null||p===void 0?void 0:p.resources};x=HG(X),A=await P.request({method:"personal_sign",params:[FG(x),H]})}try{const{data:E,error:R}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:x,signature:A},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:cs});if(R)throw R;if(!E||!E.session||!E.user){const N=new Qc;return this._returnResult({data:{user:null,session:null},error:N})}return E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),this._returnResult({data:Object.assign({},E),error:R})}catch(E){if(we(E))return this._returnResult({data:{user:null,session:null},error:E});throw E}}async signInWithSolana(e){var t,n,s,a,l,c,d,h,p,v,_,x;let A,E;if("message"in e)A=e.message,E=e.signature;else{const{chain:R,wallet:N,statement:D,options:P}=e;let L;if(vn())if(typeof N=="object")L=N;else{const H=window;if("solana"in H&&typeof H.solana=="object"&&("signIn"in H.solana&&typeof H.solana.signIn=="function"||"signMessage"in H.solana&&typeof H.solana.signMessage=="function"))L=H.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(P!=null&&P.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");L=N}const B=new URL((t=P==null?void 0:P.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in L&&L.signIn){const H=await L.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},P==null?void 0:P.signInWithSolana),{version:"1",domain:B.host,uri:B.href}),D?{statement:D}:null));let O;if(Array.isArray(H)&&H[0]&&typeof H[0]=="object")O=H[0];else if(H&&typeof H=="object"&&"signedMessage"in H&&"signature"in H)O=H;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)A=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),E=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in L)||typeof L.signMessage!="function"||!("publicKey"in L)||typeof L!="object"||!L.publicKey||!("toBase58"in L.publicKey)||typeof L.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");A=[`${B.host} wants you to sign in with your Solana account:`,L.publicKey.toBase58(),...D?["",D,""]:[""],"Version: 1",`URI: ${B.href}`,`Issued At: ${(s=(n=P==null?void 0:P.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=P==null?void 0:P.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${P.signInWithSolana.notBefore}`]:[],...!((l=P==null?void 0:P.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${P.signInWithSolana.expirationTime}`]:[],...!((c=P==null?void 0:P.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${P.signInWithSolana.chainId}`]:[],...!((d=P==null?void 0:P.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${P.signInWithSolana.nonce}`]:[],...!((h=P==null?void 0:P.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${P.signInWithSolana.requestId}`]:[],...!((v=(p=P==null?void 0:P.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||v===void 0)&&v.length?["Resources",...P.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const H=await L.signMessage(new TextEncoder().encode(A),"utf8");if(!H||!(H instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");E=H}}try{const{data:R,error:N}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:A,signature:Wo(E)},!((_=e.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:cs});if(N)throw N;if(!R||!R.session||!R.user){const D=new Qc;return this._returnResult({data:{user:null,session:null},error:D})}return R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("SIGNED_IN",R.session)),this._returnResult({data:Object.assign({},R),error:N})}catch(R){if(we(R))return this._returnResult({data:{user:null,session:null},error:R});throw R}}async _exchangeCodeForSession(e){const t=await Go(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(t??"").split("/");try{if(!n&&this.flowType==="pkce")throw new rG;const{data:a,error:l}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:cs});if(await yn(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!a||!a.session||!a.user){const c=new Qc;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:l})}catch(a){if(await yn(this.storage,`${this.storageKey}-code-verifier`),we(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:a,nonce:l}=e,c=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:l,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:cs}),{data:d,error:h}=c;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!d||!d.session||!d.user){const p=new Qc;return this._returnResult({data:{user:null,session:null},error:p})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:h})}catch(t){if(we(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,n,s,a,l;try{if("email"in e){const{email:c,options:d}=e;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await Zc(this.storage,this.storageKey));const{error:v}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},create_user:(n=d==null?void 0:d.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:p},redirectTo:d==null?void 0:d.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in e){const{phone:c,options:d}=e,{data:h,error:p}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(s=d==null?void 0:d.data)!==null&&s!==void 0?s:{},create_user:(a=d==null?void 0:d.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:p})}throw new mm("You must provide either an email or phone number.")}catch(c){if(await yn(this.storage,`${this.storageKey}-code-verifier`),we(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var t,n;try{let s,a;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:c}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:cs});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,h=l.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(s){if(we(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,n,s,a,l;try{let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Zc(this.storage,this.storageKey));const h=await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:MG});return!((a=h.data)===null||a===void 0)&&a.url&&vn()&&!(!((l=e.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(c){if(await yn(this.storage,`${this.storageKey}-code-verifier`),we(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new vi;const{error:s}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(we(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:a}=e,{error:l}=await Me(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in e){const{phone:n,type:s,options:a}=e,{data:l,error:c}=await Me(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c})}throw new mm("You must provide either an email or phone number and a type")}catch(t){if(we(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Go(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Fb:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const l=await Go(this.userStorage,this.storageKey+"-user");l!=null&&l.user?e.user=l.user:e.user=Gb()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};e.user=TG(e.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Oa}):await this._useSession(async t=>{var n,s,a;const{data:l,error:c}=t;if(c)throw c;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new vi}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Oa})})}catch(t){if(we(t))return iG(t)&&(await this._removeSession(),await yn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new vi;const l=s.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await Zc(this.storage,this.storageKey));const{data:h,error:p}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:Oa});if(p)throw p;return l.user=h.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await yn(this.storage,`${this.storageKey}-code-verifier`),we(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new vi;const t=Date.now()/1e3;let n=t,s=!0,a=null;const{payload:l}=Bb(e.access_token);if(l.exp&&(n=l.exp,s=n<=t),s){const{data:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c)return{data:{user:null,session:null},error:null};a=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;a={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(we(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:l,error:c}=t;if(c)throw c;e=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new vi;const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(we(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!vn())throw new ym("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ym(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new jC("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ym("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new jC("No code detected.");const{data:D,error:P}=await this._exchangeCodeForSession(e.code);if(P)throw P;const L=new URL(window.location.href);return L.searchParams.delete("code"),window.history.replaceState(window.history.state,"",L.toString()),{data:{session:D.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:l,expires_in:c,expires_at:d,token_type:h}=e;if(!a||!c||!l||!h)throw new ym("No session defined in URL");const p=Math.round(Date.now()/1e3),v=parseInt(c);let _=p+v;d&&(_=parseInt(d));const x=_-p;x*1e3<=du&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${v}s`);const A=_-v;p-A>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",A,_,p):p-A<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",A,_,p);const{data:E,error:R}=await this._getUser(a);if(R)throw R;const N={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:v,expires_at:_,refresh_token:l,token_type:h,user:E.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:N,redirectType:e.type},error:null})}catch(n){if(we(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Go(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:s,error:a}=t;if(a)return this._returnResult({error:a});const l=(n=s.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(nG(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await yn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=hG(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:a},error:l}=t;if(l)throw l;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Zc(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(await yn(this.storage,`${this.storageKey}-code-verifier`),we(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:s}=await this._useSession(async a=>{var l,c,d,h,p;const{data:v,error:_}=a;if(_)throw _;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",x,{headers:this.headers,jwt:(p=(h=v.session)===null||h===void 0?void 0:h.access_token)!==null&&p!==void 0?p:void 0})});if(s)throw s;return vn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:e.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(we(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:s,data:{session:a}}=t;if(s)throw s;const{options:l,provider:c,token:d,access_token:h,nonce:p}=e,v=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:c,id_token:d,access_token:h,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:cs}),{data:_,error:x}=v;return x?this._returnResult({data:{user:null,session:null},error:x}):!_||!_.session||!_.user?this._returnResult({data:{user:null,session:null},error:new Qc}):(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("USER_UPDATED",_.session)),this._returnResult({data:_,error:x}))}catch(s){if(await yn(this.storage,`${this.storageKey}-code-verifier`),we(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:a,error:l}=t;if(l)throw l;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await mG(async s=>(s>0&&await gG(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:cs})),(s,a)=>{const l=200*Math.pow(2,s);return a&&Hb(a)&&Date.now()+l-n<du})}catch(n){if(this._debug(t,"error",n),we(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),vn()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Go(this.storage,this.storageKey);if(s&&this.userStorage){let l=await Go(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:s.user},await hu(this.userStorage,this.storageKey+"-user",l)),s.user=(e=l==null?void 0:l.user)!==null&&e!==void 0?e:Gb()}else if(s&&!s.user&&!s.user){const l=await Go(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(s.user=l.user,await yn(this.storage,this.storageKey+"-user"),await hu(this.storage,this.storageKey,s)):s.user=Gb()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Fb;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${Fb}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:l}=await this._callRefreshToken(s.refresh_token);l&&(console.error(l),Hb(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:c}=await this._getUser(s.access_token);!c&&(l!=null&&l.user)?(s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new vi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Z0;const{data:a,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!a.session)throw new vi;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const c={data:a.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(a){if(this._debug(s,"error",a),we(a)){const l={data:null,error:a};return Hb(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(d){a.push(d)}});if(await Promise.all(l),a.length>0){for(let c=0;c<a.length;c+=1)console.error(a[c]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await yn(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await hu(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const a=WC(s);await hu(this.storage,this.storageKey,a)}else{const s=WC(t);await hu(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await yn(this.storage,this.storageKey),await yn(this.storage,this.storageKey+"-code-verifier"),await yn(this.storage,this.storageKey+"-user"),this.userStorage&&await yn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&vn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),du);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/du);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${du}ms, refresh threshold is ${Rw} ticks`),s<=Rw&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof _k)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!vn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,l]=await Zc(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(c.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:a}=t;return a?this._returnResult({data:null,error:a}):await Me(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:d,error:h}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return h?this._returnResult({data:null,error:h}):(e.factorType==="totp"&&d.type==="totp"&&(!((s=d==null?void 0:d.totp)===null||s===void 0)&&s.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?jG(e.webauthn.credential_response):YG(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:d}=await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:d}))})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const l=await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:c}=l;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:VG(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:$G(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Bb(n.access_token);let l=null;a.aal&&(l=a.aal);let c=l;((t=(e=n.user.factors)===null||e===void 0?void 0:e.filter(p=>p.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(c="aal2");const h=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:s}=t;return s?this._returnResult({data:null,error:s}):n?await Me(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new vi})})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new vi});const l=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&vn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(we(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new vi});const l=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&vn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(we(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;return n?this._returnResult({data:null,error:n}):t?await Me(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new vi})})}catch(e){if(we(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:n},error:s}=t;return s?this._returnResult({data:null,error:s}):n?(await Me(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new vi})})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(c=>c.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(c=>c.kid===e),n&&this.jwks_cached_at+eG>s)return n;const{data:a,error:l}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(c=>c.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:x,error:A}=await this.getSession();if(A||!x.session)return this._returnResult({data:null,error:A});n=x.session.access_token}const{header:s,payload:a,signature:l,raw:{header:c,payload:d}}=Bb(n);t!=null&&t.allowExpired||SG(a.exp);const h=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!h){const{error:x}=await this.getUser(n);if(x)throw x;return{data:{claims:a,header:s,signature:l},error:null}}const p=AG(s.alg),v=await crypto.subtle.importKey("jwk",h,p,!0,["verify"]);if(!await crypto.subtle.verify(p,v,l,uG(`${c}.${d}`)))throw new kw("Invalid JWT signature");return{data:{claims:a,header:s,signature:l},error:null}}catch(n){if(we(n))return this._returnResult({data:null,error:n});throw n}}}cf.nextInstanceID={};class n6 extends cf{constructor(e){super(e)}}var i6=function(i,e,t,n){function s(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(p){try{h(n.next(p))}catch(v){l(v)}}function d(p){try{h(n.throw(p))}catch(v){l(v)}}function h(p){p.done?a(p.value):s(p.value).then(c,d)}h((n=n.apply(i,e||[])).next())})};const s6={headers:qB},r6={schema:"public"},a6={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},o6={};class l6{constructor(e,t,n){var s,a,l,c,d,h,p,v;if(this.supabaseUrl=e,this.supabaseKey=t,this.from=R=>this.rest.from(R),this.schema=R=>this.rest.schema(R),this.rpc=(R,N={},D)=>this.rest.rpc(R,N,D),!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const _=KB(e);this.realtimeUrl=`${_}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${_}/auth/v1`,this.storageUrl=`${_}/storage/v1`,this.functionsUrl=`${_}/functions/v1`;const x=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,A={db:r6,realtime:o6,auth:Object.assign(Object.assign({},a6),{storageKey:x}),global:s6},E=JB(n??{},A);this.storageKey=(a=(s=E.auth)===null||s===void 0?void 0:s.storageKey)!==null&&a!==void 0?a:"",this.headers=(c=(l=E.global)===null||l===void 0?void 0:l.headers)!==null&&c!==void 0?c:{},this.auth=this._initSupabaseAuthClient((d=E.auth)!==null&&d!==void 0?d:{},this.headers,(h=E.global)===null||h===void 0?void 0:h.fetch),this.fetch=YB(t,this._getAccessToken.bind(this),(p=E.global)===null||p===void 0?void 0:p.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},E.realtime)),this.rest=new VH(`${_}/rest/v1`,{headers:this.headers,schema:(v=E.db)===null||v===void 0?void 0:v.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new DH(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new GB(this.storageUrl,this.headers,this.fetch)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return i6(this,void 0,void 0,function*(){const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,storageKey:a,flowType:l,debug:c},d,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new n6({url:this.authUrl,headers:Object.assign(Object.assign({},p),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,flowType:l,debug:c,fetch:h})}_initRealtimeClient(e){return new oB(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.realtime.setAuth(n??null),this.changedAccessToken=n):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const c6=(i,e,t)=>new l6(i,e,t),u6="https://dnwczvokxloyzjnqqfbd.supabase.co",d6="sb_publishable_evp59khbQk9e0LE6YnjzxQ_4ByKuJaq",nr=c6(u6,d6);var Te=(i=>(i.HOME="HOME",i.PROCESSING="PROCESSING",i.QUIZ="QUIZ",i.RESULT="RESULT",i.ERROR="ERROR",i.SERVICES="SERVICES",i.PROFILE="PROFILE",i.DEVAI="DEVAI",i.ABOUT="ABOUT",i))(Te||{});/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),f6=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),sR=i=>{const e=f6(i);return e.charAt(0).toUpperCase()+e.slice(1)},Sk=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),p6=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var g6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m6=ue.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:l,...c},d)=>ue.createElement("svg",{ref:d,...g6,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:Sk("lucide",s),...!a&&!p6(c)&&{"aria-hidden":"true"},...c},[...l.map(([h,p])=>ue.createElement(h,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=(i,e)=>{const t=ue.forwardRef(({className:n,...s},a)=>ue.createElement(m6,{ref:a,iconNode:e,className:Sk(`lucide-${h6(sR(i))}`,`lucide-${i}`,n),...s}));return t.displayName=sR(i),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y6=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],v6=me("arrow-left",y6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b6=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],_6=me("arrow-right",b6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w6=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],x6=me("arrow-up-down",w6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S6=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],A6=me("award",S6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E6=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],T6=me("book-open",E6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C6=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],Ak=me("brain-circuit",C6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],N6=me("brain",R6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Iw=me("building-2",M6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k6=[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h.01",key:"1bh4kh"}],["path",{d:"M12 4h.01",key:"1ujb9j"}],["path",{d:"M17 4h.01",key:"1upcoc"}]],Ek=me("cake",k6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I6=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],D6=me("calculator",I6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],L6=me("calendar-days",P6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O6=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],rR=me("calendar",O6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U6=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],F6=me("chart-column",U6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H6=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Dw=me("chevron-left",H6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Tk=me("circle-alert",B6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Pw=me("circle-check",G6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ck=me("circle-question-mark",z6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ux=me("circle-user-round",q6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],$6=me("circle-x",V6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j6=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Rk=me("clock",j6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y6=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],K6=me("cloud-upload",Y6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],X6=me("code-xml",J6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W6=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],aR=me("cpu",W6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Z6=me("crown",Q6);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],tz=me("file-text",ez);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],dx=me("graduation-cap",nz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],sz=me("history",iz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],hx=me("house",rz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],oz=me("info",az);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],cz=me("layers",lz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],Lw=me("library",uz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Nd=me("loader-circle",dz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],fz=me("lock",hz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pz=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],gz=me("log-in",pz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],yz=me("log-out",mz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],bz=me("mail",vz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],Nk=me("medal",_z);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],oR=me("message-circle",wz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xz=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Sz=me("monitor",xz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Az=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Ez=me("palette",Az);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tz=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],Cz=me("panels-top-left",Tz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Nz=me("pen",Rz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mz=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],kz=me("percent",Mz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iz=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Mk=me("plus",Iz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dz=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],Pz=me("puzzle",Dz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lz=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Oz=me("refresh-cw",Lz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uz=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],lR=me("repeat",Uz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fz=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Hz=me("rocket",Fz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bz=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Gz=me("save",Bz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zz=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],qz=me("settings-2",zz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],kk=me("shield-alert",Vz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $z=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],jz=me("shield-check",$z);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yz=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Kz=me("smartphone",Yz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jz=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Hp=me("sparkles",Jz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xz=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],fx=me("star",Xz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wz=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Qz=me("trash-2",Wz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zz=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ik=me("triangle-alert",Zz);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eq=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],p0=me("trophy",eq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tq=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],nq=me("type",tq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iq=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],sq=me("user-plus",iq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rq=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],aq=me("user-round",rq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oq=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],lq=me("user",oq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cq=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],uq=me("users",cq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dq=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],px=me("x",dq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hq=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],g0=me("zap",hq),fq=({onFileSelect:i,disabled:e})=>{const t=ue.useRef(null),n=s=>{s.target.files&&s.target.files.length>0&&(i(s.target.files[0]),s.target.value="")};return S.jsx("div",{className:"flex justify-center w-full",children:S.jsxs("div",{className:`uiverse-upload-card ${e?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{var s;return!e&&((s=t.current)==null?void 0:s.click())},children:[S.jsx("input",{type:"file",accept:"application/pdf",className:"hidden",ref:t,onChange:n,disabled:e}),S.jsx("div",{className:"w-16 h-16 bg-gradient-to-tr from-violet-500/20 to-fuchsia-500/20 text-violet-300 rounded-2xl flex items-center justify-center mb-4 border border-white/5 shadow-inner transition-transform duration-500",children:S.jsx(K6,{size:32,className:"drop-shadow-[0_0_10px_rgba(167,139,250,0.5)]"})}),S.jsx("h3",{className:"text-xl font-black text-white mb-2 tracking-tight transition-colors",children:"  PDF"}),S.jsx("p",{className:"text-slate-400 text-[10px] px-6 mb-6 leading-relaxed font-medium text-center",children:"         ."}),S.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-violet-300 bg-violet-500/10 border border-violet-500/20 px-3 py-1.5 rounded-full shadow-[0_0_15px_rgba(139,92,246,0.1)]",children:[S.jsx(Hp,{size:12}),S.jsx("span",{children:"  "})]})]})})},Zt=({children:i,variant:e="primary",fullWidth:t=!1,className:n="",...s})=>{const a="px-6 py-3.5 rounded-xl font-bold transition-all duration-300 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 relative overflow-hidden",l={primary:"bg-gradient-to-r from-violet-600 via-purple-600 to-fuchsia-600 text-white shadow-[0_0_20px_rgba(139,92,246,0.3)] hover:shadow-[0_0_30px_rgba(139,92,246,0.5)] border border-white/10",secondary:"bg-white/5 hover:bg-white/10 text-white border border-white/10 hover:border-white/20 backdrop-blur-md",outline:"bg-transparent border border-white/20 text-slate-300 hover:text-white hover:border-violet-500 hover:shadow-[0_0_15px_rgba(139,92,246,0.2)]",danger:"bg-red-500/10 text-red-400 hover:bg-red-500/20 border border-red-500/20"};return S.jsx("button",{className:`${a} ${l[e]} ${t?"w-full":""} ${n}`,...s,children:S.jsx("span",{className:"relative z-10 flex items-center gap-2",children:i})})},pq=({isOpen:i,onClose:e,onSuccess:t})=>{const[n,s]=ue.useState("LOGIN"),[a,l]=ue.useState(""),[c,d]=ue.useState(""),[h,p]=ue.useState(""),[v,_]=ue.useState(!1),[x,A]=ue.useState(""),[E,R]=ue.useState(!1),[N,D]=ue.useState(!1),[P,L]=ue.useState(!1);if(!i)return null;const B=()=>{e(),setTimeout(()=>{s("LOGIN"),l(""),d(""),p(""),A(""),R(!1),_(!1),D(!1),L(!1)},300)},H=async X=>{if(X.preventDefault(),n!=="LOGIN"&&!N){A("     ");return}_(!0),A("");try{let Y=null;if(n==="GUEST"){if(!h.trim())throw new Error("  ");const se=h.trim()==="2001",re=se?"":h,ne={id:se?"admin-yazan-2001":"guest-"+Date.now(),email:se?"admin@idraak.ai":"guest@local",user_metadata:{full_name:re,role:se?"admin":"student",avatar:se?"Joshua":"Felix"},app_metadata:{provider:"guest"},aud:"authenticated",created_at:new Date().toISOString()};localStorage.setItem("guest_user",JSON.stringify(ne)),Y=ne}else if(n==="LOGIN"){const se=await nr.auth.signInWithPassword({email:a,password:c});if(se.error)throw se.error;Y=se.data.user}else{if(!h.trim())throw new Error("   ");const se=await nr.auth.signUp({email:a,password:c,options:{data:{full_name:h}}});if(se.error)throw se.error;Y=se.data.user}Y&&(R(!0),setTimeout(()=>{t(Y),B()},1500))}catch(Y){A(Y.message||"   "),_(!1)}},O=()=>S.jsxs("div",{className:"absolute inset-0 bg-[#050505] z-50 p-8 flex flex-col",children:[S.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[S.jsx("button",{onClick:()=>L(!1),className:"p-2 bg-white/5 rounded-full text-slate-400 hover:text-white transition-colors",children:S.jsx(v6,{size:18})}),S.jsx("h3",{className:"text-xl font-black text-white",children:" "})]}),S.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 text-slate-400 text-sm leading-relaxed space-y-4 text-right",dir:"rtl",children:[S.jsx("p",{className:"font-bold text-white text-lg",children:"   ."}),S.jsx("p",{children:"1.            ."}),S.jsx("p",{children:"2.   PDF                     ."}),S.jsx("p",{children:"3.        .             ."}),S.jsx("p",{children:"4.    Google Gemini         ."}),S.jsx("p",{children:"5.        ."})]}),S.jsx(Zt,{onClick:()=>L(!1),className:"mt-6 shadow-lg shadow-emerald-500/10",children:" "})]});return S.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[S.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>!E&&B()}),S.jsxs("div",{className:"glass-panel w-full max-w-md bg-[#050505] rounded-[2.5rem] p-8 relative border border-white/10 shadow-[0_0_50px_rgba(139,92,246,0.15)] min-h-[580px] flex flex-col justify-center overflow-hidden",children:[P&&O(),E?S.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-10",children:[S.jsx("div",{className:"w-24 h-24 bg-emerald-500/10 rounded-full flex items-center justify-center mb-6 border border-emerald-500/20 shadow-[0_0_30px_rgba(16,185,129,0.2)]",children:S.jsx(Pw,{className:"text-emerald-400 w-12 h-12"})}),S.jsx("h2",{className:"text-3xl font-black text-white mb-2 tracking-tight",children:" !"}),S.jsx("p",{className:"text-emerald-400 font-bold text-lg",children:"   "}),S.jsx("div",{className:"mt-8",children:S.jsx(Nd,{className:"animate-spin text-slate-600"})})]}):S.jsxs(S.Fragment,{children:[S.jsx("button",{onClick:B,className:"absolute top-6 left-6 p-2 text-slate-500 hover:text-white hover:bg-white/10 rounded-full z-10 transition-all",children:S.jsx(px,{size:20})}),S.jsxs("div",{className:"text-center mb-8",children:[S.jsxs("div",{className:"w-16 h-16 bg-violet-500/10 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-violet-500/20 shadow-inner",children:[n==="LOGIN"&&S.jsx(gz,{className:"text-violet-400",size:32}),n==="SIGNUP"&&S.jsx(sq,{className:"text-violet-400",size:32}),n==="GUEST"&&S.jsx(ux,{className:"text-violet-400",size:32})]}),S.jsx("h2",{className:"text-2xl font-black text-white mb-2 tracking-tight",children:n==="LOGIN"?" ":n==="SIGNUP"?"  ":" "}),S.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"    "})]}),S.jsxs("div",{className:"flex p-1 bg-white/5 rounded-2xl mb-8 relative z-10 border border-white/5 shadow-inner",children:[S.jsx("button",{onClick:()=>{s("LOGIN"),A("")},className:`flex-1 py-3 text-sm font-black rounded-xl transition-all ${n==="LOGIN"||n==="SIGNUP"?"bg-violet-600 text-white shadow-lg shadow-violet-600/20":"text-slate-500 hover:text-white"}`,children:""}),S.jsx("button",{onClick:()=>{s("GUEST"),A("")},className:`flex-1 py-3 text-sm font-black rounded-xl transition-all ${n==="GUEST"?"bg-violet-600 text-white shadow-lg shadow-violet-600/20":"text-slate-500 hover:text-white"}`,children:""})]}),x&&S.jsxs("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-2xl flex items-start gap-3 animate-lux-up",children:[S.jsx(Tk,{className:"text-red-400 shrink-0 mt-0.5",size:18}),S.jsx("p",{className:"text-red-300 text-sm font-bold leading-tight",children:x})]}),S.jsxs("form",{onSubmit:H,className:"space-y-5 flex-1 flex flex-col",children:[n==="GUEST"&&S.jsxs("div",{className:"bg-amber-500/5 border border-amber-500/10 p-4 rounded-2xl mb-2 flex items-start gap-3 text-right",children:[S.jsx(kk,{size:20,className:"text-amber-500 shrink-0 mt-0.5"}),S.jsxs("p",{className:"text-amber-200/80 text-[11px] leading-relaxed font-medium",children:[S.jsx("span",{className:"font-black text-amber-300 block mb-0.5",children:" :"}),"         .     ."]})]}),(n==="SIGNUP"||n==="GUEST")&&S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:n==="GUEST"?"   ":" "}),S.jsxs("div",{className:"relative",children:[S.jsx(lq,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),S.jsx("input",{type:"text",required:!0,value:h,onChange:X=>p(X.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:n==="GUEST"?"   ":" "})]})]}),n!=="GUEST"&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:" "}),S.jsxs("div",{className:"relative",children:[S.jsx(bz,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),S.jsx("input",{type:"email",required:!0,value:a,onChange:X=>l(X.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:"name@example.com"})]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:" "}),S.jsxs("div",{className:"relative",children:[S.jsx(fz,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),S.jsx("input",{type:"password",required:!0,minLength:6,value:c,onChange:X=>d(X.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:""})]})]})]}),n!=="LOGIN"&&S.jsxs("div",{className:"flex items-start gap-3 mt-2 py-2 px-1",children:[S.jsx("input",{type:"checkbox",checked:N,onChange:X=>D(X.target.checked),className:"mt-1 w-5 h-5 rounded-lg border-white/10 accent-emerald-500 cursor-pointer transition-all"}),S.jsxs("label",{className:"text-xs text-slate-500 font-bold text-right leading-relaxed select-none",children:["  ",S.jsx("button",{type:"button",onClick:()=>L(!0),className:"text-emerald-400 underline hover:text-emerald-300 transition-colors",children:"   "}),"   ."]})]}),S.jsxs("div",{className:"mt-auto pt-4",children:[S.jsx(Zt,{type:"submit",fullWidth:!0,disabled:v,className:"py-4 shadow-xl",children:v?S.jsxs("span",{className:"animate-pulse flex items-center gap-2",children:[S.jsx(Nd,{className:"animate-spin",size:18}),"  ..."]}):n==="LOGIN"?"":" "}),n==="LOGIN"&&S.jsx("button",{type:"button",onClick:()=>{s("SIGNUP"),A("")},className:"w-full text-center mt-6 text-emerald-400 hover:text-emerald-300 transition-all font-black text-lg md:text-xl underline decoration-emerald-800 underline-offset-8 decoration-2",children:"      "}),n==="SIGNUP"&&S.jsx("button",{type:"button",onClick:()=>{s("LOGIN"),A("")},className:"w-full text-center mt-6 text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"      "}),n==="GUEST"&&S.jsx("button",{type:"button",onClick:()=>{s("SIGNUP"),A("")},className:"w-full text-center mt-6 text-xs font-bold text-slate-500 hover:text-emerald-400 transition-colors",children:"      "})]})]})]})]})]})};var gq=uR();const mq=()=>{const[i,e]=ue.useState([]),[t,n]=ue.useState(!0),[s,a]=ue.useState(null),[l,c]=ue.useState(null);ue.useEffect(()=>{d();let x;try{x=nr.channel("leaderboard-realtime").on("postgres_changes",{event:"*",schema:"public",table:"quiz_history"},()=>{d()}).subscribe()}catch{console.warn("Realtime subscription failed, falling back to manual fetch only.")}return()=>{x&&nr.removeChannel(x)}},[]);const d=async()=>{try{c(null);const{data:x,error:A}=await nr.from("quiz_history").select("*").order("created_at",{ascending:!1});if(A)throw A;if(!x){e([]);return}const E=new Map;x.forEach(N=>{const D=(N.score||0)*10,P=N.score||0,L=N.total_questions||10,B=N.player_name||" ",H=N.player_avatar||"Felix",O=N.player_university,X=N.player_major,Y=N.player_age;if(E.has(N.user_id)){const se=E.get(N.user_id);E.set(N.user_id,{...se,exp:se.exp+D,quizCount:se.quizCount+1,rawScoreSum:se.rawScoreSum+P,maxScoreSum:se.maxScoreSum+L})}else E.set(N.user_id,{name:B,avatar:H,exp:D,quizCount:1,rawScoreSum:P,maxScoreSum:L,university:O,major:X,age:Y})});const R=Array.from(E.entries()).map(([N,D])=>{const P=D.maxScoreSum>0?Math.round(D.rawScoreSum/D.maxScoreSum*100):0;return{userId:N,name:D.name,avatar:D.avatar,totalExp:D.exp,totalQuizzes:D.quizCount,averageScore:P,university:D.university,major:D.major,age:D.age,rank:0}}).sort((N,D)=>D.totalExp-N.totalExp).slice(0,10).map((N,D)=>({...N,rank:D+1}));e(R)}catch(x){console.error("Leaderboard fetch error:",x),c(x.message==="Failed to fetch"?"  .     .":"     .")}finally{n(!1)}},h=x=>{switch(x){case 1:return"bg-gradient-to-r from-black via-[#0a0a0a] to-[#453a15] border-[#d4af37]/20 shadow-[0_0_20px_rgba(0,0,0,0.5)]";case 2:return"bg-gradient-to-r from-[#0a0a0a] via-[#150a1c] to-[#420a15] border-[#c31432]/20 shadow-lg";case 3:return"bg-gradient-to-r from-[#030712] via-[#051125] to-[#3a3324] border-[#a89166]/20 shadow-lg";default:return"bg-gradient-to-r from-[#18181b] via-[#27272a] to-[#3f3f46] border-white/5 opacity-80 hover:opacity-100 transition-opacity"}},p=x=>["  "," "," "," "," ","  "," "," "," "," "][x-1]||" ",v=x=>["   !    ."," !      .","   !    .","     .  !"," !      .","  !      .","   .   !","    .    .","     .  !","   .    !"][x-1]||"    !",_=x=>x===1?S.jsx(Z6,{size:28,className:"text-yellow-400/80 drop-shadow-[0_0_8px_rgba(250,204,21,0.6)] animate-bounce"}):x===2?S.jsx(fx,{size:24,className:"text-fuchsia-400/80 drop-shadow-[0_0_6px_rgba(192,38,211,0.5)]"}):x===3?S.jsx(Nk,{size:24,className:"text-amber-500/80 drop-shadow-[0_0_6px_rgba(245,158,11,0.5)]"}):S.jsxs("span",{className:`text-lg font-black font-mono ${x<=5?"text-white/80":"text-slate-600"}`,children:["#",x]});return S.jsxs("div",{className:"w-full max-w-4xl mx-auto mt-2 mb-10 px-4",children:[S.jsxs("div",{className:"text-center mb-10 animate-lux-up",children:[S.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-2xl bg-gradient-to-br from-yellow-500/10 to-amber-600/10 text-yellow-500/70 mb-4 border border-yellow-500/20 shadow-[0_0_20px_rgba(234,179,8,0.1)]",children:S.jsx(p0,{size:32})}),S.jsx("h2",{className:"text-3xl md:text-4xl font-black text-white mb-3",children:" "})]}),t?S.jsx("div",{className:"flex justify-center py-10",children:S.jsx(Nd,{className:"animate-spin text-violet-500/50",size:32})}):l?S.jsxs("div",{className:"text-center py-8 bg-red-500/5 border border-red-500/10 rounded-3xl",children:[S.jsx("p",{className:"text-red-400 font-bold mb-4",children:l}),S.jsxs("button",{onClick:()=>{n(!0),d()},className:"flex items-center gap-2 mx-auto text-xs font-black text-slate-400 hover:text-white uppercase tracking-widest bg-white/5 px-4 py-2 rounded-xl transition-all",children:[S.jsx(Oz,{size:14}),"  "]})]}):S.jsx("div",{className:"grid gap-4",children:i.map((x,A)=>S.jsxs("div",{onClick:()=>a(x),className:`relative flex items-center justify-between p-4 md:p-5 rounded-[1.8rem] md:rounded-[2.2rem] border transition-all duration-700 group hover:scale-[1.01] cursor-pointer ${h(x.rank)} animate-lux-up`,style:{animationDelay:`${A*.08}s`},children:[S.jsxs("div",{className:"flex items-center gap-4 md:gap-8",children:[S.jsx("div",{className:"w-10 flex justify-center shrink-0",children:_(x.rank)}),S.jsx("div",{className:"relative",children:S.jsx("div",{className:`w-14 h-14 md:w-16 md:h-16 rounded-full border overflow-hidden bg-black/60 ${x.rank===1?"border-yellow-400/20 ring-4 ring-yellow-400/5":"border-white/5"}`,children:S.jsx("img",{src:`https://api.dicebear.com/9.x/notionists/svg?seed=${x.avatar||"default"}&backgroundColor=b6e3f4,c0aede,d1d4f9`,alt:x.name,className:"w-full h-full object-cover opacity-90"})})}),S.jsxs("div",{children:[S.jsx("h3",{className:`font-black text-base md:text-lg tracking-tight ${x.rank<=5?"text-white/90":"text-slate-400"}`,children:x.name}),S.jsx("p",{className:`text-[10px] font-black uppercase tracking-widest ${x.rank===1?"text-yellow-500/60":"text-slate-500"}`,children:p(x.rank)})]})]}),S.jsxs("div",{className:"flex flex-col items-end shrink-0",children:[S.jsxs("div",{className:"flex items-center gap-1.5",children:[S.jsx("span",{className:`text-xl md:text-2xl font-black font-mono leading-none ${x.rank===1?"text-yellow-500/80":"text-white/80"}`,children:x.totalExp}),S.jsx(Ak,{size:14,className:"text-slate-600"})]}),S.jsx("span",{className:"text-[8px] font-black uppercase tracking-tighter text-slate-700",children:" "})]})]},x.userId))}),s&&gq.createPortal(S.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4",children:[S.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-3xl",onClick:()=>a(null)}),S.jsxs("div",{className:`glass-panel w-[90%] sm:w-full max-w-md rounded-[3rem] relative animate-lux-scale border border-white/10 shadow-[0_0_80px_rgba(0,0,0,1)] overflow-hidden ${h(s.rank)}`,children:[S.jsx("button",{onClick:()=>a(null),className:"absolute top-6 right-6 w-9 h-9 flex items-center justify-center bg-red-500/20 text-red-400 border border-red-500/30 hover:bg-red-500/30 hover:text-red-300 rounded-full transition-all z-20",children:S.jsx(px,{size:22})}),S.jsx("div",{className:"p-8 md:p-10 flex flex-col items-center text-center relative z-10",children:(()=>{const x={1:"text-yellow-400",2:"text-fuchsia-400",3:"text-amber-500"},A=x[s.rank]||"text-white/80",E=x[s.rank]?x[s.rank].replace("400","300"):"text-white/70";return S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"w-32 h-32 rounded-full border-2 shadow-2xl mb-6 overflow-hidden bg-black/80",children:S.jsx("img",{src:`https://api.dicebear.com/9.x/notionists/svg?seed=${s.avatar||"default"}&backgroundColor=b6e3f4,c0aede,d1d4f9`,alt:s.name,className:"w-full h-full object-cover opacity-90"})}),S.jsx("h3",{className:"text-3xl font-black text-white/90 mb-1 tracking-tight",children:s.name}),S.jsx("p",{className:"text-sm font-black text-white/40 mb-8",children:p(s.rank)}),S.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full mb-8 text-center",children:[S.jsxs("div",{className:"bg-black/40 backdrop-blur-md rounded-[2rem] p-6 border border-white/5 flex flex-col items-center",children:[S.jsx("span",{className:`text-3xl font-black ${A}`,children:s.totalQuizzes}),S.jsx("span",{className:"text-[10px] text-white/30 font-bold uppercase tracking-widest",children:" "})]}),S.jsxs("div",{className:"bg-black/40 backdrop-blur-md rounded-[2rem] p-6 border border-white/5 flex flex-col items-center",children:[S.jsxs("span",{className:`text-3xl font-black ${A}`,children:[s.averageScore,"%"]}),S.jsx("span",{className:"text-[10px] text-white/30 font-bold uppercase tracking-widest",children:" "})]})]}),S.jsxs("div",{className:"w-full space-y-3 mb-8",children:[S.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[S.jsx(Iw,{size:20,className:"text-slate-500 shrink-0"}),S.jsxs("div",{className:"text-right",children:[S.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),S.jsx("p",{className:`text-sm font-bold ${E}`,children:s.university||" "})]})]}),S.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[S.jsx(Lw,{size:20,className:"text-slate-500 shrink-0"}),S.jsxs("div",{className:"text-right",children:[S.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),S.jsx("p",{className:`text-sm font-bold ${E}`,children:s.major||" "})]})]}),S.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[S.jsx(Ek,{size:20,className:"text-slate-500 shrink-0"}),S.jsxs("div",{className:"text-right",children:[S.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),S.jsx("p",{className:`text-sm font-bold ${E}`,children:s.age||" "})]})]})]}),S.jsx("div",{className:"w-full text-center px-4 py-4 rounded-2xl bg-black/20 border border-white/5",children:S.jsxs("p",{className:"text-xs italic text-slate-400",children:['"',v(s.rank),'"']})})]})})()})]})]}),document.body)]})},yq=()=>{const[i,e]=ue.useState({quizzes:0,students:125,loading:!0});ue.useEffect(()=>{(async()=>{try{const{count:a,error:l}=await nr.from("quiz_history").select("*",{count:"exact",head:!0}),{data:c,error:d}=await nr.from("quiz_history").select("user_id");if(l||d)throw new Error("Error fetching stats");const h=new Set(c==null?void 0:c.map(p=>p.user_id)).size;e({quizzes:a||0,students:125+h,loading:!1})}catch(a){console.error("Failed to fetch live stats:",a),e(l=>({...l,loading:!1}))}})()},[]);const t=[{label:"  ",value:i.loading?"...":`+${i.quizzes.toLocaleString()}`,icon:S.jsx(g0,{size:20}),color:"text-amber-400",bg:"bg-amber-500/10"},{label:" ",value:i.loading?"...":`+${i.students.toLocaleString()}`,icon:S.jsx(uq,{size:20}),color:"text-violet-400",bg:"bg-violet-500/10"},{label:" ",value:"99.2%",icon:S.jsx(jz,{size:20}),color:"text-emerald-400",bg:"bg-emerald-500/10"}],n=[{title:"  ",desc:"   Gemini        .",icon:S.jsx(Hp,{className:"text-violet-400"})},{title:"  ",desc:"   10   100      .",icon:S.jsx(T6,{className:"text-blue-400"})},{title:"  ",desc:"            .",icon:S.jsx(F6,{className:"text-fuchsia-400"})}];return S.jsxs("div",{className:"w-full max-w-5xl mx-auto mt-16 mb-24 px-4",children:[S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-16",children:t.map((s,a)=>S.jsxs("div",{className:"glass-panel p-6 rounded-[2rem] border border-white/5 flex items-center gap-5 hover:border-white/10 transition-all animate-lux-up",style:{animationDelay:`${a*.1}s`},children:[S.jsx("div",{className:`w-12 h-12 rounded-2xl ${s.bg} ${s.color} flex items-center justify-center shrink-0`,children:i.loading&&a<2?S.jsx(Nd,{size:18,className:"animate-spin"}):s.icon}),S.jsxs("div",{children:[S.jsx("p",{className:"text-2xl font-black text-white leading-none mb-1",children:s.value}),S.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:s.label})]})]},a))}),S.jsxs("div",{className:"relative",children:[S.jsx("div",{className:"absolute inset-0 bg-violet-600/5 blur-[100px] rounded-full pointer-events-none"}),S.jsxs("div",{className:"text-center mb-12 animate-lux-up",children:[S.jsx("h2",{className:"text-3xl font-black text-white mb-3",children:"   "}),S.jsx("div",{className:"h-1 w-20 bg-gradient-to-r from-violet-600 to-fuchsia-600 mx-auto rounded-full"})]}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 relative z-10",children:n.map((s,a)=>S.jsxs("div",{className:"group glass-panel p-8 rounded-[2.5rem] border border-white/5 hover:border-violet-500/30 transition-all animate-lux-up",style:{animationDelay:`${(a+3)*.1}s`},children:[S.jsx("div",{className:"w-14 h-14 rounded-2xl bg-white/5 flex items-center justify-center mb-6 group-hover:scale-110 group-hover:bg-violet-500/10 transition-all duration-500",children:L0.cloneElement(s.icon,{size:28})}),S.jsx("h3",{className:"text-xl font-bold text-white mb-3 group-hover:text-violet-300 transition-colors",children:s.title}),S.jsx("p",{className:"text-sm text-slate-500 leading-relaxed font-medium",children:s.desc})]},a))})]}),S.jsx("div",{className:"mt-16 glass-panel p-1 border-white/5 rounded-[2rem] overflow-hidden animate-lux-up",style:{animationDelay:"0.8s"},children:S.jsxs("div",{className:"bg-gradient-to-r from-violet-900/20 via-black to-fuchsia-900/20 p-8 rounded-[1.9rem] flex flex-col items-center text-center",children:[S.jsx(fx,{className:"text-yellow-500/50 mb-4 animate-pulse",size:32,fill:"currentColor"}),S.jsx("p",{className:"text-xl md:text-2xl font-medium text-slate-300 italic leading-relaxed",children:'"      ."'}),S.jsx("p",{className:"mt-4 text-xs font-black text-violet-400 uppercase tracking-widest",children:"  "})]})})]})},vq=({onNavigate:i,onLogActivity:e})=>{const[t,n]=ue.useState("selection");ue.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[t]);const[s,a]=ue.useState(""),[l,c]=ue.useState(""),[d,h]=ue.useState(""),[p,v]=ue.useState(null),[_,x]=ue.useState(""),[A,E]=ue.useState("100to4"),[R,N]=ue.useState(null),[D,P]=ue.useState(""),[L,B]=ue.useState(""),[H,O]=ue.useState([{id:"1",grade:"",hours:"3",isRepeated:!1,isExcluded:!1},{id:"2",grade:"",hours:"3",isRepeated:!1,isExcluded:!1},{id:"3",grade:"",hours:"3",isRepeated:!1,isExcluded:!1},{id:"4",grade:"",hours:"3",isRepeated:!1,isExcluded:!1}]),[X,Y]=ue.useState(null),se=()=>{O([...H,{id:Date.now().toString(),grade:"",hours:"3",isRepeated:!1,isExcluded:!1}])},re=te=>{H.length>1&&O(H.filter(le=>le.id!==te))},ne=(te,le)=>{O(H.map(U=>U.id===te?{...U,...le}:U))},be=()=>{const te=parseFloat(s),le=parseFloat(l),U=parseFloat(d);if(isNaN(te)||isNaN(le)||isNaN(U)){v({type:"error",message:"    "});return}const K=te*.45+le*.1,ie=(U-K)/.45;ie<0?v({type:"error",message:"    "}):(v({type:"success",message:"   :",value:ie.toFixed(2)}),e==null||e("  "))},ye=()=>{const te=parseFloat(_);if(isNaN(te)){N(null);return}if(A==="100to4"){if(te>100||te<0){N({type:"error",message:"     0  100"});return}let le="0.00",U="";te>=97?(le="4.00",U=" "):te>=50&&(le=(2.14+(te-50)*.04).toFixed(2),te>=90?U="":te>=80?U=" ":te>=70?U="":te>=60?U="":U=""),N({type:"success",message:"  4.00 :",value:le,label:U}),e==null||e("  (100  4)")}else{if(te>4||te<0){N({type:"error",message:"     0.00  4.00"});return}let le="< 50",U="";if(te>=4)le="97",U=" ";else if(te>=2.14){const K=Math.min(96,Math.round((te-2.14)/.04+50));le=K.toString(),K>=90?U="":K>=80?U=" ":K>=70?U="":K>=60?U="":U=""}N({type:"success",message:"  :",value:le,label:U}),e==null||e("  (4  100)")}},ze=()=>{let te=(parseFloat(D)||0)*(parseFloat(L)||0),le=parseFloat(L)||0;H.forEach(U=>{const K=parseFloat(U.grade),ie=parseFloat(U.hours),oe=parseFloat(U.oldGrade||"");isNaN(K)||isNaN(ie)||ie<=0||U.isExcluded||K<60||(U.isRepeated?(!isNaN(oe)&&oe>=60&&(te-=oe*ie),te+=K*ie,(isNaN(oe)||oe<60)&&(le+=ie)):(te+=K*ie,le+=ie))}),Y({gpa:le>0?(te/le).toFixed(2):"0.00",hours:le}),e==null||e("  ")},G=()=>{const te=()=>{switch(t){case"final_calc":return"  ";case"gpa_calc":return" ";case"cumulative_gpa_100":return" ";default:return""}};return S.jsxs("div",{className:"flex items-center gap-2 mb-4 sm:mb-6 text-[10px] sm:text-xs font-bold text-slate-500 overflow-x-auto whitespace-nowrap py-2",dir:"rtl",children:[S.jsxs("button",{onClick:()=>i(Te.HOME),className:"flex items-center gap-1 hover:text-white transition-colors",children:[S.jsx(hx,{size:14})," "]}),S.jsx(Dw,{size:12,className:"shrink-0 opacity-40"}),S.jsx("button",{onClick:()=>n("selection"),className:`hover:text-white transition-colors ${t==="selection"?"text-violet-400":""}`,children:" "}),t!=="selection"&&S.jsxs(S.Fragment,{children:[S.jsx(Dw,{size:12,className:"shrink-0 opacity-40"}),S.jsx("span",{className:"text-white bg-violet-500/10 px-2 py-0.5 rounded-md border border-violet-500/20",children:te()})]})]})},W=()=>S.jsxs("div",{className:"animate-fade-in space-y-10",children:[S.jsxs("div",{className:"text-center mb-12",children:[S.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-2xl bg-violet-500/10 text-violet-400 mb-6 border border-violet-500/20 shadow-xl",children:S.jsx(g0,{size:32})}),S.jsx("h2",{className:"text-3xl md:text-5xl font-black text-white mb-4 tracking-tight",children:"  "}),S.jsx("p",{className:"text-slate-500 text-sm max-w-xl mx-auto font-medium",children:"        ."})]}),S.jsx("div",{className:"max-w-5xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[{id:"final_calc",title:"  ",desc:"    .",icon:S.jsx(D6,{}),color:"violet",view:"final_calc"},{id:"gpa_calc",title:"  ",desc:"   100%  4.0.",icon:S.jsx(x6,{}),color:"emerald",view:"gpa_calc"},{id:"cumulative_gpa_100",title:"  ",desc:"    .",icon:S.jsx(kz,{}),color:"blue",view:"cumulative_gpa_100"}].map(te=>S.jsxs("div",{onClick:()=>n(te.view),className:"glass-panel group p-6 rounded-[2rem] bg-[#080808] border border-white/5 hover:border-white/20 cursor-pointer transition-all flex flex-col items-center text-center h-full",children:[S.jsx("div",{className:`w-12 h-12 bg-${te.color}-500/10 rounded-xl flex items-center justify-center text-${te.color}-400 mb-4 group-hover:scale-110 transition-transform`,children:L0.cloneElement(te.icon,{size:24})}),S.jsx("h3",{className:"text-sm font-bold text-white mb-2 leading-tight px-2",children:te.title}),S.jsx("p",{className:"text-slate-500 text-[10px] leading-relaxed mb-5",children:te.desc}),S.jsxs("div",{className:"mt-auto w-full flex items-center justify-center gap-2 py-2.5 rounded-xl bg-white/5 group-hover:bg-white/10 transition-all text-[10px] font-black uppercase tracking-widest text-slate-400",children:["  ",S.jsx(_6,{size:14})]})]},te.id))})]}),he=()=>S.jsxs("div",{className:"animate-fade-in space-y-6",children:[S.jsx("div",{className:"flex items-center justify-between mb-4",children:S.jsx("div",{className:"text-[9px] font-black text-blue-400 uppercase tracking-[0.2em] bg-blue-500/5 px-3 py-1 rounded-full border border-blue-500/10",children:"   (100%)"})}),S.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start text-right",children:[S.jsx("div",{className:"lg:col-span-7",children:S.jsxs("div",{className:"glass-panel p-6 rounded-[2.5rem] bg-[#080808] border border-white/10 shadow-2xl relative overflow-hidden space-y-8",children:[S.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-600 to-indigo-600"}),S.jsxs("div",{children:[S.jsxs("h3",{className:"text-base font-bold text-white mb-2 flex items-center gap-2 justify-end",children:["  ",S.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/10 text-blue-400 rounded-full",children:""})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-black/20 p-4 rounded-2xl border border-white/5",children:[S.jsxs("div",{className:"space-y-1",children:[S.jsx("label",{className:"text-[10px] font-bold text-slate-400 mr-1 block",children:"  "}),S.jsx("input",{type:"number",step:"0.01",value:D,onChange:te=>P(te.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-xl py-3 px-4 text-white font-bold text-sm text-right focus:border-blue-500 outline-none",placeholder:"85.50"})]}),S.jsxs("div",{className:"space-y-1",children:[S.jsx("label",{className:"text-[10px] font-bold text-slate-400 mr-1 block",children:" "}),S.jsx("input",{type:"number",value:L,onChange:te=>B(te.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-xl py-3 px-4 text-white font-bold text-sm text-right focus:border-blue-500 outline-none",placeholder:"60"})]})]})]}),S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("button",{onClick:se,className:"p-2 bg-blue-500/10 text-blue-400 rounded-lg border border-blue-500/20 hover:bg-blue-500/20",children:S.jsx(Mk,{size:16})}),S.jsxs("h3",{className:"text-base font-bold text-white flex items-center gap-2",children:["   ",S.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/10 text-blue-400 rounded-full",children:""})]})]}),H.map(te=>S.jsxs("div",{className:"p-4 rounded-2xl bg-white/[0.02] border border-white/5 space-y-4 transition-all",children:[S.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[S.jsxs("div",{className:"col-span-2",children:[S.jsx("label",{className:"text-[10px] font-bold text-amber-400 block mb-1 text-right",children:""}),S.jsxs("div",{className:"relative",children:[S.jsx(dx,{size:14,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500"}),S.jsx("input",{type:"number",value:te.grade,onChange:le=>ne(te.id,{grade:le.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-lg py-2.5 pr-9 text-white text-xs text-right",placeholder:" 100"})]})]}),S.jsxs("div",{className:"col-span-2",children:[S.jsx("label",{className:"text-[10px] font-bold text-amber-400 block mb-1 text-right",children:""}),S.jsxs("div",{className:"relative",children:[S.jsx(Rk,{size:14,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500"}),S.jsx("input",{type:"number",value:te.hours,onChange:le=>ne(te.id,{hours:le.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-lg py-2.5 pr-9 text-white text-xs text-right",placeholder:"3"})]})]}),S.jsx("div",{className:"col-span-1 flex items-end",children:S.jsx("button",{onClick:()=>re(te.id),className:"w-full h-10 text-red-500/40 hover:text-red-500 flex justify-center items-center bg-black/40 border border-white/5 rounded-lg",children:S.jsx(Qz,{size:16})})})]}),te.isRepeated&&S.jsxs("div",{className:"pt-3 border-t border-white/10 animate-fade-in",children:[S.jsxs("label",{className:"text-[10px] font-bold text-amber-400 block mb-1 text-right flex items-center gap-1.5 justify-end",children:[S.jsx(lR,{size:12}),"  "]}),S.jsxs("div",{className:"relative",children:[S.jsx(lR,{size:14,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500"}),S.jsx("input",{type:"number",value:te.oldGrade||"",onChange:le=>ne(te.id,{oldGrade:le.target.value}),className:"w-full bg-black/40 border border-amber-500/20 rounded-lg py-2.5 pr-9 text-white text-xs text-right",placeholder:"  "})]})]}),S.jsxs("div",{className:"flex justify-end gap-4 pt-3 border-t border-white/5",children:[S.jsxs("label",{className:"flex items-center gap-2 text-[10px] text-slate-400 font-bold cursor-pointer",children:["  ",S.jsx("input",{type:"checkbox",checked:te.isRepeated,onChange:le=>ne(te.id,{isRepeated:le.target.checked,oldGrade:""}),className:"w-4 h-4 accent-amber-500"})]}),S.jsxs("label",{className:"flex items-center gap-2 text-[10px] text-slate-400 font-bold cursor-pointer",children:["   ",S.jsx("input",{type:"checkbox",checked:te.isExcluded,onChange:le=>ne(te.id,{isExcluded:le.target.checked}),className:"w-4 h-4 accent-slate-500"})]})]})]},te.id))]}),S.jsx(Zt,{onClick:ze,fullWidth:!0,className:"!bg-blue-600 hover:!bg-blue-500 shadow-xl shadow-blue-900/30 !py-4",children:" "}),X&&S.jsxs("div",{className:"p-6 rounded-3xl bg-emerald-500/5 border border-emerald-500/10 text-center animate-fade-in",children:[S.jsx("p",{className:"text-[10px] font-bold text-emerald-400/60 mb-1 uppercase tracking-widest",children:"  "}),S.jsx("p",{className:"text-5xl font-black text-white italic",children:X.gpa}),S.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["  : ",S.jsx("span",{className:"font-bold text-white",children:X.hours})]})]})]})}),S.jsxs("div",{className:"lg:col-span-5 space-y-6",children:[S.jsxs("div",{className:"glass-panel p-6 rounded-3xl bg-white/[0.02] border border-white/5",children:[S.jsxs("h3",{className:"text-base font-bold text-white mb-4 flex items-center gap-3 justify-end",children:[S.jsx(oz,{size:18,className:"text-blue-400"}),"   "]}),S.jsxs("div",{className:"space-y-4 text-xs text-slate-400 leading-relaxed border-t border-white/5 pt-4",children:[S.jsxs("p",{children:[S.jsx("strong",{className:"font-black text-blue-300",children:":"}),"         ."]}),S.jsxs("p",{children:[S.jsx("strong",{className:"font-black text-blue-300",children:":"}),"         (    )."]}),S.jsxs("p",{children:[S.jsx("strong",{className:"font-black text-blue-300",children:":"}),"     .      ."]})]})]}),S.jsxs("div",{className:"glass-panel p-6 rounded-3xl bg-white/[0.02] border border-white/5",children:[S.jsxs("h3",{className:"text-base font-bold text-white mb-4 flex items-center gap-3 justify-end",children:[S.jsx(Ck,{size:18,className:"text-amber-400"}),"  "]}),S.jsxs("div",{className:"space-y-3 text-xs text-slate-400 leading-relaxed border-t border-white/5 pt-4",children:[S.jsxs("p",{children:[S.jsx("strong",{className:"font-black text-amber-300",children:" :"}),"                  ."]}),S.jsxs("p",{children:[S.jsx("strong",{className:"font-black text-amber-300",children:"  :"}),"           ."]})]})]})]})]})]});return S.jsx("div",{className:"min-h-screen pt-20 sm:pt-28 pb-20 relative z-10 px-4",children:S.jsxs("div",{className:"max-w-6xl mx-auto",children:[S.jsx(G,{}),t==="selection"&&W(),t==="final_calc"&&S.jsx("div",{className:"animate-fade-in max-w-lg mx-auto space-y-6",children:S.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#080808] border border-white/10 shadow-2xl space-y-6 text-right",children:[S.jsx("h3",{className:"text-xl font-black text-white",children:"  "}),S.jsx("input",{type:"number",value:s,onChange:te=>a(te.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:"  (100)"}),S.jsx("input",{type:"number",value:l,onChange:te=>c(te.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:"  (100)"}),S.jsx("input",{type:"number",value:d,onChange:te=>h(te.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:"   "}),S.jsx(Zt,{onClick:be,fullWidth:!0,children:" "}),p&&S.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl text-center",children:[S.jsx("p",{className:"text-xs text-slate-400",children:p.message}),S.jsx("p",{className:"text-3xl font-black text-white mt-1",children:p.value})]})]})}),t==="gpa_calc"&&S.jsx("div",{className:"animate-fade-in max-w-lg mx-auto space-y-6",children:S.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#080808] border border-white/10 shadow-2xl space-y-6 text-right",children:[S.jsxs("div",{className:"flex bg-white/5 p-1 rounded-xl",children:[S.jsx("button",{onClick:()=>E("100to4"),className:`flex-1 py-2 rounded-lg text-xs font-bold ${A==="100to4"?"bg-emerald-600 text-white":"text-slate-500"}`,children:"100  4"}),S.jsx("button",{onClick:()=>E("4to100"),className:`flex-1 py-2 rounded-lg text-xs font-bold ${A==="4to100"?"bg-emerald-600 text-white":"text-slate-500"}`,children:"4  100"})]}),S.jsx("input",{type:"number",step:"0.01",value:_,onChange:te=>x(te.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white text-right font-bold",placeholder:A==="100to4"?"  100":"  4.00"}),S.jsx(Zt,{onClick:ye,fullWidth:!0,className:"!bg-emerald-600",children:""}),R&&(R.type==="error"?S.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-xl text-center text-red-400 text-xs font-bold",children:R.message}):S.jsxs("div",{className:"p-6 bg-emerald-500/5 border border-emerald-500/10 rounded-3xl text-center",children:[S.jsx("p",{className:"text-xs text-emerald-500/60 mb-1",children:R.message}),S.jsx("p",{className:"text-5xl font-black text-white italic",children:R.value}),S.jsx("p",{className:"text-[10px] font-black text-emerald-400 mt-2 uppercase tracking-widest",children:R.label})]})),S.jsxs("div",{className:"pt-4 border-t border-white/5 grid grid-cols-2 gap-2 text-[9px] text-slate-600 text-center",children:[S.jsx("span",{children:"90+:  (3.74+)"}),S.jsx("span",{children:"80-89:   (3.34+)"}),S.jsx("span",{children:"70-79:  (2.94+)"}),S.jsx("span",{children:"60-69:  (2.54+)"})]})]})}),t==="cumulative_gpa_100"&&he()]})})},vm=()=>{const[i,e]=ue.useState(!1),t=ue.useRef(null);return ue.useEffect(()=>{const n=new IntersectionObserver(([s])=>{s.isIntersecting&&(e(!0),n.unobserve(s.target))},{threshold:.1,rootMargin:"0px 0px -50px 0px"});return t.current&&n.observe(t.current),()=>{t.current&&n.unobserve(t.current)}},[]),{ref:t,isVisible:i}},bq=({onNavigate:i})=>{const e=vm(),t=vm(),n=vm(),s=vm(),a=()=>S.jsxs("div",{className:"flex items-center gap-2 mb-8 text-[10px] sm:text-xs font-bold text-slate-500 overflow-x-auto whitespace-nowrap py-2",dir:"rtl",children:[S.jsxs("button",{onClick:()=>i(Te.HOME),className:"flex items-center gap-1 hover:text-white transition-colors",children:[S.jsx(hx,{size:14})," "]}),S.jsx(Dw,{size:12,className:"shrink-0 opacity-40"}),S.jsx("span",{className:"text-white bg-violet-500/10 px-2 py-0.5 rounded-md border border-violet-500/20",children:" "})]});return S.jsxs("div",{className:"min-h-screen pt-20 sm:pt-28 pb-32 px-4 relative z-10 bg-[#000000] text-right overflow-x-hidden",dir:"rtl",children:[S.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none",children:[S.jsx("div",{className:"absolute top-[-10%] left-[20%] w-[80vw] h-[80vw] bg-violet-600/10 rounded-full blur-[120px]"}),S.jsx("div",{className:"absolute bottom-[-5%] right-[-10%] w-[60vw] h-[60vw] bg-fuchsia-600/10 rounded-full blur-[100px]"})]}),S.jsxs("div",{className:"max-w-6xl mx-auto relative z-10",children:[S.jsxs("div",{className:"flex items-center justify-between mb-8 animate-lux-up",children:[S.jsx(a,{}),S.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 px-4 py-2 rounded-full bg-[#0f172a]/50 border border-violet-500/20 shadow-[0_0_20px_rgba(139,92,246,0.15)] backdrop-blur-xl",children:[S.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-violet-500 animate-pulse"}),S.jsx("span",{className:"text-[9px] sm:text-[11px] font-black text-violet-100 tracking-widest",children:" "})]})]}),S.jsxs("div",{ref:e.ref,className:`grid grid-cols-1 lg:grid-cols-2 gap-12 items-center mb-24 transition-all duration-1000 transform ${e.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-12"}`,children:[S.jsxs("div",{className:"text-right space-y-6 sm:space-y-8",children:[S.jsx("div",{className:"space-y-4",children:S.jsxs("h1",{className:"text-4xl sm:text-6xl md:text-8xl font-black text-white leading-tight tracking-tighter",children:[" ",S.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-400 to-blue-400",children:""})," ",S.jsx("br",{})," ."]})}),S.jsxs("p",{className:"text-slate-400 text-base sm:text-lg md:text-xl leading-relaxed max-w-xl font-medium",children:[" ",S.jsx("span",{className:"text-white font-bold italic",children:" "}),"   ",S.jsx("span",{className:"text-violet-400 font-bold",children:"  "}),".            ."]}),S.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-4",children:[S.jsxs("a",{href:"https://wa.me/962790000000",target:"_blank",className:"px-8 py-4 bg-gradient-to-r from-violet-600 to-fuchsia-600 rounded-2xl text-white font-black flex items-center justify-center gap-3 hover:shadow-[0_0_30px_rgba(139,92,246,0.4)] transition-all transform hover:-translate-y-1 active:scale-95 text-sm sm:text-base",children:[S.jsx(oR,{size:20}),"  "]}),S.jsx("button",{className:"px-8 py-4 bg-white/5 border border-white/10 rounded-2xl text-slate-300 font-black hover:bg-white/10 transition-all text-sm sm:text-base",children:" "})]})]}),S.jsx("div",{className:"relative order-first lg:order-last overflow-hidden sm:overflow-visible",children:S.jsxs("div",{className:"relative aspect-square w-full max-w-[280px] sm:max-w-lg mx-auto flex items-center justify-center",children:[S.jsx("div",{className:"absolute w-24 h-24 sm:w-32 sm:h-32 bg-violet-600/20 rounded-full blur-[40px] sm:blur-[60px] animate-pulse"}),S.jsxs("svg",{viewBox:"0 0 200 200",className:"w-full h-full relative z-10 overflow-visible",children:[S.jsx("defs",{children:S.jsxs("radialGradient",{id:"grad1",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%",children:[S.jsx("stop",{offset:"0%",style:{stopColor:"#8b5cf6",stopOpacity:.4}}),S.jsx("stop",{offset:"100%",style:{stopColor:"transparent",stopOpacity:0}})]})}),S.jsx("g",{className:"animate-spin",style:{transformOrigin:"center",animationDuration:"60s"},children:[...Array(15)].map((l,c)=>{const d=c/15*Math.PI*2,h=60+Math.random()*30,p=100+Math.cos(d)*h,v=100+Math.sin(d)*h;return S.jsx("circle",{cx:p,cy:v,r:Math.random()*1,fill:"white",className:"animate-pulse",style:{animationDelay:`${c*.3}s`}},c)})}),S.jsx("circle",{cx:"100",cy:"100",r:"45",fill:"none",stroke:"url(#grad1)",strokeWidth:"0.5",className:"animate-pulse"}),S.jsx("circle",{cx:"100",cy:"100",r:"65",fill:"none",stroke:"#8b5cf6",strokeWidth:"0.2",strokeDasharray:"4,10",className:"opacity-40"})]}),S.jsx("div",{className:"absolute top-1/4 right-[10%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-violet-400 shadow-[0_0_20px_rgba(139,92,246,0.3)] animate-bounce",style:{animationDuration:"4.5s"},children:S.jsx(X6,{size:24})}),S.jsx("div",{className:"absolute bottom-[20%] left-[5%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-fuchsia-400 shadow-[0_0_20px_rgba(217,70,239,0.3)] animate-bounce",style:{animationDuration:"5.5s",animationDelay:"1.2s"},children:S.jsx(Kz,{size:24})}),S.jsx("div",{className:"absolute top-[45%] left-[-5%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-blue-400 shadow-[0_0_20px_rgba(59,130,246,0.3)] animate-bounce",style:{animationDuration:"6.5s",animationDelay:"2.5s"},children:S.jsx(Sz,{size:24})}),S.jsx("div",{className:"absolute w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-violet-500/10 to-transparent rounded-full flex items-center justify-center border border-white/5 backdrop-blur-sm",children:S.jsx(aR,{size:28,className:"text-white/80 animate-pulse"})})]})})]}),S.jsxs("div",{ref:t.ref,className:`mb-12 flex flex-col md:flex-row md:items-end justify-between gap-6 transition-all duration-1000 transform ${t.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:[S.jsxs("div",{className:"text-right",children:[S.jsx("h3",{className:"text-2xl sm:text-3xl font-black text-white mb-2",children:" "}),S.jsx("p",{className:"text-yellow-400 text-sm sm:text-base font-bold mb-3",children:"       "}),S.jsx("div",{className:"h-1.5 w-32 bg-gradient-to-r from-violet-600 via-fuchsia-500 to-transparent rounded-full"})]}),S.jsx("p",{className:"text-slate-500 text-[9px] sm:text-[10px] font-bold uppercase tracking-[0.3em]",children:"Etqan Excellence Solutions"})]}),S.jsx("div",{ref:n.ref,className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-24",children:[{icon:S.jsx(Cz,{className:"text-violet-400"}),title:"  ",subtitle:"Premium Web Experiences",desc:S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{children:"     (Portfolios)       ."}),S.jsxs("div",{className:"text-yellow-400 font-bold text-[11px] sm:text-xs bg-yellow-400/5 p-3 rounded-xl border border-yellow-400/10",children:[S.jsx("p",{className:"mb-2 opacity-80 border-b border-yellow-400/20 pb-1 inline-block",children:":"}),S.jsxs("ul",{className:"space-y-1",children:[S.jsx("li",{children:"   "}),S.jsx("li",{children:"   "}),S.jsx("li",{children:"    "})]})]})]}),tags:["React","Tailwind","Motion"],color:"violet"},{icon:S.jsx(aR,{className:"text-blue-400"}),title:"  ",subtitle:"Academic & Enterprise Solutions",desc:"            .",tags:["Architecture","Database","AI"],color:"blue"}].map((l,c)=>S.jsx(_q,{index:c,icon:l.icon,title:l.title,subtitle:l.subtitle,desc:l.desc,tags:l.tags,color:l.color,isVisible:n.isVisible},c))}),S.jsxs("div",{ref:s.ref,className:`glass-panel p-8 sm:p-16 rounded-[2.5rem] sm:rounded-[3rem] bg-gradient-to-br from-[#0a0a0a] via-[#050505] to-[#111] border border-white/5 relative overflow-hidden text-center transition-all duration-1000 transform shadow-2xl ${s.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-12"}`,children:[S.jsx("div",{className:"absolute -top-24 -left-24 w-64 h-64 bg-violet-600/10 rounded-full blur-[100px] pointer-events-none"}),S.jsx("div",{className:"absolute -bottom-24 -right-24 w-64 h-64 bg-fuchsia-600/10 rounded-full blur-[100px] pointer-events-none"}),S.jsxs("div",{className:"relative z-10 space-y-6 sm:space-y-8",children:[S.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 sm:w-16 sm:h-16 rounded-2xl bg-white/5 border border-white/10 mb-2",children:S.jsx(Hz,{className:"text-violet-500 animate-pulse",size:28})}),S.jsx("h2",{className:"text-3xl sm:text-5xl font-black text-white tracking-tight",children:"   "}),S.jsx("p",{className:"text-slate-400 text-base sm:text-lg max-w-2xl mx-auto font-medium px-4",children:"        .   ."}),S.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 pt-6 px-4",children:[S.jsxs("a",{href:"https://wa.me/962790000000",className:"w-full sm:w-auto px-10 py-4 bg-emerald-600 hover:bg-emerald-500 rounded-2xl text-white font-black flex items-center justify-center gap-3 transition-all shadow-xl shadow-emerald-900/20 text-sm sm:text-base",children:[S.jsx(oR,{size:22}),"   "]}),S.jsx("button",{className:"w-full sm:w-auto px-10 py-4 bg-white/5 border border-white/10 rounded-2xl text-slate-300 font-black hover:bg-white/10 transition-all text-sm sm:text-base",children:"  "})]})]})]}),S.jsxs("div",{className:"mt-20 text-center space-y-4 px-4 pb-12",children:[S.jsxs("div",{className:"flex items-center justify-center gap-4 sm:gap-6 text-slate-600",children:[S.jsx("div",{className:"w-6 sm:w-8 h-px bg-white/5"}),S.jsx("span",{className:"text-[9px] sm:text-[10px] font-black uppercase tracking-[0.3em] whitespace-nowrap",children:"Etqan Group Jordan"}),S.jsx("div",{className:"w-6 sm:w-8 h-px bg-white/5"})]}),S.jsx("p",{className:"text-[9px] sm:text-[10px] font-bold text-slate-700",children:"      2024"})]})]})]})},_q=({index:i,icon:e,title:t,subtitle:n,desc:s,tags:a,color:l,isVisible:c})=>{const d={violet:"text-violet-400",fuchsia:"text-fuchsia-400",blue:"text-blue-400",emerald:"text-emerald-400",amber:"text-amber-400",rose:"text-rose-400"};return S.jsxs("div",{className:`group glass-panel p-6 sm:p-8 rounded-[2rem] sm:rounded-[2.5rem] bg-[#050505] border backdrop-blur-xl transition-all duration-700 hover:-translate-y-2 flex flex-col h-full relative overflow-hidden transform ${c?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,style:{transitionDelay:`${i*150}ms`},children:[S.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"}),S.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-2xl bg-white/5 flex items-center justify-center mb-5 sm:mb-6 group-hover:scale-110 transition-transform duration-500",children:L0.cloneElement(e,{size:24})}),S.jsxs("div",{className:"mb-2",children:[S.jsx("h3",{className:"text-lg sm:text-xl font-black text-white mb-1 group-hover:text-white transition-colors",children:t}),S.jsx("p",{className:`text-[9px] sm:text-[10px] font-black uppercase tracking-widest ${d[l]} opacity-70`,children:n})]}),S.jsx("div",{className:"text-slate-500 text-xs sm:text-sm leading-relaxed mb-6 sm:mb-8 flex-1 font-medium",children:s}),S.jsx("div",{className:"flex flex-wrap gap-2",children:a.map((h,p)=>S.jsx("span",{className:"px-2.5 py-1 rounded-lg bg-white/5 border border-white/5 text-[8px] sm:text-[9px] font-bold text-slate-400 uppercase tracking-wider",children:h},p))}),S.jsx("div",{className:"absolute -bottom-10 -right-10 w-20 h-20 sm:w-24 sm:h-24 rounded-full blur-[30px] sm:blur-[40px] opacity-0 group-hover:opacity-20 transition-opacity bg-current"})]})},qb=["Felix","Joshua","Nolan","Liam","Caleb","Mason","Jack","Ethan","Aiden","Leo","Aneka","Selena","Molly","Sophia","Zoe","Lily","Maya","Chloe","Ruby","Eva"],Vb=i=>`https://api.dicebear.com/9.x/notionists/svg?seed=${i}&backgroundColor=b6e3f4,c0aede,d1d4f9`,$b=({src:i,alt:e,className:t})=>{const[n,s]=ue.useState(!1);return S.jsxs("div",{className:`relative overflow-hidden bg-white/5 ${t}`,children:[!n&&S.jsx("div",{className:"absolute inset-0 bg-white/5 z-10 flex items-center justify-center"}),S.jsx("img",{src:i,alt:e,loading:"lazy",onLoad:()=>s(!0),className:`w-full h-full object-cover transition-opacity duration-300 ${n?"opacity-100":"opacity-0"}`})]})},wq=({user:i,quizHistory:e,onLogout:t,onSaveProfile:n,onNavigate:s})=>{const[a,l]=ue.useState(!1),[c,d]=ue.useState(!1),h=(i==null?void 0:i.user_metadata)||{};ue.useEffect(()=>{a&&window.scrollTo({top:0,behavior:"smooth"})},[a]);const p=ue.useMemo(()=>{const ne=e.reduce((te,le)=>te+le.score*10,0),be=e.length>0?Math.round(e.reduce((te,le)=>te+le.score/le.total_questions,0)/e.length*100):0;let ye=1,ze=200,G=0;ne>=2e3?(ye=5,ze=5e3,G=2e3):ne>=1e3?(ye=4,ze=2e3,G=1e3):ne>=500?(ye=3,ze=1e3,G=500):ne>=200&&(ye=2,ze=500,G=200);const W=Math.min(100,Math.max(0,(ne-G)/(ze-G)*100)),he=[{id:"first",icon:S.jsx(Hp,{}),title:" ",earned:e.length>=1,desc:"  "},{id:"master",icon:S.jsx(p0,{}),title:"",earned:e.length>=5,desc:" 5 "},{id:"exp",icon:S.jsx(g0,{}),title:" ",earned:ne>=500,desc:" 500  "},{id:"perfect",icon:S.jsx(Nk,{}),title:" ",earned:e.some(te=>te.score===te.total_questions),desc:"   100%"}];return{totalExp:ne,avgScore:be,level:ye,nextLevelXp:ze,progress:W,achievements:he}},[e]),[v,_]=ue.useState(h.full_name||""),[x,A]=ue.useState(h.gender||"male"),[E,R]=ue.useState(h.age||"18-22"),[N,D]=ue.useState(h.avatar||qb[0]),[P,L]=ue.useState(h.university||""),[B,H]=ue.useState(h.major||""),[O,X]=ue.useState(h.academic_year||"1"),Y=async()=>{d(!0),await n({full_name:v,gender:x,avatar:N,university:P,major:B,academic_year:O,age:E}),d(!1),l(!1)},se=ne=>{if(!ne)return" ";const be=new Date(ne);return new Intl.DateTimeFormat("ar-EG",{year:"numeric",month:"numeric",day:"numeric"}).format(be)},re=["  18","18-22","23-25","  25"];return S.jsx("div",{className:"min-h-screen pt-24 pb-20 px-4 md:px-6 relative z-10 bg-[#0A192F] animate-lux-up",children:S.jsx("div",{className:"max-w-7xl mx-auto",children:a?S.jsx("div",{className:"glass-panel p-8 rounded-3xl border border-blue-900/80 bg-[#112240] animate-lux-scale",children:S.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10",children:[S.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[S.jsxs("div",{children:[S.jsxs("h3",{className:"text-lg font-bold text-slate-200 mb-4 flex items-center gap-2 border-b border-blue-900/80 pb-2",children:[S.jsx(aq,{className:"text-amber-400",size:20}),"  "]}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[S.jsxs("div",{children:[S.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:" "}),S.jsx("input",{type:"text",value:v,onChange:ne=>_(ne.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 px-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all",placeholder:" "})]}),S.jsxs("div",{children:[S.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:""}),S.jsx("select",{value:E,onChange:ne=>R(ne.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 px-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all appearance-none",children:re.map(ne=>S.jsx("option",{children:ne},ne))})]}),S.jsxs("div",{className:"md:col-span-2",children:[S.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:""}),S.jsxs("div",{className:"flex bg-black/30 p-1 rounded-xl border border-blue-900/80",children:[S.jsx("button",{onClick:()=>A("male"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${x==="male"?"bg-blue-600 text-white":"text-slate-500 hover:text-white"}`,children:""}),S.jsx("button",{onClick:()=>A("female"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${x==="female"?"bg-pink-600 text-white":"text-slate-500 hover:text-white"}`,children:""})]})]})]})]}),S.jsxs("div",{children:[S.jsxs("h3",{className:"text-lg font-bold text-slate-200 mb-4 flex items-center gap-2 border-b border-blue-900/80 pb-2",children:[S.jsx(dx,{className:"text-amber-400",size:20}),"  "]}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[S.jsxs("div",{children:[S.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:" / "}),S.jsxs("div",{className:"relative",children:[S.jsx(Iw,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:16}),S.jsx("input",{type:"text",value:P,onChange:ne=>L(ne.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 pr-12 pl-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all",placeholder:" "})]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:""}),S.jsxs("div",{className:"relative",children:[S.jsx(Lw,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:16}),S.jsx("input",{type:"text",value:B,onChange:ne=>H(ne.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 pr-12 pl-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all",placeholder:" "})]})]}),S.jsxs("div",{className:"md:col-span-2",children:[S.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:" "}),S.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 custom-scrollbar",children:["1","2","3","4","5",""].map(ne=>S.jsx("button",{onClick:()=>X(ne),className:`px-6 py-2 rounded-xl border font-bold text-sm transition-all whitespace-nowrap ${O===ne?"bg-amber-500 border-amber-400 text-slate-900":"bg-black/30 border-blue-900/80 text-slate-500 hover:bg-white/5"}`,children:ne===""?"":` ${ne}`},ne))})]})]})]}),S.jsxs("div",{className:"pt-6 flex gap-4 border-t border-blue-900/80",children:[S.jsxs(Zt,{onClick:Y,disabled:c,className:"!bg-amber-500 hover:!bg-amber-600 !text-slate-900 !border-amber-600 px-8",children:[c?S.jsx(Nd,{size:18,className:"animate-spin"}):S.jsx(Gz,{size:18}),c?" ...":" "]}),S.jsx(Zt,{onClick:()=>l(!1),variant:"secondary",children:""})]})]}),S.jsxs("div",{className:"lg:col-span-4 flex flex-col h-full bg-black/20 rounded-2xl p-6 border border-blue-900/80",children:[S.jsxs("h3",{className:"text-sm font-bold text-slate-400 mb-4 flex items-center gap-2",children:[S.jsx(Ez,{size:16}),"   "]}),S.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-6 mb-6 relative",children:S.jsx("div",{className:"w-48 h-48 rounded-full border-4 border-amber-500 shadow-[0_0_30px_rgba(245,158,11,0.2)] relative z-10 bg-white/5 overflow-hidden",children:S.jsx($b,{src:Vb(N),alt:"Selected Avatar",className:"w-full h-full"})})}),S.jsx("label",{className:"text-xs font-bold text-slate-500 block mb-3",children:" :"}),S.jsx("div",{className:"grid grid-cols-5 gap-2 h-auto overflow-y-auto max-h-[200px] pr-2 custom-scrollbar",children:qb.map(ne=>S.jsx("div",{onClick:()=>D(ne),className:`aspect-square rounded-xl cursor-pointer transition-all border-2 overflow-hidden ${N===ne?"border-amber-500 scale-105 shadow-lg shadow-amber-500/20":"border-transparent hover:border-white/20 hover:scale-105"}`,children:S.jsx($b,{src:Vb(ne),alt:ne,className:"w-full h-full"})},ne))})]})]})}):S.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8 mt-6",children:[S.jsx("div",{className:"lg:col-span-1 space-y-6",children:S.jsxs("div",{className:"glass-panel bg-[#112240] p-6 sm:p-8 rounded-[2.5rem] border border-blue-900/80 flex flex-col items-center text-center relative overflow-hidden group",children:[S.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-amber-500/5 via-transparent to-transparent opacity-50 group-hover:opacity-100 transition-opacity"}),S.jsx("div",{className:"w-40 h-40 rounded-full border-[6px] border-[#0A192F] shadow-2xl mb-4 relative z-10 bg-violet-200 overflow-hidden transform group-hover:scale-105 transition-transform duration-500",children:S.jsx($b,{src:Vb(h.avatar||qb[0]),alt:"Profile",className:"w-full h-full"})}),S.jsx("h2",{className:"text-3xl font-black text-slate-200 mb-1 relative z-10",children:h.full_name}),S.jsx("p",{className:"text-sm text-slate-500 font-mono mb-4 sm:mb-6 relative z-10",children:i==null?void 0:i.email}),S.jsxs("div",{className:"w-full space-y-3 sm:space-y-4 text-right relative z-10",children:[S.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[S.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-blue-500/10 flex items-center justify-center text-blue-400 shrink-0",children:S.jsx(Iw,{size:20})}),S.jsxs("div",{children:[S.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),S.jsx("p",{className:"text-sm font-bold text-slate-300 truncate max-w-[150px]",children:h.university||"  "})]})]}),S.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[S.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-fuchsia-500/10 flex items-center justify-center text-fuchsia-400 shrink-0",children:S.jsx(Lw,{size:20})}),S.jsxs("div",{children:[S.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),S.jsx("p",{className:"text-sm font-bold text-slate-300 truncate max-w-[150px]",children:h.major||"  "})]})]}),S.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[S.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-emerald-500/10 flex items-center justify-center text-emerald-400 shrink-0",children:S.jsx(L6,{size:20})}),S.jsxs("div",{children:[S.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:" "}),S.jsx("p",{className:"text-sm font-bold text-slate-300",children:h.academic_year?h.academic_year===""?"":` ${h.academic_year}`:" "})]})]}),S.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[S.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-amber-500/10 flex items-center justify-center text-amber-400 shrink-0",children:S.jsx(Ek,{size:20})}),S.jsxs("div",{children:[S.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),S.jsx("p",{className:"text-sm font-bold text-slate-300",children:h.age||" "})]})]})]}),S.jsx("div",{className:"w-full mt-4 relative z-10",children:S.jsxs(Zt,{onClick:()=>l(!0),variant:"secondary",fullWidth:!0,className:"!py-3 !text-sm !rounded-xl bg-white/5 hover:bg-white/10 border-blue-900/50 text-slate-300 hover:text-white",children:[S.jsx(Nz,{size:16}),"  "]})}),S.jsx("div",{className:"w-full mt-3 pt-6 border-t border-blue-900/50 relative z-10",children:S.jsxs(Zt,{onClick:t,variant:"danger",fullWidth:!0,className:"!py-3 !text-sm !rounded-xl opacity-80 hover:opacity-100",children:[S.jsx(yz,{size:16}),"  "]})})]})}),S.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 sm:gap-4",children:[S.jsxs("div",{className:"glass-panel p-4 sm:p-5 rounded-[2rem] bg-[#050505] border border-blue-900/80 flex items-center gap-3 sm:gap-4 group",children:[S.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-2xl bg-amber-400/10 flex items-center justify-center text-amber-400 transition-transform group-hover:scale-110",children:S.jsx(Ak,{size:24})}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-2xl font-black text-white",children:e.length}),S.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:" "})]})]}),S.jsxs("div",{className:"glass-panel p-4 sm:p-5 rounded-[2rem] bg-[#050505] border border-blue-900/80 flex items-center gap-3 sm:gap-4 group",children:[S.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-400 transition-transform group-hover:scale-110",children:S.jsx(p0,{size:24})}),S.jsxs("div",{children:[S.jsxs("h4",{className:"text-2xl font-black text-white",children:[p.avgScore,"%"]}),S.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:" "})]})]}),S.jsxs("div",{className:"glass-panel p-4 sm:p-5 rounded-[2rem] bg-[#050505] border border-blue-900/80 flex items-center gap-3 sm:gap-4 group",children:[S.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-blue-400 transition-transform group-hover:scale-110",children:S.jsx(rR,{size:24})}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-xs font-black text-white",children:se(i==null?void 0:i.created_at)}),S.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:" "})]})]})]}),S.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-gradient-to-br from-[#112240] to-black border border-blue-900/80 relative overflow-hidden",children:[S.jsx("div",{className:"absolute top-0 right-0 p-10 opacity-5",children:S.jsx(A6,{size:120})}),S.jsxs("div",{className:"relative z-10",children:[S.jsxs("div",{className:"flex items-center justify-between mb-6",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("div",{className:"w-14 h-14 rounded-2xl bg-amber-500/20 border border-amber-400/30 flex items-center justify-center text-amber-400 shadow-[0_0_20px_rgba(245,158,11,0.2)]",children:S.jsx("span",{className:"text-3xl font-black italic",children:p.level})}),S.jsxs("div",{children:[S.jsx("h3",{className:"text-xl font-black text-slate-200 tracking-tight",children:" "}),S.jsxs("p",{className:"text-xs text-slate-500 font-bold uppercase tracking-widest",children:[p.totalExp,"   "]})]})]}),S.jsxs("div",{className:"text-right",children:[S.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1",children:" "}),S.jsxs("p",{className:"text-sm font-black text-slate-300 italic",children:[p.nextLevelXp," XP"]})]})]}),S.jsx("div",{className:"relative h-4 bg-white/5 rounded-full overflow-hidden border border-blue-900/50 p-1 mb-10",children:S.jsx("div",{className:"h-full bg-gradient-to-r from-amber-500 to-yellow-400 rounded-full transition-all duration-1000 shadow-[0_0_15px_rgba(245,158,11,0.4)]",style:{width:`${p.progress}%`}})}),S.jsxs("h4",{className:"text-xs font-black text-slate-400 uppercase tracking-[0.2em] mb-6 flex items-center gap-2",children:[S.jsx(fx,{size:14,className:"text-yellow-500"}),"  "]}),S.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:p.achievements.map(ne=>S.jsxs("div",{className:`p-4 rounded-2xl border transition-all flex flex-col items-center text-center ${ne.earned?"bg-white/5 border-amber-400/20":"bg-black/20 border-blue-900/50 opacity-40 grayscale"}`,children:[S.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mb-3 ${ne.earned?"bg-amber-400/20 text-amber-400":"bg-white/5 text-slate-700"}`,children:ne.icon}),S.jsx("p",{className:`text-xs font-black mb-1 ${ne.earned?"text-slate-200":"text-slate-600"}`,children:ne.title}),S.jsx("p",{className:"text-[9px] text-slate-500 leading-tight",children:ne.desc})]},ne.id))})]})]}),S.jsxs("div",{className:"glass-panel bg-[#112240] rounded-[2.5rem] p-8 border border-blue-900/80",children:[S.jsxs("div",{className:"flex items-center justify-between mb-6",children:[S.jsxs("h3",{className:"text-xl font-bold text-slate-200 flex items-center gap-3",children:[S.jsx(sz,{className:"text-amber-400",size:24}),"  "]}),S.jsxs("span",{className:"text-xs font-bold text-slate-500 bg-white/5 px-3 py-1 rounded-full",children:[e.length," "]})]}),S.jsxs("div",{className:"space-y-3",children:[e.length===0?S.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-blue-900/50 rounded-3xl",children:[S.jsx("div",{className:"w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-600",children:S.jsx(tz,{size:32})}),S.jsx("h4",{className:"text-lg font-bold text-slate-200 mb-2",children:"   "}),S.jsx("p",{className:"text-slate-500 mb-6 text-sm",children:"      ."}),S.jsx(Zt,{onClick:()=>s(Te.HOME),className:"!bg-amber-500 hover:!bg-amber-600 !text-slate-900 !py-2 !px-6 !text-sm",children:" "})]}):e.slice(0,10).map((ne,be)=>{const ye=Math.round(ne.score/ne.total_questions*100);return S.jsxs("div",{className:"group p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:border-amber-400/30 hover:bg-black/40 transition-all flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsxs("div",{className:`w-14 h-14 shrink-0 rounded-2xl flex items-center justify-center font-black text-lg border ${ye>=50?"bg-emerald-500/10 border-emerald-500/20 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":"bg-red-500/10 border-red-500/20 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]"}`,children:[ye,"%"]}),S.jsxs("div",{children:[S.jsx("h4",{className:"font-bold text-slate-200 text-base mb-1 group-hover:text-amber-300 transition-colors",children:ne.quiz_title}),S.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500 font-medium",children:[S.jsxs("span",{className:"flex items-center gap-1",children:[S.jsx(rR,{size:12})," ",ne.created_at?new Intl.DateTimeFormat("ar-EG",{day:"numeric",month:"numeric",year:"numeric"}).format(new Date(ne.created_at)):" "]}),S.jsxs("span",{className:"flex items-center gap-1",children:[S.jsx(g0,{size:12,className:"text-amber-500"})," +",ne.score*10," XP"]})]})]})]}),S.jsxs("div",{className:"flex items-center justify-between sm:block sm:text-right border-t border-blue-900/50 sm:border-0 pt-3 sm:pt-0",children:[S.jsxs("span",{className:"text-sm font-bold text-slate-300 bg-black/30 px-3 py-1 rounded-lg border border-blue-900/50 sm:bg-transparent sm:border-0 sm:p-0",children:[ne.score," / ",ne.total_questions]}),S.jsx("p",{className:"text-[10px] text-slate-500 uppercase sm:mt-1 hidden sm:block",children:""})]})]},be)}),e.length>10&&S.jsx("p",{className:"text-center text-xs text-slate-600 mt-4 font-medium",children:"   10  ."})]})]})]})]})})})},xq=i=>{switch(i){case"true_false":return{label:" / ",icon:S.jsx(Tk,{size:12}),color:"bg-orange-500/10 text-orange-400 border-orange-500/20"};case"cloze":return{label:" ",icon:S.jsx(nq,{size:12}),color:"bg-purple-500/10 text-purple-400 border-purple-500/20"};case"wh_question":return{label:" ",icon:S.jsx(Ck,{size:12}),color:"bg-blue-500/10 text-blue-400 border-blue-500/20"};default:return{label:" ",icon:S.jsx(Pz,{size:12}),color:"bg-slate-800/50 text-slate-300 border-slate-700/50"}}},Sq=({question:i,selectedOptionIndex:e,onSelectOption:t,showFeedback:n,language:s})=>{const a=xq(i.type),l=s==="en",c=l?"ltr":"rtl",d=l?"text-left":"text-right";return S.jsxs("div",{className:"w-full max-w-3xl mx-auto animate-fade-in-up",dir:c,children:[S.jsxs("div",{className:"glass-panel bg-[#080808]/95 rounded-2xl p-5 md:p-6 relative overflow-hidden border border-white/5 shadow-xl",children:[S.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-2/3 h-0.5 bg-gradient-to-r from-transparent via-violet-500/30 to-transparent blur-sm"}),S.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[10px] font-bold border mb-4 ${a.color}`,dir:"rtl",children:[a.icon,S.jsx("span",{children:a.label})]}),S.jsx("h2",{className:`text-sm md:text-[15px] font-bold text-white leading-relaxed mb-6 ${d} drop-shadow-sm tracking-wide`,children:i.question}),S.jsx("div",{className:"grid grid-cols-1 gap-3",children:i.options.map((h,p)=>{let v="border-white/5 bg-white/[0.02] hover:bg-white/[0.05] hover:border-violet-500/30",_=null,x="text-slate-300";return e===p&&(v="border-violet-500 bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.1)]",x="text-white font-semibold"),n&&(p===i.correctAnswerIndex?(v="border-emerald-500/50 bg-emerald-500/10",x="text-emerald-300 font-bold",_=S.jsx(Pw,{className:"text-emerald-500 shrink-0 drop-shadow-[0_0_8px_rgba(16,185,129,0.5)]",size:16})):e===p&&p!==i.correctAnswerIndex?(v="border-red-500/50 bg-red-500/10",x="text-red-300 font-medium",_=S.jsx($6,{className:"text-red-500 shrink-0",size:16})):(v="border-transparent bg-black/20 opacity-40",x="text-slate-500")),S.jsxs("button",{onClick:()=>!n&&t(p),disabled:n,className:`group w-full ${d} p-3 rounded-xl border transition-all duration-200 flex items-center justify-between gap-3 ${v}`,children:[S.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[S.jsx("div",{className:`shrink-0 w-6 h-6 rounded-md border flex items-center justify-center text-[10px] font-bold transition-all ${e===p?"border-violet-500 text-violet-300 bg-violet-500/20":"border-white/10 text-slate-500 bg-white/5 group-hover:border-violet-500/50 group-hover:text-violet-300"}`,children:String.fromCharCode(65+p)}),S.jsx("span",{className:`text-xs md:text-[13px] leading-relaxed ${x}`,children:h})]}),_]},p)})})]}),n&&S.jsx("div",{className:`mt-4 bg-[#0A0A0A] border border-white/10 p-4 rounded-2xl shadow-lg animate-fade-in ${l?"text-left":"text-right"}`,children:S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx("div",{className:"mt-0.5 text-emerald-400 shrink-0 p-1.5 bg-emerald-500/10 rounded-full",children:S.jsx(Pw,{size:16})}),S.jsxs("div",{children:[S.jsx("p",{className:"font-bold text-sm mb-1 text-emerald-300",children:l?"Explanation":" "}),S.jsx("p",{className:"text-slate-400 text-xs leading-relaxed",children:i.explanation})]})]})})]})},Aq=({quiz:i,config:e,onFinish:t,onExit:n})=>{const[s,a]=ue.useState(0),[l,c]=ue.useState(null),[d,h]=ue.useState(!1),[p,v]=ue.useState(0),[_,x]=ue.useState(!1),A=e.questionCount*60,[E,R]=ue.useState(A);ue.useEffect(()=>{const H=setInterval(()=>{R(O=>O<=1?(clearInterval(H),t(p),0):O-1)},1e3);return()=>clearInterval(H)},[p,t]);const N=H=>{const O=Math.floor(H/60),X=H%60;return`${O}:${X.toString().padStart(2,"0")}`},D=()=>{s<i.questions.length-1?(a(H=>H+1),c(null),h(!1)):t(p)},P=()=>{const H=i.questions[s];l===H.correctAnswerIndex&&v(O=>O+1),h(!0)},L=i.questions[s],B=E<60;return S.jsxs("div",{className:"min-h-screen pb-20 relative z-10 pt-24 animate-lux-up",children:[S.jsxs("div",{className:"fixed top-20 left-0 right-0 z-40 bg-[#020617]/80 backdrop-blur-md border-b border-white/5 shadow-lg",children:[S.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-4 flex justify-between items-center",children:[S.jsxs("div",{className:"text-xl font-black text-white font-mono",children:[S.jsx("span",{className:"text-violet-400",children:s+1})," / ",S.jsx("span",{className:"text-slate-500",children:i.questions.length})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsxs("div",{className:`px-4 py-2 rounded-xl font-mono font-bold text-lg border transition-colors ${B?"bg-red-500/10 text-red-400 border-red-500/20 animate-pulse":"bg-white/5 text-slate-300 border-white/5"}`,children:[S.jsx(Rk,{size:18,className:"inline mr-2"})," ",N(E)]}),S.jsx("button",{onClick:()=>x(!0),className:"p-3 rounded-xl bg-red-500/10 text-red-400 border border-red-500/20 hover:bg-red-500/20 transition-all",children:S.jsx(px,{size:18})})]})]}),S.jsx("div",{className:"w-full h-1 bg-white/5",children:S.jsx("div",{className:"h-full bg-gradient-to-r from-violet-600 to-fuchsia-600 transition-all duration-500",style:{width:`${(s+1)/i.questions.length*100}%`}})})]}),S.jsxs("div",{className:"max-w-3xl mx-auto px-4 pt-20",children:[S.jsx("div",{className:"animate-lux-scale",children:S.jsx(Sq,{question:L,selectedOptionIndex:l,onSelectOption:c,showFeedback:d,language:e.language})},s),S.jsx("div",{className:"mt-8 flex justify-center gap-4",children:d?S.jsx(Zt,{onClick:D,variant:"secondary",className:"w-full md:w-2/3 bg-white text-black hover:bg-slate-200 border-none shadow-xl",children:s<i.questions.length-1?" ":"  "}):S.jsx(Zt,{onClick:P,disabled:l===null,className:"w-full md:w-2/3 shadow-xl",children:" "})})]}),_&&S.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[S.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>x(!1)}),S.jsxs("div",{className:"glass-panel w-full max-w-sm p-8 rounded-3xl text-center relative animate-lux-scale border border-white/10",children:[S.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20",children:S.jsx(Ik,{size:32,className:"text-red-500"})}),S.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"   "}),S.jsx("p",{className:"text-slate-400 mb-8 text-sm leading-relaxed",children:"           ."}),S.jsxs("div",{className:"flex gap-3",children:[S.jsx(Zt,{onClick:n,variant:"danger",fullWidth:!0,className:"!py-3",children:" "}),S.jsx(Zt,{onClick:()=>x(!1),variant:"secondary",fullWidth:!0,className:"!py-3",children:""})]})]})]})]})},Eq=({appState:i,onNavigate:e,onReset:t,onUploadClick:n,isVisible:s})=>s?S.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-[60] animate-lux-up",children:S.jsx("div",{className:"bg-black border-t border-white/5 shadow-[0_-10px_40px_rgba(0,0,0,0.8)] pt-3 pb-6 px-2",children:S.jsxs("div",{className:"max-w-md mx-auto flex items-center justify-around relative",children:[S.jsxs("button",{onClick:()=>t(),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${i===Te.HOME?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[S.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${i===Te.HOME?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:S.jsx(hx,{size:20,strokeWidth:i===Te.HOME?2.5:2})}),S.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${i===Te.HOME?"text-violet-300":"text-slate-600"}`,children:""})]}),S.jsxs("button",{onClick:()=>e(Te.SERVICES),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${i===Te.SERVICES?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[S.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${i===Te.SERVICES?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:S.jsx(cz,{size:20,strokeWidth:i===Te.SERVICES?2.5:2})}),S.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${i===Te.SERVICES?"text-violet-300":"text-slate-600"}`,children:""})]}),S.jsxs("button",{onClick:n,className:"flex flex-col items-center gap-1.5 flex-1 group",children:[S.jsxs("div",{className:"relative",children:[S.jsx("div",{className:"absolute inset-0 bg-violet-600 blur-xl opacity-20 group-active:opacity-40"}),S.jsx("div",{className:"relative w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-700 rounded-xl flex items-center justify-center text-white shadow-lg border border-white/10 active:scale-90 transition-all",children:S.jsx(Mk,{size:22,strokeWidth:3})})]}),S.jsx("span",{className:"text-[8px] font-black text-violet-400 uppercase tracking-wider",children:" "})]}),S.jsxs("button",{onClick:()=>e(Te.DEVAI),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${i===Te.DEVAI?"text-fuchsia-400":"text-slate-500 hover:text-slate-300"}`,children:[S.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${i===Te.DEVAI?"bg-fuchsia-500/10 shadow-[0_0_15px_rgba(217,70,239,0.2)]":""}`,children:S.jsx(Hp,{size:20,strokeWidth:i===Te.DEVAI?2.5:2})}),S.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${i===Te.DEVAI?"text-fuchsia-300":"text-slate-600"}`,children:""})]}),S.jsxs("button",{onClick:()=>e(Te.PROFILE),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${i===Te.PROFILE?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[S.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${i===Te.PROFILE?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:S.jsx(ux,{size:20,strokeWidth:i===Te.PROFILE?2.5:2})}),S.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${i===Te.PROFILE?"text-violet-300":"text-slate-600"}`,children:""})]})]})})}):null,Tq=({appState:i,user:e,onReset:t,onNavigate:n,onAuthOpen:s,onProfile:a})=>{var c,d,h;const l=((c=e==null?void 0:e.user_metadata)==null?void 0:c.role)==="admin";return S.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-black/40 backdrop-blur-2xl border-b border-white/5 h-16 flex items-center px-6",children:S.jsxs("div",{className:"max-w-7xl mx-auto w-full flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:t,children:[S.jsx("div",{className:"w-9 h-9 bg-violet-600 rounded-xl flex items-center justify-center shadow-lg shadow-violet-500/20",children:l?S.jsx(kk,{className:"text-white",size:20}):S.jsx(dx,{className:"text-white",size:20})}),S.jsx("span",{className:"text-xl font-black text-white tracking-tighter",children:""})]}),S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsxs("div",{className:"hidden lg:flex items-center gap-6 text-xs font-bold text-slate-400",children:[S.jsx("button",{onClick:t,className:i===Te.HOME?"text-white":"",children:""}),S.jsx("button",{onClick:()=>n(Te.SERVICES),className:i===Te.SERVICES?"text-white":"",children:" "})]}),e?S.jsxs("button",{onClick:a,className:"flex items-center gap-2 bg-white/5 border border-white/10 px-4 py-2 rounded-xl text-xs font-bold text-white",children:[S.jsx(ux,{size:16,className:"text-violet-400"}),(h=(d=e.user_metadata)==null?void 0:d.full_name)==null?void 0:h.split(" ")[0]]}):S.jsx("button",{onClick:s,className:"bg-violet-600 px-5 py-2 rounded-xl text-xs font-bold text-white shadow-lg shadow-violet-600/20",children:""})]})]})})};function Cq(){const[i,e]=ue.useState(Te.HOME),[t,n]=ue.useState(""),[s,a]=ue.useState(null),[l,c]=ue.useState(0),[d,h]=ue.useState(""),[p,v]=ue.useState(null),[_,x]=ue.useState(!1),[A,E]=ue.useState(!1),[R,N]=ue.useState(null),[D,P]=ue.useState({language:"ar",questionCount:10});ue.useEffect(()=>{nr.auth.getSession().then(({data:{session:X}})=>v((X==null?void 0:X.user)||null));const{data:{subscription:O}}=nr.auth.onAuthStateChange((X,Y)=>v((Y==null?void 0:Y.user)||null));return()=>O.unsubscribe()},[]);const L=async O=>{try{e(Te.PROCESSING),n("    ...");const X=await yL(O);N(X),E(!0),e(Te.HOME)}catch(X){h(X.message),e(Te.ERROR)}},B=async()=>{if(R){E(!1),e(Te.PROCESSING),n("    ...");try{const O=await NH(R,D);a(O),e(Te.QUIZ)}catch(O){O.message==="API_KEY_MISSING"?h(" API .  Vercel      API_KEY ( VITE_)."):h(O.message),e(Te.ERROR)}}},H=O=>{e(O),window.scrollTo(0,0)};return S.jsxs("div",{className:"min-h-screen bg-[#020202] text-white font-sans selection:bg-violet-500/30 overflow-x-hidden",dir:"rtl",children:[S.jsx(Tq,{appState:i,user:p,onReset:()=>H(Te.HOME),onNavigate:H,onAuthOpen:()=>x(!0),onProfile:()=>H(Te.PROFILE)}),S.jsxs("main",{className:"relative pt-20 pb-24",children:[i===Te.HOME&&S.jsxs("div",{className:"animate-fade-in px-4 py-12 flex flex-col items-center",children:[S.jsxs("div",{className:"max-w-4xl text-center space-y-6 mb-16",children:[S.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-violet-500/10 border border-violet-500/20 text-violet-400 text-[10px] font-bold uppercase tracking-widest mb-4",children:[S.jsx(Hp,{size:12}),"   "]}),S.jsx("h1",{className:"text-6xl md:text-8xl font-black tracking-tighter bg-clip-text text-transparent bg-gradient-to-b from-white to-white/40 leading-none",children:""}),S.jsx("p",{className:"text-slate-400 text-sm md:text-base max-w-xl mx-auto font-medium",children:"          ."}),S.jsx("div",{className:"pt-10",children:S.jsx(fq,{onFileSelect:L})})]}),S.jsx(mq,{}),S.jsx(yq,{})]}),i===Te.PROCESSING&&S.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[70vh] text-center p-6 animate-pulse",children:[S.jsxs("div",{className:"relative mb-10",children:[S.jsx("div",{className:"absolute inset-0 bg-violet-500/20 blur-3xl rounded-full"}),S.jsx(Nd,{className:"w-20 h-20 text-violet-500 animate-spin relative z-10"})]}),S.jsx("h2",{className:"text-2xl font-black mb-3",children:t}),S.jsx("p",{className:"text-slate-500 text-sm font-bold",children:"   "})]}),i===Te.SERVICES&&S.jsx(vq,{onNavigate:H}),i===Te.DEVAI&&S.jsx(bq,{onNavigate:H}),i===Te.PROFILE&&S.jsx(wq,{user:p,quizHistory:[],onLogout:()=>nr.auth.signOut(),onSaveProfile:async()=>{},onNavigate:H}),i===Te.QUIZ&&s&&S.jsx(Aq,{quiz:s,config:D,onFinish:O=>{c(O),e(Te.RESULT)},onExit:()=>H(Te.HOME)}),i===Te.RESULT&&S.jsxs("div",{className:"min-h-[70vh] flex flex-col items-center justify-center text-center px-6",children:[S.jsx(p0,{className:"w-24 h-24 text-yellow-400 mb-6 drop-shadow-[0_0_30px_rgba(250,204,21,0.3)] animate-bounce"}),S.jsx("h2",{className:"text-4xl font-black mb-2",children:" !"}),S.jsxs("div",{className:"text-6xl font-black text-violet-400 my-8",children:[Math.round(l/((s==null?void 0:s.questions.length)||1)*100),"%"]}),S.jsxs("div",{className:"flex gap-4 w-full max-w-xs",children:[S.jsx(Zt,{fullWidth:!0,onClick:()=>H(Te.HOME),children:""}),S.jsx(Zt,{fullWidth:!0,variant:"secondary",onClick:()=>H(Te.PROFILE),children:""})]})]}),i===Te.ERROR&&S.jsxs("div",{className:"min-h-[70vh] flex flex-col items-center justify-center text-center p-6",children:[S.jsx("div",{className:"w-20 h-20 bg-red-500/10 rounded-3xl flex items-center justify-center mb-6 border border-red-500/20",children:S.jsx(Ik,{className:"w-10 h-10 text-red-500"})}),S.jsx("h2",{className:"text-2xl font-black mb-4",children:"  "}),S.jsx("div",{className:"bg-white/5 border border-white/10 p-4 rounded-2xl mb-8 max-w-sm",children:S.jsx("p",{className:"text-red-400 text-sm font-bold leading-relaxed",children:d})}),S.jsx(Zt,{onClick:()=>H(Te.HOME),children:"  "})]})]}),S.jsx(Eq,{appState:i,onNavigate:H,onReset:()=>H(Te.HOME),onUploadClick:()=>H(Te.HOME),isVisible:i!==Te.QUIZ&&i!==Te.PROCESSING}),S.jsx(pq,{isOpen:_,onClose:()=>x(!1),onSuccess:O=>v(O)}),A&&S.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm",children:S.jsxs("div",{className:"bg-[#0a0a0a] border border-white/10 rounded-[2.5rem] p-8 max-w-md w-full shadow-2xl animate-lux-up",children:[S.jsx("div",{className:"w-14 h-14 bg-violet-600/10 rounded-2xl flex items-center justify-center mb-6 border border-violet-600/20",children:S.jsx(qz,{className:"text-violet-400",size:28})}),S.jsx("h3",{className:"text-2xl font-black mb-6",children:" "}),S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{children:[S.jsx("p",{className:"text-[10px] font-black text-slate-500 mb-3 uppercase tracking-widest",children:" "}),S.jsx("div",{className:"grid grid-cols-4 gap-2",children:[5,10,20,30].map(O=>S.jsx("button",{onClick:()=>P({...D,questionCount:O}),className:`py-3 rounded-xl text-xs font-bold border transition-all ${D.questionCount===O?"bg-violet-600 border-violet-500 text-white shadow-lg shadow-violet-600/20":"bg-white/5 border-white/5 text-slate-500 hover:border-white/20"}`,children:O},O))})]}),S.jsxs("div",{children:[S.jsx("p",{className:"text-[10px] font-black text-slate-500 mb-3 uppercase tracking-widest",children:" "}),S.jsx("div",{className:"flex gap-2",children:["ar","en"].map(O=>S.jsx("button",{onClick:()=>P({...D,language:O}),className:`flex-1 py-3 rounded-xl text-xs font-bold border transition-all ${D.language===O?"bg-violet-600 border-violet-500 text-white shadow-lg shadow-violet-600/20":"bg-white/5 border-white/5 text-slate-500 hover:border-white/20"}`,children:O==="ar"?"":"English"},O))})]}),S.jsxs("div",{className:"pt-4 flex gap-3",children:[S.jsxs(Zt,{fullWidth:!0,onClick:B,children:[S.jsx(N6,{size:18}),"  "]}),S.jsx(Zt,{fullWidth:!0,variant:"secondary",onClick:()=>E(!1),children:""})]})]})]})})]})}const Dk=document.getElementById("root");if(!Dk)throw new Error("Could not find root element to mount to");const Rq=gD.createRoot(Dk);Rq.render(S.jsx(L0.StrictMode,{children:S.jsx(Cq,{})}));const jb=document.getElementById("splash-screen");jb&&setTimeout(()=>{jb.classList.add("hidden"),setTimeout(()=>{jb.remove()},600)},1200);
